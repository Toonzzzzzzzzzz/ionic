{"ast":null,"code":"import _asyncToGenerator from \"/home/toon/works/gitionic7/ionic-github/ionic/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _class;\nimport { CoreApp } from '@services/app';\nimport { CoreDomUtils } from '@services/utils/dom';\nimport { CoreUtils } from '@services/utils/utils';\nimport { CoreTextUtils } from '@services/utils/text';\nimport { CoreTag } from '@features/tag/services/tag';\nimport { Translate } from '@singletons';\nimport { CoreContentLinksHelper } from '@features/contentlinks/services/contentlinks-helper';\nimport { CoreNavigator } from '@services/navigator';\nimport { CoreMainMenuDeepLinkManager } from '@features/mainmenu/classes/deep-link-manager';\nimport { CoreTime } from '@singletons/time';\nimport { CoreAnalytics, CoreAnalyticsEventType } from '@services/analytics';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nimport * as i2 from \"../../../../components/empty-box/empty-box\";\nimport * as i3 from \"../../../../components/loading/loading\";\nimport * as i4 from \"../../../../components/combobox/combobox\";\nimport * as i5 from \"../../../../directives/content\";\nimport * as i6 from \"@ionic/angular\";\nimport * as i7 from \"../../../search/components/search-box/search-box\";\nimport * as i8 from \"../../../mainmenu/components/user-menu-button/user-menu-button\";\nimport * as i9 from \"@ngx-translate/core\";\nfunction CoreTagSearchPage_ion_col_19_ion_select_option_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-select-option\", 14);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const collection_r4 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", collection_r4.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", collection_r4.name, \"\");\n  }\n}\nfunction CoreTagSearchPage_ion_col_19_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-col\", 7)(1, \"core-combobox\", 13);\n    i0.ɵɵlistener(\"onChange\", function CoreTagSearchPage_ion_col_19_Template_core_combobox_onChange_1_listener($event) {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r5 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r5.searchTags(ctx_r5.query, $event));\n    });\n    i0.ɵɵelementStart(2, \"ion-select-option\", 14);\n    i0.ɵɵtext(3);\n    i0.ɵɵpipe(4, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(5, CoreTagSearchPage_ion_col_19_ion_select_option_5_Template, 2, 2, \"ion-select-option\", 15);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"selection\", ctx_r0.collectionId)(\"disabled\", ctx_r0.searching);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"value\", 0);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(4, 5, \"core.tag.inalltagcoll\"), \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.collections);\n  }\n}\nconst _c0 = function (a0) {\n  return {\n    $a: a0\n  };\n};\nfunction CoreTagSearchPage_core_empty_box_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"core-empty-box\", 16);\n    i0.ɵɵpipe(1, \"translate\");\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"message\", i0.ɵɵpipeBind2(1, 1, \"core.tag.notagsfound\", i0.ɵɵpureFunction1(4, _c0, ctx_r1.query)));\n  }\n}\nfunction CoreTagSearchPage_ng_container_22_ion_badge_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-badge\", 20);\n    i0.ɵɵlistener(\"click\", function CoreTagSearchPage_ng_container_22_ion_badge_2_Template_ion_badge_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r11);\n      const tag_r9 = restoredCtx.$implicit;\n      const ctx_r10 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r10.openTag(tag_r9));\n    });\n    i0.ɵɵelementStart(1, \"span\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const tag_r9 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵclassMap(\"size\" + tag_r9.size);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(tag_r9.name);\n  }\n}\nfunction CoreTagSearchPage_ng_container_22_p_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 21);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r8 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind2(2, 1, \"core.tag.showingfirsttags\", i0.ɵɵpureFunction1(4, _c0, ctx_r8.cloud.tags.length)), \" \");\n  }\n}\nfunction CoreTagSearchPage_ng_container_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 17);\n    i0.ɵɵtemplate(2, CoreTagSearchPage_ng_container_22_ion_badge_2_Template, 3, 3, \"ion-badge\", 18);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(3, CoreTagSearchPage_ng_container_22_p_3_Template, 3, 6, \"p\", 19);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.cloud.tags);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.cloud.tags.length < ctx_r2.cloud.totalcount);\n  }\n}\n/**\n * Page that displays most used tags and allows searching.\n */\nexport class CoreTagSearchPage {\n  constructor() {\n    this.collections = [];\n    this.loaded = false;\n    this.searching = false;\n    this.logView = CoreTime.once( /*#__PURE__*/_asyncToGenerator(function* () {\n      CoreAnalytics.logEvent({\n        type: CoreAnalyticsEventType.VIEW_ITEM_LIST,\n        ws: 'core_tag_get_tag_cloud',\n        name: Translate.instant('core.tag.searchtags'),\n        data: {\n          category: 'tag'\n        },\n        url: '/tag/search.php'\n      });\n    }));\n  }\n  /**\n   * View loaded.\n   */\n  ngOnInit() {\n    this.collectionId = CoreNavigator.getRouteNumberParam('collectionId') || 0;\n    this.query = CoreNavigator.getRouteParam('query') || '';\n    const deepLinkManager = new CoreMainMenuDeepLinkManager();\n    deepLinkManager.treatLink();\n    this.fetchData().finally(() => {\n      this.loaded = true;\n    });\n  }\n  fetchData() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      try {\n        yield Promise.all([_this.fetchCollections(), _this.fetchTags()]);\n        if (!_this.query) {\n          _this.logView();\n        }\n      } catch (error) {\n        CoreDomUtils.showErrorModalDefault(error, 'Error loading tags.');\n      }\n    })();\n  }\n  /**\n   * Fetch tag collections.\n   *\n   * @returns Resolved when done.\n   */\n  fetchCollections() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      const collections = yield CoreTag.getTagCollections();\n      collections.forEach(collection => {\n        if (!collection.name && collection.isdefault) {\n          collection.name = Translate.instant('core.tag.defautltagcoll');\n        }\n      });\n      _this2.collections = collections;\n    })();\n  }\n  /**\n   * Fetch tags.\n   *\n   * @returns Resolved when done.\n   */\n  fetchTags() {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      var _this3$logSearch;\n      _this3.cloud = yield CoreTag.getTagCloud(_this3.collectionId, undefined, undefined, _this3.query);\n      (_this3$logSearch = _this3.logSearch) === null || _this3$logSearch === void 0 || _this3$logSearch.call(_this3);\n    })();\n  }\n  /**\n   * Go to tag index page.\n   */\n  openTag(tag) {\n    const url = CoreTextUtils.decodeURI(tag.viewurl);\n    CoreContentLinksHelper.handleLink(url);\n  }\n  /**\n   * Refresh data.\n   *\n   * @param refresher Refresher event.\n   */\n  refreshData(refresher) {\n    CoreUtils.allPromises([CoreTag.invalidateTagCollections(), CoreTag.invalidateTagCloud(this.collectionId, undefined, undefined, this.query)]).finally(() => this.fetchData().finally(() => {\n      refresher === null || refresher === void 0 || refresher.complete();\n    }));\n  }\n  /**\n   * Search tags.\n   *\n   * @param query Search query.\n   * @param collectionId Collection ID to use.\n   * @returns Resolved when done.\n   */\n  searchTags(query, collectionId) {\n    this.searching = true;\n    this.query = query;\n    if (collectionId !== undefined) {\n      this.collectionId = collectionId;\n    }\n    this.logSearch = CoreTime.once(() => this.performLogSearch());\n    CoreApp.closeKeyboard();\n    return this.fetchTags().catch(error => {\n      CoreDomUtils.showErrorModalDefault(error, 'Error loading tags.');\n    }).finally(() => {\n      this.searching = false;\n    });\n  }\n  /**\n   * Log search.\n   */\n  performLogSearch() {\n    var _this4 = this;\n    return _asyncToGenerator(function* () {\n      if (!_this4.query) {\n        return;\n      }\n      CoreAnalytics.logEvent({\n        type: CoreAnalyticsEventType.VIEW_ITEM_LIST,\n        ws: 'core_tag_get_tag_cloud',\n        name: Translate.instant('core.tag.searchtags'),\n        data: {\n          category: 'tag'\n        },\n        url: `/tag/search.php&query=${_this4.query}&tc=${_this4.collectionId}&go=${Translate.instant('core.search')}`\n      });\n    })();\n  }\n}\n_class = CoreTagSearchPage;\n_class.ɵfac = function CoreTagSearchPage_Factory(t) {\n  return new (t || _class)();\n};\n_class.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: _class,\n  selectors: [[\"page-core-tag-search\"]],\n  decls: 23,\n  vars: 20,\n  consts: [[\"slot\", \"start\"], [3, \"text\"], [\"slot\", \"end\"], [\"slot\", \"fixed\", 3, \"disabled\", \"ionRefresh\"], [3, \"pullingText\"], [1, \"safe-area-padding\"], [1, \"ion-no-padding\", \"ion-wrap\"], [\"size\", \"12\", \"size-sm\", \"6\", 1, \"ion-no-padding\"], [\"autocorrect\", \"off\", \"searchArea\", \"CoreTag\", 3, \"initialSearch\", \"disabled\", \"spellcheck\", \"autoFocus\", \"lengthCheck\", \"onSubmit\", \"onClear\"], [\"class\", \"ion-no-padding\", \"size\", \"12\", \"size-sm\", \"6\", 4, \"ngIf\"], [3, \"hideUntil\"], [\"icon\", \"fas-tags\", 3, \"message\", 4, \"ngIf\"], [4, \"ngIf\"], [3, \"selection\", \"disabled\", \"onChange\"], [1, \"ion-text-wrap\", 3, \"value\"], [\"class\", \"ion-text-wrap\", 3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"icon\", \"fas-tags\", 3, \"message\"], [1, \"ion-text-center\", \"core-tag-cloud\"], [\"class\", \"ion-text-wrap\", 3, \"click\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"ion-text-center\", 4, \"ngIf\"], [1, \"ion-text-wrap\", 3, \"click\"], [1, \"ion-text-center\"]],\n  template: function CoreTagSearchPage_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"ion-header\")(1, \"ion-toolbar\")(2, \"ion-buttons\", 0);\n      i0.ɵɵelement(3, \"ion-back-button\", 1);\n      i0.ɵɵpipe(4, \"translate\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(5, \"ion-title\")(6, \"h1\");\n      i0.ɵɵtext(7);\n      i0.ɵɵpipe(8, \"translate\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(9, \"ion-buttons\", 2);\n      i0.ɵɵelement(10, \"core-user-menu-button\");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(11, \"ion-content\")(12, \"ion-refresher\", 3);\n      i0.ɵɵlistener(\"ionRefresh\", function CoreTagSearchPage_Template_ion_refresher_ionRefresh_12_listener($event) {\n        return ctx.refreshData($event.target);\n      });\n      i0.ɵɵelement(13, \"ion-refresher-content\", 4);\n      i0.ɵɵpipe(14, \"translate\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(15, \"ion-grid\", 5)(16, \"ion-row\", 6)(17, \"ion-col\", 7)(18, \"core-search-box\", 8);\n      i0.ɵɵlistener(\"onSubmit\", function CoreTagSearchPage_Template_core_search_box_onSubmit_18_listener($event) {\n        return ctx.searchTags($event);\n      })(\"onClear\", function CoreTagSearchPage_Template_core_search_box_onClear_18_listener() {\n        return ctx.searchTags(\"\");\n      });\n      i0.ɵɵelementEnd()();\n      i0.ɵɵtemplate(19, CoreTagSearchPage_ion_col_19_Template, 6, 7, \"ion-col\", 9);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(20, \"core-loading\", 10);\n      i0.ɵɵtemplate(21, CoreTagSearchPage_core_empty_box_21_Template, 2, 6, \"core-empty-box\", 11);\n      i0.ɵɵtemplate(22, CoreTagSearchPage_ng_container_22_Template, 4, 2, \"ng-container\", 12);\n      i0.ɵɵelementEnd()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"text\", i0.ɵɵpipeBind1(4, 14, \"core.back\"));\n      i0.ɵɵadvance(4);\n      i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(8, 16, \"core.tag.searchtags\"));\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"disabled\", !ctx.loaded);\n      i0.ɵɵadvance(1);\n      i0.ɵɵpropertyInterpolate(\"pullingText\", i0.ɵɵpipeBind1(14, 18, \"core.pulltorefresh\"));\n      i0.ɵɵadvance(4);\n      i0.ɵɵattribute(\"col-sm-6\", ctx.collections && ctx.collections.length > 1 ? \"\" : null);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"initialSearch\", ctx.query)(\"disabled\", ctx.searching)(\"spellcheck\", false)(\"autoFocus\", false)(\"lengthCheck\", 0);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.collections && ctx.collections.length > 1);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"hideUntil\", ctx.loaded && !ctx.searching);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", !ctx.cloud || !ctx.cloud.tags || !ctx.cloud.tags.length);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.cloud && ctx.cloud.tags && ctx.cloud.tags.length > 0);\n    }\n  },\n  dependencies: [i1.NgForOf, i1.NgIf, i2.CoreEmptyBoxComponent, i3.CoreLoadingComponent, i4.CoreComboboxComponent, i5.CoreContentDirective, i6.IonBadge, i6.IonButtons, i6.IonCol, i6.IonContent, i6.IonGrid, i6.IonHeader, i6.IonRefresher, i6.IonRefresherContent, i6.IonRow, i6.IonSelectOption, i6.IonTitle, i6.IonToolbar, i6.IonBackButton, i7.CoreSearchBoxComponent, i8.CoreMainMenuUserButtonComponent, i9.TranslatePipe],\n  styles: [\"[_nghost-%COMP%]   core-search-box[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%] {\\n  width: 100% !important;\\n  margin: 0 !important;\\n}\\n[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%] {\\n  margin: 8px;\\n  cursor: pointer;\\n}\\n[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size20[_ngcontent-%COMP%] {\\n  font-size: 3.4rem;\\n}\\n[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size19[_ngcontent-%COMP%] {\\n  font-size: 3.3rem;\\n}\\n[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size18[_ngcontent-%COMP%] {\\n  font-size: 3.2rem;\\n}\\n[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size17[_ngcontent-%COMP%] {\\n  font-size: 3.1rem;\\n}\\n[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size16[_ngcontent-%COMP%] {\\n  font-size: 3rem;\\n}\\n[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size15[_ngcontent-%COMP%] {\\n  font-size: 2.9rem;\\n}\\n[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size14[_ngcontent-%COMP%] {\\n  font-size: 2.8rem;\\n}\\n[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size13[_ngcontent-%COMP%] {\\n  font-size: 2.7rem;\\n}\\n[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size12[_ngcontent-%COMP%] {\\n  font-size: 2.6rem;\\n}\\n[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size11[_ngcontent-%COMP%] {\\n  font-size: 2.5rem;\\n}\\n[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size10[_ngcontent-%COMP%] {\\n  font-size: 2.4rem;\\n}\\n[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size9[_ngcontent-%COMP%] {\\n  font-size: 2.3rem;\\n}\\n[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size8[_ngcontent-%COMP%] {\\n  font-size: 2.2rem;\\n}\\n[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size7[_ngcontent-%COMP%] {\\n  font-size: 2.1rem;\\n}\\n[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size6[_ngcontent-%COMP%] {\\n  font-size: 2rem;\\n}\\n[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size5[_ngcontent-%COMP%] {\\n  font-size: 1.9rem;\\n}\\n[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size4[_ngcontent-%COMP%] {\\n  font-size: 1.8rem;\\n}\\n[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size3[_ngcontent-%COMP%] {\\n  font-size: 1.7rem;\\n}\\n[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size2[_ngcontent-%COMP%] {\\n  font-size: 1.6rem;\\n}\\n[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size1[_ngcontent-%COMP%] {\\n  font-size: 1.5rem;\\n}\\n[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size0[_ngcontent-%COMP%] {\\n  font-size: 1.4rem;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9jb3JlL2ZlYXR1cmVzL3RhZy9wYWdlcy9zZWFyY2gvc2VhcmNoLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0k7RUFDSSxzQkFBQTtFQUNBLG9CQUFBO0FBQVI7QUFHSTtFQUNJLFdBQUE7RUFDQSxlQUFBO0FBRFI7QUFHUTtFQUNJLGlCQUFBO0FBRFo7QUFJUTtFQUNJLGlCQUFBO0FBRlo7QUFLUTtFQUNJLGlCQUFBO0FBSFo7QUFNUTtFQUNJLGlCQUFBO0FBSlo7QUFPUTtFQUNJLGVBQUE7QUFMWjtBQVFRO0VBQ0ksaUJBQUE7QUFOWjtBQVNRO0VBQ0ksaUJBQUE7QUFQWjtBQVVRO0VBQ0ksaUJBQUE7QUFSWjtBQVdRO0VBQ0ksaUJBQUE7QUFUWjtBQVlRO0VBQ0ksaUJBQUE7QUFWWjtBQWFRO0VBQ0ksaUJBQUE7QUFYWjtBQWNRO0VBQ0ksaUJBQUE7QUFaWjtBQWVRO0VBQ0ksaUJBQUE7QUFiWjtBQWdCUTtFQUNJLGlCQUFBO0FBZFo7QUFpQlE7RUFDSSxlQUFBO0FBZlo7QUFrQlE7RUFDSSxpQkFBQTtBQWhCWjtBQW1CUTtFQUNJLGlCQUFBO0FBakJaO0FBb0JRO0VBQ0ksaUJBQUE7QUFsQlo7QUFxQlE7RUFDSSxpQkFBQTtBQW5CWjtBQXNCUTtFQUNJLGlCQUFBO0FBcEJaO0FBdUJRO0VBQ0ksaUJBQUE7QUFyQloiLCJzb3VyY2VzQ29udGVudCI6WyI6aG9zdCB7XG4gICAgY29yZS1zZWFyY2gtYm94IGlvbi1jYXJkIHtcbiAgICAgICAgd2lkdGg6IDEwMCUgIWltcG9ydGFudDtcbiAgICAgICAgbWFyZ2luOiAwICFpbXBvcnRhbnQ7XG4gICAgfVxuXG4gICAgLmNvcmUtdGFnLWNsb3VkIGlvbi1iYWRnZSB7XG4gICAgICAgIG1hcmdpbjogOHB4O1xuICAgICAgICBjdXJzb3I6IHBvaW50ZXI7XG5cbiAgICAgICAgLnNpemUyMCB7XG4gICAgICAgICAgICBmb250LXNpemU6IDMuNHJlbTtcbiAgICAgICAgfVxuXG4gICAgICAgIC5zaXplMTkge1xuICAgICAgICAgICAgZm9udC1zaXplOiAzLjNyZW07XG4gICAgICAgIH1cblxuICAgICAgICAuc2l6ZTE4IHtcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogMy4ycmVtO1xuICAgICAgICB9XG5cbiAgICAgICAgLnNpemUxNyB7XG4gICAgICAgICAgICBmb250LXNpemU6IDMuMXJlbTtcbiAgICAgICAgfVxuXG4gICAgICAgIC5zaXplMTYge1xuICAgICAgICAgICAgZm9udC1zaXplOiAzcmVtO1xuICAgICAgICB9XG5cbiAgICAgICAgLnNpemUxNSB7XG4gICAgICAgICAgICBmb250LXNpemU6IDIuOXJlbTtcbiAgICAgICAgfVxuXG4gICAgICAgIC5zaXplMTQge1xuICAgICAgICAgICAgZm9udC1zaXplOiAyLjhyZW07XG4gICAgICAgIH1cblxuICAgICAgICAuc2l6ZTEzIHtcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogMi43cmVtO1xuICAgICAgICB9XG5cbiAgICAgICAgLnNpemUxMiB7XG4gICAgICAgICAgICBmb250LXNpemU6IDIuNnJlbTtcbiAgICAgICAgfVxuXG4gICAgICAgIC5zaXplMTEge1xuICAgICAgICAgICAgZm9udC1zaXplOiAyLjVyZW07XG4gICAgICAgIH1cblxuICAgICAgICAuc2l6ZTEwIHtcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogMi40cmVtO1xuICAgICAgICB9XG5cbiAgICAgICAgLnNpemU5IHtcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogMi4zcmVtO1xuICAgICAgICB9XG5cbiAgICAgICAgLnNpemU4IHtcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogMi4ycmVtO1xuICAgICAgICB9XG5cbiAgICAgICAgLnNpemU3IHtcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogMi4xcmVtO1xuICAgICAgICB9XG5cbiAgICAgICAgLnNpemU2IHtcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogMnJlbTtcbiAgICAgICAgfVxuXG4gICAgICAgIC5zaXplNSB7XG4gICAgICAgICAgICBmb250LXNpemU6IDEuOXJlbTtcbiAgICAgICAgfVxuXG4gICAgICAgIC5zaXplNCB7XG4gICAgICAgICAgICBmb250LXNpemU6IDEuOHJlbTtcbiAgICAgICAgfVxuXG4gICAgICAgIC5zaXplMyB7XG4gICAgICAgICAgICBmb250LXNpemU6IDEuN3JlbTtcbiAgICAgICAgfVxuXG4gICAgICAgIC5zaXplMiB7XG4gICAgICAgICAgICBmb250LXNpemU6IDEuNnJlbTtcbiAgICAgICAgfVxuXG4gICAgICAgIC5zaXplMSB7XG4gICAgICAgICAgICBmb250LXNpemU6IDEuNXJlbTtcbiAgICAgICAgfVxuXG4gICAgICAgIC5zaXplMCB7XG4gICAgICAgICAgICBmb250LXNpemU6IDEuNHJlbTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0= */\"]\n});","map":{"version":3,"names":["CoreApp","CoreDomUtils","CoreUtils","CoreTextUtils","CoreTag","Translate","CoreContentLinksHelper","CoreNavigator","CoreMainMenuDeepLinkManager","CoreTime","CoreAnalytics","CoreAnalyticsEventType","i0","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵproperty","collection_r4","id","ɵɵadvance","ɵɵtextInterpolate1","name","ɵɵlistener","CoreTagSearchPage_ion_col_19_Template_core_combobox_onChange_1_listener","$event","ɵɵrestoreView","_r6","ctx_r5","ɵɵnextContext","ɵɵresetView","searchTags","query","ɵɵtemplate","CoreTagSearchPage_ion_col_19_ion_select_option_5_Template","ctx_r0","collectionId","searching","ɵɵpipeBind1","collections","ɵɵelement","ɵɵpipeBind2","ɵɵpureFunction1","_c0","ctx_r1","CoreTagSearchPage_ng_container_22_ion_badge_2_Template_ion_badge_click_0_listener","restoredCtx","_r11","tag_r9","$implicit","ctx_r10","openTag","ɵɵclassMap","size","ɵɵtextInterpolate","ctx_r8","cloud","tags","length","ɵɵelementContainerStart","CoreTagSearchPage_ng_container_22_ion_badge_2_Template","CoreTagSearchPage_ng_container_22_p_3_Template","ɵɵelementContainerEnd","ctx_r2","totalcount","CoreTagSearchPage","constructor","loaded","logView","once","_asyncToGenerator","logEvent","type","VIEW_ITEM_LIST","ws","instant","data","category","url","ngOnInit","getRouteNumberParam","getRouteParam","deepLinkManager","treatLink","fetchData","finally","_this","Promise","all","fetchCollections","fetchTags","error","showErrorModalDefault","_this2","getTagCollections","forEach","collection","isdefault","_this3","_this3$logSearch","getTagCloud","undefined","logSearch","call","tag","decodeURI","viewurl","handleLink","refreshData","refresher","allPromises","invalidateTagCollections","invalidateTagCloud","complete","performLogSearch","closeKeyboard","catch","_this4","selectors","decls","vars","consts","template","CoreTagSearchPage_Template","rf","ctx","CoreTagSearchPage_Template_ion_refresher_ionRefresh_12_listener","target","CoreTagSearchPage_Template_core_search_box_onSubmit_18_listener","CoreTagSearchPage_Template_core_search_box_onClear_18_listener","CoreTagSearchPage_ion_col_19_Template","CoreTagSearchPage_core_empty_box_21_Template","CoreTagSearchPage_ng_container_22_Template","ɵɵpropertyInterpolate","ɵɵattribute"],"sources":["/home/toon/works/gitionic7/ionic-github/ionic/src/core/features/tag/pages/search/search.ts","/home/toon/works/gitionic7/ionic-github/ionic/src/core/features/tag/pages/search/search.html"],"sourcesContent":["// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Component, OnInit } from '@angular/core';\n\nimport { CoreApp } from '@services/app';\nimport { CoreDomUtils } from '@services/utils/dom';\nimport { CoreUtils } from '@services/utils/utils';\nimport { CoreTextUtils } from '@services/utils/text';\nimport { CoreTagCloud, CoreTagCollection, CoreTagCloudTag, CoreTag } from '@features/tag/services/tag';\nimport { Translate } from '@singletons';\nimport { CoreContentLinksHelper } from '@features/contentlinks/services/contentlinks-helper';\nimport { CoreNavigator } from '@services/navigator';\nimport { CoreMainMenuDeepLinkManager } from '@features/mainmenu/classes/deep-link-manager';\nimport { CoreTime } from '@singletons/time';\nimport { CoreAnalytics, CoreAnalyticsEventType } from '@services/analytics';\n\n/**\n * Page that displays most used tags and allows searching.\n */\n@Component({\n    selector: 'page-core-tag-search',\n    templateUrl: 'search.html',\n    styleUrls: ['search.scss'],\n})\nexport class CoreTagSearchPage implements OnInit {\n\n    collectionId!: number;\n    query!: string;\n    collections: CoreTagCollection[] = [];\n    cloud?: CoreTagCloud;\n    loaded = false;\n    searching = false;\n\n    protected logView: () => void;\n    protected logSearch?: () => void;\n\n    constructor() {\n        this.logView = CoreTime.once(async () => {\n            CoreAnalytics.logEvent({\n                type: CoreAnalyticsEventType.VIEW_ITEM_LIST,\n                ws: 'core_tag_get_tag_cloud',\n                name: Translate.instant('core.tag.searchtags'),\n                data: { category: 'tag' },\n                url: '/tag/search.php',\n            });\n        });\n    }\n\n    /**\n     * View loaded.\n     */\n    ngOnInit(): void {\n        this.collectionId = CoreNavigator.getRouteNumberParam('collectionId') || 0;\n        this.query = CoreNavigator.getRouteParam('query') || '';\n\n        const deepLinkManager = new CoreMainMenuDeepLinkManager();\n        deepLinkManager.treatLink();\n\n        this.fetchData().finally(() => {\n            this.loaded = true;\n        });\n    }\n\n    async fetchData(): Promise<void> {\n        try {\n            await Promise.all([\n                this.fetchCollections(),\n                this.fetchTags(),\n            ]);\n\n            if (!this.query) {\n                this.logView();\n            }\n        } catch (error) {\n            CoreDomUtils.showErrorModalDefault(error, 'Error loading tags.');\n        }\n    }\n\n    /**\n     * Fetch tag collections.\n     *\n     * @returns Resolved when done.\n     */\n    async fetchCollections(): Promise<void> {\n        const collections = await CoreTag.getTagCollections();\n\n        collections.forEach((collection) => {\n            if (!collection.name && collection.isdefault) {\n                collection.name = Translate.instant('core.tag.defautltagcoll');\n            }\n        });\n\n        this.collections = collections;\n    }\n\n    /**\n     * Fetch tags.\n     *\n     * @returns Resolved when done.\n     */\n    async fetchTags(): Promise<void> {\n        this.cloud = await CoreTag.getTagCloud(this.collectionId, undefined, undefined, this.query);\n\n        this.logSearch?.();\n    }\n\n    /**\n     * Go to tag index page.\n     */\n    openTag(tag: CoreTagCloudTag): void {\n        const url = CoreTextUtils.decodeURI(tag.viewurl);\n        CoreContentLinksHelper.handleLink(url);\n    }\n\n    /**\n     * Refresh data.\n     *\n     * @param refresher Refresher event.\n     */\n    refreshData(refresher?: HTMLIonRefresherElement): void {\n        CoreUtils.allPromises([\n            CoreTag.invalidateTagCollections(),\n            CoreTag.invalidateTagCloud(this.collectionId, undefined, undefined, this.query),\n        ]).finally(() => this.fetchData().finally(() => {\n            refresher?.complete();\n        }));\n    }\n\n    /**\n     * Search tags.\n     *\n     * @param query Search query.\n     * @param collectionId Collection ID to use.\n     * @returns Resolved when done.\n     */\n    searchTags(query: string, collectionId?: number): Promise<void> {\n        this.searching = true;\n        this.query = query;\n        if (collectionId !== undefined) {\n            this.collectionId = collectionId;\n        }\n\n        this.logSearch = CoreTime.once(() => this.performLogSearch());\n        CoreApp.closeKeyboard();\n\n        return this.fetchTags().catch((error) => {\n            CoreDomUtils.showErrorModalDefault(error, 'Error loading tags.');\n        }).finally(() => {\n            this.searching = false;\n        });\n    }\n\n    /**\n     * Log search.\n     */\n    protected async performLogSearch(): Promise<void> {\n        if (!this.query) {\n            return;\n        }\n\n        CoreAnalytics.logEvent({\n            type: CoreAnalyticsEventType.VIEW_ITEM_LIST,\n            ws: 'core_tag_get_tag_cloud',\n            name: Translate.instant('core.tag.searchtags'),\n            data: { category: 'tag' },\n            url: `/tag/search.php&query=${this.query}&tc=${this.collectionId}&go=${Translate.instant('core.search')}`,\n        });\n    }\n\n}\n","<ion-header>\n    <ion-toolbar>\n        <ion-buttons slot=\"start\">\n            <ion-back-button [text]=\"'core.back' | translate\" />\n        </ion-buttons>\n        <ion-title>\n            <h1>{{ 'core.tag.searchtags' | translate }}</h1>\n        </ion-title>\n        <ion-buttons slot=\"end\">\n            <core-user-menu-button />\n        </ion-buttons>\n    </ion-toolbar>\n</ion-header>\n<ion-content>\n    <ion-refresher slot=\"fixed\" [disabled]=\"!loaded\" (ionRefresh)=\"refreshData($event.target)\">\n        <ion-refresher-content pullingText=\"{{ 'core.pulltorefresh' | translate }}\" />\n    </ion-refresher>\n    <ion-grid class=\"safe-area-padding\">\n        <ion-row class=\"ion-no-padding ion-wrap\">\n            <ion-col class=\"ion-no-padding\" size=\"12\" size-sm=\"6\" [attr.col-sm-6]=\"collections && collections.length > 1 ? '' : null\">\n                <core-search-box (onSubmit)=\"searchTags($event)\" (onClear)=\"searchTags('')\" [initialSearch]=\"query\" [disabled]=\"searching\"\n                    autocorrect=\"off\" [spellcheck]=\"false\" [autoFocus]=\"false\" [lengthCheck]=\"0\" searchArea=\"CoreTag\" />\n            </ion-col>\n            <ion-col class=\"ion-no-padding\" size=\"12\" size-sm=\"6\" *ngIf=\"collections && collections.length > 1\">\n                <core-combobox [selection]=\"collectionId\" (onChange)=\"searchTags(query, $event)\" [disabled]=\"searching\">\n                    <ion-select-option class=\"ion-text-wrap\" [value]=\"0\">\n                        {{ 'core.tag.inalltagcoll' | translate }}\n                    </ion-select-option>\n                    <ion-select-option class=\"ion-text-wrap\" *ngFor=\"let collection of collections\" [value]=\"collection.id\">\n                        {{ collection.name }}</ion-select-option>\n                </core-combobox>\n            </ion-col>\n        </ion-row>\n    </ion-grid>\n    <core-loading [hideUntil]=\"loaded && !searching\">\n        <core-empty-box *ngIf=\"!cloud || !cloud!.tags || !cloud!.tags.length\" icon=\"fas-tags\"\n            [message]=\"'core.tag.notagsfound' | translate: {$a: query}\" />\n\n        <ng-container *ngIf=\"cloud && cloud!.tags && cloud!.tags.length > 0\">\n            <div class=\"ion-text-center core-tag-cloud\">\n                <ion-badge *ngFor=\"let tag of cloud!.tags\" (click)=\"openTag(tag)\" class=\"ion-text-wrap\">\n                    <span [class]=\"'size' + tag.size\">{{ tag.name }}</span>\n                </ion-badge>\n            </div>\n            <p *ngIf=\"cloud!.tags.length < cloud!.totalcount\" class=\"ion-text-center\">\n                {{ 'core.tag.showingfirsttags' | translate: {$a: cloud!.tags.length} }}\n            </p>\n        </ng-container>\n    </core-loading>\n</ion-content>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"import _asyncToGenerator from \"/home/toon/works/gitionic7/ionic-github/ionic/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _class;\nimport { Validators, FormControl } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\n/**\n * Base class for components to render a user profile field.\n */\nexport class CoreUserProfileFieldBaseComponent {\n  constructor() {\n    this.signup = false; // True if editing the field in signup. Defaults to false.\n    this.edit = false; // True if editing the field. Defaults to false.\n    this.disabled = false; // True if disabled. Defaults to false.\n    this.modelName = '';\n  }\n  /**\n   * @inheritdoc\n   */\n  ngOnInit() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      if (!_this.field) {\n        return;\n      }\n      if (!_this.edit && 'value' in _this.field) {\n        _this.initForNonEdit(_this.field);\n        return;\n      }\n      if (_this.edit && 'required' in _this.field) {\n        _this.initForEdit(_this.field);\n        return;\n      }\n    })();\n  }\n  /**\n   * Init the data when the field is meant to be displayed without editing.\n   *\n   * @param field Field to render.\n   */\n  initForNonEdit(field) {\n    var _field$displayvalue;\n    this.value = (_field$displayvalue = field.displayvalue) !== null && _field$displayvalue !== void 0 ? _field$displayvalue : field.value;\n    this.valueNotFiltered = field.displayvalue === undefined || field.displayvalue === null;\n  }\n  /**\n   * Init the data when the field is meant to be displayed for editing.\n   *\n   * @param field Field to render.\n   */\n  initForEdit(field) {\n    var _this$form;\n    this.modelName = 'profile_field_' + field.shortname;\n    this.required = !!field.required;\n    this.control = this.createFormControl(field);\n    (_this$form = this.form) === null || _this$form === void 0 || _this$form.addControl(this.modelName, this.control);\n  }\n  /**\n   * Create the Form control.\n   *\n   * @returns Form control.\n   */\n  createFormControl(field) {\n    const formData = {\n      value: field.defaultdata,\n      disabled: this.disabled\n    };\n    return new FormControl(formData, this.required && !field.locked ? Validators.required : null);\n  }\n}\n_class = CoreUserProfileFieldBaseComponent;\n_class.ɵfac = function CoreUserProfileFieldBaseComponent_Factory(t) {\n  return new (t || _class)();\n};\n_class.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: _class,\n  selectors: [[\"ng-component\"]],\n  inputs: {\n    field: \"field\",\n    signup: \"signup\",\n    edit: \"edit\",\n    disabled: \"disabled\",\n    form: \"form\",\n    registerAuth: \"registerAuth\",\n    contextLevel: \"contextLevel\",\n    contextInstanceId: \"contextInstanceId\",\n    courseId: \"courseId\"\n  },\n  decls: 0,\n  vars: 0,\n  template: function CoreUserProfileFieldBaseComponent_Template(rf, ctx) {},\n  encapsulation: 2\n});","map":{"version":3,"names":["Validators","FormControl","CoreUserProfileFieldBaseComponent","constructor","signup","edit","disabled","modelName","ngOnInit","_this","_asyncToGenerator","field","initForNonEdit","initForEdit","_field$displayvalue","value","displayvalue","valueNotFiltered","undefined","_this$form","shortname","required","control","createFormControl","form","addControl","formData","defaultdata","locked","selectors","inputs","registerAuth","contextLevel","contextInstanceId","courseId","decls","vars","template","CoreUserProfileFieldBaseComponent_Template","rf","ctx","encapsulation"],"sources":["/home/toon/works/gitionic7/ionic-github/ionic/src/core/features/user/classes/base-profilefield-component.ts"],"sourcesContent":["// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Component, Input, OnInit } from '@angular/core';\nimport { FormGroup, Validators, FormControl } from '@angular/forms';\n\nimport { AuthEmailSignupProfileField } from '@features/login/services/login-helper';\nimport { CoreUserProfileField } from '@features/user/services/user';\n\n/**\n * Base class for components to render a user profile field.\n */\n@Component({\n    template: '',\n})\nexport abstract class CoreUserProfileFieldBaseComponent implements OnInit {\n\n    @Input() field?: AuthEmailSignupProfileField | CoreUserProfileField; // The profile field to be rendered.\n    @Input() signup = false; // True if editing the field in signup. Defaults to false.\n    @Input() edit = false; // True if editing the field. Defaults to false.\n    @Input() disabled = false; // True if disabled. Defaults to false.\n    @Input() form?: FormGroup; // Form where to add the form control. Required if edit=true or signup=true.\n    @Input() registerAuth?: string; // Register auth method. E.g. 'email'.\n    @Input() contextLevel?: string; // The context level.\n    @Input() contextInstanceId?: number; // The instance ID related to the context.\n    @Input() courseId?: number; // Course ID the field belongs to (if any). It can be used to improve performance with filters.\n\n    control?: FormControl;\n    modelName = '';\n    value?: string;\n    required?: boolean;\n    valueNotFiltered?: boolean;\n\n    /**\n     * @inheritdoc\n     */\n    async ngOnInit(): Promise<void> {\n        if (!this.field) {\n            return;\n        }\n\n        if (!this.edit && 'value' in this.field) {\n            this.initForNonEdit(this.field);\n\n            return;\n        }\n\n        if (this.edit && 'required' in this.field) {\n            this.initForEdit(this.field);\n\n            return;\n        }\n    }\n\n    /**\n     * Init the data when the field is meant to be displayed without editing.\n     *\n     * @param field Field to render.\n     */\n    protected initForNonEdit(field: CoreUserProfileField): void {\n        this.value = field.displayvalue ?? field.value;\n        this.valueNotFiltered = field.displayvalue === undefined || field.displayvalue === null;\n    }\n\n    /**\n     * Init the data when the field is meant to be displayed for editing.\n     *\n     * @param field Field to render.\n     */\n    protected initForEdit(field: AuthEmailSignupProfileField): void {\n        this.modelName = 'profile_field_' + field.shortname;\n        this.required = !!field.required;\n\n        this.control = this.createFormControl(field);\n        this.form?.addControl(this.modelName, this.control);\n    }\n\n    /**\n     * Create the Form control.\n     *\n     * @returns Form control.\n     */\n    protected createFormControl(field: AuthEmailSignupProfileField): FormControl {\n        const formData = {\n            value: field.defaultdata,\n            disabled: this.disabled,\n        };\n\n        return new FormControl(formData, this.required && !field.locked ? Validators.required : null);\n    }\n\n}\n"],"mappings":";;AAeA,SAAoBA,UAAU,EAAEC,WAAW,QAAQ,gBAAgB;;AAKnE;;;AAMA,OAAM,MAAgBC,iCAAiC;EAHvDC,YAAA;IAMa,KAAAC,MAAM,GAAG,KAAK,CAAC,CAAC;IAChB,KAAAC,IAAI,GAAG,KAAK,CAAC,CAAC;IACd,KAAAC,QAAQ,GAAG,KAAK,CAAC,CAAC;IAQ3B,KAAAC,SAAS,GAAG,EAAE;;EAKd;;;EAGMC,QAAQA,CAAA;IAAA,IAAAC,KAAA;IAAA,OAAAC,iBAAA;MACV,IAAI,CAACD,KAAI,CAACE,KAAK,EAAE;QACb;;MAGJ,IAAI,CAACF,KAAI,CAACJ,IAAI,IAAI,OAAO,IAAII,KAAI,CAACE,KAAK,EAAE;QACrCF,KAAI,CAACG,cAAc,CAACH,KAAI,CAACE,KAAK,CAAC;QAE/B;;MAGJ,IAAIF,KAAI,CAACJ,IAAI,IAAI,UAAU,IAAII,KAAI,CAACE,KAAK,EAAE;QACvCF,KAAI,CAACI,WAAW,CAACJ,KAAI,CAACE,KAAK,CAAC;QAE5B;;IACH;EACL;EAEA;;;;;EAKUC,cAAcA,CAACD,KAA2B;IAAA,IAAAG,mBAAA;IAChD,IAAI,CAACC,KAAK,IAAAD,mBAAA,GAAGH,KAAK,CAACK,YAAY,cAAAF,mBAAA,cAAAA,mBAAA,GAAIH,KAAK,CAACI,KAAK;IAC9C,IAAI,CAACE,gBAAgB,GAAGN,KAAK,CAACK,YAAY,KAAKE,SAAS,IAAIP,KAAK,CAACK,YAAY,KAAK,IAAI;EAC3F;EAEA;;;;;EAKUH,WAAWA,CAACF,KAAkC;IAAA,IAAAQ,UAAA;IACpD,IAAI,CAACZ,SAAS,GAAG,gBAAgB,GAAGI,KAAK,CAACS,SAAS;IACnD,IAAI,CAACC,QAAQ,GAAG,CAAC,CAACV,KAAK,CAACU,QAAQ;IAEhC,IAAI,CAACC,OAAO,GAAG,IAAI,CAACC,iBAAiB,CAACZ,KAAK,CAAC;IAC5C,CAAAQ,UAAA,OAAI,CAACK,IAAI,cAAAL,UAAA,eAATA,UAAA,CAAWM,UAAU,CAAC,IAAI,CAAClB,SAAS,EAAE,IAAI,CAACe,OAAO,CAAC;EACvD;EAEA;;;;;EAKUC,iBAAiBA,CAACZ,KAAkC;IAC1D,MAAMe,QAAQ,GAAG;MACbX,KAAK,EAAEJ,KAAK,CAACgB,WAAW;MACxBrB,QAAQ,EAAE,IAAI,CAACA;KAClB;IAED,OAAO,IAAIL,WAAW,CAACyB,QAAQ,EAAE,IAAI,CAACL,QAAQ,IAAI,CAACV,KAAK,CAACiB,MAAM,GAAG5B,UAAU,CAACqB,QAAQ,GAAG,IAAI,CAAC;EACjG;;SA1EkBnB,iCAAiC;;mBAAjCA,MAAiC;AAAA;;QAAjCA,MAAiC;EAAA2B,SAAA;EAAAC,MAAA;IAAAnB,KAAA;IAAAP,MAAA;IAAAC,IAAA;IAAAC,QAAA;IAAAkB,IAAA;IAAAO,YAAA;IAAAC,YAAA;IAAAC,iBAAA;IAAAC,QAAA;EAAA;EAAAC,KAAA;EAAAC,IAAA;EAAAC,QAAA,WAAAC,2CAAAC,EAAA,EAAAC,GAAA;EAAAC,aAAA;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"import _asyncToGenerator from \"/home/toon/works/gitionic7/ionic-github/ionic/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _class;\nimport { CoreQuestionBaseComponent } from '@features/question/classes/base-question-component';\nimport { CoreQuestionHelper } from '@features/question/services/question-helper';\nimport { CoreFilepool } from '@services/filepool';\nimport { CoreSites } from '@services/sites';\nimport { CoreDomUtils } from '@services/utils/dom';\nimport { AddonQtypeDdMarkerQuestion } from '../classes/ddmarker';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nimport * as i2 from \"../../../../core/components/loading/loading\";\nimport * as i3 from \"../../../../core/directives/fa-icon\";\nimport * as i4 from \"../../../../core/directives/format-text\";\nimport * as i5 from \"@ionic/angular\";\nimport * as i6 from \"@ngx-translate/core\";\nconst _c0 = [\"questiontext\"];\nfunction AddonQtypeDdMarkerComponent_div_0_ion_card_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-card\", 9)(1, \"ion-item\");\n    i0.ɵɵelement(2, \"ion-icon\", 10);\n    i0.ɵɵelementStart(3, \"ion-label\");\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"translate\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(5, 1, \"core.question.howtodraganddrop\"));\n  }\n}\nfunction AddonQtypeDdMarkerComponent_div_0_core_format_text_8_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"core-format-text\", 11);\n    i0.ɵɵlistener(\"afterRender\", function AddonQtypeDdMarkerComponent_div_0_core_format_text_8_Template_core_format_text_afterRender_0_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r4 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r4.ddAreaRendered());\n    });\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"adaptImg\", false)(\"component\", ctx_r3.component)(\"componentId\", ctx_r3.componentId)(\"text\", ctx_r3.question.ddArea)(\"filter\", false);\n  }\n}\nfunction AddonQtypeDdMarkerComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 1);\n    i0.ɵɵelement(1, \"core-loading\", 2);\n    i0.ɵɵelementStart(2, \"ion-item\", 3)(3, \"ion-label\");\n    i0.ɵɵtemplate(4, AddonQtypeDdMarkerComponent_div_0_ion_card_4_Template, 6, 3, \"ion-card\", 4);\n    i0.ɵɵelementStart(5, \"core-format-text\", 5, 6);\n    i0.ɵɵlistener(\"afterRender\", function AddonQtypeDdMarkerComponent_div_0_Template_core_format_text_afterRender_5_listener() {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r6 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r6.textRendered());\n    });\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(7, \"div\", 7);\n    i0.ɵɵtemplate(8, AddonQtypeDdMarkerComponent_div_0_core_format_text_8_Template, 1, 5, \"core-format-text\", 8);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"hideUntil\", ctx_r0.question.loaded);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"hidden\", !ctx_r0.question.loaded);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r0.question.readOnly);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"component\", ctx_r0.component)(\"componentId\", ctx_r0.componentId)(\"text\", ctx_r0.question.text)(\"contextLevel\", ctx_r0.contextLevel)(\"contextInstanceId\", ctx_r0.contextInstanceId)(\"courseId\", ctx_r0.courseId);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"hidden\", !ctx_r0.question.loaded);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.question.ddArea);\n  }\n}\n/**\n * Component to render a drag-and-drop markers question.\n */\nexport class AddonQtypeDdMarkerComponent extends CoreQuestionBaseComponent {\n  constructor(elementRef) {\n    super('AddonQtypeDdMarkerComponent', elementRef);\n    this.dropZones = []; // The drop zones received in the init object of the question.\n    this.destroyed = false;\n    this.textIsRendered = false;\n    this.ddAreaisRendered = false;\n  }\n  /**\n   * @inheritdoc\n   */\n  init() {\n    if (!this.question) {\n      return;\n    }\n    const questionElement = this.initComponent();\n    if (!questionElement) {\n      return;\n    }\n    // Get D&D area, form and question text.\n    const ddArea = questionElement.querySelector('.ddarea');\n    const ddForm = questionElement.querySelector('.ddform');\n    if (!ddArea || !ddForm) {\n      this.logger.warn('Aborting because of an error parsing question.', this.question.slot);\n      return CoreQuestionHelper.showComponentError(this.onAbort);\n    }\n    // Build the D&D area HTML.\n    this.question.ddArea = ddArea.outerHTML;\n    const wrongParts = questionElement.querySelector('.wrongparts');\n    if (wrongParts) {\n      this.question.ddArea += wrongParts.outerHTML;\n    }\n    this.question.ddArea += ddForm.outerHTML;\n    this.question.readOnly = false;\n    if (this.question.initObjects) {\n      // Moodle version = 3.5.\n      if (this.question.initObjects.dropzones !== undefined) {\n        this.dropZones = this.question.initObjects.dropzones;\n      }\n      if (this.question.initObjects.readonly !== undefined) {\n        this.question.readOnly = !!this.question.initObjects.readonly;\n      }\n    } else if (this.question.amdArgs) {\n      // Moodle version >= 3.6.\n      let nextIndex = 1;\n      // Moodle version >= 3.9, imgSrc is not specified, do not advance index.\n      if (this.question.amdArgs[nextIndex] !== undefined && typeof this.question.amdArgs[nextIndex] !== 'boolean') {\n        this.imgSrc = this.question.amdArgs[nextIndex];\n        nextIndex++;\n      }\n      if (this.question.amdArgs[nextIndex] !== undefined) {\n        this.question.readOnly = !!this.question.amdArgs[nextIndex];\n      }\n      nextIndex++;\n      if (this.question.amdArgs[nextIndex] !== undefined) {\n        this.dropZones = this.question.amdArgs[nextIndex];\n      }\n    }\n    this.question.loaded = false;\n  }\n  /**\n   * The question ddArea has been rendered.\n   */\n  ddAreaRendered() {\n    this.ddAreaisRendered = true;\n    if (this.textIsRendered) {\n      this.questionRendered();\n    }\n  }\n  /**\n   * The question text has been rendered.\n   */\n  textRendered() {\n    this.textIsRendered = true;\n    if (this.ddAreaisRendered) {\n      this.questionRendered();\n    }\n  }\n  /**\n   * The question has been rendered.\n   */\n  questionRendered() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      if (_this.destroyed || !_this.question) {\n        return;\n      }\n      // Download background image (3.6+ sites).\n      let imgSrc = _this.imgSrc;\n      const site = CoreSites.getCurrentSite();\n      if (_this.imgSrc && site !== null && site !== void 0 && site.canDownloadFiles() && site.isSitePluginFileUrl(_this.imgSrc)) {\n        imgSrc = yield CoreFilepool.getSrcByUrl(site.getId(), _this.imgSrc, _this.component, _this.componentId, 0, true, true);\n      }\n      if (_this.questionTextEl) {\n        yield CoreDomUtils.waitForImages(_this.questionTextEl.nativeElement);\n      }\n      // Create the instance.\n      _this.questionInstance = new AddonQtypeDdMarkerQuestion(_this.hostElement, _this.question, !!_this.question.readOnly, _this.dropZones, imgSrc);\n    })();\n  }\n  /**\n   * @inheritdoc\n   */\n  ngOnDestroy() {\n    var _this$questionInstanc;\n    this.destroyed = true;\n    (_this$questionInstanc = this.questionInstance) === null || _this$questionInstanc === void 0 || _this$questionInstanc.destroy();\n  }\n}\n_class = AddonQtypeDdMarkerComponent;\n_class.ɵfac = function AddonQtypeDdMarkerComponent_Factory(t) {\n  return new (t || _class)(i0.ɵɵdirectiveInject(i0.ElementRef));\n};\n_class.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: _class,\n  selectors: [[\"addon-qtype-ddmarker\"]],\n  viewQuery: function AddonQtypeDdMarkerComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(_c0, 5);\n    }\n    if (rf & 2) {\n      let _t;\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.questionTextEl = _t.first);\n    }\n  },\n  features: [i0.ɵɵInheritDefinitionFeature],\n  decls: 1,\n  vars: 1,\n  consts: [[\"class\", \"addon-qtype-ddmarker-container\", 4, \"ngIf\"], [1, \"addon-qtype-ddmarker-container\"], [3, \"hideUntil\"], [1, \"ion-text-wrap\", 3, \"hidden\"], [\"class\", \"core-info-card\", 4, \"ngIf\"], [3, \"component\", \"componentId\", \"text\", \"contextLevel\", \"contextInstanceId\", \"courseId\", \"afterRender\"], [\"questiontext\", \"\"], [1, \"fake-ion-item\", \"ion-text-wrap\", 3, \"hidden\"], [3, \"adaptImg\", \"component\", \"componentId\", \"text\", \"filter\", \"afterRender\", 4, \"ngIf\"], [1, \"core-info-card\"], [\"name\", \"fas-circle-info\", \"slot\", \"start\", \"aria-hidden\", \"true\"], [3, \"adaptImg\", \"component\", \"componentId\", \"text\", \"filter\", \"afterRender\"]],\n  template: function AddonQtypeDdMarkerComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵtemplate(0, AddonQtypeDdMarkerComponent_div_0_Template, 9, 11, \"div\", 0);\n    }\n    if (rf & 2) {\n      i0.ɵɵproperty(\"ngIf\", ctx.question && (ctx.question.text || ctx.question.text === \"\"));\n    }\n  },\n  dependencies: [i1.NgIf, i2.CoreLoadingComponent, i3.CoreFaIconDirective, i4.CoreFormatTextDirective, i5.IonCard, i5.IonIcon, i5.IonItem, i5.IonLabel, i6.TranslatePipe],\n  styles: [\".addon-qtype-ddmarker-container[_ngcontent-%COMP%] {\\n  min-height: 80px;\\n}\\n\\ncore-format-text[_ngcontent-%COMP%]     .ddarea, core-format-text[_ngcontent-%COMP%]     .ddform {\\n  -webkit-user-select: none;\\n          user-select: none;\\n}\\ncore-format-text[_ngcontent-%COMP%]     .qtext {\\n  margin-bottom: 0.5em;\\n  display: block;\\n}\\ncore-format-text[_ngcontent-%COMP%]     .droparea {\\n  display: inline-block;\\n}\\ncore-format-text[_ngcontent-%COMP%]     div.droparea img {\\n  border: 1px solid var(--core-dd-question-border);\\n  max-width: 100%;\\n}\\ncore-format-text[_ngcontent-%COMP%]     .dropzones svg {\\n  z-index: 3;\\n}\\ncore-format-text[_ngcontent-%COMP%]     .dragitem.beingdragged .markertext {\\n  z-index: 5;\\n  box-shadow: var(--core-dd-question-selected-shadow);\\n}\\ncore-format-text[_ngcontent-%COMP%]     .dragitems.readonly .dragitem, core-format-text[_ngcontent-%COMP%]     .dragitems.readonly .marker, core-format-text[_ngcontent-%COMP%]     .draghomes.readonly .dragitem, core-format-text[_ngcontent-%COMP%]     .draghomes.readonly .marker {\\n  cursor: auto;\\n}\\ncore-format-text[_ngcontent-%COMP%]     .dragitems .dragitem, core-format-text[_ngcontent-%COMP%]     .dragitems .draghome, core-format-text[_ngcontent-%COMP%]     .dragitems .marker, core-format-text[_ngcontent-%COMP%]     .draghomes .dragitem, core-format-text[_ngcontent-%COMP%]     .draghomes .draghome, core-format-text[_ngcontent-%COMP%]     .draghomes .marker {\\n  vertical-align: top;\\n  cursor: pointer;\\n  position: relative;\\n  margin: 10px;\\n  display: inline-block;\\n}\\ncore-format-text[_ngcontent-%COMP%]     .dragitems .dragitem.dragplaceholder, core-format-text[_ngcontent-%COMP%]     .dragitems .draghome.dragplaceholder, core-format-text[_ngcontent-%COMP%]     .dragitems .marker.dragplaceholder, core-format-text[_ngcontent-%COMP%]     .draghomes .dragitem.dragplaceholder, core-format-text[_ngcontent-%COMP%]     .draghomes .draghome.dragplaceholder, core-format-text[_ngcontent-%COMP%]     .draghomes .marker.dragplaceholder {\\n  display: none;\\n  visibility: hidden;\\n}\\ncore-format-text[_ngcontent-%COMP%]     .dragitems .dragitem.dragplaceholder.active, core-format-text[_ngcontent-%COMP%]     .dragitems .draghome.dragplaceholder.active, core-format-text[_ngcontent-%COMP%]     .dragitems .marker.dragplaceholder.active, core-format-text[_ngcontent-%COMP%]     .draghomes .dragitem.dragplaceholder.active, core-format-text[_ngcontent-%COMP%]     .draghomes .draghome.dragplaceholder.active, core-format-text[_ngcontent-%COMP%]     .draghomes .marker.dragplaceholder.active {\\n  display: inline-block;\\n}\\ncore-format-text[_ngcontent-%COMP%]     .dragitems .dragitem.unplaced, core-format-text[_ngcontent-%COMP%]     .dragitems .draghome.unplaced, core-format-text[_ngcontent-%COMP%]     .dragitems .marker.unplaced, core-format-text[_ngcontent-%COMP%]     .draghomes .dragitem.unplaced, core-format-text[_ngcontent-%COMP%]     .draghomes .draghome.unplaced, core-format-text[_ngcontent-%COMP%]     .draghomes .marker.unplaced {\\n  position: relative;\\n}\\ncore-format-text[_ngcontent-%COMP%]     .dragitems .dragitem.placed, core-format-text[_ngcontent-%COMP%]     .dragitems .draghome.placed, core-format-text[_ngcontent-%COMP%]     .dragitems .marker.placed, core-format-text[_ngcontent-%COMP%]     .draghomes .dragitem.placed, core-format-text[_ngcontent-%COMP%]     .draghomes .draghome.placed, core-format-text[_ngcontent-%COMP%]     .draghomes .marker.placed {\\n  position: absolute;\\n  opacity: 0.6;\\n}\\ncore-format-text[_ngcontent-%COMP%]     .droparea .dragitem, core-format-text[_ngcontent-%COMP%]     .droparea .marker {\\n  cursor: pointer;\\n  position: absolute;\\n  vertical-align: top;\\n  z-index: 2;\\n}\\ncore-format-text[_ngcontent-%COMP%]     div.ddarea {\\n  text-align: center;\\n  position: relative;\\n}\\ncore-format-text[_ngcontent-%COMP%]     div.ddarea .dropzones, core-format-text[_ngcontent-%COMP%]     div.ddarea .markertexts {\\n  top: 0;\\n  left: 0;\\n  min-height: 80px;\\n  position: absolute;\\n  text-align: start;\\n}\\ncore-format-text[_ngcontent-%COMP%]     .dropbackground {\\n  margin: 0 auto;\\n}\\ncore-format-text[_ngcontent-%COMP%]     div.dragitems div.draghome, core-format-text[_ngcontent-%COMP%]     div.dragitems div.dragitem, core-format-text[_ngcontent-%COMP%]     div.draghome, core-format-text[_ngcontent-%COMP%]     div.drag, core-format-text[_ngcontent-%COMP%]     div.draghomes div.marker, core-format-text[_ngcontent-%COMP%]     div.marker, core-format-text[_ngcontent-%COMP%]     div.drag {\\n  font: 13px/1.231 arial, helvetica, clean, sans-serif;\\n}\\ncore-format-text[_ngcontent-%COMP%]     div.dragitems span.markertext, core-format-text[_ngcontent-%COMP%]     div.draghomes span.markertext, core-format-text[_ngcontent-%COMP%]     div.markertexts span.markertext {\\n  margin: 0 5px;\\n  z-index: 2;\\n  background-color: var(--ion-item-background);\\n  border: 2px solid var(--core-dd-question-border);\\n  padding: 5px;\\n  display: inline-block;\\n  zoom: 1;\\n  border-radius: 10px;\\n  color: var(--ion-text-color);\\n}\\ncore-format-text[_ngcontent-%COMP%]     div.markertexts span.markertext {\\n  z-index: 3;\\n  background-color: var(--warning-tint);\\n  border-style: solid;\\n  border-width: 2px;\\n  border-color: var(--warning);\\n  position: absolute;\\n  color: var(--gray-900);\\n}\\ncore-format-text[_ngcontent-%COMP%]     span.wrongpart {\\n  background-color: var(--warning-tint);\\n  border-style: solid;\\n  border-width: 2px;\\n  border-color: var(--warning);\\n  padding: 5px;\\n  border-radius: 10px;\\n  opacity: 0.6;\\n  margin: 5px;\\n  display: inline-block;\\n  color: var(--gray-900);\\n}\\ncore-format-text[_ngcontent-%COMP%]     div.dragitems img.target, core-format-text[_ngcontent-%COMP%]     div.draghomes img.target {\\n  position: absolute;\\n  left: -7px; \\n\\n  top: -7px; \\n\\n}\\ncore-format-text[_ngcontent-%COMP%]     div.dragitems div.draghome img.target, core-format-text[_ngcontent-%COMP%]     div.draghomes div.marker img.target {\\n  display: none;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hZGRvbnMvcXR5cGUvZGRtYXJrZXIvY29tcG9uZW50L2RkbWFya2VyLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0E7RUFDSSxnQkFBQTtBQUFKOztBQUlJO0VBQ0kseUJBQUE7VUFBQSxpQkFBQTtBQURSO0FBSUk7RUFDSSxvQkFBQTtFQUNBLGNBQUE7QUFGUjtBQUtJO0VBQ0kscUJBQUE7QUFIUjtBQU1JO0VBQ0ksZ0RBQUE7RUFDQSxlQUFBO0FBSlI7QUFPSTtFQUNJLFVBQUE7QUFMUjtBQVFJO0VBQ0ksVUFBQTtFQUNBLG1EQUFBO0FBTlI7QUFZWTs7OztFQUVJLFlBQUE7QUFSaEI7QUFZUTs7Ozs7O0VBR0ksbUJBQUE7RUFDQSxlQUFBO0VBQ0Esa0JBQUE7RUFDQSxZQUFBO0VBQ0EscUJBQUE7QUFQWjtBQVFZOzs7Ozs7RUFDSSxhQUFBO0VBQ0Esa0JBQUE7QUFEaEI7QUFHZ0I7Ozs7OztFQUNJLHFCQUFBO0FBSXBCO0FBQVk7Ozs7OztFQUNJLGtCQUFBO0FBT2hCO0FBTFk7Ozs7OztFQUNJLGtCQUFBO0VBQ0EsWUFBQTtBQVloQjtBQU5ROztFQUVJLGVBQUE7RUFDQSxrQkFBQTtFQUNBLG1CQUFBO0VBQ0EsVUFBQTtBQVFaO0FBSkk7RUFDSSxrQkFBQTtFQUNBLGtCQUFBO0FBTVI7QUFKSTs7RUFFSSxNQUFBO0VBQ0EsT0FBQTtFQUNBLGdCQUFBO0VBQ0Esa0JBQUE7RUFDQSxpQkFBQTtBQU1SO0FBSEk7RUFDSSxjQUFBO0FBS1I7QUFGSTs7Ozs7OztFQU9JLG9EQUFBO0FBSVI7QUFGSTs7O0VBR0ksYUFBQTtFQUNBLFVBQUE7RUFDQSw0Q0FBQTtFQUNBLGdEQUFBO0VBQ0EsWUFBQTtFQUNBLHFCQUFBO0VBQ0EsT0FBQTtFQUNBLG1CQUFBO0VBQ0EsNEJBQUE7QUFJUjtBQUZJO0VBQ0ksVUFBQTtFQUNBLHFDQUFBO0VBQ0EsbUJBQUE7RUFDQSxpQkFBQTtFQUNBLDRCQUFBO0VBQ0Esa0JBQUE7RUFDQSxzQkFBQTtBQUlSO0FBRkk7RUFDSSxxQ0FBQTtFQUNBLG1CQUFBO0VBQ0EsaUJBQUE7RUFDQSw0QkFBQTtFQUNBLFlBQUE7RUFDQSxtQkFBQTtFQUNBLFlBQUE7RUFDQSxXQUFBO0VBQ0EscUJBQUE7RUFDQSxzQkFBQTtBQUlSO0FBRkk7O0VBRUksa0JBQUE7RUFDQSxVQUFBLEVBQUEsK0RBQUE7RUFDQSxTQUFBLEVBQUEsdURBQUE7QUFJUjtBQUZJOztFQUVJLGFBQUE7QUFJUiIsInNvdXJjZXNDb250ZW50IjpbIi8vIFN0eWxlIGRkbWFya2VyIGNvbnRlbnQgYSBiaXQuIEFsbW9zdCBhbGwgdGhlc2Ugc3R5bGVzIGFyZSBjb3BpZWQgZnJvbSBNb29kbGUuXG4uYWRkb24tcXR5cGUtZGRtYXJrZXItY29udGFpbmVyIHtcbiAgICBtaW4taGVpZ2h0OiA4MHB4OyAvLyBUbyBkaXNwbGF5IHRoZSBsb2FkaW5nLlxufVxuXG5jb3JlLWZvcm1hdC10ZXh0IDo6bmctZGVlcCB7XG4gICAgLmRkYXJlYSwgLmRkZm9ybSB7XG4gICAgICAgIHVzZXItc2VsZWN0OiBub25lO1xuICAgIH1cblxuICAgIC5xdGV4dCB7XG4gICAgICAgIG1hcmdpbi1ib3R0b206IDAuNWVtO1xuICAgICAgICBkaXNwbGF5OiBibG9jaztcbiAgICB9XG5cbiAgICAuZHJvcGFyZWEge1xuICAgICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XG4gICAgfVxuXG4gICAgZGl2LmRyb3BhcmVhIGltZyB7XG4gICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWNvcmUtZGQtcXVlc3Rpb24tYm9yZGVyKTtcbiAgICAgICAgbWF4LXdpZHRoOiAxMDAlO1xuICAgIH1cblxuICAgIC5kcm9wem9uZXMgc3ZnIHtcbiAgICAgICAgei1pbmRleDogMztcbiAgICB9XG5cbiAgICAuZHJhZ2l0ZW0uYmVpbmdkcmFnZ2VkIC5tYXJrZXJ0ZXh0IHtcbiAgICAgICAgei1pbmRleDogNTtcbiAgICAgICAgYm94LXNoYWRvdzogdmFyKC0tY29yZS1kZC1xdWVzdGlvbi1zZWxlY3RlZC1zaGFkb3cpO1xuICAgIH1cblxuICAgIC5kcmFnaXRlbXMsIC8vIFByZXZpb3VzIHRvIDMuOS5cbiAgICAuZHJhZ2hvbWVzIHtcbiAgICAgICAgJi5yZWFkb25seSB7XG4gICAgICAgICAgICAuZHJhZ2l0ZW0sXG4gICAgICAgICAgICAubWFya2VyIHtcbiAgICAgICAgICAgICAgICBjdXJzb3I6IGF1dG87XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAuZHJhZ2l0ZW0sIC8vIFByZXZpb3VzIHRvIDMuOS5cbiAgICAgICAgLmRyYWdob21lLFxuICAgICAgICAubWFya2VyIHtcbiAgICAgICAgICAgIHZlcnRpY2FsLWFsaWduOiB0b3A7XG4gICAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7XG4gICAgICAgICAgICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gICAgICAgICAgICBtYXJnaW46IDEwcHg7XG4gICAgICAgICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XG4gICAgICAgICAgICAmLmRyYWdwbGFjZWhvbGRlciB7XG4gICAgICAgICAgICAgICAgZGlzcGxheTogbm9uZTtcbiAgICAgICAgICAgICAgICB2aXNpYmlsaXR5OiBoaWRkZW47XG5cbiAgICAgICAgICAgICAgICAmLmFjdGl2ZSB7XG4gICAgICAgICAgICAgICAgICAgIGRpc3BsYXk6IGlubGluZS1ibG9jaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICYudW5wbGFjZWQge1xuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICYucGxhY2VkIHtcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICAgICAgICAgICAgb3BhY2l0eTogMC42O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLmRyb3BhcmVhIHtcbiAgICAgICAgLmRyYWdpdGVtLFxuICAgICAgICAubWFya2VyIHtcbiAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjtcbiAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICAgICAgICAgIHZlcnRpY2FsLWFsaWduOiB0b3A7XG4gICAgICAgICAgICB6LWluZGV4OiAyO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZGl2LmRkYXJlYSB7XG4gICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlO1xuICAgIH1cbiAgICBkaXYuZGRhcmVhIC5kcm9wem9uZXMsXG4gICAgZGl2LmRkYXJlYSAubWFya2VydGV4dHMge1xuICAgICAgICB0b3A6IDA7XG4gICAgICAgIGxlZnQ6IDA7XG4gICAgICAgIG1pbi1oZWlnaHQ6IDgwcHg7XG4gICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICAgICAgdGV4dC1hbGlnbjogc3RhcnQ7XG4gICAgfVxuXG4gICAgLmRyb3BiYWNrZ3JvdW5kIHtcbiAgICAgICAgbWFyZ2luOiAwIGF1dG87XG4gICAgfVxuXG4gICAgZGl2LmRyYWdpdGVtcyBkaXYuZHJhZ2hvbWUsXG4gICAgZGl2LmRyYWdpdGVtcyBkaXYuZHJhZ2l0ZW0sXG4gICAgZGl2LmRyYWdob21lLFxuICAgIGRpdi5kcmFnLFxuICAgIGRpdi5kcmFnaG9tZXMgZGl2Lm1hcmtlcixcbiAgICBkaXYubWFya2VyLFxuICAgIGRpdi5kcmFnIHtcbiAgICAgICAgZm9udDogMTNweC8xLjIzMSBhcmlhbCwgaGVsdmV0aWNhLCBjbGVhbiwgc2Fucy1zZXJpZjtcbiAgICB9XG4gICAgZGl2LmRyYWdpdGVtcyBzcGFuLm1hcmtlcnRleHQsXG4gICAgZGl2LmRyYWdob21lcyBzcGFuLm1hcmtlcnRleHQsXG4gICAgZGl2Lm1hcmtlcnRleHRzIHNwYW4ubWFya2VydGV4dCB7XG4gICAgICAgIG1hcmdpbjogMCA1cHg7XG4gICAgICAgIHotaW5kZXg6IDI7XG4gICAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWlvbi1pdGVtLWJhY2tncm91bmQpO1xuICAgICAgICBib3JkZXI6IDJweCBzb2xpZCB2YXIoLS1jb3JlLWRkLXF1ZXN0aW9uLWJvcmRlcik7XG4gICAgICAgIHBhZGRpbmc6IDVweDtcbiAgICAgICAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xuICAgICAgICB6b29tOiAxO1xuICAgICAgICBib3JkZXItcmFkaXVzOiAxMHB4O1xuICAgICAgICBjb2xvcjogdmFyKC0taW9uLXRleHQtY29sb3IpO1xuICAgIH1cbiAgICBkaXYubWFya2VydGV4dHMgc3Bhbi5tYXJrZXJ0ZXh0IHtcbiAgICAgICAgei1pbmRleDogMztcbiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0td2FybmluZy10aW50KTtcbiAgICAgICAgYm9yZGVyLXN0eWxlOiBzb2xpZDtcbiAgICAgICAgYm9yZGVyLXdpZHRoOiAycHg7XG4gICAgICAgIGJvcmRlci1jb2xvcjogdmFyKC0td2FybmluZyk7XG4gICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICAgICAgY29sb3I6IHZhcigtLWdyYXktOTAwKTtcbiAgICB9XG4gICAgc3Bhbi53cm9uZ3BhcnQge1xuICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS13YXJuaW5nLXRpbnQpO1xuICAgICAgICBib3JkZXItc3R5bGU6IHNvbGlkO1xuICAgICAgICBib3JkZXItd2lkdGg6IDJweDtcbiAgICAgICAgYm9yZGVyLWNvbG9yOiB2YXIoLS13YXJuaW5nKTtcbiAgICAgICAgcGFkZGluZzogNXB4O1xuICAgICAgICBib3JkZXItcmFkaXVzOiAxMHB4O1xuICAgICAgICBvcGFjaXR5OiAwLjY7XG4gICAgICAgIG1hcmdpbjogNXB4O1xuICAgICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XG4gICAgICAgIGNvbG9yOiB2YXIoLS1ncmF5LTkwMCk7XG4gICAgfVxuICAgIGRpdi5kcmFnaXRlbXMgaW1nLnRhcmdldCxcbiAgICBkaXYuZHJhZ2hvbWVzIGltZy50YXJnZXQge1xuICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICAgIGxlZnQ6IC03cHg7IC8qIFRoaXMgbXVzdCBiZSBoYWxmIHRoZSBzaXplIG9mIHRoZSB0YXJnZXQgaW1hZ2UsIG1pbnVzIDAuNS4gKi9cbiAgICAgICAgdG9wOiAtN3B4OyAvKiBJbiBvdGhlciB3b3JkcywgdGhpcyB3b3JrcyBmb3IgYSAxNXgxNSBjcm9zcy1oYWlyLiAqL1xuICAgIH1cbiAgICBkaXYuZHJhZ2l0ZW1zIGRpdi5kcmFnaG9tZSBpbWcudGFyZ2V0LFxuICAgIGRpdi5kcmFnaG9tZXMgZGl2Lm1hcmtlciBpbWcudGFyZ2V0IHtcbiAgICAgICAgZGlzcGxheTogbm9uZTtcbiAgICB9XG59XG4iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n});","map":{"version":3,"names":["CoreQuestionBaseComponent","CoreQuestionHelper","CoreFilepool","CoreSites","CoreDomUtils","AddonQtypeDdMarkerQuestion","i0","ɵɵelementStart","ɵɵelement","ɵɵtext","ɵɵelementEnd","ɵɵadvance","ɵɵtextInterpolate","ɵɵpipeBind1","ɵɵlistener","AddonQtypeDdMarkerComponent_div_0_core_format_text_8_Template_core_format_text_afterRender_0_listener","ɵɵrestoreView","_r5","ctx_r4","ɵɵnextContext","ɵɵresetView","ddAreaRendered","ɵɵproperty","ctx_r3","component","componentId","question","ddArea","ɵɵtemplate","AddonQtypeDdMarkerComponent_div_0_ion_card_4_Template","AddonQtypeDdMarkerComponent_div_0_Template_core_format_text_afterRender_5_listener","_r7","ctx_r6","textRendered","AddonQtypeDdMarkerComponent_div_0_core_format_text_8_Template","ctx_r0","loaded","readOnly","text","contextLevel","contextInstanceId","courseId","AddonQtypeDdMarkerComponent","constructor","elementRef","dropZones","destroyed","textIsRendered","ddAreaisRendered","init","questionElement","initComponent","querySelector","ddForm","logger","warn","slot","showComponentError","onAbort","outerHTML","wrongParts","initObjects","dropzones","undefined","readonly","amdArgs","nextIndex","imgSrc","questionRendered","_this","_asyncToGenerator","site","getCurrentSite","canDownloadFiles","isSitePluginFileUrl","getSrcByUrl","getId","questionTextEl","waitForImages","nativeElement","questionInstance","hostElement","ngOnDestroy","_this$questionInstanc","destroy","ɵɵdirectiveInject","ElementRef","selectors","viewQuery","AddonQtypeDdMarkerComponent_Query","rf","ctx","AddonQtypeDdMarkerComponent_div_0_Template"],"sources":["/home/toon/works/gitionic7/ionic-github/ionic/src/addons/qtype/ddmarker/component/ddmarker.ts","/home/toon/works/gitionic7/ionic-github/ionic/src/addons/qtype/ddmarker/component/addon-qtype-ddmarker.html"],"sourcesContent":["// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Component, OnDestroy, ElementRef, ViewChild } from '@angular/core';\n\nimport { AddonModQuizQuestionBasicData, CoreQuestionBaseComponent } from '@features/question/classes/base-question-component';\nimport { CoreQuestionHelper } from '@features/question/services/question-helper';\nimport { CoreFilepool } from '@services/filepool';\nimport { CoreSites } from '@services/sites';\nimport { CoreDomUtils } from '@services/utils/dom';\nimport { AddonQtypeDdMarkerQuestion } from '../classes/ddmarker';\n\n/**\n * Component to render a drag-and-drop markers question.\n */\n@Component({\n    selector: 'addon-qtype-ddmarker',\n    templateUrl: 'addon-qtype-ddmarker.html',\n    styleUrls: ['ddmarker.scss'],\n})\nexport class AddonQtypeDdMarkerComponent\n    extends CoreQuestionBaseComponent<AddonQtypeDdMarkerQuestionData>\n    implements OnDestroy {\n\n    @ViewChild('questiontext') questionTextEl?: ElementRef;\n\n    protected questionInstance?: AddonQtypeDdMarkerQuestion;\n    protected dropZones: unknown[] = []; // The drop zones received in the init object of the question.\n    protected imgSrc?: string; // Background image URL.\n    protected destroyed = false;\n    protected textIsRendered = false;\n    protected ddAreaisRendered = false;\n\n    constructor(elementRef: ElementRef) {\n        super('AddonQtypeDdMarkerComponent', elementRef);\n    }\n\n    /**\n     * @inheritdoc\n     */\n    init(): void {\n        if (!this.question) {\n            return;\n        }\n\n        const questionElement = this.initComponent();\n        if (!questionElement) {\n            return;\n        }\n\n        // Get D&D area, form and question text.\n        const ddArea = questionElement.querySelector('.ddarea');\n        const ddForm = questionElement.querySelector('.ddform');\n\n        if (!ddArea || !ddForm) {\n            this.logger.warn('Aborting because of an error parsing question.', this.question.slot);\n\n            return CoreQuestionHelper.showComponentError(this.onAbort);\n        }\n\n        // Build the D&D area HTML.\n        this.question.ddArea = ddArea.outerHTML;\n\n        const wrongParts = questionElement.querySelector('.wrongparts');\n        if (wrongParts) {\n            this.question.ddArea += wrongParts.outerHTML;\n        }\n        this.question.ddArea += ddForm.outerHTML;\n        this.question.readOnly = false;\n\n        if (this.question.initObjects) {\n            // Moodle version = 3.5.\n            if (this.question.initObjects.dropzones !== undefined) {\n                this.dropZones = <unknown[]> this.question.initObjects.dropzones;\n            }\n            if (this.question.initObjects.readonly !== undefined) {\n                this.question.readOnly = !!this.question.initObjects.readonly;\n            }\n        } else if (this.question.amdArgs) {\n            // Moodle version >= 3.6.\n            let nextIndex = 1;\n            // Moodle version >= 3.9, imgSrc is not specified, do not advance index.\n            if (this.question.amdArgs[nextIndex] !== undefined && typeof this.question.amdArgs[nextIndex] !== 'boolean') {\n                this.imgSrc = <string> this.question.amdArgs[nextIndex];\n                nextIndex++;\n            }\n\n            if (this.question.amdArgs[nextIndex] !== undefined) {\n                this.question.readOnly = !!this.question.amdArgs[nextIndex];\n            }\n            nextIndex++;\n\n            if (this.question.amdArgs[nextIndex] !== undefined) {\n                this.dropZones = <unknown[]> this.question.amdArgs[nextIndex];\n            }\n        }\n\n        this.question.loaded = false;\n    }\n\n    /**\n     * The question ddArea has been rendered.\n     */\n    ddAreaRendered(): void {\n        this.ddAreaisRendered = true;\n        if (this.textIsRendered) {\n            this.questionRendered();\n        }\n    }\n\n    /**\n     * The question text has been rendered.\n     */\n    textRendered(): void {\n        this.textIsRendered = true;\n        if (this.ddAreaisRendered) {\n            this.questionRendered();\n        }\n    }\n\n    /**\n     * The question has been rendered.\n     */\n    protected async questionRendered(): Promise<void> {\n        if (this.destroyed || !this.question) {\n            return;\n        }\n\n        // Download background image (3.6+ sites).\n        let imgSrc = this.imgSrc;\n        const site = CoreSites.getCurrentSite();\n\n        if (this.imgSrc && site?.canDownloadFiles() && site.isSitePluginFileUrl(this.imgSrc)) {\n            imgSrc = await CoreFilepool.getSrcByUrl(\n                site.getId(),\n                this.imgSrc,\n                this.component,\n                this.componentId,\n                0,\n                true,\n                true,\n            );\n        }\n\n        if (this.questionTextEl) {\n            await CoreDomUtils.waitForImages(this.questionTextEl.nativeElement);\n        }\n\n        // Create the instance.\n        this.questionInstance = new AddonQtypeDdMarkerQuestion(\n            this.hostElement,\n            this.question,\n            !!this.question.readOnly,\n            this.dropZones,\n            imgSrc,\n        );\n    }\n\n    /**\n     * @inheritdoc\n     */\n    ngOnDestroy(): void {\n        this.destroyed = true;\n        this.questionInstance?.destroy();\n    }\n\n}\n\n/**\n * Data for DD Marker question.\n */\nexport type AddonQtypeDdMarkerQuestionData = AddonModQuizQuestionBasicData & {\n    loaded?: boolean;\n    readOnly?: boolean;\n    ddArea?: string;\n};\n","<div *ngIf=\"question && (question.text || question.text === '')\" class=\"addon-qtype-ddmarker-container\">\n    <!-- Content is outside the core-loading to let the script calculate drag items position -->\n    <core-loading [hideUntil]=\"question.loaded\" />\n\n    <ion-item class=\"ion-text-wrap\" [hidden]=\"!question.loaded\">\n        <ion-label>\n            <ion-card *ngIf=\"!question.readOnly\" class=\"core-info-card\">\n                <ion-item>\n                    <ion-icon name=\"fas-circle-info\" slot=\"start\" aria-hidden=\"true\" />\n                    <ion-label>{{ 'core.question.howtodraganddrop' | translate }}</ion-label>\n                </ion-item>\n            </ion-card>\n            <core-format-text [component]=\"component\" [componentId]=\"componentId\" [text]=\"question.text\" #questiontext\n                [contextLevel]=\"contextLevel\" [contextInstanceId]=\"contextInstanceId\" [courseId]=\"courseId\"\n                (afterRender)=\"textRendered()\" />\n        </ion-label>\n    </ion-item>\n    <div class=\"fake-ion-item ion-text-wrap\" [hidden]=\"!question.loaded\">\n        <core-format-text *ngIf=\"question.ddArea\" [adaptImg]=\"false\" [component]=\"component\" [componentId]=\"componentId\"\n            [text]=\"question.ddArea\" [filter]=\"false\" (afterRender)=\"ddAreaRendered()\" />\n    </div>\n</div>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
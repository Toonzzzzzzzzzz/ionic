{"ast":null,"code":"import _asyncToGenerator from \"/home/toon/works/gitionic7/ionic-github/ionic/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _class;\nimport { CoreRoutedItemsManagerSourcesTracker } from '@classes/items-management/routed-items-manager-sources-tracker';\nimport { CoreSwipeNavigationItemsManager } from '@classes/items-management/swipe-navigation-items-manager';\nimport { CoreNavigator } from '@services/navigator';\nimport { CoreDomUtils } from '@services/utils/dom';\nimport { CoreTextUtils } from '@services/utils/text';\nimport { AddonModFeedbackAttemptsSource } from '../../classes/feedback-attempts-source';\nimport { AddonModFeedback, AddonModFeedbackProvider } from '../../services/feedback';\nimport { AddonModFeedbackHelper } from '../../services/feedback-helper';\nimport { CoreTime } from '@singletons/time';\nimport { CoreAnalytics, CoreAnalyticsEventType } from '@services/analytics';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nimport * as i2 from \"../../../../../core/components/loading/loading\";\nimport * as i3 from \"../../../../../core/components/mark-required/mark-required\";\nimport * as i4 from \"../../../../../core/components/user-avatar/user-avatar\";\nimport * as i5 from \"../../../../../core/components/spacer/spacer\";\nimport * as i6 from \"../../../../../core/directives/format-text\";\nimport * as i7 from \"../../../../../core/directives/user-link\";\nimport * as i8 from \"../../../../../core/directives/swipe-navigation\";\nimport * as i9 from \"../../../../../core/directives/content\";\nimport * as i10 from \"@ionic/angular\";\nimport * as i11 from \"../../../../../core/pipes/format-date\";\nimport * as i12 from \"@ngx-translate/core\";\nfunction AddonModFeedbackAttemptPage_h1_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h1\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r0.attempt.fullname);\n  }\n}\nfunction AddonModFeedbackAttemptPage_h1_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h1\");\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(2, 1, \"addon.mod_feedback.anonymous_user\"));\n  }\n}\nfunction AddonModFeedbackAttemptPage_ion_list_10_ion_item_1_p_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"coreFormatDate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r6 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(2, 1, ctx_r6.attempt.timemodified * 1000));\n  }\n}\nfunction AddonModFeedbackAttemptPage_ion_list_10_ion_item_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-item\", 9);\n    i0.ɵɵpipe(1, \"translate\");\n    i0.ɵɵelement(2, \"core-user-avatar\", 10);\n    i0.ɵɵelementStart(3, \"ion-label\")(4, \"h2\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(6, AddonModFeedbackAttemptPage_ion_list_10_ion_item_1_p_6_Template, 3, 3, \"p\", 2);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"userId\", ctx_r3.attempt.userid)(\"courseId\", ctx_r3.attempt.courseid);\n    i0.ɵɵattribute(\"aria-label\", i0.ɵɵpipeBind1(1, 7, \"core.user.viewprofile\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"user\", ctx_r3.attempt)(\"linkProfile\", false);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(ctx_r3.attempt.fullname);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.attempt.timemodified);\n  }\n}\nfunction AddonModFeedbackAttemptPage_ion_list_10_ion_item_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-item\", 11);\n    i0.ɵɵelement(1, \"core-user-avatar\", 12);\n    i0.ɵɵelementStart(2, \"ion-label\")(3, \"h2\");\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"p\");\n    i0.ɵɵtext(7);\n    i0.ɵɵpipe(8, \"translate\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"linkProfile\", false);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(5, 4, \"addon.mod_feedback.anonymous_user\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate2(\"\", i0.ɵɵpipeBind1(8, 6, \"addon.mod_feedback.response_nr\"), \": \", ctx_r4.anonAttempt.number, \"\");\n  }\n}\nfunction AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_core_spacer_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"core-spacer\");\n  }\n}\nfunction AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_ion_item_2_p_2_span_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const item_r8 = i0.ɵɵnextContext(3).$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"\", item_r8.itemnumber, \". \");\n  }\n}\nfunction AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_ion_item_2_p_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 17);\n    i0.ɵɵtemplate(1, AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_ion_item_2_p_2_span_1_Template, 2, 1, \"span\", 2);\n    i0.ɵɵelement(2, \"core-format-text\", 18);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const item_r8 = i0.ɵɵnextContext(2).$implicit;\n    const ctx_r11 = i0.ɵɵnextContext(3);\n    i0.ɵɵproperty(\"core-mark-required\", item_r8.required);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r11.feedback.autonumbering && item_r8.itemnumber);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"component\", ctx_r11.component)(\"componentId\", ctx_r11.cmId)(\"text\", item_r8.name)(\"contextInstanceId\", ctx_r11.cmId)(\"courseId\", ctx_r11.courseId);\n  }\n}\nfunction AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_ion_item_2_p_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵelement(1, \"core-format-text\", 18);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const item_r8 = i0.ɵɵnextContext(2).$implicit;\n    const ctx_r12 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"component\", ctx_r12.component)(\"componentId\", ctx_r12.cmId)(\"text\", item_r8.submittedValue)(\"contextInstanceId\", ctx_r12.cmId)(\"courseId\", ctx_r12.courseId);\n  }\n}\nfunction AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_ion_item_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-item\", 15)(1, \"ion-label\");\n    i0.ɵɵtemplate(2, AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_ion_item_2_p_2_Template, 3, 7, \"p\", 16);\n    i0.ɵɵtemplate(3, AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_ion_item_2_p_3_Template, 2, 5, \"p\", 2);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const item_r8 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵproperty(\"color\", item_r8.dependitem > 0 ? \"light\" : \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", item_r8.name);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", item_r8.submittedValue);\n  }\n}\nfunction AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_core_spacer_1_Template, 1, 0, \"core-spacer\", 2);\n    i0.ɵɵtemplate(2, AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_ion_item_2_Template, 4, 3, \"ion-item\", 14);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const item_r8 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", item_r8.typ === \"pagebreak\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", item_r8.typ !== \"pagebreak\");\n  }\n}\nfunction AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_Template, 3, 2, \"ng-container\", 13);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r5.items);\n  }\n}\nfunction AddonModFeedbackAttemptPage_ion_list_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-list\", 6);\n    i0.ɵɵtemplate(1, AddonModFeedbackAttemptPage_ion_list_10_ion_item_1_Template, 7, 9, \"ion-item\", 7);\n    i0.ɵɵtemplate(2, AddonModFeedbackAttemptPage_ion_list_10_ion_item_2_Template, 9, 8, \"ion-item\", 8);\n    i0.ɵɵtemplate(3, AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_Template, 2, 1, \"ng-container\", 2);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.attempt);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.anonAttempt);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.items && ctx_r2.items.length);\n  }\n}\n/**\n * Page that displays a feedback attempt review.\n */\nexport class AddonModFeedbackAttemptPage {\n  constructor() {\n    this.items = [];\n    this.component = AddonModFeedbackProvider.COMPONENT;\n    this.loaded = false;\n    this.cmId = CoreNavigator.getRequiredRouteNumberParam('cmId');\n    this.courseId = CoreNavigator.getRequiredRouteNumberParam('courseId');\n    this.attemptId = CoreNavigator.getRequiredRouteNumberParam('attemptId');\n    this.groupId = CoreNavigator.getRouteNumberParam('groupId');\n    const source = CoreRoutedItemsManagerSourcesTracker.getOrCreateSource(AddonModFeedbackAttemptsSource, [this.courseId, this.cmId]);\n    this.attempts = new AddonModFeedbackAttemptsSwipeManager(source);\n    this.logView = CoreTime.once(() => {\n      if (!this.feedback) {\n        return;\n      }\n      CoreAnalytics.logEvent({\n        type: CoreAnalyticsEventType.VIEW_ITEM,\n        ws: 'mod_feedback_get_responses_analysis',\n        name: this.feedback.name,\n        data: {\n          id: this.attemptId,\n          feedbackid: this.feedback.id,\n          category: 'feedback'\n        },\n        url: `/mod/feedback/show_entries.php?id=${this.cmId}` + (this.attempt ? `userid=${this.attempt.userid}` : '') + `&showcompleted=${this.attemptId}`\n      });\n    });\n  }\n  /**\n   * @inheritdoc\n   */\n  ngOnInit() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      try {\n        yield _this.attempts.start();\n      } catch (error) {\n        CoreDomUtils.showErrorModal(error);\n        CoreNavigator.back();\n        return;\n      }\n      _this.fetchData();\n    })();\n  }\n  /**\n   * @inheritdoc\n   */\n  ngOnDestroy() {\n    this.attempts.destroy();\n  }\n  /**\n   * Fetch all the data required for the view.\n   *\n   * @returns Promise resolved when done.\n   */\n  fetchData() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      try {\n        _this2.feedback = yield AddonModFeedback.getFeedback(_this2.courseId, _this2.cmId);\n        const attempt = yield AddonModFeedback.getAttempt(_this2.feedback.id, _this2.attemptId, {\n          cmId: _this2.cmId,\n          groupId: _this2.groupId\n        });\n        if (_this2.isAnonAttempt(attempt)) {\n          _this2.anonAttempt = attempt;\n          delete _this2.attempt;\n        } else {\n          _this2.attempt = (yield AddonModFeedbackHelper.addImageProfile([attempt]))[0];\n          delete _this2.anonAttempt;\n        }\n        const items = yield AddonModFeedback.getItems(_this2.feedback.id, {\n          cmId: _this2.cmId\n        });\n        // Add responses and format items.\n        _this2.items = items.items.map(item => {\n          const formItem = AddonModFeedbackHelper.getItemForm(item, true);\n          if (!formItem) {\n            return;\n          }\n          const attemptItem = formItem;\n          if (item.typ == 'label') {\n            attemptItem.submittedValue = CoreTextUtils.replacePluginfileUrls(item.presentation, item.itemfiles);\n          } else {\n            for (const x in attempt.responses) {\n              if (attempt.responses[x].id == item.id) {\n                attemptItem.submittedValue = attempt.responses[x].printval;\n                break;\n              }\n            }\n          }\n          return attemptItem;\n        }).filter(itemData => itemData); // Filter items with errors.\n        _this2.logView();\n      } catch (message) {\n        // Some call failed on fetch, go back.\n        CoreDomUtils.showErrorModalDefault(message, 'core.course.errorgetmodule', true);\n        CoreNavigator.back();\n      } finally {\n        _this2.loaded = true;\n      }\n    })();\n  }\n  /**\n   * Check if an attempt is anonymous or not.\n   *\n   * @param attempt Attempt to check.\n   * @returns If attempt is anonymous.\n   */\n  isAnonAttempt(attempt) {\n    return !('fullname' in attempt);\n  }\n}\n/**\n * Helper to manage swiping within a collection of discussions.\n */\n_class = AddonModFeedbackAttemptPage;\n_class.ɵfac = function AddonModFeedbackAttemptPage_Factory(t) {\n  return new (t || _class)();\n};\n_class.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: _class,\n  selectors: [[\"page-addon-mod-feedback-attempt\"]],\n  decls: 11,\n  vars: 8,\n  consts: [[\"slot\", \"start\"], [3, \"text\"], [4, \"ngIf\"], [3, \"core-swipe-navigation\"], [3, \"hideUntil\"], [\"class\", \"ion-no-margin\", 4, \"ngIf\"], [1, \"ion-no-margin\"], [\"class\", \"ion-text-wrap\", \"core-user-link\", \"\", 3, \"userId\", \"courseId\", 4, \"ngIf\"], [\"class\", \"ion-text-wrap\", 4, \"ngIf\"], [\"core-user-link\", \"\", 1, \"ion-text-wrap\", 3, \"userId\", \"courseId\"], [\"slot\", \"start\", 3, \"user\", \"linkProfile\"], [1, \"ion-text-wrap\"], [\"slot\", \"start\", 3, \"linkProfile\"], [4, \"ngFor\", \"ngForOf\"], [\"class\", \"ion-text-wrap\", 3, \"color\", 4, \"ngIf\"], [1, \"ion-text-wrap\", 3, \"color\"], [\"class\", \"item-heading\", 3, \"core-mark-required\", 4, \"ngIf\"], [1, \"item-heading\", 3, \"core-mark-required\"], [\"contextLevel\", \"module\", 3, \"component\", \"componentId\", \"text\", \"contextInstanceId\", \"courseId\"]],\n  template: function AddonModFeedbackAttemptPage_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"ion-header\")(1, \"ion-toolbar\")(2, \"ion-buttons\", 0);\n      i0.ɵɵelement(3, \"ion-back-button\", 1);\n      i0.ɵɵpipe(4, \"translate\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(5, \"ion-title\");\n      i0.ɵɵtemplate(6, AddonModFeedbackAttemptPage_h1_6_Template, 2, 1, \"h1\", 2);\n      i0.ɵɵtemplate(7, AddonModFeedbackAttemptPage_h1_7_Template, 3, 3, \"h1\", 2);\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(8, \"ion-content\", 3)(9, \"core-loading\", 4);\n      i0.ɵɵtemplate(10, AddonModFeedbackAttemptPage_ion_list_10_Template, 4, 3, \"ion-list\", 5);\n      i0.ɵɵelementEnd()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"text\", i0.ɵɵpipeBind1(4, 6, \"core.back\"));\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngIf\", ctx.attempt);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.anonAttempt);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"core-swipe-navigation\", ctx.attempts);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"hideUntil\", ctx.loaded);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.attempt || ctx.anonAttempt);\n    }\n  },\n  dependencies: [i1.NgForOf, i1.NgIf, i2.CoreLoadingComponent, i3.CoreMarkRequiredComponent, i4.CoreUserAvatarComponent, i5.CoreSpacerComponent, i6.CoreFormatTextDirective, i7.CoreUserLinkDirective, i8.CoreSwipeNavigationDirective, i9.CoreContentDirective, i10.IonButtons, i10.IonContent, i10.IonHeader, i10.IonItem, i10.IonLabel, i10.IonList, i10.IonTitle, i10.IonToolbar, i10.IonBackButton, i11.CoreFormatDatePipe, i12.TranslatePipe],\n  encapsulation: 2\n});\nclass AddonModFeedbackAttemptsSwipeManager extends CoreSwipeNavigationItemsManager {\n  /**\n   * @inheritdoc\n   */\n  getSelectedItemPathFromRoute(route) {\n    return route.params.attemptId;\n  }\n}","map":{"version":3,"names":["CoreRoutedItemsManagerSourcesTracker","CoreSwipeNavigationItemsManager","CoreNavigator","CoreDomUtils","CoreTextUtils","AddonModFeedbackAttemptsSource","AddonModFeedback","AddonModFeedbackProvider","AddonModFeedbackHelper","CoreTime","CoreAnalytics","CoreAnalyticsEventType","i0","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵadvance","ɵɵtextInterpolate","ctx_r0","attempt","fullname","ɵɵpipeBind1","ctx_r6","timemodified","ɵɵelement","ɵɵtemplate","AddonModFeedbackAttemptPage_ion_list_10_ion_item_1_p_6_Template","ɵɵproperty","ctx_r3","userid","courseid","ɵɵattribute","ɵɵtextInterpolate2","ctx_r4","anonAttempt","number","ɵɵtextInterpolate1","item_r8","itemnumber","AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_ion_item_2_p_2_span_1_Template","required","ctx_r11","feedback","autonumbering","component","cmId","name","courseId","ctx_r12","submittedValue","AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_ion_item_2_p_2_Template","AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_ion_item_2_p_3_Template","dependitem","ɵɵelementContainerStart","AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_core_spacer_1_Template","AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_ion_item_2_Template","ɵɵelementContainerEnd","typ","AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_Template","ctx_r5","items","AddonModFeedbackAttemptPage_ion_list_10_ion_item_1_Template","AddonModFeedbackAttemptPage_ion_list_10_ion_item_2_Template","AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_Template","ctx_r2","length","AddonModFeedbackAttemptPage","constructor","COMPONENT","loaded","getRequiredRouteNumberParam","attemptId","groupId","getRouteNumberParam","source","getOrCreateSource","attempts","AddonModFeedbackAttemptsSwipeManager","logView","once","logEvent","type","VIEW_ITEM","ws","data","id","feedbackid","category","url","ngOnInit","_this","_asyncToGenerator","start","error","showErrorModal","back","fetchData","ngOnDestroy","destroy","_this2","getFeedback","getAttempt","isAnonAttempt","addImageProfile","getItems","map","item","formItem","getItemForm","attemptItem","replacePluginfileUrls","presentation","itemfiles","x","responses","printval","filter","itemData","message","showErrorModalDefault","_class","selectors","decls","vars","consts","template","AddonModFeedbackAttemptPage_Template","rf","ctx","AddonModFeedbackAttemptPage_h1_6_Template","AddonModFeedbackAttemptPage_h1_7_Template","AddonModFeedbackAttemptPage_ion_list_10_Template","getSelectedItemPathFromRoute","route","params"],"sources":["/home/toon/works/gitionic7/ionic-github/ionic/src/addons/mod/feedback/pages/attempt/attempt.ts","/home/toon/works/gitionic7/ionic-github/ionic/src/addons/mod/feedback/pages/attempt/attempt.html"],"sourcesContent":["// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Component, OnDestroy, OnInit } from '@angular/core';\nimport { ActivatedRouteSnapshot } from '@angular/router';\nimport { CoreRoutedItemsManagerSourcesTracker } from '@classes/items-management/routed-items-manager-sources-tracker';\nimport { CoreSwipeNavigationItemsManager } from '@classes/items-management/swipe-navigation-items-manager';\nimport { CoreNavigator } from '@services/navigator';\nimport { CoreDomUtils } from '@services/utils/dom';\nimport { CoreTextUtils } from '@services/utils/text';\nimport { AddonModFeedbackAttemptsSource } from '../../classes/feedback-attempts-source';\nimport {\n    AddonModFeedback,\n    AddonModFeedbackProvider,\n    AddonModFeedbackWSAnonAttempt,\n    AddonModFeedbackWSFeedback,\n} from '../../services/feedback';\nimport { AddonModFeedbackAttempt, AddonModFeedbackFormItem, AddonModFeedbackHelper } from '../../services/feedback-helper';\nimport { CoreTime } from '@singletons/time';\nimport { CoreAnalytics, CoreAnalyticsEventType } from '@services/analytics';\n\n/**\n * Page that displays a feedback attempt review.\n */\n@Component({\n    selector: 'page-addon-mod-feedback-attempt',\n    templateUrl: 'attempt.html',\n})\nexport class AddonModFeedbackAttemptPage implements OnInit, OnDestroy {\n\n    cmId: number;\n    courseId: number;\n    feedback?: AddonModFeedbackWSFeedback;\n    attempt?: AddonModFeedbackAttempt;\n    attempts: AddonModFeedbackAttemptsSwipeManager;\n    anonAttempt?: AddonModFeedbackWSAnonAttempt;\n    items: AddonModFeedbackAttemptItem[] = [];\n    component = AddonModFeedbackProvider.COMPONENT;\n    loaded = false;\n\n    protected attemptId: number;\n    protected groupId?: number;\n    protected logView: () => void;\n\n    constructor() {\n        this.cmId = CoreNavigator.getRequiredRouteNumberParam('cmId');\n        this.courseId = CoreNavigator.getRequiredRouteNumberParam('courseId');\n        this.attemptId = CoreNavigator.getRequiredRouteNumberParam('attemptId');\n        this.groupId = CoreNavigator.getRouteNumberParam('groupId');\n\n        const source = CoreRoutedItemsManagerSourcesTracker.getOrCreateSource(\n            AddonModFeedbackAttemptsSource,\n            [this.courseId, this.cmId],\n        );\n\n        this.attempts = new AddonModFeedbackAttemptsSwipeManager(source);\n\n        this.logView = CoreTime.once(() => {\n            if (!this.feedback) {\n                return;\n            }\n\n            CoreAnalytics.logEvent({\n                type: CoreAnalyticsEventType.VIEW_ITEM,\n                ws: 'mod_feedback_get_responses_analysis',\n                name: this.feedback.name,\n                data: { id: this.attemptId, feedbackid: this.feedback.id, category: 'feedback' },\n                url: `/mod/feedback/show_entries.php?id=${this.cmId}` +\n                    (this.attempt ? `userid=${this.attempt.userid}` : '' ) + `&showcompleted=${this.attemptId}`,\n            });\n        });\n    }\n\n    /**\n     * @inheritdoc\n     */\n    async ngOnInit(): Promise<void> {\n        try {\n            await this.attempts.start();\n        } catch (error) {\n            CoreDomUtils.showErrorModal(error);\n\n            CoreNavigator.back();\n\n            return;\n        }\n\n        this.fetchData();\n    }\n\n    /**\n     * @inheritdoc\n     */\n    ngOnDestroy(): void {\n        this.attempts.destroy();\n    }\n\n    /**\n     * Fetch all the data required for the view.\n     *\n     * @returns Promise resolved when done.\n     */\n    protected async fetchData(): Promise<void> {\n        try {\n            this.feedback = await AddonModFeedback.getFeedback(this.courseId, this.cmId);\n\n            const attempt = await AddonModFeedback.getAttempt(this.feedback.id, this.attemptId, {\n                cmId: this.cmId,\n                groupId: this.groupId,\n            });\n\n            if (this.isAnonAttempt(attempt)) {\n                this.anonAttempt = attempt;\n                delete this.attempt;\n            } else {\n                this.attempt = (await AddonModFeedbackHelper.addImageProfile([attempt]))[0];\n                delete this.anonAttempt;\n            }\n\n            const items = await AddonModFeedback.getItems(this.feedback.id, { cmId: this.cmId });\n\n            // Add responses and format items.\n            this.items = <AddonModFeedbackAttemptItem[]> items.items.map((item) => {\n                const formItem = AddonModFeedbackHelper.getItemForm(item, true);\n                if (!formItem) {\n                    return;\n                }\n\n                const attemptItem = <AddonModFeedbackAttemptItem> formItem;\n\n                if (item.typ == 'label') {\n                    attemptItem.submittedValue = CoreTextUtils.replacePluginfileUrls(item.presentation, item.itemfiles);\n                } else {\n                    for (const x in attempt.responses) {\n                        if (attempt.responses[x].id == item.id) {\n                            attemptItem.submittedValue = attempt.responses[x].printval;\n                            break;\n                        }\n                    }\n                }\n\n                return attemptItem;\n            }).filter((itemData) => itemData); // Filter items with errors.\n\n            this.logView();\n        } catch (message) {\n            // Some call failed on fetch, go back.\n            CoreDomUtils.showErrorModalDefault(message, 'core.course.errorgetmodule', true);\n            CoreNavigator.back();\n        } finally {\n            this.loaded = true;\n        }\n    }\n\n    /**\n     * Check if an attempt is anonymous or not.\n     *\n     * @param attempt Attempt to check.\n     * @returns If attempt is anonymous.\n     */\n    isAnonAttempt(attempt: AddonModFeedbackAttempt | AddonModFeedbackWSAnonAttempt): attempt is AddonModFeedbackWSAnonAttempt {\n        return !('fullname' in attempt);\n    }\n\n}\n\ntype AddonModFeedbackAttemptItem = AddonModFeedbackFormItem & {\n    submittedValue?: string;\n};\n\n/**\n * Helper to manage swiping within a collection of discussions.\n */\nclass AddonModFeedbackAttemptsSwipeManager extends CoreSwipeNavigationItemsManager {\n\n    /**\n     * @inheritdoc\n     */\n    protected getSelectedItemPathFromRoute(route: ActivatedRouteSnapshot): string | null {\n        return route.params.attemptId;\n    }\n\n}\n","<ion-header>\n    <ion-toolbar>\n        <ion-buttons slot=\"start\">\n            <ion-back-button [text]=\"'core.back' | translate\" />\n        </ion-buttons>\n        <ion-title>\n            <h1 *ngIf=\"attempt\">{{ attempt.fullname }}</h1>\n            <h1 *ngIf=\"anonAttempt\">{{ 'addon.mod_feedback.anonymous_user' | translate }}</h1>\n        </ion-title>\n    </ion-toolbar>\n</ion-header>\n<ion-content [core-swipe-navigation]=\"attempts\">\n    <core-loading [hideUntil]=\"loaded\">\n        <ion-list class=\"ion-no-margin\" *ngIf=\"attempt || anonAttempt\">\n            <ion-item *ngIf=\"attempt\" class=\"ion-text-wrap\" core-user-link [userId]=\"attempt.userid\"\n                [attr.aria-label]=\"'core.user.viewprofile' | translate\" [courseId]=\"attempt.courseid\">\n                <core-user-avatar [user]=\"attempt\" slot=\"start\" [linkProfile]=\"false\" />\n                <ion-label>\n                    <h2>{{attempt.fullname}}</h2>\n                    <p *ngIf=\"attempt.timemodified\">{{attempt.timemodified * 1000 | coreFormatDate }}</p>\n                </ion-label>\n            </ion-item>\n\n            <ion-item class=\"ion-text-wrap\" *ngIf=\"anonAttempt\">\n                <core-user-avatar [linkProfile]=\"false\" slot=\"start\" />\n                <ion-label>\n                    <h2>{{ 'addon.mod_feedback.anonymous_user' |translate }}</h2>\n                    <p>{{ 'addon.mod_feedback.response_nr' | translate }}: {{anonAttempt.number}}</p>\n                </ion-label>\n            </ion-item>\n            <ng-container *ngIf=\"items && items.length\">\n                <ng-container *ngFor=\"let item of items\">\n                    <core-spacer *ngIf=\"item.typ === 'pagebreak'\" />\n                    <ion-item class=\"ion-text-wrap\" *ngIf=\"item.typ !== 'pagebreak'\" [color]=\"item.dependitem > 0 ? 'light' : ''\">\n                        <ion-label>\n                            <p class=\"item-heading\" *ngIf=\"item.name\" [core-mark-required]=\"item.required\">\n                                <span *ngIf=\"feedback!.autonumbering && item.itemnumber\">{{item.itemnumber}}. </span>\n                                <core-format-text [component]=\"component\" [componentId]=\"cmId\" [text]=\"item.name\" contextLevel=\"module\"\n                                    [contextInstanceId]=\"cmId\" [courseId]=\"courseId\" />\n                            </p>\n                            <p *ngIf=\"item.submittedValue\">\n                                <core-format-text [component]=\"component\" [componentId]=\"cmId\" [text]=\"item.submittedValue\"\n                                    contextLevel=\"module\" [contextInstanceId]=\"cmId\" [courseId]=\"courseId\" />\n                            </p>\n                        </ion-label>\n                    </ion-item>\n                </ng-container>\n            </ng-container>\n        </ion-list>\n    </core-loading>\n</ion-content>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"import _asyncToGenerator from \"/home/toon/works/gitionic7/ionic-github/ionic/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _class;\nimport { EventEmitter } from '@angular/core';\nimport { CorePromisedValue } from '@classes/promised-value';\nimport { CoreUserToursFocusLayout } from '@features/usertours/classes/focus-layout';\nimport { CoreUserToursPopoverLayout } from '@features/usertours/classes/popover-layout';\nimport { CoreUserTours } from '@features/usertours/services/user-tours';\nimport { CoreDomUtils } from '@services/utils/dom';\nimport { AngularFrameworkDelegate } from '@singletons';\nimport { CoreDirectivesRegistry } from '@singletons/directives-registry';\nimport { CoreDom } from '@singletons/dom';\nimport { CoreEvents } from '@singletons/events';\nimport { CoreMainMenuProvider } from '@features/mainmenu/services/mainmenu';\nimport { COLLAPSIBLE_HEADER_UPDATED } from '@directives/collapsible-header';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nconst _c0 = [\"wrapper\"];\nfunction CoreUserToursUserTourComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"div\", 5);\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵstyleMap(ctx_r0.focusStyles);\n  }\n}\nfunction CoreUserToursUserTourComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"div\", 6);\n  }\n}\nfunction CoreUserToursUserTourComponent_span_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"span\", 7);\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵstyleMap(ctx_r3.popoverWrapperArrowStyles);\n  }\n}\nconst ANIMATION_DURATION = 200;\nconst USER_TOURS_BACK_BUTTON_PRIORITY = 100;\nconst BACKDROP_DISMISS_SAFETY_TRESHOLD = 1000;\n/**\n * User Tour wrapper component.\n *\n * User Tours content will be rendered within this component according to the configured style.\n */\nexport class CoreUserToursUserTourComponent {\n  constructor({\n    nativeElement: element\n  }) {\n    this.beforeDismiss = new EventEmitter();\n    this.afterDismiss = new EventEmitter();\n    this.active = false;\n    this.popover = false;\n    this.backdrop = true;\n    this.wrapperTransform = '';\n    this.wrapperElement = new CorePromisedValue();\n    this.lastActivatedTime = 0;\n    this.element = element;\n    CoreDirectivesRegistry.register(element, this);\n    this.element.addEventListener('click', event => this.dismissOnBackOrBackdrop(event.target));\n  }\n  /**\n   * @inheritdoc\n   */\n  ngAfterViewInit() {\n    if (!this.wrapper) {\n      return;\n    }\n    this.wrapperElement.resolve(this.wrapper.nativeElement);\n  }\n  /**\n   * Show User Tour.\n   */\n  show() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      var _this$componentProps;\n      // Insert tour component and wait until it's ready.\n      const wrapper = yield _this.wrapperElement;\n      _this.tour = yield AngularFrameworkDelegate.attachViewToDom(wrapper, _this.component, (_this$componentProps = _this.componentProps) !== null && _this$componentProps !== void 0 ? _this$componentProps : {});\n      if (!_this.tour) {\n        return;\n      }\n      yield CoreDomUtils.waitForImages(_this.tour);\n      // Calculate focus styles or dismiss if the element is gone.\n      if (_this.focus && !CoreDom.isElementVisible(_this.focus)) {\n        yield _this.dismiss(false);\n        return;\n      }\n      _this.calculateStyles();\n      _this.activate();\n      yield _this.playEnterAnimation();\n    })();\n  }\n  /**\n   * Hide User Tour temporarily.\n   */\n  hide() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      const wrapper = yield _this2.wrapperElement;\n      yield _this2.playLeaveAnimation();\n      yield AngularFrameworkDelegate.removeViewFromDom(wrapper, _this2.tour);\n      _this2.deactivate();\n    })();\n  }\n  /**\n   * Dismiss User Tour.\n   *\n   * @param acknowledge Whether to confirm that the user has seen the User Tour.\n   */\n  dismiss(acknowledge = true) {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      _this3.beforeDismiss.emit();\n      if (_this3.active) {\n        yield _this3.playLeaveAnimation();\n      }\n      yield AngularFrameworkDelegate.removeViewFromDom(_this3.container, _this3.element);\n      _this3.deactivate();\n      acknowledge && (yield CoreUserTours.acknowledge(_this3.id));\n      _this3.afterDismiss.emit();\n    })();\n  }\n  /**\n   * Calculate inline styles.\n   */\n  calculateStyles() {\n    var _popoverLayout$wrappe;\n    if (!this.focus) {\n      return;\n    }\n    // Calculate focus styles.\n    const focusLayout = new CoreUserToursFocusLayout(this.focus);\n    this.focusStyles = focusLayout.inlineStyles;\n    // Calculate popup styles.\n    if (!this.side || !this.alignment) {\n      throw new Error('Cannot create a focused user tour without side and alignment');\n    }\n    const popoverLayout = new CoreUserToursPopoverLayout(this.focus, this.side, this.alignment);\n    this.popover = true;\n    this.popoverWrapperStyles = popoverLayout.wrapperInlineStyles;\n    this.popoverWrapperArrowStyles = popoverLayout.wrapperArrowInlineStyles;\n    this.wrapperTransform = `${(_popoverLayout$wrappe = popoverLayout.wrapperStyles.transform) !== null && _popoverLayout$wrappe !== void 0 ? _popoverLayout$wrappe : ''}`;\n  }\n  /**\n   * Play animation to show that the User Tour has started.\n   */\n  playEnterAnimation() {\n    var _this4 = this;\n    return _asyncToGenerator(function* () {\n      var _this4$wrapperElement;\n      if (!('animate' in _this4.element)) {\n        // Not supported, don't animate.\n        return;\n      }\n      const animations = [_this4.element.animate({\n        opacity: ['0', '1']\n      }, {\n        duration: ANIMATION_DURATION\n      }), (_this4$wrapperElement = _this4.wrapperElement.value) === null || _this4$wrapperElement === void 0 ? void 0 : _this4$wrapperElement.animate({\n        transform: [`scale(1.2) ${_this4.wrapperTransform}`, `scale(1) ${_this4.wrapperTransform}`]\n      }, {\n        duration: ANIMATION_DURATION\n      })];\n      yield Promise.all(animations.map(animation => animation === null || animation === void 0 ? void 0 : animation.finished));\n    })();\n  }\n  /**\n   * Play animation to show that the User Tour has endd.\n   */\n  playLeaveAnimation() {\n    var _this5 = this;\n    return _asyncToGenerator(function* () {\n      var _this5$wrapperElement;\n      if (!('animate' in _this5.element)) {\n        // Not supported, don't animate.\n        return;\n      }\n      const animations = [_this5.element.animate({\n        opacity: ['1', '0']\n      }, {\n        duration: ANIMATION_DURATION\n      }), (_this5$wrapperElement = _this5.wrapperElement.value) === null || _this5$wrapperElement === void 0 ? void 0 : _this5$wrapperElement.animate({\n        transform: [`scale(1) ${_this5.wrapperTransform}`, `scale(1.2) ${_this5.wrapperTransform}`]\n      }, {\n        duration: ANIMATION_DURATION\n      })];\n      yield Promise.all(animations.map(animation => animation === null || animation === void 0 ? void 0 : animation.finished));\n    })();\n  }\n  /**\n   * @inheritdoc\n   */\n  ngOnDestroy() {\n    this.deactivate();\n  }\n  /**\n   * Activate tour.\n   */\n  activate() {\n    var _this$collapsibleHead, _this$mainMenuListene, _this$resizeListener, _this$content;\n    if (this.active) {\n      return;\n    }\n    this.active = true;\n    this.lastActivatedTime = Date.now();\n    if (!this.backButtonListener) {\n      document.addEventListener('ionBackButton', this.backButtonListener = ({\n        detail\n      }) => detail.register(USER_TOURS_BACK_BUTTON_PRIORITY, () => {\n        this.dismissOnBackOrBackdrop();\n      }));\n    }\n    if (!this.focus) {\n      return;\n    }\n    this.collapsibleHeaderListener = (_this$collapsibleHead = this.collapsibleHeaderListener) !== null && _this$collapsibleHead !== void 0 ? _this$collapsibleHead : CoreEvents.on(COLLAPSIBLE_HEADER_UPDATED, () => this.calculateStyles());\n    this.mainMenuListener = (_this$mainMenuListene = this.mainMenuListener) !== null && _this$mainMenuListene !== void 0 ? _this$mainMenuListene : CoreEvents.on(CoreMainMenuProvider.MAIN_MENU_VISIBILITY_UPDATED, () => this.calculateStyles());\n    this.resizeListener = (_this$resizeListener = this.resizeListener) !== null && _this$resizeListener !== void 0 ? _this$resizeListener : CoreDom.onWindowResize(() => this.calculateStyles());\n    this.content = (_this$content = this.content) !== null && _this$content !== void 0 ? _this$content : CoreDom.closest(this.focus, 'ion-content');\n    if (!this.scrollListener && this.content) {\n      this.content.scrollEvents = true;\n      this.content.addEventListener('ionScrollEnd', this.scrollListener = () => {\n        this.calculateStyles();\n      });\n    }\n  }\n  /**\n   * Deactivate tour.\n   */\n  deactivate() {\n    var _this$collapsibleHead2, _this$mainMenuListene2, _this$resizeListener2;\n    if (!this.active) {\n      return;\n    }\n    this.active = false;\n    (_this$collapsibleHead2 = this.collapsibleHeaderListener) === null || _this$collapsibleHead2 === void 0 || _this$collapsibleHead2.off();\n    (_this$mainMenuListene2 = this.mainMenuListener) === null || _this$mainMenuListene2 === void 0 || _this$mainMenuListene2.off();\n    (_this$resizeListener2 = this.resizeListener) === null || _this$resizeListener2 === void 0 || _this$resizeListener2.off();\n    this.backButtonListener && document.removeEventListener('ionBackButton', this.backButtonListener);\n    this.backButtonListener = undefined;\n    this.collapsibleHeaderListener = undefined;\n    this.mainMenuListener = undefined;\n    this.resizeListener = undefined;\n    if (this.content && this.scrollListener) {\n      this.content.removeEventListener('ionScrollEnd', this.scrollListener);\n    }\n  }\n  /**\n   * Dismiss the tour because backdrop or back button was clicked.\n   *\n   * @param target Element clicked (if any).\n   */\n  dismissOnBackOrBackdrop(target) {\n    if (!this.active || Date.now() - this.lastActivatedTime < BACKDROP_DISMISS_SAFETY_TRESHOLD) {\n      // Not active or was recently activated, ignore.\n      return;\n    }\n    if (target && target.closest('.user-tour-wrapper')) {\n      // Click on tour wrapper, don't dismiss.\n      return;\n    }\n    this.dismiss(true);\n  }\n}\n_class = CoreUserToursUserTourComponent;\n_class.ɵfac = function CoreUserToursUserTourComponent_Factory(t) {\n  return new (t || _class)(i0.ɵɵdirectiveInject(i0.ElementRef));\n};\n_class.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: _class,\n  selectors: [[\"core-user-tours-user-tour\"]],\n  viewQuery: function CoreUserToursUserTourComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(_c0, 5);\n    }\n    if (rf & 2) {\n      let _t;\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.wrapper = _t.first);\n    }\n  },\n  hostVars: 6,\n  hostBindings: function CoreUserToursUserTourComponent_HostBindings(rf, ctx) {\n    if (rf & 2) {\n      i0.ɵɵclassProp(\"is-active\", ctx.active)(\"is-popover\", ctx.popover)(\"backdrop\", ctx.backdrop);\n    }\n  },\n  inputs: {\n    container: \"container\",\n    id: \"id\",\n    component: \"component\",\n    componentProps: \"componentProps\",\n    focus: \"focus\",\n    side: \"side\",\n    alignment: \"alignment\"\n  },\n  outputs: {\n    beforeDismiss: \"beforeDismiss\",\n    afterDismiss: \"afterDismiss\"\n  },\n  decls: 5,\n  vars: 5,\n  consts: [[\"class\", \"user-tour-focus\", 3, \"style\", 4, \"ngIf\"], [\"class\", \"user-tour-overlay\", 4, \"ngIf\"], [1, \"user-tour-wrapper\"], [\"wrapper\", \"\"], [\"class\", \"user-tour-wrapper-arrow\", 3, \"style\", 4, \"ngIf\"], [1, \"user-tour-focus\"], [1, \"user-tour-overlay\"], [1, \"user-tour-wrapper-arrow\"]],\n  template: function CoreUserToursUserTourComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵtemplate(0, CoreUserToursUserTourComponent_div_0_Template, 1, 2, \"div\", 0);\n      i0.ɵɵtemplate(1, CoreUserToursUserTourComponent_div_1_Template, 1, 0, \"div\", 1);\n      i0.ɵɵelementStart(2, \"div\", 2, 3);\n      i0.ɵɵtemplate(4, CoreUserToursUserTourComponent_span_4_Template, 1, 2, \"span\", 4);\n      i0.ɵɵelementEnd();\n    }\n    if (rf & 2) {\n      i0.ɵɵproperty(\"ngIf\", ctx.focusStyles);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", !ctx.focusStyles);\n      i0.ɵɵadvance(1);\n      i0.ɵɵstyleMap(ctx.popoverWrapperStyles);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", ctx.popover);\n    }\n  },\n  dependencies: [i1.NgIf],\n  styles: [\"[_nghost-%COMP%] {\\n  --popover-background: var(--ion-overlay-background-color, var(--ion-background-color, #fff));\\n  z-index: 105;\\n  width: 100%;\\n  height: 100%;\\n  display: none;\\n  color: white;\\n}\\n[_nghost-%COMP%]   .user-tour-focus[_ngcontent-%COMP%] {\\n  position: absolute;\\n  box-shadow: 0 0 0 9999px rgba(0, 0, 0, 0.75);\\n}\\n[_nghost-%COMP%]   .user-tour-overlay[_ngcontent-%COMP%] {\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  width: 100%;\\n  height: 100%;\\n  background: rgba(0, 0, 0, 0.75);\\n}\\n[_nghost-%COMP%]   .user-tour-wrapper[_ngcontent-%COMP%] {\\n  position: absolute;\\n}\\n.is-active[_nghost-%COMP%] {\\n  display: block;\\n}\\n.is-popover[_nghost-%COMP%]   .user-tour-wrapper[_ngcontent-%COMP%] {\\n  color: var(--ion-text-color, #000);\\n  background: var(--popover-background);\\n  width: 70vw;\\n  max-width: 400px;\\n  padding: 16px;\\n  border-radius: 8px;\\n}\\n.is-popover[_nghost-%COMP%]   .user-tour-wrapper[_ngcontent-%COMP%]   .user-tour-wrapper-arrow[_ngcontent-%COMP%] {\\n  position: absolute;\\n  border-style: solid;\\n  border-color: transparent;\\n}\\n[_nghost-%COMP%]:not(.is-popover)   .user-tour-wrapper[_ngcontent-%COMP%] {\\n  top: 0;\\n  left: 0;\\n  width: 100%;\\n  height: 100%;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n}\\n[_nghost-%COMP%]   h1[_ngcontent-%COMP%] {\\n  margin-top: 0px;\\n}\\n\\nhtml.dark[_nghost-%COMP%], html.dark   [_nghost-%COMP%] {\\n  --popover-background: var(--gray-700);\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9jb3JlL2ZlYXR1cmVzL3VzZXJ0b3Vycy9jb21wb25lbnRzL3VzZXItdG91ci91c2VyLXRvdXIuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLDRGQUFBO0VBRUEsWUFBQTtFQUNBLFdBQUE7RUFDQSxZQUFBO0VBQ0EsYUFBQTtFQUNBLFlBQUE7QUFBSjtBQUVJO0VBQ0ksa0JBQUE7RUFDQSw0Q0FBQTtBQUFSO0FBR0k7RUFDSSxrQkFBQTtFQUNBLE1BQUE7RUFDQSxPQUFBO0VBQ0EsV0FBQTtFQUNBLFlBQUE7RUFDQSwrQkFBQTtBQURSO0FBSUk7RUFDSSxrQkFBQTtBQUZSO0FBS0k7RUFDSSxjQUFBO0FBSFI7QUFNSTtFQUNJLGtDQUFBO0VBQ0EscUNBQUE7RUFDQSxXQUFBO0VBQ0EsZ0JBQUE7RUFDQSxhQUFBO0VBQ0Esa0JBQUE7QUFKUjtBQU1RO0VBQ0ksa0JBQUE7RUFDQSxtQkFBQTtFQUNBLHlCQUFBO0FBSlo7QUFTSTtFQUNJLE1BQUE7RUFDQSxPQUFBO0VBQ0EsV0FBQTtFQUNBLFlBQUE7RUFDQSxhQUFBO0VBQ0EsbUJBQUE7RUFDQSx1QkFBQTtBQVBSO0FBVUk7RUFDSSxlQUFBO0FBUlI7O0FBYUE7RUFDSSxxQ0FBQTtBQVZKIiwic291cmNlc0NvbnRlbnQiOlsiOmhvc3Qge1xuICAgIC0tcG9wb3Zlci1iYWNrZ3JvdW5kOiB2YXIoLS1pb24tb3ZlcmxheS1iYWNrZ3JvdW5kLWNvbG9yLCB2YXIoLS1pb24tYmFja2dyb3VuZC1jb2xvciwgI2ZmZikpO1xuXG4gICAgei1pbmRleDogMTA1OyAvLyBNYWluIG1lbnUgaXMgMTAxLlxuICAgIHdpZHRoOiAxMDAlO1xuICAgIGhlaWdodDogMTAwJTtcbiAgICBkaXNwbGF5OiBub25lO1xuICAgIGNvbG9yOiB3aGl0ZTtcblxuICAgIC51c2VyLXRvdXItZm9jdXMge1xuICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICAgIGJveC1zaGFkb3c6IDAgMCAwIDk5OTlweCByZ2JhKDAsIDAsIDAsIDAuNzUpO1xuICAgIH1cblxuICAgIC51c2VyLXRvdXItb3ZlcmxheSB7XG4gICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICAgICAgdG9wOiAwO1xuICAgICAgICBsZWZ0OiAwO1xuICAgICAgICB3aWR0aDogMTAwJTtcbiAgICAgICAgaGVpZ2h0OiAxMDAlO1xuICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuNzUpO1xuICAgIH1cblxuICAgIC51c2VyLXRvdXItd3JhcHBlciB7XG4gICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICB9XG5cbiAgICAmLmlzLWFjdGl2ZSB7XG4gICAgICAgIGRpc3BsYXk6IGJsb2NrO1xuICAgIH1cblxuICAgICYuaXMtcG9wb3ZlciAudXNlci10b3VyLXdyYXBwZXIge1xuICAgICAgICBjb2xvcjogdmFyKC0taW9uLXRleHQtY29sb3IsICMwMDApO1xuICAgICAgICBiYWNrZ3JvdW5kOiB2YXIoLS1wb3BvdmVyLWJhY2tncm91bmQpO1xuICAgICAgICB3aWR0aDogNzB2dztcbiAgICAgICAgbWF4LXdpZHRoOiA0MDBweDtcbiAgICAgICAgcGFkZGluZzogMTZweDtcbiAgICAgICAgYm9yZGVyLXJhZGl1czogOHB4O1xuXG4gICAgICAgIC51c2VyLXRvdXItd3JhcHBlci1hcnJvdyB7XG4gICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICAgICAgICBib3JkZXItc3R5bGU6IHNvbGlkO1xuICAgICAgICAgICAgYm9yZGVyLWNvbG9yOiB0cmFuc3BhcmVudDtcbiAgICAgICAgfVxuXG4gICAgfVxuXG4gICAgJjpub3QoLmlzLXBvcG92ZXIpIC51c2VyLXRvdXItd3JhcHBlciB7XG4gICAgICAgIHRvcDogMDtcbiAgICAgICAgbGVmdDogMDtcbiAgICAgICAgd2lkdGg6IDEwMCU7XG4gICAgICAgIGhlaWdodDogMTAwJTtcbiAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gICAgfVxuXG4gICAgaDEge1xuICAgICAgICBtYXJnaW4tdG9wOiAwcHg7XG4gICAgfVxuXG59XG5cbjpob3N0LWNvbnRleHQoaHRtbC5kYXJrKSB7XG4gICAgLS1wb3BvdmVyLWJhY2tncm91bmQ6IHZhcigtLWdyYXktNzAwKTtcbn1cbiJdLCJzb3VyY2VSb290IjoiIn0= */\"]\n});","map":{"version":3,"names":["EventEmitter","CorePromisedValue","CoreUserToursFocusLayout","CoreUserToursPopoverLayout","CoreUserTours","CoreDomUtils","AngularFrameworkDelegate","CoreDirectivesRegistry","CoreDom","CoreEvents","CoreMainMenuProvider","COLLAPSIBLE_HEADER_UPDATED","i0","ɵɵelement","ɵɵstyleMap","ctx_r0","focusStyles","ctx_r3","popoverWrapperArrowStyles","ANIMATION_DURATION","USER_TOURS_BACK_BUTTON_PRIORITY","BACKDROP_DISMISS_SAFETY_TRESHOLD","CoreUserToursUserTourComponent","constructor","nativeElement","element","beforeDismiss","afterDismiss","active","popover","backdrop","wrapperTransform","wrapperElement","lastActivatedTime","register","addEventListener","event","dismissOnBackOrBackdrop","target","ngAfterViewInit","wrapper","resolve","show","_this","_asyncToGenerator","_this$componentProps","tour","attachViewToDom","component","componentProps","waitForImages","focus","isElementVisible","dismiss","calculateStyles","activate","playEnterAnimation","hide","_this2","playLeaveAnimation","removeViewFromDom","deactivate","acknowledge","_this3","emit","container","id","_popoverLayout$wrappe","focusLayout","inlineStyles","side","alignment","Error","popoverLayout","popoverWrapperStyles","wrapperInlineStyles","wrapperArrowInlineStyles","wrapperStyles","transform","_this4","_this4$wrapperElement","animations","animate","opacity","duration","value","Promise","all","map","animation","finished","_this5","_this5$wrapperElement","ngOnDestroy","_this$collapsibleHead","_this$mainMenuListene","_this$resizeListener","_this$content","Date","now","backButtonListener","document","detail","collapsibleHeaderListener","on","mainMenuListener","MAIN_MENU_VISIBILITY_UPDATED","resizeListener","onWindowResize","content","closest","scrollListener","scrollEvents","_this$collapsibleHead2","_this$mainMenuListene2","_this$resizeListener2","off","removeEventListener","undefined","ɵɵdirectiveInject","ElementRef","selectors","viewQuery","CoreUserToursUserTourComponent_Query","rf","ctx","ɵɵtemplate","CoreUserToursUserTourComponent_div_0_Template","CoreUserToursUserTourComponent_div_1_Template","ɵɵelementStart","CoreUserToursUserTourComponent_span_4_Template","ɵɵelementEnd","ɵɵproperty","ɵɵadvance"],"sources":["/home/toon/works/gitionic7/ionic-github/ionic/src/core/features/usertours/components/user-tour/user-tour.ts","/home/toon/works/gitionic7/ionic-github/ionic/src/core/features/usertours/components/user-tour/core-user-tours-user-tour.html"],"sourcesContent":["// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { BackButtonEvent } from '@ionic/core';\nimport {\n    AfterViewInit,\n    Component,\n    ElementRef,\n    EventEmitter,\n    HostBinding,\n    Input,\n    OnDestroy,\n    Output,\n    ViewChild,\n} from '@angular/core';\nimport { CorePromisedValue } from '@classes/promised-value';\nimport { CoreUserToursFocusLayout } from '@features/usertours/classes/focus-layout';\nimport { CoreUserToursPopoverLayout } from '@features/usertours/classes/popover-layout';\nimport { CoreUserTours, CoreUserToursAlignment, CoreUserToursSide } from '@features/usertours/services/user-tours';\nimport { CoreDomUtils } from '@services/utils/dom';\nimport { AngularFrameworkDelegate } from '@singletons';\nimport { CoreDirectivesRegistry } from '@singletons/directives-registry';\nimport { CoreDom } from '@singletons/dom';\nimport { CoreEventObserver, CoreEvents } from '@singletons/events';\nimport { CoreMainMenuProvider } from '@features/mainmenu/services/mainmenu';\nimport { COLLAPSIBLE_HEADER_UPDATED } from '@directives/collapsible-header';\n\nconst ANIMATION_DURATION = 200;\nconst USER_TOURS_BACK_BUTTON_PRIORITY = 100;\nconst BACKDROP_DISMISS_SAFETY_TRESHOLD = 1000;\n\n/**\n * User Tour wrapper component.\n *\n * User Tours content will be rendered within this component according to the configured style.\n */\n@Component({\n    selector: 'core-user-tours-user-tour',\n    templateUrl: 'core-user-tours-user-tour.html',\n    styleUrls: ['user-tour.scss'],\n})\nexport class CoreUserToursUserTourComponent implements AfterViewInit, OnDestroy {\n\n    @Input() container!: HTMLElement;\n    @Input() id!: string;\n    @Input() component!: unknown;\n    @Input() componentProps?: Record<string, unknown>;\n    @Input() focus?: HTMLElement;\n    @Input() side?: CoreUserToursSide;\n    @Input() alignment?: CoreUserToursAlignment;\n    @Output() beforeDismiss = new EventEmitter<void>();\n    @Output() afterDismiss = new EventEmitter<void>();\n    @HostBinding('class.is-active') active = false;\n    @HostBinding('class.is-popover') popover = false;\n    @HostBinding('class.backdrop') backdrop = true;\n    @ViewChild('wrapper') wrapper?: ElementRef<HTMLElement>;\n\n    focusStyles?: string;\n    popoverWrapperStyles?: string;\n    popoverWrapperArrowStyles?: string;\n    private element: HTMLElement;\n    private tour?: HTMLElement;\n    private wrapperTransform = '';\n    private wrapperElement = new CorePromisedValue<HTMLElement>();\n    private backButtonListener?: (event: BackButtonEvent) => void;\n    protected collapsibleHeaderListener?: CoreEventObserver;\n    protected mainMenuListener?: CoreEventObserver;\n    protected resizeListener?: CoreEventObserver;\n    protected scrollListener?: EventListener;\n    protected content?: HTMLIonContentElement | null;\n    protected lastActivatedTime = 0;\n\n    constructor({ nativeElement: element }: ElementRef<HTMLElement>) {\n        this.element = element;\n\n        CoreDirectivesRegistry.register(element, this);\n\n        this.element.addEventListener('click', (event) =>\n            this.dismissOnBackOrBackdrop(event.target as HTMLElement));\n    }\n\n    /**\n     * @inheritdoc\n     */\n    ngAfterViewInit(): void {\n        if (!this.wrapper) {\n            return;\n        }\n\n        this.wrapperElement.resolve(this.wrapper.nativeElement);\n    }\n\n    /**\n     * Show User Tour.\n     */\n    async show(): Promise<void> {\n        // Insert tour component and wait until it's ready.\n        const wrapper = await this.wrapperElement;\n        this.tour = await AngularFrameworkDelegate.attachViewToDom(wrapper, this.component, this.componentProps ?? {});\n\n        if (!this.tour) {\n            return;\n        }\n\n        await CoreDomUtils.waitForImages(this.tour);\n\n        // Calculate focus styles or dismiss if the element is gone.\n        if (this.focus && !CoreDom.isElementVisible(this.focus)) {\n            await this.dismiss(false);\n\n            return;\n        }\n\n        this.calculateStyles();\n\n        this.activate();\n\n        await this.playEnterAnimation();\n    }\n\n    /**\n     * Hide User Tour temporarily.\n     */\n    async hide(): Promise<void> {\n        const wrapper = await this.wrapperElement;\n\n        await this.playLeaveAnimation();\n        await AngularFrameworkDelegate.removeViewFromDom(wrapper, this.tour);\n\n        this.deactivate();\n    }\n\n    /**\n     * Dismiss User Tour.\n     *\n     * @param acknowledge Whether to confirm that the user has seen the User Tour.\n     */\n    async dismiss(acknowledge: boolean = true): Promise<void> {\n        this.beforeDismiss.emit();\n\n        if (this.active) {\n            await this.playLeaveAnimation();\n        }\n\n        await AngularFrameworkDelegate.removeViewFromDom(this.container, this.element);\n        this.deactivate();\n\n        acknowledge && await CoreUserTours.acknowledge(this.id);\n\n        this.afterDismiss.emit();\n    }\n\n    /**\n     * Calculate inline styles.\n     */\n    private calculateStyles(): void {\n        if (!this.focus) {\n            return;\n        }\n\n        // Calculate focus styles.\n        const focusLayout = new CoreUserToursFocusLayout(this.focus);\n\n        this.focusStyles = focusLayout.inlineStyles;\n\n        // Calculate popup styles.\n        if (!this.side || !this.alignment) {\n            throw new Error('Cannot create a focused user tour without side and alignment');\n        }\n\n        const popoverLayout = new CoreUserToursPopoverLayout(this.focus, this.side, this.alignment);\n\n        this.popover = true;\n        this.popoverWrapperStyles = popoverLayout.wrapperInlineStyles;\n        this.popoverWrapperArrowStyles = popoverLayout.wrapperArrowInlineStyles;\n        this.wrapperTransform = `${popoverLayout.wrapperStyles.transform ?? ''}`;\n    }\n\n    /**\n     * Play animation to show that the User Tour has started.\n     */\n    private async playEnterAnimation(): Promise<void> {\n        if (!('animate' in this.element)) {\n            // Not supported, don't animate.\n            return;\n        }\n\n        const animations = [\n            this.element.animate({ opacity: ['0', '1'] }, { duration: ANIMATION_DURATION }),\n            this.wrapperElement.value?.animate(\n                { transform: [`scale(1.2) ${this.wrapperTransform}`, `scale(1) ${this.wrapperTransform}`] },\n                { duration: ANIMATION_DURATION },\n            ),\n        ];\n\n        await Promise.all(animations.map(animation => animation?.finished));\n    }\n\n    /**\n     * Play animation to show that the User Tour has endd.\n     */\n    private async playLeaveAnimation(): Promise<void> {\n        if (!('animate' in this.element)) {\n            // Not supported, don't animate.\n            return;\n        }\n\n        const animations = [\n            this.element.animate({ opacity: ['1', '0'] }, { duration: ANIMATION_DURATION }),\n            this.wrapperElement.value?.animate(\n                { transform: [`scale(1) ${this.wrapperTransform}`, `scale(1.2) ${this.wrapperTransform}`] },\n                { duration: ANIMATION_DURATION },\n            ),\n        ];\n\n        await Promise.all(animations.map(animation => animation?.finished));\n    }\n\n    /**\n     * @inheritdoc\n     */\n    ngOnDestroy(): void {\n        this.deactivate();\n    }\n\n    /**\n     * Activate tour.\n     */\n    protected activate(): void {\n        if (this.active) {\n            return;\n        }\n\n        this.active = true;\n        this.lastActivatedTime = Date.now();\n\n        if (!this.backButtonListener) {\n            document.addEventListener(\n                'ionBackButton',\n                this.backButtonListener = ({ detail }) => detail.register(\n                    USER_TOURS_BACK_BUTTON_PRIORITY,\n                    () => {\n                        this.dismissOnBackOrBackdrop();\n                    },\n                ),\n            );\n        }\n\n        if (!this.focus) {\n            return;\n        }\n\n        this.collapsibleHeaderListener = this.collapsibleHeaderListener ??\n            CoreEvents.on(COLLAPSIBLE_HEADER_UPDATED, () => this.calculateStyles());\n        this.mainMenuListener = this.mainMenuListener ??\n            CoreEvents.on(CoreMainMenuProvider.MAIN_MENU_VISIBILITY_UPDATED, () => this.calculateStyles());\n        this.resizeListener = this.resizeListener ?? CoreDom.onWindowResize(() => this.calculateStyles());\n        this.content = this.content ?? CoreDom.closest(this.focus, 'ion-content');\n\n        if (!this.scrollListener && this.content) {\n            this.content.scrollEvents = true;\n\n            this.content.addEventListener('ionScrollEnd', this.scrollListener = (): void => {\n                this.calculateStyles();\n            });\n        }\n    }\n\n    /**\n     * Deactivate tour.\n     */\n    protected deactivate(): void {\n        if (!this.active) {\n            return;\n        }\n\n        this.active = false;\n\n        this.collapsibleHeaderListener?.off();\n        this.mainMenuListener?.off();\n        this.resizeListener?.off();\n        this.backButtonListener && document.removeEventListener('ionBackButton', this.backButtonListener);\n        this.backButtonListener = undefined;\n        this.collapsibleHeaderListener = undefined;\n        this.mainMenuListener = undefined;\n        this.resizeListener = undefined;\n\n        if (this.content && this.scrollListener) {\n            this.content.removeEventListener('ionScrollEnd', this.scrollListener);\n        }\n    }\n\n    /**\n     * Dismiss the tour because backdrop or back button was clicked.\n     *\n     * @param target Element clicked (if any).\n     */\n    protected dismissOnBackOrBackdrop(target?: HTMLElement): void {\n        if (!this.active || Date.now() - this.lastActivatedTime < BACKDROP_DISMISS_SAFETY_TRESHOLD) {\n            // Not active or was recently activated, ignore.\n            return;\n        }\n\n        if (target && target.closest('.user-tour-wrapper')) {\n            // Click on tour wrapper, don't dismiss.\n            return;\n        }\n\n        this.dismiss(true);\n    }\n\n}\n","<div *ngIf=\"focusStyles\" class=\"user-tour-focus\" [style]=\"focusStyles\"></div>\n<div *ngIf=\"!focusStyles\" class=\"user-tour-overlay\"></div>\n<div class=\"user-tour-wrapper\" [style]=\"popoverWrapperStyles\" #wrapper>\n    <span *ngIf=\"popover\" class=\"user-tour-wrapper-arrow\" [style]=\"popoverWrapperArrowStyles\"></span>\n</div>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
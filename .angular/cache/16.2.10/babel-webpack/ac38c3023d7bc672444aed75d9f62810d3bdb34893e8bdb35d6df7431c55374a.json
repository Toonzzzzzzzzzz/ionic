{"ast":null,"code":"var _class;\n// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nimport { APP_INITIALIZER } from '@angular/core';\nimport { CoreMainMenuRoutingModule } from '@features/mainmenu/mainmenu-routing.module';\nimport { MESSAGES_OFFLINE_SITE_SCHEMA } from './services/database/messages';\nimport { CORE_SITE_SCHEMAS } from '@services/sites';\nimport { CoreMainMenuDelegate } from '@features/mainmenu/services/mainmenu-delegate';\nimport { AddonMessagesMainMenuHandler, AddonMessagesMainMenuHandlerService } from './services/handlers/mainmenu';\nimport { CoreCronDelegate } from '@services/cron';\nimport { CoreSettingsDelegate } from '@features/settings/services/settings-delegate';\nimport { AddonMessagesSettingsHandler, AddonMessagesSettingsHandlerService } from './services/handlers/settings';\nimport { CoreMainMenuTabRoutingModule } from '@features/mainmenu/mainmenu-tab-routing.module';\nimport { CoreContentLinksDelegate } from '@features/contentlinks/services/contentlinks-delegate';\nimport { AddonMessagesIndexLinkHandler } from './services/handlers/index-link';\nimport { AddonMessagesDiscussionLinkHandler } from './services/handlers/discussion-link';\nimport { AddonMessagesContactRequestLinkHandler } from './services/handlers/contact-request-link';\nimport { CorePushNotificationsDelegate } from '@features/pushnotifications/services/push-delegate';\nimport { AddonMessagesPushClickHandler } from './services/handlers/push-click';\nimport { CoreUserDelegate } from '@features/user/services/user-delegate';\nimport { AddonMessagesSendMessageUserHandler } from './services/handlers/user-send-message';\nimport { NgZone } from '@singletons';\nimport { CoreNetwork } from '@services/network';\nimport { AddonMessagesSync, AddonMessagesSyncProvider } from './services/messages-sync';\nimport { AddonMessagesSyncCronHandler } from './services/handlers/sync-cron';\nimport { CoreSitePreferencesRoutingModule } from '@features/settings/settings-site-routing.module';\nimport { AddonMessagesProvider } from './services/messages';\nimport { AddonMessagesOfflineProvider } from './services/messages-offline';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../core/features/mainmenu/mainmenu-routing.module\";\nimport * as i2 from \"../../core/features/mainmenu/mainmenu-tab-routing.module\";\nimport * as i3 from \"../../core/features/settings/settings-site-routing.module\";\nexport const ADDON_MESSAGES_SERVICES = [AddonMessagesProvider, AddonMessagesOfflineProvider, AddonMessagesSyncProvider];\nconst mainMenuChildrenRoutes = [{\n  path: AddonMessagesMainMenuHandlerService.PAGE_NAME,\n  loadChildren: () => import('./messages-lazy.module').then(m => m.AddonMessagesLazyModule)\n}];\nconst preferencesRoutes = [{\n  path: AddonMessagesSettingsHandlerService.PAGE_NAME,\n  loadChildren: () => import('./messages-settings-lazy.module').then(m => m.AddonMessagesSettingsLazyModule)\n}];\nexport class AddonMessagesModule {}\n_class = AddonMessagesModule;\n_class.ɵfac = function AddonMessagesModule_Factory(t) {\n  return new (t || _class)();\n};\n_class.ɵmod = /*@__PURE__*/i0.ɵɵdefineNgModule({\n  type: _class\n});\n_class.ɵinj = /*@__PURE__*/i0.ɵɵdefineInjector({\n  providers: [{\n    provide: CORE_SITE_SCHEMAS,\n    useValue: [MESSAGES_OFFLINE_SITE_SCHEMA],\n    multi: true\n  }, {\n    provide: APP_INITIALIZER,\n    multi: true,\n    useValue: () => {\n      // Register handlers.\n      CoreMainMenuDelegate.registerHandler(AddonMessagesMainMenuHandler.instance);\n      CoreCronDelegate.register(AddonMessagesMainMenuHandler.instance);\n      CoreCronDelegate.register(AddonMessagesSyncCronHandler.instance);\n      CoreSettingsDelegate.registerHandler(AddonMessagesSettingsHandler.instance);\n      CoreContentLinksDelegate.registerHandler(AddonMessagesIndexLinkHandler.instance);\n      CoreContentLinksDelegate.registerHandler(AddonMessagesDiscussionLinkHandler.instance);\n      CoreContentLinksDelegate.registerHandler(AddonMessagesContactRequestLinkHandler.instance);\n      CorePushNotificationsDelegate.registerClickHandler(AddonMessagesPushClickHandler.instance);\n      CoreUserDelegate.registerHandler(AddonMessagesSendMessageUserHandler.instance);\n      // Sync some discussions when device goes online.\n      CoreNetwork.onConnectShouldBeStable().subscribe(() => {\n        // Execute the callback in the Angular zone, so change detection doesn't stop working.\n        NgZone.run(() => {\n          AddonMessagesSync.syncAllDiscussions(undefined, true);\n        });\n      });\n    }\n  }],\n  imports: [CoreMainMenuRoutingModule.forChild({\n    children: mainMenuChildrenRoutes\n  }), CoreMainMenuTabRoutingModule.forChild(mainMenuChildrenRoutes), CoreSitePreferencesRoutingModule.forChild(preferencesRoutes)]\n});\n(function () {\n  (typeof ngJitMode === \"undefined\" || ngJitMode) && i0.ɵɵsetNgModuleScope(AddonMessagesModule, {\n    imports: [i1.CoreMainMenuRoutingModule, i2.CoreMainMenuTabRoutingModule, i3.CoreSitePreferencesRoutingModule]\n  });\n})();","map":{"version":3,"names":["APP_INITIALIZER","CoreMainMenuRoutingModule","MESSAGES_OFFLINE_SITE_SCHEMA","CORE_SITE_SCHEMAS","CoreMainMenuDelegate","AddonMessagesMainMenuHandler","AddonMessagesMainMenuHandlerService","CoreCronDelegate","CoreSettingsDelegate","AddonMessagesSettingsHandler","AddonMessagesSettingsHandlerService","CoreMainMenuTabRoutingModule","CoreContentLinksDelegate","AddonMessagesIndexLinkHandler","AddonMessagesDiscussionLinkHandler","AddonMessagesContactRequestLinkHandler","CorePushNotificationsDelegate","AddonMessagesPushClickHandler","CoreUserDelegate","AddonMessagesSendMessageUserHandler","NgZone","CoreNetwork","AddonMessagesSync","AddonMessagesSyncProvider","AddonMessagesSyncCronHandler","CoreSitePreferencesRoutingModule","AddonMessagesProvider","AddonMessagesOfflineProvider","ADDON_MESSAGES_SERVICES","mainMenuChildrenRoutes","path","PAGE_NAME","loadChildren","then","m","AddonMessagesLazyModule","preferencesRoutes","AddonMessagesSettingsLazyModule","AddonMessagesModule","provide","useValue","multi","registerHandler","instance","register","registerClickHandler","onConnectShouldBeStable","subscribe","run","syncAllDiscussions","undefined","imports","forChild","children","i1","i2","i3"],"sources":["/home/toon/works/gitionic7/ionic-github/ionic/src/addons/messages/messages.module.ts"],"sourcesContent":["// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { APP_INITIALIZER, NgModule, Type } from '@angular/core';\nimport { Routes } from '@angular/router';\n\nimport { CoreMainMenuRoutingModule } from '@features/mainmenu/mainmenu-routing.module';\nimport { MESSAGES_OFFLINE_SITE_SCHEMA } from './services/database/messages';\nimport { CORE_SITE_SCHEMAS } from '@services/sites';\nimport { CoreMainMenuDelegate } from '@features/mainmenu/services/mainmenu-delegate';\nimport { AddonMessagesMainMenuHandler, AddonMessagesMainMenuHandlerService } from './services/handlers/mainmenu';\nimport { CoreCronDelegate } from '@services/cron';\nimport { CoreSettingsDelegate } from '@features/settings/services/settings-delegate';\nimport { AddonMessagesSettingsHandler, AddonMessagesSettingsHandlerService } from './services/handlers/settings';\nimport { CoreMainMenuTabRoutingModule } from '@features/mainmenu/mainmenu-tab-routing.module';\nimport { CoreContentLinksDelegate } from '@features/contentlinks/services/contentlinks-delegate';\nimport { AddonMessagesIndexLinkHandler } from './services/handlers/index-link';\nimport { AddonMessagesDiscussionLinkHandler } from './services/handlers/discussion-link';\nimport { AddonMessagesContactRequestLinkHandler } from './services/handlers/contact-request-link';\nimport { CorePushNotificationsDelegate } from '@features/pushnotifications/services/push-delegate';\nimport { AddonMessagesPushClickHandler } from './services/handlers/push-click';\nimport { CoreUserDelegate } from '@features/user/services/user-delegate';\nimport { AddonMessagesSendMessageUserHandler } from './services/handlers/user-send-message';\nimport { NgZone } from '@singletons';\nimport { CoreNetwork } from '@services/network';\nimport { AddonMessagesSync, AddonMessagesSyncProvider } from './services/messages-sync';\nimport { AddonMessagesSyncCronHandler } from './services/handlers/sync-cron';\nimport { CoreSitePreferencesRoutingModule } from '@features/settings/settings-site-routing.module';\nimport { AddonMessagesProvider } from './services/messages';\nimport { AddonMessagesOfflineProvider } from './services/messages-offline';\n\nexport const ADDON_MESSAGES_SERVICES: Type<unknown>[] = [\n    AddonMessagesProvider,\n    AddonMessagesOfflineProvider,\n    AddonMessagesSyncProvider,\n];\n\nconst mainMenuChildrenRoutes: Routes = [\n    {\n        path: AddonMessagesMainMenuHandlerService.PAGE_NAME,\n        loadChildren: () => import('./messages-lazy.module').then(m => m.AddonMessagesLazyModule),\n    },\n];\nconst preferencesRoutes: Routes = [\n    {\n        path: AddonMessagesSettingsHandlerService.PAGE_NAME,\n        loadChildren: () => import('./messages-settings-lazy.module').then(m => m.AddonMessagesSettingsLazyModule),\n    },\n];\n\n@NgModule({\n    imports: [\n        CoreMainMenuRoutingModule.forChild({ children: mainMenuChildrenRoutes }),\n        CoreMainMenuTabRoutingModule.forChild( mainMenuChildrenRoutes),\n        CoreSitePreferencesRoutingModule.forChild(preferencesRoutes),\n    ],\n    providers: [\n        {\n            provide: CORE_SITE_SCHEMAS,\n            useValue: [MESSAGES_OFFLINE_SITE_SCHEMA],\n            multi: true,\n        },\n        {\n            provide: APP_INITIALIZER,\n            multi: true,\n            useValue: () => {\n                // Register handlers.\n                CoreMainMenuDelegate.registerHandler(AddonMessagesMainMenuHandler.instance);\n                CoreCronDelegate.register(AddonMessagesMainMenuHandler.instance);\n                CoreCronDelegate.register(AddonMessagesSyncCronHandler.instance);\n                CoreSettingsDelegate.registerHandler(AddonMessagesSettingsHandler.instance);\n                CoreContentLinksDelegate.registerHandler(AddonMessagesIndexLinkHandler.instance);\n                CoreContentLinksDelegate.registerHandler(AddonMessagesDiscussionLinkHandler.instance);\n                CoreContentLinksDelegate.registerHandler(AddonMessagesContactRequestLinkHandler.instance);\n                CorePushNotificationsDelegate.registerClickHandler(AddonMessagesPushClickHandler.instance);\n                CoreUserDelegate.registerHandler(AddonMessagesSendMessageUserHandler.instance);\n\n                // Sync some discussions when device goes online.\n                CoreNetwork.onConnectShouldBeStable().subscribe(() => {\n                    // Execute the callback in the Angular zone, so change detection doesn't stop working.\n                    NgZone.run(() => {\n                        AddonMessagesSync.syncAllDiscussions(undefined, true);\n                    });\n                });\n            },\n        },\n\n    ],\n})\nexport class AddonMessagesModule {}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
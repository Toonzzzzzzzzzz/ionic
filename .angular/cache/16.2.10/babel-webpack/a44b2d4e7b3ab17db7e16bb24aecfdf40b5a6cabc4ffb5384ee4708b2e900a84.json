{"ast":null,"code":"import _objectSpread from \"/home/toon/works/gitionic7/ionic-github/ionic/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _asyncToGenerator from \"/home/toon/works/gitionic7/ionic-github/ionic/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _class;\nimport { CoreNetwork } from '@services/network';\nimport { CoreEvents } from '@singletons/events';\nimport { CoreSites } from '@services/sites';\nimport { CoreDomUtils } from '@services/utils/dom';\nimport { CoreTimeUtils } from '@services/utils/time';\nimport { AddonCalendarProvider, AddonCalendar, AddonCalendarEventType } from '../../services/calendar';\nimport { AddonCalendarOffline } from '../../services/calendar-offline';\nimport { AddonCalendarHelper } from '../../services/calendar-helper';\nimport { AddonCalendarSync, AddonCalendarSyncProvider } from '../../services/calendar-sync';\nimport { CoreCourses } from '@features/courses/services/courses';\nimport { CoreCoursesHelper } from '@features/courses/services/courses-helper';\nimport { AddonCalendarFilterComponent } from '../../components/filter/filter';\nimport moment from 'moment-timezone';\nimport { NgZone, Translate } from '@singletons';\nimport { CoreNavigator } from '@services/navigator';\nimport { CoreUtils } from '@services/utils/utils';\nimport { CoreConstants } from '@/core/constants';\nimport { CoreSwipeSlidesDynamicItemsManager } from '@classes/items-management/swipe-slides-dynamic-items-manager';\nimport { CoreSwipeSlidesComponent } from '@components/swipe-slides/swipe-slides';\nimport { CoreSwipeSlidesDynamicItemsManagerSource } from '@classes/items-management/swipe-slides-dynamic-items-manager-source';\nimport { CoreRoutedItemsManagerSourcesTracker } from '@classes/items-management/routed-items-manager-sources-tracker';\nimport { AddonCalendarEventsSource } from '@addons/calendar/classes/events-source';\nimport { CoreAnalytics, CoreAnalyticsEventType } from '@services/analytics';\nimport { CoreUrlUtils } from '@services/utils/url';\nimport { CoreTime } from '@singletons/time';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nimport * as i2 from \"../../../../core/components/context-menu/context-menu\";\nimport * as i3 from \"../../../../core/components/context-menu/context-menu-item\";\nimport * as i4 from \"../../../../core/components/empty-box/empty-box\";\nimport * as i5 from \"../../../../core/components/loading/loading\";\nimport * as i6 from \"../../../../core/components/mod-icon/mod-icon\";\nimport * as i7 from \"../../../../core/components/swipe-slides/swipe-slides\";\nimport * as i8 from \"../../../../core/directives/fab\";\nimport * as i9 from \"../../../../core/directives/fa-icon\";\nimport * as i10 from \"../../../../core/directives/format-text\";\nimport * as i11 from \"../../../../core/directives/content\";\nimport * as i12 from \"../../../../core/directives/update-non-reactive-attributes\";\nimport * as i13 from \"@ionic/angular\";\nimport * as i14 from \"@ngx-translate/core\";\nfunction AddonCalendarDayPage_core_context_menu_item_14_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"core-context-menu-item\", 20);\n    i0.ɵɵlistener(\"action\", function AddonCalendarDayPage_core_context_menu_item_14_Template_core_context_menu_item_action_0_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.goToCurrentDay());\n    });\n    i0.ɵɵpipe(1, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵproperty(\"priority\", 900)(\"content\", i0.ɵɵpipeBind1(1, 2, \"addon.calendar.today\"));\n  }\n}\nconst _c0 = function (a0) {\n  return {\n    $a: a0\n  };\n};\nfunction AddonCalendarDayPage_ng_template_37_ion_card_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-card\", 24)(1, \"ion-item\");\n    i0.ɵɵelement(2, \"ion-icon\", 25);\n    i0.ɵɵelementStart(3, \"ion-label\");\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"translate\");\n    i0.ɵɵpipe(6, \"translate\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(5, 1, \"core.hasdatatosync\", i0.ɵɵpureFunction1(6, _c0, i0.ɵɵpipeBind1(6, 4, \"core.day\"))));\n  }\n}\nfunction AddonCalendarDayPage_ng_template_37_core_empty_box_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"core-empty-box\", 26);\n    i0.ɵɵpipe(1, \"translate\");\n  }\n  if (rf & 2) {\n    i0.ɵɵproperty(\"message\", i0.ɵɵpipeBind1(1, 1, \"addon.calendar.noevents\"));\n  }\n}\nfunction AddonCalendarDayPage_ng_template_37_ion_list_3_ng_container_1_core_mod_icon_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"core-mod-icon\", 38);\n  }\n  if (rf & 2) {\n    const event_r10 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵproperty(\"modicon\", event_r10.moduleIcon)(\"showAlt\", false)(\"modname\", event_r10.modulename)(\"componentId\", event_r10.instance)(\"purpose\", event_r10.purpose);\n  }\n}\nfunction AddonCalendarDayPage_ng_template_37_ion_list_3_ng_container_1_ion_icon_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"ion-icon\", 39);\n  }\n  if (rf & 2) {\n    const event_r10 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵproperty(\"name\", event_r10.eventIcon);\n  }\n}\nfunction AddonCalendarDayPage_ng_template_37_ion_list_3_ng_container_1_span_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 32);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const event_r10 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(event_r10.iconTitle);\n  }\n}\nfunction AddonCalendarDayPage_ng_template_37_ion_list_3_ng_container_1_ion_note_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-note\", 2);\n    i0.ɵɵelement(1, \"ion-icon\", 40);\n    i0.ɵɵelementStart(2, \"span\", 41);\n    i0.ɵɵtext(3);\n    i0.ɵɵpipe(4, \"translate\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(4, 1, \"core.notsent\"));\n  }\n}\nfunction AddonCalendarDayPage_ng_template_37_ion_list_3_ng_container_1_ion_note_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-note\", 2);\n    i0.ɵɵelement(1, \"ion-icon\", 42);\n    i0.ɵɵelementStart(2, \"span\", 41);\n    i0.ɵɵtext(3);\n    i0.ɵɵpipe(4, \"translate\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(4, 1, \"core.deletedoffline\"));\n  }\n}\nconst _c1 = function (a0) {\n  return [a0];\n};\nfunction AddonCalendarDayPage_ng_template_37_ion_list_3_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r20 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"ion-card\")(2, \"ion-item\", 29);\n    i0.ɵɵlistener(\"click\", function AddonCalendarDayPage_ng_template_37_ion_list_3_ng_container_1_Template_ion_item_click_2_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r20);\n      const event_r10 = restoredCtx.$implicit;\n      const day_r5 = i0.ɵɵnextContext(2).item;\n      const ctx_r19 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r19.gotoEvent(event_r10.id, day_r5));\n    });\n    i0.ɵɵtemplate(3, AddonCalendarDayPage_ng_template_37_ion_list_3_ng_container_1_core_mod_icon_3_Template, 1, 5, \"core-mod-icon\", 30);\n    i0.ɵɵtemplate(4, AddonCalendarDayPage_ng_template_37_ion_list_3_ng_container_1_ion_icon_4_Template, 1, 1, \"ion-icon\", 31);\n    i0.ɵɵelementStart(5, \"ion-label\")(6, \"span\", 32);\n    i0.ɵɵtext(7);\n    i0.ɵɵpipe(8, \"translate\");\n    i0.ɵɵtemplate(9, AddonCalendarDayPage_ng_template_37_ion_list_3_ng_container_1_span_9_Template, 2, 1, \"span\", 33);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"p\", 34);\n    i0.ɵɵelement(11, \"core-format-text\", 35);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"p\");\n    i0.ɵɵelement(13, \"core-format-text\", 36);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(14, AddonCalendarDayPage_ng_template_37_ion_list_3_ng_container_1_ion_note_14_Template, 5, 3, \"ion-note\", 37);\n    i0.ɵɵtemplate(15, AddonCalendarDayPage_ng_template_37_ion_list_3_ng_container_1_ion_note_15_Template, 5, 3, \"ion-note\", 37);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const event_r10 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵclassProp(\"item-dimmed\", event_r10.ispast);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(18, _c1, \"addon-calendar-eventtype-\" + event_r10.eventtype))(\"detail\", false);\n    i0.ɵɵattribute(\"aria-label\", event_r10.name);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", event_r10.moduleIcon);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", event_r10.eventIcon && !event_r10.moduleIcon);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(8, 16, \"addon.calendar.type\" + event_r10.formattedType), \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", event_r10.moduleIcon && event_r10.iconTitle);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"text\", event_r10.name)(\"contextLevel\", event_r10.contextLevel)(\"contextInstanceId\", event_r10.contextInstanceId);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"text\", event_r10.formattedtime)(\"filter\", false);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", event_r10.offline && !event_r10.deleted);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", event_r10.deleted);\n  }\n}\nfunction AddonCalendarDayPage_ng_template_37_ion_list_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-list\", 27);\n    i0.ɵɵtemplate(1, AddonCalendarDayPage_ng_template_37_ion_list_3_ng_container_1_Template, 16, 20, \"ng-container\", 28);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const day_r5 = i0.ɵɵnextContext().item;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", day_r5.filteredEvents);\n  }\n}\nfunction AddonCalendarDayPage_ng_template_37_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"core-loading\", 9);\n    i0.ɵɵtemplate(1, AddonCalendarDayPage_ng_template_37_ion_card_1_Template, 7, 8, \"ion-card\", 21);\n    i0.ɵɵtemplate(2, AddonCalendarDayPage_ng_template_37_core_empty_box_2_Template, 2, 3, \"core-empty-box\", 22);\n    i0.ɵɵtemplate(3, AddonCalendarDayPage_ng_template_37_ion_list_3_Template, 2, 1, \"ion-list\", 23);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const day_r5 = ctx.item;\n    i0.ɵɵproperty(\"hideUntil\", day_r5.loaded);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", day_r5.hasOffline);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !day_r5.filteredEvents || !day_r5.filteredEvents.length);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", day_r5.filteredEvents && day_r5.filteredEvents.length);\n  }\n}\nfunction AddonCalendarDayPage_ion_fab_38_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r24 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-fab\", 43)(1, \"ion-fab-button\", 44);\n    i0.ɵɵlistener(\"click\", function AddonCalendarDayPage_ion_fab_38_Template_ion_fab_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r24);\n      const ctx_r23 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r23.openEdit());\n    });\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelement(3, \"ion-icon\", 45);\n    i0.ɵɵelementStart(4, \"span\", 32);\n    i0.ɵɵtext(5);\n    i0.ɵɵpipe(6, \"translate\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(1);\n    i0.ɵɵattribute(\"aria-label\", i0.ɵɵpipeBind1(2, 2, \"addon.calendar.newevent\"));\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(6, 4, \"addon.calendar.newevent\"));\n  }\n}\n/**\n * Page that displays the calendar events for a certain day.\n */\nexport class AddonCalendarDayPage {\n  constructor() {\n    var _this = this;\n    this.loaded = false;\n    this.isOnline = false;\n    this.syncIcon = CoreConstants.ICON_LOADING;\n    this.filter = {\n      filtered: false,\n      courseId: undefined,\n      categoryId: undefined,\n      course: true,\n      group: true,\n      site: true,\n      user: true,\n      category: true\n    };\n    this.currentSiteId = CoreSites.getCurrentSiteId();\n    // Listen for events added. When an event is added, reload the data.\n    this.newEventObserver = CoreEvents.on(AddonCalendarProvider.NEW_EVENT_EVENT, data => {\n      if (data && data.eventId) {\n        var _this$manager;\n        (_this$manager = this.manager) === null || _this$manager === void 0 || _this$manager.getSource().markAllItemsUnloaded();\n        this.refreshData(true, true);\n      }\n    }, this.currentSiteId);\n    // Listen for new event discarded event. When it does, reload the data.\n    this.discardedObserver = CoreEvents.on(AddonCalendarProvider.NEW_EVENT_DISCARDED_EVENT, () => {\n      var _this$manager2;\n      (_this$manager2 = this.manager) === null || _this$manager2 === void 0 || _this$manager2.getSource().markAllItemsUnloaded();\n      this.refreshData(true, true);\n    }, this.currentSiteId);\n    // Listen for events edited. When an event is edited, reload the data.\n    this.editEventObserver = CoreEvents.on(AddonCalendarProvider.EDIT_EVENT_EVENT, data => {\n      if (data && data.eventId) {\n        var _this$manager3;\n        (_this$manager3 = this.manager) === null || _this$manager3 === void 0 || _this$manager3.getSource().markAllItemsUnloaded();\n        this.refreshData(true, true);\n      }\n    }, this.currentSiteId);\n    // Refresh data if calendar events are synchronized automatically.\n    this.syncObserver = CoreEvents.on(AddonCalendarSyncProvider.AUTO_SYNCED, () => {\n      var _this$manager4;\n      (_this$manager4 = this.manager) === null || _this$manager4 === void 0 || _this$manager4.getSource().markAllItemsUnloaded();\n      this.refreshData(false, true);\n    }, this.currentSiteId);\n    // Refresh data if calendar events are synchronized manually but not by this page.\n    this.manualSyncObserver = CoreEvents.on(AddonCalendarSyncProvider.MANUAL_SYNCED, data => {\n      var _this$manager5;\n      const selectedDay = (_this$manager5 = this.manager) === null || _this$manager5 === void 0 ? void 0 : _this$manager5.getSelectedItem();\n      if (data && (data.source != 'day' || !selectedDay || !data.moment || !selectedDay.moment.isSame(data.moment, 'day'))) {\n        var _this$manager6;\n        (_this$manager6 = this.manager) === null || _this$manager6 === void 0 || _this$manager6.getSource().markAllItemsUnloaded();\n        this.refreshData(false, true);\n      }\n    }, this.currentSiteId);\n    // Update the events when an event is deleted.\n    this.deleteEventObserver = CoreEvents.on(AddonCalendarProvider.DELETED_EVENT_EVENT, data => {\n      if (data && !data.sent) {\n        var _this$manager7;\n        // Event was deleted in offline. Just mark it as deleted, no need to refresh.\n        (_this$manager7 = this.manager) === null || _this$manager7 === void 0 || _this$manager7.getSource().markAsDeleted(data.eventId, true);\n      } else {\n        var _this$manager8;\n        (_this$manager8 = this.manager) === null || _this$manager8 === void 0 || _this$manager8.getSource().markAllItemsUnloaded();\n        this.refreshData(false, true);\n      }\n    }, this.currentSiteId);\n    // Listen for events \"undeleted\" (offline).\n    this.undeleteEventObserver = CoreEvents.on(AddonCalendarProvider.UNDELETED_EVENT_EVENT, data => {\n      var _this$manager9;\n      if (!data || !data.eventId) {\n        return;\n      }\n      // Mark it as undeleted, no need to refresh.\n      (_this$manager9 = this.manager) === null || _this$manager9 === void 0 || _this$manager9.getSource().markAsDeleted(data.eventId, false);\n    }, this.currentSiteId);\n    this.filterChangedObserver = CoreEvents.on(AddonCalendarProvider.FILTER_CHANGED_EVENT, /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator(function* (data) {\n        var _this$manager10, _this$manager11;\n        _this.filter = data;\n        // Course viewed has changed, check if the user can create events for this course calendar.\n        yield (_this$manager10 = _this.manager) === null || _this$manager10 === void 0 ? void 0 : _this$manager10.getSource().loadCanCreate(_this.filter.courseId);\n        (_this$manager11 = _this.manager) === null || _this$manager11 === void 0 || _this$manager11.getSource().filterAllDayEvents(_this.filter);\n      });\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n    // Refresh online status when changes.\n    this.onlineObserver = CoreNetwork.onChange().subscribe(() => {\n      // Execute the callback in the Angular zone, so change detection doesn't stop working.\n      NgZone.run(() => {\n        this.isOnline = CoreNetwork.isOnline();\n      });\n    });\n    this.logView = CoreTime.once(() => {\n      var _this$manager12;\n      const day = (_this$manager12 = this.manager) === null || _this$manager12 === void 0 ? void 0 : _this$manager12.getSelectedItem();\n      if (!day) {\n        return;\n      }\n      const params = {\n        course: this.filter.courseId,\n        time: day.moment.unix()\n      };\n      CoreAnalytics.logEvent({\n        type: CoreAnalyticsEventType.VIEW_ITEM_LIST,\n        ws: 'core_calendar_get_calendar_day_view',\n        name: Translate.instant('addon.calendar.dayviewtitle', {\n          $a: this.periodName\n        }),\n        data: _objectSpread(_objectSpread({}, params), {}, {\n          category: 'calendar'\n        }),\n        url: CoreUrlUtils.addParamsToUrl('/calendar/view.php?view=day', params)\n      });\n    });\n  }\n  /**\n   * View loaded.\n   */\n  ngOnInit() {\n    const types = [];\n    CoreUtils.enumKeys(AddonCalendarEventType).forEach(name => {\n      var _CoreNavigator$getRou;\n      const value = AddonCalendarEventType[name];\n      this.filter[name] = (_CoreNavigator$getRou = CoreNavigator.getRouteBooleanParam(name)) !== null && _CoreNavigator$getRou !== void 0 ? _CoreNavigator$getRou : true;\n      types.push(value);\n    });\n    this.filter.courseId = CoreNavigator.getRouteNumberParam('courseId');\n    this.filter.categoryId = CoreNavigator.getRouteNumberParam('categoryId');\n    this.filter.filtered = this.filter.courseId !== undefined || types.some(name => !this.filter[name]);\n    const month = CoreNavigator.getRouteNumberParam('month');\n    const source = new AddonCalendarDaySlidesItemsManagerSource(this, moment({\n      year: CoreNavigator.getRouteNumberParam('year'),\n      month: month ? month - 1 : undefined,\n      date: CoreNavigator.getRouteNumberParam('day')\n    }).startOf('day'));\n    this.manager = new CoreSwipeSlidesDynamicItemsManager(source);\n    this.managerUnsubscribe = this.manager.addListener({\n      onSelectedItemUpdated: item => {\n        this.onDayViewed(item);\n      }\n    });\n    this.fetchData(true);\n  }\n  get canCreate() {\n    var _this$manager13;\n    return ((_this$manager13 = this.manager) === null || _this$manager13 === void 0 ? void 0 : _this$manager13.getSource().canCreate) || false;\n  }\n  get timeFormat() {\n    var _this$manager14;\n    return ((_this$manager14 = this.manager) === null || _this$manager14 === void 0 ? void 0 : _this$manager14.getSource().timeFormat) || 'core.strftimetime';\n  }\n  /**\n   * Fetch all the data required for the view.\n   *\n   * @param sync Whether it should try to synchronize offline events.\n   * @returns Promise resolved when done.\n   */\n  fetchData(sync) {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      _this2.syncIcon = CoreConstants.ICON_LOADING;\n      _this2.isOnline = CoreNetwork.isOnline();\n      if (sync) {\n        yield _this2.sync();\n      }\n      try {\n        var _this2$manager, _this2$manager2, _this2$manager3;\n        yield (_this2$manager = _this2.manager) === null || _this2$manager === void 0 ? void 0 : _this2$manager.getSource().fetchData(_this2.filter.courseId);\n        yield (_this2$manager2 = _this2.manager) === null || _this2$manager2 === void 0 ? void 0 : _this2$manager2.getSource().load((_this2$manager3 = _this2.manager) === null || _this2$manager3 === void 0 ? void 0 : _this2$manager3.getSelectedItem());\n        _this2.logView();\n      } catch (error) {\n        CoreDomUtils.showErrorModalDefault(error, 'addon.calendar.errorloadevents', true);\n      }\n      _this2.loaded = true;\n      _this2.syncIcon = CoreConstants.ICON_SYNC;\n    })();\n  }\n  /**\n   * Update data related to day being viewed.\n   *\n   * @param day Day viewed.\n   */\n  onDayViewed(day) {\n    this.periodName = CoreTimeUtils.userDate(day.moment.unix() * 1000, 'core.strftimedaydate');\n  }\n  /**\n   * Refresh the data.\n   *\n   * @param refresher Refresher.\n   * @param done Function to call when done.\n   * @returns Promise resolved when done.\n   */\n  doRefresh(refresher, done) {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      if (!_this3.loaded) {\n        return;\n      }\n      yield _this3.refreshData(true).finally(() => {\n        refresher === null || refresher === void 0 || refresher.complete();\n        done && done();\n      });\n    })();\n  }\n  /**\n   * Refresh the data.\n   *\n   * @param sync Whether it should try to synchronize offline events.\n   * @param afterChange Whether the refresh is done after an event has changed or has been synced.\n   * @returns Promise resolved when done.\n   */\n  refreshData(sync, afterChange) {\n    var _this4 = this;\n    return _asyncToGenerator(function* () {\n      var _this4$manager, _this4$manager2;\n      _this4.syncIcon = CoreConstants.ICON_LOADING;\n      const selectedDay = ((_this4$manager = _this4.manager) === null || _this4$manager === void 0 ? void 0 : _this4$manager.getSelectedItem()) || null;\n      // Don't invalidate day events after a change, it has already been handled.\n      yield (_this4$manager2 = _this4.manager) === null || _this4$manager2 === void 0 ? void 0 : _this4$manager2.getSource().invalidateContent(selectedDay, !afterChange);\n      yield _this4.fetchData(sync);\n    })();\n  }\n  /**\n   * Try to synchronize offline events.\n   *\n   * @param showErrors Whether to show sync errors to the user.\n   * @returns Promise resolved when done.\n   */\n  sync(showErrors) {\n    var _this5 = this;\n    return _asyncToGenerator(function* () {\n      try {\n        const result = yield AddonCalendarSync.syncEvents();\n        if (result.warnings && result.warnings.length) {\n          CoreDomUtils.showAlert(undefined, result.warnings[0]);\n        }\n        if (result.updated) {\n          var _this5$manager, _this5$manager2;\n          // Trigger a manual sync event.\n          const selectedDay = (_this5$manager = _this5.manager) === null || _this5$manager === void 0 ? void 0 : _this5$manager.getSelectedItem();\n          result.source = 'day';\n          result.moment = selectedDay === null || selectedDay === void 0 ? void 0 : selectedDay.moment;\n          (_this5$manager2 = _this5.manager) === null || _this5$manager2 === void 0 || _this5$manager2.getSource().markAllItemsUnloaded();\n          CoreEvents.trigger(AddonCalendarSyncProvider.MANUAL_SYNCED, result, _this5.currentSiteId);\n        }\n      } catch (error) {\n        if (showErrors) {\n          CoreDomUtils.showErrorModalDefault(error, 'core.errorsync', true);\n        }\n      }\n    })();\n  }\n  /**\n   * Check whether selected day is current day.\n   *\n   * @returns If selected day is current.\n   */\n  selectedDayIsCurrent() {\n    var _this$manager15;\n    return !!((_this$manager15 = this.manager) !== null && _this$manager15 !== void 0 && (_this$manager15 = _this$manager15.getSelectedItem()) !== null && _this$manager15 !== void 0 && _this$manager15.isCurrentDay);\n  }\n  /**\n   * Navigate to a particular event.\n   *\n   * @param eventId Event to load.\n   * @param day Day.\n   */\n  gotoEvent(eventId, day) {\n    CoreNavigator.navigateToSitePath(`/calendar/event/${eventId}`, {\n      params: {\n        date: day.moment.format('MMDDY')\n      }\n    });\n  }\n  /**\n   * Show the filter menu.\n   */\n  openFilter() {\n    var _this6 = this;\n    return _asyncToGenerator(function* () {\n      var _this6$manager;\n      yield CoreDomUtils.openSideModal({\n        component: AddonCalendarFilterComponent,\n        componentProps: {\n          courses: (_this6$manager = _this6.manager) === null || _this6$manager === void 0 ? void 0 : _this6$manager.getSource().courses,\n          filter: _this6.filter\n        }\n      });\n    })();\n  }\n  /**\n   * Open page to create/edit an event.\n   *\n   * @param eventId Event ID to edit.\n   */\n  openEdit(eventId) {\n    const params = {};\n    if (!eventId) {\n      var _this$manager16;\n      // It's a new event, set the time.\n      eventId = 0;\n      const selectedDay = (_this$manager16 = this.manager) === null || _this$manager16 === void 0 ? void 0 : _this$manager16.getSelectedItem();\n      if (selectedDay) {\n        // Use current time but in the specified day.\n        const now = moment();\n        params.timestamp = selectedDay.moment.clone().set({\n          hour: now.hour(),\n          minute: now.minute()\n        }).unix() * 1000;\n      }\n    }\n    if (this.filter.courseId) {\n      params.courseId = this.filter.courseId;\n    }\n    CoreNavigator.navigateToSitePath(`/calendar/edit/${eventId}`, {\n      params\n    });\n  }\n  /**\n   * Check whether selected day has offline data.\n   *\n   * @returns Whether selected day has offline data.\n   */\n  selectedDayHasOffline() {\n    var _this$manager17;\n    const selectedDay = (_this$manager17 = this.manager) === null || _this$manager17 === void 0 ? void 0 : _this$manager17.getSelectedItem();\n    return !!(selectedDay !== null && selectedDay !== void 0 && selectedDay.hasOffline);\n  }\n  /**\n   * Go to current day.\n   */\n  goToCurrentDay() {\n    var _this7 = this;\n    return _asyncToGenerator(function* () {\n      const manager = _this7.manager;\n      if (!manager || !_this7.swipeSlidesComponent) {\n        return;\n      }\n      const currentDay = {\n        moment: moment()\n      };\n      _this7.loaded = false;\n      try {\n        // Make sure the day is loaded.\n        yield manager.getSource().loadItem(currentDay);\n        _this7.swipeSlidesComponent.slideToItem(currentDay);\n      } catch (error) {\n        CoreDomUtils.showErrorModalDefault(error, 'addon.calendar.errorloadevents', true);\n      } finally {\n        _this7.loaded = true;\n      }\n    })();\n  }\n  /**\n   * Load next day.\n   */\n  loadNext() {\n    var _this8 = this;\n    return _asyncToGenerator(function* () {\n      var _this8$swipeSlidesCom;\n      (_this8$swipeSlidesCom = _this8.swipeSlidesComponent) === null || _this8$swipeSlidesCom === void 0 || _this8$swipeSlidesCom.slideNext();\n    })();\n  }\n  /**\n   * Load previous day.\n   */\n  loadPrevious() {\n    var _this9 = this;\n    return _asyncToGenerator(function* () {\n      var _this9$swipeSlidesCom;\n      (_this9$swipeSlidesCom = _this9.swipeSlidesComponent) === null || _this9$swipeSlidesCom === void 0 || _this9$swipeSlidesCom.slidePrev();\n    })();\n  }\n  /**\n   * Page destroyed.\n   */\n  ngOnDestroy() {\n    var _this$newEventObserve, _this$discardedObserv, _this$editEventObserv, _this$deleteEventObse, _this$undeleteEventOb, _this$syncObserver, _this$manualSyncObser, _this$onlineObserver, _this$filterChangedOb, _this$manager18, _this$manager19, _this$managerUnsubscr;\n    (_this$newEventObserve = this.newEventObserver) === null || _this$newEventObserve === void 0 || _this$newEventObserve.off();\n    (_this$discardedObserv = this.discardedObserver) === null || _this$discardedObserv === void 0 || _this$discardedObserv.off();\n    (_this$editEventObserv = this.editEventObserver) === null || _this$editEventObserv === void 0 || _this$editEventObserv.off();\n    (_this$deleteEventObse = this.deleteEventObserver) === null || _this$deleteEventObse === void 0 || _this$deleteEventObse.off();\n    (_this$undeleteEventOb = this.undeleteEventObserver) === null || _this$undeleteEventOb === void 0 || _this$undeleteEventOb.off();\n    (_this$syncObserver = this.syncObserver) === null || _this$syncObserver === void 0 || _this$syncObserver.off();\n    (_this$manualSyncObser = this.manualSyncObserver) === null || _this$manualSyncObser === void 0 || _this$manualSyncObser.off();\n    (_this$onlineObserver = this.onlineObserver) === null || _this$onlineObserver === void 0 || _this$onlineObserver.unsubscribe();\n    (_this$filterChangedOb = this.filterChangedObserver) === null || _this$filterChangedOb === void 0 || _this$filterChangedOb.off();\n    (_this$manager18 = this.manager) === null || _this$manager18 === void 0 || _this$manager18.getSource().forgetRelatedSources();\n    (_this$manager19 = this.manager) === null || _this$manager19 === void 0 || _this$manager19.destroy();\n    (_this$managerUnsubscr = this.managerUnsubscribe) === null || _this$managerUnsubscr === void 0 || _this$managerUnsubscr.call(this);\n    delete this.manager;\n  }\n}\n/**\n * Helper to manage swiping within days.\n */\n_class = AddonCalendarDayPage;\n_class.ɵfac = function AddonCalendarDayPage_Factory(t) {\n  return new (t || _class)();\n};\n_class.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: _class,\n  selectors: [[\"page-addon-calendar-day\"]],\n  viewQuery: function AddonCalendarDayPage_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(CoreSwipeSlidesComponent, 5);\n    }\n    if (rf & 2) {\n      let _t;\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.swipeSlidesComponent = _t.first);\n    }\n  },\n  decls: 39,\n  vars: 31,\n  consts: [[\"slot\", \"start\"], [3, \"text\"], [\"slot\", \"end\"], [\"fill\", \"clear\", 3, \"click\"], [\"slot\", \"icon-only\", \"name\", \"fas-filter\", \"aria-hidden\", \"true\"], [\"iconAction\", \"fas-calendar-day\", 3, \"priority\", \"content\", \"action\", 4, \"ngIf\"], [3, \"hidden\", \"priority\", \"content\", \"iconAction\", \"closeOnClick\", \"action\"], [\"slot\", \"fixed\", 3, \"disabled\", \"ionRefresh\"], [3, \"pullingText\"], [3, \"hideUntil\"], [1, \"core-swipe-slides-container\"], [1, \"ion-no-padding\", \"safe-area-padding\"], [1, \"ion-align-items-center\"], [1, \"ion-text-start\"], [\"name\", \"fas-chevron-left\", \"slot\", \"icon-only\", \"aria-hidden\", \"true\"], [1, \"ion-text-center\", \"addon-calendar-period\"], [1, \"ion-text-end\"], [\"name\", \"fas-chevron-right\", \"slot\", \"icon-only\", \"aria-hidden\", \"true\"], [3, \"manager\"], [\"slot\", \"fixed\", \"core-fab\", \"\", \"vertical\", \"bottom\", \"horizontal\", \"end\", 4, \"ngIf\"], [\"iconAction\", \"fas-calendar-day\", 3, \"priority\", \"content\", \"action\"], [\"class\", \"core-warning-card list-item-limited-width\", 4, \"ngIf\"], [\"icon\", \"fas-calendar\", 3, \"message\", 4, \"ngIf\"], [\"class\", \"list-item-limited-width\", 4, \"ngIf\"], [1, \"core-warning-card\", \"list-item-limited-width\"], [\"name\", \"fas-triangle-exclamation\", \"slot\", \"start\", \"aria-hidden\", \"true\"], [\"icon\", \"fas-calendar\", 3, \"message\"], [1, \"list-item-limited-width\"], [4, \"ngFor\", \"ngForOf\"], [\"button\", \"\", 1, \"addon-calendar-event\", \"ion-text-wrap\", 3, \"ngClass\", \"detail\", \"click\"], [\"slot\", \"start\", 3, \"modicon\", \"showAlt\", \"modname\", \"componentId\", \"purpose\", 4, \"ngIf\"], [\"slot\", \"start\", \"aria-hidden\", \"true\", 3, \"name\", 4, \"ngIf\"], [1, \"sr-only\"], [\"class\", \"sr-only\", 4, \"ngIf\"], [1, \"item-heading\"], [3, \"text\", \"contextLevel\", \"contextInstanceId\"], [3, \"text\", \"filter\"], [\"slot\", \"end\", 4, \"ngIf\"], [\"slot\", \"start\", 3, \"modicon\", \"showAlt\", \"modname\", \"componentId\", \"purpose\"], [\"slot\", \"start\", \"aria-hidden\", \"true\", 3, \"name\"], [\"name\", \"fas-clock\", \"aria-hidden\", \"true\"], [1, \"ion-text-wrap\"], [\"name\", \"fas-trash\", \"aria-hidden\", \"true\"], [\"slot\", \"fixed\", \"core-fab\", \"\", \"vertical\", \"bottom\", \"horizontal\", \"end\"], [3, \"click\"], [\"name\", \"fas-plus\", \"aria-hidden\", \"true\"]],\n  template: function AddonCalendarDayPage_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"ion-header\")(1, \"ion-toolbar\")(2, \"ion-buttons\", 0);\n      i0.ɵɵelement(3, \"ion-back-button\", 1);\n      i0.ɵɵpipe(4, \"translate\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(5, \"ion-title\")(6, \"h1\");\n      i0.ɵɵtext(7);\n      i0.ɵɵpipe(8, \"translate\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(9, \"ion-buttons\", 2)(10, \"ion-button\", 3);\n      i0.ɵɵlistener(\"click\", function AddonCalendarDayPage_Template_ion_button_click_10_listener() {\n        return ctx.openFilter();\n      });\n      i0.ɵɵpipe(11, \"translate\");\n      i0.ɵɵelement(12, \"ion-icon\", 4);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(13, \"core-context-menu\");\n      i0.ɵɵtemplate(14, AddonCalendarDayPage_core_context_menu_item_14_Template, 2, 4, \"core-context-menu-item\", 5);\n      i0.ɵɵelementStart(15, \"core-context-menu-item\", 6);\n      i0.ɵɵlistener(\"action\", function AddonCalendarDayPage_Template_core_context_menu_item_action_15_listener($event) {\n        return ctx.doRefresh(undefined, $event);\n      });\n      i0.ɵɵpipe(16, \"translate\");\n      i0.ɵɵelementEnd()()()()();\n      i0.ɵɵelementStart(17, \"ion-content\")(18, \"ion-refresher\", 7);\n      i0.ɵɵlistener(\"ionRefresh\", function AddonCalendarDayPage_Template_ion_refresher_ionRefresh_18_listener($event) {\n        return ctx.doRefresh($event.target);\n      });\n      i0.ɵɵelement(19, \"ion-refresher-content\", 8);\n      i0.ɵɵpipe(20, \"translate\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(21, \"core-loading\", 9)(22, \"div\", 10)(23, \"ion-grid\", 11)(24, \"ion-row\", 12)(25, \"ion-col\", 13)(26, \"ion-button\", 3);\n      i0.ɵɵlistener(\"click\", function AddonCalendarDayPage_Template_ion_button_click_26_listener() {\n        return ctx.loadPrevious();\n      });\n      i0.ɵɵpipe(27, \"translate\");\n      i0.ɵɵelement(28, \"ion-icon\", 14);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(29, \"ion-col\", 15)(30, \"h2\");\n      i0.ɵɵtext(31);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(32, \"ion-col\", 16)(33, \"ion-button\", 3);\n      i0.ɵɵlistener(\"click\", function AddonCalendarDayPage_Template_ion_button_click_33_listener() {\n        return ctx.loadNext();\n      });\n      i0.ɵɵpipe(34, \"translate\");\n      i0.ɵɵelement(35, \"ion-icon\", 17);\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(36, \"core-swipe-slides\", 18);\n      i0.ɵɵtemplate(37, AddonCalendarDayPage_ng_template_37_Template, 4, 4, \"ng-template\");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵtemplate(38, AddonCalendarDayPage_ion_fab_38_Template, 7, 6, \"ion-fab\", 19);\n      i0.ɵɵelementEnd();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"text\", i0.ɵɵpipeBind1(4, 17, \"core.back\"));\n      i0.ɵɵadvance(4);\n      i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(8, 19, \"addon.calendar.calendarevents\"));\n      i0.ɵɵadvance(3);\n      i0.ɵɵattribute(\"aria-label\", i0.ɵɵpipeBind1(11, 21, \"core.filter\"));\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngIf\", !ctx.selectedDayIsCurrent());\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"hidden\", !ctx.loaded || !ctx.selectedDayHasOffline() || !ctx.isOnline)(\"priority\", 400)(\"content\", i0.ɵɵpipeBind1(16, 23, \"core.settings.synchronizenow\"))(\"iconAction\", ctx.syncIcon)(\"closeOnClick\", false);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"disabled\", !ctx.loaded);\n      i0.ɵɵadvance(1);\n      i0.ɵɵpropertyInterpolate(\"pullingText\", i0.ɵɵpipeBind1(20, 25, \"core.pulltorefresh\"));\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"hideUntil\", ctx.loaded);\n      i0.ɵɵadvance(5);\n      i0.ɵɵattribute(\"aria-label\", i0.ɵɵpipeBind1(27, 27, \"addon.calendar.dayprev\"));\n      i0.ɵɵadvance(5);\n      i0.ɵɵtextInterpolate(ctx.periodName);\n      i0.ɵɵadvance(2);\n      i0.ɵɵattribute(\"aria-label\", i0.ɵɵpipeBind1(34, 29, \"addon.calendar.daynext\"));\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"manager\", ctx.manager);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", ctx.canCreate && ctx.loaded);\n    }\n  },\n  dependencies: [i1.NgClass, i1.NgForOf, i1.NgIf, i2.CoreContextMenuComponent, i3.CoreContextMenuItemComponent, i4.CoreEmptyBoxComponent, i5.CoreLoadingComponent, i6.CoreModIconComponent, i7.CoreSwipeSlidesComponent, i8.CoreFabDirective, i9.CoreFaIconDirective, i10.CoreFormatTextDirective, i11.CoreContentDirective, i12.CoreUpdateNonReactiveAttributesDirective, i13.IonButton, i13.IonButtons, i13.IonCard, i13.IonCol, i13.IonContent, i13.IonFab, i13.IonFabButton, i13.IonGrid, i13.IonHeader, i13.IonIcon, i13.IonItem, i13.IonLabel, i13.IonList, i13.IonNote, i13.IonRefresher, i13.IonRefresherContent, i13.IonRow, i13.IonTitle, i13.IonToolbar, i13.IonBackButton, i14.TranslatePipe],\n  styles: [\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n[_nghost-%COMP%] {\\n  --addon-calendar-blank-day-background-color: var(--light);\\n}\\n[_nghost-%COMP%]   .item.addon-calendar-event[_ngcontent-%COMP%]    > ion-icon[_ngcontent-%COMP%] {\\n  color: white;\\n  border-radius: 50%;\\n  padding: 0.7rem;\\n  --margin-vertical: 12px;\\n  --margin-end: 12px;\\n  margin-top: var(--margin-vertical);\\n  margin-bottom: var(--margin-vertical);\\n  -webkit-margin-end: var(--margin-end);\\n  margin-inline-end: var(--margin-end);\\n}\\n[_nghost-%COMP%]   .item.addon-calendar-event.addon-calendar-eventtype-category[_ngcontent-%COMP%]    > ion-icon[_ngcontent-%COMP%] {\\n  background-color: #8e24aa;\\n}\\n[_nghost-%COMP%]   .item.addon-calendar-event.addon-calendar-eventtype-course[_ngcontent-%COMP%]    > ion-icon[_ngcontent-%COMP%] {\\n  background-color: #ca3120;\\n}\\n[_nghost-%COMP%]   .item.addon-calendar-event.addon-calendar-eventtype-group[_ngcontent-%COMP%]    > ion-icon[_ngcontent-%COMP%] {\\n  background-color: #f0ad4e;\\n}\\n[_nghost-%COMP%]   .item.addon-calendar-event.addon-calendar-eventtype-user[_ngcontent-%COMP%]    > ion-icon[_ngcontent-%COMP%] {\\n  background-color: #0f6cbf;\\n}\\n[_nghost-%COMP%]   .item.addon-calendar-event.addon-calendar-eventtype-site[_ngcontent-%COMP%]    > ion-icon[_ngcontent-%COMP%] {\\n  background-color: #357a32;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy90aGVtZS9nbG9iYWxzLnNjc3MiLCJ3ZWJwYWNrOi8vLi9zcmMvdGhlbWUvaGVscGVycy9pb25pYy5mdW5jdGlvbnMuc3RyaW5nLnNjc3MiLCJ3ZWJwYWNrOi8vLi9zcmMvdGhlbWUvaGVscGVycy9pb25pYy5mdW5jdGlvbnMuY29sb3Iuc2NzcyIsIndlYnBhY2s6Ly8uL3NyYy90aGVtZS9oZWxwZXJzL2lvbmljLm1peGlucy5zY3NzIiwid2VicGFjazovLy4vc3JjL3RoZW1lL2hlbHBlcnMvaW9uaWMuY29tcG9uZW50cy5taXhpbnMuc2NzcyIsIndlYnBhY2s6Ly8uL3NyYy90aGVtZS9oZWxwZXJzL2N1c3RvbS5taXhpbnMuc2NzcyIsIndlYnBhY2s6Ly8uL3NyYy90aGVtZS9nbG9iYWxzLmN1c3RvbS5zY3NzIiwid2VicGFjazovLy4vc3JjL3RoZW1lL2dsb2JhbHMudmFyaWFibGVzLnNjc3MiLCJ3ZWJwYWNrOi8vLi9zcmMvYWRkb25zL2NhbGVuZGFyL2NhbGVuZGFyLWNvbW1vbi5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7O0VBQUE7QUNBQTs7Ozs7RUFBQTtBQ0FBOzs7OztFQUFBO0FDQUE7Ozs7O0VBQUE7QUNBQTs7Ozs7O0VBQUE7QUNFQTs7OztFQUFBO0FBNEdBOztFQUFBO0FDOUdBOzs7O0VBQUE7QUNBQTs7OztFQUFBO0FBK0RBOzs7O0VBQUE7QUM3REE7RUFFSSx5REFBQTtBQW1ESjtBQWhEUTtFQUNJLFlBQUE7RUFDQSxrQkFBQTtFQUNBLGVBQUE7RUFDQSx1QkFBQTtFQUNBLGtCQUFBO0VBQ0Esa0NBQUE7RUFDQSxxQ0FBQTtFTHlTUixxQ0t4U3lDO0VMeVN6QyxvQ0t6U3lDO0FBbUQ3QztBQTlDWTtFQUNJLHlCRGdIaUI7QUNoRWpDO0FBakRZO0VBQ0kseUJEZ0hpQjtBQzdEakM7QUFwRFk7RUFDSSx5QkRnSGlCO0FDMURqQztBQXZEWTtFQUNJLHlCRGdIaUI7QUN2RGpDO0FBMURZO0VBQ0kseUJEZ0hpQjtBQ3BEakMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEFwcCBHbG9iYWwgdmFyaWFibGVzIFNDU1NcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqIFBsYWNlIGhlcmUgdGhlIGRpZmZlcmVudCBmaWxlcyB5b3Ugc2hvdWxkIGltcG9ydCB0byB1c2UgZ2xvYmFsIHZhcmlhYmxlcy5cbiAqL1xuXG4kZm9udC1wYXRoOiBcIi4uL2Fzc2V0cy9mb250c1wiO1xuJGFzc2V0cy1wYXRoOiBcIi4uL2Fzc2V0c1wiO1xuXG5AaW1wb3J0IFwiLi9oZWxwZXJzL2hlbHBlcnMuc2Nzc1wiO1xuQGltcG9ydCBcIi4vZ2xvYmFscy5jdXN0b20uc2Nzc1wiO1xuQGltcG9ydCBcIi4vZ2xvYmFscy52YXJpYWJsZXMuc2Nzc1wiO1xuIiwiLyoqXG4gKiBJbXBvcnRlZCBpb25pYyBzdHJpbmcgZnVuY3Rpb25zIGZvciBTQ1NTXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiBFeHRyYWN0ZWQgZnJvbVxuICogaHR0cHM6Ly9naXRodWIuY29tL2lvbmljLXRlYW0vaW9uaWMtZnJhbWV3b3JrL2Jsb2IvbWFzdGVyL2NvcmUvc3JjL3RoZW1lcy9pb25pYy5mdW5jdGlvbnMuc3RyaW5nLnNjc3NcbiAqL1xuXG5cbi8vIFN0cmluZyBVdGlsaXR5IEZ1bmN0aW9uc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuLy8gU3RyaW5nIFJlcGxhY2UgRnVuY3Rpb25cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbkBmdW5jdGlvbiBzdHItcmVwbGFjZSgkc3RyaW5nLCAkc2VhcmNoLCAkcmVwbGFjZTogXCJcIikge1xuICAkaW5kZXg6IHN0ci1pbmRleCgkc3RyaW5nLCAkc2VhcmNoKTtcblxuICBAaWYgJGluZGV4IHtcbiAgICBAcmV0dXJuIHN0ci1zbGljZSgkc3RyaW5nLCAxLCAkaW5kZXggLSAxKSArICRyZXBsYWNlICsgc3RyLXJlcGxhY2Uoc3RyLXNsaWNlKCRzdHJpbmcsICRpbmRleCArIHN0ci1sZW5ndGgoJHNlYXJjaCkpLCAkc2VhcmNoLCAkcmVwbGFjZSk7XG4gIH1cblxuICBAcmV0dXJuICRzdHJpbmc7XG59XG5cbi8vIFN0cmluZyBTcGxpdCBGdW5jdGlvblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuXG5AZnVuY3Rpb24gc3RyLXNwbGl0KCRzdHJpbmcsICRzZXBhcmF0b3IpIHtcbiAgLy8gZW1wdHkgYXJyYXkvbGlzdFxuICAkc3BsaXQtYXJyOiAoKTtcbiAgLy8gZmlyc3QgaW5kZXggb2Ygc2VwYXJhdG9yIGluIHN0cmluZ1xuICAkaW5kZXg6IHN0ci1pbmRleCgkc3RyaW5nLCAkc2VwYXJhdG9yKTtcbiAgLy8gbG9vcCB0aHJvdWdoIHN0cmluZ1xuICBAd2hpbGUgJGluZGV4ICE9IG51bGwge1xuICAgIC8vIGdldCB0aGUgc3Vic3RyaW5nIGZyb20gdGhlIGZpcnN0IGNoYXJhY3RlciB0byB0aGUgc2VwYXJhdG9yXG4gICAgJGl0ZW06IHN0ci1zbGljZSgkc3RyaW5nLCAxLCAkaW5kZXggLSAxKTtcbiAgICAvLyBwdXNoIGl0ZW0gdG8gYXJyYXlcbiAgICAkc3BsaXQtYXJyOiBhcHBlbmQoJHNwbGl0LWFyciwgJGl0ZW0pO1xuICAgIC8vIHJlbW92ZSBpdGVtIGFuZCBzZXBhcmF0b3IgZnJvbSBzdHJpbmdcbiAgICAkc3RyaW5nOiBzdHItc2xpY2UoJHN0cmluZywgJGluZGV4ICsgMSk7XG4gICAgLy8gZmluZCBuZXcgaW5kZXggb2Ygc2VwYXJhdG9yXG4gICAgJGluZGV4OiBzdHItaW5kZXgoJHN0cmluZywgJHNlcGFyYXRvcik7XG4gIH1cbiAgLy8gYWRkIHRoZSByZW1haW5pbmcgc3RyaW5nIHRvIGxpc3QgKHRoZSBsYXN0IGl0ZW0pXG4gICRzcGxpdC1hcnI6IGFwcGVuZCgkc3BsaXQtYXJyLCAkc3RyaW5nKTtcblxuICBAcmV0dXJuICRzcGxpdC1hcnI7XG59XG5cblxuLy8gU3RyaW5nIEV4dHJhY3QgRnVuY3Rpb25cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbkBmdW5jdGlvbiBzdHItZXh0cmFjdCgkc3RyaW5nLCAkc3RhcnQsICRlbmQpIHtcbiAgJHN0YXJ0LWluZGV4OiBzdHItaW5kZXgoJHN0cmluZywgJHN0YXJ0KTtcblxuICBAaWYgJHN0YXJ0LWluZGV4IHtcbiAgICAkcG9zdDogc3RyLXNsaWNlKCRzdHJpbmcsICRzdGFydC1pbmRleCArIHN0ci1sZW5ndGgoJHN0YXJ0KSk7XG4gICAgJGVuZC1pbmRleDogc3RyLWluZGV4KCRwb3N0LCAkZW5kKTtcblxuICAgIEBpZiAkZW5kLWluZGV4IHtcbiAgICAgIEByZXR1cm4gc3RyLXNsaWNlKCRwb3N0LCAxLCAkZW5kLWluZGV4IC0gMSk7XG4gICAgfVxuICB9XG5cbiAgQHJldHVybiBudWxsO1xufVxuXG5cbi8vIFN0cmluZyBDb250YWlucyBGdW5jdGlvblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuQGZ1bmN0aW9uIHN0ci1jb250YWlucygkc3RyaW5nLCAkbmVlZGxlKSB7XG4gIEBpZiAodHlwZS1vZigkc3RyaW5nKSA9PSBzdHJpbmcpIHtcbiAgICBAcmV0dXJuIHN0ci1pbmRleCgkc3RyaW5nLCAkbmVlZGxlKSAhPSBudWxsO1xuICB9XG5cbiAgQHJldHVybiBmYWxzZTtcbn1cblxuXG4vLyBVUkwgRW5jb2RlIEZ1bmN0aW9uXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5AZnVuY3Rpb24gdXJsLWVuY29kZSgkdmFsKSB7XG4gICRzcGFjZXM6IHN0ci1yZXBsYWNlKCR2YWwsIFwiIFwiLCBcIiUyMFwiKTtcbiAgJGVuY29kZWQ6IHN0ci1yZXBsYWNlKCRzcGFjZXMsIFwiI1wiLCBcIiUyM1wiKTtcbiAgQHJldHVybiAkZW5jb2RlZDtcbn1cblxuXG4vLyBBZGQgUm9vdCBTZWxlY3RvclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIEFkZHMgYSByb290IHNlbGVjdG9yIHVzaW5nIGhvc3QgYmFzZWQgb24gdGhlIHNlbGVjdG9yIHBhc3NlZFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuQGZ1bmN0aW9uIGFkZC1yb290LXNlbGVjdG9yKCRyb290LCAkYWRkSG9zdFNlbGVjdG9yKSB7XG4gICRzZWxlY3RvcnM6IHN0ci1zcGxpdCgkcm9vdCwgXCIsXCIpO1xuXG4gICRsaXN0OiAoKTtcblxuICBAZWFjaCAkc2VsZWN0b3IgaW4gJHNlbGVjdG9ycyB7XG4gICAgLy8gSWYgdGhlIHNlbGVjdG9yIGNvbnRhaW5zIDpob3N0KCBpdCBtZWFucyBpdCBpcyB0YXJnZXRpbmcgYSBjbGFzcyBvbiB0aGUgaG9zdFxuICAgIC8vIGVsZW1lbnQgc28gd2UgbmVlZCB0byBjaGFuZ2UgaG93IHdlIHRhcmdldCBpdDpcbiAgICAvLyBAaW5jbHVkZSBhZGQtcm9vdC1zZWxlY3RvcihcIjpob3N0KC5maXhlZClcIiwgXCJbZGlyPXJ0bF1cIilcbiAgICAvLyAtLT4gOmhvc3QtY29udGV4dChbZGlyPXJ0bF0pOmhvc3QoLmZpeGVkKVxuICAgIC8vIC0tPiA6aG9zdC1jb250ZXh0KFtkaXI9cnRsXSkuZml4ZWRcbiAgICBAaWYgc3RyLWNvbnRhaW5zKCRzZWxlY3RvciwgXCI6aG9zdChcIikge1xuICAgICAgLy8gQGluY2x1ZGUgYWRkLXJvb3Qtc2VsZWN0b3IoXCI6aG9zdCguZml4ZWQpXCIsIFwiW2Rpcj1ydGxdXCIpXG4gICAgICAvLyAtLT4gOmhvc3QtY29udGV4dChbZGlyPXJ0bF0pOmhvc3QoLmZpeGVkKVxuICAgICAgJHNoYWRvdy1lbGVtZW50OiBzdHItcmVwbGFjZSgkc2VsZWN0b3IsIFwiOmhvc3QoXCIsIFwiOmhvc3QtY29udGV4dCgjeyRhZGRIb3N0U2VsZWN0b3J9KTpob3N0KFwiKTtcbiAgICAgICRsaXN0OiBhcHBlbmQoJGxpc3QsICRzaGFkb3ctZWxlbWVudCwgY29tbWEpO1xuXG4gICAgICAkbmV3LWVsZW1lbnQ6ICgpO1xuICAgICAgJGVsZW1lbnRzOiBzdHItc3BsaXQoJHNlbGVjdG9yLCBcIiBcIik7XG5cbiAgICAgIEBlYWNoICRlbGVtZW50IGluICRlbGVtZW50cyB7XG4gICAgICAgIEBpZiBzdHItY29udGFpbnMoJGVsZW1lbnQsIFwiOmhvc3QoXCIpIHtcbiAgICAgICAgICAkc2NvcGVkLWVsZW1lbnQ6ICRlbGVtZW50O1xuXG4gICAgICAgICAgLy8gUmVwbGFjZSB0aGUgOmhvc3QoIGFuZCApIHNvIGFsbCB3ZSBoYXZlIGxlZnQgaXMgdGhlIGNsYXNzXG4gICAgICAgICAgLy8gaW5zaWRlIG9mIGl0OlxuICAgICAgICAgIC8vIDpob3N0KC5maXhlZCkgLT4gLmZpeGVkXG4gICAgICAgICAgJHNjb3BlZC1lbGVtZW50OiBzdHItcmVwbGFjZSgkc2NvcGVkLWVsZW1lbnQsIFwiKVwiLCBcIlwiKTtcbiAgICAgICAgICAkc2NvcGVkLWVsZW1lbnQ6IHN0ci1yZXBsYWNlKCRzY29wZWQtZWxlbWVudCwgXCI6aG9zdChcIiwgXCJcIik7XG5cbiAgICAgICAgICAvLyBBZGQgdGhlIGNsYXNzIGJhY2sgaW5zaWRlIG9mIGhvc3Qgd2l0aCB0aGUgcnRsIHNlbGVjdG9yOlxuICAgICAgICAgIC8vIC5maXhlZCAtPiA6aG9zdC1jb250ZXh0KFtkaXI9cnRsXSkuZml4ZWRcbiAgICAgICAgICAkc2NvcGVkLWVsZW1lbnQ6IHN0ci1yZXBsYWNlKCRzY29wZWQtZWxlbWVudCwgJHNjb3BlZC1lbGVtZW50LCBcIjpob3N0LWNvbnRleHQoI3skYWRkSG9zdFNlbGVjdG9yfSkjeyRzY29wZWQtZWxlbWVudH1cIik7XG5cbiAgICAgICAgICAvLyBAaW5jbHVkZSBhZGQtcm9vdC1zZWxlY3RvcihcIjpob3N0KC5maXhlZClcIiwgXCJbZGlyPXJ0bF1cIilcbiAgICAgICAgICAvLyAtLT4gOmhvc3QtY29udGV4dChbZGlyPXJ0bF0pLmZpeGVkXG4gICAgICAgICAgJG5ldy1lbGVtZW50OiBhcHBlbmQoJG5ldy1lbGVtZW50LCAkc2NvcGVkLWVsZW1lbnQsIHNwYWNlKTtcbiAgICAgICAgfSBAZWxzZSB7XG4gICAgICAgICAgLy8gQWRkIGJhY2sgYW55IHNlbGVjdG9ycyB0aGF0IGZvbGxvd2VkIHRoZSBob3N0IGFmdGVyIHRyYW5zZm9ybWluZyB0aGVcbiAgICAgICAgICAvLyBmaXJzdCBzZWxlY3RvcjpcbiAgICAgICAgICAvLyA6aG9zdCguZml4ZWQpIDo6c2xvdHRlZChpb24taWNvbilcbiAgICAgICAgICAvLyAtLT4gOmhvc3QtY29udGV4dChbZGlyPXJ0bF0pOmhvc3QoLmZpeGVkKSA6OnNsb3R0ZWQoaW9uLWljb24pXG4gICAgICAgICAgLy8gLS0+IDpob3N0LWNvbnRleHQoW2Rpcj1ydGxdKS5maXhlZCA6OnNsb3R0ZWQoaW9uLWljb24pXG4gICAgICAgICAgJG5ldy1lbGVtZW50OiBhcHBlbmQoJG5ldy1lbGVtZW50LCAkZWxlbWVudCwgc3BhY2UpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgICRsaXN0OiBhcHBlbmQoJGxpc3QsICRuZXctZWxlbWVudCwgY29tbWEpO1xuICAgIC8vIElmIHRoZSBzZWxlY3RvciBjb250YWlucyA6aG9zdCB3aXRob3V0IGEgcGFyYW50aGVzZXNcbiAgICAvLyBpdCBtZWFucyBpdCBpcyB0YXJnZXRpbmcganVzdCB0aGUgaG9zdFxuICAgIC8vIGVsZW1lbnQgc28gd2UgY2FuIGNoYW5nZSBpdCB0byBsb29rIGZvciBob3N0LWNvbnRleHRcbiAgICAvLyBAaW5jbHVkZSBhZGQtcm9vdC1zZWxlY3RvcihcIjpob3N0XCIsIFwiW2Rpcj1ydGxdXCIpXG4gICAgLy8gLS0+IDpob3N0LWNvbnRleHQoW2Rpcj1ydGxdKVxuICAgIC8vIC0tPiA6aG9zdDpkaXIocnRsKVxuICAgIH0gQGVsc2UgaWYgc3RyLWNvbnRhaW5zKCRzZWxlY3RvciwgXCI6aG9zdFwiKSB7XG4gICAgICAkbmV3LWVsZW1lbnQ6ICgpO1xuICAgICAgJGVsZW1lbnRzOiBzdHItc3BsaXQoJHNlbGVjdG9yLCBcIiBcIik7XG5cbiAgICAgIEBlYWNoICRlbGVtZW50IGluICRlbGVtZW50cyB7XG4gICAgICAgIEBpZiBzdHItY29udGFpbnMoJGVsZW1lbnQsIFwiOmhvc3RcIikge1xuICAgICAgICAgIC8vIFJlcGxhY2UgdGhlIDpob3N0IHdpdGggdGhlIGFkZEhvc3RTZWxlY3RvcjpcbiAgICAgICAgICAvLyA6aG9zdCAtPiA6aG9zdC1jb250ZXh0KFtkaXI9cnRsXSlcbiAgICAgICAgICAkdXBkYXRlZC1lbGVtZW50OiBzdHItcmVwbGFjZSgkZWxlbWVudCwgXCI6aG9zdFwiLCBcIjpob3N0LWNvbnRleHQoI3skYWRkSG9zdFNlbGVjdG9yfSlcIik7XG5cbiAgICAgICAgICAvLyBBZGQgdGhlIGZpbmFsIHNlbGVjdG9yIGFmdGVyIGFsbCB0cmFuc2Zvcm1hdGlvbnM6XG4gICAgICAgICAgLy8gOmhvc3QgLT4gOmhvc3QtY29udGV4dChbZGlyPXJ0bF0pXG4gICAgICAgICAgJG5ldy1lbGVtZW50OiBhcHBlbmQoJG5ldy1lbGVtZW50LCAkdXBkYXRlZC1lbGVtZW50LCBzcGFjZSk7XG4gICAgICAgIH0gQGVsc2Uge1xuICAgICAgICAgIC8vIEFkZCBiYWNrIGFueSBzZWxlY3RvcnMgdGhhdCBmb2xsb3dlZCB0aGUgaG9zdCBhZnRlciB0cmFuc2Zvcm1pbmcgdGhlXG4gICAgICAgICAgLy8gZmlyc3Qgc2VsZWN0b3I6XG4gICAgICAgICAgLy8gOmhvc3QgOjpzbG90dGVkKGlvbi1pY29uKSAtPiA6aG9zdC1jb250ZXh0KFtkaXI9cnRsXSkgOjpzbG90dGVkKGlvbi1pY29uKVxuICAgICAgICAgICRuZXctZWxlbWVudDogYXBwZW5kKCRuZXctZWxlbWVudCwgJGVsZW1lbnQsIHNwYWNlKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAkbGlzdDogYXBwZW5kKCRsaXN0LCAkbmV3LWVsZW1lbnQsIGNvbW1hKTtcbiAgICAvLyBJZiB0aGUgc2VsZWN0b3IgZG9lcyBub3QgY29udGFpbiBob3N0IGF0IGFsbCBpdCBpcyBlaXRoZXIgYSBzaGFkb3dcbiAgICAvLyBvciBub3JtYWwgZWxlbWVudCBzbyBhcHBlbmQgYm90aCB0aGUgYWRkSG9zdFNlbGVjdG9yIGFuZCBob3N0LWNvbnRleHRcbiAgICAvLyBAaW5jbHVkZSBhZGQtcm9vdC1zZWxlY3RvcihcImlvbi1jb21wb25lbnRcIiwgXCJbZGlyPXJ0bF1cIilcbiAgICAvLyAtLT4gOmhvc3QtY29udGV4dChbZGlyPXJ0bF0pIGlvbi1jb21wb25lbnRcbiAgICAvLyAtLT4gW2Rpcj1ydGxdIGlvbi1jb21wb25lbnRcbiAgICB9IEBlbHNlIHtcbiAgICAgICRsaXN0OiBhcHBlbmQoJGxpc3QsIFwiI3skYWRkSG9zdFNlbGVjdG9yfSAjeyRzZWxlY3Rvcn1cIiwgY29tbWEpO1xuICAgICAgJGxpc3Q6IGFwcGVuZCgkbGlzdCwgXCI6aG9zdC1jb250ZXh0KCN7JGFkZEhvc3RTZWxlY3Rvcn0pICN7JHNlbGVjdG9yfVwiLCBjb21tYSk7XG4gICAgfVxuICB9XG5cbiAgQHJldHVybiAkbGlzdDtcbn1cbiIsIi8qKlxuICogSW1wb3J0ZWQgaW9uaWMgY29sb3IgZnVuY3Rpb25zIGZvciBTQ1NTXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiBFeHRyYWN0ZWQgZnJvbVxuICogaHR0cHM6Ly9naXRodWIuY29tL2lvbmljLXRlYW0vaW9uaWMtZnJhbWV3b3JrL2Jsb2IvbWFzdGVyL2NvcmUvc3JjL3RoZW1lcy9pb25pYy5mdW5jdGlvbnMuY29sb3Iuc2Nzc1xuICovXG5cbi8vIEdldHMgdGhlIGFjdGl2ZSBjb2xvcidzIGNzcyB2YXJpYWJsZSBmcm9tIGEgdmFyaWF0aW9uLiBBbHBoYSBpcyBvcHRpb25hbC5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBFeGFtcGxlIHVzYWdlOlxuLy8gY3VycmVudC1jb2xvcihiYXNlKSA9PiB2YXIoLS1pb24tY29sb3ItYmFzZSlcbi8vIGN1cnJlbnQtY29sb3IoY29udHJhc3QsIDAuMSkgPT4gcmdiYSh2YXIoLS1pb24tY29sb3ItY29udHJhc3QtcmdiKSwgMC4xKVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbkBmdW5jdGlvbiBjdXJyZW50LWNvbG9yKCR2YXJpYXRpb24sICRhbHBoYTogbnVsbCkge1xuICBAaWYgJGFscGhhID09IG51bGwge1xuICAgIEByZXR1cm4gdmFyKC0taW9uLWNvbG9yLSN7JHZhcmlhdGlvbn0pO1xuICB9IEBlbHNlIHtcbiAgICBAcmV0dXJuIHJnYmEodmFyKC0taW9uLWNvbG9yLSN7JHZhcmlhdGlvbn0tcmdiKSwgI3skYWxwaGF9KTtcbiAgfVxufVxuXG4vLyBHZXRzIHRoZSBzcGVjaWZpYyBjb2xvcidzIGNzcyB2YXJpYWJsZSBmcm9tIHRoZSBuYW1lIGFuZCB2YXJpYXRpb24uIEFscGhhL3JnYiBhcmUgb3B0aW9uYWwuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gRXhhbXBsZSB1c2FnZTpcbi8vIGlvbi1jb2xvcihwcmltYXJ5LCBiYXNlKSA9PiB2YXIoLS1pb24tY29sb3ItcHJpbWFyeSwgIzM4ODBmZilcbi8vIGlvbi1jb2xvcihzZWNvbmRhcnksIGNvbnRyYXN0KSA9PiB2YXIoLS1pb24tY29sb3Itc2Vjb25kYXJ5LWNvbnRyYXN0KVxuLy8gaW9uLWNvbG9yKHByaW1hcnksIGJhc2UsIDAuNSkgPT4gcmdiYSh2YXIoLS1pb24tY29sb3ItcHJpbWFyeS1yZ2IsIDU2LCAxMjgsIDI1NSksIDAuNSlcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5AZnVuY3Rpb24gaW9uLWNvbG9yKCRuYW1lLCAkdmFyaWF0aW9uLCAkYWxwaGE6IG51bGwsICRyZ2I6IG51bGwpIHtcbiAgJHZhbHVlczogbWFwLWdldCgkY29sb3JzLCAkbmFtZSk7XG4gICR2YWx1ZTogbWFwLWdldCgkdmFsdWVzLCAkdmFyaWF0aW9uKTtcbiAgJHZhcmlhYmxlOiAtLWlvbi1jb2xvci0jeyRuYW1lfS0jeyR2YXJpYXRpb259O1xuXG4gIEBpZiAoJHZhcmlhdGlvbiA9PSBiYXNlKSB7XG4gICAgJHZhcmlhYmxlOiAtLWlvbi1jb2xvci0jeyRuYW1lfTtcbiAgfVxuXG4gIEBpZiAoJGFscGhhKSB7XG4gICAgJHZhbHVlOiBjb2xvci10by1yZ2ItbGlzdCgkdmFsdWUpO1xuICAgIEByZXR1cm4gcmdiYSh2YXIoI3skdmFyaWFibGV9LXJnYiwgJHZhbHVlKSwgJGFscGhhKTtcbiAgfVxuICBAaWYgKCRyZ2IpIHtcbiAgICAkdmFsdWU6IGNvbG9yLXRvLXJnYi1saXN0KCR2YWx1ZSk7XG4gICAgJHZhcmlhYmxlOiAjeyR2YXJpYWJsZX0tcmdiO1xuICB9XG5cbiAgQHJldHVybiB2YXIoI3skdmFyaWFibGV9LCAkdmFsdWUpO1xufVxuXG4vLyBNaXhlcyBhIGNvbG9yIHdpdGggYmxhY2sgdG8gY3JlYXRlIGl0cyBzaGFkZS5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5AZnVuY3Rpb24gZ2V0LWNvbG9yLXNoYWRlKCRjb2xvcikge1xuICBAcmV0dXJuIG1peCgjMDAwLCAkY29sb3IsIDEyJSk7XG59XG5cbi8vIE1peGVzIGEgY29sb3Igd2l0aCB3aGl0ZSB0byBjcmVhdGUgaXRzIHRpbnQuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQGZ1bmN0aW9uIGdldC1jb2xvci10aW50KCRjb2xvcikge1xuICBAcmV0dXJuIG1peCgjZmZmLCAkY29sb3IsIDEwJSk7XG59XG5cbi8vIENvbnZlcnRzIGEgY29sb3IgdG8gYSBjb21tYSBzZXBhcmF0ZWQgcmdiLlxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbkBmdW5jdGlvbiBjb2xvci10by1yZ2ItbGlzdCgkY29sb3IpIHtcbiAgQHJldHVybiAje3JlZCgkY29sb3IpfSwje2dyZWVuKCRjb2xvcil9LCN7Ymx1ZSgkY29sb3IpfTtcbn1cbiIsIi8qKlxuICogSW1wb3J0ZWQgaW9uaWMgbWl4aW5zIGZvciBTQ1NTXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiBFeHRyYWN0ZWQgZnJvbVxuICogaHR0cHM6Ly9naXRodWIuY29tL2lvbmljLXRlYW0vaW9uaWMtZnJhbWV3b3JrL2Jsb2IvbWFzdGVyL2NvcmUvc3JjL3RoZW1lcy9pb25pYy5taXhpbnMuc2Nzc1xuICovXG5cbkBtaXhpbiBpbnB1dC1jb3ZlcigpIHtcbiAgQGluY2x1ZGUgcG9zaXRpb24oMCwgbnVsbCwgbnVsbCwgMCk7XG4gIEBpbmNsdWRlIG1hcmdpbigwKTtcblxuICBwb3NpdGlvbjogYWJzb2x1dGU7XG5cbiAgd2lkdGg6IDEwMCU7XG4gIGhlaWdodDogMTAwJTtcblxuICBib3JkZXI6IDA7XG4gIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50O1xuICBjdXJzb3I6IHBvaW50ZXI7XG5cbiAgYXBwZWFyYW5jZTogbm9uZTtcbiAgb3V0bGluZTogbm9uZTtcblxuICAmOjotbW96LWZvY3VzLWlubmVyIHtcbiAgICBib3JkZXI6IDA7XG4gIH1cbn1cblxuQG1peGluIHZpc3VhbGx5LWhpZGRlbigpIHtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuXG4gIHRvcDogMDtcbiAgbGVmdDogMDtcbiAgcmlnaHQ6IDA7XG4gIGJvdHRvbTogMDtcblxuICB3aWR0aDogMTAwJTtcbiAgaGVpZ2h0OiAxMDAlO1xuXG4gIG1hcmdpbjogMDtcbiAgcGFkZGluZzogMDtcblxuICBib3JkZXI6IDA7XG4gIG91dGxpbmU6IDA7XG4gIGNsaXA6IHJlY3QoMCAwIDAgMCk7XG5cbiAgb3BhY2l0eTogMDtcbiAgb3ZlcmZsb3c6IGhpZGRlbjtcblxuICAtd2Via2l0LWFwcGVhcmFuY2U6IG5vbmU7XG4gIC1tb3otYXBwZWFyYW5jZTogbm9uZTtcbn1cblxuQG1peGluIHRleHQtaW5oZXJpdCgpIHtcbiAgZm9udC1mYW1pbHk6IGluaGVyaXQ7XG4gIGZvbnQtc2l6ZTogaW5oZXJpdDtcbiAgZm9udC1zdHlsZTogaW5oZXJpdDtcbiAgZm9udC13ZWlnaHQ6IGluaGVyaXQ7XG4gIGxldHRlci1zcGFjaW5nOiBpbmhlcml0O1xuICB0ZXh0LWRlY29yYXRpb246IGluaGVyaXQ7XG4gIHRleHQtaW5kZW50OiBpbmhlcml0O1xuICB0ZXh0LW92ZXJmbG93OiBpbmhlcml0O1xuICB0ZXh0LXRyYW5zZm9ybTogaW5oZXJpdDtcbiAgdGV4dC1hbGlnbjogaW5oZXJpdDtcbiAgd2hpdGUtc3BhY2U6IGluaGVyaXQ7XG4gIGNvbG9yOiBpbmhlcml0O1xufVxuXG5AbWl4aW4gYnV0dG9uLXN0YXRlKCkge1xuICBAaW5jbHVkZSBwb3NpdGlvbigwLCAwLCAwLCAwKTtcblxuICBwb3NpdGlvbjogYWJzb2x1dGU7XG5cbiAgY29udGVudDogXCJcIjtcblxuICBvcGFjaXR5OiAwO1xufVxuXG4vLyBGb250IHNtb290aGluZ1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuQG1peGluIGZvbnQtc21vb3RoaW5nKCkge1xuICAtbW96LW9zeC1mb250LXNtb290aGluZzogZ3JheXNjYWxlO1xuICAtd2Via2l0LWZvbnQtc21vb3RoaW5nOiBhbnRpYWxpYXNlZDtcbn1cblxuLy8gR2V0IHRoZSBrZXkgZnJvbSBhIG1hcCBiYXNlZCBvbiB0aGUgaW5kZXhcbkBmdW5jdGlvbiBpbmRleC10by1rZXkoJG1hcCwgJGluZGV4KSB7XG4gICRrZXlzOiBtYXAta2V5cygkbWFwKTtcblxuICBAcmV0dXJuIG50aCgka2V5cywgJGluZGV4KTtcbn1cblxuXG4vLyBCcmVha3BvaW50IE1peGluc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbi8vIEJyZWFrcG9pbnQgdmlld3BvcnQgc2l6ZXMgYW5kIG1lZGlhIHF1ZXJpZXMuXG4vL1xuLy8gQnJlYWtwb2ludHMgYXJlIGRlZmluZWQgYXMgYSBtYXAgb2YgKG5hbWU6IG1pbmltdW0gd2lkdGgpLCBvcmRlciBmcm9tIHNtYWxsIHRvIGxhcmdlOlxuLy9cbi8vICAgICh4czogMCwgc206IDU3NnB4LCBtZDogNzY4cHgsIGxnOiA5OTJweCwgeGw6IDEyMDBweClcbi8vXG4vLyBUaGUgbWFwIGRlZmluZWQgaW4gdGhlIGAkc2NyZWVuLWJyZWFrcG9pbnRzYCBnbG9iYWwgdmFyaWFibGUgaXMgdXNlZCBhcyB0aGUgYCRicmVha3BvaW50c2AgYXJndW1lbnQgYnkgZGVmYXVsdC5cblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbi8vIE1pbmltdW0gYnJlYWtwb2ludCB3aWR0aC4gTnVsbCBmb3IgdGhlIHNtYWxsZXN0IChmaXJzdCkgYnJlYWtwb2ludC5cbi8vXG4vLyAgICA+PiBicmVha3BvaW50LW1pbihzbSwgKHhzOiAwLCBzbTogNTc2cHgsIG1kOiA3NjhweCwgbGc6IDk5MnB4LCB4bDogMTIwMHB4KSlcbi8vICAgIDU3NnB4XG5AZnVuY3Rpb24gYnJlYWtwb2ludC1taW4oJG5hbWUsICRicmVha3BvaW50czogJHNjcmVlbi1icmVha3BvaW50cykge1xuICAkbWluOiBtYXAtZ2V0KCRicmVha3BvaW50cywgJG5hbWUpO1xuXG4gIEByZXR1cm4gaWYoJG5hbWUgIT0gaW5kZXgtdG8ta2V5KCRicmVha3BvaW50cywgMSksICRtaW4sIG51bGwpO1xufVxuXG4vLyBSZXR1cm5zIGEgYmxhbmsgc3RyaW5nIGlmIHNtYWxsZXN0IGJyZWFrcG9pbnQsIG90aGVyd2lzZSByZXR1cm5zIHRoZSBuYW1lIHdpdGggYSBkYXNoIGluZnJvbnQuXG4vLyBVc2VmdWwgZm9yIG1ha2luZyByZXNwb25zaXZlIHV0aWxpdGllcy5cbi8vXG4vLyAgICA+PiBicmVha3BvaW50LWluZml4KHhzLCAoeHM6IDAsIHNtOiA1NzZweCwgbWQ6IDc2OHB4LCBsZzogOTkycHgsIHhsOiAxMjAwcHgpKVxuLy8gICAgXCJcIiAgKFJldHVybnMgYSBibGFuayBzdHJpbmcpXG4vLyAgICA+PiBicmVha3BvaW50LWluZml4KHNtLCAoeHM6IDAsIHNtOiA1NzZweCwgbWQ6IDc2OHB4LCBsZzogOTkycHgsIHhsOiAxMjAwcHgpKVxuLy8gICAgXCItc21cIlxuQGZ1bmN0aW9uIGJyZWFrcG9pbnQtaW5maXgoJG5hbWUsICRicmVha3BvaW50czogJHNjcmVlbi1icmVha3BvaW50cykge1xuICBAcmV0dXJuIGlmKGJyZWFrcG9pbnQtbWluKCRuYW1lLCAkYnJlYWtwb2ludHMpID09IG51bGwsIFwiXCIsIFwiLSN7JG5hbWV9XCIpO1xufVxuXG4vLyBNZWRpYSBvZiBhdCBsZWFzdCB0aGUgbWluaW11bSBicmVha3BvaW50IHdpZHRoLiBObyBxdWVyeSBmb3IgdGhlIHNtYWxsZXN0IGJyZWFrcG9pbnQuXG4vLyBNYWtlcyB0aGUgQGNvbnRlbnQgYXBwbHkgdG8gdGhlIGdpdmVuIGJyZWFrcG9pbnQgYW5kIHdpZGVyLlxuQG1peGluIG1lZGlhLWJyZWFrcG9pbnQtdXAoJG5hbWUsICRicmVha3BvaW50czogJHNjcmVlbi1icmVha3BvaW50cykge1xuICAkbWluOiBicmVha3BvaW50LW1pbigkbmFtZSwgJGJyZWFrcG9pbnRzKTtcbiAgQGlmICRtaW4ge1xuICAgIEBtZWRpYSAobWluLXdpZHRoOiAkbWluKSB7XG4gICAgICBAY29udGVudDtcbiAgICB9XG4gIH0gQGVsc2Uge1xuICAgIEBjb250ZW50O1xuICB9XG59XG5cbi8vIE5hbWUgb2YgdGhlIG5leHQgYnJlYWtwb2ludCwgb3IgbnVsbCBmb3IgdGhlIGxhc3QgYnJlYWtwb2ludC5cbi8vXG4vLyAgICA+PiBicmVha3BvaW50LW5leHQoc20pXG4vLyAgICBtZFxuLy8gICAgPj4gYnJlYWtwb2ludC1uZXh0KHNtLCAoeHM6IDAsIHNtOiA1NzZweCwgbWQ6IDc2OHB4LCBsZzogOTkycHgsIHhsOiAxMjAwcHgpKVxuLy8gICAgbWRcbi8vICAgID4+IGJyZWFrcG9pbnQtbmV4dChzbSwgJGJyZWFrcG9pbnQtbmFtZXM6ICh4cyBzbSBtZCBsZyB4bCkpXG4vLyAgICBtZFxuQGZ1bmN0aW9uIGJyZWFrcG9pbnQtbmV4dCgkbmFtZSwgJGJyZWFrcG9pbnRzOiAkc2NyZWVuLWJyZWFrcG9pbnRzLCAkYnJlYWtwb2ludC1uYW1lczogbWFwLWtleXMoJGJyZWFrcG9pbnRzKSkge1xuICAkbjogaW5kZXgoJGJyZWFrcG9pbnQtbmFtZXMsICRuYW1lKTtcbiAgQHJldHVybiBpZigkbiA8IGxlbmd0aCgkYnJlYWtwb2ludC1uYW1lcyksIG50aCgkYnJlYWtwb2ludC1uYW1lcywgJG4gKyAxKSwgbnVsbCk7XG59XG5cbi8vIE1heGltdW0gYnJlYWtwb2ludCB3aWR0aC4gTnVsbCBmb3IgdGhlIHNtYWxsZXN0IChmaXJzdCkgYnJlYWtwb2ludC5cbi8vIFRoZSBtYXhpbXVtIHZhbHVlIGlzIHJlZHVjZWQgYnkgMC4wMnB4IHRvIHdvcmsgYXJvdW5kIHRoZSBsaW1pdGF0aW9ucyBvZlxuLy8gYG1pbi1gIGFuZCBgbWF4LWAgcHJlZml4ZXMgYW5kIHZpZXdwb3J0cyB3aXRoIGZyYWN0aW9uYWwgd2lkdGhzLlxuLy9cbi8vIFNlZSBodHRwczovL3d3dy53My5vcmcvVFIvbWVkaWFxdWVyaWVzLTQvI21xLW1pbi1tYXhcbi8vIFVzZXMgMC4wMnB4IHJhdGhlciB0aGFuIDAuMDFweCB0byB3b3JrIGFyb3VuZCBhIGN1cnJlbnQgcm91bmRpbmcgYnVnIGluIFNhZmFyaS5cdC8vIFVzZXMgMC4wMnB4IHJhdGhlciB0aGFuIDAuMDFweCB0byB3b3JrIGFyb3VuZCBhIGN1cnJlbnQgcm91bmRpbmcgYnVnIGluIFNhZmFyaS5cbi8vIFNlZSBodHRwczovL2J1Z3Mud2Via2l0Lm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MTc4MjYxXHQvLyBTZWUgaHR0cHM6Ly9idWdzLndlYmtpdC5vcmcvc2hvd19idWcuY2dpP2lkPTE3ODI2MVxuLy9cbi8vICAgID4+IGJyZWFrcG9pbnQtbWF4KG1kLCAoeHM6IDAsIHNtOiA1NzZweCwgbWQ6IDc2OHB4LCBsZzogOTkycHgsIHhsOiAxMjAwcHgpKVxuLy8gICAgNzY3Ljk4cHhcbkBmdW5jdGlvbiBicmVha3BvaW50LW1heCgkbmFtZSwgJGJyZWFrcG9pbnRzOiAkc2NyZWVuLWJyZWFrcG9pbnRzKSB7XG4gICRtYXg6IG1hcC1nZXQoJGJyZWFrcG9pbnRzLCAkbmFtZSk7XG4gIEByZXR1cm4gaWYoJG1heCBhbmQgJG1heCA+IDAsICRtYXggLSAuMDIsIG51bGwpO1xufVxuXG4vLyBNZWRpYSBvZiBhdCBtb3N0IHRoZSBtYXhpbXVtIGJyZWFrcG9pbnQgd2lkdGguIE5vIHF1ZXJ5IGZvciB0aGUgbGFyZ2VzdCBicmVha3BvaW50LlxuLy8gTWFrZXMgdGhlIEBjb250ZW50IGFwcGx5IHRvIHRoZSBnaXZlbiBicmVha3BvaW50IGFuZCBuYXJyb3dlci5cbkBtaXhpbiBtZWRpYS1icmVha3BvaW50LWRvd24oJG5hbWUsICRicmVha3BvaW50czogJHNjcmVlbi1icmVha3BvaW50cykge1xuICAkbWF4OiBicmVha3BvaW50LW1heCgkbmFtZSwgJGJyZWFrcG9pbnRzKTtcbiAgQGlmICRtYXgge1xuICAgIEBtZWRpYSAobWF4LXdpZHRoOiAkbWF4KSB7XG4gICAgICBAY29udGVudDtcbiAgICB9XG4gIH0gQGVsc2Uge1xuICAgIEBjb250ZW50O1xuICB9XG59XG5cblxuLy8gVGV4dCBEaXJlY3Rpb24gLSBsdHIgLyBydGxcbi8vXG4vLyBDU1MgZGVmYXVsdHMgdG8gdXNlIHRoZSBsdHIgY3NzLCBhbmQgYWRkcyBbZGlyPXJ0bF0gc2VsZWN0b3JzXG4vLyB0byBvdmVycmlkZSBsdHIgZGVmYXVsdHMuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbkBtaXhpbiBtdWx0aS1kaXIoKSB7XG4gIEBjb250ZW50O1xuXG4gIC8vICRyb290OiAjeyZ9O1xuICAvLyBAYXQtcm9vdCBbZGlyXSB7XG4gIC8vICAgI3skcm9vdH0ge1xuICAvLyAgICAgQGNvbnRlbnQ7XG4gIC8vICAgfVxuICAvLyB9XG59XG5cbkBtaXhpbiBydGwoKSB7XG4gICRyb290OiAjeyZ9O1xuXG4gICRyb290U3BsaXQ6IHN0ci1zcGxpdCgkcm9vdCwgXCIsXCIpO1xuICAkc2VsZWN0b3JzOiAje2FkZC1yb290LXNlbGVjdG9yKCRyb290LCBcIltkaXI9cnRsXVwiKX07XG4gICRzZWxlY3RvcnNTcGxpdDogc3RyLXNwbGl0KCRzZWxlY3RvcnMsIFwiLFwiKTtcblxuICAkaG9zdENvbnRleHRTZWxlY3RvcnM6ICgpO1xuICAkcmVzdFNlbGVjdG9yczogKCk7XG4gICRkaXJTZWxlY3RvcnM6ICgpO1xuXG4gIC8vIFNlbGVjdG9ycyBtdXN0IGJlIHNwbGl0IGludG8gaW5kaXZpZHVhbCBzZWxlY3RvcnMgaW4gY2FzZSB0aGUgYnJvd3NlclxuICAvLyBkb2Vzbid0IHN1cHBvcnQgYSBzcGVjaWZpYyBzZWxlY3Rvci5cbiAgLy8gRm9yIGV4YW1wbGUsIEZpcmVmb3ggYW5kIFNhZmFyaSBkb2Vzbid0IHN1cHBvcnQgYDpob3N0LWNvbnRleHQoKWAuXG4gIC8vIElmIGFuIGludmFsaWQgc2VsZWN0b3IgaXMgdXNlZCwgdGhlbiB0aGUgZW50aXJlIGdyb3VwIG9mIHNlbGVjdG9yc1xuICAvLyB3aWxsIGJlIGlnbm9yZWQuXG4gIC8vIEBsaW5rIGh0dHBzOi8vd3d3LnczLm9yZy9UUi9zZWxlY3RvcnMtMy8jZ3JvdXBpbmdcbiAgQGVhY2ggJHNlbGVjdG9yIGluICRzZWxlY3RvcnNTcGxpdCB7XG4gICAgLy8gR3JvdXAgdGhlIHNlbGVjdG9ycyBiYWNrIGludG8gYSBzaW5nbGUgc2VsZWN0b3IgdG8gb3B0aW1pemUgdGhlIG91dHB1dC5cbiAgICBAaWYgc3RyLWluZGV4KCRzZWxlY3RvciwgXCI6aG9zdC1jb250ZXh0XCIpIHtcbiAgICAgICRob3N0Q29udGV4dFNlbGVjdG9yczogYXBwZW5kKCRob3N0Q29udGV4dFNlbGVjdG9ycywgJHNlbGVjdG9yLCBjb21tYSk7XG4gICAgfSBAZWxzZSB7XG4gICAgICAvLyBHcm91cCB0aGUgc2VsZWN0b3JzIGJhY2sgaW50byBhIHNpbmdsZSBzZWxlY3RvciB0byBvcHRpbWl6ZSB0aGUgb3V0cHV0LlxuICAgICAgJHJlc3RTZWxlY3RvcnM6IGFwcGVuZCgkcmVzdFNlbGVjdG9ycywgJHNlbGVjdG9yLCBjb21tYSk7XG4gICAgfVxuICB9XG5cbiAgLy8gU3VwcG9ydGVkIGJ5IENocm9tZS5cbiAgQGlmIGxlbmd0aCgkaG9zdENvbnRleHRTZWxlY3RvcnMpID4gMCB7XG4gICAgQGF0LXJvb3QgI3skaG9zdENvbnRleHRTZWxlY3RvcnN9IHtcbiAgICAgIEBjb250ZW50O1xuICAgIH1cbiAgfVxuXG4gIC8vIFN1cHBvcnRlZCBieSBhbGwgYnJvd3NlcnMuXG4gIEBpZiBsZW5ndGgoJHJlc3RTZWxlY3RvcnMpID4gMCB7XG4gICAgQGF0LXJvb3QgI3skcmVzdFNlbGVjdG9yc30ge1xuICAgICAgQGNvbnRlbnQ7XG4gICAgfVxuICB9XG5cbiAgLy8gSWYgYnJvd3NlciBjYW4gc3VwcG9ydCBgOmRpcigpYCwgdGhlbiBhZGQgdGhlIGA6ZGlyKClgIHNlbGVjdG9ycy5cbiAgLy8gQHN1cHBvcnRzIHNlbGVjdG9yKDpkaXIocnRsKSkgeyAvLyBAIElNUE9UQU5UIE5PVEU6IFRoaXMgaGFzIGJlZW4gcmVtb3ZlZCBiZWNhdXNlIHNlbGVjdG9yIGZ1bmN0aW9uIGlzIG5vdCBzdXBwb3J0ZWQgaW4gY3VycmVudCBTQ1NTXG4gIC8vIEFkZGluZyA6ZGlyKCkgaW4gY2FzZSB0aGUgYnJvd3NlciBkb2Vzbid0IHN1cHBvcnQgYDpob3N0LWNvbnRleHQoKWAgYW5kIGRvZXMgc3VwcG9ydCBgOmRpcigpYC5cbiAgLy8gYDpob3N0LWNvbnRleHQoKWAgaXMgYWRkZWQ6XG4gIC8vIC0gdGhyb3VnaCB0aGUgYGFkZC1yb290LXNlbGVjdG9yKClgIGZ1bmN0aW9uLlxuICAvLyAtIGZpcnN0IHNvIHRoYXQgaXQgdGFrZXMgcHJlY2VkZW5jZSBvdmVyIGA6ZGlyKClgLlxuICAvLyBGb3IgZXhhbXBsZSxcbiAgLy8gLSBGaXJlZm94IGRvZXNuJ3Qgc3VwcG9ydCBgOmhvc3QtY29udGV4dCgpYCwgYnV0IGRvZXMgc3VwcG9ydCBgOmRpcigpYC5cbiAgLy8gLSBTYWZhcmkgZG9lc24ndCBzdXBwb3J0IGA6aG9zdC1jb250ZXh0KClgLCBidXQgU2FmYXJpIDE2LjQrIHN1cHBvcnRzIGA6ZGlyKClgXG4gIC8vIEBsaW5rIGh0dHBzOi8vd2Via2l0Lm9yZy9ibG9nLzEzOTY2L3dlYmtpdC1mZWF0dXJlcy1pbi1zYWZhcmktMTYtNC9cbiAgQGVhY2ggJHNlbGVjdG9yIGluICRyb290U3BsaXQge1xuICAgICRkaXJTZWxlY3RvcjogXCIjeyRzZWxlY3Rvcn06ZGlyKHJ0bClcIjtcbiAgICAvLyBHcm91cCB0aGUgc2VsZWN0b3JzIGJhY2sgaW50byBhIHNpbmdsZSBzZWxlY3RvciB0byBvcHRpbWl6ZSB0aGUgb3V0cHV0LlxuICAgICRkaXJTZWxlY3RvcnM6IGFwcGVuZCgkZGlyU2VsZWN0b3JzLCAkZGlyU2VsZWN0b3IsIGNvbW1hKTtcbiAgfVxuXG4gIC8vIFN1cHBvcnRlZCBieSBGaXJlZm94LlxuICBAaWYgbGVuZ3RoKCRkaXJTZWxlY3RvcnMpID4gMCB7XG4gICAgQGF0LXJvb3QgI3skZGlyU2VsZWN0b3JzfSB7XG4gICAgICBAY29udGVudDtcbiAgICB9XG4gIH1cbiAgLy99XG59XG5cbkBtaXhpbiBsdHIoKSB7XG4gIEBjb250ZW50O1xufVxuXG5cbi8vIFNWRyBCYWNrZ3JvdW5kIEltYWdlIE1peGluXG4vLyBAcGFyYW0ge3N0cmluZ30gJHN2Z1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQG1peGluIHN2Zy1iYWNrZ3JvdW5kLWltYWdlKCRzdmcsICRmbGlwLXJ0bDogZmFsc2UpIHtcbiAgJHVybDogdXJsLWVuY29kZSgkc3ZnKTtcbiAgJHZpZXdCb3g6IHN0ci1zcGxpdChzdHItZXh0cmFjdCgkc3ZnLCBcInZpZXdCb3g9J1wiLCBcIidcIiksIFwiIFwiKTtcblxuICBAaWYgJGZsaXAtcnRsICE9IHRydWUgb3IgJHZpZXdCb3ggPT0gbnVsbCB7XG4gICAgQGluY2x1ZGUgbXVsdGktZGlyKCkge1xuICAgICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKFwiZGF0YTppbWFnZS9zdmcreG1sO2NoYXJzZXQ9dXRmLTgsI3skdXJsfVwiKTtcbiAgICB9XG4gIH0gQGVsc2Uge1xuICAgICR0cmFuc2Zvcm06IFwidHJhbnNmb3JtPSd0cmFuc2xhdGUoI3tudGgoJHZpZXdCb3gsIDMpfSwgMCkgc2NhbGUoLTEsIDEpJ1wiO1xuICAgICRmbGlwcGVkLXVybDogJHN2ZztcbiAgICAkZmxpcHBlZC11cmw6IHN0ci1yZXBsYWNlKCRmbGlwcGVkLXVybCwgXCI8cGF0aFwiLCBcIjxwYXRoICN7JHRyYW5zZm9ybX1cIik7XG4gICAgJGZsaXBwZWQtdXJsOiBzdHItcmVwbGFjZSgkZmxpcHBlZC11cmwsIFwiPGxpbmVcIiwgXCI8bGluZSAjeyR0cmFuc2Zvcm19XCIpO1xuICAgICRmbGlwcGVkLXVybDogc3RyLXJlcGxhY2UoJGZsaXBwZWQtdXJsLCBcIjxwb2x5Z29uXCIsIFwiPHBvbHlnb24gI3skdHJhbnNmb3JtfVwiKTtcbiAgICAkZmxpcHBlZC11cmw6IHVybC1lbmNvZGUoJGZsaXBwZWQtdXJsKTtcblxuICAgIEBpbmNsdWRlIGx0ciAoKSB7XG4gICAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoXCJkYXRhOmltYWdlL3N2Zyt4bWw7Y2hhcnNldD11dGYtOCwjeyR1cmx9XCIpO1xuICAgIH1cbiAgICBAaW5jbHVkZSBydGwoKSB7XG4gICAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoXCJkYXRhOmltYWdlL3N2Zyt4bWw7Y2hhcnNldD11dGYtOCwjeyRmbGlwcGVkLXVybH1cIik7XG4gICAgfVxuICB9XG59XG5cbi8vIEFkZCBwcm9wZXJ0eSBob3Jpem9udGFsXG4vLyBAcGFyYW0ge3N0cmluZ30gJHN0YXJ0XG4vLyBAcGFyYW0ge3N0cmluZ30gJGVuZFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQG1peGluIHByb3BlcnR5LWhvcml6b250YWwoJHByb3AsICRzdGFydCwgJGVuZDogJHN0YXJ0KSB7XG4gIEBpZiAkc3RhcnQgPT0gMCBhbmQgJGVuZCA9PSAwIHtcbiAgICAjeyRwcm9wfS1sZWZ0OiAkc3RhcnQ7XG4gICAgI3skcHJvcH0tcmlnaHQ6ICRlbmQ7XG5cbiAgfSBAZWxzZSB7XG4gICAgLXdlYmtpdC0jeyRwcm9wfS1zdGFydDogJHN0YXJ0O1xuICAgICN7JHByb3B9LWlubGluZS1zdGFydDogJHN0YXJ0O1xuICAgIC13ZWJraXQtI3skcHJvcH0tZW5kOiAkZW5kO1xuICAgICN7JHByb3B9LWlubGluZS1lbmQ6ICRlbmQ7XG4gIH1cbn1cblxuLy8gQWRkIHByb3BlcnR5IGZvciBhbGwgZGlyZWN0aW9uc1xuLy8gQHBhcmFtIHtzdHJpbmd9ICRwcm9wXG4vLyBAcGFyYW0ge3N0cmluZ30gJHRvcFxuLy8gQHBhcmFtIHtzdHJpbmd9ICRlbmRcbi8vIEBwYXJhbSB7c3RyaW5nfSAkYm90dG9tXG4vLyBAcGFyYW0ge3N0cmluZ30gJHN0YXJ0XG4vLyBAcGFyYW0ge2Jvb2xlYW59ICRjb250ZW50IGluY2x1ZGUgY29udGVudCBvciB1c2UgZGVmYXVsdFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQG1peGluIHByb3BlcnR5KCRwcm9wLCAkdG9wLCAkZW5kOiAkdG9wLCAkYm90dG9tOiAkdG9wLCAkc3RhcnQ6ICRlbmQpIHtcbiAgQGluY2x1ZGUgcHJvcGVydHktaG9yaXpvbnRhbCgkcHJvcCwgJHN0YXJ0LCAkZW5kKTtcbiAgI3skcHJvcH0tdG9wOiAkdG9wO1xuICAjeyRwcm9wfS1ib3R0b206ICRib3R0b207XG59XG5cbi8vIEFkZCBwYWRkaW5nIGhvcml6b250YWxcbi8vIEBwYXJhbSB7c3RyaW5nfSAkc3RhcnRcbi8vIEBwYXJhbSB7c3RyaW5nfSAkZW5kXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5AbWl4aW4gcGFkZGluZy1ob3Jpem9udGFsKCRzdGFydCwgJGVuZDogJHN0YXJ0KSB7XG4gIEBpbmNsdWRlIHByb3BlcnR5LWhvcml6b250YWwocGFkZGluZywgJHN0YXJ0LCAkZW5kKTtcbn1cblxuLy8gQWRkIHBhZGRpbmcgZm9yIGFsbCBkaXJlY3Rpb25zXG4vLyBAcGFyYW0ge3N0cmluZ30gJHRvcFxuLy8gQHBhcmFtIHtzdHJpbmd9ICRlbmRcbi8vIEBwYXJhbSB7c3RyaW5nfSAkYm90dG9tXG4vLyBAcGFyYW0ge3N0cmluZ30gJHN0YXJ0XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5AbWl4aW4gcGFkZGluZygkdG9wLCAkZW5kOiAkdG9wLCAkYm90dG9tOiAkdG9wLCAkc3RhcnQ6ICRlbmQpIHtcbiAgQGluY2x1ZGUgcHJvcGVydHkocGFkZGluZywgJHRvcCwgJGVuZCwgJGJvdHRvbSwgJHN0YXJ0KTtcbn1cblxuLy8gQWRkIG1hcmdpbiBob3Jpem9udGFsXG4vLyBAcGFyYW0ge3N0cmluZ30gJHN0YXJ0XG4vLyBAcGFyYW0ge3N0cmluZ30gJGVuZFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQG1peGluIG1hcmdpbi1ob3Jpem9udGFsKCRzdGFydCwgJGVuZDogJHN0YXJ0KSB7XG4gIEBpbmNsdWRlIHByb3BlcnR5LWhvcml6b250YWwobWFyZ2luLCAkc3RhcnQsICRlbmQpO1xufVxuXG4vLyBBZGQgbWFyZ2luIGZvciBhbGwgZGlyZWN0aW9uc1xuLy8gQHBhcmFtIHtzdHJpbmd9ICR0b3Bcbi8vIEBwYXJhbSB7c3RyaW5nfSAkZW5kXG4vLyBAcGFyYW0ge3N0cmluZ30gJGJvdHRvbVxuLy8gQHBhcmFtIHtzdHJpbmd9ICRzdGFydFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQG1peGluIG1hcmdpbigkdG9wLCAkZW5kOiAkdG9wLCAkYm90dG9tOiAkdG9wLCAkc3RhcnQ6ICRlbmQpIHtcbiAgQGluY2x1ZGUgcHJvcGVydHkobWFyZ2luLCAkdG9wLCAkZW5kLCAkYm90dG9tLCAkc3RhcnQpO1xufVxuXG4vLyBBZGQgcG9zaXRpb24gaG9yaXpvbnRhbFxuLy8gQHBhcmFtIHtzdHJpbmd9ICRzdGFydCAtIGFtb3VudCB0byBwb3NpdGlvbiBzdGFydFxuLy8gQHBhcmFtIHtzdHJpbmd9ICRlbmQgLSBhbW91bnQgdG8gbGVmdDogMDsgZW5kXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5AbWl4aW4gcG9zaXRpb24taG9yaXpvbnRhbCgkc3RhcnQ6IG51bGwsICRlbmQ6IG51bGwpIHtcbiAgQGlmICRzdGFydCA9PSAkZW5kIHtcbiAgICBAaW5jbHVkZSBtdWx0aS1kaXIoKSB7XG4gICAgICBsZWZ0OiAkc3RhcnQ7XG4gICAgICByaWdodDogJGVuZDtcbiAgICB9XG4gIH0gQGVsc2Uge1xuICAgIEBhdC1yb290IHtcbiAgICAgIEBzdXBwb3J0cyAoaW5zZXQtaW5saW5lLXN0YXJ0OiAwKSB7XG4gICAgICAgICYge1xuICAgICAgICAgIGluc2V0LWlubGluZS1zdGFydDogJHN0YXJ0O1xuICAgICAgICAgIGluc2V0LWlubGluZS1lbmQ6ICRlbmQ7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBUT0RPIEZXLTM3NjZcbiAgICBAYXQtcm9vdCB7XG4gICAgICBAc3VwcG9ydHMgbm90IChpbnNldC1pbmxpbmUtc3RhcnQ6IDApIHtcbiAgICAgICAgJiB7XG4gICAgICAgICAgQGluY2x1ZGUgbHRyKCkge1xuICAgICAgICAgICAgbGVmdDogJHN0YXJ0O1xuICAgICAgICAgICAgcmlnaHQ6ICRlbmQ7XG4gICAgICAgICAgfVxuICAgICAgICAgIEBpbmNsdWRlIHJ0bCgpIHtcbiAgICAgICAgICAgIGxlZnQ6IHVuc2V0O1xuICAgICAgICAgICAgcmlnaHQ6IHVuc2V0O1xuXG4gICAgICAgICAgICBsZWZ0OiAkZW5kO1xuICAgICAgICAgICAgcmlnaHQ6ICRzdGFydDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cblxuLy8gQWRkIHBvc2l0aW9uIGZvciBhbGwgZGlyZWN0aW9uc1xuLy8gQHBhcmFtIHtzdHJpbmd9ICR0b3Bcbi8vIEBwYXJhbSB7c3RyaW5nfSAkZW5kXG4vLyBAcGFyYW0ge3N0cmluZ30gJGJvdHRvbVxuLy8gQHBhcmFtIHtzdHJpbmd9ICRzdGFydFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQG1peGluIHBvc2l0aW9uKCR0b3A6IG51bGwsICRlbmQ6IG51bGwsICRib3R0b206IG51bGwsICRzdGFydDogbnVsbCkge1xuICBAaW5jbHVkZSBwb3NpdGlvbi1ob3Jpem9udGFsKCRzdGFydCwgJGVuZCk7XG4gIHRvcDogJHRvcDtcbiAgYm90dG9tOiAkYm90dG9tO1xufVxuXG4vLyBBZGQgYm9yZGVyIGZvciBhbGwgZGlyZWN0aW9uc1xuLy8gQHBhcmFtIHtzdHJpbmd9ICR0b3Bcbi8vIEBwYXJhbSB7c3RyaW5nfSAkZW5kXG4vLyBAcGFyYW0ge3N0cmluZ30gJGJvdHRvbVxuLy8gQHBhcmFtIHtzdHJpbmd9ICRzdGFydFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQG1peGluIGJvcmRlcigkdG9wLCAkZW5kOiAkdG9wLCAkYm90dG9tOiAkdG9wLCAkc3RhcnQ6ICRlbmQpIHtcbiAgQGluY2x1ZGUgcHJvcGVydHkoYm9yZGVyLCAkdG9wLCAkZW5kLCAkYm90dG9tLCAkc3RhcnQpO1xufVxuXG4vLyBBZGQgYm9yZGVyIHJhZGl1cyBmb3IgYWxsIGRpcmVjdGlvbnNcbi8vIEBwYXJhbSB7c3RyaW5nfSAkdG9wLXN0YXJ0XG4vLyBAcGFyYW0ge3N0cmluZ30gJHRvcC1lbmRcbi8vIEBwYXJhbSB7c3RyaW5nfSAkYm90dG9tLWVuZFxuLy8gQHBhcmFtIHtzdHJpbmd9ICRib3R0b20tc3RhcnRcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbkBtaXhpbiBib3JkZXItcmFkaXVzKCR0b3Atc3RhcnQsICR0b3AtZW5kOiAkdG9wLXN0YXJ0LCAkYm90dG9tLWVuZDogJHRvcC1zdGFydCwgJGJvdHRvbS1zdGFydDogJHRvcC1lbmQpIHtcbiAgQGlmICR0b3Atc3RhcnQgPT0gJHRvcC1lbmQgYW5kICR0b3Atc3RhcnQgPT0gJGJvdHRvbS1lbmQgYW5kICR0b3Atc3RhcnQgPT0gJGJvdHRvbS1zdGFydCB7XG4gICAgQGluY2x1ZGUgbXVsdGktZGlyKCkge1xuICAgICAgYm9yZGVyLXJhZGl1czogJHRvcC1zdGFydDtcbiAgICB9XG4gIH0gQGVsc2Uge1xuICAgIEBpbmNsdWRlIGx0cigpIHtcbiAgICAgIGJvcmRlci10b3AtbGVmdC1yYWRpdXM6ICR0b3Atc3RhcnQ7XG4gICAgICBib3JkZXItdG9wLXJpZ2h0LXJhZGl1czogJHRvcC1lbmQ7XG4gICAgICBib3JkZXItYm90dG9tLXJpZ2h0LXJhZGl1czogJGJvdHRvbS1lbmQ7XG4gICAgICBib3JkZXItYm90dG9tLWxlZnQtcmFkaXVzOiAkYm90dG9tLXN0YXJ0O1xuICAgIH1cblxuICAgIEBpbmNsdWRlIHJ0bCgpIHtcbiAgICAgIGJvcmRlci10b3AtbGVmdC1yYWRpdXM6ICR0b3AtZW5kO1xuICAgICAgYm9yZGVyLXRvcC1yaWdodC1yYWRpdXM6ICR0b3Atc3RhcnQ7XG4gICAgICBib3JkZXItYm90dG9tLXJpZ2h0LXJhZGl1czogJGJvdHRvbS1zdGFydDtcbiAgICAgIGJvcmRlci1ib3R0b20tbGVmdC1yYWRpdXM6ICRib3R0b20tZW5kO1xuICAgIH1cbiAgfVxufVxuXG4vLyBBZGQgZGlyZWN0aW9uIGZvciBhbGwgZGlyZWN0aW9uc1xuLy8gQHBhcmFtIHtzdHJpbmd9ICRkaXIgLSBEaXJlY3Rpb24gb24gTFRSXG5AbWl4aW4gZGlyZWN0aW9uKCRkaXIpIHtcbiAgJG90aGVyLWRpcjogbnVsbDtcblxuICBAaWYgJGRpciA9PSBsdHIge1xuICAgICRvdGhlci1kaXI6IHJ0bDtcbiAgfSBAZWxzZSB7XG4gICAgJG90aGVyLWRpcjogbHRyO1xuICB9XG5cbiAgQGluY2x1ZGUgbHRyKCkge1xuICAgIGRpcmVjdGlvbjogJGRpcjtcbiAgfVxuICBAaW5jbHVkZSBydGwoKSB7XG4gICAgZGlyZWN0aW9uOiAkb3RoZXItZGlyO1xuICB9XG59XG5cbi8vIEFkZCBmbG9hdCBmb3IgYWxsIGRpcmVjdGlvbnNcbi8vIEBwYXJhbSB7c3RyaW5nfSAkc2lkZVxuLy8gQHBhcmFtIHtzdHJpbmd9ICRkZWNvcmF0b3IgLSAhaW1wb3J0YW50XG5AbWl4aW4gZmxvYXQoJHNpZGUsICRkZWNvcmF0b3I6IG51bGwpIHtcbiAgQGlmICRzaWRlID09IHN0YXJ0IHtcbiAgICBAaW5jbHVkZSBsdHIoKSB7XG4gICAgICBmbG9hdDogbGVmdCAkZGVjb3JhdG9yO1xuICAgIH1cbiAgICBAaW5jbHVkZSBydGwoKSB7XG4gICAgICBmbG9hdDogcmlnaHQgJGRlY29yYXRvcjtcbiAgICB9XG4gIH0gQGVsc2UgaWYgJHNpZGUgPT0gZW5kIHtcbiAgICBAaW5jbHVkZSBsdHIoKSB7XG4gICAgICBmbG9hdDogcmlnaHQgJGRlY29yYXRvcjtcbiAgICB9XG4gICAgQGluY2x1ZGUgcnRsKCkge1xuICAgICAgZmxvYXQ6IGxlZnQgJGRlY29yYXRvcjtcbiAgICB9XG4gIH0gQGVsc2Uge1xuICAgIEBpbmNsdWRlIG11bHRpLWRpcigpIHtcbiAgICAgIGZsb2F0OiAkc2lkZSAkZGVjb3JhdG9yO1xuICAgIH1cbiAgfVxufVxuXG5AbWl4aW4gYmFja2dyb3VuZC1wb3NpdGlvbigkaG9yaXpvbnRhbCwgJGhvcml6b250YWwtYW1vdW50OiBudWxsLCAkdmVydGljYWw6IG51bGwsICR2ZXJ0aWNhbC1hbW91bnQ6IG51bGwpIHtcbiAgQGlmICRob3Jpem9udGFsID09IHN0YXJ0IG9yICRob3Jpem9udGFsID09IGVuZCB7XG4gICAgJGhvcml6b250YWwtbHRyOiBudWxsO1xuICAgICRob3Jpem9udGFsLXJ0bDogbnVsbDtcbiAgICBAaWYgJGhvcml6b250YWwgPT0gc3RhcnQge1xuICAgICAgJGhvcml6b250YWwtbHRyOiBsZWZ0O1xuICAgICAgJGhvcml6b250YWwtcnRsOiByaWdodDtcbiAgICB9IEBlbHNlIHtcbiAgICAgICRob3Jpem9udGFsLWx0cjogcmlnaHQ7XG4gICAgICAkaG9yaXpvbnRhbC1ydGw6IGxlZnQ7XG4gICAgfVxuXG4gICAgQGluY2x1ZGUgbHRyKCkge1xuICAgICAgYmFja2dyb3VuZC1wb3NpdGlvbjogJGhvcml6b250YWwtbHRyICRob3Jpem9udGFsLWFtb3VudCAkdmVydGljYWwgJHZlcnRpY2FsLWFtb3VudDtcbiAgICB9XG4gICAgQGluY2x1ZGUgcnRsKCkge1xuICAgICAgYmFja2dyb3VuZC1wb3NpdGlvbjogJGhvcml6b250YWwtcnRsICRob3Jpem9udGFsLWFtb3VudCAkdmVydGljYWwgJHZlcnRpY2FsLWFtb3VudDtcbiAgICB9XG4gIH0gQGVsc2Uge1xuICAgIEBpbmNsdWRlIG11bHRpLWRpcigpIHtcbiAgICAgIGJhY2tncm91bmQtcG9zaXRpb246ICRob3Jpem9udGFsICRob3Jpem9udGFsLWFtb3VudCAkdmVydGljYWwgJHZlcnRpY2FsLWFtb3VudDtcbiAgICB9XG4gIH1cbn1cblxuQG1peGluIHRyYW5zZm9ybS1vcmlnaW4oJHgtYXhpcywgJHktYXhpczogbnVsbCkge1xuICBAaWYgJHgtYXhpcyA9PSBzdGFydCB7XG4gICAgQGluY2x1ZGUgbHRyKCkge1xuICAgICAgdHJhbnNmb3JtLW9yaWdpbjogbGVmdCAkeS1heGlzO1xuICAgIH1cbiAgICBAaW5jbHVkZSBydGwoKSB7XG4gICAgICB0cmFuc2Zvcm0tb3JpZ2luOiByaWdodCAkeS1heGlzO1xuICAgIH1cbiAgfSBAZWxzZSBpZiAkeC1heGlzID09IGVuZCB7XG4gICAgQGluY2x1ZGUgbHRyKCkge1xuICAgICAgdHJhbnNmb3JtLW9yaWdpbjogcmlnaHQgJHktYXhpcztcbiAgICB9XG4gICAgQGluY2x1ZGUgcnRsKCkge1xuICAgICAgdHJhbnNmb3JtLW9yaWdpbjogbGVmdCAkeS1heGlzO1xuICAgIH1cbiAgfSBAZWxzZSBpZiAkeC1heGlzID09IGxlZnQgb3IgJHgtYXhpcyA9PSByaWdodCB7XG4gICAgQGluY2x1ZGUgbXVsdGktZGlyKCkge1xuICAgICAgdHJhbnNmb3JtLW9yaWdpbjogJHgtYXhpcyAkeS1heGlzO1xuICAgIH1cbiAgfSBAZWxzZSB7XG4gICAgQGluY2x1ZGUgbHRyKCkge1xuICAgICAgdHJhbnNmb3JtLW9yaWdpbjogJHgtYXhpcyAkeS1heGlzO1xuICAgIH1cbiAgICBAaW5jbHVkZSBydGwoKSB7XG4gICAgICB0cmFuc2Zvcm0tb3JpZ2luOiBjYWxjKDEwMCUgLSAjeyR4LWF4aXN9KSAkeS1heGlzO1xuICAgIH1cbiAgfVxufVxuXG4vLyBBZGQgdHJhbnNmb3JtIGZvciBhbGwgZGlyZWN0aW9uc1xuLy8gQHBhcmFtIHtzdHJpbmd9ICR0cmFuc2Zvcm1zIC0gY29tbWEgc2VwYXJhdGVkIGxpc3Qgb2YgdHJhbnNmb3Jtc1xuQG1peGluIHRyYW5zZm9ybSgkdHJhbnNmb3Jtcy4uLikge1xuICAkZXh0cmE6IG51bGw7XG5cbiAgJHg6IG51bGw7XG4gICRsdHItdHJhbnNsYXRlOiBudWxsO1xuICAkcnRsLXRyYW5zbGF0ZTogbnVsbDtcblxuICBAZWFjaCAkdHJhbnNmb3JtIGluICR0cmFuc2Zvcm1zIHtcbiAgICBAaWYgKHN0ci1pbmRleCgkdHJhbnNmb3JtLCB0cmFuc2xhdGUzZCkpIHtcbiAgICAgICR0cmFuc2Zvcm06IHN0ci1yZXBsYWNlKCR0cmFuc2Zvcm0sICd0cmFuc2xhdGUzZCgnKTtcbiAgICAgICR0cmFuc2Zvcm06IHN0ci1yZXBsYWNlKCR0cmFuc2Zvcm0sICcpJyk7XG5cbiAgICAgICRjb29yZGluYXRlczogc3RyLXNwbGl0KCR0cmFuc2Zvcm0sICcsJyk7XG5cbiAgICAgICR4OiBudGgoJGNvb3JkaW5hdGVzLCAxKTtcbiAgICAgICR5OiBudGgoJGNvb3JkaW5hdGVzLCAyKTtcbiAgICAgICR6OiBudGgoJGNvb3JkaW5hdGVzLCAzKTtcblxuICAgICAgJGx0ci10cmFuc2xhdGU6IHRyYW5zbGF0ZTNkKCR4LCAkeSwgJHopO1xuICAgICAgJHJ0bC10cmFuc2xhdGU6IHRyYW5zbGF0ZTNkKGNhbGMoLTEgKiAjeyR4fSksICR5LCAkeik7XG4gICAgfSBAZWxzZSB7XG4gICAgICBAaWYgJGV4dHJhID09IG51bGwge1xuICAgICAgICAkZXh0cmE6ICR0cmFuc2Zvcm07XG4gICAgICB9IEBlbHNlIHtcbiAgICAgICAgJGV4dHJhOiAkZXh0cmEgJHRyYW5zZm9ybTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBAaWYgJHggPT0gJzAnIG9yICR4ID09IG51bGwge1xuICAgIEBpbmNsdWRlIG11bHRpLWRpcigpIHtcbiAgICAgIHRyYW5zZm9ybTogJGx0ci10cmFuc2xhdGUgJGV4dHJhO1xuICAgIH1cbiAgfSBAZWxzZSB7XG4gICAgQGluY2x1ZGUgbHRyKCkge1xuICAgICAgdHJhbnNmb3JtOiAkbHRyLXRyYW5zbGF0ZSAkZXh0cmE7XG4gICAgfVxuXG4gICAgQGluY2x1ZGUgcnRsKCkge1xuICAgICAgdHJhbnNmb3JtOiAkcnRsLXRyYW5zbGF0ZSAkZXh0cmE7XG4gICAgfVxuICB9XG59XG4iLCIvKipcbiAqIEltcG9ydGVkIGlvbmljIG1peGlucyBmb3IgU0NTUyBmcm9tIGRpZmZlcmVudCBjb21wb25lbnRzXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiBFeHRyYWN0ZWQgZnJvbVxuICogaHR0cHM6Ly9naXRodWIuY29tL2lvbmljLXRlYW0vaW9uaWMtZnJhbWV3b3JrL2Jsb2IvbWFzdGVyL2NvcmUvc3JjL2NvbXBvbmVudHMvZ3JpZC9ncmlkLm1peGlucy5zY3NzXG4gKiBodHRwczovL2dpdGh1Yi5jb20vaW9uaWMtdGVhbS9pb25pYy1mcmFtZXdvcmsvYmxvYi9tYXN0ZXIvY29yZS9zcmMvY29tcG9uZW50cy9pdGVtL2l0ZW0ubWl4aW5zLnNjc3NcbiAqL1xuXG4vLyBSZXNwb25zaXZlIE1peGluc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuXG4vLyBDcmVhdGVzIGEgZml4ZWQgd2lkdGggZm9yIHRoZSBncmlkIGJhc2VkIG9uIHRoZSBzY3JlZW4gc2l6ZVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbkBtaXhpbiBtYWtlLWdyaWQtd2lkdGhzKCR3aWR0aHM6ICRncmlkLXdpZHRocywgJGJyZWFrcG9pbnRzOiAkc2NyZWVuLWJyZWFrcG9pbnRzKSB7XG4gIEBlYWNoICRicmVha3BvaW50LCAkd2lkdGggaW4gJHdpZHRocyB7XG4gICAgQGluY2x1ZGUgbWVkaWEtYnJlYWtwb2ludC11cCgkYnJlYWtwb2ludCwgJGJyZWFrcG9pbnRzKSB7XG4gICAgICB3aWR0aDogJHdpZHRoO1xuICAgIH1cbiAgfVxuXG4gIG1heC13aWR0aDogMTAwJTtcbn1cblxuXG4vLyBBZGRzIHBhZGRpbmcgdG8gdGhlIGVsZW1lbnQgYmFzZWQgb24gYnJlYWtwb2ludHNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5AbWl4aW4gbWFrZS1icmVha3BvaW50LXBhZGRpbmcoJHBhZGRpbmdzKSB7XG4gIEBlYWNoICRicmVha3BvaW50IGluIG1hcC1rZXlzKCRwYWRkaW5ncykge1xuICAgIEBpbmNsdWRlIG1lZGlhLWJyZWFrcG9pbnQtdXAoJGJyZWFrcG9pbnQpIHtcbiAgICAgICRwYWRkaW5nOiBtYXAtZ2V0KCRwYWRkaW5ncywgJGJyZWFrcG9pbnQpO1xuXG4gICAgICBAaW5jbHVkZSBwYWRkaW5nKCRwYWRkaW5nKTtcbiAgICB9XG4gIH1cbn1cblxuXG4vLyBJdGVtIE1peGluc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuQG1peGluIGl0ZW0tcHVzaC1zdmctdXJsKCRmaWxsKSB7XG4gICRpdGVtLWRldGFpbC1wdXNoLXN2ZzogXCI8c3ZnIHhtbG5zPSdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Zycgdmlld0JveD0nMCAwIDEyIDIwJz48cGF0aCBkPSdNMiwyMGwtMi0ybDgtOEwwLDJsMi0ybDEwLDEwTDIsMjB6JyBmaWxsPScjeyRmaWxsfScvPjwvc3ZnPlwiO1xuXG4gIEBpbmNsdWRlIHN2Zy1iYWNrZ3JvdW5kLWltYWdlKCRpdGVtLWRldGFpbC1wdXNoLXN2ZywgdHJ1ZSk7XG59XG4iLCJAdXNlIFwic2FzczptYXRoXCIgYXMgbWF0aDtcblxuLyoqXG4gKiBBcHAgY3VzdG9tIG1peGlucyBmb3IgU0NTU1xuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogUGxhY2UgaGVyZSBvdXIgY3VzdG9tIG1peGlucy5cbiAqL1xuXG4vLyBNaXhlcyBhIGNvbG9yIHdpdGggYmxhY2sgdG8gY3JlYXRlIGl0cyBzaGFkZS5cbi8vIERlZmF1bHQgdG8gYm9vdHN0cmFwIGxldmVsIDYuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQGZ1bmN0aW9uIGdldC1jb2xvci1zaGFkZS1wZXJjZW50KCRjb2xvciwgJHBlcmNlbnQ6IDQ4JSkge1xuICAgIEByZXR1cm4gbWl4KCMwMDAsICRjb2xvciwgJHBlcmNlbnQpO1xufVxuXG4vLyBNaXhlcyBhIGNvbG9yIHdpdGggd2hpdGUgdG8gY3JlYXRlIGl0cyB0aW50LlxuLy8gRGVmYXVsdCB0byBib290c3RyYXAgbGV2ZWwgLTEwLlxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbkBmdW5jdGlvbiBnZXQtY29sb3ItdGludC1wZXJjZW50KCRjb2xvciwgJHBlcmNlbnQ6IDgwJSkge1xuICAgIEByZXR1cm4gbWl4KCNmZmYsICRjb2xvciwgJHBlcmNlbnQpO1xufVxuXG4vLyBJb25pYyBDb2xvcnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBHZW5lcmF0ZXMgdGhlIGNvbG9yIGNsYXNzZXMgYW5kIHZhcmlhYmxlcyBiYXNlZCBvbiB0aGVcbi8vIGNvbG9ycyBtYXBcblxuQG1peGluIGdlbmVyYXRlLWNvbG9yKCRjb2xvci1uYW1lLCAkY29sb3JzLCAkdGhlbWUpIHtcbiAgICAkY29sb3ItdGhlbWVzOiBtYXAtZ2V0KCRjb2xvcnMsICRjb2xvci1uYW1lKTtcbiAgICAkYmFzZTogbWFwLWdldCgkY29sb3ItdGhlbWVzLCAkdGhlbWUpO1xuXG4gICAgQGlmICR0aGVtZSA9PSAnZGFyaycge1xuICAgICAgICAkYmFzZTogbWl4KG1hcC1nZXQoJGNvbG9yLXRoZW1lcywgJ2xpZ2h0JyksIHdoaXRlLCA4MCUpICFkZWZhdWx0O1xuICAgIH1cblxuICAgIEBpbmNsdWRlIGdlbmVyYXRlLWNvbG9yLXZhcmlhbnRzKCRjb2xvci1uYW1lLCAkYmFzZSk7XG59XG5cbkBtaXhpbiBnZW5lcmF0ZS1jb2xvci12YXJpYW50cygkY29sb3ItbmFtZSwgJGJhc2UpIHtcbiAgICAkY29udHJhc3Q6IGdldF9jb250cmFzdF9jb2xvcigkYmFzZSk7XG4gICAgJHNoYWRlOiBnZXQtY29sb3Itc2hhZGUtcGVyY2VudCgkYmFzZSk7XG4gICAgJHRpbnQ6IGdldC1jb2xvci10aW50LXBlcmNlbnQoJGJhc2UpO1xuXG4gICAgLS0jeyRjb2xvci1uYW1lfTogI3skYmFzZX07XG4gICAgLS0jeyRjb2xvci1uYW1lfS1zaGFkZTogI3skc2hhZGV9O1xuICAgIC0tI3skY29sb3ItbmFtZX0tdGludDogI3skdGludH07XG4gICAgLS0jeyRjb2xvci1uYW1lfS1jb250cmFzdDogI3skY29udHJhc3R9O1xuXG4gICAgLy8gSW50ZXJuYWwgaW9uaWMgdXNlIG9ubHkuXG4gICAgLS1pb24tY29sb3ItI3skY29sb3ItbmFtZX06IHZhcigtLSN7JGNvbG9yLW5hbWV9KTtcbiAgICAtLWlvbi1jb2xvci0jeyRjb2xvci1uYW1lfS1iYXNlOiB2YXIoLS1pb24tY29sb3ItI3skY29sb3ItbmFtZX0pO1xuICAgIC0taW9uLWNvbG9yLSN7JGNvbG9yLW5hbWV9LXJnYjogI3tjb2xvci10by1yZ2ItbGlzdCgkYmFzZSl9O1xuICAgIC0taW9uLWNvbG9yLSN7JGNvbG9yLW5hbWV9LWNvbnRyYXN0OiAjeyRjb250cmFzdH07XG4gICAgLS1pb24tY29sb3ItI3skY29sb3ItbmFtZX0tY29udHJhc3QtcmdiOiAje2NvbG9yLXRvLXJnYi1saXN0KCRjb250cmFzdCl9O1xuICAgIC0taW9uLWNvbG9yLSN7JGNvbG9yLW5hbWV9LXNoYWRlOiAjeyRzaGFkZX07XG4gICAgLS1pb24tY29sb3ItI3skY29sb3ItbmFtZX0tdGludDogI3skdGludH07XG5cbiAgICAuaW9uLWNvbG9yLSN7JGNvbG9yLW5hbWV9IHtcbiAgICAgICAgLS1pb24tY29sb3I6IHZhcigtLWlvbi1jb2xvci0jeyRjb2xvci1uYW1lfSk7XG4gICAgICAgIC0taW9uLWNvbG9yLWJhc2U6IHZhcigtLWlvbi1jb2xvci0jeyRjb2xvci1uYW1lfS1iYXNlKTtcbiAgICAgICAgLS1pb24tY29sb3ItcmdiOiB2YXIoLS1pb24tY29sb3ItI3skY29sb3ItbmFtZX0tcmdiKTtcbiAgICAgICAgLS1pb24tY29sb3ItY29udHJhc3Q6IHZhcigtLWlvbi1jb2xvci0jeyRjb2xvci1uYW1lfS1jb250cmFzdCk7XG4gICAgICAgIC0taW9uLWNvbG9yLWNvbnRyYXN0LXJnYjogdmFyKC0taW9uLWNvbG9yLSN7JGNvbG9yLW5hbWV9LWNvbnRyYXN0LXJnYik7XG4gICAgICAgIC0taW9uLWNvbG9yLXNoYWRlOiB2YXIoLS1pb24tY29sb3ItI3skY29sb3ItbmFtZX0tc2hhZGUpO1xuICAgICAgICAtLWlvbi1jb2xvci10aW50OiB2YXIoLS1pb24tY29sb3ItI3skY29sb3ItbmFtZX0tdGludCk7XG4gICAgfVxufVxuXG5AbWl4aW4gY29yZS1mb2N1cygpIHtcbiAgICBvdXRsaW5lOiBub25lO1xuICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgICAmOjphZnRlciB7XG4gICAgICAgIEBpbmNsdWRlIHBvc2l0aW9uKDAsIDAsIDAsIDApO1xuICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICAgIGNvbnRlbnQ6IFwiXCI7XG4gICAgICAgIG9wYWNpdHk6IDE7XG4gICAgICAgIHotaW5kZXg6IDE7XG4gICAgICAgIEBpbmNsdWRlIGNvcmUtZm9jdXMtc3R5bGUoKTtcbiAgICB9XG59XG5cbkBtaXhpbiBjb3JlLWZvY3VzLXN0eWxlKCkge1xuICAgIGJveC1zaGFkb3c6IGluc2V0IDAgMCB2YXIoLS1hMTF5LWZvY3VzLXdpZHRoKSAxcHggdmFyKC0tYTExeS1mb2N1cy1jb2xvcik7XG4gICAgYm9yZGVyLXJhZGl1czogdmFyKC0tYm9yZGVyLXJhZGl1cyk7XG4gICAgLy8gVGhpY2tlciBvcHRpb246XG4gICAgLy8gYm9yZGVyOiB2YXIoLS1hMTF5LWZvY3VzLXdpZHRoKSBzb2xpZCB2YXIoLS1hMTF5LWZvY3VzLWNvbG9yKTtcbn1cblxuQG1peGluIGNvcmUtdHJhbnNpdGlvbigkcHJvcGVydGllczogYWxsLCAkZHVyYXRpb246IDUwMG1zLCAkdGltaW5nLWZ1bmN0aW9uOiBlYXNlLWluLW91dCkge1xuICAgICR0cmFuc2l0aW9uczogKCk7XG4gICAgQGVhY2ggJHByb3BlcnR5IGluICRwcm9wZXJ0aWVzIHtcbiAgICAgICR0cmFuc2l0aW9uczogYXBwZW5kKCR0cmFuc2l0aW9ucywgJHByb3BlcnR5ICRkdXJhdGlvbiAkdGltaW5nLWZ1bmN0aW9uLCBjb21tYSk7XG4gICAgfVxuXG4gICAgLXdlYmtpdC10cmFuc2l0aW9uOiAkdHJhbnNpdGlvbnM7XG4gICAgdHJhbnNpdGlvbjogJHRyYW5zaXRpb25zO1xufVxuXG5AbWl4aW4gc3Itb25seSgpIHtcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgd2lkdGg6IDFweDtcbiAgICBoZWlnaHQ6IDFweDtcbiAgICBwYWRkaW5nOiAwO1xuICAgIG1hcmdpbjogLTFweDtcbiAgICBvdmVyZmxvdzogaGlkZGVuO1xuICAgIGNsaXA6IHJlY3QoMCwgMCwgMCwgMCk7XG4gICAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcbiAgICBib3JkZXI6IDA7XG59XG5cbi8qKlxuICogU2FtZSBhcyBpdGVtLXB1c2gtc3ZnLXVybCBidXQgYWRtaXRzIGZsaXAtcnRsXG4gKi9cbkBtaXhpbiBwdXNoLWFycm93LWNvbG9yKCRmaWxsOiA2MjYyNjIsICRmbGlwLXJ0bDogZmFsc2UpIHtcbiAgICAkaXRlbS1kZXRhaWwtcHVzaC1zdmc6IFwiPHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHZpZXdCb3g9JzAgMCAxMiAyMCc+PHBhdGggZD0nTTIsMjBsLTItMmw4LThMMCwybDItMmwxMCwxMEwyLDIweicgZmlsbD0nI3skZmlsbH0nLz48L3N2Zz5cIjtcblxuICAgIEBpbmNsdWRlIHN2Zy1iYWNrZ3JvdW5kLWltYWdlKCRpdGVtLWRldGFpbC1wdXNoLXN2ZywgJGZsaXAtcnRsKTtcbn1cblxuQG1peGluIGJvcmRlci1zdGFydCgkcHgsICR0eXBlOiBudWxsLCAkY29sb3I6IG51bGwpIHtcbiAgICBAaW5jbHVkZSBwcm9wZXJ0eS1ob3Jpem9udGFsKGJvcmRlciwgJHB4ICR0eXBlICRjb2xvciwgbnVsbCk7XG59XG5cbkBtaXhpbiBib3JkZXItZW5kKCRweCwgJHR5cGU6IG51bGwsICRjb2xvcjogbnVsbCkge1xuICAgIEBpbmNsdWRlIHByb3BlcnR5LWhvcml6b250YWwoYm9yZGVyLCBudWxsLCAkcHggJHR5cGUgJGNvbG9yKTtcbn1cblxuQG1peGluIHNhZmUtYXJlYS1ib3JkZXItc3RhcnQoJHB4LCAkdHlwZSwgJGNvbG9yKSB7XG4gICAgJHNhZmUtYXJlYS1wb3NpdGlvbjogY2FsYyh2YXIoLS1pb24tc2FmZS1hcmVhLWxlZnQpICsgI3skcHh9KTtcblxuICAgIEBpbmNsdWRlIGJvcmRlci1zdGFydCgkc2FmZS1hcmVhLXBvc2l0aW9uLCAkdHlwZSwgJGNvbG9yKTtcbn1cblxuQG1peGluIHNhZmUtYXJlYS1ib3JkZXItZW5kKCRweCwgJHR5cGUsICRjb2xvcikge1xuICAgICRzYWZlLWFyZWEtcG9zaXRpb246IGNhbGModmFyKC0taW9uLXNhZmUtYXJlYS1yaWdodCkgKyAjeyRweH0pO1xuXG4gICAgQGluY2x1ZGUgYm9yZGVyLWVuZCgkc2FmZS1hcmVhLXBvc2l0aW9uLCAkdHlwZSwgJGNvbG9yKTtcbn1cblxuQG1peGluIHNhZmUtYXJlYS1tYXJnaW4taG9yaXpvbnRhbCgkc3RhcnQsICRlbmQ6ICRzdGFydCkge1xuICAgICRzYWZlLWFyZWEtZW5kOiBudWxsO1xuICAgICRzYWZlLWFyZWEtc3RhcnQ6IG51bGw7XG5cbiAgICBAaWYgKCRlbmQpIHtcbiAgICAgICAgJHNhZmUtYXJlYS1lbmQ6IGNhbGModmFyKC0taW9uLXNhZmUtYXJlYS1yaWdodCkgKyAjeyRlbmR9KTtcbiAgICB9XG4gICAgQGlmICgkc3RhcnQpIHtcbiAgICAgICAgJHNhZmUtYXJlYS1zdGFydDogY2FsYyh2YXIoLS1pb24tc2FmZS1hcmVhLWxlZnQpICsgI3skc3RhcnR9KTtcbiAgICB9XG5cbiAgICBAaW5jbHVkZSBtYXJnaW4taG9yaXpvbnRhbCgkc2FmZS1hcmVhLXN0YXJ0LCAkc2FmZS1hcmVhLWVuZCk7XG59XG5cbkBtaXhpbiBzYWZlLWFyZWEtbWFyZ2luLXN0YXJ0KCRzdGFydCwgJGVuZCkge1xuICAgICRzYWZlLWFyZWEtc3RhcnQ6IGNhbGModmFyKC0taW9uLXNhZmUtYXJlYS1sZWZ0KSArICN7JHN0YXJ0fSk7XG5cbiAgICBAaW5jbHVkZSBtYXJnaW4taG9yaXpvbnRhbCgkc2FmZS1hcmVhLXN0YXJ0LCAkZW5kKTtcbn1cblxuQG1peGluIHNhZmUtYXJlYS1tYXJnaW4tZW5kKCRzdGFydCwgJGVuZCkge1xuICAgICRzYWZlLWFyZWEtZW5kOiBjYWxjKHZhcigtLWlvbi1zYWZlLWFyZWEtcmlnaHQpICsgI3skZW5kfSk7XG5cbiAgICBAaW5jbHVkZSBtYXJnaW4taG9yaXpvbnRhbCgkc3RhcnQsICRzYWZlLWFyZWEtZW5kKTtcbn1cblxuQG1peGluIHNhZmUtYXJlYS1wYWRkaW5nLWhvcml6b250YWwoJHN0YXJ0LCAkZW5kOiAkc3RhcnQpIHtcbiAgICAkc2FmZS1hcmVhLWVuZDogbnVsbDtcbiAgICAkc2FmZS1hcmVhLXN0YXJ0OiBudWxsO1xuXG4gICAgQGlmICgkZW5kKSB7XG4gICAgICAgICRzYWZlLWFyZWEtZW5kOiBjYWxjKHZhcigtLWlvbi1zYWZlLWFyZWEtcmlnaHQpICsgI3skZW5kfSk7XG4gICAgfVxuICAgIEBpZiAoJHN0YXJ0KSB7XG4gICAgICAgICRzYWZlLWFyZWEtc3RhcnQ6IGNhbGModmFyKC0taW9uLXNhZmUtYXJlYS1sZWZ0KSArICN7JHN0YXJ0fSk7XG4gICAgfVxuXG4gICAgQGluY2x1ZGUgcGFkZGluZy1ob3Jpem9udGFsKCRzYWZlLWFyZWEtc3RhcnQsICRzYWZlLWFyZWEtZW5kKTtcbn1cblxuQG1peGluIHNhZmUtYXJlYS1wYWRkaW5nLXN0YXJ0KCRzdGFydCwgJGVuZCkge1xuICAgICRzYWZlLWFyZWEtc3RhcnQ6IGNhbGModmFyKC0taW9uLXNhZmUtYXJlYS1sZWZ0KSArICN7JHN0YXJ0fSk7XG5cbiAgICBAaW5jbHVkZSBwYWRkaW5nLWhvcml6b250YWwoJHNhZmUtYXJlYS1zdGFydCwgJGVuZCk7XG59XG5cbkBtaXhpbiBzYWZlLWFyZWEtcGFkZGluZy1lbmQoJHN0YXJ0LCAkZW5kKSB7XG4gICAgJHNhZmUtYXJlYS1lbmQ6IGNhbGModmFyKC0taW9uLXNhZmUtYXJlYS1yaWdodCkgKyAjeyRlbmR9KTtcblxuICAgIEBpbmNsdWRlIHBhZGRpbmctaG9yaXpvbnRhbCgkc3RhcnQsICRzYWZlLWFyZWEtZW5kKTtcbn1cblxuQG1peGluIHNhZmUtYXJlYS1wb3NpdGlvbigkdG9wOiBudWxsLCAkZW5kOiBudWxsLCAkYm90dG9tOiBudWxsLCAkc3RhcnQ6IG51bGwpIHtcbiAgICAkc2FmZS1hcmVhLXN0YXJ0OiBjYWxjKHZhcigtLWlvbi1zYWZlLWFyZWEtbGVmdCkgKyAjeyRzdGFydH0pO1xuICAgICRzYWZlLWFyZWEtZW5kOiBjYWxjKHZhcigtLWlvbi1zYWZlLWFyZWEtcmlnaHQpICsgI3skZW5kfSk7XG5cbiAgICBAaW5jbHVkZSBwb3NpdGlvbigkdG9wLCAkc2FmZS1hcmVhLWVuZCwgJGJvdHRvbSwgJHNhZmUtYXJlYS1zdGFydCk7XG59XG5cbkBtaXhpbiBjb3JlLWhlYWRpbmdzKCkge1xuICAgIGgxIHtcbiAgICAgICAgZm9udC1zaXplOiAyNnB4O1xuICAgIH1cbiAgICBoMiwgLml0ZW0taGVhZGluZyB7XG4gICAgICAgIGZvbnQtc2l6ZTogMjRweDtcbiAgICB9XG4gICAgaDMge1xuICAgICAgICBmb250LXNpemU6IDIycHg7XG4gICAgfVxuICAgIGg0IHtcbiAgICAgICAgZm9udC1zaXplOiAyMHB4O1xuICAgIH1cbiAgICBoNSB7XG4gICAgICAgIGZvbnQtc2l6ZTogMThweDtcbiAgICB9XG4gICAgaDYge1xuICAgICAgICBmb250LXNpemU6IDE2cHg7XG4gICAgfVxufVxuXG5AbWl4aW4gZGFya21vZGUoKSB7XG4gICAgJHJvb3Q6ICN7Jn07XG5cbiAgICBAYXQtcm9vdCAje2FkZC1yb290LXNlbGVjdG9yKCRyb290LCBcImh0bWwuZGFya1wiKX0ge1xuICAgICAgICBAY29udGVudDtcbiAgICB9XG59XG5cbkBtaXhpbiBob3Jpem9udGFsX3Njcm9sbF9pdGVtKCR3aWR0aCwgJG1pbi13aWR0aCwgJG1heC13aWR0aCkge1xuICAgIGZsZXg6IDAgMCAkd2lkdGg7XG4gICAgbWluLXdpZHRoOiAkbWluLXdpZHRoO1xuICAgIG1heC13aWR0aDogJG1heC13aWR0aDtcbiAgICBhbGlnbi1zZWxmOiBzdHJldGNoO1xuICAgIGRpc3BsYXk6IGJsb2NrO1xuXG4gICAgaW9uLWNhcmQge1xuICAgICAgICAtLXZlcnRpY2FsLW1hcmdpbjogMTBweDtcbiAgICAgICAgLS1ob3Jpem9udGFsLW1hcmdpbjogMTBweDtcblxuICAgICAgICB3aWR0aDogY2FsYygxMDAlIC0gdmFyKC0taG9yaXpvbnRhbC1tYXJnaW4pIC0gdmFyKC0taG9yaXpvbnRhbC1tYXJnaW4pKTtcbiAgICAgICAgaGVpZ2h0OiBjYWxjKDEwMCUgLSB2YXIoLS12ZXJ0aWNhbC1tYXJnaW4pIC0gdmFyKC0tdmVydGljYWwtbWFyZ2luKSk7XG4gICAgICAgIG1hcmdpbjogdmFyKC0tdmVydGljYWwtbWFyZ2luKSB2YXIoLS1ob3Jpem9udGFsLW1hcmdpbik7XG5cbiAgICAgICAgQG1lZGlhIChtYXgtd2lkdGg6IDM2MHB4KSB7XG4gICAgICAgICAgICAtLWhvcml6b250YWwtbWFyZ2luOiA2cHg7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbi8vIENvbG9yIG1peGlucy5cbkBmdW5jdGlvbiBnZXRfYnJpZ2h0bmVzcygkY29sb3IpIHtcbiAgICBAcmV0dXJuIG1hdGguZGl2KHJlZCgkY29sb3IpICsgZ3JlZW4oJGNvbG9yKSArIGJsdWUoJGNvbG9yKSwgMyk7XG59XG5cbi8vIEdldCB0aGUgYmV0dGVyIGNvbG9yIGNvbnRyYXN0IHVzaW5nIFdDQUcgYWxnb3J5dGhtLlxuQGZ1bmN0aW9uIGdldF9jb250cmFzdF9jb2xvcigkY29sb3IpIHtcbiAgICAkbHVtaWFuY2U6IGx1bWluYW5jZSgkY29sb3IpO1xuXG4gICAgLy8gV2hpdGUgbHVtaWFuY2UgaXMgMS5cbiAgICAkd2hpdGVDb250cmFzdDogbWF0aC5kaXYoJGx1bWlhbmNlICsgMC4wNSwgMSArIDAuMDUpO1xuICAgIC8vIFdoaXRlIGx1bWlhbmNlIGlzIDAuXG4gICAgJGJsYWNrQ29udHJhc3Q6IG1hdGguZGl2KDAuMDUsICRsdW1pYW5jZSArIDAuMDUpO1xuXG4gICAgQHJldHVybiBpZigkd2hpdGVDb250cmFzdCA8ICRibGFja0NvbnRyYXN0LCB3aGl0ZSwgYmxhY2spO1xufVxuXG4vLyBDb2xvciBjb250cmFzdCB1c2luZyB5aXEgYXByb3hpbWF0aW9uIHdpdGggMTUwIHRocmVzaG9sZC5cbkBmdW5jdGlvbiBnZXRfY29udHJhc3RfY29sb3JfeWlxKCRjb2xvciwgJGRhcms6IGJsYWNrLCAkbGlnaHQ6IHdoaXRlKSB7XG4gICAgJHI6IHJlZCgkY29sb3IpO1xuICAgICRnOiBncmVlbigkY29sb3IpO1xuICAgICRiOiBibHVlKCRjb2xvcik7XG5cbiAgICAkeWlxOiBtYXRoLmRpdigoJHIgKiAyOTkpICsgKCRnICogNTg3KSArICgkYiAqIDExNCksIDEwMDApO1xuXG4gICAgQHJldHVybiBpZigkeWlxID49IDEyOCwgJGRhcmssICRsaWdodCk7XG59XG5cbi8vIFdDQUcgY29udHJhc3QgYWxnb3JpdGhtXG5AZnVuY3Rpb24gY2hlY2stY29udHJhc3QoJGZvcmVncm91bmQsICRiYWNrZ3JvdW5kKSB7XG4gICAgJGZvcmVncm91bmRMdW1pYW5jZTogbHVtaW5hbmNlKCRmb3JlZ3JvdW5kKTtcbiAgICAkYmFja2dyb3VuZEx1bWluYW5jZTogbHVtaW5hbmNlKCRiYWNrZ3JvdW5kKTtcblxuICAgIEBpZiAoJGJhY2tncm91bmRMdW1pbmFuY2UgPCAkZm9yZWdyb3VuZEx1bWlhbmNlKSB7XG4gICAgICAgIEByZXR1cm4gbWF0aC5kaXYoJGJhY2tncm91bmRMdW1pbmFuY2UgKyAwLjA1LCAkZm9yZWdyb3VuZEx1bWlhbmNlICsgMC4wNSk7XG4gICAgfSBAZWxzZSB7XG4gICAgICAgIEByZXR1cm4gbWF0aC5kaXYoJGZvcmVncm91bmRMdW1pYW5jZSArIDAuMDUsICRiYWNrZ3JvdW5kTHVtaW5hbmNlICsgMC4wNSk7XG4gICAgfVxufVxuXG5AZnVuY3Rpb24gbHVtaW5hbmNlKCRjb2xvcikge1xuICAgICRyOiByZWQoJGNvbG9yKTtcbiAgICAkZzogZ3JlZW4oJGNvbG9yKTtcbiAgICAkYjogYmx1ZSgkY29sb3IpO1xuXG4gICAgJHI6IGNvbXBvbmVudC1sdW1pbmFuY2UoJHIpO1xuICAgICRnOiBjb21wb25lbnQtbHVtaW5hbmNlKCRnKTtcbiAgICAkYjogY29tcG9uZW50LWx1bWluYW5jZSgkYik7XG5cbiAgICBAcmV0dXJuICRyICogMC4yMTI2ICsgJGcgKiAwLjcxNTIgKyAkYiAqIDAuMDcyMjtcbn1cblxuQGZ1bmN0aW9uIGNvbXBvbmVudC1sdW1pbmFuY2UoJHZhbHVlKSB7XG4gICAgJHZhbHVlOiBtYXRoLmRpdigkdmFsdWUsIDI1NSk7XG5cbiAgICBAaWYgKCR2YWx1ZSA8PSAwLjAzOTI4KSB7XG4gICAgICAgIEByZXR1cm4gbWF0aC5kaXYoJHZhbHVlLCAxMi45Mik7XG4gICAgfSBAZWxzZSB7XG4gICAgICAgIEByZXR1cm4gbWF0aC5wb3cobWF0aC5kaXYoJHZhbHVlICsgMC4wNTUsIDEuMDU1KSwgMi40KTtcbiAgICB9XG59XG4iLCIvKlxuICogQXBwIEN1c3RvbSBBcHAgdmFyaWFibGVzIFNDU1NcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqIFBsYWNlIGhlcmUgYWxsIGN1c3RvbSBhcHAgdmFyaWFibGVzLlxuICovXG4iLCIvKlxuICogQXBwIEdsb2JhbCB2YXJpYWJsZXMgU0NTU1xuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogUGxhY2UgaGVyZSBhbGwgZ2xvYmFsIHZhcmlhYmxlcy5cbiAqL1xuXG4kd2hpdGU6ICAgICAgICNmZmZmZmYgIWRlZmF1bHQ7XG4kZ3JheS0xMDA6ICAgICNmOGY5ZmEgIWRlZmF1bHQ7XG4kZ3JheS0yMDA6ICAgICNlOWVjZWYgIWRlZmF1bHQ7XG4kZ3JheS0zMDA6ICAgICNkZWUyZTYgIWRlZmF1bHQ7IC8vIFN0cm9rZVxuJGdyYXktNDAwOiAgICAjY2VkNGRhICFkZWZhdWx0O1xuJGdyYXktNTAwOiAgICAjOGY5NTllICFkZWZhdWx0OyAvLyBTdHJva2Ugb24gaW5wdXRzXG4kZ3JheS02MDA6ICAgICM2YTczN2IgIWRlZmF1bHQ7XG4kZ3JheS03MDA6ICAgICM0OTUwNTcgIWRlZmF1bHQ7XG4kZ3JheS04MDA6ICAgICMzNDNhNDAgIWRlZmF1bHQ7XG4kZ3JheS05MDA6ICAgICMyODI4MjggIWRlZmF1bHQ7IC8vIENvcHkgdGV4dFxuJGJsYWNrOiAgICAgICAjMDAwMDAwICFkZWZhdWx0OyAvLyBBdm9pZCB1c2FnZVxuXG4kYmx1ZTogICAgICAgICMwZjZjYmYgIWRlZmF1bHQ7XG4kY3lhbjogICAgICAgICMwMDgxOTYgIWRlZmF1bHQ7IC8vIE5vdCB1c2VkLlxuJGdyZWVuOiAgICAgICAjMzU3YTMyICFkZWZhdWx0O1xuJHJlZDogICAgICAgICAjY2EzMTIwICFkZWZhdWx0O1xuJHllbGxvdzogICAgICAjZjBhZDRlICFkZWZhdWx0O1xuXG4kYnJhbmQtY29sb3I6ICNmOTgwMTIgIWRlZmF1bHQ7XG5cbiR0ZXh0LWNvbG9yOiAgICAgICAgICAgICAgICRncmF5LTkwMCAhZGVmYXVsdDtcbiR0ZXh0LWNvbG9yLXJnYjogICAgICAgICAgIGNvbG9yLXRvLXJnYi1saXN0KCR0ZXh0LWNvbG9yKSAhZGVmYXVsdDtcbiR0ZXh0LWNvbG9yLWRhcms6ICAgICAgICAgICR3aGl0ZSAhZGVmYXVsdDtcbiR0ZXh0LWNvbG9yLWRhcmstcmdiOiAgICAgIGNvbG9yLXRvLXJnYi1saXN0KCR0ZXh0LWNvbG9yLWRhcmspICFkZWZhdWx0O1xuXG4kYmFja2dyb3VuZC1jb2xvcjogICAgICAgICAgJHdoaXRlICFkZWZhdWx0O1xuJGJhY2tncm91bmQtY29sb3ItcmdiOiAgICAgIGNvbG9yLXRvLXJnYi1saXN0KCRiYWNrZ3JvdW5kLWNvbG9yKSAhZGVmYXVsdDtcbiRiYWNrZ3JvdW5kLWNvbG9yLWRhcms6ICAgICAkZ3JheS05MDAgIWRlZmF1bHQ7IC8vICMxYTFhMWFcbiRiYWNrZ3JvdW5kLWNvbG9yLWRhcmstcmdiOiBjb2xvci10by1yZ2ItbGlzdCgkYmFja2dyb3VuZC1jb2xvci1kYXJrKSAhZGVmYXVsdDtcblxuJGlvbi1pdGVtLWJhY2tncm91bmQ6ICAgICAgJHdoaXRlICFkZWZhdWx0O1xuJGlvbi1pdGVtLWJhY2tncm91bmQtcmdiOiAgY29sb3ItdG8tcmdiLWxpc3QoJGlvbi1pdGVtLWJhY2tncm91bmQpICFkZWZhdWx0O1xuJGlvbi1pdGVtLWJhY2tncm91bmQtZGFyazogJGdyYXktOTAwICFkZWZhdWx0O1xuJGlvbi1pdGVtLWJhY2tncm91bmQtZGFyay1yZ2I6IGNvbG9yLXRvLXJnYi1saXN0KCRpb24taXRlbS1iYWNrZ3JvdW5kLWRhcmspICFkZWZhdWx0O1xuXG4kcHJpbWFyeTogICAgJGJyYW5kLWNvbG9yICFkZWZhdWx0O1xuJHNlY29uZGFyeTogICRncmF5LTMwMCAhZGVmYXVsdDtcbiRkYW5nZXI6ICAgICAkcmVkICFkZWZhdWx0O1xuJHdhcm5pbmc6ICAgICR5ZWxsb3cgIWRlZmF1bHQ7XG4kc3VjY2VzczogICAgJGdyZWVuICFkZWZhdWx0O1xuJGluZm86ICAgICAgICRibHVlICFkZWZhdWx0O1xuJGxpZ2h0OiAgICAgICRncmF5LTEwMCAhZGVmYXVsdDtcbiRtZWRpdW06ICAgICAkZ3JheS03MDAgIWRlZmF1bHQ7XG4kZGFyazogICAgICAgJGdyYXktOTAwICFkZWZhdWx0O1xuXG4kY29sb3JzOiAgKFxuICAgIHByaW1hcnk6IChsaWdodDogJHByaW1hcnksIGRhcms6ICRwcmltYXJ5KSxcbiAgICBzZWNvbmRhcnk6IChsaWdodDogJHNlY29uZGFyeSwgZGFyazogJGdyYXktNzAwKSxcbiAgICBzdWNjZXNzOiAobGlnaHQ6ICRzdWNjZXNzKSxcbiAgICB3YXJuaW5nOiAobGlnaHQ6ICR3YXJuaW5nKSxcbiAgICBkYW5nZXI6ICAobGlnaHQ6ICRkYW5nZXIpLFxuICAgIGluZm86IChsaWdodDogJGluZm8pLFxuICAgIGxpZ2h0OiAobGlnaHQ6ICRsaWdodCwgZGFyazogJGRhcmspLFxuICAgIG1lZGl1bTogKGxpZ2h0OiAkbWVkaXVtLCBkYXJrOiAkZ3JheS0yMDApLFxuICAgIGRhcms6IChsaWdodDogJGRhcmssIGRhcms6ICRsaWdodCksXG4pICFkZWZhdWx0O1xuXG4vKipcbiAqIExheW91dCBCcmVha3BvaW50c1xuICpcbiAqIGh0dHBzOi8vaW9uaWNmcmFtZXdvcmsuY29tL2RvY3MvbGF5b3V0L2dyaWQjZGVmYXVsdC1icmVha3BvaW50c1xuICovXG5cbi8vIFRoZSBtaW5pbXVtIGRpbWVuc2lvbnMgYXQgd2hpY2ggeW91ciBsYXlvdXQgd2lsbCBjaGFuZ2UsXG4vLyBhZGFwdGluZyB0byBkaWZmZXJlbnQgc2NyZWVuIHNpemVzLCBmb3IgdXNlIGluIG1lZGlhIHF1ZXJpZXNcbiRzY3JlZW4tYnJlYWtwb2ludHM6IChcbiAgICB4czogMHB4LFxuICAgIHNtOiA1NzZweCxcbiAgICBtZDogNzY4cHgsXG4gICAgbGc6IDk5MnB4LFxuICAgIHRhYmxldDogOTkycHgsXG4gICAgeGw6IDEyMDBweFxuKSAhZGVmYXVsdDtcblxuJGNvcmUtY291cnNlLWltYWdlLWJhY2tncm91bmQ6ICM4MWVjZWMsICM3NGI5ZmYsICNhMjliZmUsICNkZmU2ZTksICMwMGI4OTQsICMwOTg0ZTMsICNiMmJlYzMsICNmZGNiNmUsICNmZDc5YTgsICM2YzVjZTcgIWRlZmF1bHQ7XG4kY29yZS1kZC1xdWVzdGlvbi1jb2xvcnM6ICNGRkZGRkYsICNCMEM0REUsICNEQ0RDREMsICNEOEJGRDgsICM4N0NFRkEsICNEQUE1MjAsICNGRkQ3MDAsICNGMEU2OEMgIWRlZmF1bHQ7XG4kY29yZS10ZXh0LWhpZ2h0bGlnaHQtYmFja2dyb3VuZC1jb2xvcjogbGlnaHRlbigkYmx1ZSwgNDAlKSAhZGVmYXVsdDtcblxuJGNvcmUtZml4ZWQtdXJsOiBmYWxzZSAhZGVmYXVsdDtcbiRjb3JlLWRhc2hib2FyZC1sb2dvOiBmYWxzZSAhZGVmYXVsdDtcbiRjb3JlLWFsd2F5cy1zaG93LW1haW4tbWVudTogZmFsc2UgIWRlZmF1bHQ7XG4kY29yZS1mb3JtYXQtdGV4dC1uZXZlci1zaG9ydGVuOiBmYWxzZSAhZGVmYXVsdDtcblxuJGNvcmUtaGlkZS1jb3Vyc2VpbWFnZS1vbi1jb3Vyc2U6IGZhbHNlICFkZWZhdWx0O1xuJGNvcmUtaGlkZS1wcm9ncmVzcy1vbi1jb3Vyc2U6IGZhbHNlICFkZWZhdWx0O1xuJGNvcmUtaGlkZS1wcm9ncmVzcy1vbi1zZWN0aW9uLXNlbGVjdG9yOiBmYWxzZSAhZGVmYXVsdDtcblxuJGNvcmUtY291cnNlLWhpZGUtdGh1bWItb24tY2FyZHM6IGZhbHNlICFkZWZhdWx0O1xuJGNvcmUtY291cnNlLXRodW1iLW9uLWNhcmRzLWJhY2tncm91bmQ6IG51bGwgIWRlZmF1bHQ7XG4kY29yZS1jb3Vyc2UtaGlkZS1wcm9ncmVzcy1vbi1jYXJkczogZmFsc2UgIWRlZmF1bHQ7XG5cbi8vIENvbmZpZ3VyYXRpb24gb3B0aW9ucyBmb3IgbG9naW4gcGFnZS5cbiRjb3JlLWxvZ2luLWJ1dHRvbi1vdXRsaW5lOiBmYWxzZSAhZGVmYXVsdDtcbiRjb3JlLWxvZ2luLWJ1dHRvbi1vdXRsaW5lLWRhcms6ICRjb3JlLWxvZ2luLWJ1dHRvbi1vdXRsaW5lICFkZWZhdWx0O1xuJGNvcmUtbG9naW4tbG9hZGluZy1jb2xvcjogZmFsc2UgIWRlZmF1bHQ7XG4kY29yZS1sb2dpbi1sb2FkaW5nLWNvbG9yLWRhcms6ICR0ZXh0LWNvbG9yLWRhcmsgIWRlZmF1bHQ7XG4kY29yZS1sb2dpbi1oaWRlLWZvcmdvdC1wYXNzd29yZDogZmFsc2UgIWRlZmF1bHQ7XG4kY29yZS1sb2dpbi1oaWRlLW5lZWQtaGVscDogZmFsc2UgIWRlZmF1bHQ7XG4kY29yZS1sb2dpbi1oaWRlLXFyY29kZTogZmFsc2UgIWRlZmF1bHQ7XG5cbi8vIENvbmZpZ3VyYXRpb24gb3B0aW9ucyBmb3IgbW9yZSBwYWdlLiAoZGVwcmVjYXRlZCBvbiA0LjApXG4kY29yZS1tb3JlLWhpZGUtc2l0ZWluZm86IGZhbHNlICFkZWZhdWx0O1xuJGNvcmUtbW9yZS1oaWRlLXNpdGVuYW1lOiBmYWxzZSAhZGVmYXVsdDtcbiRjb3JlLW1vcmUtaGlkZS1zaXRldXJsOiBmYWxzZSAhZGVmYXVsdDtcblxuLy8gQ29uZmlndXJhdGlvbiBvcHRpb25zIGZvciB1c2VyIHBhZ2UuXG4kY29yZS11c2VyLWhpZGUtc2l0ZWluZm86ICRjb3JlLW1vcmUtaGlkZS1zaXRlaW5mbyAhZGVmYXVsdDtcbiRjb3JlLXVzZXItaGlkZS1zaXRlbmFtZTogJGNvcmUtbW9yZS1oaWRlLXNpdGVuYW1lICFkZWZhdWx0O1xuJGNvcmUtdXNlci1oaWRlLXNpdGV1cmw6ICRjb3JlLW1vcmUtaGlkZS1zaXRldXJsICFkZWZhdWx0O1xuXG4vLyBBY3Rpdml0eSBpY29uIGJhY2tncm91bmQgY29sb3JzLlxuJGFjdGl2aXR5LWljb24tY29sb3JzOiAoXG4gICAgYWRtaW5pc3RyYXRpb246ICM1ZDYzZjYsXG4gICAgYXNzZXNzbWVudDogI2ViNjZhMixcbiAgICBjb2xsYWJvcmF0aW9uOiAjZjc2MzRkLFxuICAgIGNvbW11bmljYXRpb246ICMxMWE2NzYsXG4gICAgY29udGVudDogIzM5OWJlMixcbiAgICBpbnRlcmZhY2U6ICNhMzc4ZmZcbikgIWRlZmF1bHQ7XG5cbiRjYWxlbmRhci1ldmVudC1jYXRlZ29yeS1jYXRlZ29yeTogIzhlMjRhYSAhZGVmYXVsdDtcbiRjYWxlbmRhci1ldmVudC1jYXRlZ29yeS1jb3Vyc2U6ICRyZWQgIWRlZmF1bHQ7XG4kY2FsZW5kYXItZXZlbnQtY2F0ZWdvcnktZ3JvdXA6ICR5ZWxsb3cgIWRlZmF1bHQ7XG4kY2FsZW5kYXItZXZlbnQtY2F0ZWdvcnktdXNlcjogJGJsdWUgIWRlZmF1bHQ7XG4kY2FsZW5kYXItZXZlbnQtY2F0ZWdvcnktc2l0ZTogJGdyZWVuICFkZWZhdWx0O1xuXG4vLyBDYWxlbmRhciBldmVudCBjYXRlZ29yeSBiYWNrZ3JvdW5kIGNvbG9ycy5cbiRjYWxlbmRhci1ldmVudC1jYXRlZ29yeS1jb2xvcnM6IChcbiAgICBjYXRlZ29yeTogJGNhbGVuZGFyLWV2ZW50LWNhdGVnb3J5LWNhdGVnb3J5LFxuICAgIGNvdXJzZTogJGNhbGVuZGFyLWV2ZW50LWNhdGVnb3J5LWNvdXJzZSxcbiAgICBncm91cDogJGNhbGVuZGFyLWV2ZW50LWNhdGVnb3J5LWdyb3VwLFxuICAgIHVzZXI6ICRjYWxlbmRhci1ldmVudC1jYXRlZ29yeS11c2VyLFxuICAgIHNpdGU6ICRjYWxlbmRhci1ldmVudC1jYXRlZ29yeS1zaXRlLFxuKSAhZGVmYXVsdDtcbiIsIkB1c2UgXCJ0aGVtZS9nbG9iYWxzXCIgYXMgKjtcblxuOmhvc3Qge1xuXG4gICAgLS1hZGRvbi1jYWxlbmRhci1ibGFuay1kYXktYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tbGlnaHQpO1xuXG4gICAgLml0ZW0uYWRkb24tY2FsZW5kYXItZXZlbnQge1xuICAgICAgICA+IGlvbi1pY29uIHtcbiAgICAgICAgICAgIGNvbG9yOiB3aGl0ZTtcbiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDUwJTtcbiAgICAgICAgICAgIHBhZGRpbmc6IDAuN3JlbTtcbiAgICAgICAgICAgIC0tbWFyZ2luLXZlcnRpY2FsOiAxMnB4O1xuICAgICAgICAgICAgLS1tYXJnaW4tZW5kOiAxMnB4O1xuICAgICAgICAgICAgbWFyZ2luLXRvcDogdmFyKC0tbWFyZ2luLXZlcnRpY2FsKTtcbiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IHZhcigtLW1hcmdpbi12ZXJ0aWNhbCk7XG4gICAgICAgICAgICBAaW5jbHVkZSBtYXJnaW4taG9yaXpvbnRhbChudWxsLCB2YXIoLS1tYXJnaW4tZW5kKSk7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIEBlYWNoICRjYXRlZ29yeSwgJHZhbHVlIGluICRjYWxlbmRhci1ldmVudC1jYXRlZ29yeS1jb2xvcnMge1xuICAgICAgICAgICAgJi5hZGRvbi1jYWxlbmRhci1ldmVudHR5cGUtI3skY2F0ZWdvcnl9ID4gaW9uLWljb24ge1xuICAgICAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICR2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ== */\", \"[_nghost-%COMP%]   .core-swipe-slides-container[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%] {\\n  flex: none;\\n  width: 100%;\\n}\\n[_nghost-%COMP%]   .addon-calendar-period[_ngcontent-%COMP%] {\\n  flex-grow: 3;\\n}\\n[_nghost-%COMP%]   .addon-calendar-period[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%] {\\n  margin-top: 10px;\\n  font-size: 1.2rem;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hZGRvbnMvY2FsZW5kYXIvcGFnZXMvZGF5L2RheS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNJO0VBQ0ksVUFBQTtFQUNBLFdBQUE7QUFBUjtBQUdJO0VBQ0ksWUFBQTtBQURSO0FBRVE7RUFDSSxnQkFBQTtFQUNBLGlCQUFBO0FBQVoiLCJzb3VyY2VzQ29udGVudCI6WyI6aG9zdCB7XG4gICAgLmNvcmUtc3dpcGUtc2xpZGVzLWNvbnRhaW5lciBpb24tZ3JpZCB7XG4gICAgICAgIGZsZXg6IG5vbmU7XG4gICAgICAgIHdpZHRoOiAxMDAlO1xuICAgIH1cblxuICAgIC5hZGRvbi1jYWxlbmRhci1wZXJpb2Qge1xuICAgICAgICBmbGV4LWdyb3c6IDM7XG4gICAgICAgIGgyIHtcbiAgICAgICAgICAgIG1hcmdpbi10b3A6IDEwcHg7XG4gICAgICAgICAgICBmb250LXNpemU6IDEuMnJlbTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0= */\"]\n});\nclass AddonCalendarDaySlidesItemsManagerSource extends CoreSwipeSlidesDynamicItemsManagerSource {\n  constructor(page, initialMoment) {\n    super({\n      moment: initialMoment\n    });\n    this.courses = [];\n    this.eventsSources = new Set();\n    // Offline events classified in month & day.\n    this.offlineEvents = {};\n    this.offlineEditedEventsIds = []; // IDs of events edited in offline.\n    this.canCreate = false;\n    this.sendLog = true;\n    this.dayPage = page;\n  }\n  /**\n   * Fetch data.\n   *\n   * @param courseId Current selected course id (if any).\n   * @returns Promise resolved when done.\n   */\n  fetchData(courseId) {\n    var _this10 = this;\n    return _asyncToGenerator(function* () {\n      yield Promise.all([_this10.loadCourses(courseId), _this10.loadCanCreate(courseId), _this10.loadCategories(), _this10.loadOfflineEvents(), _this10.loadOfflineDeletedEvents(), _this10.loadTimeFormat()]);\n    })();\n  }\n  /**\n   * Filter all loaded days events based on the filter popover.\n   *\n   * @param filter Filter to apply.\n   */\n  filterAllDayEvents(filter) {\n    var _this$getItems;\n    (_this$getItems = this.getItems()) === null || _this$getItems === void 0 || _this$getItems.forEach(day => this.filterEvents(day, filter));\n  }\n  /**\n   * Filter events of a certain day based on the filter popover.\n   *\n   * @param day Day with the events.\n   * @param filter Filter to apply.\n   */\n  filterEvents(day, filter) {\n    day.filteredEvents = AddonCalendarHelper.getFilteredEvents(day.events || [], filter, this.categories || {});\n    this.rememberEventsList(day);\n  }\n  /**\n   * Load courses.\n   *\n   * @param courseId Current selected course id (if any).\n   * @returns Promise resolved when done.\n   */\n  loadCourses(courseId) {\n    var _this11 = this;\n    return _asyncToGenerator(function* () {\n      const data = yield CoreCoursesHelper.getCoursesForPopover(courseId);\n      _this11.courses = data.courses;\n    })();\n  }\n  /**\n   * Load whether user can create events.\n   *\n   * @param courseId Current selected course id (if any).\n   * @returns Promise resolved when done.\n   */\n  loadCanCreate(courseId) {\n    var _this12 = this;\n    return _asyncToGenerator(function* () {\n      _this12.canCreate = yield AddonCalendarHelper.canEditEvents(courseId);\n    })();\n  }\n  /**\n   * Load categories to be able to filter events.\n   *\n   * @returns Promise resolved when done.\n   */\n  loadCategories() {\n    var _this13 = this;\n    return _asyncToGenerator(function* () {\n      if (_this13.categories) {\n        // Already retrieved, stop.\n        return;\n      }\n      try {\n        const categories = yield CoreCourses.getCategories(0, true);\n        // Index categories by ID.\n        _this13.categories = CoreUtils.arrayToObject(categories, 'id');\n      } catch (_unused) {\n        // Ignore errors.\n      }\n    })();\n  }\n  /**\n   * Load events created or edited in offline.\n   *\n   * @returns Promise resolved when done.\n   */\n  loadOfflineEvents() {\n    var _this14 = this;\n    return _asyncToGenerator(function* () {\n      // Get offline events.\n      const events = yield AddonCalendarOffline.getAllEditedEvents();\n      // Classify them by month & day.\n      _this14.offlineEvents = AddonCalendarHelper.classifyIntoMonths(events);\n      // Get the IDs of events edited in offline.\n      _this14.offlineEditedEventsIds = events.filter(event => event.id > 0).map(event => event.id);\n    })();\n  }\n  /**\n   * Load events deleted in offline.\n   *\n   * @returns Promise resolved when done.\n   */\n  loadOfflineDeletedEvents() {\n    var _this15 = this;\n    return _asyncToGenerator(function* () {\n      const deletedEventsIds = yield AddonCalendarOffline.getAllDeletedEventsIds();\n      _this15.deletedEvents = new Set(deletedEventsIds);\n    })();\n  }\n  /**\n   * Load time format.\n   *\n   * @returns Promise resolved when done.\n   */\n  loadTimeFormat() {\n    var _this16 = this;\n    return _asyncToGenerator(function* () {\n      _this16.timeFormat = yield AddonCalendar.getCalendarTimeFormat();\n    })();\n  }\n  /**\n   * @inheritdoc\n   */\n  getItemId(item) {\n    return AddonCalendarHelper.getDayId(item.moment);\n  }\n  /**\n   * @inheritdoc\n   */\n  getPreviousItem(item) {\n    return {\n      moment: item.moment.clone().subtract(1, 'day')\n    };\n  }\n  /**\n   * @inheritdoc\n   */\n  getNextItem(item) {\n    return {\n      moment: item.moment.clone().add(1, 'day')\n    };\n  }\n  /**\n   * @inheritdoc\n   */\n  loadItemData(day, preload = false) {\n    var _this17 = this;\n    return _asyncToGenerator(function* () {\n      const preloadedDay = _objectSpread(_objectSpread({}, day), {}, {\n        hasOffline: false,\n        events: [],\n        onlineEvents: [],\n        filteredEvents: [],\n        isCurrentDay: day.moment.isSame(moment(), 'day'),\n        isPastDay: day.moment.isBefore(moment(), 'day')\n      });\n      if (preload) {\n        return preloadedDay;\n      }\n      let result;\n      try {\n        // Don't pass courseId and categoryId, we'll filter them locally.\n        result = yield AddonCalendar.getDayEvents(day.moment.year(), day.moment.month() + 1, day.moment.date());\n        preloadedDay.onlineEvents = yield Promise.all(result.events.map(event => AddonCalendarHelper.formatEventData(event)));\n      } catch (error) {\n        // Allow navigating to non-cached days in offline (behave as if using emergency cache).\n        if (CoreNetwork.isOnline()) {\n          throw error;\n        }\n      }\n      // Merge the online events with offline data.\n      preloadedDay.events = _this17.mergeEvents(preloadedDay);\n      // Filter events by course.\n      _this17.filterEvents(preloadedDay, _this17.dayPage.filter);\n      // Re-calculate the formatted time so it uses the device date.\n      const dayTime = day.moment.unix() * 1000;\n      const currentTime = CoreTimeUtils.timestamp();\n      const promises = preloadedDay.events.map( /*#__PURE__*/function () {\n        var _ref2 = _asyncToGenerator(function* (event) {\n          event.ispast = preloadedDay.isPastDay || preloadedDay.isCurrentDay && _this17.isEventPast(event, currentTime);\n          event.formattedtime = yield AddonCalendar.formatEventTime(event, _this17.dayPage.timeFormat, true, dayTime);\n        });\n        return function (_x2) {\n          return _ref2.apply(this, arguments);\n        };\n      }());\n      yield Promise.all(promises);\n      return preloadedDay;\n    })();\n  }\n  /**\n   * Returns if the event is in the past or not.\n   *\n   * @param event Event object.\n   * @param currentTime Current time.\n   * @returns True if it's in the past.\n   */\n  isEventPast(event, currentTime) {\n    return event.timestart + event.timeduration < currentTime;\n  }\n  /**\n   * Merge online events with the offline events of that period.\n   *\n   * @param day Day with the events.\n   * @returns Merged events.\n   */\n  mergeEvents(day) {\n    var _this$deletedEvents, _this$deletedEvents2;\n    day.hasOffline = false;\n    if (!Object.keys(this.offlineEvents).length && !((_this$deletedEvents = this.deletedEvents) !== null && _this$deletedEvents !== void 0 && _this$deletedEvents.size)) {\n      // No offline events, nothing to merge.\n      return day.onlineEvents || [];\n    }\n    const monthOfflineEvents = this.offlineEvents[AddonCalendarHelper.getMonthId(day.moment)];\n    const dayOfflineEvents = monthOfflineEvents && monthOfflineEvents[day.moment.date()];\n    let result = day.onlineEvents || [];\n    if ((_this$deletedEvents2 = this.deletedEvents) !== null && _this$deletedEvents2 !== void 0 && _this$deletedEvents2.size) {\n      // Mark as deleted the events that were deleted in offline.\n      result.forEach(event => {\n        var _this$deletedEvents3;\n        event.deleted = (_this$deletedEvents3 = this.deletedEvents) === null || _this$deletedEvents3 === void 0 ? void 0 : _this$deletedEvents3.has(event.id);\n        if (event.deleted) {\n          day.hasOffline = true;\n        }\n      });\n    }\n    if (this.offlineEditedEventsIds.length) {\n      var _day$onlineEvents;\n      // Remove the online events that were modified in offline.\n      result = result.filter(event => this.offlineEditedEventsIds.indexOf(event.id) == -1);\n      if (result.length != ((_day$onlineEvents = day.onlineEvents) === null || _day$onlineEvents === void 0 ? void 0 : _day$onlineEvents.length)) {\n        day.hasOffline = true;\n      }\n    }\n    if (dayOfflineEvents && dayOfflineEvents.length) {\n      // Add the offline events (either new or edited).\n      day.hasOffline = true;\n      result = AddonCalendarHelper.sortEvents(result.concat(dayOfflineEvents));\n    }\n    return result;\n  }\n  /**\n   * Invalidate content.\n   *\n   * @param selectedDay The current selected day.\n   * @param invalidateDayEvents Whether to invalidate selected day events.\n   * @returns Promise resolved when done.\n   */\n  invalidateContent(selectedDay, invalidateDayEvents) {\n    var _this18 = this;\n    return _asyncToGenerator(function* () {\n      const promises = [];\n      if (invalidateDayEvents && selectedDay) {\n        promises.push(AddonCalendar.invalidateDayEvents(selectedDay.moment.year(), selectedDay.moment.month() + 1, selectedDay.moment.date()));\n      }\n      promises.push(AddonCalendar.invalidateAllowedEventTypes());\n      promises.push(CoreCourses.invalidateCategories(0, true));\n      promises.push(AddonCalendar.invalidateTimeFormat());\n      _this18.categories = undefined; // Get categories again.\n      _this18.sendLog = true;\n      if (selectedDay) {\n        selectedDay.dirty = true;\n      }\n      yield Promise.all(promises);\n    })();\n  }\n  /**\n   * Find an event and mark it as deleted.\n   *\n   * @param eventId Event ID.\n   * @param deleted Whether to mark it as deleted or not.\n   */\n  markAsDeleted(eventId, deleted) {\n    var _this$getItems2;\n    // Mark the event as deleted or not.\n    (_this$getItems2 = this.getItems()) === null || _this$getItems2 === void 0 || _this$getItems2.some(day => {\n      var _day$onlineEvents2;\n      const event = (_day$onlineEvents2 = day.onlineEvents) === null || _day$onlineEvents2 === void 0 ? void 0 : _day$onlineEvents2.find(event => event.id == eventId);\n      if (!event) {\n        return false;\n      }\n      event.deleted = deleted;\n      if (deleted) {\n        day.hasOffline = true;\n      } else {\n        var _day$events, _day$onlineEvents3, _day$events2;\n        // Re-calculate \"hasOffline\".\n        day.hasOffline = ((_day$events = day.events) === null || _day$events === void 0 ? void 0 : _day$events.length) != ((_day$onlineEvents3 = day.onlineEvents) === null || _day$onlineEvents3 === void 0 ? void 0 : _day$onlineEvents3.length) || ((_day$events2 = day.events) === null || _day$events2 === void 0 ? void 0 : _day$events2.some(event => event.deleted || event.offline));\n      }\n      return true;\n    });\n    // Add it or remove it from the list of deleted events.\n    if (deleted) {\n      var _this$deletedEvents4;\n      (_this$deletedEvents4 = this.deletedEvents) === null || _this$deletedEvents4 === void 0 || _this$deletedEvents4.add(eventId);\n    } else {\n      var _this$deletedEvents5;\n      (_this$deletedEvents5 = this.deletedEvents) === null || _this$deletedEvents5 === void 0 || _this$deletedEvents5.delete(eventId);\n    }\n  }\n  /**\n   * Forget other sources that where created whilst using this one.\n   */\n  forgetRelatedSources() {\n    for (const source of this.eventsSources) {\n      CoreRoutedItemsManagerSourcesTracker.removeReference(source, this);\n    }\n  }\n  /**\n   * Remember the list of events in a day to be used in a different context.\n   *\n   * @param day Day containing the events list.\n   */\n  rememberEventsList(day) {\n    var _this19 = this;\n    return _asyncToGenerator(function* () {\n      var _day$filteredEvents;\n      const source = CoreRoutedItemsManagerSourcesTracker.getOrCreateSource(AddonCalendarEventsSource, [day.moment.format('MMDDY')]);\n      if (!_this19.eventsSources.has(source)) {\n        _this19.eventsSources.add(source);\n        CoreRoutedItemsManagerSourcesTracker.addReference(source, _this19);\n      }\n      source.setEvents((_day$filteredEvents = day.filteredEvents) !== null && _day$filteredEvents !== void 0 ? _day$filteredEvents : []);\n      yield source.reload();\n    })();\n  }\n}","map":{"version":3,"names":["CoreNetwork","CoreEvents","CoreSites","CoreDomUtils","CoreTimeUtils","AddonCalendarProvider","AddonCalendar","AddonCalendarEventType","AddonCalendarOffline","AddonCalendarHelper","AddonCalendarSync","AddonCalendarSyncProvider","CoreCourses","CoreCoursesHelper","AddonCalendarFilterComponent","moment","NgZone","Translate","CoreNavigator","CoreUtils","CoreConstants","CoreSwipeSlidesDynamicItemsManager","CoreSwipeSlidesComponent","CoreSwipeSlidesDynamicItemsManagerSource","CoreRoutedItemsManagerSourcesTracker","AddonCalendarEventsSource","CoreAnalytics","CoreAnalyticsEventType","CoreUrlUtils","CoreTime","i0","ɵɵelementStart","ɵɵlistener","AddonCalendarDayPage_core_context_menu_item_14_Template_core_context_menu_item_action_0_listener","ɵɵrestoreView","_r4","ctx_r3","ɵɵnextContext","ɵɵresetView","goToCurrentDay","ɵɵelementEnd","ɵɵproperty","ɵɵpipeBind1","ɵɵelement","ɵɵtext","ɵɵadvance","ɵɵtextInterpolate","ɵɵpipeBind2","ɵɵpureFunction1","_c0","event_r10","moduleIcon","modulename","instance","purpose","eventIcon","iconTitle","ɵɵelementContainerStart","AddonCalendarDayPage_ng_template_37_ion_list_3_ng_container_1_Template_ion_item_click_2_listener","restoredCtx","_r20","$implicit","day_r5","item","ctx_r19","gotoEvent","id","ɵɵtemplate","AddonCalendarDayPage_ng_template_37_ion_list_3_ng_container_1_core_mod_icon_3_Template","AddonCalendarDayPage_ng_template_37_ion_list_3_ng_container_1_ion_icon_4_Template","AddonCalendarDayPage_ng_template_37_ion_list_3_ng_container_1_span_9_Template","AddonCalendarDayPage_ng_template_37_ion_list_3_ng_container_1_ion_note_14_Template","AddonCalendarDayPage_ng_template_37_ion_list_3_ng_container_1_ion_note_15_Template","ɵɵelementContainerEnd","ɵɵclassProp","ispast","_c1","eventtype","ɵɵattribute","name","ɵɵtextInterpolate1","formattedType","contextLevel","contextInstanceId","formattedtime","offline","deleted","AddonCalendarDayPage_ng_template_37_ion_list_3_ng_container_1_Template","filteredEvents","AddonCalendarDayPage_ng_template_37_ion_card_1_Template","AddonCalendarDayPage_ng_template_37_core_empty_box_2_Template","AddonCalendarDayPage_ng_template_37_ion_list_3_Template","loaded","hasOffline","length","AddonCalendarDayPage_ion_fab_38_Template_ion_fab_button_click_1_listener","_r24","ctx_r23","openEdit","AddonCalendarDayPage","constructor","_this","isOnline","syncIcon","ICON_LOADING","filter","filtered","courseId","undefined","categoryId","course","group","site","user","category","currentSiteId","getCurrentSiteId","newEventObserver","on","NEW_EVENT_EVENT","data","eventId","_this$manager","manager","getSource","markAllItemsUnloaded","refreshData","discardedObserver","NEW_EVENT_DISCARDED_EVENT","_this$manager2","editEventObserver","EDIT_EVENT_EVENT","_this$manager3","syncObserver","AUTO_SYNCED","_this$manager4","manualSyncObserver","MANUAL_SYNCED","_this$manager5","selectedDay","getSelectedItem","source","isSame","_this$manager6","deleteEventObserver","DELETED_EVENT_EVENT","sent","_this$manager7","markAsDeleted","_this$manager8","undeleteEventObserver","UNDELETED_EVENT_EVENT","_this$manager9","filterChangedObserver","FILTER_CHANGED_EVENT","_ref","_asyncToGenerator","_this$manager10","_this$manager11","loadCanCreate","filterAllDayEvents","_x","apply","arguments","onlineObserver","onChange","subscribe","run","logView","once","_this$manager12","day","params","time","unix","logEvent","type","VIEW_ITEM_LIST","ws","instant","$a","periodName","_objectSpread","url","addParamsToUrl","ngOnInit","types","enumKeys","forEach","_CoreNavigator$getRou","value","getRouteBooleanParam","push","getRouteNumberParam","some","month","AddonCalendarDaySlidesItemsManagerSource","year","date","startOf","managerUnsubscribe","addListener","onSelectedItemUpdated","onDayViewed","fetchData","canCreate","_this$manager13","timeFormat","_this$manager14","sync","_this2","_this2$manager","_this2$manager2","_this2$manager3","load","error","showErrorModalDefault","ICON_SYNC","userDate","doRefresh","refresher","done","_this3","finally","complete","afterChange","_this4","_this4$manager","_this4$manager2","invalidateContent","showErrors","_this5","result","syncEvents","warnings","showAlert","updated","_this5$manager","_this5$manager2","trigger","selectedDayIsCurrent","_this$manager15","isCurrentDay","navigateToSitePath","format","openFilter","_this6","_this6$manager","openSideModal","component","componentProps","courses","_this$manager16","now","timestamp","clone","set","hour","minute","selectedDayHasOffline","_this$manager17","_this7","swipeSlidesComponent","currentDay","loadItem","slideToItem","loadNext","_this8","_this8$swipeSlidesCom","slideNext","loadPrevious","_this9","_this9$swipeSlidesCom","slidePrev","ngOnDestroy","_this$newEventObserve","_this$discardedObserv","_this$editEventObserv","_this$deleteEventObse","_this$undeleteEventOb","_this$syncObserver","_this$manualSyncObser","_this$onlineObserver","_this$filterChangedOb","_this$manager18","_this$manager19","_this$managerUnsubscr","off","unsubscribe","forgetRelatedSources","destroy","call","_class","selectors","viewQuery","AddonCalendarDayPage_Query","rf","ctx","AddonCalendarDayPage_Template_ion_button_click_10_listener","AddonCalendarDayPage_core_context_menu_item_14_Template","AddonCalendarDayPage_Template_core_context_menu_item_action_15_listener","$event","AddonCalendarDayPage_Template_ion_refresher_ionRefresh_18_listener","target","AddonCalendarDayPage_Template_ion_button_click_26_listener","AddonCalendarDayPage_Template_ion_button_click_33_listener","AddonCalendarDayPage_ng_template_37_Template","AddonCalendarDayPage_ion_fab_38_Template","ɵɵpropertyInterpolate","page","initialMoment","eventsSources","Set","offlineEvents","offlineEditedEventsIds","sendLog","dayPage","_this10","Promise","all","loadCourses","loadCategories","loadOfflineEvents","loadOfflineDeletedEvents","loadTimeFormat","_this$getItems","getItems","filterEvents","getFilteredEvents","events","categories","rememberEventsList","_this11","getCoursesForPopover","_this12","canEditEvents","_this13","getCategories","arrayToObject","_unused","_this14","getAllEditedEvents","classifyIntoMonths","event","map","_this15","deletedEventsIds","getAllDeletedEventsIds","deletedEvents","_this16","getCalendarTimeFormat","getItemId","getDayId","getPreviousItem","subtract","getNextItem","add","loadItemData","preload","_this17","preloadedDay","onlineEvents","isPastDay","isBefore","getDayEvents","formatEventData","mergeEvents","dayTime","currentTime","promises","_ref2","isEventPast","formatEventTime","_x2","timestart","timeduration","_this$deletedEvents","_this$deletedEvents2","Object","keys","size","monthOfflineEvents","getMonthId","dayOfflineEvents","_this$deletedEvents3","has","_day$onlineEvents","indexOf","sortEvents","concat","invalidateDayEvents","_this18","invalidateAllowedEventTypes","invalidateCategories","invalidateTimeFormat","dirty","_this$getItems2","_day$onlineEvents2","find","_day$events","_day$onlineEvents3","_day$events2","_this$deletedEvents4","_this$deletedEvents5","delete","removeReference","_this19","_day$filteredEvents","getOrCreateSource","addReference","setEvents","reload"],"sources":["/home/toon/works/gitionic7/ionic-github/ionic/src/addons/calendar/pages/day/day.ts","/home/toon/works/gitionic7/ionic-github/ionic/src/addons/calendar/pages/day/day.html"],"sourcesContent":["// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Component, OnInit, OnDestroy, ViewChild } from '@angular/core';\nimport { CoreNetwork } from '@services/network';\nimport { CoreEventObserver, CoreEvents } from '@singletons/events';\nimport { CoreSites } from '@services/sites';\nimport { CoreDomUtils } from '@services/utils/dom';\nimport { CoreTimeUtils } from '@services/utils/time';\nimport {\n    AddonCalendarProvider,\n    AddonCalendar,\n    AddonCalendarEventToDisplay,\n    AddonCalendarCalendarDay,\n    AddonCalendarEventType,\n} from '../../services/calendar';\nimport { AddonCalendarOffline } from '../../services/calendar-offline';\nimport { AddonCalendarFilter, AddonCalendarHelper } from '../../services/calendar-helper';\nimport { AddonCalendarSync, AddonCalendarSyncProvider } from '../../services/calendar-sync';\nimport { CoreCategoryData, CoreCourses, CoreEnrolledCourseData } from '@features/courses/services/courses';\nimport { CoreCoursesHelper } from '@features/courses/services/courses-helper';\nimport { AddonCalendarFilterComponent } from '../../components/filter/filter';\nimport moment from 'moment-timezone';\nimport { NgZone, Translate } from '@singletons';\nimport { CoreNavigator } from '@services/navigator';\nimport { Params } from '@angular/router';\nimport { Subscription } from 'rxjs';\nimport { CoreUtils } from '@services/utils/utils';\nimport { CoreConstants } from '@/core/constants';\nimport { CoreSwipeSlidesDynamicItemsManager } from '@classes/items-management/swipe-slides-dynamic-items-manager';\nimport { CoreSwipeSlidesComponent } from '@components/swipe-slides/swipe-slides';\nimport {\n    CoreSwipeSlidesDynamicItem,\n    CoreSwipeSlidesDynamicItemsManagerSource,\n} from '@classes/items-management/swipe-slides-dynamic-items-manager-source';\nimport { CoreRoutedItemsManagerSourcesTracker } from '@classes/items-management/routed-items-manager-sources-tracker';\nimport { AddonCalendarEventsSource } from '@addons/calendar/classes/events-source';\nimport { CoreAnalytics, CoreAnalyticsEventType } from '@services/analytics';\nimport { CoreUrlUtils } from '@services/utils/url';\nimport { CoreTime } from '@singletons/time';\n\n/**\n * Page that displays the calendar events for a certain day.\n */\n@Component({\n    selector: 'page-addon-calendar-day',\n    templateUrl: 'day.html',\n    styleUrls: ['../../calendar-common.scss', 'day.scss'],\n})\nexport class AddonCalendarDayPage implements OnInit, OnDestroy {\n\n    @ViewChild(CoreSwipeSlidesComponent) swipeSlidesComponent?: CoreSwipeSlidesComponent<PreloadedDay>;\n\n    protected currentSiteId: string;\n\n    // Observers.\n    protected newEventObserver: CoreEventObserver;\n    protected discardedObserver: CoreEventObserver;\n    protected editEventObserver: CoreEventObserver;\n    protected deleteEventObserver: CoreEventObserver;\n    protected undeleteEventObserver: CoreEventObserver;\n    protected syncObserver: CoreEventObserver;\n    protected manualSyncObserver: CoreEventObserver;\n    protected onlineObserver: Subscription;\n    protected filterChangedObserver: CoreEventObserver;\n    protected managerUnsubscribe?: () => void;\n    protected logView: () => void;\n\n    periodName?: string;\n    manager?: CoreSwipeSlidesDynamicItemsManager<PreloadedDay, AddonCalendarDaySlidesItemsManagerSource>;\n    loaded = false;\n    isOnline = false;\n    syncIcon = CoreConstants.ICON_LOADING;\n    filter: AddonCalendarFilter = {\n        filtered: false,\n        courseId: undefined,\n        categoryId: undefined,\n        course: true,\n        group: true,\n        site: true,\n        user: true,\n        category: true,\n    };\n\n    constructor() {\n        this.currentSiteId = CoreSites.getCurrentSiteId();\n\n        // Listen for events added. When an event is added, reload the data.\n        this.newEventObserver = CoreEvents.on(\n            AddonCalendarProvider.NEW_EVENT_EVENT,\n            (data) => {\n                if (data && data.eventId) {\n                    this.manager?.getSource().markAllItemsUnloaded();\n                    this.refreshData(true, true);\n                }\n            },\n            this.currentSiteId,\n        );\n\n        // Listen for new event discarded event. When it does, reload the data.\n        this.discardedObserver = CoreEvents.on(AddonCalendarProvider.NEW_EVENT_DISCARDED_EVENT, () => {\n            this.manager?.getSource().markAllItemsUnloaded();\n            this.refreshData(true, true);\n        }, this.currentSiteId);\n\n        // Listen for events edited. When an event is edited, reload the data.\n        this.editEventObserver = CoreEvents.on(\n            AddonCalendarProvider.EDIT_EVENT_EVENT,\n            (data) => {\n                if (data && data.eventId) {\n                    this.manager?.getSource().markAllItemsUnloaded();\n                    this.refreshData(true, true);\n                }\n            },\n            this.currentSiteId,\n        );\n\n        // Refresh data if calendar events are synchronized automatically.\n        this.syncObserver = CoreEvents.on(AddonCalendarSyncProvider.AUTO_SYNCED, () => {\n            this.manager?.getSource().markAllItemsUnloaded();\n            this.refreshData(false, true);\n        }, this.currentSiteId);\n\n        // Refresh data if calendar events are synchronized manually but not by this page.\n        this.manualSyncObserver = CoreEvents.on(AddonCalendarSyncProvider.MANUAL_SYNCED, (data) => {\n            const selectedDay = this.manager?.getSelectedItem();\n            if (data && (data.source != 'day' || !selectedDay || !data.moment || !selectedDay.moment.isSame(data.moment, 'day'))) {\n                this.manager?.getSource().markAllItemsUnloaded();\n                this.refreshData(false, true);\n            }\n        }, this.currentSiteId);\n\n        // Update the events when an event is deleted.\n        this.deleteEventObserver = CoreEvents.on(\n            AddonCalendarProvider.DELETED_EVENT_EVENT,\n            (data) => {\n                if (data && !data.sent) {\n                    // Event was deleted in offline. Just mark it as deleted, no need to refresh.\n                    this.manager?.getSource().markAsDeleted(data.eventId, true);\n                } else {\n                    this.manager?.getSource().markAllItemsUnloaded();\n                    this.refreshData(false, true);\n                }\n            },\n            this.currentSiteId,\n        );\n\n        // Listen for events \"undeleted\" (offline).\n        this.undeleteEventObserver = CoreEvents.on(\n            AddonCalendarProvider.UNDELETED_EVENT_EVENT,\n            (data) => {\n                if (!data || !data.eventId) {\n                    return;\n                }\n\n                // Mark it as undeleted, no need to refresh.\n                this.manager?.getSource().markAsDeleted(data.eventId, false);\n            },\n            this.currentSiteId,\n        );\n\n        this.filterChangedObserver = CoreEvents.on(\n            AddonCalendarProvider.FILTER_CHANGED_EVENT,\n            async (data) => {\n                this.filter = data;\n\n                // Course viewed has changed, check if the user can create events for this course calendar.\n                await this.manager?.getSource().loadCanCreate(this.filter.courseId);\n\n                this.manager?.getSource().filterAllDayEvents(this.filter);\n            },\n        );\n\n        // Refresh online status when changes.\n        this.onlineObserver = CoreNetwork.onChange().subscribe(() => {\n            // Execute the callback in the Angular zone, so change detection doesn't stop working.\n            NgZone.run(() => {\n                this.isOnline = CoreNetwork.isOnline();\n            });\n        });\n\n        this.logView = CoreTime.once(() => {\n            const day = this.manager?.getSelectedItem();\n            if (!day) {\n                return;\n            }\n            const params = {\n                course: this.filter.courseId,\n                time: day.moment.unix(),\n            };\n\n            CoreAnalytics.logEvent({\n                type: CoreAnalyticsEventType.VIEW_ITEM_LIST,\n                ws: 'core_calendar_get_calendar_day_view',\n                name: Translate.instant('addon.calendar.dayviewtitle', { $a: this.periodName }),\n                data: {\n                    ...params,\n                    category: 'calendar',\n                },\n                url: CoreUrlUtils.addParamsToUrl('/calendar/view.php?view=day', params),\n            });\n        });\n    }\n\n    /**\n     * View loaded.\n     */\n    ngOnInit(): void {\n        const types: string[] = [];\n\n        CoreUtils.enumKeys(AddonCalendarEventType).forEach((name) => {\n            const value = AddonCalendarEventType[name];\n            this.filter[name] = CoreNavigator.getRouteBooleanParam(name) ?? true;\n            types.push(value);\n        });\n        this.filter.courseId = CoreNavigator.getRouteNumberParam('courseId');\n        this.filter.categoryId = CoreNavigator.getRouteNumberParam('categoryId');\n\n        this.filter.filtered = this.filter.courseId !== undefined || types.some((name) => !this.filter[name]);\n\n        const month = CoreNavigator.getRouteNumberParam('month');\n        const source = new AddonCalendarDaySlidesItemsManagerSource(this, moment({\n            year: CoreNavigator.getRouteNumberParam('year'),\n            month: month ? month - 1 : undefined,\n            date: CoreNavigator.getRouteNumberParam('day'),\n        }).startOf('day'));\n        this.manager = new CoreSwipeSlidesDynamicItemsManager(source);\n        this.managerUnsubscribe = this.manager.addListener({\n            onSelectedItemUpdated: (item) => {\n                this.onDayViewed(item);\n            },\n        });\n\n        this.fetchData(true);\n    }\n\n    get canCreate(): boolean {\n        return this.manager?.getSource().canCreate || false;\n    }\n\n    get timeFormat(): string {\n        return this.manager?.getSource().timeFormat || 'core.strftimetime';\n    }\n\n    /**\n     * Fetch all the data required for the view.\n     *\n     * @param sync Whether it should try to synchronize offline events.\n     * @returns Promise resolved when done.\n     */\n    async fetchData(sync?: boolean): Promise<void> {\n        this.syncIcon = CoreConstants.ICON_LOADING;\n        this.isOnline = CoreNetwork.isOnline();\n\n        if (sync) {\n            await this.sync();\n        }\n\n        try {\n            await this.manager?.getSource().fetchData(this.filter.courseId);\n\n            await this.manager?.getSource().load(this.manager?.getSelectedItem());\n\n            this.logView();\n        } catch (error) {\n            CoreDomUtils.showErrorModalDefault(error, 'addon.calendar.errorloadevents', true);\n        }\n\n        this.loaded = true;\n        this.syncIcon = CoreConstants.ICON_SYNC;\n    }\n\n    /**\n     * Update data related to day being viewed.\n     *\n     * @param day Day viewed.\n     */\n    onDayViewed(day: DayBasicData): void {\n        this.periodName = CoreTimeUtils.userDate(\n            day.moment.unix() * 1000,\n            'core.strftimedaydate',\n        );\n    }\n\n    /**\n     * Refresh the data.\n     *\n     * @param refresher Refresher.\n     * @param done Function to call when done.\n     * @returns Promise resolved when done.\n     */\n    async doRefresh(refresher?: HTMLIonRefresherElement, done?: () => void): Promise<void> {\n        if (!this.loaded) {\n            return;\n        }\n\n        await this.refreshData(true).finally(() => {\n            refresher?.complete();\n            done && done();\n        });\n    }\n\n    /**\n     * Refresh the data.\n     *\n     * @param sync Whether it should try to synchronize offline events.\n     * @param afterChange Whether the refresh is done after an event has changed or has been synced.\n     * @returns Promise resolved when done.\n     */\n    async refreshData(sync?: boolean, afterChange?: boolean): Promise<void> {\n        this.syncIcon = CoreConstants.ICON_LOADING;\n\n        const selectedDay = this.manager?.getSelectedItem() || null;\n\n        // Don't invalidate day events after a change, it has already been handled.\n        await this.manager?.getSource().invalidateContent(selectedDay, !afterChange);\n\n        await this.fetchData(sync);\n    }\n\n    /**\n     * Try to synchronize offline events.\n     *\n     * @param showErrors Whether to show sync errors to the user.\n     * @returns Promise resolved when done.\n     */\n    protected async sync(showErrors?: boolean): Promise<void> {\n        try {\n            const result = await AddonCalendarSync.syncEvents();\n\n            if (result.warnings && result.warnings.length) {\n                CoreDomUtils.showAlert(undefined, result.warnings[0]);\n            }\n\n            if (result.updated) {\n                // Trigger a manual sync event.\n                const selectedDay = this.manager?.getSelectedItem();\n                result.source = 'day';\n                result.moment = selectedDay?.moment;\n\n                this.manager?.getSource().markAllItemsUnloaded();\n                CoreEvents.trigger(AddonCalendarSyncProvider.MANUAL_SYNCED, result, this.currentSiteId);\n            }\n        } catch (error) {\n            if (showErrors) {\n                CoreDomUtils.showErrorModalDefault(error, 'core.errorsync', true);\n            }\n        }\n    }\n\n    /**\n     * Check whether selected day is current day.\n     *\n     * @returns If selected day is current.\n     */\n    selectedDayIsCurrent(): boolean {\n        return !!this.manager?.getSelectedItem()?.isCurrentDay;\n    }\n\n    /**\n     * Navigate to a particular event.\n     *\n     * @param eventId Event to load.\n     * @param day Day.\n     */\n    gotoEvent(eventId: number, day: PreloadedDay): void {\n        CoreNavigator.navigateToSitePath(`/calendar/event/${eventId}`, { params: { date: day.moment.format('MMDDY') } });\n    }\n\n    /**\n     * Show the filter menu.\n     */\n    async openFilter(): Promise<void> {\n        await CoreDomUtils.openSideModal({\n            component: AddonCalendarFilterComponent,\n            componentProps: {\n                courses: this.manager?.getSource().courses,\n                filter: this.filter,\n            },\n        });\n    }\n\n    /**\n     * Open page to create/edit an event.\n     *\n     * @param eventId Event ID to edit.\n     */\n    openEdit(eventId?: number): void {\n        const params: Params = {};\n\n        if (!eventId) {\n            // It's a new event, set the time.\n            eventId = 0;\n\n            const selectedDay = this.manager?.getSelectedItem();\n            if (selectedDay) {\n                // Use current time but in the specified day.\n                const now = moment();\n                params.timestamp = selectedDay.moment.clone().set({ hour: now.hour(), minute: now.minute() }).unix() * 1000;\n            }\n        }\n\n        if (this.filter.courseId) {\n            params.courseId = this.filter.courseId;\n        }\n\n        CoreNavigator.navigateToSitePath(`/calendar/edit/${eventId}`, { params });\n    }\n\n    /**\n     * Check whether selected day has offline data.\n     *\n     * @returns Whether selected day has offline data.\n     */\n    selectedDayHasOffline(): boolean {\n        const selectedDay = this.manager?.getSelectedItem();\n\n        return !!(selectedDay?.hasOffline);\n    }\n\n    /**\n     * Go to current day.\n     */\n    async goToCurrentDay(): Promise<void> {\n        const manager = this.manager;\n        if (!manager || !this.swipeSlidesComponent) {\n            return;\n        }\n\n        const currentDay = {\n            moment: moment(),\n        };\n        this.loaded = false;\n\n        try {\n            // Make sure the day is loaded.\n            await manager.getSource().loadItem(currentDay);\n\n            this.swipeSlidesComponent.slideToItem(currentDay);\n        } catch (error) {\n            CoreDomUtils.showErrorModalDefault(error, 'addon.calendar.errorloadevents', true);\n        } finally {\n            this.loaded = true;\n        }\n    }\n\n    /**\n     * Load next day.\n     */\n    async loadNext(): Promise<void> {\n        this.swipeSlidesComponent?.slideNext();\n    }\n\n    /**\n     * Load previous day.\n     */\n    async loadPrevious(): Promise<void> {\n        this.swipeSlidesComponent?.slidePrev();\n    }\n\n    /**\n     * Page destroyed.\n     */\n    ngOnDestroy(): void {\n        this.newEventObserver?.off();\n        this.discardedObserver?.off();\n        this.editEventObserver?.off();\n        this.deleteEventObserver?.off();\n        this.undeleteEventObserver?.off();\n        this.syncObserver?.off();\n        this.manualSyncObserver?.off();\n        this.onlineObserver?.unsubscribe();\n        this.filterChangedObserver?.off();\n        this.manager?.getSource().forgetRelatedSources();\n        this.manager?.destroy();\n        this.managerUnsubscribe?.();\n\n        delete this.manager;\n    }\n\n}\n\n/**\n * Basic data to identify a day.\n */\ntype DayBasicData = {\n    moment: moment.Moment;\n};\n\n/**\n * Preloaded month.\n */\ntype PreloadedDay = DayBasicData & CoreSwipeSlidesDynamicItem & {\n    events?: AddonCalendarEventToDisplay[]; // Events (both online and offline).\n    onlineEvents?: AddonCalendarEventToDisplay[];\n    filteredEvents?: AddonCalendarEventToDisplay[];\n    isCurrentDay?: boolean;\n    isPastDay?: boolean;\n    hasOffline?: boolean; // Whether the day has offline data.\n};\n\n/**\n * Helper to manage swiping within days.\n */\nclass AddonCalendarDaySlidesItemsManagerSource extends CoreSwipeSlidesDynamicItemsManagerSource<PreloadedDay> {\n\n    courses: CoreEnrolledCourseData[] = [];\n    eventsSources: Set<AddonCalendarEventsSource> = new Set();\n    // Offline events classified in month & day.\n    offlineEvents: Record<string, Record<number, AddonCalendarEventToDisplay[]>> = {};\n    offlineEditedEventsIds: number[] = []; // IDs of events edited in offline.\n    categories?: { [id: number]: CoreCategoryData };\n    deletedEvents?: Set<number>; // Events deleted in offline.\n    timeFormat?: string;\n    canCreate = false;\n\n    protected dayPage: AddonCalendarDayPage;\n    protected sendLog = true;\n\n    constructor(page: AddonCalendarDayPage, initialMoment: moment.Moment) {\n        super({ moment: initialMoment });\n\n        this.dayPage = page;\n    }\n\n    /**\n     * Fetch data.\n     *\n     * @param courseId Current selected course id (if any).\n     * @returns Promise resolved when done.\n     */\n    async fetchData(courseId?: number): Promise<void> {\n        await Promise.all([\n            this.loadCourses(courseId),\n            this.loadCanCreate(courseId),\n            this.loadCategories(),\n            this.loadOfflineEvents(),\n            this.loadOfflineDeletedEvents(),\n            this.loadTimeFormat(),\n        ]);\n    }\n\n    /**\n     * Filter all loaded days events based on the filter popover.\n     *\n     * @param filter Filter to apply.\n     */\n    filterAllDayEvents(filter: AddonCalendarFilter): void {\n        this.getItems()?.forEach(day => this.filterEvents(day, filter));\n    }\n\n    /**\n     * Filter events of a certain day based on the filter popover.\n     *\n     * @param day Day with the events.\n     * @param filter Filter to apply.\n     */\n    filterEvents(day: PreloadedDay, filter: AddonCalendarFilter): void {\n        day.filteredEvents = AddonCalendarHelper.getFilteredEvents(day.events || [], filter, this.categories || {});\n\n        this.rememberEventsList(day);\n    }\n\n    /**\n     * Load courses.\n     *\n     * @param courseId Current selected course id (if any).\n     * @returns Promise resolved when done.\n     */\n    async loadCourses(courseId?: number): Promise<void> {\n        const data = await CoreCoursesHelper.getCoursesForPopover(courseId);\n\n        this.courses = data.courses;\n    }\n\n    /**\n     * Load whether user can create events.\n     *\n     * @param courseId Current selected course id (if any).\n     * @returns Promise resolved when done.\n     */\n    async loadCanCreate(courseId?: number): Promise<void> {\n        this.canCreate = await AddonCalendarHelper.canEditEvents(courseId);\n    }\n\n    /**\n     * Load categories to be able to filter events.\n     *\n     * @returns Promise resolved when done.\n     */\n    async loadCategories(): Promise<void> {\n        if (this.categories) {\n            // Already retrieved, stop.\n            return;\n        }\n\n        try {\n            const categories = await CoreCourses.getCategories(0, true);\n\n            // Index categories by ID.\n            this.categories = CoreUtils.arrayToObject(categories, 'id');\n        } catch {\n            // Ignore errors.\n        }\n    }\n\n    /**\n     * Load events created or edited in offline.\n     *\n     * @returns Promise resolved when done.\n     */\n    async loadOfflineEvents(): Promise<void> {\n        // Get offline events.\n        const events = await AddonCalendarOffline.getAllEditedEvents();\n\n        // Classify them by month & day.\n        this.offlineEvents = AddonCalendarHelper.classifyIntoMonths(events);\n\n        // Get the IDs of events edited in offline.\n        this.offlineEditedEventsIds = events.filter((event) => event.id > 0).map((event) => event.id);\n    }\n\n    /**\n     * Load events deleted in offline.\n     *\n     * @returns Promise resolved when done.\n     */\n    async loadOfflineDeletedEvents(): Promise<void> {\n        const deletedEventsIds = await AddonCalendarOffline.getAllDeletedEventsIds();\n\n        this.deletedEvents = new Set(deletedEventsIds);\n    }\n\n    /**\n     * Load time format.\n     *\n     * @returns Promise resolved when done.\n     */\n    async loadTimeFormat(): Promise<void> {\n        this.timeFormat = await AddonCalendar.getCalendarTimeFormat();\n    }\n\n    /**\n     * @inheritdoc\n     */\n    getItemId(item: DayBasicData): string | number {\n        return AddonCalendarHelper.getDayId(item.moment);\n    }\n\n    /**\n     * @inheritdoc\n     */\n    getPreviousItem(item: DayBasicData): DayBasicData | null {\n        return {\n            moment: item.moment.clone().subtract(1, 'day'),\n        };\n    }\n\n    /**\n     * @inheritdoc\n     */\n    getNextItem(item: DayBasicData): DayBasicData | null {\n        return {\n            moment: item.moment.clone().add(1, 'day'),\n        };\n    }\n\n    /**\n     * @inheritdoc\n     */\n    async loadItemData(day: DayBasicData, preload = false): Promise<PreloadedDay | null> {\n        const preloadedDay: PreloadedDay = {\n            ...day,\n            hasOffline: false,\n            events: [],\n            onlineEvents: [],\n            filteredEvents: [],\n            isCurrentDay: day.moment.isSame(moment(), 'day'),\n            isPastDay: day.moment.isBefore(moment(), 'day'),\n        };\n\n        if (preload) {\n            return preloadedDay;\n        }\n\n        let result: AddonCalendarCalendarDay;\n\n        try {\n            // Don't pass courseId and categoryId, we'll filter them locally.\n            result = await AddonCalendar.getDayEvents(day.moment.year(), day.moment.month() + 1, day.moment.date());\n            preloadedDay.onlineEvents = await Promise.all(result.events.map((event) => AddonCalendarHelper.formatEventData(event)));\n        } catch (error) {\n            // Allow navigating to non-cached days in offline (behave as if using emergency cache).\n            if (CoreNetwork.isOnline()) {\n                throw error;\n            }\n        }\n\n        // Merge the online events with offline data.\n        preloadedDay.events = this.mergeEvents(preloadedDay);\n\n        // Filter events by course.\n        this.filterEvents(preloadedDay, this.dayPage.filter);\n\n        // Re-calculate the formatted time so it uses the device date.\n        const dayTime = day.moment.unix() * 1000;\n        const currentTime = CoreTimeUtils.timestamp();\n\n        const promises = preloadedDay.events.map(async (event) => {\n            event.ispast = preloadedDay.isPastDay || (preloadedDay.isCurrentDay && this.isEventPast(event, currentTime));\n            event.formattedtime = await AddonCalendar.formatEventTime(event, this.dayPage.timeFormat, true, dayTime);\n        });\n\n        await Promise.all(promises);\n\n        return preloadedDay;\n    }\n\n    /**\n     * Returns if the event is in the past or not.\n     *\n     * @param event Event object.\n     * @param currentTime Current time.\n     * @returns True if it's in the past.\n     */\n    isEventPast(event: AddonCalendarEventToDisplay, currentTime: number): boolean {\n        return (event.timestart + event.timeduration) < currentTime;\n    }\n\n    /**\n     * Merge online events with the offline events of that period.\n     *\n     * @param day Day with the events.\n     * @returns Merged events.\n     */\n    mergeEvents(day: PreloadedDay): AddonCalendarEventToDisplay[] {\n        day.hasOffline = false;\n\n        if (!Object.keys(this.offlineEvents).length && !this.deletedEvents?.size) {\n            // No offline events, nothing to merge.\n            return day.onlineEvents || [];\n        }\n\n        const monthOfflineEvents = this.offlineEvents[AddonCalendarHelper.getMonthId(day.moment)];\n        const dayOfflineEvents = monthOfflineEvents && monthOfflineEvents[day.moment.date()];\n        let result = day.onlineEvents || [];\n\n        if (this.deletedEvents?.size) {\n            // Mark as deleted the events that were deleted in offline.\n            result.forEach((event) => {\n                event.deleted = this.deletedEvents?.has(event.id);\n\n                if (event.deleted) {\n                    day.hasOffline = true;\n                }\n            });\n        }\n\n        if (this.offlineEditedEventsIds.length) {\n            // Remove the online events that were modified in offline.\n            result = result.filter((event) => this.offlineEditedEventsIds.indexOf(event.id) == -1);\n\n            if (result.length != day.onlineEvents?.length) {\n                day.hasOffline = true;\n            }\n        }\n\n        if (dayOfflineEvents && dayOfflineEvents.length) {\n            // Add the offline events (either new or edited).\n            day.hasOffline = true;\n            result = AddonCalendarHelper.sortEvents(result.concat(dayOfflineEvents));\n        }\n\n        return result;\n    }\n\n    /**\n     * Invalidate content.\n     *\n     * @param selectedDay The current selected day.\n     * @param invalidateDayEvents Whether to invalidate selected day events.\n     * @returns Promise resolved when done.\n     */\n    async invalidateContent(selectedDay: PreloadedDay | null, invalidateDayEvents?: boolean): Promise<void> {\n        const promises: Promise<void>[] = [];\n\n        if (invalidateDayEvents && selectedDay) {\n            promises.push(AddonCalendar.invalidateDayEvents(\n                selectedDay.moment.year(),\n                selectedDay.moment.month() + 1,\n                selectedDay.moment.date(),\n            ));\n        }\n        promises.push(AddonCalendar.invalidateAllowedEventTypes());\n        promises.push(CoreCourses.invalidateCategories(0, true));\n        promises.push(AddonCalendar.invalidateTimeFormat());\n\n        this.categories = undefined; // Get categories again.\n        this.sendLog = true;\n\n        if (selectedDay) {\n            selectedDay.dirty = true;\n        }\n\n        await Promise.all(promises);\n    }\n\n    /**\n     * Find an event and mark it as deleted.\n     *\n     * @param eventId Event ID.\n     * @param deleted Whether to mark it as deleted or not.\n     */\n    markAsDeleted(eventId: number, deleted: boolean): void {\n        // Mark the event as deleted or not.\n        this.getItems()?.some(day => {\n            const event = day.onlineEvents?.find((event) => event.id == eventId);\n\n            if (!event) {\n                return false;\n            }\n\n            event.deleted = deleted;\n\n            if (deleted) {\n                day.hasOffline = true;\n            } else {\n                // Re-calculate \"hasOffline\".\n                day.hasOffline = day.events?.length != day.onlineEvents?.length ||\n                    day.events?.some((event) => event.deleted || event.offline);\n            }\n\n            return true;\n        });\n\n        // Add it or remove it from the list of deleted events.\n        if (deleted) {\n            this.deletedEvents?.add(eventId);\n        } else {\n            this.deletedEvents?.delete(eventId);\n        }\n    }\n\n    /**\n     * Forget other sources that where created whilst using this one.\n     */\n    forgetRelatedSources(): void {\n        for (const source of this.eventsSources) {\n            CoreRoutedItemsManagerSourcesTracker.removeReference(source, this);\n        }\n    }\n\n    /**\n     * Remember the list of events in a day to be used in a different context.\n     *\n     * @param day Day containing the events list.\n     */\n    private async rememberEventsList(day: PreloadedDay): Promise<void> {\n        const source = CoreRoutedItemsManagerSourcesTracker.getOrCreateSource(AddonCalendarEventsSource, [\n            day.moment.format('MMDDY'),\n        ]);\n\n        if (!this.eventsSources.has(source)) {\n            this.eventsSources.add(source);\n\n            CoreRoutedItemsManagerSourcesTracker.addReference(source, this);\n        }\n\n        source.setEvents(day.filteredEvents ?? []);\n\n        await source.reload();\n    }\n\n}\n","<ion-header>\n    <ion-toolbar>\n        <ion-buttons slot=\"start\">\n            <ion-back-button [text]=\"'core.back' | translate\" />\n        </ion-buttons>\n        <ion-title>\n            <h1>{{ 'addon.calendar.calendarevents' | translate }}</h1>\n        </ion-title>\n        <ion-buttons slot=\"end\">\n            <ion-button fill=\"clear\" (click)=\"openFilter()\" [attr.aria-label]=\"'core.filter' | translate\">\n                <ion-icon slot=\"icon-only\" name=\"fas-filter\" aria-hidden=\"true\" />\n            </ion-button>\n            <core-context-menu>\n                <core-context-menu-item *ngIf=\"!selectedDayIsCurrent()\" [priority]=\"900\" [content]=\"'addon.calendar.today' | translate\"\n                    iconAction=\"fas-calendar-day\" (action)=\"goToCurrentDay()\" />\n                <core-context-menu-item [hidden]=\"!loaded || !selectedDayHasOffline() || !isOnline\" [priority]=\"400\"\n                    [content]=\"'core.settings.synchronizenow' | translate\" (action)=\"doRefresh(undefined, $event)\" [iconAction]=\"syncIcon\"\n                    [closeOnClick]=\"false\" />\n            </core-context-menu>\n        </ion-buttons>\n    </ion-toolbar>\n</ion-header>\n<ion-content>\n    <ion-refresher slot=\"fixed\" [disabled]=\"!loaded\" (ionRefresh)=\"doRefresh($event.target)\">\n        <ion-refresher-content pullingText=\"{{ 'core.pulltorefresh' | translate }}\" />\n    </ion-refresher>\n\n    <core-loading [hideUntil]=\"loaded\">\n        <div class=\"core-swipe-slides-container\">\n            <!-- Period name and arrows to navigate. -->\n            <ion-grid class=\"ion-no-padding safe-area-padding\">\n                <ion-row class=\"ion-align-items-center\">\n                    <ion-col class=\"ion-text-start\">\n                        <ion-button fill=\"clear\" (click)=\"loadPrevious()\" [attr.aria-label]=\"'addon.calendar.dayprev' | translate\">\n                            <ion-icon name=\"fas-chevron-left\" slot=\"icon-only\" aria-hidden=\"true\" />\n                        </ion-button>\n                    </ion-col>\n                    <ion-col class=\"ion-text-center addon-calendar-period\">\n                        <h2>{{ periodName }}</h2>\n                    </ion-col>\n                    <ion-col class=\"ion-text-end\">\n                        <ion-button fill=\"clear\" (click)=\"loadNext()\" [attr.aria-label]=\"'addon.calendar.daynext' | translate\">\n                            <ion-icon name=\"fas-chevron-right\" slot=\"icon-only\" aria-hidden=\"true\" />\n                        </ion-button>\n                    </ion-col>\n                </ion-row>\n            </ion-grid>\n\n            <core-swipe-slides [manager]=\"manager\">\n                <ng-template let-day=\"item\">\n                    <core-loading [hideUntil]=\"day.loaded\">\n                        <!-- There is data to be synchronized -->\n                        <ion-card class=\"core-warning-card list-item-limited-width\" *ngIf=\"day.hasOffline\">\n                            <ion-item>\n                                <ion-icon name=\"fas-triangle-exclamation\" slot=\"start\" aria-hidden=\"true\" />\n                                <ion-label>{{ 'core.hasdatatosync' | translate:{$a: 'core.day' | translate} }}</ion-label>\n                            </ion-item>\n                        </ion-card>\n\n                        <core-empty-box *ngIf=\"!day.filteredEvents || !day.filteredEvents.length\" icon=\"fas-calendar\"\n                            [message]=\"'addon.calendar.noevents' | translate\" />\n\n                        <ion-list *ngIf=\"day.filteredEvents && day.filteredEvents.length\" class=\"list-item-limited-width\">\n                            <ng-container *ngFor=\"let event of day.filteredEvents\">\n                                <ion-card>\n                                    <ion-item class=\"addon-calendar-event ion-text-wrap\" [attr.aria-label]=\"event.name\"\n                                        (click)=\"gotoEvent(event.id, day)\" [class.item-dimmed]=\"event.ispast\"\n                                        [ngClass]=\"['addon-calendar-eventtype-'+event.eventtype]\" button [detail]=\"false\">\n                                        <core-mod-icon *ngIf=\"event.moduleIcon\" [modicon]=\"event.moduleIcon\" slot=\"start\" [showAlt]=\"false\"\n                                            [modname]=\"event.modulename\" [componentId]=\"event.instance\" [purpose]=\"event.purpose\" />\n                                        <ion-icon *ngIf=\"event.eventIcon && !event.moduleIcon\" [name]=\"event.eventIcon\" slot=\"start\"\n                                            aria-hidden=\"true\" />\n                                        <ion-label>\n                                            <!-- Add the icon title so accessibility tools read it. -->\n                                            <span class=\"sr-only\">\n                                                {{ 'addon.calendar.type' + event.formattedType | translate }}\n                                                <span class=\"sr-only\" *ngIf=\"event.moduleIcon && event.iconTitle\">{{ event.iconTitle\n                                                    }}</span>\n                                            </span>\n                                            <p class=\"item-heading\">\n                                                <core-format-text [text]=\"event.name\" [contextLevel]=\"event.contextLevel\"\n                                                    [contextInstanceId]=\"event.contextInstanceId\" />\n                                            </p>\n                                            <p>\n                                                <core-format-text [text]=\"event.formattedtime\" [filter]=\"false\" />\n                                            </p>\n                                        </ion-label>\n                                        <ion-note *ngIf=\"event.offline && !event.deleted\" slot=\"end\">\n                                            <ion-icon name=\"fas-clock\" aria-hidden=\"true\" />\n                                            <span class=\"ion-text-wrap\">{{ 'core.notsent' | translate }}</span>\n                                        </ion-note>\n                                        <ion-note *ngIf=\"event.deleted\" slot=\"end\">\n                                            <ion-icon name=\"fas-trash\" aria-hidden=\"true\" />\n                                            <span class=\"ion-text-wrap\">{{ 'core.deletedoffline' | translate }}</span>\n                                        </ion-note>\n                                    </ion-item>\n                                </ion-card>\n                            </ng-container>\n                        </ion-list>\n                    </core-loading>\n                </ng-template>\n            </core-swipe-slides>\n        </div>\n    </core-loading>\n\n    <!-- Create a calendar event. -->\n    <ion-fab slot=\"fixed\" core-fab vertical=\"bottom\" horizontal=\"end\" *ngIf=\"canCreate && loaded\">\n        <ion-fab-button (click)=\"openEdit()\" [attr.aria-label]=\"'addon.calendar.newevent' | translate\">\n            <ion-icon name=\"fas-plus\" aria-hidden=\"true\" />\n            <span class=\"sr-only\">{{ 'addon.calendar.newevent' | translate }}</span>\n        </ion-fab-button>\n    </ion-fab>\n</ion-content>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
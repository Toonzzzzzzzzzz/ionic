{"ast":null,"code":"import _asyncToGenerator from \"/home/toon/works/gitionic7/ionic-github/ionic/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _class;\nimport { FormGroup, Validators } from '@angular/forms';\nimport { CoreEvents } from '@singletons/events';\nimport { CoreGroups } from '@services/groups';\nimport { CoreSites } from '@services/sites';\nimport { CoreSync } from '@services/sync';\nimport { CoreDomUtils } from '@services/utils/dom';\nimport { CoreTimeUtils } from '@services/utils/time';\nimport { CoreUtils } from '@services/utils/utils';\nimport { CoreCourses } from '@features/courses/services/courses';\nimport { CoreEditorRichTextEditorComponent } from '@features/editor/components/rich-text-editor/rich-text-editor';\nimport { AddonCalendarProvider, AddonCalendarEventType, AddonCalendar } from '../../services/calendar';\nimport { AddonCalendarOffline } from '../../services/calendar-offline';\nimport { AddonCalendarHelper } from '../../services/calendar-helper';\nimport { AddonCalendarSync, AddonCalendarSyncProvider } from '../../services/calendar-sync';\nimport { Translate } from '@singletons';\nimport { CoreFilterHelper } from '@features/filter/services/filter-helper';\nimport { CoreError } from '@classes/errors/error';\nimport { CoreNavigator } from '@services/navigator';\nimport { CoreForms } from '@singletons/form';\nimport { CoreReminders, CoreRemindersService } from '@features/reminders/services/reminders';\nimport { CoreRemindersSetReminderMenuComponent } from '@features/reminders/components/set-reminder-menu/set-reminder-menu';\nimport moment from 'moment-timezone';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"../../../../core/components/input-errors/input-errors\";\nimport * as i4 from \"../../../../core/components/loading/loading\";\nimport * as i5 from \"../../../../core/components/mark-required/mark-required\";\nimport * as i6 from \"../../../../core/directives/fa-icon\";\nimport * as i7 from \"../../../../core/directives/collapsible-footer\";\nimport * as i8 from \"../../../../core/directives/content\";\nimport * as i9 from \"../../../../core/directives/update-non-reactive-attributes\";\nimport * as i10 from \"@ionic/angular\";\nimport * as i11 from \"../../../../core/features/editor/components/rich-text-editor/rich-text-editor\";\nimport * as i12 from \"@ngx-translate/core\";\nconst _c0 = [\"editEventForm\"];\nfunction AddonCalendarEditEventPage_form_14_ng_template_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-datetime\", 29)(1, \"span\", 30);\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"translate\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"max\", ctx_r3.maxDate)(\"min\", ctx_r3.minDate);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(3, 3, \"core.date\"));\n  }\n}\nfunction AddonCalendarEditEventPage_form_14_p_24_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 31);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(2, 1, ctx_r4.eventTypes[0].name));\n  }\n}\nfunction AddonCalendarEditEventPage_form_14_ion_select_25_ion_select_option_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-select-option\", 34);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const type_r15 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", type_r15.value);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(2, 2, type_r15.name), \" \");\n  }\n}\nconst _c1 = function (a0) {\n  return {\n    header: a0\n  };\n};\nfunction AddonCalendarEditEventPage_form_14_ion_select_25_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-select\", 32);\n    i0.ɵɵpipe(1, \"translate\");\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵtemplate(3, AddonCalendarEditEventPage_form_14_ion_select_25_ion_select_option_3_Template, 3, 4, \"ion-select-option\", 33);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"cancelText\", i0.ɵɵpipeBind1(1, 3, \"core.cancel\"))(\"interfaceOptions\", i0.ɵɵpureFunction1(7, _c1, i0.ɵɵpipeBind1(2, 5, \"addon.calendar.eventkind\")));\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r5.eventTypes);\n  }\n}\nfunction AddonCalendarEditEventPage_form_14_ion_item_26_ion_select_option_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-select-option\", 34);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const category_r17 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", category_r17.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", category_r17.name, \" \");\n  }\n}\nfunction AddonCalendarEditEventPage_form_14_ion_item_26_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-item\", 9)(1, \"ion-label\")(2, \"p\", 11);\n    i0.ɵɵtext(3);\n    i0.ɵɵpipe(4, \"translate\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"ion-select\", 35);\n    i0.ɵɵpipe(6, \"translate\");\n    i0.ɵɵpipe(7, \"translate\");\n    i0.ɵɵpipe(8, \"translate\");\n    i0.ɵɵtemplate(9, AddonCalendarEditEventPage_form_14_ion_item_26_ion_select_option_9_Template, 2, 2, \"ion-select-option\", 33);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r6 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"core-mark-required\", true);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(4, 6, \"core.category\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"placeholder\", i0.ɵɵpipeBind1(6, 8, \"core.noselection\"))(\"cancelText\", i0.ɵɵpipeBind1(7, 10, \"core.cancel\"))(\"interfaceOptions\", i0.ɵɵpureFunction1(14, _c1, i0.ɵɵpipeBind1(8, 12, \"core.category\")));\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r6.categories);\n  }\n}\nfunction AddonCalendarEditEventPage_form_14_ion_item_27_ion_select_option_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-select-option\", 34);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const course_r19 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", course_r19.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(course_r19.fullname);\n  }\n}\nfunction AddonCalendarEditEventPage_form_14_ion_item_27_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-item\", 9)(1, \"ion-label\")(2, \"p\", 11);\n    i0.ɵɵtext(3);\n    i0.ɵɵpipe(4, \"translate\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"ion-select\", 36);\n    i0.ɵɵpipe(6, \"translate\");\n    i0.ɵɵpipe(7, \"translate\");\n    i0.ɵɵpipe(8, \"translate\");\n    i0.ɵɵtemplate(9, AddonCalendarEditEventPage_form_14_ion_item_27_ion_select_option_9_Template, 2, 2, \"ion-select-option\", 33);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r7 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"core-mark-required\", true);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(4, 6, \"core.course\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"placeholder\", i0.ɵɵpipeBind1(6, 8, \"core.noselection\"))(\"cancelText\", i0.ɵɵpipeBind1(7, 10, \"core.cancel\"))(\"interfaceOptions\", i0.ɵɵpureFunction1(14, _c1, i0.ɵɵpipeBind1(8, 12, \"core.course\")));\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r7.courses);\n  }\n}\nfunction AddonCalendarEditEventPage_form_14_ng_container_28_ion_select_option_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-select-option\", 34);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const course_r24 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", course_r24.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", course_r24.fullname, \" \");\n  }\n}\nfunction AddonCalendarEditEventPage_form_14_ng_container_28_ion_item_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-item\", 40)(1, \"ion-label\")(2, \"p\");\n    i0.ɵɵtext(3);\n    i0.ɵɵpipe(4, \"translate\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(4, 1, \"core.coursenogroups\"));\n  }\n}\nfunction AddonCalendarEditEventPage_form_14_ng_container_28_ion_item_12_ion_select_option_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-select-option\", 34);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const group_r26 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", group_r26.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(group_r26.name);\n  }\n}\nfunction AddonCalendarEditEventPage_form_14_ng_container_28_ion_item_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-item\", 41)(1, \"ion-label\")(2, \"p\", 11);\n    i0.ɵɵtext(3);\n    i0.ɵɵpipe(4, \"translate\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"ion-select\", 42);\n    i0.ɵɵpipe(6, \"translate\");\n    i0.ɵɵpipe(7, \"translate\");\n    i0.ɵɵpipe(8, \"translate\");\n    i0.ɵɵtemplate(9, AddonCalendarEditEventPage_form_14_ng_container_28_ion_item_12_ion_select_option_9_Template, 2, 2, \"ion-select-option\", 33);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r22 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"core-mark-required\", true);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(4, 6, \"core.group\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"placeholder\", i0.ɵɵpipeBind1(6, 8, \"core.noselection\"))(\"cancelText\", i0.ɵɵpipeBind1(7, 10, \"core.cancel\"))(\"interfaceOptions\", i0.ɵɵpureFunction1(14, _c1, i0.ɵɵpipeBind1(8, 12, \"core.group\")));\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r22.groups);\n  }\n}\nfunction AddonCalendarEditEventPage_form_14_ng_container_28_ion_item_13_ion_spinner_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"ion-spinner\");\n    i0.ɵɵpipe(1, \"translate\");\n  }\n  if (rf & 2) {\n    i0.ɵɵattribute(\"aria-label\", i0.ɵɵpipeBind1(1, 1, \"core.loading\"));\n  }\n}\nfunction AddonCalendarEditEventPage_form_14_ng_container_28_ion_item_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-item\", 9)(1, \"ion-label\");\n    i0.ɵɵtemplate(2, AddonCalendarEditEventPage_form_14_ng_container_28_ion_item_13_ion_spinner_2_Template, 2, 3, \"ion-spinner\", 20);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r23 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r23.loadingGroups);\n  }\n}\nfunction AddonCalendarEditEventPage_form_14_ng_container_28_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r29 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"ion-item\", 9)(2, \"ion-label\")(3, \"p\", 11);\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"translate\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(6, \"ion-select\", 37);\n    i0.ɵɵlistener(\"ionChange\", function AddonCalendarEditEventPage_form_14_ng_container_28_Template_ion_select_ionChange_6_listener() {\n      i0.ɵɵrestoreView(_r29);\n      const ctx_r28 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r28.groupCourseSelected());\n    });\n    i0.ɵɵpipe(7, \"translate\");\n    i0.ɵɵpipe(8, \"translate\");\n    i0.ɵɵpipe(9, \"translate\");\n    i0.ɵɵtemplate(10, AddonCalendarEditEventPage_form_14_ng_container_28_ion_select_option_10_Template, 2, 2, \"ion-select-option\", 33);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(11, AddonCalendarEditEventPage_form_14_ng_container_28_ion_item_11_Template, 5, 3, \"ion-item\", 38);\n    i0.ɵɵtemplate(12, AddonCalendarEditEventPage_form_14_ng_container_28_ion_item_12_Template, 10, 16, \"ion-item\", 39);\n    i0.ɵɵtemplate(13, AddonCalendarEditEventPage_form_14_ng_container_28_ion_item_13_Template, 3, 1, \"ion-item\", 19);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r8 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"core-mark-required\", true);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(5, 9, \"core.course\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"placeholder\", i0.ɵɵpipeBind1(7, 11, \"core.noselection\"))(\"cancelText\", i0.ɵɵpipeBind1(8, 13, \"core.cancel\"))(\"interfaceOptions\", i0.ɵɵpureFunction1(17, _c1, i0.ɵɵpipeBind1(9, 15, \"core.course\")));\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r8.courses);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r8.loadingGroups && ctx_r8.courseGroupSet && !ctx_r8.groups.length);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r8.loadingGroups && ctx_r8.groups.length > 0);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r8.loadingGroups);\n  }\n}\nfunction AddonCalendarEditEventPage_form_14_ng_container_29_ion_item_9_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r33 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-item\", 9)(1, \"ion-label\")(2, \"p\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(4, \"ion-button\", 44);\n    i0.ɵɵlistener(\"click\", function AddonCalendarEditEventPage_form_14_ng_container_29_ion_item_9_Template_ion_button_click_4_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r33);\n      const reminder_r31 = restoredCtx.$implicit;\n      const ctx_r32 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r32.removeReminder(reminder_r31));\n    });\n    i0.ɵɵpipe(5, \"translate\");\n    i0.ɵɵelement(6, \"ion-icon\", 47);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const reminder_r31 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(reminder_r31.label);\n    i0.ɵɵadvance(1);\n    i0.ɵɵattribute(\"aria-label\", i0.ɵɵpipeBind1(5, 2, \"core.delete\"));\n  }\n}\nfunction AddonCalendarEditEventPage_form_14_ng_container_29_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r35 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"ion-item-divider\", 43)(2, \"ion-label\")(3, \"p\", 24);\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"translate\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(6, \"ion-button\", 44);\n    i0.ɵɵlistener(\"click\", function AddonCalendarEditEventPage_form_14_ng_container_29_Template_ion_button_click_6_listener() {\n      i0.ɵɵrestoreView(_r35);\n      const ctx_r34 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r34.addReminder());\n    });\n    i0.ɵɵpipe(7, \"translate\");\n    i0.ɵɵelement(8, \"ion-icon\", 45);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(9, AddonCalendarEditEventPage_form_14_ng_container_29_ion_item_9_Template, 7, 4, \"ion-item\", 46);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r9 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(5, 3, \"addon.calendar.reminders\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵattribute(\"aria-label\", i0.ɵɵpipeBind1(7, 5, \"addon.calendar.setnewreminder\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r9.reminders);\n  }\n}\nfunction AddonCalendarEditEventPage_form_14_ion_item_49_ng_template_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-datetime\", 49)(1, \"span\", 30);\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"translate\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r36 = i0.ɵɵnextContext(3);\n    i0.ɵɵproperty(\"max\", ctx_r36.maxDate)(\"min\", ctx_r36.minDate);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(3, 3, \"addon.calendar.durationuntil\"));\n  }\n}\nfunction AddonCalendarEditEventPage_form_14_ion_item_49_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-item\");\n    i0.ɵɵelement(1, \"ion-label\", 10)(2, \"ion-datetime-button\", 48);\n    i0.ɵɵelementStart(3, \"ion-modal\", 15);\n    i0.ɵɵtemplate(4, AddonCalendarEditEventPage_form_14_ion_item_49_ng_template_4_Template, 4, 5, \"ng-template\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"keepContentsMounted\", true);\n  }\n}\nfunction AddonCalendarEditEventPage_form_14_ion_item_56_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-item\")(1, \"ion-label\", 50);\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(4, \"ion-input\", 51);\n    i0.ɵɵpipe(5, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(3, 2, \"addon.calendar.durationminutes\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"placeholder\", i0.ɵɵpipeBind1(5, 4, \"addon.calendar.durationminutes\"));\n  }\n}\nfunction AddonCalendarEditEventPage_form_14_ng_container_57_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"ion-item\", 52)(2, \"ion-label\")(3, \"p\", 24);\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"translate\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelement(6, \"ion-checkbox\", 53);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"ion-item\", 9)(8, \"ion-label\", 10)(9, \"p\", 24);\n    i0.ɵɵtext(10);\n    i0.ɵɵpipe(11, \"translate\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelement(12, \"ion-input\", 54);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r12 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(5, 3, \"addon.calendar.repeatevent\"));\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(11, 5, \"addon.calendar.repeatweeksl\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"disabled\", !ctx_r12.form.controls.repeat.value);\n  }\n}\nconst _c2 = function (a0) {\n  return {\n    $a: a0\n  };\n};\nfunction AddonCalendarEditEventPage_form_14_div_58_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 21)(1, \"ion-radio-group\", 55)(2, \"ion-item-divider\", 23)(3, \"ion-label\")(4, \"p\", 24);\n    i0.ɵɵtext(5);\n    i0.ɵɵpipe(6, \"translate\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(7, \"ion-item\")(8, \"ion-label\")(9, \"p\");\n    i0.ɵɵtext(10);\n    i0.ɵɵpipe(11, \"translate\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelement(12, \"ion-radio\", 56);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"ion-item\")(14, \"ion-label\")(15, \"p\");\n    i0.ɵɵtext(16);\n    i0.ɵɵpipe(17, \"translate\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelement(18, \"ion-radio\", 57);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r13 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(6, 3, \"addon.calendar.repeatedevents\"));\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(11, 5, \"addon.calendar.repeateditall\", i0.ɵɵpureFunction1(10, _c2, ctx_r13.otherEventsCount)));\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(17, 8, \"addon.calendar.repeateditthis\"));\n  }\n}\nfunction AddonCalendarEditEventPage_form_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"form\", 7, 8)(2, \"ion-item\", 9)(3, \"ion-label\", 10)(4, \"p\", 11);\n    i0.ɵɵtext(5);\n    i0.ɵɵpipe(6, \"translate\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelement(7, \"ion-input\", 12);\n    i0.ɵɵpipe(8, \"translate\");\n    i0.ɵɵelement(9, \"core-input-errors\", 13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"ion-item\", 9)(11, \"ion-label\", 10)(12, \"p\", 11);\n    i0.ɵɵtext(13);\n    i0.ɵɵpipe(14, \"translate\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelement(15, \"ion-datetime-button\", 14);\n    i0.ɵɵelementStart(16, \"ion-modal\", 15);\n    i0.ɵɵtemplate(17, AddonCalendarEditEventPage_form_14_ng_template_17_Template, 4, 5, \"ng-template\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(18, \"core-input-errors\", 13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(19, \"ion-item\", 16)(20, \"ion-label\")(21, \"p\", 11);\n    i0.ɵɵtext(22);\n    i0.ɵɵpipe(23, \"translate\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(24, AddonCalendarEditEventPage_form_14_p_24_Template, 3, 3, \"p\", 17);\n    i0.ɵɵtemplate(25, AddonCalendarEditEventPage_form_14_ion_select_25_Template, 4, 9, \"ion-select\", 18);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(26, AddonCalendarEditEventPage_form_14_ion_item_26_Template, 10, 16, \"ion-item\", 19);\n    i0.ɵɵtemplate(27, AddonCalendarEditEventPage_form_14_ion_item_27_Template, 10, 16, \"ion-item\", 19);\n    i0.ɵɵtemplate(28, AddonCalendarEditEventPage_form_14_ng_container_28_Template, 14, 19, \"ng-container\", 20);\n    i0.ɵɵtemplate(29, AddonCalendarEditEventPage_form_14_ng_container_29_Template, 10, 7, \"ng-container\", 20);\n    i0.ɵɵelementStart(30, \"div\", 21)(31, \"ion-radio-group\", 22)(32, \"ion-item-divider\", 23)(33, \"ion-label\")(34, \"p\", 24);\n    i0.ɵɵtext(35);\n    i0.ɵɵpipe(36, \"translate\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(37, \"ion-item\")(38, \"ion-label\")(39, \"p\");\n    i0.ɵɵtext(40);\n    i0.ɵɵpipe(41, \"translate\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelement(42, \"ion-radio\", 25);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(43, \"ion-item\")(44, \"ion-label\")(45, \"p\");\n    i0.ɵɵtext(46);\n    i0.ɵɵpipe(47, \"translate\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelement(48, \"ion-radio\", 25);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(49, AddonCalendarEditEventPage_form_14_ion_item_49_Template, 5, 1, \"ion-item\", 20);\n    i0.ɵɵelementStart(50, \"ion-item\")(51, \"ion-label\")(52, \"p\");\n    i0.ɵɵtext(53);\n    i0.ɵɵpipe(54, \"translate\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelement(55, \"ion-radio\", 25);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(56, AddonCalendarEditEventPage_form_14_ion_item_56_Template, 6, 6, \"ion-item\", 20);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(57, AddonCalendarEditEventPage_form_14_ng_container_57_Template, 13, 7, \"ng-container\", 20);\n    i0.ɵɵtemplate(58, AddonCalendarEditEventPage_form_14_div_58_Template, 19, 12, \"div\", 26);\n    i0.ɵɵelementStart(59, \"ion-item\", 9)(60, \"ion-label\", 10)(61, \"p\", 24);\n    i0.ɵɵtext(62);\n    i0.ɵɵpipe(63, \"translate\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelement(64, \"core-rich-text-editor\", 27);\n    i0.ɵɵpipe(65, \"translate\");\n    i0.ɵɵpipe(66, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(67, \"ion-item\", 9)(68, \"ion-label\", 10)(69, \"p\", 24);\n    i0.ɵɵtext(70);\n    i0.ɵɵpipe(71, \"translate\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelement(72, \"ion-input\", 28);\n    i0.ɵɵpipe(73, \"translate\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"formGroup\", ctx_r0.form);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"core-mark-required\", true);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(6, 39, \"addon.calendar.eventname\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"placeholder\", i0.ɵɵpipeBind1(8, 41, \"addon.calendar.eventname\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"control\", ctx_r0.form.controls.name)(\"errorMessages\", ctx_r0.errors);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"core-mark-required\", true);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(14, 43, \"core.date\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"keepContentsMounted\", true);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"control\", ctx_r0.form.controls.timestart)(\"errorMessages\", ctx_r0.errors);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"core-mark-required\", true);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(23, 45, \"addon.calendar.eventkind\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.eventTypes.length === 1);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.eventTypes.length > 1);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.typeControl.value === \"category\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.typeControl.value === \"course\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.typeControl.value === \"group\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.remindersEnabled && !ctx_r0.eventId);\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(36, 47, \"addon.calendar.eventduration\"));\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(41, 49, \"addon.calendar.durationnone\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"value\", 0);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(47, 51, \"addon.calendar.durationuntil\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"value\", 1);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.form.controls.duration.value === 1);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(54, 53, \"addon.calendar.durationminutes\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"value\", 2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.form.controls.duration.value === 2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r0.eventId || ctx_r0.eventId < 0);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.eventRepeatId);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(63, 55, \"core.description\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"control\", ctx_r0.descriptionControl)(\"placeholder\", i0.ɵɵpipeBind1(66, 59, \"core.description\"))(\"component\", ctx_r0.component)(\"componentId\", ctx_r0.eventId)(\"autoSave\", false);\n    i0.ɵɵattribute(\"aria-label\", i0.ɵɵpipeBind1(65, 57, \"core.description\"));\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(71, 61, \"core.location\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"placeholder\", i0.ɵɵpipeBind1(73, 63, \"core.location\"));\n  }\n}\nfunction AddonCalendarEditEventPage_div_15_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r38 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 58)(1, \"div\", 59)(2, \"ion-button\", 60);\n    i0.ɵɵlistener(\"click\", function AddonCalendarEditEventPage_div_15_Template_ion_button_click_2_listener() {\n      i0.ɵɵrestoreView(_r38);\n      const ctx_r37 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r37.submit());\n    });\n    i0.ɵɵtext(3);\n    i0.ɵɵpipe(4, \"translate\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"disabled\", !ctx_r1.form.valid);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(4, 2, \"core.save\"), \" \");\n  }\n}\n/**\n * Page that displays a form to create/edit an event.\n */\nexport class AddonCalendarEditEventPage {\n  constructor(fb) {\n    this.fb = fb;\n    this.title = 'addon.calendar.newevent';\n    this.component = AddonCalendarProvider.COMPONENT;\n    this.loaded = false;\n    this.hasOffline = false;\n    this.eventTypes = [];\n    this.categories = [];\n    this.courses = [];\n    this.groups = [];\n    this.loadingGroups = false;\n    this.courseGroupSet = false;\n    this.error = false;\n    this.otherEventsCount = 0;\n    // Reminders.\n    this.remindersEnabled = false;\n    this.reminders = [];\n    this.types = {}; // Object with the supported types.\n    this.showAll = false;\n    this.isDestroyed = false;\n    this.gotEventData = false;\n    this.currentSite = CoreSites.getRequiredCurrentSite();\n    this.remindersEnabled = CoreReminders.isEnabled();\n    this.errors = {\n      required: Translate.instant('core.required')\n    };\n    this.form = new FormGroup({});\n    // Initialize form variables.\n    this.typeControl = this.fb.control('', Validators.required);\n    this.groupControl = this.fb.control('');\n    this.descriptionControl = this.fb.control('');\n    this.form.addControl('name', this.fb.control('', Validators.required));\n    this.form.addControl('eventtype', this.typeControl);\n    this.form.addControl('categoryid', this.fb.control(''));\n    this.form.addControl('groupcourseid', this.fb.control(''));\n    this.form.addControl('groupid', this.groupControl);\n    this.form.addControl('description', this.descriptionControl);\n    this.form.addControl('location', this.fb.control(''));\n    this.form.addControl('duration', this.fb.control(0));\n    this.form.addControl('timedurationminutes', this.fb.control(''));\n    this.form.addControl('repeat', this.fb.control(false));\n    this.form.addControl('repeats', this.fb.control('1'));\n    this.form.addControl('repeateditall', this.fb.control(1));\n    this.maxDate = CoreTimeUtils.getDatetimeDefaultMax();\n    this.minDate = CoreTimeUtils.getDatetimeDefaultMin();\n  }\n  /**\n   * @inheritdoc\n   */\n  ngOnInit() {\n    this.eventId = CoreNavigator.getRouteNumberParam('eventId') || undefined;\n    this.courseId = CoreNavigator.getRouteNumberParam('courseId') || 0;\n    this.title = this.eventId ? 'addon.calendar.editevent' : 'addon.calendar.newevent';\n    const timestamp = CoreNavigator.getRouteNumberParam('timestamp');\n    const currentDate = CoreTimeUtils.toDatetimeFormat(timestamp);\n    this.form.addControl('timestart', this.fb.control(currentDate, Validators.required));\n    this.form.addControl('timedurationuntil', this.fb.control(currentDate));\n    this.form.addControl('courseid', this.fb.control(this.courseId));\n    this.initReminders();\n    this.fetchData().finally(() => {\n      this.originalData = CoreUtils.clone(this.form.value);\n      this.loaded = true;\n    });\n  }\n  /**\n   * Fetch the data needed to render the form.\n   *\n   * @returns Promise resolved when done.\n   */\n  fetchData() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      _this.error = false;\n      // Get access info.\n      try {\n        const [types, accessInfo] = yield Promise.all([AddonCalendar.getAllowedEventTypes(_this.courseId), CoreUtils.ignoreErrors(AddonCalendar.getAccessInformation(_this.courseId), {\n          canmanageentries: false,\n          canmanageownentries: false,\n          canmanagegroupentries: false\n        })]);\n        _this.types = types;\n        const promises = [];\n        const eventTypes = AddonCalendarHelper.getEventTypeOptions(_this.types);\n        if (!eventTypes.length) {\n          throw new CoreError(Translate.instant('addon.calendar.nopermissiontoupdatecalendar'));\n        }\n        if (_this.eventId && !_this.gotEventData) {\n          // Editing an event, get the event data. Wait for sync first.\n          const eventId = _this.eventId;\n          promises.push(AddonCalendarSync.waitForSync(AddonCalendarSyncProvider.SYNC_ID).then( /*#__PURE__*/_asyncToGenerator(function* () {\n            // Do not block if the scope is already destroyed.\n            if (!_this.isDestroyed && _this.eventId) {\n              CoreSync.blockOperation(AddonCalendarProvider.COMPONENT, eventId);\n            }\n            let eventForm;\n            // Get the event offline data if there's any.\n            try {\n              eventForm = yield AddonCalendarOffline.getEvent(eventId);\n              _this.hasOffline = true;\n            } catch (_unused) {\n              // No offline data.\n              _this.hasOffline = false;\n            }\n            if (eventId > 0) {\n              // It's an online event. get its data from server.\n              const event = yield AddonCalendar.getEventById(eventId);\n              if (!eventForm) {\n                eventForm = event; // Use offline data first.\n              }\n\n              _this.eventRepeatId = event === null || event === void 0 ? void 0 : event.repeatid;\n              if (_this.eventRepeatId) {\n                _this.otherEventsCount = event.eventcount ? event.eventcount - 1 : 0;\n              }\n            }\n            _this.gotEventData = true;\n            if (eventForm) {\n              // Load the data in the form.\n              return _this.loadEventData(eventForm, _this.hasOffline);\n            }\n            return;\n          })));\n        }\n        if (_this.types.category) {\n          // Get the categories.\n          promises.push(_this.fetchCategories());\n        }\n        _this.showAll = CoreUtils.isTrueOrOne(_this.currentSite.getStoredConfig('calendar_adminseesall')) && accessInfo.canmanageentries;\n        if (_this.types.course || _this.types.groups) {\n          promises.push(_this.fetchCourses());\n        }\n        yield Promise.all(promises);\n        if (!_this.typeControl.value) {\n          // Initialize event type value. If course is allowed, select it first.\n          if (_this.types.course) {\n            _this.typeControl.setValue(AddonCalendarEventType.COURSE);\n          } else {\n            _this.typeControl.setValue(eventTypes[0].value);\n          }\n        }\n        _this.eventTypes = eventTypes;\n      } catch (error) {\n        CoreDomUtils.showErrorModalDefault(error, 'Error getting data.');\n        _this.error = true;\n      }\n    })();\n  }\n  fetchCategories() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      _this2.categories = yield CoreCourses.getCategories(0, true);\n    })();\n  }\n  fetchCourses() {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      // Get the courses.\n      let courses = yield _this3.showAll ? CoreCourses.getCoursesByField() : CoreCourses.getUserCourses();\n      if (courses.length < 0) {\n        _this3.courses = [];\n        return;\n      }\n      const courseFillFullname = /*#__PURE__*/function () {\n        var _ref2 = _asyncToGenerator(function* (course) {\n          try {\n            const result = yield CoreFilterHelper.getFiltersAndFormatText(course.fullname, 'course', course.id);\n            course.fullname = result.text;\n          } catch (_unused2) {\n            // Ignore errors.\n          }\n        });\n        return function courseFillFullname(_x) {\n          return _ref2.apply(this, arguments);\n        };\n      }();\n      if (_this3.showAll) {\n        // Remove site home from the list of courses.\n        const siteHomeId = CoreSites.getCurrentSiteHomeId();\n        if ('contacts' in courses[0]) {\n          courses = courses.filter(course => course.id != siteHomeId);\n        } else {\n          courses = courses.filter(course => course.id != siteHomeId);\n        }\n      }\n      // Format the name of the courses.\n      if ('contacts' in courses[0]) {\n        yield Promise.all(courses.map(courseFillFullname));\n      } else {\n        yield Promise.all(courses.map(courseFillFullname));\n      }\n      // Sort courses by name.\n      _this3.courses = courses.sort((a, b) => {\n        const compareA = a.fullname.toLowerCase();\n        const compareB = b.fullname.toLowerCase();\n        return compareA.localeCompare(compareB);\n      });\n    })();\n  }\n  /**\n   * Load an event data into the form.\n   *\n   * @param event Event data.\n   * @param isOffline Whether the data is from offline or not.\n   * @returns Promise resolved when done.\n   */\n  loadEventData(event, isOffline) {\n    var _this4 = this;\n    return _asyncToGenerator(function* () {\n      var _onlineEvent$course;\n      if (!event) {\n        return;\n      }\n      const offlineEvent = event;\n      const onlineEvent = event;\n      const courseId = isOffline ? offlineEvent.courseid : (_onlineEvent$course = onlineEvent.course) === null || _onlineEvent$course === void 0 ? void 0 : _onlineEvent$course.id;\n      _this4.form.controls.name.setValue(event.name);\n      _this4.form.controls.timestart.setValue(CoreTimeUtils.toDatetimeFormat(event.timestart * 1000));\n      _this4.form.controls.eventtype.setValue(event.eventtype);\n      _this4.form.controls.categoryid.setValue(event.categoryid || '');\n      _this4.form.controls.courseid.setValue(courseId || '');\n      _this4.form.controls.groupcourseid.setValue(courseId || '');\n      _this4.form.controls.groupid.setValue(event.groupid || '');\n      _this4.form.controls.description.setValue(event.description);\n      _this4.form.controls.location.setValue(event.location);\n      if (isOffline) {\n        // It's an offline event, use the data as it is.\n        _this4.form.controls.duration.setValue(offlineEvent.duration);\n        _this4.form.controls.timedurationuntil.setValue(CoreTimeUtils.toDatetimeFormat((offlineEvent.timedurationuntil || 0) * 1000 || Date.now()));\n        _this4.form.controls.timedurationminutes.setValue(offlineEvent.timedurationminutes || '');\n        _this4.form.controls.repeat.setValue(!!offlineEvent.repeat);\n        _this4.form.controls.repeats.setValue(offlineEvent.repeats || '1');\n        _this4.form.controls.repeateditall.setValue(offlineEvent.repeateditall || 1);\n      } else {\n        // Online event, we'll have to calculate the data.\n        if (onlineEvent.timeduration > 0) {\n          _this4.form.controls.duration.setValue(1);\n          _this4.form.controls.timedurationuntil.setValue(CoreTimeUtils.toDatetimeFormat((onlineEvent.timestart + onlineEvent.timeduration) * 1000));\n        } else {\n          // No duration.\n          _this4.form.controls.duration.setValue(0);\n          _this4.form.controls.timedurationuntil.setValue(CoreTimeUtils.toDatetimeFormat());\n        }\n        _this4.form.controls.timedurationminutes.setValue('');\n        _this4.form.controls.repeat.setValue(!!onlineEvent.repeatid);\n        _this4.form.controls.repeats.setValue(onlineEvent.eventcount || '1');\n        _this4.form.controls.repeateditall.setValue(1);\n      }\n      if (event.eventtype == AddonCalendarEventType.GROUP && courseId) {\n        yield _this4.loadGroups(courseId);\n      }\n    })();\n  }\n  /**\n   * Pull to refresh.\n   *\n   * @param refresher Refresher.\n   */\n  refreshData(refresher) {\n    const promises = [AddonCalendar.invalidateAccessInformation(this.courseId), AddonCalendar.invalidateAllowedEventTypes(this.courseId)];\n    if (this.types) {\n      if (this.types.category) {\n        promises.push(CoreCourses.invalidateCategories(0, true));\n      }\n      if (this.types.course || this.types.groups) {\n        if (this.showAll) {\n          promises.push(CoreCourses.invalidateCoursesByField());\n        } else {\n          promises.push(CoreCourses.invalidateUserCourses());\n        }\n      }\n    }\n    Promise.all(promises).finally(() => {\n      this.fetchData().finally(() => {\n        refresher === null || refresher === void 0 || refresher.complete();\n      });\n    });\n  }\n  /**\n   * A course was selected, get its groups.\n   */\n  groupCourseSelected() {\n    var _this5 = this;\n    return _asyncToGenerator(function* () {\n      const courseId = _this5.form.controls.groupcourseid.value;\n      if (!courseId) {\n        return;\n      }\n      const modal = yield CoreDomUtils.showModalLoading();\n      try {\n        yield _this5.loadGroups(courseId);\n        _this5.groupControl.setValue('');\n      } catch (error) {\n        CoreDomUtils.showErrorModalDefault(error, 'Error getting data.');\n      }\n      modal.dismiss();\n    })();\n  }\n  /**\n   * Load groups of a certain course.\n   *\n   * @param courseId Course ID.\n   * @returns Promise resolved when done.\n   */\n  loadGroups(courseId) {\n    var _this6 = this;\n    return _asyncToGenerator(function* () {\n      _this6.loadingGroups = true;\n      try {\n        _this6.groups = yield CoreGroups.getUserGroupsInCourse(courseId);\n        _this6.courseGroupSet = true;\n      } finally {\n        _this6.loadingGroups = false;\n      }\n    })();\n  }\n  selectDuration(duration) {\n    this.form.controls.duration.setValue(duration);\n  }\n  /**\n   * Create the event.\n   */\n  submit() {\n    var _this7 = this;\n    return _asyncToGenerator(function* () {\n      // Validate data.\n      const formData = _this7.form.value;\n      const timeStartDate = moment(formData.timestart).unix();\n      const timeUntilDate = moment(formData.timedurationuntil).unix();\n      const timeDurationMinutes = parseInt(formData.timedurationminutes || '', 10);\n      let error;\n      if (formData.eventtype === AddonCalendarEventType.COURSE && !formData.courseid) {\n        error = 'core.selectacourse';\n      } else if (formData.eventtype === AddonCalendarEventType.GROUP && !formData.groupcourseid) {\n        error = 'core.selectacourse';\n      } else if (formData.eventtype === AddonCalendarEventType.GROUP && !formData.groupid) {\n        error = 'core.selectagroup';\n      } else if (formData.eventtype === AddonCalendarEventType.CATEGORY && !formData.categoryid) {\n        error = 'core.selectacategory';\n      } else if (formData.duration === 1 && timeStartDate > timeUntilDate) {\n        error = 'addon.calendar.invalidtimedurationuntil';\n      } else if (formData.duration === 2 && (isNaN(timeDurationMinutes) || timeDurationMinutes < 1)) {\n        error = 'addon.calendar.invalidtimedurationminutes';\n      }\n      if (error) {\n        // Show error and stop.\n        CoreDomUtils.showErrorModal(Translate.instant(error));\n        return;\n      }\n      // Format the data to send.\n      const data = {\n        name: formData.name,\n        eventtype: formData.eventtype,\n        timestart: timeStartDate,\n        description: {\n          text: formData.description || '',\n          format: 1,\n          itemid: 0 // Files not supported yet.\n        },\n\n        location: formData.location,\n        duration: formData.duration,\n        repeat: formData.repeat\n      };\n      if (formData.eventtype == AddonCalendarEventType.COURSE) {\n        data.courseid = formData.courseid;\n      } else if (formData.eventtype == AddonCalendarEventType.GROUP) {\n        data.groupcourseid = formData.groupcourseid;\n        data.groupid = formData.groupid;\n      } else if (formData.eventtype == AddonCalendarEventType.CATEGORY) {\n        data.categoryid = formData.categoryid;\n      }\n      if (formData.duration == 1) {\n        data.timedurationuntil = timeUntilDate;\n      } else if (formData.duration == 2) {\n        data.timedurationminutes = formData.timedurationminutes;\n      }\n      if (formData.repeat) {\n        data.repeats = Number(formData.repeats);\n      }\n      if (_this7.eventRepeatId) {\n        data.repeatid = _this7.eventRepeatId;\n        data.repeateditall = formData.repeateditall;\n      }\n      // Send the data.\n      const modal = yield CoreDomUtils.showModalLoading('core.sending', true);\n      let event;\n      try {\n        const result = yield AddonCalendar.submitEvent(_this7.eventId, data, {\n          reminders: _this7.eventId ? [] : _this7.reminders // Only allow adding reminders for new events.\n        });\n\n        event = result.event;\n        CoreForms.triggerFormSubmittedEvent(_this7.formElement, result.sent, _this7.currentSite.getId());\n        if (result.sent) {\n          // Event created or edited, invalidate right days & months.\n          const numberOfRepetitions = formData.repeat ? formData.repeats : data.repeateditall && _this7.otherEventsCount ? _this7.otherEventsCount + 1 : 1;\n          try {\n            yield AddonCalendarHelper.refreshAfterChangeEvent(result.event, numberOfRepetitions);\n          } catch (_unused3) {\n            // Ignore errors.\n          }\n        }\n        _this7.returnToList(event);\n      } catch (error) {\n        CoreDomUtils.showErrorModalDefault(error, 'Error sending data.');\n      }\n      modal.dismiss();\n    })();\n  }\n  /**\n   * Convenience function to update or return to event list depending on device.\n   *\n   * @param event Event.\n   */\n  returnToList(event) {\n    // Unblock the sync because the view will be destroyed and the sync process could be triggered before ngOnDestroy.\n    this.unblockSync();\n    if (this.eventId && this.eventId > 0) {\n      // Editing an event.\n      CoreEvents.trigger(AddonCalendarProvider.EDIT_EVENT_EVENT, {\n        eventId: this.eventId\n      }, this.currentSite.getId());\n    } else {\n      CoreEvents.trigger(AddonCalendarProvider.NEW_EVENT_EVENT, {\n        eventId: event.id,\n        oldEventId: this.eventId\n      }, this.currentSite.getId());\n    }\n    this.originalData = undefined; // Avoid asking for confirmation.\n    CoreNavigator.back();\n  }\n  /**\n   * Check if we can leave the page or not.\n   *\n   * @returns Resolved with true if we can leave it, rejected if not.\n   */\n  canLeave() {\n    var _this8 = this;\n    return _asyncToGenerator(function* () {\n      if (AddonCalendarHelper.hasEventDataChanged(_this8.form.value, _this8.originalData)) {\n        // Show confirmation if some data has been modified.\n        yield CoreDomUtils.showConfirm(Translate.instant('core.confirmcanceledit'));\n      }\n      CoreForms.triggerFormCancelledEvent(_this8.formElement, _this8.currentSite.getId());\n      return true;\n    })();\n  }\n  /**\n   * Unblock sync.\n   */\n  unblockSync() {\n    if (this.eventId) {\n      CoreSync.unblockOperation(AddonCalendarProvider.COMPONENT, this.eventId);\n    }\n  }\n  /**\n   * Init reminders.\n   *\n   * @returns Promise resolved when done.\n   */\n  initReminders() {\n    var _this9 = this;\n    return _asyncToGenerator(function* () {\n      // Don't init reminders when editing an event. Right now, only allow adding reminders for new events.\n      if (!_this9.remindersEnabled || _this9.eventId) {\n        return;\n      }\n      // Check if default reminders are enabled.\n      const defaultTime = yield CoreReminders.getDefaultNotificationTime(_this9.currentSite.getId());\n      if (defaultTime === CoreRemindersService.DISABLED) {\n        return;\n      }\n      const data = CoreRemindersService.convertSecondsToValueAndUnit(defaultTime);\n      // Add default reminder.\n      _this9.reminders.push({\n        value: data.value,\n        unit: data.unit,\n        label: CoreReminders.getUnitValueLabel(data.value, data.unit, true)\n      });\n    })();\n  }\n  /**\n   * Add a reminder.\n   */\n  addReminder() {\n    var _this10 = this;\n    return _asyncToGenerator(function* () {\n      const formData = _this10.form.value;\n      const eventTime = moment(formData.timestart).unix();\n      const reminderTime = yield CoreDomUtils.openPopover({\n        component: CoreRemindersSetReminderMenuComponent,\n        componentProps: {\n          eventTime\n        }\n        // TODO: Add event to open the popover in place.\n      });\n\n      if (reminderTime === undefined) {\n        // User canceled.\n        return;\n      }\n      const data = CoreRemindersService.convertSecondsToValueAndUnit(reminderTime.timeBefore);\n      // Add reminder.\n      _this10.reminders.push({\n        time: reminderTime.timeBefore,\n        value: data.value,\n        unit: data.unit,\n        label: CoreReminders.getUnitValueLabel(data.value, data.unit)\n      });\n    })();\n  }\n  /**\n   * Remove a reminder.\n   *\n   * @param reminder The reminder to remove.\n   */\n  removeReminder(reminder) {\n    const index = this.reminders.indexOf(reminder);\n    if (index !== -1) {\n      this.reminders.splice(index, 1);\n    }\n  }\n  /**\n   * @inheritdoc\n   */\n  ngOnDestroy() {\n    this.unblockSync();\n    this.isDestroyed = true;\n  }\n}\n_class = AddonCalendarEditEventPage;\n_class.ɵfac = function AddonCalendarEditEventPage_Factory(t) {\n  return new (t || _class)(i0.ɵɵdirectiveInject(i1.FormBuilder));\n};\n_class.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: _class,\n  selectors: [[\"page-addon-calendar-edit-event\"]],\n  viewQuery: function AddonCalendarEditEventPage_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(CoreEditorRichTextEditorComponent, 5);\n      i0.ɵɵviewQuery(_c0, 5);\n    }\n    if (rf & 2) {\n      let _t;\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.descriptionEditor = _t.first);\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.formElement = _t.first);\n    }\n  },\n  decls: 16,\n  vars: 13,\n  consts: [[\"slot\", \"start\"], [3, \"text\"], [\"slot\", \"fixed\", 3, \"disabled\", \"ionRefresh\"], [3, \"pullingText\"], [3, \"hideUntil\"], [3, \"formGroup\", 4, \"ngIf\"], [\"collapsible-footer\", \"\", \"appearOnBottom\", \"\", \"slot\", \"fixed\", 4, \"ngIf\"], [3, \"formGroup\"], [\"editEventForm\", \"\"], [1, \"ion-text-wrap\"], [\"position\", \"stacked\"], [1, \"item-heading\", 3, \"core-mark-required\"], [\"type\", \"text\", \"name\", \"name\", \"formControlName\", \"name\", 3, \"placeholder\"], [3, \"control\", \"errorMessages\"], [\"datetime\", \"timestart\"], [3, \"keepContentsMounted\"], [1, \"ion-text-wrap\", \"addon-calendar-eventtype-container\"], [\"slot\", \"end\", 4, \"ngIf\"], [\"formControlName\", \"eventtype\", \"interface\", \"action-sheet\", 3, \"cancelText\", \"interfaceOptions\", 4, \"ngIf\"], [\"class\", \"ion-text-wrap\", 4, \"ngIf\"], [4, \"ngIf\"], [1, \"ion-text-wrap\", \"addon-calendar-radio-container\"], [\"formControlName\", \"duration\"], [1, \"addon-calendar-radio-title\"], [1, \"item-heading\"], [\"slot\", \"end\", 3, \"value\"], [\"class\", \"ion-text-wrap addon-calendar-radio-container\", 4, \"ngIf\"], [\"name\", \"description\", 3, \"control\", \"placeholder\", \"component\", \"componentId\", \"autoSave\"], [\"type\", \"text\", \"name\", \"location\", \"formControlName\", \"location\", 3, \"placeholder\"], [\"id\", \"timestart\", \"formControlName\", \"timestart\", \"presentation\", \"date-time\", 3, \"max\", \"min\"], [\"slot\", \"title\"], [\"slot\", \"end\"], [\"formControlName\", \"eventtype\", \"interface\", \"action-sheet\", 3, \"cancelText\", \"interfaceOptions\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [3, \"value\"], [\"formControlName\", \"categoryid\", \"interface\", \"action-sheet\", 3, \"placeholder\", \"cancelText\", \"interfaceOptions\"], [\"formControlName\", \"courseid\", \"interface\", \"action-sheet\", 3, \"placeholder\", \"cancelText\", \"interfaceOptions\"], [\"formControlName\", \"groupcourseid\", \"interface\", \"action-sheet\", 3, \"placeholder\", \"cancelText\", \"interfaceOptions\", \"ionChange\"], [\"class\", \"ion-text-wrap core-danger-item\", 4, \"ngIf\"], [\"class\", \"ion-text-wrap core-edit-set-group\", 4, \"ngIf\"], [1, \"ion-text-wrap\", \"core-danger-item\"], [1, \"ion-text-wrap\", \"core-edit-set-group\"], [\"formControlName\", \"groupid\", \"interface\", \"action-sheet\", 3, \"placeholder\", \"cancelText\", \"interfaceOptions\"], [1, \"addon-calendar-reminders-title\"], [\"fill\", \"clear\", \"slot\", \"end\", 3, \"click\"], [\"name\", \"fas-plus\", \"slot\", \"icon-only\", \"aria-hidden\", \"true\"], [\"class\", \"ion-text-wrap\", 4, \"ngFor\", \"ngForOf\"], [\"name\", \"fas-trash\", \"color\", \"danger\", \"slot\", \"icon-only\", \"aria-hidden\", \"true\"], [\"datetime\", \"timedurationuntil\"], [\"id\", \"timedurationuntil\", \"formControlName\", \"timedurationuntil\", \"presentation\", \"date-time\", 3, \"max\", \"min\"], [1, \"sr-only\"], [\"type\", \"number\", \"name\", \"timedurationminutes\", \"slot\", \"end\", \"formControlName\", \"timedurationminutes\", 3, \"placeholder\"], [1, \"ion-text-wrap\", \"divider\"], [\"slot\", \"end\", \"formControlName\", \"repeat\"], [\"type\", \"number\", \"name\", \"repeats\", \"formControlName\", \"repeats\", 3, \"disabled\"], [\"formControlName\", \"repeateditall\"], [\"slot\", \"end\", \"value\", \"1\"], [\"slot\", \"end\", \"value\", \"0\"], [\"collapsible-footer\", \"\", \"appearOnBottom\", \"\", \"slot\", \"fixed\"], [1, \"list-item-limited-width\", \"adaptable-buttons-row\"], [\"expand\", \"block\", \"type\", \"submit\", 1, \"ion-margin\", \"ion-text-wrap\", 3, \"disabled\", \"click\"]],\n  template: function AddonCalendarEditEventPage_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"ion-header\")(1, \"ion-toolbar\")(2, \"ion-buttons\", 0);\n      i0.ɵɵelement(3, \"ion-back-button\", 1);\n      i0.ɵɵpipe(4, \"translate\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(5, \"ion-title\")(6, \"h1\");\n      i0.ɵɵtext(7);\n      i0.ɵɵpipe(8, \"translate\");\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(9, \"ion-content\")(10, \"ion-refresher\", 2);\n      i0.ɵɵlistener(\"ionRefresh\", function AddonCalendarEditEventPage_Template_ion_refresher_ionRefresh_10_listener($event) {\n        return ctx.refreshData($event.target);\n      });\n      i0.ɵɵelement(11, \"ion-refresher-content\", 3);\n      i0.ɵɵpipe(12, \"translate\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(13, \"core-loading\", 4);\n      i0.ɵɵtemplate(14, AddonCalendarEditEventPage_form_14_Template, 74, 65, \"form\", 5);\n      i0.ɵɵtemplate(15, AddonCalendarEditEventPage_div_15_Template, 5, 4, \"div\", 6);\n      i0.ɵɵelementEnd()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"text\", i0.ɵɵpipeBind1(4, 7, \"core.back\"));\n      i0.ɵɵadvance(4);\n      i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(8, 9, ctx.title));\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"disabled\", !ctx.loaded);\n      i0.ɵɵadvance(1);\n      i0.ɵɵpropertyInterpolate(\"pullingText\", i0.ɵɵpipeBind1(12, 11, \"core.pulltorefresh\"));\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"hideUntil\", ctx.loaded);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", !ctx.error);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.loaded && !ctx.error);\n    }\n  },\n  dependencies: [i2.NgForOf, i2.NgIf, i3.CoreInputErrorsComponent, i4.CoreLoadingComponent, i5.CoreMarkRequiredComponent, i6.CoreFaIconDirective, i7.CoreCollapsibleFooterDirective, i8.CoreContentDirective, i9.CoreUpdateNonReactiveAttributesDirective, i1.ɵNgNoValidate, i1.NgControlStatus, i1.NgControlStatusGroup, i10.IonButton, i10.IonButtons, i10.IonCheckbox, i10.IonContent, i10.IonDatetime, i10.IonDatetimeButton, i10.IonHeader, i10.IonIcon, i10.IonInput, i10.IonItem, i10.IonItemDivider, i10.IonLabel, i10.IonRadio, i10.IonRadioGroup, i10.IonRefresher, i10.IonRefresherContent, i10.IonSelect, i10.IonSelectOption, i10.IonSpinner, i10.IonTitle, i10.IonToolbar, i10.IonModal, i10.BooleanValueAccessor, i10.NumericValueAccessor, i10.RadioValueAccessor, i10.SelectValueAccessor, i10.TextValueAccessor, i10.IonBackButton, i1.FormGroupDirective, i1.FormControlName, i11.CoreEditorRichTextEditorComponent, i12.TranslatePipe],\n  styles: [\"[_nghost-%COMP%]   .addon-calendar-eventtype-container.item-select-disabled[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%], [_nghost-%COMP%]   .addon-calendar-eventtype-container.item-select-disabled[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%] {\\n  opacity: 1;\\n}\\n[_nghost-%COMP%]   .addon-calendar-eventtype-container.item-select-disabled[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]::part(icon) {\\n  display: none;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hZGRvbnMvY2FsZW5kYXIvcGFnZXMvZWRpdC1ldmVudC9lZGl0LWV2ZW50LnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBRVE7RUFDSSxVQUFBO0FBRFo7QUFJUTtFQUNJLGFBQUE7QUFGWiIsInNvdXJjZXNDb250ZW50IjpbIjpob3N0IHtcbiAgICAuYWRkb24tY2FsZW5kYXItZXZlbnR0eXBlLWNvbnRhaW5lci5pdGVtLXNlbGVjdC1kaXNhYmxlZCB7XG4gICAgICAgIGlvbi1sYWJlbCwgaW9uLXNlbGVjdCB7XG4gICAgICAgICAgICBvcGFjaXR5OiAxO1xuICAgICAgICB9XG5cbiAgICAgICAgaW9uLXNlbGVjdDo6cGFydChpY29uKSB7XG4gICAgICAgICAgICBkaXNwbGF5OiBub25lO1xuICAgICAgICB9XG4gICAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ== */\"]\n});","map":{"version":3,"names":["FormGroup","Validators","CoreEvents","CoreGroups","CoreSites","CoreSync","CoreDomUtils","CoreTimeUtils","CoreUtils","CoreCourses","CoreEditorRichTextEditorComponent","AddonCalendarProvider","AddonCalendarEventType","AddonCalendar","AddonCalendarOffline","AddonCalendarHelper","AddonCalendarSync","AddonCalendarSyncProvider","Translate","CoreFilterHelper","CoreError","CoreNavigator","CoreForms","CoreReminders","CoreRemindersService","CoreRemindersSetReminderMenuComponent","moment","i0","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵproperty","ctx_r3","maxDate","minDate","ɵɵadvance","ɵɵtextInterpolate","ɵɵpipeBind1","ctx_r4","eventTypes","name","type_r15","value","ɵɵtextInterpolate1","ɵɵtemplate","AddonCalendarEditEventPage_form_14_ion_select_25_ion_select_option_3_Template","ɵɵpureFunction1","_c1","ctx_r5","category_r17","id","AddonCalendarEditEventPage_form_14_ion_item_26_ion_select_option_9_Template","ctx_r6","categories","course_r19","fullname","AddonCalendarEditEventPage_form_14_ion_item_27_ion_select_option_9_Template","ctx_r7","courses","course_r24","group_r26","AddonCalendarEditEventPage_form_14_ng_container_28_ion_item_12_ion_select_option_9_Template","ctx_r22","groups","ɵɵelement","ɵɵattribute","AddonCalendarEditEventPage_form_14_ng_container_28_ion_item_13_ion_spinner_2_Template","ctx_r23","loadingGroups","ɵɵelementContainerStart","ɵɵlistener","AddonCalendarEditEventPage_form_14_ng_container_28_Template_ion_select_ionChange_6_listener","ɵɵrestoreView","_r29","ctx_r28","ɵɵnextContext","ɵɵresetView","groupCourseSelected","AddonCalendarEditEventPage_form_14_ng_container_28_ion_select_option_10_Template","AddonCalendarEditEventPage_form_14_ng_container_28_ion_item_11_Template","AddonCalendarEditEventPage_form_14_ng_container_28_ion_item_12_Template","AddonCalendarEditEventPage_form_14_ng_container_28_ion_item_13_Template","ɵɵelementContainerEnd","ctx_r8","courseGroupSet","length","AddonCalendarEditEventPage_form_14_ng_container_29_ion_item_9_Template_ion_button_click_4_listener","restoredCtx","_r33","reminder_r31","$implicit","ctx_r32","removeReminder","label","AddonCalendarEditEventPage_form_14_ng_container_29_Template_ion_button_click_6_listener","_r35","ctx_r34","addReminder","AddonCalendarEditEventPage_form_14_ng_container_29_ion_item_9_Template","ctx_r9","reminders","ctx_r36","AddonCalendarEditEventPage_form_14_ion_item_49_ng_template_4_Template","ctx_r12","form","controls","repeat","ɵɵpipeBind2","_c2","ctx_r13","otherEventsCount","AddonCalendarEditEventPage_form_14_ng_template_17_Template","AddonCalendarEditEventPage_form_14_p_24_Template","AddonCalendarEditEventPage_form_14_ion_select_25_Template","AddonCalendarEditEventPage_form_14_ion_item_26_Template","AddonCalendarEditEventPage_form_14_ion_item_27_Template","AddonCalendarEditEventPage_form_14_ng_container_28_Template","AddonCalendarEditEventPage_form_14_ng_container_29_Template","AddonCalendarEditEventPage_form_14_ion_item_49_Template","AddonCalendarEditEventPage_form_14_ion_item_56_Template","AddonCalendarEditEventPage_form_14_ng_container_57_Template","AddonCalendarEditEventPage_form_14_div_58_Template","ctx_r0","errors","timestart","typeControl","remindersEnabled","eventId","duration","eventRepeatId","descriptionControl","component","AddonCalendarEditEventPage_div_15_Template_ion_button_click_2_listener","_r38","ctx_r37","submit","ctx_r1","valid","AddonCalendarEditEventPage","constructor","fb","title","COMPONENT","loaded","hasOffline","error","types","showAll","isDestroyed","gotEventData","currentSite","getRequiredCurrentSite","isEnabled","required","instant","control","groupControl","addControl","getDatetimeDefaultMax","getDatetimeDefaultMin","ngOnInit","getRouteNumberParam","undefined","courseId","timestamp","currentDate","toDatetimeFormat","initReminders","fetchData","finally","originalData","clone","_this","_asyncToGenerator","accessInfo","Promise","all","getAllowedEventTypes","ignoreErrors","getAccessInformation","canmanageentries","canmanageownentries","canmanagegroupentries","promises","getEventTypeOptions","push","waitForSync","SYNC_ID","then","blockOperation","eventForm","getEvent","_unused","event","getEventById","repeatid","eventcount","loadEventData","category","fetchCategories","isTrueOrOne","getStoredConfig","course","fetchCourses","setValue","COURSE","showErrorModalDefault","_this2","getCategories","_this3","getCoursesByField","getUserCourses","courseFillFullname","_ref2","result","getFiltersAndFormatText","text","_unused2","_x","apply","arguments","siteHomeId","getCurrentSiteHomeId","filter","map","sort","a","b","compareA","toLowerCase","compareB","localeCompare","isOffline","_this4","_onlineEvent$course","offlineEvent","onlineEvent","courseid","eventtype","categoryid","groupcourseid","groupid","description","location","timedurationuntil","Date","now","timedurationminutes","repeats","repeateditall","timeduration","GROUP","loadGroups","refreshData","refresher","invalidateAccessInformation","invalidateAllowedEventTypes","invalidateCategories","invalidateCoursesByField","invalidateUserCourses","complete","_this5","modal","showModalLoading","dismiss","_this6","getUserGroupsInCourse","selectDuration","_this7","formData","timeStartDate","unix","timeUntilDate","timeDurationMinutes","parseInt","CATEGORY","isNaN","showErrorModal","data","format","itemid","Number","submitEvent","triggerFormSubmittedEvent","formElement","sent","getId","numberOfRepetitions","refreshAfterChangeEvent","_unused3","returnToList","unblockSync","trigger","EDIT_EVENT_EVENT","NEW_EVENT_EVENT","oldEventId","back","canLeave","_this8","hasEventDataChanged","showConfirm","triggerFormCancelledEvent","unblockOperation","_this9","defaultTime","getDefaultNotificationTime","DISABLED","convertSecondsToValueAndUnit","unit","getUnitValueLabel","_this10","eventTime","reminderTime","openPopover","componentProps","timeBefore","time","reminder","index","indexOf","splice","ngOnDestroy","ɵɵdirectiveInject","i1","FormBuilder","selectors","viewQuery","AddonCalendarEditEventPage_Query","rf","ctx","AddonCalendarEditEventPage_Template_ion_refresher_ionRefresh_10_listener","$event","target","AddonCalendarEditEventPage_form_14_Template","AddonCalendarEditEventPage_div_15_Template","ɵɵpropertyInterpolate"],"sources":["/home/toon/works/gitionic7/ionic-github/ionic/src/addons/calendar/pages/edit-event/edit-event.ts","/home/toon/works/gitionic7/ionic-github/ionic/src/addons/calendar/pages/edit-event/edit-event.html"],"sourcesContent":["// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Component, OnInit, OnDestroy, ViewChild, ElementRef } from '@angular/core';\nimport { FormControl, FormGroup, FormBuilder, Validators } from '@angular/forms';\nimport { CoreEvents } from '@singletons/events';\nimport { CoreGroup, CoreGroups } from '@services/groups';\nimport { CoreSites } from '@services/sites';\nimport { CoreSync } from '@services/sync';\nimport { CoreDomUtils } from '@services/utils/dom';\nimport { CoreTimeUtils } from '@services/utils/time';\nimport { CoreUtils } from '@services/utils/utils';\nimport { CoreCategoryData, CoreCourses, CoreCourseSearchedData, CoreEnrolledCourseData } from '@features/courses/services/courses';\nimport { CoreEditorRichTextEditorComponent } from '@features/editor/components/rich-text-editor/rich-text-editor';\nimport {\n    AddonCalendarProvider,\n    AddonCalendarGetCalendarAccessInformationWSResponse,\n    AddonCalendarEvent,\n    AddonCalendarEventType,\n    AddonCalendar,\n    AddonCalendarSubmitCreateUpdateFormDataWSParams,\n} from '../../services/calendar';\nimport { AddonCalendarOffline } from '../../services/calendar-offline';\nimport { AddonCalendarEventTypeOption, AddonCalendarHelper } from '../../services/calendar-helper';\nimport { AddonCalendarSync, AddonCalendarSyncProvider } from '../../services/calendar-sync';\nimport { CoreSite } from '@classes/sites/site';\nimport { Translate } from '@singletons';\nimport { CoreFilterHelper } from '@features/filter/services/filter-helper';\nimport { AddonCalendarOfflineEventDBRecord } from '../../services/database/calendar-offline';\nimport { CoreError } from '@classes/errors/error';\nimport { CoreNavigator } from '@services/navigator';\nimport { CanLeave } from '@guards/can-leave';\nimport { CoreForms } from '@singletons/form';\nimport { CoreReminders, CoreRemindersService, CoreRemindersUnits } from '@features/reminders/services/reminders';\nimport { CoreRemindersSetReminderMenuComponent } from '@features/reminders/components/set-reminder-menu/set-reminder-menu';\nimport moment from 'moment-timezone';\n\n/**\n * Page that displays a form to create/edit an event.\n */\n@Component({\n    selector: 'page-addon-calendar-edit-event',\n    templateUrl: 'edit-event.html',\n    styleUrls: ['edit-event.scss'],\n})\nexport class AddonCalendarEditEventPage implements OnInit, OnDestroy, CanLeave {\n\n    @ViewChild(CoreEditorRichTextEditorComponent) descriptionEditor!: CoreEditorRichTextEditorComponent;\n    @ViewChild('editEventForm') formElement!: ElementRef;\n\n    title = 'addon.calendar.newevent';\n    component = AddonCalendarProvider.COMPONENT;\n    loaded = false;\n    hasOffline = false;\n    eventTypes: AddonCalendarEventTypeOption[] = [];\n    categories: CoreCategoryData[] = [];\n    courses: CoreCourseSearchedData[] | CoreEnrolledCourseData[] = [];\n    groups: CoreGroup[] = [];\n    loadingGroups = false;\n    courseGroupSet = false;\n    errors: Record<string, string>;\n    error = false;\n    eventRepeatId?: number;\n    otherEventsCount = 0;\n    eventId?: number;\n    maxDate: string;\n    minDate: string;\n\n    // Form variables.\n    form: FormGroup;\n    typeControl: FormControl;\n    groupControl: FormControl;\n    descriptionControl: FormControl;\n\n    // Reminders.\n    remindersEnabled = false;\n    reminders: AddonCalendarEventCandidateReminder[] = [];\n\n    protected courseId!: number;\n    protected originalData?: AddonCalendarOfflineEventDBRecord;\n    protected currentSite: CoreSite;\n    protected types: { [name: string]: boolean } = {}; // Object with the supported types.\n    protected showAll = false;\n    protected isDestroyed = false;\n    protected gotEventData = false;\n\n    constructor(\n        protected fb: FormBuilder,\n    ) {\n        this.currentSite = CoreSites.getRequiredCurrentSite();\n        this.remindersEnabled = CoreReminders.isEnabled();\n        this.errors = {\n            required: Translate.instant('core.required'),\n        };\n\n        this.form = new FormGroup({});\n\n        // Initialize form variables.\n        this.typeControl = this.fb.control('', Validators.required);\n        this.groupControl = this.fb.control('');\n        this.descriptionControl = this.fb.control('');\n        this.form.addControl('name', this.fb.control('', Validators.required));\n        this.form.addControl('eventtype', this.typeControl);\n        this.form.addControl('categoryid', this.fb.control(''));\n        this.form.addControl('groupcourseid', this.fb.control(''));\n        this.form.addControl('groupid', this.groupControl);\n        this.form.addControl('description', this.descriptionControl);\n        this.form.addControl('location', this.fb.control(''));\n        this.form.addControl('duration', this.fb.control(0));\n        this.form.addControl('timedurationminutes', this.fb.control(''));\n        this.form.addControl('repeat', this.fb.control(false));\n        this.form.addControl('repeats', this.fb.control('1'));\n        this.form.addControl('repeateditall', this.fb.control(1));\n\n        this.maxDate = CoreTimeUtils.getDatetimeDefaultMax();\n        this.minDate = CoreTimeUtils.getDatetimeDefaultMin();\n    }\n\n    /**\n     * @inheritdoc\n     */\n    ngOnInit(): void {\n        this.eventId = CoreNavigator.getRouteNumberParam('eventId') || undefined;\n        this.courseId = CoreNavigator.getRouteNumberParam('courseId') || 0;\n        this.title = this.eventId ? 'addon.calendar.editevent' : 'addon.calendar.newevent';\n\n        const timestamp = CoreNavigator.getRouteNumberParam('timestamp');\n        const currentDate = CoreTimeUtils.toDatetimeFormat(timestamp);\n        this.form.addControl('timestart', this.fb.control(currentDate, Validators.required));\n        this.form.addControl('timedurationuntil', this.fb.control(currentDate));\n        this.form.addControl('courseid', this.fb.control(this.courseId));\n\n        this.initReminders();\n        this.fetchData().finally(() => {\n            this.originalData = CoreUtils.clone(this.form.value);\n            this.loaded = true;\n        });\n    }\n\n    /**\n     * Fetch the data needed to render the form.\n     *\n     * @returns Promise resolved when done.\n     */\n    protected async fetchData(): Promise<void> {\n        this.error = false;\n\n        // Get access info.\n        try {\n            const [types, accessInfo] = await Promise.all([\n                AddonCalendar.getAllowedEventTypes(this.courseId),\n                CoreUtils.ignoreErrors(AddonCalendar.getAccessInformation(this.courseId), {\n                    canmanageentries: false,\n                    canmanageownentries: false,\n                    canmanagegroupentries: false,\n                } as AddonCalendarGetCalendarAccessInformationWSResponse),\n            ]);\n\n            this.types = types;\n\n            const promises: Promise<void>[] = [];\n            const eventTypes = AddonCalendarHelper.getEventTypeOptions(this.types);\n\n            if (!eventTypes.length) {\n                throw new CoreError(Translate.instant('addon.calendar.nopermissiontoupdatecalendar'));\n            }\n\n            if (this.eventId && !this.gotEventData) {\n                // Editing an event, get the event data. Wait for sync first.\n                const eventId = this.eventId;\n\n                promises.push(AddonCalendarSync.waitForSync(AddonCalendarSyncProvider.SYNC_ID).then(async () => {\n                    // Do not block if the scope is already destroyed.\n                    if (!this.isDestroyed && this.eventId) {\n                        CoreSync.blockOperation(AddonCalendarProvider.COMPONENT, eventId);\n                    }\n\n                    let eventForm: AddonCalendarEvent | AddonCalendarOfflineEventDBRecord | undefined;\n\n                    // Get the event offline data if there's any.\n                    try {\n                        eventForm = await AddonCalendarOffline.getEvent(eventId);\n\n                        this.hasOffline = true;\n                    } catch {\n                        // No offline data.\n                        this.hasOffline = false;\n                    }\n\n                    if (eventId > 0) {\n                        // It's an online event. get its data from server.\n                        const event = await AddonCalendar.getEventById(eventId);\n\n                        if (!eventForm) {\n                            eventForm = event; // Use offline data first.\n                        }\n\n                        this.eventRepeatId = event?.repeatid;\n                        if (this.eventRepeatId) {\n\n                            this.otherEventsCount = event.eventcount ? event.eventcount - 1 : 0;\n                        }\n                    }\n\n                    this.gotEventData = true;\n\n                    if (eventForm) {\n                        // Load the data in the form.\n                        return this.loadEventData(eventForm, this.hasOffline);\n                    }\n\n                    return;\n                }));\n            }\n\n            if (this.types.category) {\n                // Get the categories.\n                promises.push(this.fetchCategories());\n            }\n\n            this.showAll = CoreUtils.isTrueOrOne(this.currentSite.getStoredConfig('calendar_adminseesall')) &&\n                accessInfo.canmanageentries;\n\n            if (this.types.course || this.types.groups) {\n                promises.push(this.fetchCourses());\n            }\n            await Promise.all(promises);\n\n            if (!this.typeControl.value) {\n                // Initialize event type value. If course is allowed, select it first.\n                if (this.types.course) {\n                    this.typeControl.setValue(AddonCalendarEventType.COURSE);\n                } else {\n                    this.typeControl.setValue(eventTypes[0].value);\n                }\n            }\n\n            this.eventTypes = eventTypes;\n        } catch (error) {\n            CoreDomUtils.showErrorModalDefault(error, 'Error getting data.');\n            this.error = true;\n        }\n    }\n\n    protected async fetchCategories(): Promise<void> {\n        this.categories = await CoreCourses.getCategories(0, true);\n    }\n\n    protected async fetchCourses(): Promise<void> {\n        // Get the courses.\n        let courses = await (this.showAll ? CoreCourses.getCoursesByField() : CoreCourses.getUserCourses());\n\n        if (courses.length < 0) {\n            this.courses = [];\n\n            return;\n        }\n\n        const courseFillFullname = async (course: CoreCourseSearchedData | CoreEnrolledCourseData): Promise<void> => {\n            try {\n                const result = await CoreFilterHelper.getFiltersAndFormatText(course.fullname, 'course', course.id);\n                course.fullname = result.text;\n            } catch {\n                // Ignore errors.\n            }\n        };\n\n        if (this.showAll) {\n            // Remove site home from the list of courses.\n            const siteHomeId = CoreSites.getCurrentSiteHomeId();\n\n            if ('contacts' in courses[0]) {\n                courses = (courses as CoreCourseSearchedData[]).filter((course) => course.id != siteHomeId);\n            } else {\n                courses = (courses as CoreEnrolledCourseData[]).filter((course) => course.id != siteHomeId);\n            }\n        }\n\n        // Format the name of the courses.\n        if ('contacts' in courses[0]) {\n            await Promise.all((courses as CoreCourseSearchedData[]).map(courseFillFullname));\n        } else {\n            await Promise.all((courses as CoreEnrolledCourseData[]).map(courseFillFullname));\n        }\n\n        // Sort courses by name.\n        this.courses = courses.sort((a, b) => {\n            const compareA = a.fullname.toLowerCase();\n            const compareB = b.fullname.toLowerCase();\n\n            return compareA.localeCompare(compareB);\n        });\n\n    }\n\n    /**\n     * Load an event data into the form.\n     *\n     * @param event Event data.\n     * @param isOffline Whether the data is from offline or not.\n     * @returns Promise resolved when done.\n     */\n    protected async loadEventData(\n        event: AddonCalendarEvent | AddonCalendarOfflineEventDBRecord,\n        isOffline: boolean,\n    ): Promise<void> {\n        if (!event) {\n            return;\n        }\n\n        const offlineEvent = (event as AddonCalendarOfflineEventDBRecord);\n        const onlineEvent = (event as AddonCalendarEvent);\n\n        const courseId = isOffline ? offlineEvent.courseid : onlineEvent.course?.id;\n\n        this.form.controls.name.setValue(event.name);\n        this.form.controls.timestart.setValue(CoreTimeUtils.toDatetimeFormat(event.timestart * 1000));\n        this.form.controls.eventtype.setValue(event.eventtype);\n        this.form.controls.categoryid.setValue(event.categoryid || '');\n        this.form.controls.courseid.setValue(courseId || '');\n        this.form.controls.groupcourseid.setValue(courseId || '');\n        this.form.controls.groupid.setValue(event.groupid || '');\n        this.form.controls.description.setValue(event.description);\n        this.form.controls.location.setValue(event.location);\n\n        if (isOffline) {\n            // It's an offline event, use the data as it is.\n            this.form.controls.duration.setValue(offlineEvent.duration);\n            this.form.controls.timedurationuntil.setValue(\n                CoreTimeUtils.toDatetimeFormat(((offlineEvent.timedurationuntil || 0) * 1000) || Date.now()),\n            );\n            this.form.controls.timedurationminutes.setValue(offlineEvent.timedurationminutes || '');\n            this.form.controls.repeat.setValue(!!offlineEvent.repeat);\n            this.form.controls.repeats.setValue(offlineEvent.repeats || '1');\n            this.form.controls.repeateditall.setValue(offlineEvent.repeateditall || 1);\n        } else {\n            // Online event, we'll have to calculate the data.\n\n            if (onlineEvent.timeduration > 0) {\n                this.form.controls.duration.setValue(1);\n                this.form.controls.timedurationuntil.setValue(CoreTimeUtils.toDatetimeFormat(\n                    (onlineEvent.timestart + onlineEvent.timeduration) * 1000,\n                ));\n            } else {\n                // No duration.\n                this.form.controls.duration.setValue(0);\n                this.form.controls.timedurationuntil.setValue(CoreTimeUtils.toDatetimeFormat());\n            }\n\n            this.form.controls.timedurationminutes.setValue('');\n            this.form.controls.repeat.setValue(!!onlineEvent.repeatid);\n            this.form.controls.repeats.setValue(onlineEvent.eventcount || '1');\n            this.form.controls.repeateditall.setValue(1);\n        }\n\n        if (event.eventtype == AddonCalendarEventType.GROUP && courseId) {\n            await this.loadGroups(courseId);\n        }\n    }\n\n    /**\n     * Pull to refresh.\n     *\n     * @param refresher Refresher.\n     */\n    refreshData(refresher?: HTMLIonRefresherElement): void {\n        const promises = [\n            AddonCalendar.invalidateAccessInformation(this.courseId),\n            AddonCalendar.invalidateAllowedEventTypes(this.courseId),\n        ];\n\n        if (this.types) {\n            if (this.types.category) {\n                promises.push(CoreCourses.invalidateCategories(0, true));\n            }\n            if (this.types.course || this.types.groups) {\n                if (this.showAll) {\n                    promises.push(CoreCourses.invalidateCoursesByField());\n                } else {\n                    promises.push(CoreCourses.invalidateUserCourses());\n                }\n            }\n        }\n\n        Promise.all(promises).finally(() => {\n            this.fetchData().finally(() => {\n                refresher?.complete();\n            });\n        });\n    }\n\n    /**\n     * A course was selected, get its groups.\n     */\n    async groupCourseSelected(): Promise<void> {\n        const courseId = this.form.controls.groupcourseid.value;\n        if (!courseId) {\n            return;\n        }\n\n        const modal = await CoreDomUtils.showModalLoading();\n\n        try {\n            await this.loadGroups(courseId);\n\n            this.groupControl.setValue('');\n        } catch (error) {\n            CoreDomUtils.showErrorModalDefault(error, 'Error getting data.');\n        }\n\n        modal.dismiss();\n    }\n\n    /**\n     * Load groups of a certain course.\n     *\n     * @param courseId Course ID.\n     * @returns Promise resolved when done.\n     */\n    protected async loadGroups(courseId: number): Promise<void> {\n        this.loadingGroups = true;\n\n        try {\n            this.groups = await CoreGroups.getUserGroupsInCourse(courseId);\n            this.courseGroupSet = true;\n        } finally {\n            this.loadingGroups = false;\n        }\n    }\n\n    selectDuration(duration: string): void {\n        this.form.controls.duration.setValue(duration);\n    }\n\n    /**\n     * Create the event.\n     */\n    async submit(): Promise<void> {\n        // Validate data.\n        const formData = this.form.value;\n        const timeStartDate = moment(formData.timestart).unix();\n        const timeUntilDate = moment(formData.timedurationuntil).unix();\n        const timeDurationMinutes = parseInt(formData.timedurationminutes || '', 10);\n        let error: string | undefined;\n\n        if (formData.eventtype === AddonCalendarEventType.COURSE && !formData.courseid) {\n            error = 'core.selectacourse';\n        } else if (formData.eventtype === AddonCalendarEventType.GROUP && !formData.groupcourseid) {\n            error = 'core.selectacourse';\n        } else if (formData.eventtype === AddonCalendarEventType.GROUP && !formData.groupid) {\n            error = 'core.selectagroup';\n        } else if (formData.eventtype === AddonCalendarEventType.CATEGORY && !formData.categoryid) {\n            error = 'core.selectacategory';\n        } else if (formData.duration === 1 && timeStartDate > timeUntilDate) {\n            error = 'addon.calendar.invalidtimedurationuntil';\n        } else if (formData.duration === 2 && (isNaN(timeDurationMinutes) || timeDurationMinutes < 1)) {\n            error = 'addon.calendar.invalidtimedurationminutes';\n        }\n\n        if (error) {\n            // Show error and stop.\n            CoreDomUtils.showErrorModal(Translate.instant(error));\n\n            return;\n        }\n\n        // Format the data to send.\n        const data: AddonCalendarSubmitCreateUpdateFormDataWSParams = {\n            name: formData.name,\n            eventtype: formData.eventtype,\n            timestart: timeStartDate,\n            description: {\n                text: formData.description || '',\n                format: 1,\n                itemid: 0, // Files not supported yet.\n            },\n            location: formData.location,\n            duration: formData.duration,\n            repeat: formData.repeat,\n        };\n\n        if (formData.eventtype == AddonCalendarEventType.COURSE) {\n            data.courseid = formData.courseid;\n        } else if (formData.eventtype == AddonCalendarEventType.GROUP) {\n            data.groupcourseid = formData.groupcourseid;\n            data.groupid = formData.groupid;\n        } else if (formData.eventtype == AddonCalendarEventType.CATEGORY) {\n            data.categoryid = formData.categoryid;\n        }\n\n        if (formData.duration == 1) {\n            data.timedurationuntil = timeUntilDate;\n        } else if (formData.duration == 2) {\n            data.timedurationminutes = formData.timedurationminutes;\n        }\n\n        if (formData.repeat) {\n            data.repeats = Number(formData.repeats);\n        }\n\n        if (this.eventRepeatId) {\n            data.repeatid = this.eventRepeatId;\n            data.repeateditall = formData.repeateditall;\n        }\n\n        // Send the data.\n        const modal = await CoreDomUtils.showModalLoading('core.sending', true);\n        let event: AddonCalendarEvent | AddonCalendarOfflineEventDBRecord;\n\n        try {\n            const result = await AddonCalendar.submitEvent(this.eventId, data, {\n                reminders: this.eventId ? [] : this.reminders, // Only allow adding reminders for new events.\n            });\n            event = result.event;\n\n            CoreForms.triggerFormSubmittedEvent(this.formElement, result.sent, this.currentSite.getId());\n\n            if (result.sent) {\n                // Event created or edited, invalidate right days & months.\n                const numberOfRepetitions = formData.repeat\n                    ? formData.repeats\n                    : (data.repeateditall && this.otherEventsCount\n                        ? this.otherEventsCount + 1\n                        : 1);\n\n                try {\n                    await AddonCalendarHelper.refreshAfterChangeEvent(result.event, numberOfRepetitions);\n                } catch {\n                    // Ignore errors.\n                }\n            }\n\n            this.returnToList(event);\n        } catch (error) {\n            CoreDomUtils.showErrorModalDefault(error, 'Error sending data.');\n        }\n\n        modal.dismiss();\n    }\n\n    /**\n     * Convenience function to update or return to event list depending on device.\n     *\n     * @param event Event.\n     */\n    protected returnToList(event: AddonCalendarEvent | AddonCalendarOfflineEventDBRecord): void {\n        // Unblock the sync because the view will be destroyed and the sync process could be triggered before ngOnDestroy.\n        this.unblockSync();\n\n        if (this.eventId && this.eventId > 0) {\n            // Editing an event.\n            CoreEvents.trigger(\n                AddonCalendarProvider.EDIT_EVENT_EVENT,\n                { eventId: this.eventId },\n                this.currentSite.getId(),\n            );\n        } else {\n            CoreEvents.trigger(\n                AddonCalendarProvider.NEW_EVENT_EVENT,\n                {\n                    eventId: event.id,\n                    oldEventId: this.eventId,\n                },\n                this.currentSite.getId(),\n            );\n        }\n\n        this.originalData = undefined; // Avoid asking for confirmation.\n        CoreNavigator.back();\n    }\n\n    /**\n     * Check if we can leave the page or not.\n     *\n     * @returns Resolved with true if we can leave it, rejected if not.\n     */\n    async canLeave(): Promise<boolean> {\n        if (AddonCalendarHelper.hasEventDataChanged(this.form.value, this.originalData)) {\n            // Show confirmation if some data has been modified.\n            await CoreDomUtils.showConfirm(Translate.instant('core.confirmcanceledit'));\n        }\n\n        CoreForms.triggerFormCancelledEvent(this.formElement, this.currentSite.getId());\n\n        return true;\n    }\n\n    /**\n     * Unblock sync.\n     */\n    protected unblockSync(): void {\n        if (this.eventId) {\n            CoreSync.unblockOperation(AddonCalendarProvider.COMPONENT, this.eventId);\n        }\n    }\n\n    /**\n     * Init reminders.\n     *\n     * @returns Promise resolved when done.\n     */\n    protected async initReminders(): Promise<void> {\n        // Don't init reminders when editing an event. Right now, only allow adding reminders for new events.\n        if (!this.remindersEnabled || this.eventId) {\n            return;\n        }\n\n        // Check if default reminders are enabled.\n        const defaultTime = await CoreReminders.getDefaultNotificationTime(this.currentSite.getId());\n        if (defaultTime === CoreRemindersService.DISABLED) {\n            return;\n        }\n\n        const data = CoreRemindersService.convertSecondsToValueAndUnit(defaultTime);\n\n        // Add default reminder.\n        this.reminders.push({\n            value: data.value,\n            unit: data.unit,\n            label: CoreReminders.getUnitValueLabel(data.value, data.unit, true),\n        });\n    }\n\n    /**\n     * Add a reminder.\n     */\n    async addReminder(): Promise<void> {\n        const formData = this.form.value;\n        const eventTime = moment(formData.timestart).unix();\n\n        const reminderTime = await CoreDomUtils.openPopover<{timeBefore: number}>({\n            component: CoreRemindersSetReminderMenuComponent,\n            componentProps: {\n                eventTime,\n            },\n            // TODO: Add event to open the popover in place.\n        });\n\n        if (reminderTime === undefined) {\n            // User canceled.\n            return;\n        }\n\n        const data = CoreRemindersService.convertSecondsToValueAndUnit(reminderTime.timeBefore);\n\n        // Add reminder.\n        this.reminders.push({\n            time: reminderTime.timeBefore,\n            value: data.value,\n            unit: data.unit,\n            label: CoreReminders.getUnitValueLabel(data.value, data.unit),\n        });\n    }\n\n    /**\n     * Remove a reminder.\n     *\n     * @param reminder The reminder to remove.\n     */\n    removeReminder(reminder: AddonCalendarEventCandidateReminder): void {\n        const index = this.reminders.indexOf(reminder);\n        if (index !== -1) {\n            this.reminders.splice(index, 1);\n        }\n    }\n\n    /**\n     * @inheritdoc\n     */\n    ngOnDestroy(): void {\n        this.unblockSync();\n        this.isDestroyed = true;\n    }\n\n}\n\ntype AddonCalendarEventCandidateReminder =  {\n    time?: number; // Undefined for default reminder.\n    value: number; // Amount of time.\n    unit: CoreRemindersUnits; // Units.\n    label: string; // Label to represent the reminder.\n};\n","<ion-header>\n    <ion-toolbar>\n        <ion-buttons slot=\"start\">\n            <ion-back-button [text]=\"'core.back' | translate\" />\n        </ion-buttons>\n        <ion-title>\n            <h1>{{ title | translate }}</h1>\n        </ion-title>\n    </ion-toolbar>\n</ion-header>\n<ion-content>\n    <ion-refresher slot=\"fixed\" [disabled]=\"!loaded\" (ionRefresh)=\"refreshData($event.target)\">\n        <ion-refresher-content pullingText=\"{{ 'core.pulltorefresh' | translate }}\" />\n    </ion-refresher>\n\n    <core-loading [hideUntil]=\"loaded\">\n        <form [formGroup]=\"form\" *ngIf=\"!error\" #editEventForm>\n            <!-- Event name. -->\n            <ion-item class=\"ion-text-wrap\">\n                <ion-label position=\"stacked\">\n                    <p class=\"item-heading\" [core-mark-required]=\"true\">{{ 'addon.calendar.eventname' | translate }}</p>\n                </ion-label>\n                <ion-input type=\"text\" name=\"name\" [placeholder]=\"'addon.calendar.eventname' | translate\" formControlName=\"name\" />\n                <core-input-errors [control]=\"form.controls.name\" [errorMessages]=\"errors\" />\n            </ion-item>\n\n            <!-- Date. -->\n            <ion-item class=\"ion-text-wrap\">\n                <ion-label position=\"stacked\">\n                    <p class=\"item-heading\" [core-mark-required]=\"true\">{{ 'core.date' | translate }}</p>\n                </ion-label>\n                <ion-datetime-button datetime=\"timestart\" />\n                <ion-modal [keepContentsMounted]=\"true\">\n                    <ng-template>\n                        <ion-datetime id=\"timestart\" formControlName=\"timestart\" presentation=\"date-time\" [max]=\"maxDate\" [min]=\"minDate\">\n                            <span slot=\"title\">{{'core.date' | translate}}</span>\n                        </ion-datetime>\n                    </ng-template>\n                </ion-modal>\n                <core-input-errors [control]=\"form.controls.timestart\" [errorMessages]=\"errors\" />\n            </ion-item>\n\n            <!-- Type. -->\n            <ion-item class=\"ion-text-wrap addon-calendar-eventtype-container\">\n                <ion-label>\n                    <p class=\"item-heading\" [core-mark-required]=\"true\">{{ 'addon.calendar.eventkind' | translate }}</p>\n                </ion-label>\n                <p *ngIf=\"eventTypes.length === 1\" slot=\"end\">{{eventTypes[0].name | translate }}</p>\n                <ion-select *ngIf=\"eventTypes.length > 1\" formControlName=\"eventtype\" interface=\"action-sheet\"\n                    [cancelText]=\"'core.cancel' | translate\" [interfaceOptions]=\"{header: 'addon.calendar.eventkind' | translate}\">\n                    <ion-select-option *ngFor=\"let type of eventTypes\" [value]=\"type.value\">\n                        {{ type.name | translate }}\n                    </ion-select-option>\n                </ion-select>\n            </ion-item>\n\n            <!-- Category. -->\n            <ion-item class=\"ion-text-wrap\" *ngIf=\"typeControl.value === 'category'\">\n                <ion-label>\n                    <p class=\"item-heading\" [core-mark-required]=\"true\">{{ 'core.category' | translate }}</p>\n                </ion-label>\n                <ion-select formControlName=\"categoryid\" interface=\"action-sheet\" [placeholder]=\"'core.noselection' | translate\"\n                    [cancelText]=\"'core.cancel' | translate\" [interfaceOptions]=\"{header: 'core.category' | translate}\">\n                    <ion-select-option *ngFor=\"let category of categories\" [value]=\"category.id\">\n                        {{ category.name }}\n                    </ion-select-option>\n                </ion-select>\n            </ion-item>\n\n            <!-- Course. -->\n            <ion-item class=\"ion-text-wrap\" *ngIf=\"typeControl.value === 'course'\">\n                <ion-label>\n                    <p class=\"item-heading\" [core-mark-required]=\"true\">{{ 'core.course' | translate }}</p>\n                </ion-label>\n                <ion-select formControlName=\"courseid\" interface=\"action-sheet\" [placeholder]=\"'core.noselection' | translate\"\n                    [cancelText]=\"'core.cancel' | translate\" [interfaceOptions]=\"{header: 'core.course' | translate}\">\n                    <ion-select-option *ngFor=\"let course of courses\" [value]=\"course.id\">{{ course.fullname }}</ion-select-option>\n                </ion-select>\n            </ion-item>\n\n            <!-- Group. -->\n            <ng-container *ngIf=\"typeControl.value === 'group'\">\n                <!-- Select the course. -->\n                <ion-item class=\"ion-text-wrap\">\n                    <ion-label>\n                        <p class=\"item-heading\" [core-mark-required]=\"true\">{{ 'core.course' | translate }}</p>\n                    </ion-label>\n                    <ion-select formControlName=\"groupcourseid\" interface=\"action-sheet\" [placeholder]=\"'core.noselection' | translate\"\n                        [cancelText]=\"'core.cancel' | translate\" (ionChange)=\"groupCourseSelected()\"\n                        [interfaceOptions]=\"{header: 'core.course' | translate}\">\n                        <ion-select-option *ngFor=\"let course of courses\" [value]=\"course.id\">\n                            {{ course.fullname }}\n                        </ion-select-option>\n                    </ion-select>\n                </ion-item>\n                <!-- The course has no groups. -->\n                <ion-item class=\"ion-text-wrap core-danger-item\" *ngIf=\"!loadingGroups && courseGroupSet && !groups.length\">\n                    <ion-label>\n                        <p>{{ 'core.coursenogroups' | translate }}</p>\n                    </ion-label>\n                </ion-item>\n                <!-- Select the group. -->\n                <ion-item class=\"ion-text-wrap core-edit-set-group\" *ngIf=\"!loadingGroups && groups.length > 0\">\n                    <ion-label>\n                        <p class=\"item-heading\" [core-mark-required]=\"true\">{{ 'core.group' | translate }}</p>\n                    </ion-label>\n                    <ion-select formControlName=\"groupid\" interface=\"action-sheet\" [placeholder]=\"'core.noselection' | translate\"\n                        [cancelText]=\"'core.cancel' | translate\" [interfaceOptions]=\"{header: 'core.group' | translate}\">\n                        <ion-select-option *ngFor=\"let group of groups\" [value]=\"group.id\">{{ group.name }}</ion-select-option>\n                    </ion-select>\n                </ion-item>\n                <!-- Loading groups. -->\n                <ion-item class=\"ion-text-wrap\" *ngIf=\"loadingGroups\">\n                    <ion-label>\n                        <ion-spinner *ngIf=\"loadingGroups\" [attr.aria-label]=\"'core.loading' | translate\" />\n                    </ion-label>\n                </ion-item>\n            </ng-container>\n\n            <!-- Reminders. Right now, only allow adding them here for new events. -->\n            <ng-container *ngIf=\"remindersEnabled && !eventId\">\n                <ion-item-divider class=\"addon-calendar-reminders-title\">\n                    <ion-label>\n                        <p class=\"item-heading\">{{ 'addon.calendar.reminders' | translate }}</p>\n                    </ion-label>\n                    <ion-button fill=\"clear\" (click)=\"addReminder()\" slot=\"end\"\n                        [attr.aria-label]=\"'addon.calendar.setnewreminder' | translate\">\n                        <ion-icon name=\"fas-plus\" slot=\"icon-only\" aria-hidden=\"true\" />\n                    </ion-button>\n                </ion-item-divider>\n                <ion-item *ngFor=\"let reminder of reminders\" class=\"ion-text-wrap\">\n                    <ion-label>\n                        <p>{{ reminder.label }}</p>\n                    </ion-label>\n                    <ion-button fill=\"clear\" (click)=\"removeReminder(reminder)\" [attr.aria-label]=\"'core.delete' | translate\" slot=\"end\">\n                        <ion-icon name=\"fas-trash\" color=\"danger\" slot=\"icon-only\" aria-hidden=\"true\" />\n                    </ion-button>\n                </ion-item>\n            </ng-container>\n\n            <!-- Duration. -->\n            <div class=\"ion-text-wrap addon-calendar-radio-container\">\n                <ion-radio-group formControlName=\"duration\">\n                    <ion-item-divider class=\"addon-calendar-radio-title\">\n                        <ion-label>\n                            <p class=\"item-heading\">{{ 'addon.calendar.eventduration' | translate }}</p>\n                        </ion-label>\n                    </ion-item-divider>\n                    <ion-item>\n                        <ion-label>\n                            <p>{{ 'addon.calendar.durationnone' | translate }}</p>\n                        </ion-label>\n                        <ion-radio slot=\"end\" [value]=\"0\" />\n                    </ion-item>\n                    <ion-item>\n                        <ion-label>\n                            <p>{{ 'addon.calendar.durationuntil' | translate }}</p>\n                        </ion-label>\n                        <ion-radio slot=\"end\" [value]=\"1\" />\n                    </ion-item>\n                    <ion-item *ngIf=\"form.controls.duration.value === 1\">\n                        <ion-label position=\"stacked\" />\n                        <ion-datetime-button datetime=\"timedurationuntil\" />\n                        <ion-modal [keepContentsMounted]=\"true\">\n                            <ng-template>\n                                <ion-datetime id=\"timedurationuntil\" formControlName=\"timedurationuntil\" [max]=\"maxDate\" [min]=\"minDate\"\n                                    presentation=\"date-time\">\n                                    <span slot=\"title\">{{'addon.calendar.durationuntil' | translate}}</span>\n                                </ion-datetime>\n                            </ng-template>\n                        </ion-modal>\n                    </ion-item>\n                    <ion-item>\n                        <ion-label>\n                            <p>{{ 'addon.calendar.durationminutes' | translate }}</p>\n                        </ion-label>\n                        <ion-radio slot=\"end\" [value]=\"2\" />\n                    </ion-item>\n                    <ion-item *ngIf=\"form.controls.duration.value === 2\">\n                        <ion-label class=\"sr-only\">{{ 'addon.calendar.durationminutes' | translate }}</ion-label>\n                        <ion-input type=\"number\" name=\"timedurationminutes\" slot=\"end\"\n                            [placeholder]=\"'addon.calendar.durationminutes' | translate\" formControlName=\"timedurationminutes\" />\n                    </ion-item>\n                </ion-radio-group>\n            </div>\n\n            <!-- Repeat (for new events). -->\n            <ng-container *ngIf=\"!eventId || eventId < 0\">\n                <ion-item class=\"ion-text-wrap divider\">\n                    <ion-label>\n                        <p class=\"item-heading\">{{ 'addon.calendar.repeatevent' | translate }}</p>\n                    </ion-label>\n                    <ion-checkbox slot=\"end\" formControlName=\"repeat\" />\n                </ion-item>\n                <ion-item class=\"ion-text-wrap\">\n                    <ion-label position=\"stacked\">\n                        <p class=\"item-heading\">{{ 'addon.calendar.repeatweeksl' | translate }}</p>\n                    </ion-label>\n                    <ion-input type=\"number\" name=\"repeats\" formControlName=\"repeats\" [disabled]=\"!form.controls.repeat.value\" />\n                </ion-item>\n            </ng-container>\n\n            <!-- Apply to all events or just this one (editing repeated events). -->\n            <div *ngIf=\"eventRepeatId\" class=\"ion-text-wrap addon-calendar-radio-container\">\n                <ion-radio-group formControlName=\"repeateditall\">\n                    <ion-item-divider class=\"addon-calendar-radio-title\">\n                        <ion-label>\n                            <p class=\"item-heading\">{{ 'addon.calendar.repeatedevents' | translate }}</p>\n                        </ion-label>\n                    </ion-item-divider>\n                    <ion-item>\n                        <ion-label>\n                            <p>{{ 'addon.calendar.repeateditall' | translate:{$a: otherEventsCount} }}</p>\n                        </ion-label>\n                        <ion-radio slot=\"end\" value=\"1\" />\n                    </ion-item>\n                    <ion-item>\n                        <ion-label>\n                            <p>{{ 'addon.calendar.repeateditthis' | translate }}</p>\n                        </ion-label>\n                        <ion-radio slot=\"end\" value=\"0\" />\n                    </ion-item>\n                </ion-radio-group>\n            </div>\n\n            <!-- Description. -->\n            <ion-item class=\"ion-text-wrap\">\n                <ion-label position=\"stacked\">\n                    <p class=\"item-heading\">{{ 'core.description' | translate }}</p>\n                </ion-label>\n                <core-rich-text-editor [control]=\"descriptionControl\" [attr.aria-label]=\"'core.description' | translate\"\n                    [placeholder]=\"'core.description' | translate\" name=\"description\" [component]=\"component\" [componentId]=\"eventId\"\n                    [autoSave]=\"false\" />\n            </ion-item>\n\n            <!-- Location. -->\n            <ion-item class=\"ion-text-wrap\">\n                <ion-label position=\"stacked\">\n                    <p class=\"item-heading\">{{ 'core.location' | translate }}</p>\n                </ion-label>\n                <ion-input type=\"text\" name=\"location\" [placeholder]=\"'core.location' | translate\" formControlName=\"location\" />\n            </ion-item>\n        </form>\n        <div collapsible-footer appearOnBottom *ngIf=\"loaded && !error\" slot=\"fixed\">\n            <div class=\"list-item-limited-width adaptable-buttons-row\">\n                <ion-button expand=\"block\" (click)=\"submit()\" [disabled]=\"!form.valid\" type=\"submit\" class=\"ion-margin ion-text-wrap\">\n                    {{ 'core.save' | translate }}\n                </ion-button>\n            </div>\n        </div>\n    </core-loading>\n</ion-content>\n"],"mappings":";;AAeA,SAAsBA,SAAS,EAAeC,UAAU,QAAQ,gBAAgB;AAChF,SAASC,UAAU,QAAQ,oBAAoB;AAC/C,SAAoBC,UAAU,QAAQ,kBAAkB;AACxD,SAASC,SAAS,QAAQ,iBAAiB;AAC3C,SAASC,QAAQ,QAAQ,gBAAgB;AACzC,SAASC,YAAY,QAAQ,qBAAqB;AAClD,SAASC,aAAa,QAAQ,sBAAsB;AACpD,SAASC,SAAS,QAAQ,uBAAuB;AACjD,SAA2BC,WAAW,QAAwD,oCAAoC;AAClI,SAASC,iCAAiC,QAAQ,+DAA+D;AACjH,SACIC,qBAAqB,EAGrBC,sBAAsB,EACtBC,aAAa,QAEV,yBAAyB;AAChC,SAASC,oBAAoB,QAAQ,iCAAiC;AACtE,SAAuCC,mBAAmB,QAAQ,gCAAgC;AAClG,SAASC,iBAAiB,EAAEC,yBAAyB,QAAQ,8BAA8B;AAE3F,SAASC,SAAS,QAAQ,aAAa;AACvC,SAASC,gBAAgB,QAAQ,yCAAyC;AAE1E,SAASC,SAAS,QAAQ,uBAAuB;AACjD,SAASC,aAAa,QAAQ,qBAAqB;AAEnD,SAASC,SAAS,QAAQ,kBAAkB;AAC5C,SAASC,aAAa,EAAEC,oBAAoB,QAA4B,wCAAwC;AAChH,SAASC,qCAAqC,QAAQ,oEAAoE;AAC1H,OAAOC,MAAM,MAAM,iBAAiB;;;;;;;;;;;;;;;;;ICZZC,EAAA,CAAAC,cAAA,uBAAkH;IAC3FD,EAAA,CAAAE,MAAA,GAA2B;;IAAAF,EAAA,CAAAG,YAAA,EAAO;;;;IADyBH,EAAA,CAAAI,UAAA,QAAAC,MAAA,CAAAC,OAAA,CAAe,QAAAD,MAAA,CAAAE,OAAA;IAC1EP,EAAA,CAAAQ,SAAA,GAA2B;IAA3BR,EAAA,CAAAS,iBAAA,CAAAT,EAAA,CAAAU,WAAA,oBAA2B;;;;;IAY1DV,EAAA,CAAAC,cAAA,YAA8C;IAAAD,EAAA,CAAAE,MAAA,GAAmC;;IAAAF,EAAA,CAAAG,YAAA,EAAI;;;;IAAvCH,EAAA,CAAAQ,SAAA,GAAmC;IAAnCR,EAAA,CAAAS,iBAAA,CAAAT,EAAA,CAAAU,WAAA,OAAAC,MAAA,CAAAC,UAAA,IAAAC,IAAA,EAAmC;;;;;IAG7Eb,EAAA,CAAAC,cAAA,4BAAwE;IACpED,EAAA,CAAAE,MAAA,GACJ;;IAAAF,EAAA,CAAAG,YAAA,EAAoB;;;;IAF+BH,EAAA,CAAAI,UAAA,UAAAU,QAAA,CAAAC,KAAA,CAAoB;IACnEf,EAAA,CAAAQ,SAAA,GACJ;IADIR,EAAA,CAAAgB,kBAAA,MAAAhB,EAAA,CAAAU,WAAA,OAAAI,QAAA,CAAAD,IAAA,OACJ;;;;;;;;;;IAJJb,EAAA,CAAAC,cAAA,qBACmH;;;IAC/GD,EAAA,CAAAiB,UAAA,IAAAC,6EAAA,gCAEoB;IACxBlB,EAAA,CAAAG,YAAA,EAAa;;;;IAJTH,EAAA,CAAAI,UAAA,eAAAJ,EAAA,CAAAU,WAAA,sBAAwC,qBAAAV,EAAA,CAAAmB,eAAA,IAAAC,GAAA,EAAApB,EAAA,CAAAU,WAAA;IACJV,EAAA,CAAAQ,SAAA,GAAa;IAAbR,EAAA,CAAAI,UAAA,YAAAiB,MAAA,CAAAT,UAAA,CAAa;;;;;IAajDZ,EAAA,CAAAC,cAAA,4BAA6E;IACzED,EAAA,CAAAE,MAAA,GACJ;IAAAF,EAAA,CAAAG,YAAA,EAAoB;;;;IAFmCH,EAAA,CAAAI,UAAA,UAAAkB,YAAA,CAAAC,EAAA,CAAqB;IACxEvB,EAAA,CAAAQ,SAAA,GACJ;IADIR,EAAA,CAAAgB,kBAAA,MAAAM,YAAA,CAAAT,IAAA,MACJ;;;;;IARRb,EAAA,CAAAC,cAAA,kBAAyE;IAEbD,EAAA,CAAAE,MAAA,GAAiC;;IAAAF,EAAA,CAAAG,YAAA,EAAI;IAE7FH,EAAA,CAAAC,cAAA,qBACwG;;;;IACpGD,EAAA,CAAAiB,UAAA,IAAAO,2EAAA,gCAEoB;IACxBxB,EAAA,CAAAG,YAAA,EAAa;;;;IAPeH,EAAA,CAAAQ,SAAA,GAA2B;IAA3BR,EAAA,CAAAI,UAAA,4BAA2B;IAACJ,EAAA,CAAAQ,SAAA,GAAiC;IAAjCR,EAAA,CAAAS,iBAAA,CAAAT,EAAA,CAAAU,WAAA,wBAAiC;IAEvBV,EAAA,CAAAQ,SAAA,GAA8C;IAA9CR,EAAA,CAAAI,UAAA,gBAAAJ,EAAA,CAAAU,WAAA,2BAA8C,eAAAV,EAAA,CAAAU,WAAA,4CAAAV,EAAA,CAAAmB,eAAA,KAAAC,GAAA,EAAApB,EAAA,CAAAU,WAAA;IAEpEV,EAAA,CAAAQ,SAAA,GAAa;IAAbR,EAAA,CAAAI,UAAA,YAAAqB,MAAA,CAAAC,UAAA,CAAa;;;;;IAarD1B,EAAA,CAAAC,cAAA,4BAAsE;IAAAD,EAAA,CAAAE,MAAA,GAAqB;IAAAF,EAAA,CAAAG,YAAA,EAAoB;;;;IAA7DH,EAAA,CAAAI,UAAA,UAAAuB,UAAA,CAAAJ,EAAA,CAAmB;IAACvB,EAAA,CAAAQ,SAAA,GAAqB;IAArBR,EAAA,CAAAS,iBAAA,CAAAkB,UAAA,CAAAC,QAAA,CAAqB;;;;;IANnG5B,EAAA,CAAAC,cAAA,kBAAuE;IAEXD,EAAA,CAAAE,MAAA,GAA+B;;IAAAF,EAAA,CAAAG,YAAA,EAAI;IAE3FH,EAAA,CAAAC,cAAA,qBACsG;;;;IAClGD,EAAA,CAAAiB,UAAA,IAAAY,2EAAA,gCAA+G;IACnH7B,EAAA,CAAAG,YAAA,EAAa;;;;IALeH,EAAA,CAAAQ,SAAA,GAA2B;IAA3BR,EAAA,CAAAI,UAAA,4BAA2B;IAACJ,EAAA,CAAAQ,SAAA,GAA+B;IAA/BR,EAAA,CAAAS,iBAAA,CAAAT,EAAA,CAAAU,WAAA,sBAA+B;IAEvBV,EAAA,CAAAQ,SAAA,GAA8C;IAA9CR,EAAA,CAAAI,UAAA,gBAAAJ,EAAA,CAAAU,WAAA,2BAA8C,eAAAV,EAAA,CAAAU,WAAA,4CAAAV,EAAA,CAAAmB,eAAA,KAAAC,GAAA,EAAApB,EAAA,CAAAU,WAAA;IAEpEV,EAAA,CAAAQ,SAAA,GAAU;IAAVR,EAAA,CAAAI,UAAA,YAAA0B,MAAA,CAAAC,OAAA,CAAU;;;;;IAc5C/B,EAAA,CAAAC,cAAA,4BAAsE;IAClED,EAAA,CAAAE,MAAA,GACJ;IAAAF,EAAA,CAAAG,YAAA,EAAoB;;;;IAF8BH,EAAA,CAAAI,UAAA,UAAA4B,UAAA,CAAAT,EAAA,CAAmB;IACjEvB,EAAA,CAAAQ,SAAA,GACJ;IADIR,EAAA,CAAAgB,kBAAA,MAAAgB,UAAA,CAAAJ,QAAA,MACJ;;;;;IAIR5B,EAAA,CAAAC,cAAA,mBAA4G;IAEjGD,EAAA,CAAAE,MAAA,GAAuC;;IAAAF,EAAA,CAAAG,YAAA,EAAI;;;IAA3CH,EAAA,CAAAQ,SAAA,GAAuC;IAAvCR,EAAA,CAAAS,iBAAA,CAAAT,EAAA,CAAAU,WAAA,8BAAuC;;;;;IAU1CV,EAAA,CAAAC,cAAA,4BAAmE;IAAAD,EAAA,CAAAE,MAAA,GAAgB;IAAAF,EAAA,CAAAG,YAAA,EAAoB;;;;IAAvDH,EAAA,CAAAI,UAAA,UAAA6B,SAAA,CAAAV,EAAA,CAAkB;IAACvB,EAAA,CAAAQ,SAAA,GAAgB;IAAhBR,EAAA,CAAAS,iBAAA,CAAAwB,SAAA,CAAApB,IAAA,CAAgB;;;;;IAN3Fb,EAAA,CAAAC,cAAA,mBAAgG;IAEpCD,EAAA,CAAAE,MAAA,GAA8B;;IAAAF,EAAA,CAAAG,YAAA,EAAI;IAE1FH,EAAA,CAAAC,cAAA,qBACqG;;;;IACjGD,EAAA,CAAAiB,UAAA,IAAAiB,2FAAA,gCAAuG;IAC3GlC,EAAA,CAAAG,YAAA,EAAa;;;;IALeH,EAAA,CAAAQ,SAAA,GAA2B;IAA3BR,EAAA,CAAAI,UAAA,4BAA2B;IAACJ,EAAA,CAAAQ,SAAA,GAA8B;IAA9BR,EAAA,CAAAS,iBAAA,CAAAT,EAAA,CAAAU,WAAA,qBAA8B;IAEvBV,EAAA,CAAAQ,SAAA,GAA8C;IAA9CR,EAAA,CAAAI,UAAA,gBAAAJ,EAAA,CAAAU,WAAA,2BAA8C,eAAAV,EAAA,CAAAU,WAAA,4CAAAV,EAAA,CAAAmB,eAAA,KAAAC,GAAA,EAAApB,EAAA,CAAAU,WAAA;IAEpEV,EAAA,CAAAQ,SAAA,GAAS;IAATR,EAAA,CAAAI,UAAA,YAAA+B,OAAA,CAAAC,MAAA,CAAS;;;;;IAM9CpC,EAAA,CAAAqC,SAAA,kBAAoF;;;;IAAjDrC,EAAA,CAAAsC,WAAA,eAAAtC,EAAA,CAAAU,WAAA,uBAA8C;;;;;IAFzFV,EAAA,CAAAC,cAAA,kBAAsD;IAE9CD,EAAA,CAAAiB,UAAA,IAAAsB,qFAAA,0BAAoF;IACxFvC,EAAA,CAAAG,YAAA,EAAY;;;;IADMH,EAAA,CAAAQ,SAAA,GAAmB;IAAnBR,EAAA,CAAAI,UAAA,SAAAoC,OAAA,CAAAC,aAAA,CAAmB;;;;;;IAjC7CzC,EAAA,CAAA0C,uBAAA,GAAoD;IAEhD1C,EAAA,CAAAC,cAAA,kBAAgC;IAE4BD,EAAA,CAAAE,MAAA,GAA+B;;IAAAF,EAAA,CAAAG,YAAA,EAAI;IAE3FH,EAAA,CAAAC,cAAA,qBAE6D;IADhBD,EAAA,CAAA2C,UAAA,uBAAAC,4FAAA;MAAA5C,EAAA,CAAA6C,aAAA,CAAAC,IAAA;MAAA,MAAAC,OAAA,GAAA/C,EAAA,CAAAgD,aAAA;MAAA,OAAahD,EAAA,CAAAiD,WAAA,CAAAF,OAAA,CAAAG,mBAAA,EAAqB;IAAA,EAAC;;;;IAE5ElD,EAAA,CAAAiB,UAAA,KAAAkC,gFAAA,gCAEoB;IACxBnD,EAAA,CAAAG,YAAA,EAAa;IAGjBH,EAAA,CAAAiB,UAAA,KAAAmC,uEAAA,uBAIW;IAEXpD,EAAA,CAAAiB,UAAA,KAAAoC,uEAAA,yBAQW;IAEXrD,EAAA,CAAAiB,UAAA,KAAAqC,uEAAA,uBAIW;IACftD,EAAA,CAAAuD,qBAAA,EAAe;;;;IAhCqBvD,EAAA,CAAAQ,SAAA,GAA2B;IAA3BR,EAAA,CAAAI,UAAA,4BAA2B;IAACJ,EAAA,CAAAQ,SAAA,GAA+B;IAA/BR,EAAA,CAAAS,iBAAA,CAAAT,EAAA,CAAAU,WAAA,sBAA+B;IAElBV,EAAA,CAAAQ,SAAA,GAA8C;IAA9CR,EAAA,CAAAI,UAAA,gBAAAJ,EAAA,CAAAU,WAAA,4BAA8C,eAAAV,EAAA,CAAAU,WAAA,4CAAAV,EAAA,CAAAmB,eAAA,KAAAC,GAAA,EAAApB,EAAA,CAAAU,WAAA;IAGzEV,EAAA,CAAAQ,SAAA,GAAU;IAAVR,EAAA,CAAAI,UAAA,YAAAoD,MAAA,CAAAzB,OAAA,CAAU;IAMN/B,EAAA,CAAAQ,SAAA,GAAwD;IAAxDR,EAAA,CAAAI,UAAA,UAAAoD,MAAA,CAAAf,aAAA,IAAAe,MAAA,CAAAC,cAAA,KAAAD,MAAA,CAAApB,MAAA,CAAAsB,MAAA,CAAwD;IAMrD1D,EAAA,CAAAQ,SAAA,GAAyC;IAAzCR,EAAA,CAAAI,UAAA,UAAAoD,MAAA,CAAAf,aAAA,IAAAe,MAAA,CAAApB,MAAA,CAAAsB,MAAA,KAAyC;IAU7D1D,EAAA,CAAAQ,SAAA,GAAmB;IAAnBR,EAAA,CAAAI,UAAA,SAAAoD,MAAA,CAAAf,aAAA,CAAmB;;;;;;IAkBpDzC,EAAA,CAAAC,cAAA,kBAAmE;IAExDD,EAAA,CAAAE,MAAA,GAAoB;IAAAF,EAAA,CAAAG,YAAA,EAAI;IAE/BH,EAAA,CAAAC,cAAA,qBAAqH;IAA5FD,EAAA,CAAA2C,UAAA,mBAAAgB,mGAAA;MAAA,MAAAC,WAAA,GAAA5D,EAAA,CAAA6C,aAAA,CAAAgB,IAAA;MAAA,MAAAC,YAAA,GAAAF,WAAA,CAAAG,SAAA;MAAA,MAAAC,OAAA,GAAAhE,EAAA,CAAAgD,aAAA;MAAA,OAAShD,EAAA,CAAAiD,WAAA,CAAAe,OAAA,CAAAC,cAAA,CAAAH,YAAA,CAAwB;IAAA,EAAC;;IACvD9D,EAAA,CAAAqC,SAAA,mBAAgF;IACpFrC,EAAA,CAAAG,YAAA,EAAa;;;;IAJNH,EAAA,CAAAQ,SAAA,GAAoB;IAApBR,EAAA,CAAAS,iBAAA,CAAAqD,YAAA,CAAAI,KAAA,CAAoB;IAEiClE,EAAA,CAAAQ,SAAA,GAA6C;IAA7CR,EAAA,CAAAsC,WAAA,eAAAtC,EAAA,CAAAU,WAAA,sBAA6C;;;;;;IAdjHV,EAAA,CAAA0C,uBAAA,GAAmD;IAC/C1C,EAAA,CAAAC,cAAA,2BAAyD;IAEzBD,EAAA,CAAAE,MAAA,GAA4C;;IAAAF,EAAA,CAAAG,YAAA,EAAI;IAE5EH,EAAA,CAAAC,cAAA,qBACoE;IAD3CD,EAAA,CAAA2C,UAAA,mBAAAwB,wFAAA;MAAAnE,EAAA,CAAA6C,aAAA,CAAAuB,IAAA;MAAA,MAAAC,OAAA,GAAArE,EAAA,CAAAgD,aAAA;MAAA,OAAShD,EAAA,CAAAiD,WAAA,CAAAoB,OAAA,CAAAC,WAAA,EAAa;IAAA,EAAC;;IAE5CtE,EAAA,CAAAqC,SAAA,mBAAgE;IACpErC,EAAA,CAAAG,YAAA,EAAa;IAEjBH,EAAA,CAAAiB,UAAA,IAAAsD,sEAAA,uBAOW;IACfvE,EAAA,CAAAuD,qBAAA,EAAe;;;;IAfqBvD,EAAA,CAAAQ,SAAA,GAA4C;IAA5CR,EAAA,CAAAS,iBAAA,CAAAT,EAAA,CAAAU,WAAA,mCAA4C;IAGpEV,EAAA,CAAAQ,SAAA,GAA+D;IAA/DR,EAAA,CAAAsC,WAAA,eAAAtC,EAAA,CAAAU,WAAA,wCAA+D;IAIxCV,EAAA,CAAAQ,SAAA,GAAY;IAAZR,EAAA,CAAAI,UAAA,YAAAoE,MAAA,CAAAC,SAAA,CAAY;;;;;IAmC3BzE,EAAA,CAAAC,cAAA,uBAC6B;IACND,EAAA,CAAAE,MAAA,GAA8C;;IAAAF,EAAA,CAAAG,YAAA,EAAO;;;;IAFHH,EAAA,CAAAI,UAAA,QAAAsE,OAAA,CAAApE,OAAA,CAAe,QAAAoE,OAAA,CAAAnE,OAAA;IAEjEP,EAAA,CAAAQ,SAAA,GAA8C;IAA9CR,EAAA,CAAAS,iBAAA,CAAAT,EAAA,CAAAU,WAAA,uCAA8C;;;;;IAPjFV,EAAA,CAAAC,cAAA,eAAqD;IACjDD,EAAA,CAAAqC,SAAA,oBAAgC;IAEhCrC,EAAA,CAAAC,cAAA,oBAAwC;IACpCD,EAAA,CAAAiB,UAAA,IAAA0D,qEAAA,sBAKc;IAClB3E,EAAA,CAAAG,YAAA,EAAY;;;IAPDH,EAAA,CAAAQ,SAAA,GAA4B;IAA5BR,EAAA,CAAAI,UAAA,6BAA4B;;;;;IAe3CJ,EAAA,CAAAC,cAAA,eAAqD;IACtBD,EAAA,CAAAE,MAAA,GAAkD;;IAAAF,EAAA,CAAAG,YAAA,EAAY;IACzFH,EAAA,CAAAqC,SAAA,oBACyG;;IAC7GrC,EAAA,CAAAG,YAAA,EAAW;;;IAHoBH,EAAA,CAAAQ,SAAA,GAAkD;IAAlDR,EAAA,CAAAS,iBAAA,CAAAT,EAAA,CAAAU,WAAA,yCAAkD;IAEzEV,EAAA,CAAAQ,SAAA,GAA4D;IAA5DR,EAAA,CAAAI,UAAA,gBAAAJ,EAAA,CAAAU,WAAA,yCAA4D;;;;;IAM5EV,EAAA,CAAA0C,uBAAA,GAA8C;IAC1C1C,EAAA,CAAAC,cAAA,mBAAwC;IAERD,EAAA,CAAAE,MAAA,GAA8C;;IAAAF,EAAA,CAAAG,YAAA,EAAI;IAE9EH,EAAA,CAAAqC,SAAA,uBAAoD;IACxDrC,EAAA,CAAAG,YAAA,EAAW;IACXH,EAAA,CAAAC,cAAA,kBAAgC;IAEAD,EAAA,CAAAE,MAAA,IAA+C;;IAAAF,EAAA,CAAAG,YAAA,EAAI;IAE/EH,EAAA,CAAAqC,SAAA,qBAA6G;IACjHrC,EAAA,CAAAG,YAAA,EAAW;IACfH,EAAA,CAAAuD,qBAAA,EAAe;;;;IAVqBvD,EAAA,CAAAQ,SAAA,GAA8C;IAA9CR,EAAA,CAAAS,iBAAA,CAAAT,EAAA,CAAAU,WAAA,qCAA8C;IAM9CV,EAAA,CAAAQ,SAAA,GAA+C;IAA/CR,EAAA,CAAAS,iBAAA,CAAAT,EAAA,CAAAU,WAAA,uCAA+C;IAETV,EAAA,CAAAQ,SAAA,GAAwC;IAAxCR,EAAA,CAAAI,UAAA,cAAAwE,OAAA,CAAAC,IAAA,CAAAC,QAAA,CAAAC,MAAA,CAAAhE,KAAA,CAAwC;;;;;;;;;;IAKlHf,EAAA,CAAAC,cAAA,cAAgF;IAIxCD,EAAA,CAAAE,MAAA,GAAiD;;IAAAF,EAAA,CAAAG,YAAA,EAAI;IAGrFH,EAAA,CAAAC,cAAA,eAAU;IAECD,EAAA,CAAAE,MAAA,IAAuE;;IAAAF,EAAA,CAAAG,YAAA,EAAI;IAElFH,EAAA,CAAAqC,SAAA,qBAAkC;IACtCrC,EAAA,CAAAG,YAAA,EAAW;IACXH,EAAA,CAAAC,cAAA,gBAAU;IAECD,EAAA,CAAAE,MAAA,IAAiD;;IAAAF,EAAA,CAAAG,YAAA,EAAI;IAE5DH,EAAA,CAAAqC,SAAA,qBAAkC;IACtCrC,EAAA,CAAAG,YAAA,EAAW;;;;IAdqBH,EAAA,CAAAQ,SAAA,GAAiD;IAAjDR,EAAA,CAAAS,iBAAA,CAAAT,EAAA,CAAAU,WAAA,wCAAiD;IAKtEV,EAAA,CAAAQ,SAAA,GAAuE;IAAvER,EAAA,CAAAS,iBAAA,CAAAT,EAAA,CAAAgF,WAAA,wCAAAhF,EAAA,CAAAmB,eAAA,KAAA8D,GAAA,EAAAC,OAAA,CAAAC,gBAAA,GAAuE;IAMvEnF,EAAA,CAAAQ,SAAA,GAAiD;IAAjDR,EAAA,CAAAS,iBAAA,CAAAT,EAAA,CAAAU,WAAA,yCAAiD;;;;;IA1MxEV,EAAA,CAAAC,cAAA,iBAAuD;IAISD,EAAA,CAAAE,MAAA,GAA4C;;IAAAF,EAAA,CAAAG,YAAA,EAAI;IAExGH,EAAA,CAAAqC,SAAA,oBAAmH;;IACnHrC,EAAA,CAAAqC,SAAA,4BAA6E;IACjFrC,EAAA,CAAAG,YAAA,EAAW;IAGXH,EAAA,CAAAC,cAAA,mBAAgC;IAE4BD,EAAA,CAAAE,MAAA,IAA6B;;IAAAF,EAAA,CAAAG,YAAA,EAAI;IAEzFH,EAAA,CAAAqC,SAAA,+BAA4C;IAC5CrC,EAAA,CAAAC,cAAA,qBAAwC;IACpCD,EAAA,CAAAiB,UAAA,KAAAmE,0DAAA,sBAIc;IAClBpF,EAAA,CAAAG,YAAA,EAAY;IACZH,EAAA,CAAAqC,SAAA,6BAAkF;IACtFrC,EAAA,CAAAG,YAAA,EAAW;IAGXH,EAAA,CAAAC,cAAA,oBAAmE;IAEPD,EAAA,CAAAE,MAAA,IAA4C;;IAAAF,EAAA,CAAAG,YAAA,EAAI;IAExGH,EAAA,CAAAiB,UAAA,KAAAoE,gDAAA,gBAAqF;IACrFrF,EAAA,CAAAiB,UAAA,KAAAqE,yDAAA,yBAKa;IACjBtF,EAAA,CAAAG,YAAA,EAAW;IAGXH,EAAA,CAAAiB,UAAA,KAAAsE,uDAAA,yBAUW;IAGXvF,EAAA,CAAAiB,UAAA,KAAAuE,uDAAA,yBAQW;IAGXxF,EAAA,CAAAiB,UAAA,KAAAwE,2DAAA,6BAoCe;IAGfzF,EAAA,CAAAiB,UAAA,KAAAyE,2DAAA,4BAkBe;IAGf1F,EAAA,CAAAC,cAAA,eAA0D;IAIlBD,EAAA,CAAAE,MAAA,IAAgD;;IAAAF,EAAA,CAAAG,YAAA,EAAI;IAGpFH,EAAA,CAAAC,cAAA,gBAAU;IAECD,EAAA,CAAAE,MAAA,IAA+C;;IAAAF,EAAA,CAAAG,YAAA,EAAI;IAE1DH,EAAA,CAAAqC,SAAA,qBAAoC;IACxCrC,EAAA,CAAAG,YAAA,EAAW;IACXH,EAAA,CAAAC,cAAA,gBAAU;IAECD,EAAA,CAAAE,MAAA,IAAgD;;IAAAF,EAAA,CAAAG,YAAA,EAAI;IAE3DH,EAAA,CAAAqC,SAAA,qBAAoC;IACxCrC,EAAA,CAAAG,YAAA,EAAW;IACXH,EAAA,CAAAiB,UAAA,KAAA0E,uDAAA,uBAWW;IACX3F,EAAA,CAAAC,cAAA,gBAAU;IAECD,EAAA,CAAAE,MAAA,IAAkD;;IAAAF,EAAA,CAAAG,YAAA,EAAI;IAE7DH,EAAA,CAAAqC,SAAA,qBAAoC;IACxCrC,EAAA,CAAAG,YAAA,EAAW;IACXH,EAAA,CAAAiB,UAAA,KAAA2E,uDAAA,uBAIW;IACf5F,EAAA,CAAAG,YAAA,EAAkB;IAItBH,EAAA,CAAAiB,UAAA,KAAA4E,2DAAA,4BAae;IAGf7F,EAAA,CAAAiB,UAAA,KAAA6E,kDAAA,oBAoBM;IAGN9F,EAAA,CAAAC,cAAA,mBAAgC;IAEAD,EAAA,CAAAE,MAAA,IAAoC;;IAAAF,EAAA,CAAAG,YAAA,EAAI;IAEpEH,EAAA,CAAAqC,SAAA,iCAEyB;;;IAC7BrC,EAAA,CAAAG,YAAA,EAAW;IAGXH,EAAA,CAAAC,cAAA,mBAAgC;IAEAD,EAAA,CAAAE,MAAA,IAAiC;;IAAAF,EAAA,CAAAG,YAAA,EAAI;IAEjEH,EAAA,CAAAqC,SAAA,qBAAgH;;IACpHrC,EAAA,CAAAG,YAAA,EAAW;;;;IAjOTH,EAAA,CAAAI,UAAA,cAAA2F,MAAA,CAAAlB,IAAA,CAAkB;IAIY7E,EAAA,CAAAQ,SAAA,GAA2B;IAA3BR,EAAA,CAAAI,UAAA,4BAA2B;IAACJ,EAAA,CAAAQ,SAAA,GAA4C;IAA5CR,EAAA,CAAAS,iBAAA,CAAAT,EAAA,CAAAU,WAAA,oCAA4C;IAEjEV,EAAA,CAAAQ,SAAA,GAAsD;IAAtDR,EAAA,CAAAI,UAAA,gBAAAJ,EAAA,CAAAU,WAAA,oCAAsD;IACtEV,EAAA,CAAAQ,SAAA,GAA8B;IAA9BR,EAAA,CAAAI,UAAA,YAAA2F,MAAA,CAAAlB,IAAA,CAAAC,QAAA,CAAAjE,IAAA,CAA8B,kBAAAkF,MAAA,CAAAC,MAAA;IAMrBhG,EAAA,CAAAQ,SAAA,GAA2B;IAA3BR,EAAA,CAAAI,UAAA,4BAA2B;IAACJ,EAAA,CAAAQ,SAAA,GAA6B;IAA7BR,EAAA,CAAAS,iBAAA,CAAAT,EAAA,CAAAU,WAAA,sBAA6B;IAG1EV,EAAA,CAAAQ,SAAA,GAA4B;IAA5BR,EAAA,CAAAI,UAAA,6BAA4B;IAOpBJ,EAAA,CAAAQ,SAAA,GAAmC;IAAnCR,EAAA,CAAAI,UAAA,YAAA2F,MAAA,CAAAlB,IAAA,CAAAC,QAAA,CAAAmB,SAAA,CAAmC,kBAAAF,MAAA,CAAAC,MAAA;IAM1BhG,EAAA,CAAAQ,SAAA,GAA2B;IAA3BR,EAAA,CAAAI,UAAA,4BAA2B;IAACJ,EAAA,CAAAQ,SAAA,GAA4C;IAA5CR,EAAA,CAAAS,iBAAA,CAAAT,EAAA,CAAAU,WAAA,qCAA4C;IAEhGV,EAAA,CAAAQ,SAAA,GAA6B;IAA7BR,EAAA,CAAAI,UAAA,SAAA2F,MAAA,CAAAnF,UAAA,CAAA8C,MAAA,OAA6B;IACpB1D,EAAA,CAAAQ,SAAA,GAA2B;IAA3BR,EAAA,CAAAI,UAAA,SAAA2F,MAAA,CAAAnF,UAAA,CAAA8C,MAAA,KAA2B;IASX1D,EAAA,CAAAQ,SAAA,GAAsC;IAAtCR,EAAA,CAAAI,UAAA,SAAA2F,MAAA,CAAAG,WAAA,CAAAnF,KAAA,gBAAsC;IAatCf,EAAA,CAAAQ,SAAA,GAAoC;IAApCR,EAAA,CAAAI,UAAA,SAAA2F,MAAA,CAAAG,WAAA,CAAAnF,KAAA,cAAoC;IAWtDf,EAAA,CAAAQ,SAAA,GAAmC;IAAnCR,EAAA,CAAAI,UAAA,SAAA2F,MAAA,CAAAG,WAAA,CAAAnF,KAAA,aAAmC;IAuCnCf,EAAA,CAAAQ,SAAA,GAAkC;IAAlCR,EAAA,CAAAI,UAAA,SAAA2F,MAAA,CAAAI,gBAAA,KAAAJ,MAAA,CAAAK,OAAA,CAAkC;IAyBTpG,EAAA,CAAAQ,SAAA,GAAgD;IAAhDR,EAAA,CAAAS,iBAAA,CAAAT,EAAA,CAAAU,WAAA,yCAAgD;IAKrEV,EAAA,CAAAQ,SAAA,GAA+C;IAA/CR,EAAA,CAAAS,iBAAA,CAAAT,EAAA,CAAAU,WAAA,wCAA+C;IAEhCV,EAAA,CAAAQ,SAAA,GAAW;IAAXR,EAAA,CAAAI,UAAA,YAAW;IAI1BJ,EAAA,CAAAQ,SAAA,GAAgD;IAAhDR,EAAA,CAAAS,iBAAA,CAAAT,EAAA,CAAAU,WAAA,yCAAgD;IAEjCV,EAAA,CAAAQ,SAAA,GAAW;IAAXR,EAAA,CAAAI,UAAA,YAAW;IAE1BJ,EAAA,CAAAQ,SAAA,GAAwC;IAAxCR,EAAA,CAAAI,UAAA,SAAA2F,MAAA,CAAAlB,IAAA,CAAAC,QAAA,CAAAuB,QAAA,CAAAtF,KAAA,OAAwC;IAcxCf,EAAA,CAAAQ,SAAA,GAAkD;IAAlDR,EAAA,CAAAS,iBAAA,CAAAT,EAAA,CAAAU,WAAA,2CAAkD;IAEnCV,EAAA,CAAAQ,SAAA,GAAW;IAAXR,EAAA,CAAAI,UAAA,YAAW;IAE1BJ,EAAA,CAAAQ,SAAA,GAAwC;IAAxCR,EAAA,CAAAI,UAAA,SAAA2F,MAAA,CAAAlB,IAAA,CAAAC,QAAA,CAAAuB,QAAA,CAAAtF,KAAA,OAAwC;IAS5Cf,EAAA,CAAAQ,SAAA,GAA6B;IAA7BR,EAAA,CAAAI,UAAA,UAAA2F,MAAA,CAAAK,OAAA,IAAAL,MAAA,CAAAK,OAAA,KAA6B;IAgBtCpG,EAAA,CAAAQ,SAAA,GAAmB;IAAnBR,EAAA,CAAAI,UAAA,SAAA2F,MAAA,CAAAO,aAAA,CAAmB;IAyBOtG,EAAA,CAAAQ,SAAA,GAAoC;IAApCR,EAAA,CAAAS,iBAAA,CAAAT,EAAA,CAAAU,WAAA,6BAAoC;IAEzCV,EAAA,CAAAQ,SAAA,GAA8B;IAA9BR,EAAA,CAAAI,UAAA,YAAA2F,MAAA,CAAAQ,kBAAA,CAA8B,gBAAAvG,EAAA,CAAAU,WAAA,2CAAAqF,MAAA,CAAAS,SAAA,iBAAAT,MAAA,CAAAK,OAAA;IAACpG,EAAA,CAAAsC,WAAA,eAAAtC,EAAA,CAAAU,WAAA,6BAAkD;IAQ5EV,EAAA,CAAAQ,SAAA,GAAiC;IAAjCR,EAAA,CAAAS,iBAAA,CAAAT,EAAA,CAAAU,WAAA,0BAAiC;IAEtBV,EAAA,CAAAQ,SAAA,GAA2C;IAA3CR,EAAA,CAAAI,UAAA,gBAAAJ,EAAA,CAAAU,WAAA,0BAA2C;;;;;;IAG1FV,EAAA,CAAAC,cAAA,cAA6E;IAE1CD,EAAA,CAAA2C,UAAA,mBAAA8D,uEAAA;MAAAzG,EAAA,CAAA6C,aAAA,CAAA6D,IAAA;MAAA,MAAAC,OAAA,GAAA3G,EAAA,CAAAgD,aAAA;MAAA,OAAShD,EAAA,CAAAiD,WAAA,CAAA0D,OAAA,CAAAC,MAAA,EAAQ;IAAA,EAAC;IACzC5G,EAAA,CAAAE,MAAA,GACJ;;IAAAF,EAAA,CAAAG,YAAA,EAAa;;;;IAFiCH,EAAA,CAAAQ,SAAA,GAAwB;IAAxBR,EAAA,CAAAI,UAAA,cAAAyG,MAAA,CAAAhC,IAAA,CAAAiC,KAAA,CAAwB;IAClE9G,EAAA,CAAAQ,SAAA,GACJ;IADIR,EAAA,CAAAgB,kBAAA,MAAAhB,EAAA,CAAAU,WAAA,yBACJ;;;ADvMhB;;;AAQA,OAAM,MAAOqG,0BAA0B;EAyCnCC,YACcC,EAAe;IAAf,KAAAA,EAAE,GAAFA,EAAE;IArChB,KAAAC,KAAK,GAAG,yBAAyB;IACjC,KAAAV,SAAS,GAAGxH,qBAAqB,CAACmI,SAAS;IAC3C,KAAAC,MAAM,GAAG,KAAK;IACd,KAAAC,UAAU,GAAG,KAAK;IAClB,KAAAzG,UAAU,GAAmC,EAAE;IAC/C,KAAAc,UAAU,GAAuB,EAAE;IACnC,KAAAK,OAAO,GAAwD,EAAE;IACjE,KAAAK,MAAM,GAAgB,EAAE;IACxB,KAAAK,aAAa,GAAG,KAAK;IACrB,KAAAgB,cAAc,GAAG,KAAK;IAEtB,KAAA6D,KAAK,GAAG,KAAK;IAEb,KAAAnC,gBAAgB,GAAG,CAAC;IAWpB;IACA,KAAAgB,gBAAgB,GAAG,KAAK;IACxB,KAAA1B,SAAS,GAA0C,EAAE;IAK3C,KAAA8C,KAAK,GAAgC,EAAE,CAAC,CAAC;IACzC,KAAAC,OAAO,GAAG,KAAK;IACf,KAAAC,WAAW,GAAG,KAAK;IACnB,KAAAC,YAAY,GAAG,KAAK;IAK1B,IAAI,CAACC,WAAW,GAAGlJ,SAAS,CAACmJ,sBAAsB,EAAE;IACrD,IAAI,CAACzB,gBAAgB,GAAGvG,aAAa,CAACiI,SAAS,EAAE;IACjD,IAAI,CAAC7B,MAAM,GAAG;MACV8B,QAAQ,EAAEvI,SAAS,CAACwI,OAAO,CAAC,eAAe;KAC9C;IAED,IAAI,CAAClD,IAAI,GAAG,IAAIxG,SAAS,CAAC,EAAE,CAAC;IAE7B;IACA,IAAI,CAAC6H,WAAW,GAAG,IAAI,CAACe,EAAE,CAACe,OAAO,CAAC,EAAE,EAAE1J,UAAU,CAACwJ,QAAQ,CAAC;IAC3D,IAAI,CAACG,YAAY,GAAG,IAAI,CAAChB,EAAE,CAACe,OAAO,CAAC,EAAE,CAAC;IACvC,IAAI,CAACzB,kBAAkB,GAAG,IAAI,CAACU,EAAE,CAACe,OAAO,CAAC,EAAE,CAAC;IAC7C,IAAI,CAACnD,IAAI,CAACqD,UAAU,CAAC,MAAM,EAAE,IAAI,CAACjB,EAAE,CAACe,OAAO,CAAC,EAAE,EAAE1J,UAAU,CAACwJ,QAAQ,CAAC,CAAC;IACtE,IAAI,CAACjD,IAAI,CAACqD,UAAU,CAAC,WAAW,EAAE,IAAI,CAAChC,WAAW,CAAC;IACnD,IAAI,CAACrB,IAAI,CAACqD,UAAU,CAAC,YAAY,EAAE,IAAI,CAACjB,EAAE,CAACe,OAAO,CAAC,EAAE,CAAC,CAAC;IACvD,IAAI,CAACnD,IAAI,CAACqD,UAAU,CAAC,eAAe,EAAE,IAAI,CAACjB,EAAE,CAACe,OAAO,CAAC,EAAE,CAAC,CAAC;IAC1D,IAAI,CAACnD,IAAI,CAACqD,UAAU,CAAC,SAAS,EAAE,IAAI,CAACD,YAAY,CAAC;IAClD,IAAI,CAACpD,IAAI,CAACqD,UAAU,CAAC,aAAa,EAAE,IAAI,CAAC3B,kBAAkB,CAAC;IAC5D,IAAI,CAAC1B,IAAI,CAACqD,UAAU,CAAC,UAAU,EAAE,IAAI,CAACjB,EAAE,CAACe,OAAO,CAAC,EAAE,CAAC,CAAC;IACrD,IAAI,CAACnD,IAAI,CAACqD,UAAU,CAAC,UAAU,EAAE,IAAI,CAACjB,EAAE,CAACe,OAAO,CAAC,CAAC,CAAC,CAAC;IACpD,IAAI,CAACnD,IAAI,CAACqD,UAAU,CAAC,qBAAqB,EAAE,IAAI,CAACjB,EAAE,CAACe,OAAO,CAAC,EAAE,CAAC,CAAC;IAChE,IAAI,CAACnD,IAAI,CAACqD,UAAU,CAAC,QAAQ,EAAE,IAAI,CAACjB,EAAE,CAACe,OAAO,CAAC,KAAK,CAAC,CAAC;IACtD,IAAI,CAACnD,IAAI,CAACqD,UAAU,CAAC,SAAS,EAAE,IAAI,CAACjB,EAAE,CAACe,OAAO,CAAC,GAAG,CAAC,CAAC;IACrD,IAAI,CAACnD,IAAI,CAACqD,UAAU,CAAC,eAAe,EAAE,IAAI,CAACjB,EAAE,CAACe,OAAO,CAAC,CAAC,CAAC,CAAC;IAEzD,IAAI,CAAC1H,OAAO,GAAG1B,aAAa,CAACuJ,qBAAqB,EAAE;IACpD,IAAI,CAAC5H,OAAO,GAAG3B,aAAa,CAACwJ,qBAAqB,EAAE;EACxD;EAEA;;;EAGAC,QAAQA,CAAA;IACJ,IAAI,CAACjC,OAAO,GAAG1G,aAAa,CAAC4I,mBAAmB,CAAC,SAAS,CAAC,IAAIC,SAAS;IACxE,IAAI,CAACC,QAAQ,GAAG9I,aAAa,CAAC4I,mBAAmB,CAAC,UAAU,CAAC,IAAI,CAAC;IAClE,IAAI,CAACpB,KAAK,GAAG,IAAI,CAACd,OAAO,GAAG,0BAA0B,GAAG,yBAAyB;IAElF,MAAMqC,SAAS,GAAG/I,aAAa,CAAC4I,mBAAmB,CAAC,WAAW,CAAC;IAChE,MAAMI,WAAW,GAAG9J,aAAa,CAAC+J,gBAAgB,CAACF,SAAS,CAAC;IAC7D,IAAI,CAAC5D,IAAI,CAACqD,UAAU,CAAC,WAAW,EAAE,IAAI,CAACjB,EAAE,CAACe,OAAO,CAACU,WAAW,EAAEpK,UAAU,CAACwJ,QAAQ,CAAC,CAAC;IACpF,IAAI,CAACjD,IAAI,CAACqD,UAAU,CAAC,mBAAmB,EAAE,IAAI,CAACjB,EAAE,CAACe,OAAO,CAACU,WAAW,CAAC,CAAC;IACvE,IAAI,CAAC7D,IAAI,CAACqD,UAAU,CAAC,UAAU,EAAE,IAAI,CAACjB,EAAE,CAACe,OAAO,CAAC,IAAI,CAACQ,QAAQ,CAAC,CAAC;IAEhE,IAAI,CAACI,aAAa,EAAE;IACpB,IAAI,CAACC,SAAS,EAAE,CAACC,OAAO,CAAC,MAAK;MAC1B,IAAI,CAACC,YAAY,GAAGlK,SAAS,CAACmK,KAAK,CAAC,IAAI,CAACnE,IAAI,CAAC9D,KAAK,CAAC;MACpD,IAAI,CAACqG,MAAM,GAAG,IAAI;IACtB,CAAC,CAAC;EACN;EAEA;;;;;EAKgByB,SAASA,CAAA;IAAA,IAAAI,KAAA;IAAA,OAAAC,iBAAA;MACrBD,KAAI,CAAC3B,KAAK,GAAG,KAAK;MAElB;MACA,IAAI;QACA,MAAM,CAACC,KAAK,EAAE4B,UAAU,CAAC,SAASC,OAAO,CAACC,GAAG,CAAC,CAC1CnK,aAAa,CAACoK,oBAAoB,CAACL,KAAI,CAACT,QAAQ,CAAC,EACjD3J,SAAS,CAAC0K,YAAY,CAACrK,aAAa,CAACsK,oBAAoB,CAACP,KAAI,CAACT,QAAQ,CAAC,EAAE;UACtEiB,gBAAgB,EAAE,KAAK;UACvBC,mBAAmB,EAAE,KAAK;UAC1BC,qBAAqB,EAAE;SAC6B,CAAC,CAC5D,CAAC;QAEFV,KAAI,CAAC1B,KAAK,GAAGA,KAAK;QAElB,MAAMqC,QAAQ,GAAoB,EAAE;QACpC,MAAMhJ,UAAU,GAAGxB,mBAAmB,CAACyK,mBAAmB,CAACZ,KAAI,CAAC1B,KAAK,CAAC;QAEtE,IAAI,CAAC3G,UAAU,CAAC8C,MAAM,EAAE;UACpB,MAAM,IAAIjE,SAAS,CAACF,SAAS,CAACwI,OAAO,CAAC,6CAA6C,CAAC,CAAC;;QAGzF,IAAIkB,KAAI,CAAC7C,OAAO,IAAI,CAAC6C,KAAI,CAACvB,YAAY,EAAE;UACpC;UACA,MAAMtB,OAAO,GAAG6C,KAAI,CAAC7C,OAAO;UAE5BwD,QAAQ,CAACE,IAAI,CAACzK,iBAAiB,CAAC0K,WAAW,CAACzK,yBAAyB,CAAC0K,OAAO,CAAC,CAACC,IAAI,eAAAf,iBAAA,CAAC,aAAW;YAC3F;YACA,IAAI,CAACD,KAAI,CAACxB,WAAW,IAAIwB,KAAI,CAAC7C,OAAO,EAAE;cACnC1H,QAAQ,CAACwL,cAAc,CAAClL,qBAAqB,CAACmI,SAAS,EAAEf,OAAO,CAAC;;YAGrE,IAAI+D,SAA6E;YAEjF;YACA,IAAI;cACAA,SAAS,SAAShL,oBAAoB,CAACiL,QAAQ,CAAChE,OAAO,CAAC;cAExD6C,KAAI,CAAC5B,UAAU,GAAG,IAAI;aACzB,CAAC,OAAAgD,OAAA,EAAM;cACJ;cACApB,KAAI,CAAC5B,UAAU,GAAG,KAAK;;YAG3B,IAAIjB,OAAO,GAAG,CAAC,EAAE;cACb;cACA,MAAMkE,KAAK,SAASpL,aAAa,CAACqL,YAAY,CAACnE,OAAO,CAAC;cAEvD,IAAI,CAAC+D,SAAS,EAAE;gBACZA,SAAS,GAAGG,KAAK,CAAC,CAAC;;;cAGvBrB,KAAI,CAAC3C,aAAa,GAAGgE,KAAK,aAALA,KAAK,uBAALA,KAAK,CAAEE,QAAQ;cACpC,IAAIvB,KAAI,CAAC3C,aAAa,EAAE;gBAEpB2C,KAAI,CAAC9D,gBAAgB,GAAGmF,KAAK,CAACG,UAAU,GAAGH,KAAK,CAACG,UAAU,GAAG,CAAC,GAAG,CAAC;;;YAI3ExB,KAAI,CAACvB,YAAY,GAAG,IAAI;YAExB,IAAIyC,SAAS,EAAE;cACX;cACA,OAAOlB,KAAI,CAACyB,aAAa,CAACP,SAAS,EAAElB,KAAI,CAAC5B,UAAU,CAAC;;YAGzD;UACJ,CAAC,EAAC,CAAC;;QAGP,IAAI4B,KAAI,CAAC1B,KAAK,CAACoD,QAAQ,EAAE;UACrB;UACAf,QAAQ,CAACE,IAAI,CAACb,KAAI,CAAC2B,eAAe,EAAE,CAAC;;QAGzC3B,KAAI,CAACzB,OAAO,GAAG3I,SAAS,CAACgM,WAAW,CAAC5B,KAAI,CAACtB,WAAW,CAACmD,eAAe,CAAC,uBAAuB,CAAC,CAAC,IAC3F3B,UAAU,CAACM,gBAAgB;QAE/B,IAAIR,KAAI,CAAC1B,KAAK,CAACwD,MAAM,IAAI9B,KAAI,CAAC1B,KAAK,CAACnF,MAAM,EAAE;UACxCwH,QAAQ,CAACE,IAAI,CAACb,KAAI,CAAC+B,YAAY,EAAE,CAAC;;QAEtC,MAAM5B,OAAO,CAACC,GAAG,CAACO,QAAQ,CAAC;QAE3B,IAAI,CAACX,KAAI,CAAC/C,WAAW,CAACnF,KAAK,EAAE;UACzB;UACA,IAAIkI,KAAI,CAAC1B,KAAK,CAACwD,MAAM,EAAE;YACnB9B,KAAI,CAAC/C,WAAW,CAAC+E,QAAQ,CAAChM,sBAAsB,CAACiM,MAAM,CAAC;WAC3D,MAAM;YACHjC,KAAI,CAAC/C,WAAW,CAAC+E,QAAQ,CAACrK,UAAU,CAAC,CAAC,CAAC,CAACG,KAAK,CAAC;;;QAItDkI,KAAI,CAACrI,UAAU,GAAGA,UAAU;OAC/B,CAAC,OAAO0G,KAAK,EAAE;QACZ3I,YAAY,CAACwM,qBAAqB,CAAC7D,KAAK,EAAE,qBAAqB,CAAC;QAChE2B,KAAI,CAAC3B,KAAK,GAAG,IAAI;;IACpB;EACL;EAEgBsD,eAAeA,CAAA;IAAA,IAAAQ,MAAA;IAAA,OAAAlC,iBAAA;MAC3BkC,MAAI,CAAC1J,UAAU,SAAS5C,WAAW,CAACuM,aAAa,CAAC,CAAC,EAAE,IAAI,CAAC;IAAC;EAC/D;EAEgBL,YAAYA,CAAA;IAAA,IAAAM,MAAA;IAAA,OAAApC,iBAAA;MACxB;MACA,IAAInH,OAAO,SAAUuJ,MAAI,CAAC9D,OAAO,GAAG1I,WAAW,CAACyM,iBAAiB,EAAE,GAAGzM,WAAW,CAAC0M,cAAc,EAAG;MAEnG,IAAIzJ,OAAO,CAAC2B,MAAM,GAAG,CAAC,EAAE;QACpB4H,MAAI,CAACvJ,OAAO,GAAG,EAAE;QAEjB;;MAGJ,MAAM0J,kBAAkB;QAAA,IAAAC,KAAA,GAAAxC,iBAAA,CAAG,WAAO6B,MAAuD,EAAmB;UACxG,IAAI;YACA,MAAMY,MAAM,SAASnM,gBAAgB,CAACoM,uBAAuB,CAACb,MAAM,CAACnJ,QAAQ,EAAE,QAAQ,EAAEmJ,MAAM,CAACxJ,EAAE,CAAC;YACnGwJ,MAAM,CAACnJ,QAAQ,GAAG+J,MAAM,CAACE,IAAI;WAChC,CAAC,OAAAC,QAAA,EAAM;YACJ;UAAA;QAER,CAAC;QAAA,gBAPKL,kBAAkBA,CAAAM,EAAA;UAAA,OAAAL,KAAA,CAAAM,KAAA,OAAAC,SAAA;QAAA;MAAA,GAOvB;MAED,IAAIX,MAAI,CAAC9D,OAAO,EAAE;QACd;QACA,MAAM0E,UAAU,GAAGzN,SAAS,CAAC0N,oBAAoB,EAAE;QAEnD,IAAI,UAAU,IAAIpK,OAAO,CAAC,CAAC,CAAC,EAAE;UAC1BA,OAAO,GAAIA,OAAoC,CAACqK,MAAM,CAAErB,MAAM,IAAKA,MAAM,CAACxJ,EAAE,IAAI2K,UAAU,CAAC;SAC9F,MAAM;UACHnK,OAAO,GAAIA,OAAoC,CAACqK,MAAM,CAAErB,MAAM,IAAKA,MAAM,CAACxJ,EAAE,IAAI2K,UAAU,CAAC;;;MAInG;MACA,IAAI,UAAU,IAAInK,OAAO,CAAC,CAAC,CAAC,EAAE;QAC1B,MAAMqH,OAAO,CAACC,GAAG,CAAEtH,OAAoC,CAACsK,GAAG,CAACZ,kBAAkB,CAAC,CAAC;OACnF,MAAM;QACH,MAAMrC,OAAO,CAACC,GAAG,CAAEtH,OAAoC,CAACsK,GAAG,CAACZ,kBAAkB,CAAC,CAAC;;MAGpF;MACAH,MAAI,CAACvJ,OAAO,GAAGA,OAAO,CAACuK,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAI;QACjC,MAAMC,QAAQ,GAAGF,CAAC,CAAC3K,QAAQ,CAAC8K,WAAW,EAAE;QACzC,MAAMC,QAAQ,GAAGH,CAAC,CAAC5K,QAAQ,CAAC8K,WAAW,EAAE;QAEzC,OAAOD,QAAQ,CAACG,aAAa,CAACD,QAAQ,CAAC;MAC3C,CAAC,CAAC;IAAC;EAEP;EAEA;;;;;;;EAOgBjC,aAAaA,CACzBJ,KAA6D,EAC7DuC,SAAkB;IAAA,IAAAC,MAAA;IAAA,OAAA5D,iBAAA;MAAA,IAAA6D,mBAAA;MAElB,IAAI,CAACzC,KAAK,EAAE;QACR;;MAGJ,MAAM0C,YAAY,GAAI1C,KAA2C;MACjE,MAAM2C,WAAW,GAAI3C,KAA4B;MAEjD,MAAM9B,QAAQ,GAAGqE,SAAS,GAAGG,YAAY,CAACE,QAAQ,IAAAH,mBAAA,GAAGE,WAAW,CAAClC,MAAM,cAAAgC,mBAAA,uBAAlBA,mBAAA,CAAoBxL,EAAE;MAE3EuL,MAAI,CAACjI,IAAI,CAACC,QAAQ,CAACjE,IAAI,CAACoK,QAAQ,CAACX,KAAK,CAACzJ,IAAI,CAAC;MAC5CiM,MAAI,CAACjI,IAAI,CAACC,QAAQ,CAACmB,SAAS,CAACgF,QAAQ,CAACrM,aAAa,CAAC+J,gBAAgB,CAAC2B,KAAK,CAACrE,SAAS,GAAG,IAAI,CAAC,CAAC;MAC7F6G,MAAI,CAACjI,IAAI,CAACC,QAAQ,CAACqI,SAAS,CAAClC,QAAQ,CAACX,KAAK,CAAC6C,SAAS,CAAC;MACtDL,MAAI,CAACjI,IAAI,CAACC,QAAQ,CAACsI,UAAU,CAACnC,QAAQ,CAACX,KAAK,CAAC8C,UAAU,IAAI,EAAE,CAAC;MAC9DN,MAAI,CAACjI,IAAI,CAACC,QAAQ,CAACoI,QAAQ,CAACjC,QAAQ,CAACzC,QAAQ,IAAI,EAAE,CAAC;MACpDsE,MAAI,CAACjI,IAAI,CAACC,QAAQ,CAACuI,aAAa,CAACpC,QAAQ,CAACzC,QAAQ,IAAI,EAAE,CAAC;MACzDsE,MAAI,CAACjI,IAAI,CAACC,QAAQ,CAACwI,OAAO,CAACrC,QAAQ,CAACX,KAAK,CAACgD,OAAO,IAAI,EAAE,CAAC;MACxDR,MAAI,CAACjI,IAAI,CAACC,QAAQ,CAACyI,WAAW,CAACtC,QAAQ,CAACX,KAAK,CAACiD,WAAW,CAAC;MAC1DT,MAAI,CAACjI,IAAI,CAACC,QAAQ,CAAC0I,QAAQ,CAACvC,QAAQ,CAACX,KAAK,CAACkD,QAAQ,CAAC;MAEpD,IAAIX,SAAS,EAAE;QACX;QACAC,MAAI,CAACjI,IAAI,CAACC,QAAQ,CAACuB,QAAQ,CAAC4E,QAAQ,CAAC+B,YAAY,CAAC3G,QAAQ,CAAC;QAC3DyG,MAAI,CAACjI,IAAI,CAACC,QAAQ,CAAC2I,iBAAiB,CAACxC,QAAQ,CACzCrM,aAAa,CAAC+J,gBAAgB,CAAE,CAACqE,YAAY,CAACS,iBAAiB,IAAI,CAAC,IAAI,IAAI,IAAKC,IAAI,CAACC,GAAG,EAAE,CAAC,CAC/F;QACDb,MAAI,CAACjI,IAAI,CAACC,QAAQ,CAAC8I,mBAAmB,CAAC3C,QAAQ,CAAC+B,YAAY,CAACY,mBAAmB,IAAI,EAAE,CAAC;QACvFd,MAAI,CAACjI,IAAI,CAACC,QAAQ,CAACC,MAAM,CAACkG,QAAQ,CAAC,CAAC,CAAC+B,YAAY,CAACjI,MAAM,CAAC;QACzD+H,MAAI,CAACjI,IAAI,CAACC,QAAQ,CAAC+I,OAAO,CAAC5C,QAAQ,CAAC+B,YAAY,CAACa,OAAO,IAAI,GAAG,CAAC;QAChEf,MAAI,CAACjI,IAAI,CAACC,QAAQ,CAACgJ,aAAa,CAAC7C,QAAQ,CAAC+B,YAAY,CAACc,aAAa,IAAI,CAAC,CAAC;OAC7E,MAAM;QACH;QAEA,IAAIb,WAAW,CAACc,YAAY,GAAG,CAAC,EAAE;UAC9BjB,MAAI,CAACjI,IAAI,CAACC,QAAQ,CAACuB,QAAQ,CAAC4E,QAAQ,CAAC,CAAC,CAAC;UACvC6B,MAAI,CAACjI,IAAI,CAACC,QAAQ,CAAC2I,iBAAiB,CAACxC,QAAQ,CAACrM,aAAa,CAAC+J,gBAAgB,CACxE,CAACsE,WAAW,CAAChH,SAAS,GAAGgH,WAAW,CAACc,YAAY,IAAI,IAAI,CAC5D,CAAC;SACL,MAAM;UACH;UACAjB,MAAI,CAACjI,IAAI,CAACC,QAAQ,CAACuB,QAAQ,CAAC4E,QAAQ,CAAC,CAAC,CAAC;UACvC6B,MAAI,CAACjI,IAAI,CAACC,QAAQ,CAAC2I,iBAAiB,CAACxC,QAAQ,CAACrM,aAAa,CAAC+J,gBAAgB,EAAE,CAAC;;QAGnFmE,MAAI,CAACjI,IAAI,CAACC,QAAQ,CAAC8I,mBAAmB,CAAC3C,QAAQ,CAAC,EAAE,CAAC;QACnD6B,MAAI,CAACjI,IAAI,CAACC,QAAQ,CAACC,MAAM,CAACkG,QAAQ,CAAC,CAAC,CAACgC,WAAW,CAACzC,QAAQ,CAAC;QAC1DsC,MAAI,CAACjI,IAAI,CAACC,QAAQ,CAAC+I,OAAO,CAAC5C,QAAQ,CAACgC,WAAW,CAACxC,UAAU,IAAI,GAAG,CAAC;QAClEqC,MAAI,CAACjI,IAAI,CAACC,QAAQ,CAACgJ,aAAa,CAAC7C,QAAQ,CAAC,CAAC,CAAC;;MAGhD,IAAIX,KAAK,CAAC6C,SAAS,IAAIlO,sBAAsB,CAAC+O,KAAK,IAAIxF,QAAQ,EAAE;QAC7D,MAAMsE,MAAI,CAACmB,UAAU,CAACzF,QAAQ,CAAC;;IAClC;EACL;EAEA;;;;;EAKA0F,WAAWA,CAACC,SAAmC;IAC3C,MAAMvE,QAAQ,GAAG,CACb1K,aAAa,CAACkP,2BAA2B,CAAC,IAAI,CAAC5F,QAAQ,CAAC,EACxDtJ,aAAa,CAACmP,2BAA2B,CAAC,IAAI,CAAC7F,QAAQ,CAAC,CAC3D;IAED,IAAI,IAAI,CAACjB,KAAK,EAAE;MACZ,IAAI,IAAI,CAACA,KAAK,CAACoD,QAAQ,EAAE;QACrBf,QAAQ,CAACE,IAAI,CAAChL,WAAW,CAACwP,oBAAoB,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC;;MAE5D,IAAI,IAAI,CAAC/G,KAAK,CAACwD,MAAM,IAAI,IAAI,CAACxD,KAAK,CAACnF,MAAM,EAAE;QACxC,IAAI,IAAI,CAACoF,OAAO,EAAE;UACdoC,QAAQ,CAACE,IAAI,CAAChL,WAAW,CAACyP,wBAAwB,EAAE,CAAC;SACxD,MAAM;UACH3E,QAAQ,CAACE,IAAI,CAAChL,WAAW,CAAC0P,qBAAqB,EAAE,CAAC;;;;IAK9DpF,OAAO,CAACC,GAAG,CAACO,QAAQ,CAAC,CAACd,OAAO,CAAC,MAAK;MAC/B,IAAI,CAACD,SAAS,EAAE,CAACC,OAAO,CAAC,MAAK;QAC1BqF,SAAS,aAATA,SAAS,eAATA,SAAS,CAAEM,QAAQ,EAAE;MACzB,CAAC,CAAC;IACN,CAAC,CAAC;EACN;EAEA;;;EAGMvL,mBAAmBA,CAAA;IAAA,IAAAwL,MAAA;IAAA,OAAAxF,iBAAA;MACrB,MAAMV,QAAQ,GAAGkG,MAAI,CAAC7J,IAAI,CAACC,QAAQ,CAACuI,aAAa,CAACtM,KAAK;MACvD,IAAI,CAACyH,QAAQ,EAAE;QACX;;MAGJ,MAAMmG,KAAK,SAAShQ,YAAY,CAACiQ,gBAAgB,EAAE;MAEnD,IAAI;QACA,MAAMF,MAAI,CAACT,UAAU,CAACzF,QAAQ,CAAC;QAE/BkG,MAAI,CAACzG,YAAY,CAACgD,QAAQ,CAAC,EAAE,CAAC;OACjC,CAAC,OAAO3D,KAAK,EAAE;QACZ3I,YAAY,CAACwM,qBAAqB,CAAC7D,KAAK,EAAE,qBAAqB,CAAC;;MAGpEqH,KAAK,CAACE,OAAO,EAAE;IAAC;EACpB;EAEA;;;;;;EAMgBZ,UAAUA,CAACzF,QAAgB;IAAA,IAAAsG,MAAA;IAAA,OAAA5F,iBAAA;MACvC4F,MAAI,CAACrM,aAAa,GAAG,IAAI;MAEzB,IAAI;QACAqM,MAAI,CAAC1M,MAAM,SAAS5D,UAAU,CAACuQ,qBAAqB,CAACvG,QAAQ,CAAC;QAC9DsG,MAAI,CAACrL,cAAc,GAAG,IAAI;OAC7B,SAAS;QACNqL,MAAI,CAACrM,aAAa,GAAG,KAAK;;IAC7B;EACL;EAEAuM,cAAcA,CAAC3I,QAAgB;IAC3B,IAAI,CAACxB,IAAI,CAACC,QAAQ,CAACuB,QAAQ,CAAC4E,QAAQ,CAAC5E,QAAQ,CAAC;EAClD;EAEA;;;EAGMO,MAAMA,CAAA;IAAA,IAAAqI,MAAA;IAAA,OAAA/F,iBAAA;MACR;MACA,MAAMgG,QAAQ,GAAGD,MAAI,CAACpK,IAAI,CAAC9D,KAAK;MAChC,MAAMoO,aAAa,GAAGpP,MAAM,CAACmP,QAAQ,CAACjJ,SAAS,CAAC,CAACmJ,IAAI,EAAE;MACvD,MAAMC,aAAa,GAAGtP,MAAM,CAACmP,QAAQ,CAACzB,iBAAiB,CAAC,CAAC2B,IAAI,EAAE;MAC/D,MAAME,mBAAmB,GAAGC,QAAQ,CAACL,QAAQ,CAACtB,mBAAmB,IAAI,EAAE,EAAE,EAAE,CAAC;MAC5E,IAAItG,KAAyB;MAE7B,IAAI4H,QAAQ,CAAC/B,SAAS,KAAKlO,sBAAsB,CAACiM,MAAM,IAAI,CAACgE,QAAQ,CAAChC,QAAQ,EAAE;QAC5E5F,KAAK,GAAG,oBAAoB;OAC/B,MAAM,IAAI4H,QAAQ,CAAC/B,SAAS,KAAKlO,sBAAsB,CAAC+O,KAAK,IAAI,CAACkB,QAAQ,CAAC7B,aAAa,EAAE;QACvF/F,KAAK,GAAG,oBAAoB;OAC/B,MAAM,IAAI4H,QAAQ,CAAC/B,SAAS,KAAKlO,sBAAsB,CAAC+O,KAAK,IAAI,CAACkB,QAAQ,CAAC5B,OAAO,EAAE;QACjFhG,KAAK,GAAG,mBAAmB;OAC9B,MAAM,IAAI4H,QAAQ,CAAC/B,SAAS,KAAKlO,sBAAsB,CAACuQ,QAAQ,IAAI,CAACN,QAAQ,CAAC9B,UAAU,EAAE;QACvF9F,KAAK,GAAG,sBAAsB;OACjC,MAAM,IAAI4H,QAAQ,CAAC7I,QAAQ,KAAK,CAAC,IAAI8I,aAAa,GAAGE,aAAa,EAAE;QACjE/H,KAAK,GAAG,yCAAyC;OACpD,MAAM,IAAI4H,QAAQ,CAAC7I,QAAQ,KAAK,CAAC,KAAKoJ,KAAK,CAACH,mBAAmB,CAAC,IAAIA,mBAAmB,GAAG,CAAC,CAAC,EAAE;QAC3FhI,KAAK,GAAG,2CAA2C;;MAGvD,IAAIA,KAAK,EAAE;QACP;QACA3I,YAAY,CAAC+Q,cAAc,CAACnQ,SAAS,CAACwI,OAAO,CAACT,KAAK,CAAC,CAAC;QAErD;;MAGJ;MACA,MAAMqI,IAAI,GAAoD;QAC1D9O,IAAI,EAAEqO,QAAQ,CAACrO,IAAI;QACnBsM,SAAS,EAAE+B,QAAQ,CAAC/B,SAAS;QAC7BlH,SAAS,EAAEkJ,aAAa;QACxB5B,WAAW,EAAE;UACT1B,IAAI,EAAEqD,QAAQ,CAAC3B,WAAW,IAAI,EAAE;UAChCqC,MAAM,EAAE,CAAC;UACTC,MAAM,EAAE,CAAC,CAAE;SACd;;QACDrC,QAAQ,EAAE0B,QAAQ,CAAC1B,QAAQ;QAC3BnH,QAAQ,EAAE6I,QAAQ,CAAC7I,QAAQ;QAC3BtB,MAAM,EAAEmK,QAAQ,CAACnK;OACpB;MAED,IAAImK,QAAQ,CAAC/B,SAAS,IAAIlO,sBAAsB,CAACiM,MAAM,EAAE;QACrDyE,IAAI,CAACzC,QAAQ,GAAGgC,QAAQ,CAAChC,QAAQ;OACpC,MAAM,IAAIgC,QAAQ,CAAC/B,SAAS,IAAIlO,sBAAsB,CAAC+O,KAAK,EAAE;QAC3D2B,IAAI,CAACtC,aAAa,GAAG6B,QAAQ,CAAC7B,aAAa;QAC3CsC,IAAI,CAACrC,OAAO,GAAG4B,QAAQ,CAAC5B,OAAO;OAClC,MAAM,IAAI4B,QAAQ,CAAC/B,SAAS,IAAIlO,sBAAsB,CAACuQ,QAAQ,EAAE;QAC9DG,IAAI,CAACvC,UAAU,GAAG8B,QAAQ,CAAC9B,UAAU;;MAGzC,IAAI8B,QAAQ,CAAC7I,QAAQ,IAAI,CAAC,EAAE;QACxBsJ,IAAI,CAAClC,iBAAiB,GAAG4B,aAAa;OACzC,MAAM,IAAIH,QAAQ,CAAC7I,QAAQ,IAAI,CAAC,EAAE;QAC/BsJ,IAAI,CAAC/B,mBAAmB,GAAGsB,QAAQ,CAACtB,mBAAmB;;MAG3D,IAAIsB,QAAQ,CAACnK,MAAM,EAAE;QACjB4K,IAAI,CAAC9B,OAAO,GAAGiC,MAAM,CAACZ,QAAQ,CAACrB,OAAO,CAAC;;MAG3C,IAAIoB,MAAI,CAAC3I,aAAa,EAAE;QACpBqJ,IAAI,CAACnF,QAAQ,GAAGyE,MAAI,CAAC3I,aAAa;QAClCqJ,IAAI,CAAC7B,aAAa,GAAGoB,QAAQ,CAACpB,aAAa;;MAG/C;MACA,MAAMa,KAAK,SAAShQ,YAAY,CAACiQ,gBAAgB,CAAC,cAAc,EAAE,IAAI,CAAC;MACvE,IAAItE,KAA6D;MAEjE,IAAI;QACA,MAAMqB,MAAM,SAASzM,aAAa,CAAC6Q,WAAW,CAACd,MAAI,CAAC7I,OAAO,EAAEuJ,IAAI,EAAE;UAC/DlL,SAAS,EAAEwK,MAAI,CAAC7I,OAAO,GAAG,EAAE,GAAG6I,MAAI,CAACxK,SAAS,CAAE;SAClD,CAAC;;QACF6F,KAAK,GAAGqB,MAAM,CAACrB,KAAK;QAEpB3K,SAAS,CAACqQ,yBAAyB,CAACf,MAAI,CAACgB,WAAW,EAAEtE,MAAM,CAACuE,IAAI,EAAEjB,MAAI,CAACtH,WAAW,CAACwI,KAAK,EAAE,CAAC;QAE5F,IAAIxE,MAAM,CAACuE,IAAI,EAAE;UACb;UACA,MAAME,mBAAmB,GAAGlB,QAAQ,CAACnK,MAAM,GACrCmK,QAAQ,CAACrB,OAAO,GACf8B,IAAI,CAAC7B,aAAa,IAAImB,MAAI,CAAC9J,gBAAgB,GACxC8J,MAAI,CAAC9J,gBAAgB,GAAG,CAAC,GACzB,CAAE;UAEZ,IAAI;YACA,MAAM/F,mBAAmB,CAACiR,uBAAuB,CAAC1E,MAAM,CAACrB,KAAK,EAAE8F,mBAAmB,CAAC;WACvF,CAAC,OAAAE,QAAA,EAAM;YACJ;UAAA;;QAIRrB,MAAI,CAACsB,YAAY,CAACjG,KAAK,CAAC;OAC3B,CAAC,OAAOhD,KAAK,EAAE;QACZ3I,YAAY,CAACwM,qBAAqB,CAAC7D,KAAK,EAAE,qBAAqB,CAAC;;MAGpEqH,KAAK,CAACE,OAAO,EAAE;IAAC;EACpB;EAEA;;;;;EAKU0B,YAAYA,CAACjG,KAA6D;IAChF;IACA,IAAI,CAACkG,WAAW,EAAE;IAElB,IAAI,IAAI,CAACpK,OAAO,IAAI,IAAI,CAACA,OAAO,GAAG,CAAC,EAAE;MAClC;MACA7H,UAAU,CAACkS,OAAO,CACdzR,qBAAqB,CAAC0R,gBAAgB,EACtC;QAAEtK,OAAO,EAAE,IAAI,CAACA;MAAO,CAAE,EACzB,IAAI,CAACuB,WAAW,CAACwI,KAAK,EAAE,CAC3B;KACJ,MAAM;MACH5R,UAAU,CAACkS,OAAO,CACdzR,qBAAqB,CAAC2R,eAAe,EACrC;QACIvK,OAAO,EAAEkE,KAAK,CAAC/I,EAAE;QACjBqP,UAAU,EAAE,IAAI,CAACxK;OACpB,EACD,IAAI,CAACuB,WAAW,CAACwI,KAAK,EAAE,CAC3B;;IAGL,IAAI,CAACpH,YAAY,GAAGR,SAAS,CAAC,CAAC;IAC/B7I,aAAa,CAACmR,IAAI,EAAE;EACxB;EAEA;;;;;EAKMC,QAAQA,CAAA;IAAA,IAAAC,MAAA;IAAA,OAAA7H,iBAAA;MACV,IAAI9J,mBAAmB,CAAC4R,mBAAmB,CAACD,MAAI,CAAClM,IAAI,CAAC9D,KAAK,EAAEgQ,MAAI,CAAChI,YAAY,CAAC,EAAE;QAC7E;QACA,MAAMpK,YAAY,CAACsS,WAAW,CAAC1R,SAAS,CAACwI,OAAO,CAAC,wBAAwB,CAAC,CAAC;;MAG/EpI,SAAS,CAACuR,yBAAyB,CAACH,MAAI,CAACd,WAAW,EAAEc,MAAI,CAACpJ,WAAW,CAACwI,KAAK,EAAE,CAAC;MAE/E,OAAO,IAAI;IAAC;EAChB;EAEA;;;EAGUK,WAAWA,CAAA;IACjB,IAAI,IAAI,CAACpK,OAAO,EAAE;MACd1H,QAAQ,CAACyS,gBAAgB,CAACnS,qBAAqB,CAACmI,SAAS,EAAE,IAAI,CAACf,OAAO,CAAC;;EAEhF;EAEA;;;;;EAKgBwC,aAAaA,CAAA;IAAA,IAAAwI,MAAA;IAAA,OAAAlI,iBAAA;MACzB;MACA,IAAI,CAACkI,MAAI,CAACjL,gBAAgB,IAAIiL,MAAI,CAAChL,OAAO,EAAE;QACxC;;MAGJ;MACA,MAAMiL,WAAW,SAASzR,aAAa,CAAC0R,0BAA0B,CAACF,MAAI,CAACzJ,WAAW,CAACwI,KAAK,EAAE,CAAC;MAC5F,IAAIkB,WAAW,KAAKxR,oBAAoB,CAAC0R,QAAQ,EAAE;QAC/C;;MAGJ,MAAM5B,IAAI,GAAG9P,oBAAoB,CAAC2R,4BAA4B,CAACH,WAAW,CAAC;MAE3E;MACAD,MAAI,CAAC3M,SAAS,CAACqF,IAAI,CAAC;QAChB/I,KAAK,EAAE4O,IAAI,CAAC5O,KAAK;QACjB0Q,IAAI,EAAE9B,IAAI,CAAC8B,IAAI;QACfvN,KAAK,EAAEtE,aAAa,CAAC8R,iBAAiB,CAAC/B,IAAI,CAAC5O,KAAK,EAAE4O,IAAI,CAAC8B,IAAI,EAAE,IAAI;OACrE,CAAC;IAAC;EACP;EAEA;;;EAGMnN,WAAWA,CAAA;IAAA,IAAAqN,OAAA;IAAA,OAAAzI,iBAAA;MACb,MAAMgG,QAAQ,GAAGyC,OAAI,CAAC9M,IAAI,CAAC9D,KAAK;MAChC,MAAM6Q,SAAS,GAAG7R,MAAM,CAACmP,QAAQ,CAACjJ,SAAS,CAAC,CAACmJ,IAAI,EAAE;MAEnD,MAAMyC,YAAY,SAASlT,YAAY,CAACmT,WAAW,CAAuB;QACtEtL,SAAS,EAAE1G,qCAAqC;QAChDiS,cAAc,EAAE;UACZH;;QAEJ;OACH,CAAC;;MAEF,IAAIC,YAAY,KAAKtJ,SAAS,EAAE;QAC5B;QACA;;MAGJ,MAAMoH,IAAI,GAAG9P,oBAAoB,CAAC2R,4BAA4B,CAACK,YAAY,CAACG,UAAU,CAAC;MAEvF;MACAL,OAAI,CAAClN,SAAS,CAACqF,IAAI,CAAC;QAChBmI,IAAI,EAAEJ,YAAY,CAACG,UAAU;QAC7BjR,KAAK,EAAE4O,IAAI,CAAC5O,KAAK;QACjB0Q,IAAI,EAAE9B,IAAI,CAAC8B,IAAI;QACfvN,KAAK,EAAEtE,aAAa,CAAC8R,iBAAiB,CAAC/B,IAAI,CAAC5O,KAAK,EAAE4O,IAAI,CAAC8B,IAAI;OAC/D,CAAC;IAAC;EACP;EAEA;;;;;EAKAxN,cAAcA,CAACiO,QAA6C;IACxD,MAAMC,KAAK,GAAG,IAAI,CAAC1N,SAAS,CAAC2N,OAAO,CAACF,QAAQ,CAAC;IAC9C,IAAIC,KAAK,KAAK,CAAC,CAAC,EAAE;MACd,IAAI,CAAC1N,SAAS,CAAC4N,MAAM,CAACF,KAAK,EAAE,CAAC,CAAC;;EAEvC;EAEA;;;EAGAG,WAAWA,CAAA;IACP,IAAI,CAAC9B,WAAW,EAAE;IAClB,IAAI,CAAC/I,WAAW,GAAG,IAAI;EAC3B;;SAnnBSV,0BAA0B;;mBAA1BA,MAA0B,EAAA/G,EAAA,CAAAuS,iBAAA,CAAAC,EAAA,CAAAC,WAAA;AAAA;;QAA1B1L,MAA0B;EAAA2L,SAAA;EAAAC,SAAA,WAAAC,iCAAAC,EAAA,EAAAC,GAAA;IAAA,IAAAD,EAAA;qBAExB9T,iCAAiC;;;;;;;;;;;;;;MC1DhDiB,EAAA,CAAAC,cAAA,iBAAY;MAGAD,EAAA,CAAAqC,SAAA,yBAAoD;;MACxDrC,EAAA,CAAAG,YAAA,EAAc;MACdH,EAAA,CAAAC,cAAA,gBAAW;MACHD,EAAA,CAAAE,MAAA,GAAuB;;MAAAF,EAAA,CAAAG,YAAA,EAAK;MAI5CH,EAAA,CAAAC,cAAA,kBAAa;MACwCD,EAAA,CAAA2C,UAAA,wBAAAoQ,yEAAAC,MAAA;QAAA,OAAcF,GAAA,CAAA5E,WAAA,CAAA8E,MAAA,CAAAC,MAAA,CAA0B;MAAA,EAAC;MACtFjT,EAAA,CAAAqC,SAAA,gCAA8E;;MAClFrC,EAAA,CAAAG,YAAA,EAAgB;MAEhBH,EAAA,CAAAC,cAAA,uBAAmC;MAC/BD,EAAA,CAAAiB,UAAA,KAAAiS,2CAAA,oBAkOO;MACPlT,EAAA,CAAAiB,UAAA,KAAAkS,0CAAA,iBAMM;MACVnT,EAAA,CAAAG,YAAA,EAAe;;;MAvPUH,EAAA,CAAAQ,SAAA,GAAgC;MAAhCR,EAAA,CAAAI,UAAA,SAAAJ,EAAA,CAAAU,WAAA,oBAAgC;MAG7CV,EAAA,CAAAQ,SAAA,GAAuB;MAAvBR,EAAA,CAAAS,iBAAA,CAAAT,EAAA,CAAAU,WAAA,OAAAoS,GAAA,CAAA5L,KAAA,EAAuB;MAKPlH,EAAA,CAAAQ,SAAA,GAAoB;MAApBR,EAAA,CAAAI,UAAA,cAAA0S,GAAA,CAAA1L,MAAA,CAAoB;MACrBpH,EAAA,CAAAQ,SAAA,GAAoD;MAApDR,EAAA,CAAAoT,qBAAA,gBAAApT,EAAA,CAAAU,WAAA,+BAAoD;MAGjEV,EAAA,CAAAQ,SAAA,GAAoB;MAApBR,EAAA,CAAAI,UAAA,cAAA0S,GAAA,CAAA1L,MAAA,CAAoB;MACJpH,EAAA,CAAAQ,SAAA,GAAY;MAAZR,EAAA,CAAAI,UAAA,UAAA0S,GAAA,CAAAxL,KAAA,CAAY;MAmOEtH,EAAA,CAAAQ,SAAA,GAAsB;MAAtBR,EAAA,CAAAI,UAAA,SAAA0S,GAAA,CAAA1L,MAAA,KAAA0L,GAAA,CAAAxL,KAAA,CAAsB"},"metadata":{},"sourceType":"module","externalDependencies":[]}
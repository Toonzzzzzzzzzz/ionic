{"ast":null,"code":"import _asyncToGenerator from \"/home/toon/works/gitionic7/ionic-github/ionic/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _class;\nimport { CoreUtils } from '@services/utils/utils';\nimport { CoreMath } from '@singletons/math';\nimport { CoreDirectivesRegistry } from '@singletons/directives-registry';\nimport { CoreFormatTextDirective } from './format-text';\nimport { CoreLoadingComponent } from '@components/loading/loading';\nimport { CoreDom } from '@singletons/dom';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ionic/angular\";\n/**\n * Directive to make an element fixed at the bottom collapsible when scrolling.\n *\n * Example usage:\n *\n * <div collapsible-footer>\n */\nexport class CoreCollapsibleFooterDirective {\n  constructor(el, ionContent) {\n    this.ionContent = ionContent;\n    this.appearOnBottom = false;\n    this.id = '0';\n    this.initialHeight = 48;\n    this.finalHeight = 0;\n    this.initialPaddingBottom = '0px';\n    this.previousTop = 0;\n    this.previousHeight = 0;\n    this.loadingHeight = false;\n    this.element = el.nativeElement;\n  }\n  /**\n   * @inheritdoc\n   */\n  ngOnInit() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      var _this$content;\n      _this.id = String(CoreUtils.getUniqueId('CoreCollapsibleFooterDirective'));\n      // Only if not present or explicitly falsy it will be false.\n      _this.appearOnBottom = !CoreUtils.isFalseOrZero(_this.appearOnBottom);\n      _this.slotPromise = CoreDom.slotOnContent(_this.element);\n      yield _this.slotPromise;\n      yield _this.waitLoadingsDone();\n      yield _this.waitFormatTextsRendered();\n      _this.content = _this.element.closest('ion-content');\n      (_this$content = _this.content) === null || _this$content === void 0 || _this$content.setAttribute('data-collapsible-footer-id', _this.id);\n      yield _this.calculateHeight();\n      CoreDom.onElementSlot(_this.element, () => {\n        _this.calculateHeight();\n      });\n      _this.listenEvents();\n    })();\n  }\n  /**\n   * Calculate the height of the footer.\n   */\n  calculateHeight() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      var _this2$content;\n      if (_this2.loadingHeight) {\n        // Already calculating, return.\n        return;\n      }\n      _this2.loadingHeight = true;\n      _this2.viewportPromise = CoreDom.waitToBeInViewport(_this2.element);\n      yield _this2.viewportPromise;\n      _this2.element.classList.remove('is-active');\n      yield CoreUtils.nextTick();\n      // Set a minimum height value.\n      _this2.initialHeight = _this2.element.getBoundingClientRect().height || _this2.initialHeight;\n      const moduleNav = _this2.element.querySelector('core-course-module-navigation');\n      if (moduleNav) {\n        _this2.element.classList.add('has-module-nav');\n        _this2.finalHeight = _this2.initialHeight - moduleNav.getBoundingClientRect().height;\n      }\n      _this2.previousHeight = _this2.initialHeight;\n      (_this2$content = _this2.content) === null || _this2$content === void 0 || _this2$content.style.setProperty('--core-collapsible-footer-max-height', _this2.initialHeight + 'px');\n      _this2.element.classList.add('is-active');\n      _this2.setBarHeight(_this2.initialHeight);\n      _this2.loadingHeight = false;\n    })();\n  }\n  /**\n   * Setup event listeners.\n   */\n  listenEvents() {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      var _this3$content, _this3$element$parent, _this3$page;\n      if (!_this3.content || (_this3$content = _this3.content) !== null && _this3$content !== void 0 && _this3$content.classList.contains('has-collapsible-footer')) {\n        return;\n      }\n      _this3.content.classList.add('has-collapsible-footer');\n      // Move element to the nearest ion-content if it's not the parent.\n      if (((_this3$element$parent = _this3.element.parentElement) === null || _this3$element$parent === void 0 ? void 0 : _this3$element$parent.nodeName) != 'ION-CONTENT') {\n        _this3.content.appendChild(_this3.element);\n      }\n      // Set a padding to not overlap elements.\n      _this3.initialPaddingBottom = _this3.content.style.getPropertyValue('--padding-bottom') || _this3.initialPaddingBottom;\n      _this3.content.style.setProperty('--padding-bottom', `calc(${_this3.initialPaddingBottom} + var(--core-collapsible-footer-max-height, 0px))`);\n      const scroll = yield _this3.content.getScrollElement();\n      _this3.content.scrollEvents = true;\n      // Init shadow.\n      _this3.content.classList.toggle('core-footer-shadow', !CoreDom.scrollIsBottom(scroll));\n      _this3.content.addEventListener('ionScroll', _this3.contentScrollListener = e => {\n        if (!_this3.content) {\n          return;\n        }\n        _this3.onScroll(e.detail, scroll);\n      });\n      _this3.content.addEventListener('ionScrollEnd', _this3.endContentScrollListener = () => {\n        if (!_this3.content) {\n          return;\n        }\n        const height = _this3.previousHeight;\n        const collapsed = height <= _this3.finalHeight;\n        const expanded = height >= _this3.initialHeight;\n        if (!collapsed && !expanded) {\n          // Finish opening or closing the bar.\n          const newHeight = height - _this3.finalHeight < (_this3.initialHeight - _this3.finalHeight) / 2 ? _this3.finalHeight : _this3.initialHeight;\n          _this3.setBarHeight(newHeight);\n        }\n      });\n      _this3.resizeListener = CoreDom.onWindowResize(() => {\n        _this3.calculateHeight();\n      }, 50);\n      _this3.page = _this3.content.closest('.ion-page') || undefined;\n      (_this3$page = _this3.page) === null || _this3$page === void 0 || _this3$page.addEventListener('ionViewDidEnter', _this3.pageDidEnterListener = () => {\n        _this3.calculateHeight();\n      });\n      // Handle scroll when navigating using tab key and the selected element is behind the footer.\n      _this3.content.addEventListener('keyup', _this3.keyUpListener = ev => {\n        if (ev.key !== 'Tab' || !document.activeElement) {\n          return;\n        }\n        if (document.activeElement.getBoundingClientRect().bottom > _this3.element.getBoundingClientRect().top) {\n          document.activeElement.scrollIntoView({\n            block: 'center'\n          });\n        }\n      });\n    })();\n  }\n  /**\n   * Wait until all <core-format-text> children inside the element are done rendering.\n   */\n  waitFormatTextsRendered() {\n    var _this4 = this;\n    return _asyncToGenerator(function* () {\n      yield CoreDirectivesRegistry.waitDirectivesReady(_this4.element, 'core-format-text', CoreFormatTextDirective);\n    })();\n  }\n  /**\n   * On scroll function.\n   *\n   * @param scrollDetail Scroll detail object.\n   * @param scrollElement Scroll element to calculate maxScroll.\n   */\n  onScroll(scrollDetail, scrollElement) {\n    const maxScroll = scrollElement.scrollHeight - scrollElement.offsetHeight;\n    if (scrollDetail.scrollTop <= 0 || this.appearOnBottom && scrollDetail.scrollTop >= maxScroll) {\n      // Reset.\n      this.setBarHeight(this.initialHeight);\n    } else {\n      let newHeight = this.previousHeight - (scrollDetail.scrollTop - this.previousTop);\n      newHeight = CoreMath.clamp(newHeight, this.finalHeight, this.initialHeight);\n      this.setBarHeight(newHeight);\n    }\n    this.previousTop = scrollDetail.scrollTop;\n  }\n  /**\n   * Sets the bar height.\n   *\n   * @param height The new bar height.\n   */\n  setBarHeight(height) {\n    var _this$content2;\n    const collapsed = height <= this.finalHeight;\n    const expanded = height >= this.initialHeight;\n    this.element.classList.toggle('footer-collapsed', collapsed);\n    this.element.classList.toggle('footer-expanded', expanded);\n    (_this$content2 = this.content) === null || _this$content2 === void 0 || _this$content2.style.setProperty('--core-collapsible-footer-height', height + 'px');\n    this.previousHeight = height;\n  }\n  /**\n   * Wait until all <core-loading> children inside the page.\n   *\n   * @returns Promise resolved when loadings are done.\n   */\n  waitLoadingsDone() {\n    var _this5 = this;\n    return _asyncToGenerator(function* () {\n      const scrollElement = yield _this5.ionContent.getScrollElement();\n      yield Promise.all([yield CoreDirectivesRegistry.waitDirectivesReady(scrollElement, 'core-loading', CoreLoadingComponent), yield CoreDirectivesRegistry.waitDirectivesReady(_this5.element, 'core-loading', CoreLoadingComponent)]);\n    })();\n  }\n  /**\n   * @inheritdoc\n   */\n  ngOnDestroy() {\n    var _this6 = this;\n    return _asyncToGenerator(function* () {\n      var _this6$element, _this6$resizeListener, _this6$slotPromise, _this6$viewportPromis;\n      if (_this6.content) {\n        // Only reset the variables and classes if the collapsible footer hasn't changed (avoid race conditions).\n        if (_this6.content.getAttribute('data-collapsible-footer-id') === _this6.id) {\n          _this6.content.style.setProperty('--padding-bottom', _this6.initialPaddingBottom);\n          _this6.content.classList.remove('has-collapsible-footer');\n        }\n        if (_this6.contentScrollListener) {\n          _this6.content.removeEventListener('ionScroll', _this6.contentScrollListener);\n        }\n        if (_this6.endContentScrollListener) {\n          _this6.content.removeEventListener('ionScrollEnd', _this6.endContentScrollListener);\n        }\n        if (_this6.keyUpListener) {\n          _this6.content.removeEventListener('keyup', _this6.keyUpListener);\n        }\n      }\n      if (_this6.page && _this6.pageDidEnterListener) {\n        _this6.page.removeEventListener('ionViewDidEnter', _this6.pageDidEnterListener);\n      }\n      (_this6$element = _this6.element) === null || _this6$element === void 0 || _this6$element.remove();\n      (_this6$resizeListener = _this6.resizeListener) === null || _this6$resizeListener === void 0 || _this6$resizeListener.off();\n      (_this6$slotPromise = _this6.slotPromise) === null || _this6$slotPromise === void 0 || _this6$slotPromise.cancel();\n      (_this6$viewportPromis = _this6.viewportPromise) === null || _this6$viewportPromis === void 0 || _this6$viewportPromis.cancel();\n    })();\n  }\n}\n_class = CoreCollapsibleFooterDirective;\n_class.ɵfac = function CoreCollapsibleFooterDirective_Factory(t) {\n  return new (t || _class)(i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i1.IonContent));\n};\n_class.ɵdir = /*@__PURE__*/i0.ɵɵdefineDirective({\n  type: _class,\n  selectors: [[\"\", \"collapsible-footer\", \"\"]],\n  inputs: {\n    appearOnBottom: \"appearOnBottom\"\n  }\n});","map":{"version":3,"names":["CoreUtils","CoreMath","CoreDirectivesRegistry","CoreFormatTextDirective","CoreLoadingComponent","CoreDom","CoreCollapsibleFooterDirective","constructor","el","ionContent","appearOnBottom","id","initialHeight","finalHeight","initialPaddingBottom","previousTop","previousHeight","loadingHeight","element","nativeElement","ngOnInit","_this","_asyncToGenerator","_this$content","String","getUniqueId","isFalseOrZero","slotPromise","slotOnContent","waitLoadingsDone","waitFormatTextsRendered","content","closest","setAttribute","calculateHeight","onElementSlot","listenEvents","_this2","_this2$content","viewportPromise","waitToBeInViewport","classList","remove","nextTick","getBoundingClientRect","height","moduleNav","querySelector","add","style","setProperty","setBarHeight","_this3","_this3$content","_this3$element$parent","_this3$page","contains","parentElement","nodeName","appendChild","getPropertyValue","scroll","getScrollElement","scrollEvents","toggle","scrollIsBottom","addEventListener","contentScrollListener","e","onScroll","detail","endContentScrollListener","collapsed","expanded","newHeight","resizeListener","onWindowResize","page","undefined","pageDidEnterListener","keyUpListener","ev","key","document","activeElement","bottom","top","scrollIntoView","block","_this4","waitDirectivesReady","scrollDetail","scrollElement","maxScroll","scrollHeight","offsetHeight","scrollTop","clamp","_this$content2","_this5","Promise","all","ngOnDestroy","_this6","_this6$element","_this6$resizeListener","_this6$slotPromise","_this6$viewportPromis","getAttribute","removeEventListener","off","cancel","i0","ɵɵdirectiveInject","ElementRef","i1","IonContent","selectors","inputs"],"sources":["/home/toon/works/gitionic7/ionic-github/ionic/src/core/directives/collapsible-footer.ts"],"sourcesContent":["// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Directive, ElementRef, Input, OnDestroy, OnInit } from '@angular/core';\nimport { ScrollDetail } from '@ionic/core';\nimport { IonContent } from '@ionic/angular';\nimport { CoreUtils } from '@services/utils/utils';\nimport { CoreMath } from '@singletons/math';\nimport { CoreDirectivesRegistry } from '@singletons/directives-registry';\nimport { CoreFormatTextDirective } from './format-text';\nimport { CoreEventObserver } from '@singletons/events';\nimport { CoreLoadingComponent } from '@components/loading/loading';\nimport { CoreCancellablePromise } from '@classes/cancellable-promise';\nimport { CoreDom } from '@singletons/dom';\n\n/**\n * Directive to make an element fixed at the bottom collapsible when scrolling.\n *\n * Example usage:\n *\n * <div collapsible-footer>\n */\n@Directive({\n    selector: '[collapsible-footer]',\n})\nexport class CoreCollapsibleFooterDirective implements OnInit, OnDestroy {\n\n    @Input() appearOnBottom = false;\n\n    protected id = '0';\n    protected element: HTMLElement;\n    protected initialHeight = 48;\n    protected finalHeight = 0;\n    protected initialPaddingBottom = '0px';\n    protected previousTop = 0;\n    protected previousHeight = 0;\n    protected content?: HTMLIonContentElement | null;\n    protected loadingChangedListener?: CoreEventObserver;\n    protected contentScrollListener?: EventListener;\n    protected endContentScrollListener?: EventListener;\n    protected resizeListener?: CoreEventObserver;\n    protected slotPromise?: CoreCancellablePromise<void>;\n    protected viewportPromise?: CoreCancellablePromise<void>;\n    protected loadingHeight = false;\n    protected pageDidEnterListener?: EventListener;\n    protected keyUpListener?: EventListener;\n    protected page?: HTMLElement;\n\n    constructor(el: ElementRef, protected ionContent: IonContent) {\n        this.element = el.nativeElement;\n    }\n\n    /**\n     * @inheritdoc\n     */\n    async ngOnInit(): Promise<void> {\n        this.id = String(CoreUtils.getUniqueId('CoreCollapsibleFooterDirective'));\n\n        // Only if not present or explicitly falsy it will be false.\n        this.appearOnBottom = !CoreUtils.isFalseOrZero(this.appearOnBottom);\n        this.slotPromise = CoreDom.slotOnContent(this.element);\n\n        await this.slotPromise;\n        await this.waitLoadingsDone();\n        await this.waitFormatTextsRendered();\n\n        this.content = this.element.closest('ion-content');\n        this.content?.setAttribute('data-collapsible-footer-id', this.id);\n\n        await this.calculateHeight();\n\n        CoreDom.onElementSlot(this.element, () => {\n            this.calculateHeight();\n        });\n\n        this.listenEvents();\n    }\n\n    /**\n     * Calculate the height of the footer.\n     */\n    protected async calculateHeight(): Promise<void> {\n        if (this.loadingHeight) {\n            // Already calculating, return.\n            return;\n        }\n        this.loadingHeight = true;\n\n        this.viewportPromise = CoreDom.waitToBeInViewport(this.element);\n        await this.viewportPromise;\n\n        this.element.classList.remove('is-active');\n        await CoreUtils.nextTick();\n\n        // Set a minimum height value.\n        this.initialHeight = this.element.getBoundingClientRect().height || this.initialHeight;\n        const moduleNav = this.element.querySelector('core-course-module-navigation');\n        if (moduleNav) {\n            this.element.classList.add('has-module-nav');\n            this.finalHeight = this.initialHeight - (moduleNav.getBoundingClientRect().height);\n        }\n\n        this.previousHeight = this.initialHeight;\n\n        this.content?.style.setProperty('--core-collapsible-footer-max-height', this.initialHeight + 'px');\n        this.element.classList.add('is-active');\n\n        this.setBarHeight(this.initialHeight);\n        this.loadingHeight = false;\n    }\n\n    /**\n     * Setup event listeners.\n     */\n    protected async listenEvents(): Promise<void> {\n        if (!this.content || this.content?.classList.contains('has-collapsible-footer')) {\n            return;\n        }\n\n        this.content.classList.add('has-collapsible-footer');\n\n        // Move element to the nearest ion-content if it's not the parent.\n        if (this.element.parentElement?.nodeName != 'ION-CONTENT') {\n            this.content.appendChild(this.element);\n        }\n\n        // Set a padding to not overlap elements.\n        this.initialPaddingBottom = this.content.style.getPropertyValue('--padding-bottom') || this.initialPaddingBottom;\n        this.content.style.setProperty(\n            '--padding-bottom',\n            `calc(${this.initialPaddingBottom} + var(--core-collapsible-footer-max-height, 0px))`,\n        );\n\n        const scroll = await this.content.getScrollElement();\n        this.content.scrollEvents = true;\n\n        // Init shadow.\n        this.content.classList.toggle('core-footer-shadow', !CoreDom.scrollIsBottom(scroll));\n\n        this.content.addEventListener('ionScroll', this.contentScrollListener = (e: CustomEvent<ScrollDetail>): void => {\n            if (!this.content) {\n                return;\n            }\n\n            this.onScroll(e.detail, scroll);\n        });\n\n        this.content.addEventListener('ionScrollEnd', this.endContentScrollListener = (): void => {\n            if (!this.content) {\n                return;\n            }\n\n            const height = this.previousHeight;\n            const collapsed = height <= this.finalHeight;\n            const expanded = height >= this.initialHeight;\n\n            if (!collapsed && !expanded) {\n                // Finish opening or closing the bar.\n                const newHeight = (height - this.finalHeight) < (this.initialHeight - this.finalHeight) / 2\n                    ? this.finalHeight\n                    : this.initialHeight;\n\n                this.setBarHeight(newHeight);\n            }\n        });\n\n        this.resizeListener = CoreDom.onWindowResize(() => {\n            this.calculateHeight();\n        }, 50);\n\n        this.page = this.content.closest<HTMLElement>('.ion-page') || undefined;\n        this.page?.addEventListener(\n            'ionViewDidEnter',\n            this.pageDidEnterListener = () => {\n                this.calculateHeight();\n            },\n        );\n\n        // Handle scroll when navigating using tab key and the selected element is behind the footer.\n        this.content.addEventListener('keyup', this.keyUpListener = (ev: KeyboardEvent) => {\n            if (ev.key !== 'Tab' || !document.activeElement) {\n                return;\n            }\n\n            if (document.activeElement.getBoundingClientRect().bottom > this.element.getBoundingClientRect().top) {\n                document.activeElement.scrollIntoView({ block: 'center' });\n            }\n        });\n    }\n\n    /**\n     * Wait until all <core-format-text> children inside the element are done rendering.\n     */\n    protected async waitFormatTextsRendered(): Promise<void> {\n        await CoreDirectivesRegistry.waitDirectivesReady(this.element, 'core-format-text', CoreFormatTextDirective);\n    }\n\n    /**\n     * On scroll function.\n     *\n     * @param scrollDetail Scroll detail object.\n     * @param scrollElement Scroll element to calculate maxScroll.\n     */\n    protected onScroll(scrollDetail: ScrollDetail, scrollElement: HTMLElement): void {\n        const maxScroll = scrollElement.scrollHeight - scrollElement.offsetHeight;\n        if (scrollDetail.scrollTop <= 0 || (this.appearOnBottom && scrollDetail.scrollTop >= maxScroll)) {\n            // Reset.\n            this.setBarHeight(this.initialHeight);\n        } else {\n            let newHeight = this.previousHeight - (scrollDetail.scrollTop - this.previousTop);\n            newHeight = CoreMath.clamp(newHeight, this.finalHeight, this.initialHeight);\n\n            this.setBarHeight(newHeight);\n        }\n        this.previousTop = scrollDetail.scrollTop;\n    }\n\n    /**\n     * Sets the bar height.\n     *\n     * @param height The new bar height.\n     */\n    protected setBarHeight(height: number): void {\n        const collapsed = height <= this.finalHeight;\n        const expanded = height >= this.initialHeight;\n        this.element.classList.toggle('footer-collapsed', collapsed);\n        this.element.classList.toggle('footer-expanded', expanded);\n        this.content?.style.setProperty('--core-collapsible-footer-height', height + 'px');\n        this.previousHeight = height;\n    }\n\n    /**\n     * Wait until all <core-loading> children inside the page.\n     *\n     * @returns Promise resolved when loadings are done.\n     */\n    protected async waitLoadingsDone(): Promise<void> {\n        const scrollElement = await this.ionContent.getScrollElement();\n\n        await Promise.all([\n            await CoreDirectivesRegistry.waitDirectivesReady(scrollElement, 'core-loading', CoreLoadingComponent),\n            await CoreDirectivesRegistry.waitDirectivesReady(this.element, 'core-loading', CoreLoadingComponent),\n        ]);\n    }\n\n    /**\n     * @inheritdoc\n     */\n    async ngOnDestroy(): Promise<void> {\n        if (this.content) {\n            // Only reset the variables and classes if the collapsible footer hasn't changed (avoid race conditions).\n            if (this.content.getAttribute('data-collapsible-footer-id') === this.id) {\n                this.content.style.setProperty('--padding-bottom', this.initialPaddingBottom);\n                this.content.classList.remove('has-collapsible-footer');\n            }\n\n            if (this.contentScrollListener) {\n                this.content.removeEventListener('ionScroll', this.contentScrollListener);\n            }\n            if (this.endContentScrollListener) {\n                this.content.removeEventListener('ionScrollEnd', this.endContentScrollListener);\n            }\n            if (this.keyUpListener) {\n                this.content.removeEventListener('keyup', this.keyUpListener);\n            }\n        }\n\n        if (this.page && this.pageDidEnterListener) {\n            this.page.removeEventListener('ionViewDidEnter', this.pageDidEnterListener);\n        }\n\n        this.element?.remove();\n        this.resizeListener?.off();\n        this.slotPromise?.cancel();\n        this.viewportPromise?.cancel();\n    }\n\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
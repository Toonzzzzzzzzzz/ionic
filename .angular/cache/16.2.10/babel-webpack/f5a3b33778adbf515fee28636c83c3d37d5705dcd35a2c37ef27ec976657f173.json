{"ast":null,"code":"import _asyncToGenerator from \"/home/toon/works/gitionic7/ionic-github/ionic/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _class;\nimport { CoreNavigator } from '@services/navigator';\nimport { CoreSites } from '@services/sites';\nimport { makeSingleton, Translate } from '@singletons';\nimport * as i0 from \"@angular/core\";\n/**\n * Service that provides some features regarding users information.\n */\nexport class CoreUserHelperProvider {\n  /**\n   * Formats a user address, concatenating address, city and country.\n   *\n   * @param address Address.\n   * @param city City.\n   * @param country Country.\n   * @returns Formatted address.\n   * @deprecated since 4.3. Not used anymore.\n   */\n  formatAddress(address, city, country) {\n    const separator = Translate.instant('core.listsep');\n    let values = [address, city, country];\n    values = values.filter(value => value && value.length > 0);\n    return values.join(separator + ' ');\n  }\n  /**\n   * Formats a user role list, translating and concatenating them.\n   *\n   * @param roles List of user roles.\n   * @returns The formatted roles.\n   */\n  formatRoleList(roles) {\n    if (!roles || roles.length <= 0) {\n      return '';\n    }\n    const separator = Translate.instant('core.listsep');\n    return roles.map(value => {\n      const translation = Translate.instant('core.user.' + value.shortname);\n      return translation.indexOf('core.user.') < 0 ? translation : value.shortname;\n    }).join(separator + ' ');\n  }\n  /**\n   * Open a page with instructions on how to complete profile.\n   *\n   * @param siteId The site ID. Undefined for current site.\n   */\n  openCompleteProfile(siteId) {\n    return _asyncToGenerator(function* () {\n      var _siteId;\n      const currentSite = CoreSites.getCurrentSite();\n      siteId = (_siteId = siteId) !== null && _siteId !== void 0 ? _siteId : currentSite === null || currentSite === void 0 ? void 0 : currentSite.getId();\n      if (!currentSite || siteId !== currentSite.getId()) {\n        return; // Site that triggered the event is not current site.\n      }\n      // If current page is already complete profile, stop.\n      if (CoreNavigator.isCurrent('/user/completeprofile')) {\n        return;\n      }\n      yield CoreNavigator.navigate('/user/completeprofile', {\n        params: {\n          siteId\n        },\n        reset: true\n      });\n    })();\n  }\n  /**\n   * Get the user initials.\n   *\n   * @param user User object.\n   * @returns Promise resolved with the user data.\n   */\n  getUserInitials(user) {\n    var _user$firstname, _user$lastname;\n    if (!user.firstname && !user.lastname) {\n      // @TODO: Use local info or check WS to get initials from.\n      return '';\n    }\n    return (((_user$firstname = user.firstname) === null || _user$firstname === void 0 ? void 0 : _user$firstname.charAt(0)) || '') + (((_user$lastname = user.lastname) === null || _user$lastname === void 0 ? void 0 : _user$lastname.charAt(0)) || '');\n  }\n  /**\n   * Translates legacy timezone names.\n   *\n   * @param tz Timezone name.\n   * @returns Readable timezone name.\n   */\n  translateLegacyTimezone(tz) {\n    var _CoreUserHelperProvid;\n    return (_CoreUserHelperProvid = CoreUserHelperProvider.LEGACY_TIMEZONES[tz]) !== null && _CoreUserHelperProvid !== void 0 ? _CoreUserHelperProvid : tz;\n  }\n}\n_class = CoreUserHelperProvider;\n_class.LEGACY_TIMEZONES = {\n  '-13.0': 'Australia/Perth',\n  '-12.5': 'Etc/GMT+12',\n  '-12.0': 'Etc/GMT+12',\n  '-11.5': 'Etc/GMT+11',\n  '-11.0': 'Etc/GMT+11',\n  '-10.5': 'Etc/GMT+10',\n  '-10.0': 'Etc/GMT+10',\n  '-9.5': 'Etc/GMT+9',\n  '-9.0': 'Etc/GMT+9',\n  '-8.5': 'Etc/GMT+8',\n  '-8.0': 'Etc/GMT+8',\n  '-7.5': 'Etc/GMT+7',\n  '-7.0': 'Etc/GMT+7',\n  '-6.5': 'Etc/GMT+6',\n  '-6.0': 'Etc/GMT+6',\n  '-5.5': 'Etc/GMT+5',\n  '-5.0': 'Etc/GMT+5',\n  '-4.5': 'Etc/GMT+4',\n  '-4.0': 'Etc/GMT+4',\n  '-3.5': 'Etc/GMT+3',\n  '-3.0': 'Etc/GMT+3',\n  '-2.5': 'Etc/GMT+2',\n  '-2.0': 'Etc/GMT+2',\n  '-1.5': 'Etc/GMT+1',\n  '-1.0': 'Etc/GMT+1',\n  '-0.5': 'Etc/GMT',\n  '0': 'Etc/GMT',\n  '0.0': 'Etc/GMT',\n  '0.5': 'Etc/GMT',\n  '1.0': 'Etc/GMT-1',\n  '1.5': 'Etc/GMT-1',\n  '2.0': 'Etc/GMT-2',\n  '2.5': 'Etc/GMT-2',\n  '3.0': 'Etc/GMT-3',\n  '3.5': 'Etc/GMT-3',\n  '4.0': 'Etc/GMT-4',\n  '4.5': 'Asia/Kabul',\n  '5.0': 'Etc/GMT-5',\n  '5.5': 'Asia/Kolkata',\n  '6.0': 'Etc/GMT-6',\n  '6.5': 'Asia/Rangoon',\n  '7.0': 'Etc/GMT-7',\n  '7.5': 'Etc/GMT-7',\n  '8.0': 'Etc/GMT-8',\n  '8.5': 'Etc/GMT-8',\n  '9.0': 'Etc/GMT-9',\n  '9.5': 'Australia/Darwin',\n  '10.0': 'Etc/GMT-10',\n  '10.5': 'Etc/GMT-10',\n  '11.0': 'Etc/GMT-11',\n  '11.5': 'Etc/GMT-11',\n  '12.0': 'Etc/GMT-12',\n  '12.5': 'Etc/GMT-12',\n  '13.0': 'Etc/GMT-13'\n};\n_class.ɵfac = function CoreUserHelperProvider_Factory(t) {\n  return new (t || _class)();\n};\n_class.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: _class,\n  factory: _class.ɵfac,\n  providedIn: 'root'\n});\nexport const CoreUserHelper = makeSingleton(CoreUserHelperProvider);","map":{"version":3,"names":["CoreNavigator","CoreSites","makeSingleton","Translate","CoreUserHelperProvider","formatAddress","address","city","country","separator","instant","values","filter","value","length","join","formatRoleList","roles","map","translation","shortname","indexOf","openCompleteProfile","siteId","_asyncToGenerator","_siteId","currentSite","getCurrentSite","getId","isCurrent","navigate","params","reset","getUserInitials","user","_user$firstname","_user$lastname","firstname","lastname","charAt","translateLegacyTimezone","tz","_CoreUserHelperProvid","LEGACY_TIMEZONES","_class","factory","ɵfac","providedIn","CoreUserHelper"],"sources":["/home/toon/works/gitionic7/ionic-github/ionic/src/core/features/user/services/user-helper.ts"],"sourcesContent":["// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Injectable } from '@angular/core';\nimport { CoreNavigator } from '@services/navigator';\nimport { CoreSites } from '@services/sites';\n\nimport { makeSingleton, Translate } from '@singletons';\nimport { CoreUserProfile, CoreUserRole } from './user';\n\n/**\n * Service that provides some features regarding users information.\n */\n@Injectable({ providedIn: 'root' })\nexport class CoreUserHelperProvider {\n\n    protected static readonly LEGACY_TIMEZONES = {\n        '-13.0': 'Australia/Perth',\n        '-12.5': 'Etc/GMT+12',\n        '-12.0': 'Etc/GMT+12',\n        '-11.5': 'Etc/GMT+11',\n        '-11.0': 'Etc/GMT+11',\n        '-10.5': 'Etc/GMT+10',\n        '-10.0': 'Etc/GMT+10',\n        '-9.5': 'Etc/GMT+9',\n        '-9.0': 'Etc/GMT+9',\n        '-8.5': 'Etc/GMT+8',\n        '-8.0': 'Etc/GMT+8',\n        '-7.5': 'Etc/GMT+7',\n        '-7.0': 'Etc/GMT+7',\n        '-6.5': 'Etc/GMT+6',\n        '-6.0': 'Etc/GMT+6',\n        '-5.5': 'Etc/GMT+5',\n        '-5.0': 'Etc/GMT+5',\n        '-4.5': 'Etc/GMT+4',\n        '-4.0': 'Etc/GMT+4',\n        '-3.5': 'Etc/GMT+3',\n        '-3.0': 'Etc/GMT+3',\n        '-2.5': 'Etc/GMT+2',\n        '-2.0': 'Etc/GMT+2',\n        '-1.5': 'Etc/GMT+1',\n        '-1.0': 'Etc/GMT+1',\n        '-0.5': 'Etc/GMT',\n        '0': 'Etc/GMT',\n        '0.0': 'Etc/GMT',\n        '0.5': 'Etc/GMT',\n        '1.0': 'Etc/GMT-1',\n        '1.5': 'Etc/GMT-1',\n        '2.0': 'Etc/GMT-2',\n        '2.5': 'Etc/GMT-2',\n        '3.0': 'Etc/GMT-3',\n        '3.5': 'Etc/GMT-3',\n        '4.0': 'Etc/GMT-4',\n        '4.5': 'Asia/Kabul',\n        '5.0': 'Etc/GMT-5',\n        '5.5': 'Asia/Kolkata',\n        '6.0': 'Etc/GMT-6',\n        '6.5': 'Asia/Rangoon',\n        '7.0': 'Etc/GMT-7',\n        '7.5': 'Etc/GMT-7',\n        '8.0': 'Etc/GMT-8',\n        '8.5': 'Etc/GMT-8',\n        '9.0': 'Etc/GMT-9',\n        '9.5': 'Australia/Darwin',\n        '10.0': 'Etc/GMT-10',\n        '10.5': 'Etc/GMT-10',\n        '11.0': 'Etc/GMT-11',\n        '11.5': 'Etc/GMT-11',\n        '12.0': 'Etc/GMT-12',\n        '12.5': 'Etc/GMT-12',\n        '13.0': 'Etc/GMT-13',\n    };\n\n    /**\n     * Formats a user address, concatenating address, city and country.\n     *\n     * @param address Address.\n     * @param city City.\n     * @param country Country.\n     * @returns Formatted address.\n     * @deprecated since 4.3. Not used anymore.\n     */\n    formatAddress(address?: string, city?: string, country?: string): string {\n        const separator = Translate.instant('core.listsep');\n        let values = [address, city, country];\n\n        values = values.filter((value) => value && value.length > 0);\n\n        return values.join(separator + ' ');\n    }\n\n    /**\n     * Formats a user role list, translating and concatenating them.\n     *\n     * @param roles List of user roles.\n     * @returns The formatted roles.\n     */\n    formatRoleList(roles?: CoreUserRole[]): string {\n        if (!roles || roles.length <= 0) {\n            return '';\n        }\n\n        const separator = Translate.instant('core.listsep');\n\n        return roles.map((value) => {\n            const translation = Translate.instant('core.user.' + value.shortname);\n\n            return translation.indexOf('core.user.') < 0 ? translation : value.shortname;\n        }).join(separator + ' ');\n    }\n\n    /**\n     * Open a page with instructions on how to complete profile.\n     *\n     * @param siteId The site ID. Undefined for current site.\n     */\n    async openCompleteProfile(siteId?: string): Promise<void> {\n        const currentSite = CoreSites.getCurrentSite();\n        siteId = siteId ?? currentSite?.getId();\n\n        if (!currentSite || siteId !== currentSite.getId()) {\n            return; // Site that triggered the event is not current site.\n        }\n\n        // If current page is already complete profile, stop.\n        if (CoreNavigator.isCurrent('/user/completeprofile')) {\n            return;\n        }\n\n        await CoreNavigator.navigate('/user/completeprofile', { params: { siteId }, reset: true });\n    }\n\n    /**\n     * Get the user initials.\n     *\n     * @param user User object.\n     * @returns Promise resolved with the user data.\n     */\n    getUserInitials(user: Partial<CoreUserProfile>): string {\n        if (!user.firstname && !user.lastname) {\n            // @TODO: Use local info or check WS to get initials from.\n            return '';\n        }\n\n        return (user.firstname?.charAt(0) || '') + (user.lastname?.charAt(0) || '');\n    }\n\n    /**\n     * Translates legacy timezone names.\n     *\n     * @param tz Timezone name.\n     * @returns Readable timezone name.\n     */\n    translateLegacyTimezone(tz: string): string {\n        return CoreUserHelperProvider.LEGACY_TIMEZONES[tz] ?? tz;\n    }\n\n}\n\nexport const CoreUserHelper = makeSingleton(CoreUserHelperProvider);\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
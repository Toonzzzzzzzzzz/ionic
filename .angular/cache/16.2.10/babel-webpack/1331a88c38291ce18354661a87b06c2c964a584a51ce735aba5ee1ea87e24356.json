{"ast":null,"code":"import _asyncToGenerator from \"/home/toon/works/gitionic7/ionic-github/ionic/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _class;\n// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nimport { EventEmitter } from '@angular/core';\nimport { IonicSlides } from '@ionic/angular';\nimport { CoreSites } from '@services/sites';\nimport { CoreFilepool } from '@services/filepool';\nimport { CoreDomUtils } from '@services/utils/dom';\nimport { CoreUrlUtils } from '@services/utils/url';\nimport { CoreUtils } from '@services/utils/utils';\nimport { Translate } from '@singletons';\nimport { CoreEvents } from '@singletons/events';\nimport { CoreEditorOffline } from '../../services/editor-offline';\nimport { CoreDirectivesRegistry } from '@singletons/directives-registry';\nimport { CoreLoadingComponent } from '@components/loading/loading';\nimport { CoreScreen } from '@services/screen';\nimport { CoreDom } from '@singletons/dom';\nimport { CorePlatform } from '@services/platform';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ionic/angular\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"../../../../directives/fa-icon\";\nimport * as i4 from \"@ngx-translate/core\";\nconst _c0 = [\"editor\"];\nconst _c1 = [\"textarea\"];\nconst _c2 = [\"toolbar\"];\nconst _c3 = [\"swiperRef\"];\nfunction CoreEditorRichTextEditorComponent_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 27);\n    i0.ɵɵelement(1, \"ion-icon\", 28);\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(3, 1, ctx_r2.infoMessage), \" \");\n  }\n}\nfunction CoreEditorRichTextEditorComponent_button_8_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 29);\n    i0.ɵɵlistener(\"click\", function CoreEditorRichTextEditorComponent_button_8_Template_button_click_0_listener($event) {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.toolbarPrev($event));\n    })(\"keyup\", function CoreEditorRichTextEditorComponent_button_8_Template_button_keyup_0_listener($event) {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r11 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r11.toolbarPrev($event));\n    })(\"mousedown\", function CoreEditorRichTextEditorComponent_button_8_Template_button_mousedown_0_listener($event) {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r12 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r12.downAction($event));\n    })(\"keydown\", function CoreEditorRichTextEditorComponent_button_8_Template_button_keydown_0_listener($event) {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r13 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r13.downAction($event));\n    });\n    i0.ɵɵpipe(1, \"translate\");\n    i0.ɵɵelement(2, \"ion-icon\", 30);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"tabindex\", ctx_r4.toolbarPrevHidden ? -1 : 0);\n    i0.ɵɵattribute(\"disabled\", ctx_r4.toolbarPrevHidden ? \"true\" : null)(\"aria-label\", i0.ɵɵpipeBind1(1, 3, \"core.previous\"));\n  }\n}\nfunction CoreEditorRichTextEditorComponent_swiper_slide_61_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r15 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"swiper-slide\")(1, \"button\", 22);\n    i0.ɵɵlistener(\"click\", function CoreEditorRichTextEditorComponent_swiper_slide_61_Template_button_click_1_listener($event) {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r14 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r14.scanQR($event));\n    })(\"keyup\", function CoreEditorRichTextEditorComponent_swiper_slide_61_Template_button_keyup_1_listener($event) {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r16 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r16.scanQR($event));\n    })(\"mousedown\", function CoreEditorRichTextEditorComponent_swiper_slide_61_Template_button_mousedown_1_listener($event) {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r17 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r17.stopBubble($event));\n    })(\"keydown\", function CoreEditorRichTextEditorComponent_swiper_slide_61_Template_button_keydown_1_listener($event) {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r18 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r18.stopBubble($event));\n    });\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelement(3, \"ion-icon\", 31);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r6 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"disabled\", !ctx_r6.rteEnabled)(\"title\", i0.ɵɵpipeBind1(2, 2, \"core.scanqr\"));\n  }\n}\nfunction CoreEditorRichTextEditorComponent_swiper_slide_66_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r20 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"swiper-slide\")(1, \"button\", 25);\n    i0.ɵɵlistener(\"click\", function CoreEditorRichTextEditorComponent_swiper_slide_66_Template_button_click_1_listener($event) {\n      i0.ɵɵrestoreView(_r20);\n      const ctx_r19 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r19.hideToolbar($event, true));\n    })(\"keyup\", function CoreEditorRichTextEditorComponent_swiper_slide_66_Template_button_keyup_1_listener($event) {\n      i0.ɵɵrestoreView(_r20);\n      const ctx_r21 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r21.hideToolbar($event, true));\n    })(\"mousedown\", function CoreEditorRichTextEditorComponent_swiper_slide_66_Template_button_mousedown_1_listener($event) {\n      i0.ɵɵrestoreView(_r20);\n      const ctx_r22 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r22.downAction($event));\n    })(\"keydown\", function CoreEditorRichTextEditorComponent_swiper_slide_66_Template_button_keydown_1_listener($event) {\n      i0.ɵɵrestoreView(_r20);\n      const ctx_r23 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r23.downAction($event));\n    });\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelement(3, \"ion-icon\", 32);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"title\", i0.ɵɵpipeBind1(2, 1, \"core.editor.hidetoolbar\"));\n  }\n}\nfunction CoreEditorRichTextEditorComponent_button_67_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r25 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 29);\n    i0.ɵɵlistener(\"click\", function CoreEditorRichTextEditorComponent_button_67_Template_button_click_0_listener($event) {\n      i0.ɵɵrestoreView(_r25);\n      const ctx_r24 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r24.toolbarNext($event));\n    })(\"keyup\", function CoreEditorRichTextEditorComponent_button_67_Template_button_keyup_0_listener($event) {\n      i0.ɵɵrestoreView(_r25);\n      const ctx_r26 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r26.toolbarNext($event));\n    })(\"mousedown\", function CoreEditorRichTextEditorComponent_button_67_Template_button_mousedown_0_listener($event) {\n      i0.ɵɵrestoreView(_r25);\n      const ctx_r27 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r27.downAction($event));\n    })(\"keydown\", function CoreEditorRichTextEditorComponent_button_67_Template_button_keydown_0_listener($event) {\n      i0.ɵɵrestoreView(_r25);\n      const ctx_r28 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r28.downAction($event));\n    });\n    i0.ɵɵpipe(1, \"translate\");\n    i0.ɵɵelement(2, \"ion-icon\", 33);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r8 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"tabindex\", ctx_r8.toolbarNextHidden ? -1 : 0);\n    i0.ɵɵattribute(\"disabled\", ctx_r8.toolbarNextHidden ? \"true\" : null)(\"aria-label\", i0.ɵɵpipeBind1(1, 3, \"core.next\"));\n  }\n}\n/**\n * Component to display a rich text editor if enabled.\n *\n * If enabled, this component will show a rich text editor. Otherwise it'll show a regular textarea.\n *\n * Example:\n * <core-rich-text-editor [control]=\"control\" [placeholder]=\"field.name\"></core-rich-text-editor>\n */\nexport class CoreEditorRichTextEditorComponent {\n  set swiperRef(swiperRef) {\n    /**\n     * This setTimeout waits for Ionic's async initialization to complete.\n     * Otherwise, an outdated swiper reference will be used.\n     */\n    setTimeout(() => {\n      var _swiperRef$nativeElem;\n      if ((_swiperRef$nativeElem = swiperRef.nativeElement) !== null && _swiperRef$nativeElem !== void 0 && _swiperRef$nativeElem.swiper) {\n        this.toolbarSlides = swiperRef.nativeElement.swiper;\n        this.toolbarSlides.changeLanguageDirection(CorePlatform.isRTL ? 'rtl' : 'ltr');\n        Object.keys(this.swiperOpts).forEach(key => {\n          if (this.toolbarSlides) {\n            this.toolbarSlides.params[key] = this.swiperOpts[key];\n          }\n        });\n      }\n    }, 0);\n  }\n  constructor(content, elementRef) {\n    this.content = content;\n    // Based on: https://github.com/judgewest2000/Ionic3RichText/\n    // @todo Anchor button, fullscreen...\n    // @todo Textarea height is not being updated when editor is resized. Height is calculated if any css is changed.\n    // @todo Implement ControlValueAccessor https://angular.io/api/forms/ControlValueAccessor.\n    this.placeholder = ''; // Placeholder to set in textarea.\n    this.name = 'core-rich-text-editor'; // Name to set to the textarea.\n    this.DRAFT_AUTOSAVE_FREQUENCY = 30000;\n    this.RESTORE_MESSAGE_CLEAR_TIME = 6000;\n    this.SAVE_MESSAGE_CLEAR_TIME = 2000;\n    this.minHeight = 200; // Minimum height of the editor.\n    this.isCurrentView = true;\n    this.toolbarButtonWidth = 44;\n    this.toolbarArrowWidth = 44;\n    this.lastDraft = '';\n    this.draftWasRestored = false;\n    this.rteEnabled = false;\n    this.isPhone = false;\n    this.toolbarHidden = false;\n    this.toolbarArrows = false;\n    this.toolbarPrevHidden = true;\n    this.toolbarNextHidden = false;\n    this.canScanQR = false;\n    this.toolbarStyles = {\n      strong: 'false',\n      em: 'false',\n      u: 'false',\n      strike: 'false',\n      p: 'false',\n      h3: 'false',\n      h4: 'false',\n      h5: 'false',\n      ul: 'false',\n      ol: 'false'\n    };\n    this.swiperOpts = {\n      modules: [IonicSlides],\n      slidesPerView: 6,\n      centerInsufficientSlides: true,\n      watchSlidesProgress: true\n    };\n    this.contentChanged = new EventEmitter();\n    this.element = elementRef.nativeElement;\n    this.pageInstance = 'app_' + Date.now(); // Generate a \"unique\" ID based on timestamp.\n  }\n  /**\n   * @inheritdoc\n   */\n  ngOnInit() {\n    this.canScanQR = CoreUtils.canScanQR();\n    this.isPhone = CoreScreen.isMobile;\n    this.toolbarHidden = this.isPhone;\n  }\n  /**\n   * @inheritdoc\n   */\n  ngAfterViewInit() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      var _this$editor, _this$control, _this$control2, _this$control3;\n      _this.rteEnabled = yield CoreDomUtils.isRichTextEditorEnabled();\n      yield _this.waitLoadingsDone();\n      // Setup the editor.\n      _this.editorElement = (_this$editor = _this.editor) === null || _this$editor === void 0 ? void 0 : _this$editor.nativeElement;\n      _this.setContent((_this$control = _this.control) === null || _this$control === void 0 ? void 0 : _this$control.value);\n      _this.originalContent = (_this$control2 = _this.control) === null || _this$control2 === void 0 ? void 0 : _this$control2.value;\n      _this.lastDraft = (_this$control3 = _this.control) === null || _this$control3 === void 0 ? void 0 : _this$control3.value;\n      // Use paragraph on enter.\n      // eslint-disable-next-line deprecation/deprecation\n      document.execCommand('DefaultParagraphSeparator', false, 'p');\n      _this.maximizeEditorSize();\n      _this.setListeners();\n      _this.updateToolbarButtons();\n      if (_this.elementId) {\n        // Prepend elementId with 'id_' like in web. Don't use a setter for this because the value shouldn't change.\n        _this.elementId = 'id_' + _this.elementId;\n        _this.element.setAttribute('id', _this.elementId);\n      }\n      // Update tags for a11y.\n      _this.replaceTags(['b', 'i'], ['strong', 'em']);\n      if (_this.shouldAutoSaveDrafts()) {\n        _this.restoreDraft();\n        _this.autoSaveDrafts();\n        _this.deleteDraftOnSubmitOrCancel();\n      }\n      const ionItem = _this.element.closest('ion-item');\n      if (!ionItem) {\n        return;\n      }\n      ionItem.classList.add('item-rte');\n      const label = ionItem.querySelector('ion-label');\n      if (!label) {\n        return;\n      }\n      const updateArialabelledBy = () => {\n        var _label$getAttribute;\n        return _this.ariaLabelledBy = (_label$getAttribute = label.getAttribute('id')) !== null && _label$getAttribute !== void 0 ? _label$getAttribute : undefined;\n      };\n      _this.labelObserver = new MutationObserver(updateArialabelledBy);\n      _this.labelObserver.observe(label, {\n        attributes: true,\n        attributeFilter: ['id']\n      });\n      updateArialabelledBy();\n    })();\n  }\n  /**\n   * Set listeners and observers.\n   */\n  setListeners() {\n    var _this$control4;\n    // Listen for changes on the control to update the editor (if it is updated from outside of this component).\n    this.valueChangeSubscription = (_this$control4 = this.control) === null || _this$control4 === void 0 ? void 0 : _this$control4.valueChanges.subscribe(newValue => {\n      if (this.draftWasRestored && this.originalContent == newValue) {\n        var _this$control5;\n        // A draft was restored and the content hasn't changed in the site. Use the draft value instead of this one.\n        (_this$control5 = this.control) === null || _this$control5 === void 0 || _this$control5.setValue(this.lastDraft, {\n          emitEvent: false\n        });\n        return;\n      }\n      // Apply the new content.\n      this.setContent(newValue);\n      this.originalContent = newValue;\n      this.infoMessage = undefined;\n      // Save a draft so the original content is saved.\n      this.lastDraft = newValue;\n      CoreEditorOffline.saveDraft(this.contextLevel || '', this.contextInstanceId || 0, this.elementId || '', this.draftExtraParams || {}, this.pageInstance, newValue, newValue);\n    });\n    this.resizeListener = CoreDom.onWindowResize(() => {\n      this.windowResized();\n    }, 50);\n    document.addEventListener('selectionchange', this.selectionChangeFunction = () => this.updateToolbarStyles());\n    this.keyboardObserver = CoreEvents.on(CoreEvents.KEYBOARD_CHANGE, () => {\n      // Opening or closing the keyboard also calls the resize function, but sometimes the resize is called too soon.\n      // Check the height again, now the window height should have been updated.\n      this.maximizeEditorSize();\n    });\n    // Change the side when the language changes.\n    this.languageChangedSubscription = Translate.onLangChange.subscribe(() => {\n      setTimeout(() => {\n        var _this$toolbarSlides;\n        (_this$toolbarSlides = this.toolbarSlides) === null || _this$toolbarSlides === void 0 || _this$toolbarSlides.changeLanguageDirection(CorePlatform.isRTL ? 'rtl' : 'ltr');\n      });\n    });\n  }\n  /**\n   * Handle keydown events in the editor.\n   *\n   * @param event Event\n   */\n  onKeyDown(event) {\n    this.onChange();\n    const shortcutId = this.getShortcutId(event);\n    const commands = this.getShortcutCommands();\n    const command = commands[shortcutId];\n    if (!command) {\n      return;\n    }\n    this.stopBubble(event);\n    this.executeCommand(command);\n  }\n  /**\n   * Resize editor to maximize the space occupied.\n   */\n  maximizeEditorSize() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      // Editor is ready, adjust Height if needed.\n      const blankHeight = yield _this2.getBlankHeightInContent();\n      const newHeight = blankHeight + _this2.element.getBoundingClientRect().height;\n      if (newHeight > _this2.minHeight) {\n        _this2.element.style.setProperty('--core-rte-height', newHeight - 1 + 'px');\n      } else {\n        _this2.element.style.removeProperty('--core-rte-height');\n      }\n    })();\n  }\n  /**\n   * Wait until all <core-loading> children inside the page.\n   *\n   * @returns Promise resolved when loadings are done.\n   */\n  waitLoadingsDone() {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      _this3.domPromise = CoreDom.waitToBeInDOM(_this3.element);\n      yield _this3.domPromise;\n      const page = _this3.element.closest('.ion-page');\n      if (!page) {\n        return;\n      }\n      yield CoreDirectivesRegistry.waitDirectivesReady(page, 'core-loading', CoreLoadingComponent);\n    })();\n  }\n  /**\n   * Get the height of the space in blank at the end of the page.\n   *\n   * @returns Blank height in px. Will be negative if no blank space.\n   */\n  getBlankHeightInContent() {\n    var _this4 = this;\n    return _asyncToGenerator(function* () {\n      yield CoreUtils.nextTicks(5); // Ensure content is completely loaded in the DOM.\n      let content = _this4.element.closest('ion-content');\n      const contentHeight = yield CoreDomUtils.getContentHeight(_this4.content);\n      // Get first children with content, not fixed.\n      let scrollContentHeight = 0;\n      while (scrollContentHeight == 0 && (_content = content) !== null && _content !== void 0 && _content.children) {\n        var _content;\n        const children = Array.from(content.children).filter(element => element.slot !== 'fixed' && !element.classList.contains('core-loading-container'));\n        scrollContentHeight = children.map(element => element.getBoundingClientRect().height).reduce((a, b) => a + b, 0);\n        content = children[0];\n      }\n      return contentHeight - scrollContentHeight;\n    })();\n  }\n  /**\n   * On change function to sync with form data.\n   */\n  onChange() {\n    var _this$control10;\n    if (this.rteEnabled) {\n      if (!this.editorElement) {\n        return;\n      }\n      if (this.isNullOrWhiteSpace(this.editorElement.textContent)) {\n        this.clearText();\n      } else {\n        var _this$control6, _this$control7;\n        // The textarea and the form control must receive the original URLs.\n        this.restoreExternalContent();\n        // Don't emit event so our valueChanges doesn't get notified by this change.\n        (_this$control6 = this.control) === null || _this$control6 === void 0 || _this$control6.setValue(this.editorElement.innerHTML, {\n          emitEvent: false\n        });\n        (_this$control7 = this.control) === null || _this$control7 === void 0 || _this$control7.markAsDirty();\n        if (this.textarea) {\n          this.textarea.value = this.editorElement.innerHTML;\n        }\n        // Treat URLs again for the editor.\n        this.treatExternalContent();\n      }\n    } else {\n      if (!this.textarea) {\n        return;\n      }\n      if (this.isNullOrWhiteSpace(this.textarea.value || '')) {\n        this.clearText();\n      } else {\n        var _this$control8, _this$control9;\n        // Don't emit event so our valueChanges doesn't get notified by this change.\n        (_this$control8 = this.control) === null || _this$control8 === void 0 || _this$control8.setValue(this.textarea.value, {\n          emitEvent: false\n        });\n        (_this$control9 = this.control) === null || _this$control9 === void 0 || _this$control9.markAsDirty();\n      }\n    }\n    this.contentChanged.emit((_this$control10 = this.control) === null || _this$control10 === void 0 ? void 0 : _this$control10.value);\n  }\n  /**\n   * Set the caret position on the character number.\n   *\n   * @param parent Parent where to set the position.\n   * @param chars Number of chars where to place the caret. If not defined it will go to the end.\n   */\n  setCurrentCursorPosition(parent, chars) {\n    /**\n     * Loops round all the child text nodes within the supplied node and sets a range from the start of the initial node to\n     * the characters.\n     *\n     * @param node Node where to start.\n     * @param range Previous calculated range.\n     * @param chars Object with counting of characters (input-output param).\n     * @param chars.count Count of characters.\n     * @returns Selection range.\n     */\n    const setRange = (node, range, chars) => {\n      if (chars.count === 0) {\n        range.setEnd(node, 0);\n      } else if (node && chars.count > 0) {\n        if (node.hasChildNodes()) {\n          // Navigate through children.\n          for (let lp = 0; lp < node.childNodes.length; lp++) {\n            range = setRange(node.childNodes[lp], range, chars);\n            if (chars.count === 0) {\n              break;\n            }\n          }\n        } else if ((node.textContent || '').length < chars.count) {\n          // Jump this node.\n          // @todo empty nodes will be omitted.\n          chars.count -= (node.textContent || '').length;\n        } else {\n          // The cursor will be placed in this element.\n          range.setEnd(node, chars.count);\n          chars.count = 0;\n        }\n      }\n      return range;\n    };\n    let range = document.createRange();\n    if (chars === undefined) {\n      // Select all so it will go to the end.\n      range.selectNode(parent);\n      range.selectNodeContents(parent);\n    } else if (chars < 0 || chars > (parent.textContent || '').length) {\n      return;\n    } else {\n      range.selectNode(parent);\n      range.setStart(parent, 0);\n      range = setRange(parent, range, {\n        count: chars\n      });\n    }\n    if (range) {\n      const selection = window.getSelection();\n      range.collapse(false);\n      selection === null || selection === void 0 || selection.removeAllRanges();\n      selection === null || selection === void 0 || selection.addRange(range);\n    }\n  }\n  /**\n   * Toggle from rte editor to textarea syncing values.\n   *\n   * @param event The event.\n   */\n  toggleEditor(event) {\n    var _this5 = this;\n    return _asyncToGenerator(function* () {\n      var _this5$control;\n      if (event.type == 'keyup' && !_this5.isValidKeyboardKey(event)) {\n        return;\n      }\n      _this5.stopBubble(event);\n      _this5.setContent(((_this5$control = _this5.control) === null || _this5$control === void 0 ? void 0 : _this5$control.value) || '');\n      _this5.rteEnabled = !_this5.rteEnabled;\n      // Set focus and cursor at the end.\n      // Modify the DOM directly so the keyboard stays open.\n      if (_this5.rteEnabled) {\n        var _this5$editorElement, _this5$textarea, _this5$editorElement2;\n        // Update tags for a11y.\n        _this5.replaceTags(['b', 'i'], ['strong', 'em']);\n        (_this5$editorElement = _this5.editorElement) === null || _this5$editorElement === void 0 || _this5$editorElement.removeAttribute('hidden');\n        const textareaInputElement = yield (_this5$textarea = _this5.textarea) === null || _this5$textarea === void 0 ? void 0 : _this5$textarea.getInputElement();\n        textareaInputElement === null || textareaInputElement === void 0 || textareaInputElement.setAttribute('hidden', '');\n        (_this5$editorElement2 = _this5.editorElement) === null || _this5$editorElement2 === void 0 || _this5$editorElement2.focus();\n      } else {\n        var _this5$editorElement3, _this5$textarea2, _this5$textarea3;\n        (_this5$editorElement3 = _this5.editorElement) === null || _this5$editorElement3 === void 0 || _this5$editorElement3.setAttribute('hidden', '');\n        const textareaInputElement = yield (_this5$textarea2 = _this5.textarea) === null || _this5$textarea2 === void 0 ? void 0 : _this5$textarea2.getInputElement();\n        textareaInputElement === null || textareaInputElement === void 0 || textareaInputElement.removeAttribute('hidden');\n        (_this5$textarea3 = _this5.textarea) === null || _this5$textarea3 === void 0 || _this5$textarea3.setFocus();\n      }\n    })();\n  }\n  /**\n   * Treat elements that can contain external content.\n   * We only search for images because the editor should receive unfiltered text, so the multimedia filter won't be applied.\n   * Treating videos and audios in here is complex, so if a user manually adds one he won't be able to play it in the editor.\n   */\n  treatExternalContent() {\n    var _this6 = this;\n    if (!CoreSites.isLoggedIn() || !this.editorElement) {\n      // Only treat external content if the user is logged in.\n      return;\n    }\n    const elements = Array.from(this.editorElement.querySelectorAll('img'));\n    const site = CoreSites.getCurrentSite();\n    const siteId = CoreSites.getCurrentSiteId();\n    const canDownloadFiles = !site || site.canDownloadFiles();\n    elements.forEach( /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator(function* (el) {\n        if (el.getAttribute('data-original-src')) {\n          // Already treated.\n          return;\n        }\n        const url = el.src;\n        if (!url || !CoreUrlUtils.isDownloadableUrl(url) || !canDownloadFiles && site !== null && site !== void 0 && site.isSitePluginFileUrl(url)) {\n          // Nothing to treat.\n          return;\n        }\n        // Check if it's downloaded.\n        const finalUrl = yield CoreFilepool.getSrcByUrl(siteId, url, _this6.component, _this6.componentId);\n        // Check again if it's already treated, this function can be called concurrently more than once.\n        if (!el.getAttribute('data-original-src')) {\n          el.setAttribute('data-original-src', el.src);\n          el.setAttribute('src', finalUrl);\n        }\n      });\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n  }\n  /**\n   * Reverts changes made by treatExternalContent.\n   */\n  restoreExternalContent() {\n    if (!this.editorElement) {\n      return;\n    }\n    const elements = Array.from(this.editorElement.querySelectorAll('img'));\n    elements.forEach(el => {\n      const originalUrl = el.getAttribute('data-original-src');\n      if (originalUrl) {\n        el.setAttribute('src', originalUrl);\n        el.removeAttribute('data-original-src');\n      }\n    });\n  }\n  /**\n   * Check if text is empty.\n   *\n   * @param value text\n   * @returns If value is null only a white space.\n   */\n  isNullOrWhiteSpace(value) {\n    if (value == null || value === undefined) {\n      return true;\n    }\n    value = value.replace(/[\\n\\r]/g, '');\n    value = value.split(' ').join('');\n    return value.length === 0;\n  }\n  /**\n   * Set the content of the textarea and the editor element.\n   *\n   * @param value New content.\n   */\n  setContent(value) {\n    if (!this.editorElement || !this.textarea) {\n      return;\n    }\n    if (this.isNullOrWhiteSpace(value)) {\n      this.editorElement.innerHTML = '<p></p>';\n      this.textarea.value = '';\n    } else {\n      this.editorElement.innerHTML = value || '';\n      this.textarea.value = value;\n      this.treatExternalContent();\n    }\n  }\n  /**\n   * Clear the text.\n   */\n  clearText() {\n    var _this$control11;\n    this.setContent(null);\n    // Don't emit event so our valueChanges doesn't get notified by this change.\n    (_this$control11 = this.control) === null || _this$control11 === void 0 || _this$control11.setValue(null, {\n      emitEvent: false\n    });\n    setTimeout(() => {\n      if (this.rteEnabled && this.editorElement) {\n        this.setCurrentCursorPosition(this.editorElement);\n      }\n    }, 1);\n  }\n  /**\n   * Execute an action over the selected text when a button is activated.\n   *  API docs: https://developer.mozilla.org/en-US/docs/Web/API/Document/execCommand\n   *\n   * @param event Event data\n   * @param command Command to execute.\n   * @param parameters If parameters is set to block, a formatBlock command will be performed. Otherwise it will switch the\n   *                      toolbar styles button when set.\n   */\n  buttonAction(event, command, parameters) {\n    if (event.type == 'keyup' && !this.isValidKeyboardKey(event)) {\n      return;\n    }\n    this.stopBubble(event);\n    if (!command) {\n      return;\n    }\n    this.executeCommand({\n      name: command,\n      parameters\n    });\n  }\n  /**\n   * Execute an action over the selected text.\n   *  API docs: https://developer.mozilla.org/en-US/docs/Web/API/Document/execCommand\n   *\n   * @param command Editor command.\n   * @param command.name Command name.\n   * @param command.parameters Command parameters.\n   */\n  executeCommand({\n    name: command,\n    parameters\n  }) {\n    if (parameters == 'block') {\n      // eslint-disable-next-line deprecation/deprecation\n      document.execCommand('formatBlock', false, '<' + command + '>');\n      return;\n    }\n    if (parameters) {\n      this.toolbarStyles[parameters] = this.toolbarStyles[parameters] == 'true' ? 'false' : 'true';\n    }\n    // eslint-disable-next-line deprecation/deprecation\n    document.execCommand(command, false);\n    // Modern browsers are using non a11y tags, so replace them.\n    if (command === 'bold') {\n      this.replaceTags(['b'], ['strong']);\n    } else if (command == 'italic') {\n      this.replaceTags(['i'], ['em']);\n    }\n  }\n  /**\n   * Replace tags for a11y.\n   *\n   * @param originTags      Origin tags to be replaced.\n   * @param destinationTags Destination tags to replace.\n   */\n  replaceTags(originTags, destinationTags) {\n    if (!this.editorElement) {\n      return;\n    }\n    this.editorElement = CoreDom.replaceTags(this.editorElement, originTags, destinationTags);\n    this.onChange();\n  }\n  /**\n   * Focus editor when click the area.\n   */\n  focusRTE() {\n    if (this.rteEnabled) {\n      var _this$editorElement;\n      (_this$editorElement = this.editorElement) === null || _this$editorElement === void 0 || _this$editorElement.focus();\n    } else {\n      var _this$textarea;\n      (_this$textarea = this.textarea) === null || _this$textarea === void 0 || _this$textarea.setFocus();\n    }\n  }\n  /**\n   * Hide the toolbar in phone mode.\n   *\n   * @param event Event.\n   * @param force If true it will not check the target of the event.\n   */\n  hideToolbar(event, force = false) {\n    if (!force && event.target && this.element.contains(event.target)) {\n      // Do not hide if clicked inside the editor area, except forced.\n      return;\n    }\n    if (event.type == 'keyup' && !this.isValidKeyboardKey(event)) {\n      return;\n    }\n    this.element.classList.remove('has-focus');\n    this.stopBubble(event);\n    if (this.isPhone) {\n      this.toolbarHidden = true;\n    }\n  }\n  /**\n   * Checks if Space or Enter have been pressed.\n   *\n   * @param event Keyboard Event.\n   * @returns Wether space or enter have been pressed.\n   */\n  isValidKeyboardKey(event) {\n    return event.key === ' ' || event.key === 'Enter';\n  }\n  /**\n   * Show the toolbar.\n   */\n  showToolbar(event) {\n    var _this$editorElement2;\n    this.updateToolbarButtons();\n    this.element.classList.add('ion-touched');\n    this.element.classList.remove('ion-untouched');\n    this.element.classList.add('has-focus');\n    this.stopBubble(event);\n    (_this$editorElement2 = this.editorElement) === null || _this$editorElement2 === void 0 || _this$editorElement2.focus();\n    this.toolbarHidden = false;\n  }\n  /**\n   * Stop event default and propagation.\n   *\n   * @param event Event.\n   */\n  stopBubble(event) {\n    if (event.type != 'touchend' && event.type != 'mouseup' && event.type != 'keyup') {\n      event.preventDefault();\n    }\n    event.stopPropagation();\n  }\n  /**\n   * When a button is clicked first we should stop event propagation, but it has some cases to not.\n   *\n   * @param event Event.\n   */\n  downAction(event) {\n    var _window$getSelection;\n    if (event.type == 'keydown' && !this.isValidKeyboardKey(event)) {\n      return;\n    }\n    const selection = (_window$getSelection = window.getSelection()) === null || _window$getSelection === void 0 ? void 0 : _window$getSelection.toString();\n    // When RTE is focused with a whole paragraph in desktop the stopBubble will not fire click.\n    if (CorePlatform.isMobile() || !this.rteEnabled || document.activeElement != this.editorElement || selection == '') {\n      this.stopBubble(event);\n    }\n  }\n  /**\n   * Method that shows the next toolbar buttons.\n   */\n  toolbarNext(event) {\n    var _this7 = this;\n    return _asyncToGenerator(function* () {\n      if (event.type == 'keyup' && !_this7.isValidKeyboardKey(event)) {\n        return;\n      }\n      _this7.stopBubble(event);\n      if (!_this7.toolbarNextHidden) {\n        var _this7$toolbarSlides, _this7$toolbarSlides2;\n        const currentIndex = (_this7$toolbarSlides = _this7.toolbarSlides) === null || _this7$toolbarSlides === void 0 ? void 0 : _this7$toolbarSlides.activeIndex;\n        (_this7$toolbarSlides2 = _this7.toolbarSlides) === null || _this7$toolbarSlides2 === void 0 || _this7$toolbarSlides2.slideTo((currentIndex || 0) + _this7.toolbarSlides.slidesPerViewDynamic());\n      }\n      yield _this7.updateToolbarArrows();\n    })();\n  }\n  /**\n   * Method that shows the previous toolbar buttons.\n   */\n  toolbarPrev(event) {\n    var _this8 = this;\n    return _asyncToGenerator(function* () {\n      if (event.type == 'keyup' && !_this8.isValidKeyboardKey(event)) {\n        return;\n      }\n      _this8.stopBubble(event);\n      if (!_this8.toolbarPrevHidden) {\n        var _this8$toolbarSlides, _this8$toolbarSlides2;\n        const currentIndex = (_this8$toolbarSlides = _this8.toolbarSlides) === null || _this8$toolbarSlides === void 0 ? void 0 : _this8$toolbarSlides.activeIndex;\n        (_this8$toolbarSlides2 = _this8.toolbarSlides) === null || _this8$toolbarSlides2 === void 0 || _this8$toolbarSlides2.slideTo((currentIndex || 0) - _this8.toolbarSlides.slidesPerViewDynamic());\n      }\n      yield _this8.updateToolbarArrows();\n    })();\n  }\n  /**\n   * Update the number of toolbar buttons displayed.\n   */\n  updateToolbarButtons() {\n    var _this9 = this;\n    return _asyncToGenerator(function* () {\n      var _this9$buttonsDomProm;\n      if (!_this9.isCurrentView || !_this9.toolbar || !_this9.toolbarSlides || _this9.element.offsetParent == null) {\n        // Don't calculate if component isn't in current view, the calculations are wrong.\n        return;\n      }\n      const length = _this9.toolbarSlides.slides.length;\n      // Cancel previous one, if any.\n      (_this9$buttonsDomProm = _this9.buttonsDomPromise) === null || _this9$buttonsDomProm === void 0 || _this9$buttonsDomProm.cancel();\n      _this9.buttonsDomPromise = CoreDom.waitToBeInDOM(_this9.toolbar.nativeElement);\n      yield _this9.buttonsDomPromise;\n      const width = _this9.toolbar.nativeElement.getBoundingClientRect().width;\n      if (length > 0 && width > length * _this9.toolbarButtonWidth) {\n        _this9.swiperOpts.slidesPerView = length;\n        _this9.toolbarArrows = false;\n      } else {\n        _this9.swiperOpts.slidesPerView = Math.floor((width - _this9.toolbarArrowWidth * 2) / _this9.toolbarButtonWidth);\n        _this9.toolbarArrows = true;\n      }\n      yield CoreUtils.nextTick();\n      _this9.toolbarSlides.update();\n      yield _this9.updateToolbarArrows();\n    })();\n  }\n  /**\n   * Show or hide next/previous toolbar arrows.\n   */\n  updateToolbarArrows() {\n    var _this10 = this;\n    return _asyncToGenerator(function* () {\n      if (!_this10.toolbarSlides) {\n        return;\n      }\n      const currentIndex = _this10.toolbarSlides.activeIndex;\n      const length = _this10.toolbarSlides.slides.length;\n      _this10.toolbarPrevHidden = currentIndex <= 0;\n      _this10.toolbarNextHidden = currentIndex + _this10.toolbarSlides.slidesPerViewDynamic() >= length;\n    })();\n  }\n  /**\n   * Update highlighted toolbar styles.\n   */\n  updateToolbarStyles() {\n    var _window$getSelection2;\n    const node = (_window$getSelection2 = window.getSelection()) === null || _window$getSelection2 === void 0 ? void 0 : _window$getSelection2.focusNode;\n    if (!node) {\n      return;\n    }\n    let element = node.nodeType == 1 ? node : node.parentElement;\n    const styles = {};\n    while (element != null && element !== this.editorElement) {\n      const tagName = element.tagName.toLowerCase();\n      if (this.toolbarStyles[tagName]) {\n        styles[tagName] = 'true';\n      }\n      element = element.parentElement;\n    }\n    for (const tagName in this.toolbarStyles) {\n      this.toolbarStyles[tagName] = 'false';\n    }\n    if (element === this.editorElement) {\n      Object.assign(this.toolbarStyles, styles);\n    }\n  }\n  /**\n   * Check if should auto save drafts.\n   *\n   * @returns {boolean} Whether it should auto save drafts.\n   */\n  shouldAutoSaveDrafts() {\n    return !!CoreSites.getCurrentSite() && (this.autoSave === undefined || CoreUtils.isTrueOrOne(this.autoSave)) && this.contextLevel !== undefined && this.contextInstanceId !== undefined && this.elementId !== undefined;\n  }\n  /**\n   * Restore a draft if there is any.\n   *\n   * @returns Promise resolved when done.\n   */\n  restoreDraft() {\n    var _this11 = this;\n    return _asyncToGenerator(function* () {\n      try {\n        const entry = yield CoreEditorOffline.resumeDraft(_this11.contextLevel || '', _this11.contextInstanceId || 0, _this11.elementId || '', _this11.draftExtraParams || {}, _this11.pageInstance, _this11.originalContent);\n        if (entry === undefined) {\n          // No draft found.\n          return;\n        }\n        _this11.element.classList.add('ion-touched');\n        _this11.element.classList.remove('ion-untouched');\n        let draftText = entry.drafttext || '';\n        // Revert untouched editor contents to an empty string.\n        if (draftText == '<p></p>' || draftText == '<p><br></p>' || draftText == '<br>' || draftText == '<p>&nbsp;</p>' || draftText == '<p><br>&nbsp;</p>') {\n          draftText = '';\n        }\n        if (draftText !== '' && _this11.control && draftText != _this11.control.value) {\n          // Restore the draft.\n          _this11.control.setValue(draftText, {\n            emitEvent: false\n          });\n          _this11.setContent(draftText);\n          _this11.lastDraft = draftText;\n          _this11.draftWasRestored = true;\n          _this11.originalContent = entry.originalcontent;\n          if (entry.drafttext != entry.originalcontent) {\n            // Notify the user.\n            _this11.showMessage('core.editor.textrecovered', _this11.RESTORE_MESSAGE_CLEAR_TIME);\n          }\n        }\n      } catch (_unused) {\n        // Ignore errors, shouldn't happen.\n      }\n    })();\n  }\n  /**\n   * Automatically save drafts every certain time.\n   */\n  autoSaveDrafts() {\n    var _this12 = this;\n    this.autoSaveInterval = window.setInterval( /*#__PURE__*/_asyncToGenerator(function* () {\n      if (!_this12.control) {\n        return;\n      }\n      const newText = _this12.control.value;\n      if (_this12.lastDraft == newText) {\n        // Text hasn't changed, nothing to save.\n        return;\n      }\n      try {\n        yield CoreEditorOffline.saveDraft(_this12.contextLevel || '', _this12.contextInstanceId || 0, _this12.elementId || '', _this12.draftExtraParams || {}, _this12.pageInstance, newText, _this12.originalContent);\n        // Draft saved, notify the user.\n        _this12.lastDraft = newText;\n        _this12.showMessage('core.editor.autosavesucceeded', _this12.SAVE_MESSAGE_CLEAR_TIME);\n      } catch (error) {\n        // Error saving draft.\n      }\n    }), this.DRAFT_AUTOSAVE_FREQUENCY);\n  }\n  /**\n   * Delete the draft when the form is submitted or cancelled.\n   */\n  deleteDraftOnSubmitOrCancel() {\n    var _this13 = this;\n    this.resetObserver = CoreEvents.on(CoreEvents.FORM_ACTION, /*#__PURE__*/function () {\n      var _ref3 = _asyncToGenerator(function* (data) {\n        const form = _this13.element.closest('form');\n        if (data.form && form && data.form == form) {\n          try {\n            yield CoreEditorOffline.deleteDraft(_this13.contextLevel || '', _this13.contextInstanceId || 0, _this13.elementId || '', _this13.draftExtraParams || {});\n          } catch (error) {\n            // Error deleting draft. Shouldn't happen.\n          }\n        }\n      });\n      return function (_x2) {\n        return _ref3.apply(this, arguments);\n      };\n    }(), CoreSites.getCurrentSiteId());\n  }\n  /**\n   * Show a message.\n   *\n   * @param message Identifier of the message to display.\n   * @param timeout Number of milliseconds when to remove the message.\n   */\n  showMessage(message, timeout) {\n    clearTimeout(this.hideMessageTimeout);\n    this.infoMessage = message;\n    this.hideMessageTimeout = window.setTimeout(() => {\n      this.hideMessageTimeout = undefined;\n      this.infoMessage = undefined;\n    }, timeout);\n  }\n  /**\n   * Scan a QR code and put its text in the editor.\n   *\n   * @param event Event data\n   * @returns Promise resolved when done.\n   */\n  scanQR(event) {\n    var _this14 = this;\n    return _asyncToGenerator(function* () {\n      if (event.type == 'keyup' && !_this14.isValidKeyboardKey(event)) {\n        return;\n      }\n      _this14.stopBubble(event);\n      // Scan for a QR code.\n      const text = yield CoreUtils.scanQR();\n      if (text) {\n        var _this14$editorElement;\n        (_this14$editorElement = _this14.editorElement) === null || _this14$editorElement === void 0 || _this14$editorElement.focus(); // Make sure the editor is focused.\n        // eslint-disable-next-line deprecation/deprecation\n        document.execCommand('insertText', false, text);\n      }\n    })();\n  }\n  /**\n   * Window resized.\n   */\n  windowResized() {\n    var _this15 = this;\n    return _asyncToGenerator(function* () {\n      yield CoreDomUtils.waitForResizeDone();\n      _this15.isPhone = CoreScreen.isMobile;\n      _this15.maximizeEditorSize();\n      _this15.updateToolbarButtons();\n    })();\n  }\n  /**\n   * User entered the page that contains the component.\n   */\n  ionViewDidEnter() {\n    this.isCurrentView = true;\n    this.updateToolbarButtons();\n  }\n  /**\n   * User left the page that contains the component.\n   */\n  ionViewDidLeave() {\n    this.isCurrentView = false;\n  }\n  /**\n   * @inheritdoc\n   */\n  ngOnDestroy() {\n    var _this$valueChangeSubs, _this$languageChanged, _this$resetObserver, _this$keyboardObserve, _this$labelObserver, _this$resizeListener, _this$domPromise, _this$buttonsDomPromi;\n    (_this$valueChangeSubs = this.valueChangeSubscription) === null || _this$valueChangeSubs === void 0 || _this$valueChangeSubs.unsubscribe();\n    (_this$languageChanged = this.languageChangedSubscription) === null || _this$languageChanged === void 0 || _this$languageChanged.unsubscribe();\n    this.selectionChangeFunction && document.removeEventListener('selectionchange', this.selectionChangeFunction);\n    clearInterval(this.initHeightInterval);\n    clearInterval(this.autoSaveInterval);\n    clearTimeout(this.hideMessageTimeout);\n    (_this$resetObserver = this.resetObserver) === null || _this$resetObserver === void 0 || _this$resetObserver.off();\n    (_this$keyboardObserve = this.keyboardObserver) === null || _this$keyboardObserve === void 0 || _this$keyboardObserve.off();\n    (_this$labelObserver = this.labelObserver) === null || _this$labelObserver === void 0 || _this$labelObserver.disconnect();\n    (_this$resizeListener = this.resizeListener) === null || _this$resizeListener === void 0 || _this$resizeListener.off();\n    (_this$domPromise = this.domPromise) === null || _this$domPromise === void 0 || _this$domPromise.cancel();\n    (_this$buttonsDomPromi = this.buttonsDomPromise) === null || _this$buttonsDomPromi === void 0 || _this$buttonsDomPromi.cancel();\n  }\n  /**\n   * Get commands triggered by keyboard shortcuts.\n   *\n   * @returns Commands dictionary indexed by their corresponding keyboard shortcut id.\n   */\n  getShortcutCommands() {\n    if (!this.shortcutCommands) {\n      const isIOS = CorePlatform.isIOS();\n      const metaKey = isIOS ? 'metaKey' : 'ctrlKey';\n      const shiftKey = isIOS ? 'ctrlKey' : 'shiftKey';\n      // Same shortcuts as TinyMCE:\n      // @see https://www.tiny.cloud/docs/advanced/keyboard-shortcuts/\n      const shortcuts = [{\n        code: 'KeyB',\n        modifiers: [metaKey],\n        command: {\n          name: 'bold',\n          parameters: 'strong'\n        }\n      }, {\n        code: 'KeyI',\n        modifiers: [metaKey],\n        command: {\n          name: 'italic',\n          parameters: 'em'\n        }\n      }, {\n        code: 'KeyU',\n        modifiers: [metaKey],\n        command: {\n          name: 'underline',\n          parameters: 'u'\n        }\n      }, {\n        code: 'Digit3',\n        modifiers: ['altKey', shiftKey],\n        command: {\n          name: 'h3',\n          parameters: 'block'\n        }\n      }, {\n        code: 'Digit4',\n        modifiers: ['altKey', shiftKey],\n        command: {\n          name: 'h4',\n          parameters: 'block'\n        }\n      }, {\n        code: 'Digit5',\n        modifiers: ['altKey', shiftKey],\n        command: {\n          name: 'h5',\n          parameters: 'block'\n        }\n      }, {\n        code: 'Digit7',\n        modifiers: ['altKey', shiftKey],\n        command: {\n          name: 'p',\n          parameters: 'block'\n        }\n      }];\n      this.shortcutCommands = shortcuts.reduce((shortcuts, {\n        code,\n        modifiers,\n        command\n      }) => {\n        const id = this.getShortcutId({\n          code: code,\n          altKey: modifiers.includes('altKey'),\n          metaKey: modifiers.includes('metaKey'),\n          shiftKey: modifiers.includes('shiftKey'),\n          ctrlKey: modifiers.includes('ctrlKey')\n        });\n        shortcuts[id] = command;\n        return shortcuts;\n      }, {});\n    }\n    return this.shortcutCommands;\n  }\n  /**\n   * Get a unique identifier for a given keyboard shortcut.\n   *\n   * @param shortcut Shortcut.\n   * @returns Identifier.\n   */\n  getShortcutId(shortcut) {\n    return (shortcut.altKey ? '1' : '0') + (shortcut.metaKey ? '1' : '0') + (shortcut.shiftKey ? '1' : '0') + (shortcut.ctrlKey ? '1' : '0') + shortcut.code;\n  }\n}\n_class = CoreEditorRichTextEditorComponent;\n_class.ɵfac = function CoreEditorRichTextEditorComponent_Factory(t) {\n  return new (t || _class)(i0.ɵɵdirectiveInject(i1.IonContent, 8), i0.ɵɵdirectiveInject(i0.ElementRef));\n};\n_class.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: _class,\n  selectors: [[\"core-rich-text-editor\"]],\n  viewQuery: function CoreEditorRichTextEditorComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(_c0, 5);\n      i0.ɵɵviewQuery(_c1, 5);\n      i0.ɵɵviewQuery(_c2, 5);\n      i0.ɵɵviewQuery(_c3, 5);\n    }\n    if (rf & 2) {\n      let _t;\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.editor = _t.first);\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.textarea = _t.first);\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.toolbar = _t.first);\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.swiperRef = _t.first);\n    }\n  },\n  inputs: {\n    placeholder: \"placeholder\",\n    control: \"control\",\n    name: \"name\",\n    component: \"component\",\n    componentId: \"componentId\",\n    autoSave: \"autoSave\",\n    contextLevel: \"contextLevel\",\n    contextInstanceId: \"contextInstanceId\",\n    elementId: \"elementId\",\n    draftExtraParams: \"draftExtraParams\"\n  },\n  outputs: {\n    contentChanged: \"contentChanged\"\n  },\n  decls: 68,\n  vars: 74,\n  consts: [[1, \"core-rte-editor-container\", 3, \"click\"], [\"role\", \"textbox\", \"contenteditable\", \"true\", 1, \"core-rte-editor\", 3, \"hidden\", \"focus\", \"blur\", \"keydown\", \"keyup\", \"change\", \"paste\", \"input\"], [\"editor\", \"\"], [\"role\", \"textbox\", \"ngControl\", \"control\", 1, \"core-textarea\", 3, \"hidden\", \"placeholder\", \"ionChange\", \"ionFocus\", \"ionBlur\"], [\"textarea\", \"\"], [\"class\", \"core-rte-info-message\", 4, \"ngIf\"], [1, \"core-rte-toolbar\"], [\"toolbar\", \"\"], [\"class\", \"toolbar-arrow\", 3, \"tabindex\", \"click\", \"keyup\", \"mousedown\", \"keydown\", 4, \"ngIf\"], [3, \"slidesPerView\", \"slidechangetransitionend\"], [\"swiperRef\", \"\"], [\"tabindex\", \"0\", 3, \"disabled\", \"title\", \"click\", \"keyup\", \"mousedown\", \"keydown\"], [\"name\", \"fas-bold\", \"aria-hidden\", \"true\"], [\"name\", \"fas-italic\", \"aria-hidden\", \"true\"], [\"name\", \"fas-underline\", \"aria-hidden\", \"true\"], [\"name\", \"fas-strikethrough\", \"aria-hidden\", \"true\"], [\"name\", \"fas-paragraph\", \"aria-hidden\", \"true\"], [\"name\", \"fas-heading\", \"aria-hidden\", \"true\"], [\"aria-hidden\", \"true\"], [\"tabindex\", \"0\", 3, \"disabled\", \"title\", \"click\", \"mousedown\", \"keydown\"], [\"name\", \"fas-list-ul\", \"aria-hidden\", \"true\"], [\"name\", \"fas-list-ol\", \"aria-hidden\", \"true\"], [3, \"disabled\", \"title\", \"click\", \"keyup\", \"mousedown\", \"keydown\"], [\"name\", \"fas-eraser\", \"aria-hidden\", \"true\"], [4, \"ngIf\"], [\"tabindex\", \"0\", 3, \"title\", \"click\", \"keyup\", \"mousedown\", \"keydown\"], [\"name\", \"fas-code\", \"aria-hidden\", \"true\"], [1, \"core-rte-info-message\"], [\"name\", \"fas-circle-info\", \"aria-hidden\", \"true\"], [1, \"toolbar-arrow\", 3, \"tabindex\", \"click\", \"keyup\", \"mousedown\", \"keydown\"], [\"name\", \"fas-chevron-left\", \"aria-hidden\", \"true\"], [\"name\", \"fas-qrcode\", \"aria-hidden\", \"true\"], [\"name\", \"fas-xmark\", \"aria-hidden\", \"true\"], [\"name\", \"fas-chevron-right\", \"aria-hidden\", \"true\"]],\n  template: function CoreEditorRichTextEditorComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0);\n      i0.ɵɵlistener(\"click\", function CoreEditorRichTextEditorComponent_Template_div_click_0_listener() {\n        return ctx.focusRTE();\n      });\n      i0.ɵɵelementStart(1, \"div\", 1, 2);\n      i0.ɵɵlistener(\"focus\", function CoreEditorRichTextEditorComponent_Template_div_focus_1_listener($event) {\n        return ctx.showToolbar($event);\n      })(\"blur\", function CoreEditorRichTextEditorComponent_Template_div_blur_1_listener($event) {\n        return ctx.hideToolbar($event);\n      })(\"keydown\", function CoreEditorRichTextEditorComponent_Template_div_keydown_1_listener($event) {\n        return ctx.onKeyDown($event);\n      })(\"keyup\", function CoreEditorRichTextEditorComponent_Template_div_keyup_1_listener() {\n        return ctx.onChange();\n      })(\"change\", function CoreEditorRichTextEditorComponent_Template_div_change_1_listener() {\n        return ctx.onChange();\n      })(\"paste\", function CoreEditorRichTextEditorComponent_Template_div_paste_1_listener() {\n        return ctx.onChange();\n      })(\"input\", function CoreEditorRichTextEditorComponent_Template_div_input_1_listener() {\n        return ctx.onChange();\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(3, \"ion-textarea\", 3, 4);\n      i0.ɵɵlistener(\"ionChange\", function CoreEditorRichTextEditorComponent_Template_ion_textarea_ionChange_3_listener() {\n        return ctx.onChange();\n      })(\"ionFocus\", function CoreEditorRichTextEditorComponent_Template_ion_textarea_ionFocus_3_listener($event) {\n        return ctx.showToolbar($event);\n      })(\"ionBlur\", function CoreEditorRichTextEditorComponent_Template_ion_textarea_ionBlur_3_listener($event) {\n        return ctx.hideToolbar($event);\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(5, CoreEditorRichTextEditorComponent_div_5_Template, 4, 3, \"div\", 5);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(6, \"div\", 6, 7);\n      i0.ɵɵtemplate(8, CoreEditorRichTextEditorComponent_button_8_Template, 3, 5, \"button\", 8);\n      i0.ɵɵelementStart(9, \"swiper-container\", 9, 10);\n      i0.ɵɵlistener(\"slidechangetransitionend\", function CoreEditorRichTextEditorComponent_Template_swiper_container_slidechangetransitionend_9_listener() {\n        return ctx.updateToolbarArrows();\n      });\n      i0.ɵɵelementStart(11, \"swiper-slide\")(12, \"button\", 11);\n      i0.ɵɵlistener(\"click\", function CoreEditorRichTextEditorComponent_Template_button_click_12_listener($event) {\n        return ctx.buttonAction($event, \"bold\", \"strong\");\n      })(\"keyup\", function CoreEditorRichTextEditorComponent_Template_button_keyup_12_listener($event) {\n        return ctx.buttonAction($event, \"bold\", \"strong\");\n      })(\"mousedown\", function CoreEditorRichTextEditorComponent_Template_button_mousedown_12_listener($event) {\n        return ctx.downAction($event);\n      })(\"keydown\", function CoreEditorRichTextEditorComponent_Template_button_keydown_12_listener($event) {\n        return ctx.downAction($event);\n      });\n      i0.ɵɵpipe(13, \"translate\");\n      i0.ɵɵelement(14, \"ion-icon\", 12);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(15, \"swiper-slide\")(16, \"button\", 11);\n      i0.ɵɵlistener(\"click\", function CoreEditorRichTextEditorComponent_Template_button_click_16_listener($event) {\n        return ctx.buttonAction($event, \"italic\", \"em\");\n      })(\"keyup\", function CoreEditorRichTextEditorComponent_Template_button_keyup_16_listener($event) {\n        return ctx.buttonAction($event, \"italic\", \"em\");\n      })(\"mousedown\", function CoreEditorRichTextEditorComponent_Template_button_mousedown_16_listener($event) {\n        return ctx.downAction($event);\n      })(\"keydown\", function CoreEditorRichTextEditorComponent_Template_button_keydown_16_listener($event) {\n        return ctx.downAction($event);\n      });\n      i0.ɵɵpipe(17, \"translate\");\n      i0.ɵɵelement(18, \"ion-icon\", 13);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(19, \"swiper-slide\")(20, \"button\", 11);\n      i0.ɵɵlistener(\"click\", function CoreEditorRichTextEditorComponent_Template_button_click_20_listener($event) {\n        return ctx.buttonAction($event, \"underline\", \"u\");\n      })(\"keyup\", function CoreEditorRichTextEditorComponent_Template_button_keyup_20_listener($event) {\n        return ctx.buttonAction($event, \"underline\", \"u\");\n      })(\"mousedown\", function CoreEditorRichTextEditorComponent_Template_button_mousedown_20_listener($event) {\n        return ctx.downAction($event);\n      })(\"keydown\", function CoreEditorRichTextEditorComponent_Template_button_keydown_20_listener($event) {\n        return ctx.downAction($event);\n      });\n      i0.ɵɵpipe(21, \"translate\");\n      i0.ɵɵelement(22, \"ion-icon\", 14);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(23, \"swiper-slide\")(24, \"button\", 11);\n      i0.ɵɵlistener(\"click\", function CoreEditorRichTextEditorComponent_Template_button_click_24_listener($event) {\n        return ctx.buttonAction($event, \"strikethrough\", \"strike\");\n      })(\"keyup\", function CoreEditorRichTextEditorComponent_Template_button_keyup_24_listener($event) {\n        return ctx.buttonAction($event, \"strikethrough\", \"strike\");\n      })(\"mousedown\", function CoreEditorRichTextEditorComponent_Template_button_mousedown_24_listener($event) {\n        return ctx.downAction($event);\n      })(\"keydown\", function CoreEditorRichTextEditorComponent_Template_button_keydown_24_listener($event) {\n        return ctx.downAction($event);\n      });\n      i0.ɵɵpipe(25, \"translate\");\n      i0.ɵɵelement(26, \"ion-icon\", 15);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(27, \"swiper-slide\")(28, \"button\", 11);\n      i0.ɵɵlistener(\"click\", function CoreEditorRichTextEditorComponent_Template_button_click_28_listener($event) {\n        return ctx.buttonAction($event, \"p\", \"block\");\n      })(\"keyup\", function CoreEditorRichTextEditorComponent_Template_button_keyup_28_listener($event) {\n        return ctx.buttonAction($event, \"p\", \"block\");\n      })(\"mousedown\", function CoreEditorRichTextEditorComponent_Template_button_mousedown_28_listener($event) {\n        return ctx.downAction($event);\n      })(\"keydown\", function CoreEditorRichTextEditorComponent_Template_button_keydown_28_listener($event) {\n        return ctx.downAction($event);\n      });\n      i0.ɵɵpipe(29, \"translate\");\n      i0.ɵɵelement(30, \"ion-icon\", 16);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(31, \"swiper-slide\")(32, \"button\", 11);\n      i0.ɵɵlistener(\"click\", function CoreEditorRichTextEditorComponent_Template_button_click_32_listener($event) {\n        return ctx.buttonAction($event, \"h3\", \"block\");\n      })(\"keyup\", function CoreEditorRichTextEditorComponent_Template_button_keyup_32_listener($event) {\n        return ctx.buttonAction($event, \"h3\", \"block\");\n      })(\"mousedown\", function CoreEditorRichTextEditorComponent_Template_button_mousedown_32_listener($event) {\n        return ctx.downAction($event);\n      })(\"keydown\", function CoreEditorRichTextEditorComponent_Template_button_keydown_32_listener($event) {\n        return ctx.downAction($event);\n      });\n      i0.ɵɵpipe(33, \"translate\");\n      i0.ɵɵelement(34, \"ion-icon\", 17);\n      i0.ɵɵelementStart(35, \"span\", 18);\n      i0.ɵɵtext(36, \"3\");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(37, \"swiper-slide\")(38, \"button\", 11);\n      i0.ɵɵlistener(\"click\", function CoreEditorRichTextEditorComponent_Template_button_click_38_listener($event) {\n        return ctx.buttonAction($event, \"h4\", \"block\");\n      })(\"keyup\", function CoreEditorRichTextEditorComponent_Template_button_keyup_38_listener($event) {\n        return ctx.buttonAction($event, \"h4\", \"block\");\n      })(\"mousedown\", function CoreEditorRichTextEditorComponent_Template_button_mousedown_38_listener($event) {\n        return ctx.downAction($event);\n      })(\"keydown\", function CoreEditorRichTextEditorComponent_Template_button_keydown_38_listener($event) {\n        return ctx.downAction($event);\n      });\n      i0.ɵɵpipe(39, \"translate\");\n      i0.ɵɵelement(40, \"ion-icon\", 17);\n      i0.ɵɵelementStart(41, \"span\", 18);\n      i0.ɵɵtext(42, \"4\");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(43, \"swiper-slide\")(44, \"button\", 11);\n      i0.ɵɵlistener(\"click\", function CoreEditorRichTextEditorComponent_Template_button_click_44_listener($event) {\n        return ctx.buttonAction($event, \"h5\", \"block\");\n      })(\"keyup\", function CoreEditorRichTextEditorComponent_Template_button_keyup_44_listener($event) {\n        return ctx.buttonAction($event, \"h5\", \"block\");\n      })(\"mousedown\", function CoreEditorRichTextEditorComponent_Template_button_mousedown_44_listener($event) {\n        return ctx.downAction($event);\n      })(\"keydown\", function CoreEditorRichTextEditorComponent_Template_button_keydown_44_listener($event) {\n        return ctx.downAction($event);\n      });\n      i0.ɵɵpipe(45, \"translate\");\n      i0.ɵɵelement(46, \"ion-icon\", 17);\n      i0.ɵɵelementStart(47, \"span\", 18);\n      i0.ɵɵtext(48, \"5\");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(49, \"swiper-slide\")(50, \"button\", 19);\n      i0.ɵɵlistener(\"click\", function CoreEditorRichTextEditorComponent_Template_button_click_50_listener($event) {\n        return ctx.buttonAction($event, \"insertUnorderedList\");\n      })(\"mousedown\", function CoreEditorRichTextEditorComponent_Template_button_mousedown_50_listener($event) {\n        return ctx.downAction($event);\n      })(\"keydown\", function CoreEditorRichTextEditorComponent_Template_button_keydown_50_listener($event) {\n        return ctx.downAction($event);\n      });\n      i0.ɵɵpipe(51, \"translate\");\n      i0.ɵɵelement(52, \"ion-icon\", 20);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(53, \"swiper-slide\")(54, \"button\", 11);\n      i0.ɵɵlistener(\"click\", function CoreEditorRichTextEditorComponent_Template_button_click_54_listener($event) {\n        return ctx.buttonAction($event, \"insertOrderedList\");\n      })(\"keyup\", function CoreEditorRichTextEditorComponent_Template_button_keyup_54_listener($event) {\n        return ctx.buttonAction($event, \"insertOrderedList\");\n      })(\"mousedown\", function CoreEditorRichTextEditorComponent_Template_button_mousedown_54_listener($event) {\n        return ctx.downAction($event);\n      })(\"keydown\", function CoreEditorRichTextEditorComponent_Template_button_keydown_54_listener($event) {\n        return ctx.downAction($event);\n      });\n      i0.ɵɵpipe(55, \"translate\");\n      i0.ɵɵelement(56, \"ion-icon\", 21);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(57, \"swiper-slide\")(58, \"button\", 22);\n      i0.ɵɵlistener(\"click\", function CoreEditorRichTextEditorComponent_Template_button_click_58_listener($event) {\n        return ctx.buttonAction($event, \"removeFormat\");\n      })(\"keyup\", function CoreEditorRichTextEditorComponent_Template_button_keyup_58_listener($event) {\n        return ctx.buttonAction($event, \"removeFormat\");\n      })(\"mousedown\", function CoreEditorRichTextEditorComponent_Template_button_mousedown_58_listener($event) {\n        return ctx.downAction($event);\n      })(\"keydown\", function CoreEditorRichTextEditorComponent_Template_button_keydown_58_listener($event) {\n        return ctx.downAction($event);\n      });\n      i0.ɵɵpipe(59, \"translate\");\n      i0.ɵɵelement(60, \"ion-icon\", 23);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵtemplate(61, CoreEditorRichTextEditorComponent_swiper_slide_61_Template, 4, 4, \"swiper-slide\", 24);\n      i0.ɵɵelementStart(62, \"swiper-slide\")(63, \"button\", 25);\n      i0.ɵɵlistener(\"click\", function CoreEditorRichTextEditorComponent_Template_button_click_63_listener($event) {\n        return ctx.toggleEditor($event);\n      })(\"keyup\", function CoreEditorRichTextEditorComponent_Template_button_keyup_63_listener($event) {\n        return ctx.toggleEditor($event);\n      })(\"mousedown\", function CoreEditorRichTextEditorComponent_Template_button_mousedown_63_listener($event) {\n        return ctx.downAction($event);\n      })(\"keydown\", function CoreEditorRichTextEditorComponent_Template_button_keydown_63_listener($event) {\n        return ctx.downAction($event);\n      });\n      i0.ɵɵpipe(64, \"translate\");\n      i0.ɵɵelement(65, \"ion-icon\", 26);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵtemplate(66, CoreEditorRichTextEditorComponent_swiper_slide_66_Template, 4, 3, \"swiper-slide\", 24);\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(67, CoreEditorRichTextEditorComponent_button_67_Template, 3, 5, \"button\", 8);\n      i0.ɵɵelementEnd();\n    }\n    if (rf & 2) {\n      i0.ɵɵclassProp(\"toolbar-hidden\", ctx.toolbarHidden);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"hidden\", !ctx.rteEnabled);\n      i0.ɵɵattribute(\"aria-labelledby\", ctx.ariaLabelledBy)(\"data-placeholder-text\", ctx.placeholder);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"hidden\", ctx.rteEnabled)(\"placeholder\", ctx.placeholder);\n      i0.ɵɵattribute(\"name\", ctx.name);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", ctx.infoMessage);\n      i0.ɵɵadvance(1);\n      i0.ɵɵclassProp(\"toolbar-hidden\", ctx.toolbarHidden);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", ctx.toolbarArrows);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"slidesPerView\", ctx.swiperOpts.slidesPerView);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"disabled\", !ctx.rteEnabled)(\"title\", i0.ɵɵpipeBind1(13, 50, \"core.editor.bold\"));\n      i0.ɵɵattribute(\"aria-pressed\", ctx.toolbarStyles.strong);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"disabled\", !ctx.rteEnabled)(\"title\", i0.ɵɵpipeBind1(17, 52, \"core.editor.italic\"));\n      i0.ɵɵattribute(\"aria-pressed\", ctx.toolbarStyles.em);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"disabled\", !ctx.rteEnabled)(\"title\", i0.ɵɵpipeBind1(21, 54, \"core.editor.underline\"));\n      i0.ɵɵattribute(\"aria-pressed\", ctx.toolbarStyles.u);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"disabled\", !ctx.rteEnabled)(\"title\", i0.ɵɵpipeBind1(25, 56, \"core.editor.strikethrough\"));\n      i0.ɵɵattribute(\"aria-pressed\", ctx.toolbarStyles.strike);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"disabled\", !ctx.rteEnabled)(\"title\", i0.ɵɵpipeBind1(29, 58, \"core.editor.p\"));\n      i0.ɵɵattribute(\"aria-pressed\", ctx.toolbarStyles.p);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"disabled\", !ctx.rteEnabled)(\"title\", i0.ɵɵpipeBind1(33, 60, \"core.editor.h3\"));\n      i0.ɵɵattribute(\"aria-pressed\", ctx.toolbarStyles.h3);\n      i0.ɵɵadvance(6);\n      i0.ɵɵproperty(\"disabled\", !ctx.rteEnabled)(\"title\", i0.ɵɵpipeBind1(39, 62, \"core.editor.h4\"));\n      i0.ɵɵattribute(\"aria-pressed\", ctx.toolbarStyles.h4);\n      i0.ɵɵadvance(6);\n      i0.ɵɵproperty(\"disabled\", !ctx.rteEnabled)(\"title\", i0.ɵɵpipeBind1(45, 64, \"core.editor.h5\"));\n      i0.ɵɵattribute(\"aria-pressed\", ctx.toolbarStyles.h5);\n      i0.ɵɵadvance(6);\n      i0.ɵɵproperty(\"disabled\", !ctx.rteEnabled)(\"title\", i0.ɵɵpipeBind1(51, 66, \"core.editor.unorderedlist\"));\n      i0.ɵɵattribute(\"aria-pressed\", ctx.toolbarStyles.ul);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"disabled\", !ctx.rteEnabled)(\"title\", i0.ɵɵpipeBind1(55, 68, \"core.editor.orderedlist\"));\n      i0.ɵɵattribute(\"aria-pressed\", ctx.toolbarStyles.ol);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"disabled\", !ctx.rteEnabled)(\"title\", i0.ɵɵpipeBind1(59, 70, \"core.editor.clear\"));\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngIf\", ctx.canScanQR);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"title\", i0.ɵɵpipeBind1(64, 72, \"core.editor.toggle\"));\n      i0.ɵɵattribute(\"aria-pressed\", !ctx.rteEnabled);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngIf\", ctx.isPhone);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.toolbarArrows);\n    }\n  },\n  dependencies: [i2.NgIf, i3.CoreFaIconDirective, i1.IonIcon, i1.IonTextarea, i1.TextValueAccessor, i4.TranslatePipe],\n  styles: [\"@charset \\\"UTF-8\\\";\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n[_nghost-%COMP%] {\\n  --placeholder-color: var(--ion-placeholder-color);\\n  --toobar-background: var(--white);\\n  --button-color: var(--ion-text-color);\\n  --button-active-color: var(--gray-300);\\n  --background: var(--rte-editor-background);\\n}\\n\\nhtml.dark[_nghost-%COMP%], html.dark   [_nghost-%COMP%] {\\n  --color: var(--white);\\n  --button-color: var(--gray-200);\\n  --button-active-color: var(--gray-500);\\n  --toobar-background: var(--gray-900);\\n}\\n\\n[_nghost-%COMP%] {\\n  height: var(--core-rte-height, auto);\\n  overflow: hidden;\\n  min-height: 200px; \\n\\n  min-height: 40vh;\\n  width: 100%;\\n  display: flex;\\n  flex-direction: column;\\n  background: var(--background);\\n}\\n[_nghost-%COMP%]   .core-rte-editor-container[_ngcontent-%COMP%] {\\n  max-height: calc(100% - 46px);\\n  display: flex;\\n  flex-grow: 1;\\n  flex-direction: column;\\n  justify-content: space-between;\\n}\\n[_nghost-%COMP%]   .core-rte-editor-container.toolbar-hidden[_ngcontent-%COMP%] {\\n  max-height: 100%;\\n}\\n[_nghost-%COMP%]   .core-rte-editor-container[_ngcontent-%COMP%]   .core-rte-info-message[_ngcontent-%COMP%] {\\n  padding: 5px;\\n  border-top: 1px solid var(--info);\\n  background: var(--background);\\n  flex-shrink: 1;\\n  font-size: 1.1rem;\\n}\\n[_nghost-%COMP%]   .core-rte-editor-container[_ngcontent-%COMP%]   .core-rte-info-message[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%] {\\n  color: var(--info);\\n}\\n[_nghost-%COMP%]   .core-rte-editor[_ngcontent-%COMP%], [_nghost-%COMP%]   .core-textarea[_ngcontent-%COMP%] {\\n  padding: 2px;\\n  margin: 2px;\\n  width: calc(100% - 4px);\\n  resize: none;\\n  background-color: var(--background);\\n  color: var(--color);\\n  flex-grow: 1;\\n}\\n[_nghost-%COMP%]   .core-rte-editor[_ngcontent-%COMP%] {\\n  -webkit-user-select: auto !important;\\n  user-select: auto !important;\\n  word-wrap: break-word;\\n  overflow-x: hidden;\\n  overflow-y: auto;\\n  cursor: text;\\n}\\n[_nghost-%COMP%]   .core-rte-editor[_ngcontent-%COMP%]     img {\\n  -webkit-padding-start: 2px;\\n  padding-inline-start: 2px;\\n  max-width: 95%;\\n  width: auto;\\n}\\n[_nghost-%COMP%]   .core-rte-editor[_ngcontent-%COMP%]:empty:before {\\n  content: attr(data-placeholder-text);\\n  display: block;\\n  color: var(--placeholder-color);\\n  font-weight: bold;\\n}\\n[_nghost-%COMP%]   .core-rte-editor[_ngcontent-%COMP%]     *:empty:after {\\n  content: \\\"\\u200B\\\";\\n}\\n[_nghost-%COMP%]   .core-textarea[_ngcontent-%COMP%] {\\n  position: relative;\\n}\\n[_nghost-%COMP%]   .core-textarea[_ngcontent-%COMP%]     textarea {\\n  margin: 0 !important;\\n  padding: 0;\\n  resize: none;\\n  overflow-x: hidden;\\n  overflow-y: auto;\\n  position: absolute;\\n  height: auto;\\n  top: 0;\\n  bottom: 0;\\n}\\n[_nghost-%COMP%]   div.core-rte-toolbar[_ngcontent-%COMP%] {\\n  display: flex;\\n  width: 100%;\\n  z-index: 1;\\n  flex-grow: 0;\\n  flex-shrink: 0;\\n  background-color: var(--toobar-background);\\n  padding-top: 5px;\\n  border-top: 1px solid var(--stroke);\\n}\\n[_nghost-%COMP%]   div.core-rte-toolbar[_ngcontent-%COMP%]   swiper-container[_ngcontent-%COMP%] {\\n  width: 240px;\\n  flex-grow: 1;\\n  flex-shrink: 1;\\n}\\n[_nghost-%COMP%]   div.core-rte-toolbar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] {\\n  display: flex;\\n  justify-content: center;\\n  align-items: center;\\n  width: 36px;\\n  height: 36px;\\n  padding-right: 6px;\\n  padding-left: 6px;\\n  margin: 0 auto;\\n  font-size: 18px;\\n  background-color: var(--toobar-background);\\n  border-radius: var(--radius-xs);\\n  transition: background-color 200ms ease-in-out;\\n  color: var(--button-color);\\n  cursor: pointer;\\n}\\n[_nghost-%COMP%]   div.core-rte-toolbar[_ngcontent-%COMP%]   button.toolbar-button-enable[_ngcontent-%COMP%] {\\n  width: 100%;\\n}\\n[_nghost-%COMP%]   div.core-rte-toolbar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:active, [_nghost-%COMP%]   div.core-rte-toolbar[_ngcontent-%COMP%]   button[aria-pressed=true][_ngcontent-%COMP%] {\\n  background-color: var(--button-active-color);\\n}\\n[_nghost-%COMP%]   div.core-rte-toolbar[_ngcontent-%COMP%]   button.toolbar-arrow[_ngcontent-%COMP%] {\\n  width: 28px;\\n  flex-grow: 0;\\n  flex-shrink: 0;\\n  opacity: 1;\\n  transition: opacity 200ms ease-in-out;\\n}\\n[_nghost-%COMP%]   div.core-rte-toolbar[_ngcontent-%COMP%]   button.toolbar-arrow[_ngcontent-%COMP%]:active {\\n  background-color: var(--toobar-background);\\n}\\n[_nghost-%COMP%]   div.core-rte-toolbar[_ngcontent-%COMP%]   button.toolbar-arrow[disabled][_ngcontent-%COMP%], [_nghost-%COMP%]   div.core-rte-toolbar[_ngcontent-%COMP%]   button.toolbar-arrow[_ngcontent-%COMP%]:disabled {\\n  opacity: 0.5;\\n}\\n[_nghost-%COMP%]   div.core-rte-toolbar.toolbar-hidden[_ngcontent-%COMP%] {\\n  visibility: hidden;\\n  height: 0;\\n  border: none;\\n}\\n\\n.keyboard-is-open[_nghost-%COMP%], .keyboard-is-open   [_nghost-%COMP%] {\\n  min-height: 200px;\\n}\\n\\n.item-label-stacked[_nghost-%COMP%], .item-label-stacked   [_nghost-%COMP%] {\\n  margin-top: 10px;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9jb3JlL2ZlYXR1cmVzL2VkaXRvci9jb21wb25lbnRzL3JpY2gtdGV4dC1lZGl0b3IvcmljaC10ZXh0LWVkaXRvci5zY3NzIiwid2VicGFjazovLy4vc3JjL3RoZW1lL2dsb2JhbHMuc2NzcyIsIndlYnBhY2s6Ly8uL3NyYy90aGVtZS9oZWxwZXJzL2lvbmljLmZ1bmN0aW9ucy5zdHJpbmcuc2NzcyIsIndlYnBhY2s6Ly8uL3NyYy90aGVtZS9oZWxwZXJzL2lvbmljLmZ1bmN0aW9ucy5jb2xvci5zY3NzIiwid2VicGFjazovLy4vc3JjL3RoZW1lL2hlbHBlcnMvaW9uaWMubWl4aW5zLnNjc3MiLCJ3ZWJwYWNrOi8vLi9zcmMvdGhlbWUvaGVscGVycy9pb25pYy5jb21wb25lbnRzLm1peGlucy5zY3NzIiwid2VicGFjazovLy4vc3JjL3RoZW1lL2hlbHBlcnMvY3VzdG9tLm1peGlucy5zY3NzIiwid2VicGFjazovLy4vc3JjL3RoZW1lL2dsb2JhbHMuY3VzdG9tLnNjc3MiLCJ3ZWJwYWNrOi8vLi9zcmMvdGhlbWUvZ2xvYmFscy52YXJpYWJsZXMuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxnQkFBZ0I7QUNBaEI7Ozs7RUFBQTtBQ0FBOzs7OztFQUFBO0FDQUE7Ozs7O0VBQUE7QUNBQTs7Ozs7RUFBQTtBQ0FBOzs7Ozs7RUFBQTtBQ0VBOzs7O0VBQUE7QUE0R0E7O0VBQUE7QUM5R0E7Ozs7RUFBQTtBQ0FBOzs7O0VBQUE7QUErREE7Ozs7RUFBQTtBUjlEQTtFQUNJLGlEQUFBO0VBQ0EsaUNBQUE7RUFDQSxxQ0FBQTtFQUNBLHNDQUFBO0VBQ0EsMENBQUE7QUFzREo7O0FBbkRBO0VBQ0kscUJBQUE7RUFDQSwrQkFBQTtFQUNBLHNDQUFBO0VBQ0Esb0NBQUE7QUFzREo7O0FBbkRBO0VBQ0ksb0NBQUE7RUFDQSxnQkFBQTtFQUNBLGlCQUFBLEVBQUEscUNBQUE7RUFDQSxnQkFBQTtFQUNBLFdBQUE7RUFDQSxhQUFBO0VBQ0Esc0JBQUE7RUFDQSw2QkFBQTtBQXNESjtBQXBESTtFQUNJLDZCQUFBO0VBQ0EsYUFBQTtFQUNBLFlBQUE7RUFDQSxzQkFBQTtFQUNBLDhCQUFBO0FBc0RSO0FBckRRO0VBQ0ksZ0JBQUE7QUF1RFo7QUFwRFE7RUFDSSxZQUFBO0VBQ0EsaUNBQUE7RUFDQSw2QkFBQTtFQUNBLGNBQUE7RUFDQSxpQkFBQTtBQXNEWjtBQXBEWTtFQUNJLGtCQUFBO0FBc0RoQjtBQWpESTtFQUNJLFlBQUE7RUFDQSxXQUFBO0VBQ0EsdUJBQUE7RUFDQSxZQUFBO0VBQ0EsbUNBQUE7RUFDQSxtQkFBQTtFQUNBLFlBQUE7QUFtRFI7QUFoREk7RUFDSSxvQ0FBQTtFQUNBLDRCQUFBO0VBQ0EscUJBQUE7RUFDQSxrQkFBQTtFQUNBLGdCQUFBO0VBQ0EsWUFBQTtBQWtEUjtBQWpEUTtFSW1QSiwwQkpsUDJDO0VJbVAzQyx5QkpuUDJDO0VBQ25DLGNBQUE7RUFDQSxXQUFBO0FBb0RaO0FBbERRO0VBQ0ksb0NBQUE7RUFDQSxjQUFBO0VBQ0EsK0JBQUE7RUFDQSxpQkFBQTtBQW9EWjtBQWhEUTtFQUNJLFlBQUE7QUFrRFo7QUE5Q0k7RUFDSSxrQkFBQTtBQWdEUjtBQTlDUTtFQUNJLG9CQUFBO0VBQ0EsVUFBQTtFQUNBLFlBQUE7RUFDQSxrQkFBQTtFQUNBLGdCQUFBO0VBQ0Esa0JBQUE7RUFDQSxZQUFBO0VBQ0EsTUFBQTtFQUNBLFNBQUE7QUFnRFo7QUE1Q0k7RUFDSSxhQUFBO0VBQ0EsV0FBQTtFQUNBLFVBQUE7RUFDQSxZQUFBO0VBQ0EsY0FBQTtFQUNBLDBDQUFBO0VBQ0EsZ0JBQUE7RUFDQSxtQ0FBQTtBQThDUjtBQTVDUTtFQUNJLFlBQUE7RUFDQSxZQUFBO0VBQ0EsY0FBQTtBQThDWjtBQTNDUTtFQUNJLGFBQUE7RUFDQSx1QkFBQTtFQUNBLG1CQUFBO0VBQ0EsV0FBQTtFQUNBLFlBQUE7RUFDQSxrQkFBQTtFQUNBLGlCQUFBO0VBQ0EsY0FBQTtFQUNBLGVBQUE7RUFDQSwwQ0FBQTtFQUNBLCtCQUFBO0VNaENSLDhDQUpnQjtFTnNDUiwwQkFBQTtFQUNBLGVBQUE7QUE4Q1o7QUE1Q1k7RUFDSSxXQUFBO0FBOENoQjtBQTNDWTtFQUNJLDRDQUFBO0FBNkNoQjtBQTFDWTtFQUNJLFdBQUE7RUFDQSxZQUFBO0VBQ0EsY0FBQTtFQUNBLFVBQUE7RU1qRFoscUNBSmdCO0FObUdwQjtBQTNDZ0I7RUFDSSwwQ0FBQTtBQTZDcEI7QUExQ2dCO0VBRUksWUFBQTtBQTJDcEI7QUF0Q1E7RUFDSSxrQkFBQTtFQUNBLFNBQUE7RUFDQSxZQUFBO0FBd0NaOztBQW5DQTtFQUNJLGlCQUFBO0FBc0NKOztBQW5DQTtFQUNJLGdCQUFBO0FBc0NKIiwic291cmNlc0NvbnRlbnQiOlsiQHVzZSBcInRoZW1lL2dsb2JhbHNcIiBhcyAqO1xuOmhvc3Qge1xuICAgIC0tcGxhY2Vob2xkZXItY29sb3I6IHZhcigtLWlvbi1wbGFjZWhvbGRlci1jb2xvcik7XG4gICAgLS10b29iYXItYmFja2dyb3VuZDogdmFyKC0td2hpdGUpO1xuICAgIC0tYnV0dG9uLWNvbG9yOiB2YXIoLS1pb24tdGV4dC1jb2xvcik7XG4gICAgLS1idXR0b24tYWN0aXZlLWNvbG9yOiB2YXIoLS1ncmF5LTMwMCk7XG4gICAgLS1iYWNrZ3JvdW5kOiB2YXIoLS1ydGUtZWRpdG9yLWJhY2tncm91bmQpO1xufVxuXG46aG9zdC1jb250ZXh0KGh0bWwuZGFyaykge1xuICAgIC0tY29sb3I6IHZhcigtLXdoaXRlKTtcbiAgICAtLWJ1dHRvbi1jb2xvcjogdmFyKC0tZ3JheS0yMDApO1xuICAgIC0tYnV0dG9uLWFjdGl2ZS1jb2xvcjogdmFyKC0tZ3JheS01MDApO1xuICAgIC0tdG9vYmFyLWJhY2tncm91bmQ6IHZhcigtLWdyYXktOTAwKTtcbn1cblxuOmhvc3Qge1xuICAgIGhlaWdodDogdmFyKC0tY29yZS1ydGUtaGVpZ2h0LCBhdXRvKTtcbiAgICBvdmVyZmxvdzogaGlkZGVuO1xuICAgIG1pbi1oZWlnaHQ6IDIwMHB4OyAvKiBKdXN0IGluIGNhc2UgdmggaXMgbm90IHN1cHBvcnRlZCAqL1xuICAgIG1pbi1oZWlnaHQ6IDQwdmg7XG4gICAgd2lkdGg6IDEwMCU7XG4gICAgZGlzcGxheTogZmxleDtcbiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICAgIGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQpO1xuXG4gICAgLmNvcmUtcnRlLWVkaXRvci1jb250YWluZXIge1xuICAgICAgICBtYXgtaGVpZ2h0OiBjYWxjKDEwMCUgLSA0NnB4KTtcbiAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgZmxleC1ncm93OiAxO1xuICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XG4gICAgICAgICYudG9vbGJhci1oaWRkZW4ge1xuICAgICAgICAgICAgbWF4LWhlaWdodDogMTAwJTtcbiAgICAgICAgfVxuXG4gICAgICAgIC5jb3JlLXJ0ZS1pbmZvLW1lc3NhZ2Uge1xuICAgICAgICAgICAgcGFkZGluZzogNXB4O1xuICAgICAgICAgICAgYm9yZGVyLXRvcDogMXB4IHNvbGlkIHZhcigtLWluZm8pO1xuICAgICAgICAgICAgYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZCk7XG4gICAgICAgICAgICBmbGV4LXNocmluazogMTtcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogMS4xcmVtO1xuXG4gICAgICAgICAgICAuaWNvbiB7XG4gICAgICAgICAgICAgICAgY29sb3I6IHZhcigtLWluZm8pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLmNvcmUtcnRlLWVkaXRvciwgLmNvcmUtdGV4dGFyZWEge1xuICAgICAgICBwYWRkaW5nOiAycHg7XG4gICAgICAgIG1hcmdpbjogMnB4O1xuICAgICAgICB3aWR0aDogY2FsYygxMDAlIC0gNHB4KTtcbiAgICAgICAgcmVzaXplOiBub25lO1xuICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1iYWNrZ3JvdW5kKTtcbiAgICAgICAgY29sb3I6IHZhcigtLWNvbG9yKTtcbiAgICAgICAgZmxleC1ncm93OiAxO1xuICAgIH1cblxuICAgIC5jb3JlLXJ0ZS1lZGl0b3Ige1xuICAgICAgICAtd2Via2l0LXVzZXItc2VsZWN0OiBhdXRvICFpbXBvcnRhbnQ7XG4gICAgICAgIHVzZXItc2VsZWN0OiBhdXRvICFpbXBvcnRhbnQ7XG4gICAgICAgIHdvcmQtd3JhcDogYnJlYWstd29yZDtcbiAgICAgICAgb3ZlcmZsb3cteDogaGlkZGVuO1xuICAgICAgICBvdmVyZmxvdy15OiBhdXRvO1xuICAgICAgICBjdXJzb3I6IHRleHQ7XG4gICAgICAgIDo6bmctZGVlcCBpbWcge1xuICAgICAgICAgICAgQGluY2x1ZGUgcGFkZGluZyhudWxsLCBudWxsLCBudWxsLCAycHgpO1xuICAgICAgICAgICAgbWF4LXdpZHRoOiA5NSU7XG4gICAgICAgICAgICB3aWR0aDogYXV0bztcbiAgICAgICAgfVxuICAgICAgICAmOmVtcHR5OmJlZm9yZSB7XG4gICAgICAgICAgICBjb250ZW50OiBhdHRyKGRhdGEtcGxhY2Vob2xkZXItdGV4dCk7XG4gICAgICAgICAgICBkaXNwbGF5OiBibG9jaztcbiAgICAgICAgICAgIGNvbG9yOiB2YXIoLS1wbGFjZWhvbGRlci1jb2xvcik7XG4gICAgICAgICAgICBmb250LXdlaWdodDogYm9sZDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIE1ha2UgZW1wdHkgZWxlbWVudHMgc2VsZWN0YWJsZSAodG8gbW92ZSB0aGUgY3Vyc29yKS5cbiAgICAgICAgOjpuZy1kZWVwICo6ZW1wdHk6YWZ0ZXIge1xuICAgICAgICAgICAgY29udGVudDogJ1xcMjAwQic7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAuY29yZS10ZXh0YXJlYSB7XG4gICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcblxuICAgICAgICA6Om5nLWRlZXAgdGV4dGFyZWEge1xuICAgICAgICAgICAgbWFyZ2luOiAwICFpbXBvcnRhbnQ7XG4gICAgICAgICAgICBwYWRkaW5nOiAwO1xuICAgICAgICAgICAgcmVzaXplOiBub25lO1xuICAgICAgICAgICAgb3ZlcmZsb3cteDogaGlkZGVuO1xuICAgICAgICAgICAgb3ZlcmZsb3cteTogYXV0bztcbiAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICAgICAgICAgIGhlaWdodDogYXV0bztcbiAgICAgICAgICAgIHRvcDogMDtcbiAgICAgICAgICAgIGJvdHRvbTogMDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGRpdi5jb3JlLXJ0ZS10b29sYmFyIHtcbiAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgd2lkdGg6IDEwMCU7XG4gICAgICAgIHotaW5kZXg6IDE7XG4gICAgICAgIGZsZXgtZ3JvdzogMDtcbiAgICAgICAgZmxleC1zaHJpbms6IDA7XG4gICAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLXRvb2Jhci1iYWNrZ3JvdW5kKTtcbiAgICAgICAgcGFkZGluZy10b3A6IDVweDtcbiAgICAgICAgYm9yZGVyLXRvcDogMXB4IHNvbGlkIHZhcigtLXN0cm9rZSk7XG5cbiAgICAgICAgc3dpcGVyLWNvbnRhaW5lciB7XG4gICAgICAgICAgICB3aWR0aDogMjQwcHg7XG4gICAgICAgICAgICBmbGV4LWdyb3c6IDE7XG4gICAgICAgICAgICBmbGV4LXNocmluazogMTtcbiAgICAgICAgfVxuXG4gICAgICAgIGJ1dHRvbiB7XG4gICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICAgICAgd2lkdGg6IDM2cHg7XG4gICAgICAgICAgICBoZWlnaHQ6IDM2cHg7XG4gICAgICAgICAgICBwYWRkaW5nLXJpZ2h0OiA2cHg7XG4gICAgICAgICAgICBwYWRkaW5nLWxlZnQ6IDZweDtcbiAgICAgICAgICAgIG1hcmdpbjogMCBhdXRvO1xuICAgICAgICAgICAgZm9udC1zaXplOiAxOHB4O1xuICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tdG9vYmFyLWJhY2tncm91bmQpO1xuICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLXhzKTtcbiAgICAgICAgICAgIEBpbmNsdWRlIGNvcmUtdHJhbnNpdGlvbihiYWNrZ3JvdW5kLWNvbG9yLCAyMDBtcyk7XG4gICAgICAgICAgICBjb2xvcjogdmFyKC0tYnV0dG9uLWNvbG9yKTtcbiAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjtcblxuICAgICAgICAgICAgJi50b29sYmFyLWJ1dHRvbi1lbmFibGUge1xuICAgICAgICAgICAgICAgIHdpZHRoOiAxMDAlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAmOmFjdGl2ZSwgJlthcmlhLXByZXNzZWQ9XCJ0cnVlXCJdIHtcbiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1idXR0b24tYWN0aXZlLWNvbG9yKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgJi50b29sYmFyLWFycm93IHtcbiAgICAgICAgICAgICAgICB3aWR0aDogMjhweDtcbiAgICAgICAgICAgICAgICBmbGV4LWdyb3c6IDA7XG4gICAgICAgICAgICAgICAgZmxleC1zaHJpbms6IDA7XG4gICAgICAgICAgICAgICAgb3BhY2l0eTogMTtcbiAgICAgICAgICAgICAgICBAaW5jbHVkZSBjb3JlLXRyYW5zaXRpb24ob3BhY2l0eSwgMjAwbXMpO1xuXG4gICAgICAgICAgICAgICAgJjphY3RpdmUge1xuICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS10b29iYXItYmFja2dyb3VuZCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgJltkaXNhYmxlZF0sXG4gICAgICAgICAgICAgICAgJjpkaXNhYmxlZCB7XG4gICAgICAgICAgICAgICAgICAgIG9wYWNpdHk6IC41O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgICYudG9vbGJhci1oaWRkZW4ge1xuICAgICAgICAgICAgdmlzaWJpbGl0eTogaGlkZGVuO1xuICAgICAgICAgICAgaGVpZ2h0OiAwO1xuICAgICAgICAgICAgYm9yZGVyOiBub25lO1xuICAgICAgICB9XG4gICAgfVxufVxuXG46aG9zdC1jb250ZXh0KC5rZXlib2FyZC1pcy1vcGVuKSB7XG4gICAgbWluLWhlaWdodDogMjAwcHg7XG59XG5cbjpob3N0LWNvbnRleHQoLml0ZW0tbGFiZWwtc3RhY2tlZCkge1xuICAgIG1hcmdpbi10b3A6IDEwcHg7XG59XG4iLCIvKipcbiAqIEFwcCBHbG9iYWwgdmFyaWFibGVzIFNDU1NcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqIFBsYWNlIGhlcmUgdGhlIGRpZmZlcmVudCBmaWxlcyB5b3Ugc2hvdWxkIGltcG9ydCB0byB1c2UgZ2xvYmFsIHZhcmlhYmxlcy5cbiAqL1xuXG4kZm9udC1wYXRoOiBcIi4uL2Fzc2V0cy9mb250c1wiO1xuJGFzc2V0cy1wYXRoOiBcIi4uL2Fzc2V0c1wiO1xuXG5AaW1wb3J0IFwiLi9oZWxwZXJzL2hlbHBlcnMuc2Nzc1wiO1xuQGltcG9ydCBcIi4vZ2xvYmFscy5jdXN0b20uc2Nzc1wiO1xuQGltcG9ydCBcIi4vZ2xvYmFscy52YXJpYWJsZXMuc2Nzc1wiO1xuIiwiLyoqXG4gKiBJbXBvcnRlZCBpb25pYyBzdHJpbmcgZnVuY3Rpb25zIGZvciBTQ1NTXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiBFeHRyYWN0ZWQgZnJvbVxuICogaHR0cHM6Ly9naXRodWIuY29tL2lvbmljLXRlYW0vaW9uaWMtZnJhbWV3b3JrL2Jsb2IvbWFzdGVyL2NvcmUvc3JjL3RoZW1lcy9pb25pYy5mdW5jdGlvbnMuc3RyaW5nLnNjc3NcbiAqL1xuXG5cbi8vIFN0cmluZyBVdGlsaXR5IEZ1bmN0aW9uc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuLy8gU3RyaW5nIFJlcGxhY2UgRnVuY3Rpb25cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbkBmdW5jdGlvbiBzdHItcmVwbGFjZSgkc3RyaW5nLCAkc2VhcmNoLCAkcmVwbGFjZTogXCJcIikge1xuICAkaW5kZXg6IHN0ci1pbmRleCgkc3RyaW5nLCAkc2VhcmNoKTtcblxuICBAaWYgJGluZGV4IHtcbiAgICBAcmV0dXJuIHN0ci1zbGljZSgkc3RyaW5nLCAxLCAkaW5kZXggLSAxKSArICRyZXBsYWNlICsgc3RyLXJlcGxhY2Uoc3RyLXNsaWNlKCRzdHJpbmcsICRpbmRleCArIHN0ci1sZW5ndGgoJHNlYXJjaCkpLCAkc2VhcmNoLCAkcmVwbGFjZSk7XG4gIH1cblxuICBAcmV0dXJuICRzdHJpbmc7XG59XG5cbi8vIFN0cmluZyBTcGxpdCBGdW5jdGlvblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuXG5AZnVuY3Rpb24gc3RyLXNwbGl0KCRzdHJpbmcsICRzZXBhcmF0b3IpIHtcbiAgLy8gZW1wdHkgYXJyYXkvbGlzdFxuICAkc3BsaXQtYXJyOiAoKTtcbiAgLy8gZmlyc3QgaW5kZXggb2Ygc2VwYXJhdG9yIGluIHN0cmluZ1xuICAkaW5kZXg6IHN0ci1pbmRleCgkc3RyaW5nLCAkc2VwYXJhdG9yKTtcbiAgLy8gbG9vcCB0aHJvdWdoIHN0cmluZ1xuICBAd2hpbGUgJGluZGV4ICE9IG51bGwge1xuICAgIC8vIGdldCB0aGUgc3Vic3RyaW5nIGZyb20gdGhlIGZpcnN0IGNoYXJhY3RlciB0byB0aGUgc2VwYXJhdG9yXG4gICAgJGl0ZW06IHN0ci1zbGljZSgkc3RyaW5nLCAxLCAkaW5kZXggLSAxKTtcbiAgICAvLyBwdXNoIGl0ZW0gdG8gYXJyYXlcbiAgICAkc3BsaXQtYXJyOiBhcHBlbmQoJHNwbGl0LWFyciwgJGl0ZW0pO1xuICAgIC8vIHJlbW92ZSBpdGVtIGFuZCBzZXBhcmF0b3IgZnJvbSBzdHJpbmdcbiAgICAkc3RyaW5nOiBzdHItc2xpY2UoJHN0cmluZywgJGluZGV4ICsgMSk7XG4gICAgLy8gZmluZCBuZXcgaW5kZXggb2Ygc2VwYXJhdG9yXG4gICAgJGluZGV4OiBzdHItaW5kZXgoJHN0cmluZywgJHNlcGFyYXRvcik7XG4gIH1cbiAgLy8gYWRkIHRoZSByZW1haW5pbmcgc3RyaW5nIHRvIGxpc3QgKHRoZSBsYXN0IGl0ZW0pXG4gICRzcGxpdC1hcnI6IGFwcGVuZCgkc3BsaXQtYXJyLCAkc3RyaW5nKTtcblxuICBAcmV0dXJuICRzcGxpdC1hcnI7XG59XG5cblxuLy8gU3RyaW5nIEV4dHJhY3QgRnVuY3Rpb25cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbkBmdW5jdGlvbiBzdHItZXh0cmFjdCgkc3RyaW5nLCAkc3RhcnQsICRlbmQpIHtcbiAgJHN0YXJ0LWluZGV4OiBzdHItaW5kZXgoJHN0cmluZywgJHN0YXJ0KTtcblxuICBAaWYgJHN0YXJ0LWluZGV4IHtcbiAgICAkcG9zdDogc3RyLXNsaWNlKCRzdHJpbmcsICRzdGFydC1pbmRleCArIHN0ci1sZW5ndGgoJHN0YXJ0KSk7XG4gICAgJGVuZC1pbmRleDogc3RyLWluZGV4KCRwb3N0LCAkZW5kKTtcblxuICAgIEBpZiAkZW5kLWluZGV4IHtcbiAgICAgIEByZXR1cm4gc3RyLXNsaWNlKCRwb3N0LCAxLCAkZW5kLWluZGV4IC0gMSk7XG4gICAgfVxuICB9XG5cbiAgQHJldHVybiBudWxsO1xufVxuXG5cbi8vIFN0cmluZyBDb250YWlucyBGdW5jdGlvblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuQGZ1bmN0aW9uIHN0ci1jb250YWlucygkc3RyaW5nLCAkbmVlZGxlKSB7XG4gIEBpZiAodHlwZS1vZigkc3RyaW5nKSA9PSBzdHJpbmcpIHtcbiAgICBAcmV0dXJuIHN0ci1pbmRleCgkc3RyaW5nLCAkbmVlZGxlKSAhPSBudWxsO1xuICB9XG5cbiAgQHJldHVybiBmYWxzZTtcbn1cblxuXG4vLyBVUkwgRW5jb2RlIEZ1bmN0aW9uXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5AZnVuY3Rpb24gdXJsLWVuY29kZSgkdmFsKSB7XG4gICRzcGFjZXM6IHN0ci1yZXBsYWNlKCR2YWwsIFwiIFwiLCBcIiUyMFwiKTtcbiAgJGVuY29kZWQ6IHN0ci1yZXBsYWNlKCRzcGFjZXMsIFwiI1wiLCBcIiUyM1wiKTtcbiAgQHJldHVybiAkZW5jb2RlZDtcbn1cblxuXG4vLyBBZGQgUm9vdCBTZWxlY3RvclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIEFkZHMgYSByb290IHNlbGVjdG9yIHVzaW5nIGhvc3QgYmFzZWQgb24gdGhlIHNlbGVjdG9yIHBhc3NlZFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuQGZ1bmN0aW9uIGFkZC1yb290LXNlbGVjdG9yKCRyb290LCAkYWRkSG9zdFNlbGVjdG9yKSB7XG4gICRzZWxlY3RvcnM6IHN0ci1zcGxpdCgkcm9vdCwgXCIsXCIpO1xuXG4gICRsaXN0OiAoKTtcblxuICBAZWFjaCAkc2VsZWN0b3IgaW4gJHNlbGVjdG9ycyB7XG4gICAgLy8gSWYgdGhlIHNlbGVjdG9yIGNvbnRhaW5zIDpob3N0KCBpdCBtZWFucyBpdCBpcyB0YXJnZXRpbmcgYSBjbGFzcyBvbiB0aGUgaG9zdFxuICAgIC8vIGVsZW1lbnQgc28gd2UgbmVlZCB0byBjaGFuZ2UgaG93IHdlIHRhcmdldCBpdDpcbiAgICAvLyBAaW5jbHVkZSBhZGQtcm9vdC1zZWxlY3RvcihcIjpob3N0KC5maXhlZClcIiwgXCJbZGlyPXJ0bF1cIilcbiAgICAvLyAtLT4gOmhvc3QtY29udGV4dChbZGlyPXJ0bF0pOmhvc3QoLmZpeGVkKVxuICAgIC8vIC0tPiA6aG9zdC1jb250ZXh0KFtkaXI9cnRsXSkuZml4ZWRcbiAgICBAaWYgc3RyLWNvbnRhaW5zKCRzZWxlY3RvciwgXCI6aG9zdChcIikge1xuICAgICAgLy8gQGluY2x1ZGUgYWRkLXJvb3Qtc2VsZWN0b3IoXCI6aG9zdCguZml4ZWQpXCIsIFwiW2Rpcj1ydGxdXCIpXG4gICAgICAvLyAtLT4gOmhvc3QtY29udGV4dChbZGlyPXJ0bF0pOmhvc3QoLmZpeGVkKVxuICAgICAgJHNoYWRvdy1lbGVtZW50OiBzdHItcmVwbGFjZSgkc2VsZWN0b3IsIFwiOmhvc3QoXCIsIFwiOmhvc3QtY29udGV4dCgjeyRhZGRIb3N0U2VsZWN0b3J9KTpob3N0KFwiKTtcbiAgICAgICRsaXN0OiBhcHBlbmQoJGxpc3QsICRzaGFkb3ctZWxlbWVudCwgY29tbWEpO1xuXG4gICAgICAkbmV3LWVsZW1lbnQ6ICgpO1xuICAgICAgJGVsZW1lbnRzOiBzdHItc3BsaXQoJHNlbGVjdG9yLCBcIiBcIik7XG5cbiAgICAgIEBlYWNoICRlbGVtZW50IGluICRlbGVtZW50cyB7XG4gICAgICAgIEBpZiBzdHItY29udGFpbnMoJGVsZW1lbnQsIFwiOmhvc3QoXCIpIHtcbiAgICAgICAgICAkc2NvcGVkLWVsZW1lbnQ6ICRlbGVtZW50O1xuXG4gICAgICAgICAgLy8gUmVwbGFjZSB0aGUgOmhvc3QoIGFuZCApIHNvIGFsbCB3ZSBoYXZlIGxlZnQgaXMgdGhlIGNsYXNzXG4gICAgICAgICAgLy8gaW5zaWRlIG9mIGl0OlxuICAgICAgICAgIC8vIDpob3N0KC5maXhlZCkgLT4gLmZpeGVkXG4gICAgICAgICAgJHNjb3BlZC1lbGVtZW50OiBzdHItcmVwbGFjZSgkc2NvcGVkLWVsZW1lbnQsIFwiKVwiLCBcIlwiKTtcbiAgICAgICAgICAkc2NvcGVkLWVsZW1lbnQ6IHN0ci1yZXBsYWNlKCRzY29wZWQtZWxlbWVudCwgXCI6aG9zdChcIiwgXCJcIik7XG5cbiAgICAgICAgICAvLyBBZGQgdGhlIGNsYXNzIGJhY2sgaW5zaWRlIG9mIGhvc3Qgd2l0aCB0aGUgcnRsIHNlbGVjdG9yOlxuICAgICAgICAgIC8vIC5maXhlZCAtPiA6aG9zdC1jb250ZXh0KFtkaXI9cnRsXSkuZml4ZWRcbiAgICAgICAgICAkc2NvcGVkLWVsZW1lbnQ6IHN0ci1yZXBsYWNlKCRzY29wZWQtZWxlbWVudCwgJHNjb3BlZC1lbGVtZW50LCBcIjpob3N0LWNvbnRleHQoI3skYWRkSG9zdFNlbGVjdG9yfSkjeyRzY29wZWQtZWxlbWVudH1cIik7XG5cbiAgICAgICAgICAvLyBAaW5jbHVkZSBhZGQtcm9vdC1zZWxlY3RvcihcIjpob3N0KC5maXhlZClcIiwgXCJbZGlyPXJ0bF1cIilcbiAgICAgICAgICAvLyAtLT4gOmhvc3QtY29udGV4dChbZGlyPXJ0bF0pLmZpeGVkXG4gICAgICAgICAgJG5ldy1lbGVtZW50OiBhcHBlbmQoJG5ldy1lbGVtZW50LCAkc2NvcGVkLWVsZW1lbnQsIHNwYWNlKTtcbiAgICAgICAgfSBAZWxzZSB7XG4gICAgICAgICAgLy8gQWRkIGJhY2sgYW55IHNlbGVjdG9ycyB0aGF0IGZvbGxvd2VkIHRoZSBob3N0IGFmdGVyIHRyYW5zZm9ybWluZyB0aGVcbiAgICAgICAgICAvLyBmaXJzdCBzZWxlY3RvcjpcbiAgICAgICAgICAvLyA6aG9zdCguZml4ZWQpIDo6c2xvdHRlZChpb24taWNvbilcbiAgICAgICAgICAvLyAtLT4gOmhvc3QtY29udGV4dChbZGlyPXJ0bF0pOmhvc3QoLmZpeGVkKSA6OnNsb3R0ZWQoaW9uLWljb24pXG4gICAgICAgICAgLy8gLS0+IDpob3N0LWNvbnRleHQoW2Rpcj1ydGxdKS5maXhlZCA6OnNsb3R0ZWQoaW9uLWljb24pXG4gICAgICAgICAgJG5ldy1lbGVtZW50OiBhcHBlbmQoJG5ldy1lbGVtZW50LCAkZWxlbWVudCwgc3BhY2UpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgICRsaXN0OiBhcHBlbmQoJGxpc3QsICRuZXctZWxlbWVudCwgY29tbWEpO1xuICAgIC8vIElmIHRoZSBzZWxlY3RvciBjb250YWlucyA6aG9zdCB3aXRob3V0IGEgcGFyYW50aGVzZXNcbiAgICAvLyBpdCBtZWFucyBpdCBpcyB0YXJnZXRpbmcganVzdCB0aGUgaG9zdFxuICAgIC8vIGVsZW1lbnQgc28gd2UgY2FuIGNoYW5nZSBpdCB0byBsb29rIGZvciBob3N0LWNvbnRleHRcbiAgICAvLyBAaW5jbHVkZSBhZGQtcm9vdC1zZWxlY3RvcihcIjpob3N0XCIsIFwiW2Rpcj1ydGxdXCIpXG4gICAgLy8gLS0+IDpob3N0LWNvbnRleHQoW2Rpcj1ydGxdKVxuICAgIC8vIC0tPiA6aG9zdDpkaXIocnRsKVxuICAgIH0gQGVsc2UgaWYgc3RyLWNvbnRhaW5zKCRzZWxlY3RvciwgXCI6aG9zdFwiKSB7XG4gICAgICAkbmV3LWVsZW1lbnQ6ICgpO1xuICAgICAgJGVsZW1lbnRzOiBzdHItc3BsaXQoJHNlbGVjdG9yLCBcIiBcIik7XG5cbiAgICAgIEBlYWNoICRlbGVtZW50IGluICRlbGVtZW50cyB7XG4gICAgICAgIEBpZiBzdHItY29udGFpbnMoJGVsZW1lbnQsIFwiOmhvc3RcIikge1xuICAgICAgICAgIC8vIFJlcGxhY2UgdGhlIDpob3N0IHdpdGggdGhlIGFkZEhvc3RTZWxlY3RvcjpcbiAgICAgICAgICAvLyA6aG9zdCAtPiA6aG9zdC1jb250ZXh0KFtkaXI9cnRsXSlcbiAgICAgICAgICAkdXBkYXRlZC1lbGVtZW50OiBzdHItcmVwbGFjZSgkZWxlbWVudCwgXCI6aG9zdFwiLCBcIjpob3N0LWNvbnRleHQoI3skYWRkSG9zdFNlbGVjdG9yfSlcIik7XG5cbiAgICAgICAgICAvLyBBZGQgdGhlIGZpbmFsIHNlbGVjdG9yIGFmdGVyIGFsbCB0cmFuc2Zvcm1hdGlvbnM6XG4gICAgICAgICAgLy8gOmhvc3QgLT4gOmhvc3QtY29udGV4dChbZGlyPXJ0bF0pXG4gICAgICAgICAgJG5ldy1lbGVtZW50OiBhcHBlbmQoJG5ldy1lbGVtZW50LCAkdXBkYXRlZC1lbGVtZW50LCBzcGFjZSk7XG4gICAgICAgIH0gQGVsc2Uge1xuICAgICAgICAgIC8vIEFkZCBiYWNrIGFueSBzZWxlY3RvcnMgdGhhdCBmb2xsb3dlZCB0aGUgaG9zdCBhZnRlciB0cmFuc2Zvcm1pbmcgdGhlXG4gICAgICAgICAgLy8gZmlyc3Qgc2VsZWN0b3I6XG4gICAgICAgICAgLy8gOmhvc3QgOjpzbG90dGVkKGlvbi1pY29uKSAtPiA6aG9zdC1jb250ZXh0KFtkaXI9cnRsXSkgOjpzbG90dGVkKGlvbi1pY29uKVxuICAgICAgICAgICRuZXctZWxlbWVudDogYXBwZW5kKCRuZXctZWxlbWVudCwgJGVsZW1lbnQsIHNwYWNlKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAkbGlzdDogYXBwZW5kKCRsaXN0LCAkbmV3LWVsZW1lbnQsIGNvbW1hKTtcbiAgICAvLyBJZiB0aGUgc2VsZWN0b3IgZG9lcyBub3QgY29udGFpbiBob3N0IGF0IGFsbCBpdCBpcyBlaXRoZXIgYSBzaGFkb3dcbiAgICAvLyBvciBub3JtYWwgZWxlbWVudCBzbyBhcHBlbmQgYm90aCB0aGUgYWRkSG9zdFNlbGVjdG9yIGFuZCBob3N0LWNvbnRleHRcbiAgICAvLyBAaW5jbHVkZSBhZGQtcm9vdC1zZWxlY3RvcihcImlvbi1jb21wb25lbnRcIiwgXCJbZGlyPXJ0bF1cIilcbiAgICAvLyAtLT4gOmhvc3QtY29udGV4dChbZGlyPXJ0bF0pIGlvbi1jb21wb25lbnRcbiAgICAvLyAtLT4gW2Rpcj1ydGxdIGlvbi1jb21wb25lbnRcbiAgICB9IEBlbHNlIHtcbiAgICAgICRsaXN0OiBhcHBlbmQoJGxpc3QsIFwiI3skYWRkSG9zdFNlbGVjdG9yfSAjeyRzZWxlY3Rvcn1cIiwgY29tbWEpO1xuICAgICAgJGxpc3Q6IGFwcGVuZCgkbGlzdCwgXCI6aG9zdC1jb250ZXh0KCN7JGFkZEhvc3RTZWxlY3Rvcn0pICN7JHNlbGVjdG9yfVwiLCBjb21tYSk7XG4gICAgfVxuICB9XG5cbiAgQHJldHVybiAkbGlzdDtcbn1cbiIsIi8qKlxuICogSW1wb3J0ZWQgaW9uaWMgY29sb3IgZnVuY3Rpb25zIGZvciBTQ1NTXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiBFeHRyYWN0ZWQgZnJvbVxuICogaHR0cHM6Ly9naXRodWIuY29tL2lvbmljLXRlYW0vaW9uaWMtZnJhbWV3b3JrL2Jsb2IvbWFzdGVyL2NvcmUvc3JjL3RoZW1lcy9pb25pYy5mdW5jdGlvbnMuY29sb3Iuc2Nzc1xuICovXG5cbi8vIEdldHMgdGhlIGFjdGl2ZSBjb2xvcidzIGNzcyB2YXJpYWJsZSBmcm9tIGEgdmFyaWF0aW9uLiBBbHBoYSBpcyBvcHRpb25hbC5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBFeGFtcGxlIHVzYWdlOlxuLy8gY3VycmVudC1jb2xvcihiYXNlKSA9PiB2YXIoLS1pb24tY29sb3ItYmFzZSlcbi8vIGN1cnJlbnQtY29sb3IoY29udHJhc3QsIDAuMSkgPT4gcmdiYSh2YXIoLS1pb24tY29sb3ItY29udHJhc3QtcmdiKSwgMC4xKVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbkBmdW5jdGlvbiBjdXJyZW50LWNvbG9yKCR2YXJpYXRpb24sICRhbHBoYTogbnVsbCkge1xuICBAaWYgJGFscGhhID09IG51bGwge1xuICAgIEByZXR1cm4gdmFyKC0taW9uLWNvbG9yLSN7JHZhcmlhdGlvbn0pO1xuICB9IEBlbHNlIHtcbiAgICBAcmV0dXJuIHJnYmEodmFyKC0taW9uLWNvbG9yLSN7JHZhcmlhdGlvbn0tcmdiKSwgI3skYWxwaGF9KTtcbiAgfVxufVxuXG4vLyBHZXRzIHRoZSBzcGVjaWZpYyBjb2xvcidzIGNzcyB2YXJpYWJsZSBmcm9tIHRoZSBuYW1lIGFuZCB2YXJpYXRpb24uIEFscGhhL3JnYiBhcmUgb3B0aW9uYWwuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gRXhhbXBsZSB1c2FnZTpcbi8vIGlvbi1jb2xvcihwcmltYXJ5LCBiYXNlKSA9PiB2YXIoLS1pb24tY29sb3ItcHJpbWFyeSwgIzM4ODBmZilcbi8vIGlvbi1jb2xvcihzZWNvbmRhcnksIGNvbnRyYXN0KSA9PiB2YXIoLS1pb24tY29sb3Itc2Vjb25kYXJ5LWNvbnRyYXN0KVxuLy8gaW9uLWNvbG9yKHByaW1hcnksIGJhc2UsIDAuNSkgPT4gcmdiYSh2YXIoLS1pb24tY29sb3ItcHJpbWFyeS1yZ2IsIDU2LCAxMjgsIDI1NSksIDAuNSlcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5AZnVuY3Rpb24gaW9uLWNvbG9yKCRuYW1lLCAkdmFyaWF0aW9uLCAkYWxwaGE6IG51bGwsICRyZ2I6IG51bGwpIHtcbiAgJHZhbHVlczogbWFwLWdldCgkY29sb3JzLCAkbmFtZSk7XG4gICR2YWx1ZTogbWFwLWdldCgkdmFsdWVzLCAkdmFyaWF0aW9uKTtcbiAgJHZhcmlhYmxlOiAtLWlvbi1jb2xvci0jeyRuYW1lfS0jeyR2YXJpYXRpb259O1xuXG4gIEBpZiAoJHZhcmlhdGlvbiA9PSBiYXNlKSB7XG4gICAgJHZhcmlhYmxlOiAtLWlvbi1jb2xvci0jeyRuYW1lfTtcbiAgfVxuXG4gIEBpZiAoJGFscGhhKSB7XG4gICAgJHZhbHVlOiBjb2xvci10by1yZ2ItbGlzdCgkdmFsdWUpO1xuICAgIEByZXR1cm4gcmdiYSh2YXIoI3skdmFyaWFibGV9LXJnYiwgJHZhbHVlKSwgJGFscGhhKTtcbiAgfVxuICBAaWYgKCRyZ2IpIHtcbiAgICAkdmFsdWU6IGNvbG9yLXRvLXJnYi1saXN0KCR2YWx1ZSk7XG4gICAgJHZhcmlhYmxlOiAjeyR2YXJpYWJsZX0tcmdiO1xuICB9XG5cbiAgQHJldHVybiB2YXIoI3skdmFyaWFibGV9LCAkdmFsdWUpO1xufVxuXG4vLyBNaXhlcyBhIGNvbG9yIHdpdGggYmxhY2sgdG8gY3JlYXRlIGl0cyBzaGFkZS5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5AZnVuY3Rpb24gZ2V0LWNvbG9yLXNoYWRlKCRjb2xvcikge1xuICBAcmV0dXJuIG1peCgjMDAwLCAkY29sb3IsIDEyJSk7XG59XG5cbi8vIE1peGVzIGEgY29sb3Igd2l0aCB3aGl0ZSB0byBjcmVhdGUgaXRzIHRpbnQuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQGZ1bmN0aW9uIGdldC1jb2xvci10aW50KCRjb2xvcikge1xuICBAcmV0dXJuIG1peCgjZmZmLCAkY29sb3IsIDEwJSk7XG59XG5cbi8vIENvbnZlcnRzIGEgY29sb3IgdG8gYSBjb21tYSBzZXBhcmF0ZWQgcmdiLlxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbkBmdW5jdGlvbiBjb2xvci10by1yZ2ItbGlzdCgkY29sb3IpIHtcbiAgQHJldHVybiAje3JlZCgkY29sb3IpfSwje2dyZWVuKCRjb2xvcil9LCN7Ymx1ZSgkY29sb3IpfTtcbn1cbiIsIi8qKlxuICogSW1wb3J0ZWQgaW9uaWMgbWl4aW5zIGZvciBTQ1NTXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiBFeHRyYWN0ZWQgZnJvbVxuICogaHR0cHM6Ly9naXRodWIuY29tL2lvbmljLXRlYW0vaW9uaWMtZnJhbWV3b3JrL2Jsb2IvbWFzdGVyL2NvcmUvc3JjL3RoZW1lcy9pb25pYy5taXhpbnMuc2Nzc1xuICovXG5cbkBtaXhpbiBpbnB1dC1jb3ZlcigpIHtcbiAgQGluY2x1ZGUgcG9zaXRpb24oMCwgbnVsbCwgbnVsbCwgMCk7XG4gIEBpbmNsdWRlIG1hcmdpbigwKTtcblxuICBwb3NpdGlvbjogYWJzb2x1dGU7XG5cbiAgd2lkdGg6IDEwMCU7XG4gIGhlaWdodDogMTAwJTtcblxuICBib3JkZXI6IDA7XG4gIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50O1xuICBjdXJzb3I6IHBvaW50ZXI7XG5cbiAgYXBwZWFyYW5jZTogbm9uZTtcbiAgb3V0bGluZTogbm9uZTtcblxuICAmOjotbW96LWZvY3VzLWlubmVyIHtcbiAgICBib3JkZXI6IDA7XG4gIH1cbn1cblxuQG1peGluIHZpc3VhbGx5LWhpZGRlbigpIHtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuXG4gIHRvcDogMDtcbiAgbGVmdDogMDtcbiAgcmlnaHQ6IDA7XG4gIGJvdHRvbTogMDtcblxuICB3aWR0aDogMTAwJTtcbiAgaGVpZ2h0OiAxMDAlO1xuXG4gIG1hcmdpbjogMDtcbiAgcGFkZGluZzogMDtcblxuICBib3JkZXI6IDA7XG4gIG91dGxpbmU6IDA7XG4gIGNsaXA6IHJlY3QoMCAwIDAgMCk7XG5cbiAgb3BhY2l0eTogMDtcbiAgb3ZlcmZsb3c6IGhpZGRlbjtcblxuICAtd2Via2l0LWFwcGVhcmFuY2U6IG5vbmU7XG4gIC1tb3otYXBwZWFyYW5jZTogbm9uZTtcbn1cblxuQG1peGluIHRleHQtaW5oZXJpdCgpIHtcbiAgZm9udC1mYW1pbHk6IGluaGVyaXQ7XG4gIGZvbnQtc2l6ZTogaW5oZXJpdDtcbiAgZm9udC1zdHlsZTogaW5oZXJpdDtcbiAgZm9udC13ZWlnaHQ6IGluaGVyaXQ7XG4gIGxldHRlci1zcGFjaW5nOiBpbmhlcml0O1xuICB0ZXh0LWRlY29yYXRpb246IGluaGVyaXQ7XG4gIHRleHQtaW5kZW50OiBpbmhlcml0O1xuICB0ZXh0LW92ZXJmbG93OiBpbmhlcml0O1xuICB0ZXh0LXRyYW5zZm9ybTogaW5oZXJpdDtcbiAgdGV4dC1hbGlnbjogaW5oZXJpdDtcbiAgd2hpdGUtc3BhY2U6IGluaGVyaXQ7XG4gIGNvbG9yOiBpbmhlcml0O1xufVxuXG5AbWl4aW4gYnV0dG9uLXN0YXRlKCkge1xuICBAaW5jbHVkZSBwb3NpdGlvbigwLCAwLCAwLCAwKTtcblxuICBwb3NpdGlvbjogYWJzb2x1dGU7XG5cbiAgY29udGVudDogXCJcIjtcblxuICBvcGFjaXR5OiAwO1xufVxuXG4vLyBGb250IHNtb290aGluZ1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuQG1peGluIGZvbnQtc21vb3RoaW5nKCkge1xuICAtbW96LW9zeC1mb250LXNtb290aGluZzogZ3JheXNjYWxlO1xuICAtd2Via2l0LWZvbnQtc21vb3RoaW5nOiBhbnRpYWxpYXNlZDtcbn1cblxuLy8gR2V0IHRoZSBrZXkgZnJvbSBhIG1hcCBiYXNlZCBvbiB0aGUgaW5kZXhcbkBmdW5jdGlvbiBpbmRleC10by1rZXkoJG1hcCwgJGluZGV4KSB7XG4gICRrZXlzOiBtYXAta2V5cygkbWFwKTtcblxuICBAcmV0dXJuIG50aCgka2V5cywgJGluZGV4KTtcbn1cblxuXG4vLyBCcmVha3BvaW50IE1peGluc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbi8vIEJyZWFrcG9pbnQgdmlld3BvcnQgc2l6ZXMgYW5kIG1lZGlhIHF1ZXJpZXMuXG4vL1xuLy8gQnJlYWtwb2ludHMgYXJlIGRlZmluZWQgYXMgYSBtYXAgb2YgKG5hbWU6IG1pbmltdW0gd2lkdGgpLCBvcmRlciBmcm9tIHNtYWxsIHRvIGxhcmdlOlxuLy9cbi8vICAgICh4czogMCwgc206IDU3NnB4LCBtZDogNzY4cHgsIGxnOiA5OTJweCwgeGw6IDEyMDBweClcbi8vXG4vLyBUaGUgbWFwIGRlZmluZWQgaW4gdGhlIGAkc2NyZWVuLWJyZWFrcG9pbnRzYCBnbG9iYWwgdmFyaWFibGUgaXMgdXNlZCBhcyB0aGUgYCRicmVha3BvaW50c2AgYXJndW1lbnQgYnkgZGVmYXVsdC5cblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbi8vIE1pbmltdW0gYnJlYWtwb2ludCB3aWR0aC4gTnVsbCBmb3IgdGhlIHNtYWxsZXN0IChmaXJzdCkgYnJlYWtwb2ludC5cbi8vXG4vLyAgICA+PiBicmVha3BvaW50LW1pbihzbSwgKHhzOiAwLCBzbTogNTc2cHgsIG1kOiA3NjhweCwgbGc6IDk5MnB4LCB4bDogMTIwMHB4KSlcbi8vICAgIDU3NnB4XG5AZnVuY3Rpb24gYnJlYWtwb2ludC1taW4oJG5hbWUsICRicmVha3BvaW50czogJHNjcmVlbi1icmVha3BvaW50cykge1xuICAkbWluOiBtYXAtZ2V0KCRicmVha3BvaW50cywgJG5hbWUpO1xuXG4gIEByZXR1cm4gaWYoJG5hbWUgIT0gaW5kZXgtdG8ta2V5KCRicmVha3BvaW50cywgMSksICRtaW4sIG51bGwpO1xufVxuXG4vLyBSZXR1cm5zIGEgYmxhbmsgc3RyaW5nIGlmIHNtYWxsZXN0IGJyZWFrcG9pbnQsIG90aGVyd2lzZSByZXR1cm5zIHRoZSBuYW1lIHdpdGggYSBkYXNoIGluZnJvbnQuXG4vLyBVc2VmdWwgZm9yIG1ha2luZyByZXNwb25zaXZlIHV0aWxpdGllcy5cbi8vXG4vLyAgICA+PiBicmVha3BvaW50LWluZml4KHhzLCAoeHM6IDAsIHNtOiA1NzZweCwgbWQ6IDc2OHB4LCBsZzogOTkycHgsIHhsOiAxMjAwcHgpKVxuLy8gICAgXCJcIiAgKFJldHVybnMgYSBibGFuayBzdHJpbmcpXG4vLyAgICA+PiBicmVha3BvaW50LWluZml4KHNtLCAoeHM6IDAsIHNtOiA1NzZweCwgbWQ6IDc2OHB4LCBsZzogOTkycHgsIHhsOiAxMjAwcHgpKVxuLy8gICAgXCItc21cIlxuQGZ1bmN0aW9uIGJyZWFrcG9pbnQtaW5maXgoJG5hbWUsICRicmVha3BvaW50czogJHNjcmVlbi1icmVha3BvaW50cykge1xuICBAcmV0dXJuIGlmKGJyZWFrcG9pbnQtbWluKCRuYW1lLCAkYnJlYWtwb2ludHMpID09IG51bGwsIFwiXCIsIFwiLSN7JG5hbWV9XCIpO1xufVxuXG4vLyBNZWRpYSBvZiBhdCBsZWFzdCB0aGUgbWluaW11bSBicmVha3BvaW50IHdpZHRoLiBObyBxdWVyeSBmb3IgdGhlIHNtYWxsZXN0IGJyZWFrcG9pbnQuXG4vLyBNYWtlcyB0aGUgQGNvbnRlbnQgYXBwbHkgdG8gdGhlIGdpdmVuIGJyZWFrcG9pbnQgYW5kIHdpZGVyLlxuQG1peGluIG1lZGlhLWJyZWFrcG9pbnQtdXAoJG5hbWUsICRicmVha3BvaW50czogJHNjcmVlbi1icmVha3BvaW50cykge1xuICAkbWluOiBicmVha3BvaW50LW1pbigkbmFtZSwgJGJyZWFrcG9pbnRzKTtcbiAgQGlmICRtaW4ge1xuICAgIEBtZWRpYSAobWluLXdpZHRoOiAkbWluKSB7XG4gICAgICBAY29udGVudDtcbiAgICB9XG4gIH0gQGVsc2Uge1xuICAgIEBjb250ZW50O1xuICB9XG59XG5cbi8vIE5hbWUgb2YgdGhlIG5leHQgYnJlYWtwb2ludCwgb3IgbnVsbCBmb3IgdGhlIGxhc3QgYnJlYWtwb2ludC5cbi8vXG4vLyAgICA+PiBicmVha3BvaW50LW5leHQoc20pXG4vLyAgICBtZFxuLy8gICAgPj4gYnJlYWtwb2ludC1uZXh0KHNtLCAoeHM6IDAsIHNtOiA1NzZweCwgbWQ6IDc2OHB4LCBsZzogOTkycHgsIHhsOiAxMjAwcHgpKVxuLy8gICAgbWRcbi8vICAgID4+IGJyZWFrcG9pbnQtbmV4dChzbSwgJGJyZWFrcG9pbnQtbmFtZXM6ICh4cyBzbSBtZCBsZyB4bCkpXG4vLyAgICBtZFxuQGZ1bmN0aW9uIGJyZWFrcG9pbnQtbmV4dCgkbmFtZSwgJGJyZWFrcG9pbnRzOiAkc2NyZWVuLWJyZWFrcG9pbnRzLCAkYnJlYWtwb2ludC1uYW1lczogbWFwLWtleXMoJGJyZWFrcG9pbnRzKSkge1xuICAkbjogaW5kZXgoJGJyZWFrcG9pbnQtbmFtZXMsICRuYW1lKTtcbiAgQHJldHVybiBpZigkbiA8IGxlbmd0aCgkYnJlYWtwb2ludC1uYW1lcyksIG50aCgkYnJlYWtwb2ludC1uYW1lcywgJG4gKyAxKSwgbnVsbCk7XG59XG5cbi8vIE1heGltdW0gYnJlYWtwb2ludCB3aWR0aC4gTnVsbCBmb3IgdGhlIHNtYWxsZXN0IChmaXJzdCkgYnJlYWtwb2ludC5cbi8vIFRoZSBtYXhpbXVtIHZhbHVlIGlzIHJlZHVjZWQgYnkgMC4wMnB4IHRvIHdvcmsgYXJvdW5kIHRoZSBsaW1pdGF0aW9ucyBvZlxuLy8gYG1pbi1gIGFuZCBgbWF4LWAgcHJlZml4ZXMgYW5kIHZpZXdwb3J0cyB3aXRoIGZyYWN0aW9uYWwgd2lkdGhzLlxuLy9cbi8vIFNlZSBodHRwczovL3d3dy53My5vcmcvVFIvbWVkaWFxdWVyaWVzLTQvI21xLW1pbi1tYXhcbi8vIFVzZXMgMC4wMnB4IHJhdGhlciB0aGFuIDAuMDFweCB0byB3b3JrIGFyb3VuZCBhIGN1cnJlbnQgcm91bmRpbmcgYnVnIGluIFNhZmFyaS5cdC8vIFVzZXMgMC4wMnB4IHJhdGhlciB0aGFuIDAuMDFweCB0byB3b3JrIGFyb3VuZCBhIGN1cnJlbnQgcm91bmRpbmcgYnVnIGluIFNhZmFyaS5cbi8vIFNlZSBodHRwczovL2J1Z3Mud2Via2l0Lm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MTc4MjYxXHQvLyBTZWUgaHR0cHM6Ly9idWdzLndlYmtpdC5vcmcvc2hvd19idWcuY2dpP2lkPTE3ODI2MVxuLy9cbi8vICAgID4+IGJyZWFrcG9pbnQtbWF4KG1kLCAoeHM6IDAsIHNtOiA1NzZweCwgbWQ6IDc2OHB4LCBsZzogOTkycHgsIHhsOiAxMjAwcHgpKVxuLy8gICAgNzY3Ljk4cHhcbkBmdW5jdGlvbiBicmVha3BvaW50LW1heCgkbmFtZSwgJGJyZWFrcG9pbnRzOiAkc2NyZWVuLWJyZWFrcG9pbnRzKSB7XG4gICRtYXg6IG1hcC1nZXQoJGJyZWFrcG9pbnRzLCAkbmFtZSk7XG4gIEByZXR1cm4gaWYoJG1heCBhbmQgJG1heCA+IDAsICRtYXggLSAuMDIsIG51bGwpO1xufVxuXG4vLyBNZWRpYSBvZiBhdCBtb3N0IHRoZSBtYXhpbXVtIGJyZWFrcG9pbnQgd2lkdGguIE5vIHF1ZXJ5IGZvciB0aGUgbGFyZ2VzdCBicmVha3BvaW50LlxuLy8gTWFrZXMgdGhlIEBjb250ZW50IGFwcGx5IHRvIHRoZSBnaXZlbiBicmVha3BvaW50IGFuZCBuYXJyb3dlci5cbkBtaXhpbiBtZWRpYS1icmVha3BvaW50LWRvd24oJG5hbWUsICRicmVha3BvaW50czogJHNjcmVlbi1icmVha3BvaW50cykge1xuICAkbWF4OiBicmVha3BvaW50LW1heCgkbmFtZSwgJGJyZWFrcG9pbnRzKTtcbiAgQGlmICRtYXgge1xuICAgIEBtZWRpYSAobWF4LXdpZHRoOiAkbWF4KSB7XG4gICAgICBAY29udGVudDtcbiAgICB9XG4gIH0gQGVsc2Uge1xuICAgIEBjb250ZW50O1xuICB9XG59XG5cblxuLy8gVGV4dCBEaXJlY3Rpb24gLSBsdHIgLyBydGxcbi8vXG4vLyBDU1MgZGVmYXVsdHMgdG8gdXNlIHRoZSBsdHIgY3NzLCBhbmQgYWRkcyBbZGlyPXJ0bF0gc2VsZWN0b3JzXG4vLyB0byBvdmVycmlkZSBsdHIgZGVmYXVsdHMuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbkBtaXhpbiBtdWx0aS1kaXIoKSB7XG4gIEBjb250ZW50O1xuXG4gIC8vICRyb290OiAjeyZ9O1xuICAvLyBAYXQtcm9vdCBbZGlyXSB7XG4gIC8vICAgI3skcm9vdH0ge1xuICAvLyAgICAgQGNvbnRlbnQ7XG4gIC8vICAgfVxuICAvLyB9XG59XG5cbkBtaXhpbiBydGwoKSB7XG4gICRyb290OiAjeyZ9O1xuXG4gICRyb290U3BsaXQ6IHN0ci1zcGxpdCgkcm9vdCwgXCIsXCIpO1xuICAkc2VsZWN0b3JzOiAje2FkZC1yb290LXNlbGVjdG9yKCRyb290LCBcIltkaXI9cnRsXVwiKX07XG4gICRzZWxlY3RvcnNTcGxpdDogc3RyLXNwbGl0KCRzZWxlY3RvcnMsIFwiLFwiKTtcblxuICAkaG9zdENvbnRleHRTZWxlY3RvcnM6ICgpO1xuICAkcmVzdFNlbGVjdG9yczogKCk7XG4gICRkaXJTZWxlY3RvcnM6ICgpO1xuXG4gIC8vIFNlbGVjdG9ycyBtdXN0IGJlIHNwbGl0IGludG8gaW5kaXZpZHVhbCBzZWxlY3RvcnMgaW4gY2FzZSB0aGUgYnJvd3NlclxuICAvLyBkb2Vzbid0IHN1cHBvcnQgYSBzcGVjaWZpYyBzZWxlY3Rvci5cbiAgLy8gRm9yIGV4YW1wbGUsIEZpcmVmb3ggYW5kIFNhZmFyaSBkb2Vzbid0IHN1cHBvcnQgYDpob3N0LWNvbnRleHQoKWAuXG4gIC8vIElmIGFuIGludmFsaWQgc2VsZWN0b3IgaXMgdXNlZCwgdGhlbiB0aGUgZW50aXJlIGdyb3VwIG9mIHNlbGVjdG9yc1xuICAvLyB3aWxsIGJlIGlnbm9yZWQuXG4gIC8vIEBsaW5rIGh0dHBzOi8vd3d3LnczLm9yZy9UUi9zZWxlY3RvcnMtMy8jZ3JvdXBpbmdcbiAgQGVhY2ggJHNlbGVjdG9yIGluICRzZWxlY3RvcnNTcGxpdCB7XG4gICAgLy8gR3JvdXAgdGhlIHNlbGVjdG9ycyBiYWNrIGludG8gYSBzaW5nbGUgc2VsZWN0b3IgdG8gb3B0aW1pemUgdGhlIG91dHB1dC5cbiAgICBAaWYgc3RyLWluZGV4KCRzZWxlY3RvciwgXCI6aG9zdC1jb250ZXh0XCIpIHtcbiAgICAgICRob3N0Q29udGV4dFNlbGVjdG9yczogYXBwZW5kKCRob3N0Q29udGV4dFNlbGVjdG9ycywgJHNlbGVjdG9yLCBjb21tYSk7XG4gICAgfSBAZWxzZSB7XG4gICAgICAvLyBHcm91cCB0aGUgc2VsZWN0b3JzIGJhY2sgaW50byBhIHNpbmdsZSBzZWxlY3RvciB0byBvcHRpbWl6ZSB0aGUgb3V0cHV0LlxuICAgICAgJHJlc3RTZWxlY3RvcnM6IGFwcGVuZCgkcmVzdFNlbGVjdG9ycywgJHNlbGVjdG9yLCBjb21tYSk7XG4gICAgfVxuICB9XG5cbiAgLy8gU3VwcG9ydGVkIGJ5IENocm9tZS5cbiAgQGlmIGxlbmd0aCgkaG9zdENvbnRleHRTZWxlY3RvcnMpID4gMCB7XG4gICAgQGF0LXJvb3QgI3skaG9zdENvbnRleHRTZWxlY3RvcnN9IHtcbiAgICAgIEBjb250ZW50O1xuICAgIH1cbiAgfVxuXG4gIC8vIFN1cHBvcnRlZCBieSBhbGwgYnJvd3NlcnMuXG4gIEBpZiBsZW5ndGgoJHJlc3RTZWxlY3RvcnMpID4gMCB7XG4gICAgQGF0LXJvb3QgI3skcmVzdFNlbGVjdG9yc30ge1xuICAgICAgQGNvbnRlbnQ7XG4gICAgfVxuICB9XG5cbiAgLy8gSWYgYnJvd3NlciBjYW4gc3VwcG9ydCBgOmRpcigpYCwgdGhlbiBhZGQgdGhlIGA6ZGlyKClgIHNlbGVjdG9ycy5cbiAgLy8gQHN1cHBvcnRzIHNlbGVjdG9yKDpkaXIocnRsKSkgeyAvLyBAIElNUE9UQU5UIE5PVEU6IFRoaXMgaGFzIGJlZW4gcmVtb3ZlZCBiZWNhdXNlIHNlbGVjdG9yIGZ1bmN0aW9uIGlzIG5vdCBzdXBwb3J0ZWQgaW4gY3VycmVudCBTQ1NTXG4gIC8vIEFkZGluZyA6ZGlyKCkgaW4gY2FzZSB0aGUgYnJvd3NlciBkb2Vzbid0IHN1cHBvcnQgYDpob3N0LWNvbnRleHQoKWAgYW5kIGRvZXMgc3VwcG9ydCBgOmRpcigpYC5cbiAgLy8gYDpob3N0LWNvbnRleHQoKWAgaXMgYWRkZWQ6XG4gIC8vIC0gdGhyb3VnaCB0aGUgYGFkZC1yb290LXNlbGVjdG9yKClgIGZ1bmN0aW9uLlxuICAvLyAtIGZpcnN0IHNvIHRoYXQgaXQgdGFrZXMgcHJlY2VkZW5jZSBvdmVyIGA6ZGlyKClgLlxuICAvLyBGb3IgZXhhbXBsZSxcbiAgLy8gLSBGaXJlZm94IGRvZXNuJ3Qgc3VwcG9ydCBgOmhvc3QtY29udGV4dCgpYCwgYnV0IGRvZXMgc3VwcG9ydCBgOmRpcigpYC5cbiAgLy8gLSBTYWZhcmkgZG9lc24ndCBzdXBwb3J0IGA6aG9zdC1jb250ZXh0KClgLCBidXQgU2FmYXJpIDE2LjQrIHN1cHBvcnRzIGA6ZGlyKClgXG4gIC8vIEBsaW5rIGh0dHBzOi8vd2Via2l0Lm9yZy9ibG9nLzEzOTY2L3dlYmtpdC1mZWF0dXJlcy1pbi1zYWZhcmktMTYtNC9cbiAgQGVhY2ggJHNlbGVjdG9yIGluICRyb290U3BsaXQge1xuICAgICRkaXJTZWxlY3RvcjogXCIjeyRzZWxlY3Rvcn06ZGlyKHJ0bClcIjtcbiAgICAvLyBHcm91cCB0aGUgc2VsZWN0b3JzIGJhY2sgaW50byBhIHNpbmdsZSBzZWxlY3RvciB0byBvcHRpbWl6ZSB0aGUgb3V0cHV0LlxuICAgICRkaXJTZWxlY3RvcnM6IGFwcGVuZCgkZGlyU2VsZWN0b3JzLCAkZGlyU2VsZWN0b3IsIGNvbW1hKTtcbiAgfVxuXG4gIC8vIFN1cHBvcnRlZCBieSBGaXJlZm94LlxuICBAaWYgbGVuZ3RoKCRkaXJTZWxlY3RvcnMpID4gMCB7XG4gICAgQGF0LXJvb3QgI3skZGlyU2VsZWN0b3JzfSB7XG4gICAgICBAY29udGVudDtcbiAgICB9XG4gIH1cbiAgLy99XG59XG5cbkBtaXhpbiBsdHIoKSB7XG4gIEBjb250ZW50O1xufVxuXG5cbi8vIFNWRyBCYWNrZ3JvdW5kIEltYWdlIE1peGluXG4vLyBAcGFyYW0ge3N0cmluZ30gJHN2Z1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQG1peGluIHN2Zy1iYWNrZ3JvdW5kLWltYWdlKCRzdmcsICRmbGlwLXJ0bDogZmFsc2UpIHtcbiAgJHVybDogdXJsLWVuY29kZSgkc3ZnKTtcbiAgJHZpZXdCb3g6IHN0ci1zcGxpdChzdHItZXh0cmFjdCgkc3ZnLCBcInZpZXdCb3g9J1wiLCBcIidcIiksIFwiIFwiKTtcblxuICBAaWYgJGZsaXAtcnRsICE9IHRydWUgb3IgJHZpZXdCb3ggPT0gbnVsbCB7XG4gICAgQGluY2x1ZGUgbXVsdGktZGlyKCkge1xuICAgICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKFwiZGF0YTppbWFnZS9zdmcreG1sO2NoYXJzZXQ9dXRmLTgsI3skdXJsfVwiKTtcbiAgICB9XG4gIH0gQGVsc2Uge1xuICAgICR0cmFuc2Zvcm06IFwidHJhbnNmb3JtPSd0cmFuc2xhdGUoI3tudGgoJHZpZXdCb3gsIDMpfSwgMCkgc2NhbGUoLTEsIDEpJ1wiO1xuICAgICRmbGlwcGVkLXVybDogJHN2ZztcbiAgICAkZmxpcHBlZC11cmw6IHN0ci1yZXBsYWNlKCRmbGlwcGVkLXVybCwgXCI8cGF0aFwiLCBcIjxwYXRoICN7JHRyYW5zZm9ybX1cIik7XG4gICAgJGZsaXBwZWQtdXJsOiBzdHItcmVwbGFjZSgkZmxpcHBlZC11cmwsIFwiPGxpbmVcIiwgXCI8bGluZSAjeyR0cmFuc2Zvcm19XCIpO1xuICAgICRmbGlwcGVkLXVybDogc3RyLXJlcGxhY2UoJGZsaXBwZWQtdXJsLCBcIjxwb2x5Z29uXCIsIFwiPHBvbHlnb24gI3skdHJhbnNmb3JtfVwiKTtcbiAgICAkZmxpcHBlZC11cmw6IHVybC1lbmNvZGUoJGZsaXBwZWQtdXJsKTtcblxuICAgIEBpbmNsdWRlIGx0ciAoKSB7XG4gICAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoXCJkYXRhOmltYWdlL3N2Zyt4bWw7Y2hhcnNldD11dGYtOCwjeyR1cmx9XCIpO1xuICAgIH1cbiAgICBAaW5jbHVkZSBydGwoKSB7XG4gICAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoXCJkYXRhOmltYWdlL3N2Zyt4bWw7Y2hhcnNldD11dGYtOCwjeyRmbGlwcGVkLXVybH1cIik7XG4gICAgfVxuICB9XG59XG5cbi8vIEFkZCBwcm9wZXJ0eSBob3Jpem9udGFsXG4vLyBAcGFyYW0ge3N0cmluZ30gJHN0YXJ0XG4vLyBAcGFyYW0ge3N0cmluZ30gJGVuZFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQG1peGluIHByb3BlcnR5LWhvcml6b250YWwoJHByb3AsICRzdGFydCwgJGVuZDogJHN0YXJ0KSB7XG4gIEBpZiAkc3RhcnQgPT0gMCBhbmQgJGVuZCA9PSAwIHtcbiAgICAjeyRwcm9wfS1sZWZ0OiAkc3RhcnQ7XG4gICAgI3skcHJvcH0tcmlnaHQ6ICRlbmQ7XG5cbiAgfSBAZWxzZSB7XG4gICAgLXdlYmtpdC0jeyRwcm9wfS1zdGFydDogJHN0YXJ0O1xuICAgICN7JHByb3B9LWlubGluZS1zdGFydDogJHN0YXJ0O1xuICAgIC13ZWJraXQtI3skcHJvcH0tZW5kOiAkZW5kO1xuICAgICN7JHByb3B9LWlubGluZS1lbmQ6ICRlbmQ7XG4gIH1cbn1cblxuLy8gQWRkIHByb3BlcnR5IGZvciBhbGwgZGlyZWN0aW9uc1xuLy8gQHBhcmFtIHtzdHJpbmd9ICRwcm9wXG4vLyBAcGFyYW0ge3N0cmluZ30gJHRvcFxuLy8gQHBhcmFtIHtzdHJpbmd9ICRlbmRcbi8vIEBwYXJhbSB7c3RyaW5nfSAkYm90dG9tXG4vLyBAcGFyYW0ge3N0cmluZ30gJHN0YXJ0XG4vLyBAcGFyYW0ge2Jvb2xlYW59ICRjb250ZW50IGluY2x1ZGUgY29udGVudCBvciB1c2UgZGVmYXVsdFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQG1peGluIHByb3BlcnR5KCRwcm9wLCAkdG9wLCAkZW5kOiAkdG9wLCAkYm90dG9tOiAkdG9wLCAkc3RhcnQ6ICRlbmQpIHtcbiAgQGluY2x1ZGUgcHJvcGVydHktaG9yaXpvbnRhbCgkcHJvcCwgJHN0YXJ0LCAkZW5kKTtcbiAgI3skcHJvcH0tdG9wOiAkdG9wO1xuICAjeyRwcm9wfS1ib3R0b206ICRib3R0b207XG59XG5cbi8vIEFkZCBwYWRkaW5nIGhvcml6b250YWxcbi8vIEBwYXJhbSB7c3RyaW5nfSAkc3RhcnRcbi8vIEBwYXJhbSB7c3RyaW5nfSAkZW5kXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5AbWl4aW4gcGFkZGluZy1ob3Jpem9udGFsKCRzdGFydCwgJGVuZDogJHN0YXJ0KSB7XG4gIEBpbmNsdWRlIHByb3BlcnR5LWhvcml6b250YWwocGFkZGluZywgJHN0YXJ0LCAkZW5kKTtcbn1cblxuLy8gQWRkIHBhZGRpbmcgZm9yIGFsbCBkaXJlY3Rpb25zXG4vLyBAcGFyYW0ge3N0cmluZ30gJHRvcFxuLy8gQHBhcmFtIHtzdHJpbmd9ICRlbmRcbi8vIEBwYXJhbSB7c3RyaW5nfSAkYm90dG9tXG4vLyBAcGFyYW0ge3N0cmluZ30gJHN0YXJ0XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5AbWl4aW4gcGFkZGluZygkdG9wLCAkZW5kOiAkdG9wLCAkYm90dG9tOiAkdG9wLCAkc3RhcnQ6ICRlbmQpIHtcbiAgQGluY2x1ZGUgcHJvcGVydHkocGFkZGluZywgJHRvcCwgJGVuZCwgJGJvdHRvbSwgJHN0YXJ0KTtcbn1cblxuLy8gQWRkIG1hcmdpbiBob3Jpem9udGFsXG4vLyBAcGFyYW0ge3N0cmluZ30gJHN0YXJ0XG4vLyBAcGFyYW0ge3N0cmluZ30gJGVuZFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQG1peGluIG1hcmdpbi1ob3Jpem9udGFsKCRzdGFydCwgJGVuZDogJHN0YXJ0KSB7XG4gIEBpbmNsdWRlIHByb3BlcnR5LWhvcml6b250YWwobWFyZ2luLCAkc3RhcnQsICRlbmQpO1xufVxuXG4vLyBBZGQgbWFyZ2luIGZvciBhbGwgZGlyZWN0aW9uc1xuLy8gQHBhcmFtIHtzdHJpbmd9ICR0b3Bcbi8vIEBwYXJhbSB7c3RyaW5nfSAkZW5kXG4vLyBAcGFyYW0ge3N0cmluZ30gJGJvdHRvbVxuLy8gQHBhcmFtIHtzdHJpbmd9ICRzdGFydFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQG1peGluIG1hcmdpbigkdG9wLCAkZW5kOiAkdG9wLCAkYm90dG9tOiAkdG9wLCAkc3RhcnQ6ICRlbmQpIHtcbiAgQGluY2x1ZGUgcHJvcGVydHkobWFyZ2luLCAkdG9wLCAkZW5kLCAkYm90dG9tLCAkc3RhcnQpO1xufVxuXG4vLyBBZGQgcG9zaXRpb24gaG9yaXpvbnRhbFxuLy8gQHBhcmFtIHtzdHJpbmd9ICRzdGFydCAtIGFtb3VudCB0byBwb3NpdGlvbiBzdGFydFxuLy8gQHBhcmFtIHtzdHJpbmd9ICRlbmQgLSBhbW91bnQgdG8gbGVmdDogMDsgZW5kXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5AbWl4aW4gcG9zaXRpb24taG9yaXpvbnRhbCgkc3RhcnQ6IG51bGwsICRlbmQ6IG51bGwpIHtcbiAgQGlmICRzdGFydCA9PSAkZW5kIHtcbiAgICBAaW5jbHVkZSBtdWx0aS1kaXIoKSB7XG4gICAgICBsZWZ0OiAkc3RhcnQ7XG4gICAgICByaWdodDogJGVuZDtcbiAgICB9XG4gIH0gQGVsc2Uge1xuICAgIEBhdC1yb290IHtcbiAgICAgIEBzdXBwb3J0cyAoaW5zZXQtaW5saW5lLXN0YXJ0OiAwKSB7XG4gICAgICAgICYge1xuICAgICAgICAgIGluc2V0LWlubGluZS1zdGFydDogJHN0YXJ0O1xuICAgICAgICAgIGluc2V0LWlubGluZS1lbmQ6ICRlbmQ7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBUT0RPIEZXLTM3NjZcbiAgICBAYXQtcm9vdCB7XG4gICAgICBAc3VwcG9ydHMgbm90IChpbnNldC1pbmxpbmUtc3RhcnQ6IDApIHtcbiAgICAgICAgJiB7XG4gICAgICAgICAgQGluY2x1ZGUgbHRyKCkge1xuICAgICAgICAgICAgbGVmdDogJHN0YXJ0O1xuICAgICAgICAgICAgcmlnaHQ6ICRlbmQ7XG4gICAgICAgICAgfVxuICAgICAgICAgIEBpbmNsdWRlIHJ0bCgpIHtcbiAgICAgICAgICAgIGxlZnQ6IHVuc2V0O1xuICAgICAgICAgICAgcmlnaHQ6IHVuc2V0O1xuXG4gICAgICAgICAgICBsZWZ0OiAkZW5kO1xuICAgICAgICAgICAgcmlnaHQ6ICRzdGFydDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cblxuLy8gQWRkIHBvc2l0aW9uIGZvciBhbGwgZGlyZWN0aW9uc1xuLy8gQHBhcmFtIHtzdHJpbmd9ICR0b3Bcbi8vIEBwYXJhbSB7c3RyaW5nfSAkZW5kXG4vLyBAcGFyYW0ge3N0cmluZ30gJGJvdHRvbVxuLy8gQHBhcmFtIHtzdHJpbmd9ICRzdGFydFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQG1peGluIHBvc2l0aW9uKCR0b3A6IG51bGwsICRlbmQ6IG51bGwsICRib3R0b206IG51bGwsICRzdGFydDogbnVsbCkge1xuICBAaW5jbHVkZSBwb3NpdGlvbi1ob3Jpem9udGFsKCRzdGFydCwgJGVuZCk7XG4gIHRvcDogJHRvcDtcbiAgYm90dG9tOiAkYm90dG9tO1xufVxuXG4vLyBBZGQgYm9yZGVyIGZvciBhbGwgZGlyZWN0aW9uc1xuLy8gQHBhcmFtIHtzdHJpbmd9ICR0b3Bcbi8vIEBwYXJhbSB7c3RyaW5nfSAkZW5kXG4vLyBAcGFyYW0ge3N0cmluZ30gJGJvdHRvbVxuLy8gQHBhcmFtIHtzdHJpbmd9ICRzdGFydFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQG1peGluIGJvcmRlcigkdG9wLCAkZW5kOiAkdG9wLCAkYm90dG9tOiAkdG9wLCAkc3RhcnQ6ICRlbmQpIHtcbiAgQGluY2x1ZGUgcHJvcGVydHkoYm9yZGVyLCAkdG9wLCAkZW5kLCAkYm90dG9tLCAkc3RhcnQpO1xufVxuXG4vLyBBZGQgYm9yZGVyIHJhZGl1cyBmb3IgYWxsIGRpcmVjdGlvbnNcbi8vIEBwYXJhbSB7c3RyaW5nfSAkdG9wLXN0YXJ0XG4vLyBAcGFyYW0ge3N0cmluZ30gJHRvcC1lbmRcbi8vIEBwYXJhbSB7c3RyaW5nfSAkYm90dG9tLWVuZFxuLy8gQHBhcmFtIHtzdHJpbmd9ICRib3R0b20tc3RhcnRcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbkBtaXhpbiBib3JkZXItcmFkaXVzKCR0b3Atc3RhcnQsICR0b3AtZW5kOiAkdG9wLXN0YXJ0LCAkYm90dG9tLWVuZDogJHRvcC1zdGFydCwgJGJvdHRvbS1zdGFydDogJHRvcC1lbmQpIHtcbiAgQGlmICR0b3Atc3RhcnQgPT0gJHRvcC1lbmQgYW5kICR0b3Atc3RhcnQgPT0gJGJvdHRvbS1lbmQgYW5kICR0b3Atc3RhcnQgPT0gJGJvdHRvbS1zdGFydCB7XG4gICAgQGluY2x1ZGUgbXVsdGktZGlyKCkge1xuICAgICAgYm9yZGVyLXJhZGl1czogJHRvcC1zdGFydDtcbiAgICB9XG4gIH0gQGVsc2Uge1xuICAgIEBpbmNsdWRlIGx0cigpIHtcbiAgICAgIGJvcmRlci10b3AtbGVmdC1yYWRpdXM6ICR0b3Atc3RhcnQ7XG4gICAgICBib3JkZXItdG9wLXJpZ2h0LXJhZGl1czogJHRvcC1lbmQ7XG4gICAgICBib3JkZXItYm90dG9tLXJpZ2h0LXJhZGl1czogJGJvdHRvbS1lbmQ7XG4gICAgICBib3JkZXItYm90dG9tLWxlZnQtcmFkaXVzOiAkYm90dG9tLXN0YXJ0O1xuICAgIH1cblxuICAgIEBpbmNsdWRlIHJ0bCgpIHtcbiAgICAgIGJvcmRlci10b3AtbGVmdC1yYWRpdXM6ICR0b3AtZW5kO1xuICAgICAgYm9yZGVyLXRvcC1yaWdodC1yYWRpdXM6ICR0b3Atc3RhcnQ7XG4gICAgICBib3JkZXItYm90dG9tLXJpZ2h0LXJhZGl1czogJGJvdHRvbS1zdGFydDtcbiAgICAgIGJvcmRlci1ib3R0b20tbGVmdC1yYWRpdXM6ICRib3R0b20tZW5kO1xuICAgIH1cbiAgfVxufVxuXG4vLyBBZGQgZGlyZWN0aW9uIGZvciBhbGwgZGlyZWN0aW9uc1xuLy8gQHBhcmFtIHtzdHJpbmd9ICRkaXIgLSBEaXJlY3Rpb24gb24gTFRSXG5AbWl4aW4gZGlyZWN0aW9uKCRkaXIpIHtcbiAgJG90aGVyLWRpcjogbnVsbDtcblxuICBAaWYgJGRpciA9PSBsdHIge1xuICAgICRvdGhlci1kaXI6IHJ0bDtcbiAgfSBAZWxzZSB7XG4gICAgJG90aGVyLWRpcjogbHRyO1xuICB9XG5cbiAgQGluY2x1ZGUgbHRyKCkge1xuICAgIGRpcmVjdGlvbjogJGRpcjtcbiAgfVxuICBAaW5jbHVkZSBydGwoKSB7XG4gICAgZGlyZWN0aW9uOiAkb3RoZXItZGlyO1xuICB9XG59XG5cbi8vIEFkZCBmbG9hdCBmb3IgYWxsIGRpcmVjdGlvbnNcbi8vIEBwYXJhbSB7c3RyaW5nfSAkc2lkZVxuLy8gQHBhcmFtIHtzdHJpbmd9ICRkZWNvcmF0b3IgLSAhaW1wb3J0YW50XG5AbWl4aW4gZmxvYXQoJHNpZGUsICRkZWNvcmF0b3I6IG51bGwpIHtcbiAgQGlmICRzaWRlID09IHN0YXJ0IHtcbiAgICBAaW5jbHVkZSBsdHIoKSB7XG4gICAgICBmbG9hdDogbGVmdCAkZGVjb3JhdG9yO1xuICAgIH1cbiAgICBAaW5jbHVkZSBydGwoKSB7XG4gICAgICBmbG9hdDogcmlnaHQgJGRlY29yYXRvcjtcbiAgICB9XG4gIH0gQGVsc2UgaWYgJHNpZGUgPT0gZW5kIHtcbiAgICBAaW5jbHVkZSBsdHIoKSB7XG4gICAgICBmbG9hdDogcmlnaHQgJGRlY29yYXRvcjtcbiAgICB9XG4gICAgQGluY2x1ZGUgcnRsKCkge1xuICAgICAgZmxvYXQ6IGxlZnQgJGRlY29yYXRvcjtcbiAgICB9XG4gIH0gQGVsc2Uge1xuICAgIEBpbmNsdWRlIG11bHRpLWRpcigpIHtcbiAgICAgIGZsb2F0OiAkc2lkZSAkZGVjb3JhdG9yO1xuICAgIH1cbiAgfVxufVxuXG5AbWl4aW4gYmFja2dyb3VuZC1wb3NpdGlvbigkaG9yaXpvbnRhbCwgJGhvcml6b250YWwtYW1vdW50OiBudWxsLCAkdmVydGljYWw6IG51bGwsICR2ZXJ0aWNhbC1hbW91bnQ6IG51bGwpIHtcbiAgQGlmICRob3Jpem9udGFsID09IHN0YXJ0IG9yICRob3Jpem9udGFsID09IGVuZCB7XG4gICAgJGhvcml6b250YWwtbHRyOiBudWxsO1xuICAgICRob3Jpem9udGFsLXJ0bDogbnVsbDtcbiAgICBAaWYgJGhvcml6b250YWwgPT0gc3RhcnQge1xuICAgICAgJGhvcml6b250YWwtbHRyOiBsZWZ0O1xuICAgICAgJGhvcml6b250YWwtcnRsOiByaWdodDtcbiAgICB9IEBlbHNlIHtcbiAgICAgICRob3Jpem9udGFsLWx0cjogcmlnaHQ7XG4gICAgICAkaG9yaXpvbnRhbC1ydGw6IGxlZnQ7XG4gICAgfVxuXG4gICAgQGluY2x1ZGUgbHRyKCkge1xuICAgICAgYmFja2dyb3VuZC1wb3NpdGlvbjogJGhvcml6b250YWwtbHRyICRob3Jpem9udGFsLWFtb3VudCAkdmVydGljYWwgJHZlcnRpY2FsLWFtb3VudDtcbiAgICB9XG4gICAgQGluY2x1ZGUgcnRsKCkge1xuICAgICAgYmFja2dyb3VuZC1wb3NpdGlvbjogJGhvcml6b250YWwtcnRsICRob3Jpem9udGFsLWFtb3VudCAkdmVydGljYWwgJHZlcnRpY2FsLWFtb3VudDtcbiAgICB9XG4gIH0gQGVsc2Uge1xuICAgIEBpbmNsdWRlIG11bHRpLWRpcigpIHtcbiAgICAgIGJhY2tncm91bmQtcG9zaXRpb246ICRob3Jpem9udGFsICRob3Jpem9udGFsLWFtb3VudCAkdmVydGljYWwgJHZlcnRpY2FsLWFtb3VudDtcbiAgICB9XG4gIH1cbn1cblxuQG1peGluIHRyYW5zZm9ybS1vcmlnaW4oJHgtYXhpcywgJHktYXhpczogbnVsbCkge1xuICBAaWYgJHgtYXhpcyA9PSBzdGFydCB7XG4gICAgQGluY2x1ZGUgbHRyKCkge1xuICAgICAgdHJhbnNmb3JtLW9yaWdpbjogbGVmdCAkeS1heGlzO1xuICAgIH1cbiAgICBAaW5jbHVkZSBydGwoKSB7XG4gICAgICB0cmFuc2Zvcm0tb3JpZ2luOiByaWdodCAkeS1heGlzO1xuICAgIH1cbiAgfSBAZWxzZSBpZiAkeC1heGlzID09IGVuZCB7XG4gICAgQGluY2x1ZGUgbHRyKCkge1xuICAgICAgdHJhbnNmb3JtLW9yaWdpbjogcmlnaHQgJHktYXhpcztcbiAgICB9XG4gICAgQGluY2x1ZGUgcnRsKCkge1xuICAgICAgdHJhbnNmb3JtLW9yaWdpbjogbGVmdCAkeS1heGlzO1xuICAgIH1cbiAgfSBAZWxzZSBpZiAkeC1heGlzID09IGxlZnQgb3IgJHgtYXhpcyA9PSByaWdodCB7XG4gICAgQGluY2x1ZGUgbXVsdGktZGlyKCkge1xuICAgICAgdHJhbnNmb3JtLW9yaWdpbjogJHgtYXhpcyAkeS1heGlzO1xuICAgIH1cbiAgfSBAZWxzZSB7XG4gICAgQGluY2x1ZGUgbHRyKCkge1xuICAgICAgdHJhbnNmb3JtLW9yaWdpbjogJHgtYXhpcyAkeS1heGlzO1xuICAgIH1cbiAgICBAaW5jbHVkZSBydGwoKSB7XG4gICAgICB0cmFuc2Zvcm0tb3JpZ2luOiBjYWxjKDEwMCUgLSAjeyR4LWF4aXN9KSAkeS1heGlzO1xuICAgIH1cbiAgfVxufVxuXG4vLyBBZGQgdHJhbnNmb3JtIGZvciBhbGwgZGlyZWN0aW9uc1xuLy8gQHBhcmFtIHtzdHJpbmd9ICR0cmFuc2Zvcm1zIC0gY29tbWEgc2VwYXJhdGVkIGxpc3Qgb2YgdHJhbnNmb3Jtc1xuQG1peGluIHRyYW5zZm9ybSgkdHJhbnNmb3Jtcy4uLikge1xuICAkZXh0cmE6IG51bGw7XG5cbiAgJHg6IG51bGw7XG4gICRsdHItdHJhbnNsYXRlOiBudWxsO1xuICAkcnRsLXRyYW5zbGF0ZTogbnVsbDtcblxuICBAZWFjaCAkdHJhbnNmb3JtIGluICR0cmFuc2Zvcm1zIHtcbiAgICBAaWYgKHN0ci1pbmRleCgkdHJhbnNmb3JtLCB0cmFuc2xhdGUzZCkpIHtcbiAgICAgICR0cmFuc2Zvcm06IHN0ci1yZXBsYWNlKCR0cmFuc2Zvcm0sICd0cmFuc2xhdGUzZCgnKTtcbiAgICAgICR0cmFuc2Zvcm06IHN0ci1yZXBsYWNlKCR0cmFuc2Zvcm0sICcpJyk7XG5cbiAgICAgICRjb29yZGluYXRlczogc3RyLXNwbGl0KCR0cmFuc2Zvcm0sICcsJyk7XG5cbiAgICAgICR4OiBudGgoJGNvb3JkaW5hdGVzLCAxKTtcbiAgICAgICR5OiBudGgoJGNvb3JkaW5hdGVzLCAyKTtcbiAgICAgICR6OiBudGgoJGNvb3JkaW5hdGVzLCAzKTtcblxuICAgICAgJGx0ci10cmFuc2xhdGU6IHRyYW5zbGF0ZTNkKCR4LCAkeSwgJHopO1xuICAgICAgJHJ0bC10cmFuc2xhdGU6IHRyYW5zbGF0ZTNkKGNhbGMoLTEgKiAjeyR4fSksICR5LCAkeik7XG4gICAgfSBAZWxzZSB7XG4gICAgICBAaWYgJGV4dHJhID09IG51bGwge1xuICAgICAgICAkZXh0cmE6ICR0cmFuc2Zvcm07XG4gICAgICB9IEBlbHNlIHtcbiAgICAgICAgJGV4dHJhOiAkZXh0cmEgJHRyYW5zZm9ybTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBAaWYgJHggPT0gJzAnIG9yICR4ID09IG51bGwge1xuICAgIEBpbmNsdWRlIG11bHRpLWRpcigpIHtcbiAgICAgIHRyYW5zZm9ybTogJGx0ci10cmFuc2xhdGUgJGV4dHJhO1xuICAgIH1cbiAgfSBAZWxzZSB7XG4gICAgQGluY2x1ZGUgbHRyKCkge1xuICAgICAgdHJhbnNmb3JtOiAkbHRyLXRyYW5zbGF0ZSAkZXh0cmE7XG4gICAgfVxuXG4gICAgQGluY2x1ZGUgcnRsKCkge1xuICAgICAgdHJhbnNmb3JtOiAkcnRsLXRyYW5zbGF0ZSAkZXh0cmE7XG4gICAgfVxuICB9XG59XG4iLCIvKipcbiAqIEltcG9ydGVkIGlvbmljIG1peGlucyBmb3IgU0NTUyBmcm9tIGRpZmZlcmVudCBjb21wb25lbnRzXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiBFeHRyYWN0ZWQgZnJvbVxuICogaHR0cHM6Ly9naXRodWIuY29tL2lvbmljLXRlYW0vaW9uaWMtZnJhbWV3b3JrL2Jsb2IvbWFzdGVyL2NvcmUvc3JjL2NvbXBvbmVudHMvZ3JpZC9ncmlkLm1peGlucy5zY3NzXG4gKiBodHRwczovL2dpdGh1Yi5jb20vaW9uaWMtdGVhbS9pb25pYy1mcmFtZXdvcmsvYmxvYi9tYXN0ZXIvY29yZS9zcmMvY29tcG9uZW50cy9pdGVtL2l0ZW0ubWl4aW5zLnNjc3NcbiAqL1xuXG4vLyBSZXNwb25zaXZlIE1peGluc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuXG4vLyBDcmVhdGVzIGEgZml4ZWQgd2lkdGggZm9yIHRoZSBncmlkIGJhc2VkIG9uIHRoZSBzY3JlZW4gc2l6ZVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbkBtaXhpbiBtYWtlLWdyaWQtd2lkdGhzKCR3aWR0aHM6ICRncmlkLXdpZHRocywgJGJyZWFrcG9pbnRzOiAkc2NyZWVuLWJyZWFrcG9pbnRzKSB7XG4gIEBlYWNoICRicmVha3BvaW50LCAkd2lkdGggaW4gJHdpZHRocyB7XG4gICAgQGluY2x1ZGUgbWVkaWEtYnJlYWtwb2ludC11cCgkYnJlYWtwb2ludCwgJGJyZWFrcG9pbnRzKSB7XG4gICAgICB3aWR0aDogJHdpZHRoO1xuICAgIH1cbiAgfVxuXG4gIG1heC13aWR0aDogMTAwJTtcbn1cblxuXG4vLyBBZGRzIHBhZGRpbmcgdG8gdGhlIGVsZW1lbnQgYmFzZWQgb24gYnJlYWtwb2ludHNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5AbWl4aW4gbWFrZS1icmVha3BvaW50LXBhZGRpbmcoJHBhZGRpbmdzKSB7XG4gIEBlYWNoICRicmVha3BvaW50IGluIG1hcC1rZXlzKCRwYWRkaW5ncykge1xuICAgIEBpbmNsdWRlIG1lZGlhLWJyZWFrcG9pbnQtdXAoJGJyZWFrcG9pbnQpIHtcbiAgICAgICRwYWRkaW5nOiBtYXAtZ2V0KCRwYWRkaW5ncywgJGJyZWFrcG9pbnQpO1xuXG4gICAgICBAaW5jbHVkZSBwYWRkaW5nKCRwYWRkaW5nKTtcbiAgICB9XG4gIH1cbn1cblxuXG4vLyBJdGVtIE1peGluc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuQG1peGluIGl0ZW0tcHVzaC1zdmctdXJsKCRmaWxsKSB7XG4gICRpdGVtLWRldGFpbC1wdXNoLXN2ZzogXCI8c3ZnIHhtbG5zPSdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Zycgdmlld0JveD0nMCAwIDEyIDIwJz48cGF0aCBkPSdNMiwyMGwtMi0ybDgtOEwwLDJsMi0ybDEwLDEwTDIsMjB6JyBmaWxsPScjeyRmaWxsfScvPjwvc3ZnPlwiO1xuXG4gIEBpbmNsdWRlIHN2Zy1iYWNrZ3JvdW5kLWltYWdlKCRpdGVtLWRldGFpbC1wdXNoLXN2ZywgdHJ1ZSk7XG59XG4iLCJAdXNlIFwic2FzczptYXRoXCIgYXMgbWF0aDtcblxuLyoqXG4gKiBBcHAgY3VzdG9tIG1peGlucyBmb3IgU0NTU1xuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogUGxhY2UgaGVyZSBvdXIgY3VzdG9tIG1peGlucy5cbiAqL1xuXG4vLyBNaXhlcyBhIGNvbG9yIHdpdGggYmxhY2sgdG8gY3JlYXRlIGl0cyBzaGFkZS5cbi8vIERlZmF1bHQgdG8gYm9vdHN0cmFwIGxldmVsIDYuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQGZ1bmN0aW9uIGdldC1jb2xvci1zaGFkZS1wZXJjZW50KCRjb2xvciwgJHBlcmNlbnQ6IDQ4JSkge1xuICAgIEByZXR1cm4gbWl4KCMwMDAsICRjb2xvciwgJHBlcmNlbnQpO1xufVxuXG4vLyBNaXhlcyBhIGNvbG9yIHdpdGggd2hpdGUgdG8gY3JlYXRlIGl0cyB0aW50LlxuLy8gRGVmYXVsdCB0byBib290c3RyYXAgbGV2ZWwgLTEwLlxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbkBmdW5jdGlvbiBnZXQtY29sb3ItdGludC1wZXJjZW50KCRjb2xvciwgJHBlcmNlbnQ6IDgwJSkge1xuICAgIEByZXR1cm4gbWl4KCNmZmYsICRjb2xvciwgJHBlcmNlbnQpO1xufVxuXG4vLyBJb25pYyBDb2xvcnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBHZW5lcmF0ZXMgdGhlIGNvbG9yIGNsYXNzZXMgYW5kIHZhcmlhYmxlcyBiYXNlZCBvbiB0aGVcbi8vIGNvbG9ycyBtYXBcblxuQG1peGluIGdlbmVyYXRlLWNvbG9yKCRjb2xvci1uYW1lLCAkY29sb3JzLCAkdGhlbWUpIHtcbiAgICAkY29sb3ItdGhlbWVzOiBtYXAtZ2V0KCRjb2xvcnMsICRjb2xvci1uYW1lKTtcbiAgICAkYmFzZTogbWFwLWdldCgkY29sb3ItdGhlbWVzLCAkdGhlbWUpO1xuXG4gICAgQGlmICR0aGVtZSA9PSAnZGFyaycge1xuICAgICAgICAkYmFzZTogbWl4KG1hcC1nZXQoJGNvbG9yLXRoZW1lcywgJ2xpZ2h0JyksIHdoaXRlLCA4MCUpICFkZWZhdWx0O1xuICAgIH1cblxuICAgIEBpbmNsdWRlIGdlbmVyYXRlLWNvbG9yLXZhcmlhbnRzKCRjb2xvci1uYW1lLCAkYmFzZSk7XG59XG5cbkBtaXhpbiBnZW5lcmF0ZS1jb2xvci12YXJpYW50cygkY29sb3ItbmFtZSwgJGJhc2UpIHtcbiAgICAkY29udHJhc3Q6IGdldF9jb250cmFzdF9jb2xvcigkYmFzZSk7XG4gICAgJHNoYWRlOiBnZXQtY29sb3Itc2hhZGUtcGVyY2VudCgkYmFzZSk7XG4gICAgJHRpbnQ6IGdldC1jb2xvci10aW50LXBlcmNlbnQoJGJhc2UpO1xuXG4gICAgLS0jeyRjb2xvci1uYW1lfTogI3skYmFzZX07XG4gICAgLS0jeyRjb2xvci1uYW1lfS1zaGFkZTogI3skc2hhZGV9O1xuICAgIC0tI3skY29sb3ItbmFtZX0tdGludDogI3skdGludH07XG4gICAgLS0jeyRjb2xvci1uYW1lfS1jb250cmFzdDogI3skY29udHJhc3R9O1xuXG4gICAgLy8gSW50ZXJuYWwgaW9uaWMgdXNlIG9ubHkuXG4gICAgLS1pb24tY29sb3ItI3skY29sb3ItbmFtZX06IHZhcigtLSN7JGNvbG9yLW5hbWV9KTtcbiAgICAtLWlvbi1jb2xvci0jeyRjb2xvci1uYW1lfS1iYXNlOiB2YXIoLS1pb24tY29sb3ItI3skY29sb3ItbmFtZX0pO1xuICAgIC0taW9uLWNvbG9yLSN7JGNvbG9yLW5hbWV9LXJnYjogI3tjb2xvci10by1yZ2ItbGlzdCgkYmFzZSl9O1xuICAgIC0taW9uLWNvbG9yLSN7JGNvbG9yLW5hbWV9LWNvbnRyYXN0OiAjeyRjb250cmFzdH07XG4gICAgLS1pb24tY29sb3ItI3skY29sb3ItbmFtZX0tY29udHJhc3QtcmdiOiAje2NvbG9yLXRvLXJnYi1saXN0KCRjb250cmFzdCl9O1xuICAgIC0taW9uLWNvbG9yLSN7JGNvbG9yLW5hbWV9LXNoYWRlOiAjeyRzaGFkZX07XG4gICAgLS1pb24tY29sb3ItI3skY29sb3ItbmFtZX0tdGludDogI3skdGludH07XG5cbiAgICAuaW9uLWNvbG9yLSN7JGNvbG9yLW5hbWV9IHtcbiAgICAgICAgLS1pb24tY29sb3I6IHZhcigtLWlvbi1jb2xvci0jeyRjb2xvci1uYW1lfSk7XG4gICAgICAgIC0taW9uLWNvbG9yLWJhc2U6IHZhcigtLWlvbi1jb2xvci0jeyRjb2xvci1uYW1lfS1iYXNlKTtcbiAgICAgICAgLS1pb24tY29sb3ItcmdiOiB2YXIoLS1pb24tY29sb3ItI3skY29sb3ItbmFtZX0tcmdiKTtcbiAgICAgICAgLS1pb24tY29sb3ItY29udHJhc3Q6IHZhcigtLWlvbi1jb2xvci0jeyRjb2xvci1uYW1lfS1jb250cmFzdCk7XG4gICAgICAgIC0taW9uLWNvbG9yLWNvbnRyYXN0LXJnYjogdmFyKC0taW9uLWNvbG9yLSN7JGNvbG9yLW5hbWV9LWNvbnRyYXN0LXJnYik7XG4gICAgICAgIC0taW9uLWNvbG9yLXNoYWRlOiB2YXIoLS1pb24tY29sb3ItI3skY29sb3ItbmFtZX0tc2hhZGUpO1xuICAgICAgICAtLWlvbi1jb2xvci10aW50OiB2YXIoLS1pb24tY29sb3ItI3skY29sb3ItbmFtZX0tdGludCk7XG4gICAgfVxufVxuXG5AbWl4aW4gY29yZS1mb2N1cygpIHtcbiAgICBvdXRsaW5lOiBub25lO1xuICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgICAmOjphZnRlciB7XG4gICAgICAgIEBpbmNsdWRlIHBvc2l0aW9uKDAsIDAsIDAsIDApO1xuICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICAgIGNvbnRlbnQ6IFwiXCI7XG4gICAgICAgIG9wYWNpdHk6IDE7XG4gICAgICAgIHotaW5kZXg6IDE7XG4gICAgICAgIEBpbmNsdWRlIGNvcmUtZm9jdXMtc3R5bGUoKTtcbiAgICB9XG59XG5cbkBtaXhpbiBjb3JlLWZvY3VzLXN0eWxlKCkge1xuICAgIGJveC1zaGFkb3c6IGluc2V0IDAgMCB2YXIoLS1hMTF5LWZvY3VzLXdpZHRoKSAxcHggdmFyKC0tYTExeS1mb2N1cy1jb2xvcik7XG4gICAgYm9yZGVyLXJhZGl1czogdmFyKC0tYm9yZGVyLXJhZGl1cyk7XG4gICAgLy8gVGhpY2tlciBvcHRpb246XG4gICAgLy8gYm9yZGVyOiB2YXIoLS1hMTF5LWZvY3VzLXdpZHRoKSBzb2xpZCB2YXIoLS1hMTF5LWZvY3VzLWNvbG9yKTtcbn1cblxuQG1peGluIGNvcmUtdHJhbnNpdGlvbigkcHJvcGVydGllczogYWxsLCAkZHVyYXRpb246IDUwMG1zLCAkdGltaW5nLWZ1bmN0aW9uOiBlYXNlLWluLW91dCkge1xuICAgICR0cmFuc2l0aW9uczogKCk7XG4gICAgQGVhY2ggJHByb3BlcnR5IGluICRwcm9wZXJ0aWVzIHtcbiAgICAgICR0cmFuc2l0aW9uczogYXBwZW5kKCR0cmFuc2l0aW9ucywgJHByb3BlcnR5ICRkdXJhdGlvbiAkdGltaW5nLWZ1bmN0aW9uLCBjb21tYSk7XG4gICAgfVxuXG4gICAgLXdlYmtpdC10cmFuc2l0aW9uOiAkdHJhbnNpdGlvbnM7XG4gICAgdHJhbnNpdGlvbjogJHRyYW5zaXRpb25zO1xufVxuXG5AbWl4aW4gc3Itb25seSgpIHtcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgd2lkdGg6IDFweDtcbiAgICBoZWlnaHQ6IDFweDtcbiAgICBwYWRkaW5nOiAwO1xuICAgIG1hcmdpbjogLTFweDtcbiAgICBvdmVyZmxvdzogaGlkZGVuO1xuICAgIGNsaXA6IHJlY3QoMCwgMCwgMCwgMCk7XG4gICAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcbiAgICBib3JkZXI6IDA7XG59XG5cbi8qKlxuICogU2FtZSBhcyBpdGVtLXB1c2gtc3ZnLXVybCBidXQgYWRtaXRzIGZsaXAtcnRsXG4gKi9cbkBtaXhpbiBwdXNoLWFycm93LWNvbG9yKCRmaWxsOiA2MjYyNjIsICRmbGlwLXJ0bDogZmFsc2UpIHtcbiAgICAkaXRlbS1kZXRhaWwtcHVzaC1zdmc6IFwiPHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHZpZXdCb3g9JzAgMCAxMiAyMCc+PHBhdGggZD0nTTIsMjBsLTItMmw4LThMMCwybDItMmwxMCwxMEwyLDIweicgZmlsbD0nI3skZmlsbH0nLz48L3N2Zz5cIjtcblxuICAgIEBpbmNsdWRlIHN2Zy1iYWNrZ3JvdW5kLWltYWdlKCRpdGVtLWRldGFpbC1wdXNoLXN2ZywgJGZsaXAtcnRsKTtcbn1cblxuQG1peGluIGJvcmRlci1zdGFydCgkcHgsICR0eXBlOiBudWxsLCAkY29sb3I6IG51bGwpIHtcbiAgICBAaW5jbHVkZSBwcm9wZXJ0eS1ob3Jpem9udGFsKGJvcmRlciwgJHB4ICR0eXBlICRjb2xvciwgbnVsbCk7XG59XG5cbkBtaXhpbiBib3JkZXItZW5kKCRweCwgJHR5cGU6IG51bGwsICRjb2xvcjogbnVsbCkge1xuICAgIEBpbmNsdWRlIHByb3BlcnR5LWhvcml6b250YWwoYm9yZGVyLCBudWxsLCAkcHggJHR5cGUgJGNvbG9yKTtcbn1cblxuQG1peGluIHNhZmUtYXJlYS1ib3JkZXItc3RhcnQoJHB4LCAkdHlwZSwgJGNvbG9yKSB7XG4gICAgJHNhZmUtYXJlYS1wb3NpdGlvbjogY2FsYyh2YXIoLS1pb24tc2FmZS1hcmVhLWxlZnQpICsgI3skcHh9KTtcblxuICAgIEBpbmNsdWRlIGJvcmRlci1zdGFydCgkc2FmZS1hcmVhLXBvc2l0aW9uLCAkdHlwZSwgJGNvbG9yKTtcbn1cblxuQG1peGluIHNhZmUtYXJlYS1ib3JkZXItZW5kKCRweCwgJHR5cGUsICRjb2xvcikge1xuICAgICRzYWZlLWFyZWEtcG9zaXRpb246IGNhbGModmFyKC0taW9uLXNhZmUtYXJlYS1yaWdodCkgKyAjeyRweH0pO1xuXG4gICAgQGluY2x1ZGUgYm9yZGVyLWVuZCgkc2FmZS1hcmVhLXBvc2l0aW9uLCAkdHlwZSwgJGNvbG9yKTtcbn1cblxuQG1peGluIHNhZmUtYXJlYS1tYXJnaW4taG9yaXpvbnRhbCgkc3RhcnQsICRlbmQ6ICRzdGFydCkge1xuICAgICRzYWZlLWFyZWEtZW5kOiBudWxsO1xuICAgICRzYWZlLWFyZWEtc3RhcnQ6IG51bGw7XG5cbiAgICBAaWYgKCRlbmQpIHtcbiAgICAgICAgJHNhZmUtYXJlYS1lbmQ6IGNhbGModmFyKC0taW9uLXNhZmUtYXJlYS1yaWdodCkgKyAjeyRlbmR9KTtcbiAgICB9XG4gICAgQGlmICgkc3RhcnQpIHtcbiAgICAgICAgJHNhZmUtYXJlYS1zdGFydDogY2FsYyh2YXIoLS1pb24tc2FmZS1hcmVhLWxlZnQpICsgI3skc3RhcnR9KTtcbiAgICB9XG5cbiAgICBAaW5jbHVkZSBtYXJnaW4taG9yaXpvbnRhbCgkc2FmZS1hcmVhLXN0YXJ0LCAkc2FmZS1hcmVhLWVuZCk7XG59XG5cbkBtaXhpbiBzYWZlLWFyZWEtbWFyZ2luLXN0YXJ0KCRzdGFydCwgJGVuZCkge1xuICAgICRzYWZlLWFyZWEtc3RhcnQ6IGNhbGModmFyKC0taW9uLXNhZmUtYXJlYS1sZWZ0KSArICN7JHN0YXJ0fSk7XG5cbiAgICBAaW5jbHVkZSBtYXJnaW4taG9yaXpvbnRhbCgkc2FmZS1hcmVhLXN0YXJ0LCAkZW5kKTtcbn1cblxuQG1peGluIHNhZmUtYXJlYS1tYXJnaW4tZW5kKCRzdGFydCwgJGVuZCkge1xuICAgICRzYWZlLWFyZWEtZW5kOiBjYWxjKHZhcigtLWlvbi1zYWZlLWFyZWEtcmlnaHQpICsgI3skZW5kfSk7XG5cbiAgICBAaW5jbHVkZSBtYXJnaW4taG9yaXpvbnRhbCgkc3RhcnQsICRzYWZlLWFyZWEtZW5kKTtcbn1cblxuQG1peGluIHNhZmUtYXJlYS1wYWRkaW5nLWhvcml6b250YWwoJHN0YXJ0LCAkZW5kOiAkc3RhcnQpIHtcbiAgICAkc2FmZS1hcmVhLWVuZDogbnVsbDtcbiAgICAkc2FmZS1hcmVhLXN0YXJ0OiBudWxsO1xuXG4gICAgQGlmICgkZW5kKSB7XG4gICAgICAgICRzYWZlLWFyZWEtZW5kOiBjYWxjKHZhcigtLWlvbi1zYWZlLWFyZWEtcmlnaHQpICsgI3skZW5kfSk7XG4gICAgfVxuICAgIEBpZiAoJHN0YXJ0KSB7XG4gICAgICAgICRzYWZlLWFyZWEtc3RhcnQ6IGNhbGModmFyKC0taW9uLXNhZmUtYXJlYS1sZWZ0KSArICN7JHN0YXJ0fSk7XG4gICAgfVxuXG4gICAgQGluY2x1ZGUgcGFkZGluZy1ob3Jpem9udGFsKCRzYWZlLWFyZWEtc3RhcnQsICRzYWZlLWFyZWEtZW5kKTtcbn1cblxuQG1peGluIHNhZmUtYXJlYS1wYWRkaW5nLXN0YXJ0KCRzdGFydCwgJGVuZCkge1xuICAgICRzYWZlLWFyZWEtc3RhcnQ6IGNhbGModmFyKC0taW9uLXNhZmUtYXJlYS1sZWZ0KSArICN7JHN0YXJ0fSk7XG5cbiAgICBAaW5jbHVkZSBwYWRkaW5nLWhvcml6b250YWwoJHNhZmUtYXJlYS1zdGFydCwgJGVuZCk7XG59XG5cbkBtaXhpbiBzYWZlLWFyZWEtcGFkZGluZy1lbmQoJHN0YXJ0LCAkZW5kKSB7XG4gICAgJHNhZmUtYXJlYS1lbmQ6IGNhbGModmFyKC0taW9uLXNhZmUtYXJlYS1yaWdodCkgKyAjeyRlbmR9KTtcblxuICAgIEBpbmNsdWRlIHBhZGRpbmctaG9yaXpvbnRhbCgkc3RhcnQsICRzYWZlLWFyZWEtZW5kKTtcbn1cblxuQG1peGluIHNhZmUtYXJlYS1wb3NpdGlvbigkdG9wOiBudWxsLCAkZW5kOiBudWxsLCAkYm90dG9tOiBudWxsLCAkc3RhcnQ6IG51bGwpIHtcbiAgICAkc2FmZS1hcmVhLXN0YXJ0OiBjYWxjKHZhcigtLWlvbi1zYWZlLWFyZWEtbGVmdCkgKyAjeyRzdGFydH0pO1xuICAgICRzYWZlLWFyZWEtZW5kOiBjYWxjKHZhcigtLWlvbi1zYWZlLWFyZWEtcmlnaHQpICsgI3skZW5kfSk7XG5cbiAgICBAaW5jbHVkZSBwb3NpdGlvbigkdG9wLCAkc2FmZS1hcmVhLWVuZCwgJGJvdHRvbSwgJHNhZmUtYXJlYS1zdGFydCk7XG59XG5cbkBtaXhpbiBjb3JlLWhlYWRpbmdzKCkge1xuICAgIGgxIHtcbiAgICAgICAgZm9udC1zaXplOiAyNnB4O1xuICAgIH1cbiAgICBoMiwgLml0ZW0taGVhZGluZyB7XG4gICAgICAgIGZvbnQtc2l6ZTogMjRweDtcbiAgICB9XG4gICAgaDMge1xuICAgICAgICBmb250LXNpemU6IDIycHg7XG4gICAgfVxuICAgIGg0IHtcbiAgICAgICAgZm9udC1zaXplOiAyMHB4O1xuICAgIH1cbiAgICBoNSB7XG4gICAgICAgIGZvbnQtc2l6ZTogMThweDtcbiAgICB9XG4gICAgaDYge1xuICAgICAgICBmb250LXNpemU6IDE2cHg7XG4gICAgfVxufVxuXG5AbWl4aW4gZGFya21vZGUoKSB7XG4gICAgJHJvb3Q6ICN7Jn07XG5cbiAgICBAYXQtcm9vdCAje2FkZC1yb290LXNlbGVjdG9yKCRyb290LCBcImh0bWwuZGFya1wiKX0ge1xuICAgICAgICBAY29udGVudDtcbiAgICB9XG59XG5cbkBtaXhpbiBob3Jpem9udGFsX3Njcm9sbF9pdGVtKCR3aWR0aCwgJG1pbi13aWR0aCwgJG1heC13aWR0aCkge1xuICAgIGZsZXg6IDAgMCAkd2lkdGg7XG4gICAgbWluLXdpZHRoOiAkbWluLXdpZHRoO1xuICAgIG1heC13aWR0aDogJG1heC13aWR0aDtcbiAgICBhbGlnbi1zZWxmOiBzdHJldGNoO1xuICAgIGRpc3BsYXk6IGJsb2NrO1xuXG4gICAgaW9uLWNhcmQge1xuICAgICAgICAtLXZlcnRpY2FsLW1hcmdpbjogMTBweDtcbiAgICAgICAgLS1ob3Jpem9udGFsLW1hcmdpbjogMTBweDtcblxuICAgICAgICB3aWR0aDogY2FsYygxMDAlIC0gdmFyKC0taG9yaXpvbnRhbC1tYXJnaW4pIC0gdmFyKC0taG9yaXpvbnRhbC1tYXJnaW4pKTtcbiAgICAgICAgaGVpZ2h0OiBjYWxjKDEwMCUgLSB2YXIoLS12ZXJ0aWNhbC1tYXJnaW4pIC0gdmFyKC0tdmVydGljYWwtbWFyZ2luKSk7XG4gICAgICAgIG1hcmdpbjogdmFyKC0tdmVydGljYWwtbWFyZ2luKSB2YXIoLS1ob3Jpem9udGFsLW1hcmdpbik7XG5cbiAgICAgICAgQG1lZGlhIChtYXgtd2lkdGg6IDM2MHB4KSB7XG4gICAgICAgICAgICAtLWhvcml6b250YWwtbWFyZ2luOiA2cHg7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbi8vIENvbG9yIG1peGlucy5cbkBmdW5jdGlvbiBnZXRfYnJpZ2h0bmVzcygkY29sb3IpIHtcbiAgICBAcmV0dXJuIG1hdGguZGl2KHJlZCgkY29sb3IpICsgZ3JlZW4oJGNvbG9yKSArIGJsdWUoJGNvbG9yKSwgMyk7XG59XG5cbi8vIEdldCB0aGUgYmV0dGVyIGNvbG9yIGNvbnRyYXN0IHVzaW5nIFdDQUcgYWxnb3J5dGhtLlxuQGZ1bmN0aW9uIGdldF9jb250cmFzdF9jb2xvcigkY29sb3IpIHtcbiAgICAkbHVtaWFuY2U6IGx1bWluYW5jZSgkY29sb3IpO1xuXG4gICAgLy8gV2hpdGUgbHVtaWFuY2UgaXMgMS5cbiAgICAkd2hpdGVDb250cmFzdDogbWF0aC5kaXYoJGx1bWlhbmNlICsgMC4wNSwgMSArIDAuMDUpO1xuICAgIC8vIFdoaXRlIGx1bWlhbmNlIGlzIDAuXG4gICAgJGJsYWNrQ29udHJhc3Q6IG1hdGguZGl2KDAuMDUsICRsdW1pYW5jZSArIDAuMDUpO1xuXG4gICAgQHJldHVybiBpZigkd2hpdGVDb250cmFzdCA8ICRibGFja0NvbnRyYXN0LCB3aGl0ZSwgYmxhY2spO1xufVxuXG4vLyBDb2xvciBjb250cmFzdCB1c2luZyB5aXEgYXByb3hpbWF0aW9uIHdpdGggMTUwIHRocmVzaG9sZC5cbkBmdW5jdGlvbiBnZXRfY29udHJhc3RfY29sb3JfeWlxKCRjb2xvciwgJGRhcms6IGJsYWNrLCAkbGlnaHQ6IHdoaXRlKSB7XG4gICAgJHI6IHJlZCgkY29sb3IpO1xuICAgICRnOiBncmVlbigkY29sb3IpO1xuICAgICRiOiBibHVlKCRjb2xvcik7XG5cbiAgICAkeWlxOiBtYXRoLmRpdigoJHIgKiAyOTkpICsgKCRnICogNTg3KSArICgkYiAqIDExNCksIDEwMDApO1xuXG4gICAgQHJldHVybiBpZigkeWlxID49IDEyOCwgJGRhcmssICRsaWdodCk7XG59XG5cbi8vIFdDQUcgY29udHJhc3QgYWxnb3JpdGhtXG5AZnVuY3Rpb24gY2hlY2stY29udHJhc3QoJGZvcmVncm91bmQsICRiYWNrZ3JvdW5kKSB7XG4gICAgJGZvcmVncm91bmRMdW1pYW5jZTogbHVtaW5hbmNlKCRmb3JlZ3JvdW5kKTtcbiAgICAkYmFja2dyb3VuZEx1bWluYW5jZTogbHVtaW5hbmNlKCRiYWNrZ3JvdW5kKTtcblxuICAgIEBpZiAoJGJhY2tncm91bmRMdW1pbmFuY2UgPCAkZm9yZWdyb3VuZEx1bWlhbmNlKSB7XG4gICAgICAgIEByZXR1cm4gbWF0aC5kaXYoJGJhY2tncm91bmRMdW1pbmFuY2UgKyAwLjA1LCAkZm9yZWdyb3VuZEx1bWlhbmNlICsgMC4wNSk7XG4gICAgfSBAZWxzZSB7XG4gICAgICAgIEByZXR1cm4gbWF0aC5kaXYoJGZvcmVncm91bmRMdW1pYW5jZSArIDAuMDUsICRiYWNrZ3JvdW5kTHVtaW5hbmNlICsgMC4wNSk7XG4gICAgfVxufVxuXG5AZnVuY3Rpb24gbHVtaW5hbmNlKCRjb2xvcikge1xuICAgICRyOiByZWQoJGNvbG9yKTtcbiAgICAkZzogZ3JlZW4oJGNvbG9yKTtcbiAgICAkYjogYmx1ZSgkY29sb3IpO1xuXG4gICAgJHI6IGNvbXBvbmVudC1sdW1pbmFuY2UoJHIpO1xuICAgICRnOiBjb21wb25lbnQtbHVtaW5hbmNlKCRnKTtcbiAgICAkYjogY29tcG9uZW50LWx1bWluYW5jZSgkYik7XG5cbiAgICBAcmV0dXJuICRyICogMC4yMTI2ICsgJGcgKiAwLjcxNTIgKyAkYiAqIDAuMDcyMjtcbn1cblxuQGZ1bmN0aW9uIGNvbXBvbmVudC1sdW1pbmFuY2UoJHZhbHVlKSB7XG4gICAgJHZhbHVlOiBtYXRoLmRpdigkdmFsdWUsIDI1NSk7XG5cbiAgICBAaWYgKCR2YWx1ZSA8PSAwLjAzOTI4KSB7XG4gICAgICAgIEByZXR1cm4gbWF0aC5kaXYoJHZhbHVlLCAxMi45Mik7XG4gICAgfSBAZWxzZSB7XG4gICAgICAgIEByZXR1cm4gbWF0aC5wb3cobWF0aC5kaXYoJHZhbHVlICsgMC4wNTUsIDEuMDU1KSwgMi40KTtcbiAgICB9XG59XG4iLCIvKlxuICogQXBwIEN1c3RvbSBBcHAgdmFyaWFibGVzIFNDU1NcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqIFBsYWNlIGhlcmUgYWxsIGN1c3RvbSBhcHAgdmFyaWFibGVzLlxuICovXG4iLCIvKlxuICogQXBwIEdsb2JhbCB2YXJpYWJsZXMgU0NTU1xuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogUGxhY2UgaGVyZSBhbGwgZ2xvYmFsIHZhcmlhYmxlcy5cbiAqL1xuXG4kd2hpdGU6ICAgICAgICNmZmZmZmYgIWRlZmF1bHQ7XG4kZ3JheS0xMDA6ICAgICNmOGY5ZmEgIWRlZmF1bHQ7XG4kZ3JheS0yMDA6ICAgICNlOWVjZWYgIWRlZmF1bHQ7XG4kZ3JheS0zMDA6ICAgICNkZWUyZTYgIWRlZmF1bHQ7IC8vIFN0cm9rZVxuJGdyYXktNDAwOiAgICAjY2VkNGRhICFkZWZhdWx0O1xuJGdyYXktNTAwOiAgICAjOGY5NTllICFkZWZhdWx0OyAvLyBTdHJva2Ugb24gaW5wdXRzXG4kZ3JheS02MDA6ICAgICM2YTczN2IgIWRlZmF1bHQ7XG4kZ3JheS03MDA6ICAgICM0OTUwNTcgIWRlZmF1bHQ7XG4kZ3JheS04MDA6ICAgICMzNDNhNDAgIWRlZmF1bHQ7XG4kZ3JheS05MDA6ICAgICMyODI4MjggIWRlZmF1bHQ7IC8vIENvcHkgdGV4dFxuJGJsYWNrOiAgICAgICAjMDAwMDAwICFkZWZhdWx0OyAvLyBBdm9pZCB1c2FnZVxuXG4kYmx1ZTogICAgICAgICMwZjZjYmYgIWRlZmF1bHQ7XG4kY3lhbjogICAgICAgICMwMDgxOTYgIWRlZmF1bHQ7IC8vIE5vdCB1c2VkLlxuJGdyZWVuOiAgICAgICAjMzU3YTMyICFkZWZhdWx0O1xuJHJlZDogICAgICAgICAjY2EzMTIwICFkZWZhdWx0O1xuJHllbGxvdzogICAgICAjZjBhZDRlICFkZWZhdWx0O1xuXG4kYnJhbmQtY29sb3I6ICNmOTgwMTIgIWRlZmF1bHQ7XG5cbiR0ZXh0LWNvbG9yOiAgICAgICAgICAgICAgICRncmF5LTkwMCAhZGVmYXVsdDtcbiR0ZXh0LWNvbG9yLXJnYjogICAgICAgICAgIGNvbG9yLXRvLXJnYi1saXN0KCR0ZXh0LWNvbG9yKSAhZGVmYXVsdDtcbiR0ZXh0LWNvbG9yLWRhcms6ICAgICAgICAgICR3aGl0ZSAhZGVmYXVsdDtcbiR0ZXh0LWNvbG9yLWRhcmstcmdiOiAgICAgIGNvbG9yLXRvLXJnYi1saXN0KCR0ZXh0LWNvbG9yLWRhcmspICFkZWZhdWx0O1xuXG4kYmFja2dyb3VuZC1jb2xvcjogICAgICAgICAgJHdoaXRlICFkZWZhdWx0O1xuJGJhY2tncm91bmQtY29sb3ItcmdiOiAgICAgIGNvbG9yLXRvLXJnYi1saXN0KCRiYWNrZ3JvdW5kLWNvbG9yKSAhZGVmYXVsdDtcbiRiYWNrZ3JvdW5kLWNvbG9yLWRhcms6ICAgICAkZ3JheS05MDAgIWRlZmF1bHQ7IC8vICMxYTFhMWFcbiRiYWNrZ3JvdW5kLWNvbG9yLWRhcmstcmdiOiBjb2xvci10by1yZ2ItbGlzdCgkYmFja2dyb3VuZC1jb2xvci1kYXJrKSAhZGVmYXVsdDtcblxuJGlvbi1pdGVtLWJhY2tncm91bmQ6ICAgICAgJHdoaXRlICFkZWZhdWx0O1xuJGlvbi1pdGVtLWJhY2tncm91bmQtcmdiOiAgY29sb3ItdG8tcmdiLWxpc3QoJGlvbi1pdGVtLWJhY2tncm91bmQpICFkZWZhdWx0O1xuJGlvbi1pdGVtLWJhY2tncm91bmQtZGFyazogJGdyYXktOTAwICFkZWZhdWx0O1xuJGlvbi1pdGVtLWJhY2tncm91bmQtZGFyay1yZ2I6IGNvbG9yLXRvLXJnYi1saXN0KCRpb24taXRlbS1iYWNrZ3JvdW5kLWRhcmspICFkZWZhdWx0O1xuXG4kcHJpbWFyeTogICAgJGJyYW5kLWNvbG9yICFkZWZhdWx0O1xuJHNlY29uZGFyeTogICRncmF5LTMwMCAhZGVmYXVsdDtcbiRkYW5nZXI6ICAgICAkcmVkICFkZWZhdWx0O1xuJHdhcm5pbmc6ICAgICR5ZWxsb3cgIWRlZmF1bHQ7XG4kc3VjY2VzczogICAgJGdyZWVuICFkZWZhdWx0O1xuJGluZm86ICAgICAgICRibHVlICFkZWZhdWx0O1xuJGxpZ2h0OiAgICAgICRncmF5LTEwMCAhZGVmYXVsdDtcbiRtZWRpdW06ICAgICAkZ3JheS03MDAgIWRlZmF1bHQ7XG4kZGFyazogICAgICAgJGdyYXktOTAwICFkZWZhdWx0O1xuXG4kY29sb3JzOiAgKFxuICAgIHByaW1hcnk6IChsaWdodDogJHByaW1hcnksIGRhcms6ICRwcmltYXJ5KSxcbiAgICBzZWNvbmRhcnk6IChsaWdodDogJHNlY29uZGFyeSwgZGFyazogJGdyYXktNzAwKSxcbiAgICBzdWNjZXNzOiAobGlnaHQ6ICRzdWNjZXNzKSxcbiAgICB3YXJuaW5nOiAobGlnaHQ6ICR3YXJuaW5nKSxcbiAgICBkYW5nZXI6ICAobGlnaHQ6ICRkYW5nZXIpLFxuICAgIGluZm86IChsaWdodDogJGluZm8pLFxuICAgIGxpZ2h0OiAobGlnaHQ6ICRsaWdodCwgZGFyazogJGRhcmspLFxuICAgIG1lZGl1bTogKGxpZ2h0OiAkbWVkaXVtLCBkYXJrOiAkZ3JheS0yMDApLFxuICAgIGRhcms6IChsaWdodDogJGRhcmssIGRhcms6ICRsaWdodCksXG4pICFkZWZhdWx0O1xuXG4vKipcbiAqIExheW91dCBCcmVha3BvaW50c1xuICpcbiAqIGh0dHBzOi8vaW9uaWNmcmFtZXdvcmsuY29tL2RvY3MvbGF5b3V0L2dyaWQjZGVmYXVsdC1icmVha3BvaW50c1xuICovXG5cbi8vIFRoZSBtaW5pbXVtIGRpbWVuc2lvbnMgYXQgd2hpY2ggeW91ciBsYXlvdXQgd2lsbCBjaGFuZ2UsXG4vLyBhZGFwdGluZyB0byBkaWZmZXJlbnQgc2NyZWVuIHNpemVzLCBmb3IgdXNlIGluIG1lZGlhIHF1ZXJpZXNcbiRzY3JlZW4tYnJlYWtwb2ludHM6IChcbiAgICB4czogMHB4LFxuICAgIHNtOiA1NzZweCxcbiAgICBtZDogNzY4cHgsXG4gICAgbGc6IDk5MnB4LFxuICAgIHRhYmxldDogOTkycHgsXG4gICAgeGw6IDEyMDBweFxuKSAhZGVmYXVsdDtcblxuJGNvcmUtY291cnNlLWltYWdlLWJhY2tncm91bmQ6ICM4MWVjZWMsICM3NGI5ZmYsICNhMjliZmUsICNkZmU2ZTksICMwMGI4OTQsICMwOTg0ZTMsICNiMmJlYzMsICNmZGNiNmUsICNmZDc5YTgsICM2YzVjZTcgIWRlZmF1bHQ7XG4kY29yZS1kZC1xdWVzdGlvbi1jb2xvcnM6ICNGRkZGRkYsICNCMEM0REUsICNEQ0RDREMsICNEOEJGRDgsICM4N0NFRkEsICNEQUE1MjAsICNGRkQ3MDAsICNGMEU2OEMgIWRlZmF1bHQ7XG4kY29yZS10ZXh0LWhpZ2h0bGlnaHQtYmFja2dyb3VuZC1jb2xvcjogbGlnaHRlbigkYmx1ZSwgNDAlKSAhZGVmYXVsdDtcblxuJGNvcmUtZml4ZWQtdXJsOiBmYWxzZSAhZGVmYXVsdDtcbiRjb3JlLWRhc2hib2FyZC1sb2dvOiBmYWxzZSAhZGVmYXVsdDtcbiRjb3JlLWFsd2F5cy1zaG93LW1haW4tbWVudTogZmFsc2UgIWRlZmF1bHQ7XG4kY29yZS1mb3JtYXQtdGV4dC1uZXZlci1zaG9ydGVuOiBmYWxzZSAhZGVmYXVsdDtcblxuJGNvcmUtaGlkZS1jb3Vyc2VpbWFnZS1vbi1jb3Vyc2U6IGZhbHNlICFkZWZhdWx0O1xuJGNvcmUtaGlkZS1wcm9ncmVzcy1vbi1jb3Vyc2U6IGZhbHNlICFkZWZhdWx0O1xuJGNvcmUtaGlkZS1wcm9ncmVzcy1vbi1zZWN0aW9uLXNlbGVjdG9yOiBmYWxzZSAhZGVmYXVsdDtcblxuJGNvcmUtY291cnNlLWhpZGUtdGh1bWItb24tY2FyZHM6IGZhbHNlICFkZWZhdWx0O1xuJGNvcmUtY291cnNlLXRodW1iLW9uLWNhcmRzLWJhY2tncm91bmQ6IG51bGwgIWRlZmF1bHQ7XG4kY29yZS1jb3Vyc2UtaGlkZS1wcm9ncmVzcy1vbi1jYXJkczogZmFsc2UgIWRlZmF1bHQ7XG5cbi8vIENvbmZpZ3VyYXRpb24gb3B0aW9ucyBmb3IgbG9naW4gcGFnZS5cbiRjb3JlLWxvZ2luLWJ1dHRvbi1vdXRsaW5lOiBmYWxzZSAhZGVmYXVsdDtcbiRjb3JlLWxvZ2luLWJ1dHRvbi1vdXRsaW5lLWRhcms6ICRjb3JlLWxvZ2luLWJ1dHRvbi1vdXRsaW5lICFkZWZhdWx0O1xuJGNvcmUtbG9naW4tbG9hZGluZy1jb2xvcjogZmFsc2UgIWRlZmF1bHQ7XG4kY29yZS1sb2dpbi1sb2FkaW5nLWNvbG9yLWRhcms6ICR0ZXh0LWNvbG9yLWRhcmsgIWRlZmF1bHQ7XG4kY29yZS1sb2dpbi1oaWRlLWZvcmdvdC1wYXNzd29yZDogZmFsc2UgIWRlZmF1bHQ7XG4kY29yZS1sb2dpbi1oaWRlLW5lZWQtaGVscDogZmFsc2UgIWRlZmF1bHQ7XG4kY29yZS1sb2dpbi1oaWRlLXFyY29kZTogZmFsc2UgIWRlZmF1bHQ7XG5cbi8vIENvbmZpZ3VyYXRpb24gb3B0aW9ucyBmb3IgbW9yZSBwYWdlLiAoZGVwcmVjYXRlZCBvbiA0LjApXG4kY29yZS1tb3JlLWhpZGUtc2l0ZWluZm86IGZhbHNlICFkZWZhdWx0O1xuJGNvcmUtbW9yZS1oaWRlLXNpdGVuYW1lOiBmYWxzZSAhZGVmYXVsdDtcbiRjb3JlLW1vcmUtaGlkZS1zaXRldXJsOiBmYWxzZSAhZGVmYXVsdDtcblxuLy8gQ29uZmlndXJhdGlvbiBvcHRpb25zIGZvciB1c2VyIHBhZ2UuXG4kY29yZS11c2VyLWhpZGUtc2l0ZWluZm86ICRjb3JlLW1vcmUtaGlkZS1zaXRlaW5mbyAhZGVmYXVsdDtcbiRjb3JlLXVzZXItaGlkZS1zaXRlbmFtZTogJGNvcmUtbW9yZS1oaWRlLXNpdGVuYW1lICFkZWZhdWx0O1xuJGNvcmUtdXNlci1oaWRlLXNpdGV1cmw6ICRjb3JlLW1vcmUtaGlkZS1zaXRldXJsICFkZWZhdWx0O1xuXG4vLyBBY3Rpdml0eSBpY29uIGJhY2tncm91bmQgY29sb3JzLlxuJGFjdGl2aXR5LWljb24tY29sb3JzOiAoXG4gICAgYWRtaW5pc3RyYXRpb246ICM1ZDYzZjYsXG4gICAgYXNzZXNzbWVudDogI2ViNjZhMixcbiAgICBjb2xsYWJvcmF0aW9uOiAjZjc2MzRkLFxuICAgIGNvbW11bmljYXRpb246ICMxMWE2NzYsXG4gICAgY29udGVudDogIzM5OWJlMixcbiAgICBpbnRlcmZhY2U6ICNhMzc4ZmZcbikgIWRlZmF1bHQ7XG5cbiRjYWxlbmRhci1ldmVudC1jYXRlZ29yeS1jYXRlZ29yeTogIzhlMjRhYSAhZGVmYXVsdDtcbiRjYWxlbmRhci1ldmVudC1jYXRlZ29yeS1jb3Vyc2U6ICRyZWQgIWRlZmF1bHQ7XG4kY2FsZW5kYXItZXZlbnQtY2F0ZWdvcnktZ3JvdXA6ICR5ZWxsb3cgIWRlZmF1bHQ7XG4kY2FsZW5kYXItZXZlbnQtY2F0ZWdvcnktdXNlcjogJGJsdWUgIWRlZmF1bHQ7XG4kY2FsZW5kYXItZXZlbnQtY2F0ZWdvcnktc2l0ZTogJGdyZWVuICFkZWZhdWx0O1xuXG4vLyBDYWxlbmRhciBldmVudCBjYXRlZ29yeSBiYWNrZ3JvdW5kIGNvbG9ycy5cbiRjYWxlbmRhci1ldmVudC1jYXRlZ29yeS1jb2xvcnM6IChcbiAgICBjYXRlZ29yeTogJGNhbGVuZGFyLWV2ZW50LWNhdGVnb3J5LWNhdGVnb3J5LFxuICAgIGNvdXJzZTogJGNhbGVuZGFyLWV2ZW50LWNhdGVnb3J5LWNvdXJzZSxcbiAgICBncm91cDogJGNhbGVuZGFyLWV2ZW50LWNhdGVnb3J5LWdyb3VwLFxuICAgIHVzZXI6ICRjYWxlbmRhci1ldmVudC1jYXRlZ29yeS11c2VyLFxuICAgIHNpdGU6ICRjYWxlbmRhci1ldmVudC1jYXRlZ29yeS1zaXRlLFxuKSAhZGVmYXVsdDtcbiJdLCJzb3VyY2VSb290IjoiIn0= */\"]\n});","map":{"version":3,"names":["EventEmitter","IonicSlides","CoreSites","CoreFilepool","CoreDomUtils","CoreUrlUtils","CoreUtils","Translate","CoreEvents","CoreEditorOffline","CoreDirectivesRegistry","CoreLoadingComponent","CoreScreen","CoreDom","CorePlatform","i0","ɵɵelementStart","ɵɵelement","ɵɵtext","ɵɵelementEnd","ɵɵadvance","ɵɵtextInterpolate1","ɵɵpipeBind1","ctx_r2","infoMessage","ɵɵlistener","CoreEditorRichTextEditorComponent_button_8_Template_button_click_0_listener","$event","ɵɵrestoreView","_r10","ctx_r9","ɵɵnextContext","ɵɵresetView","toolbarPrev","CoreEditorRichTextEditorComponent_button_8_Template_button_keyup_0_listener","ctx_r11","CoreEditorRichTextEditorComponent_button_8_Template_button_mousedown_0_listener","ctx_r12","downAction","CoreEditorRichTextEditorComponent_button_8_Template_button_keydown_0_listener","ctx_r13","ɵɵproperty","ctx_r4","toolbarPrevHidden","ɵɵattribute","CoreEditorRichTextEditorComponent_swiper_slide_61_Template_button_click_1_listener","_r15","ctx_r14","scanQR","CoreEditorRichTextEditorComponent_swiper_slide_61_Template_button_keyup_1_listener","ctx_r16","CoreEditorRichTextEditorComponent_swiper_slide_61_Template_button_mousedown_1_listener","ctx_r17","stopBubble","CoreEditorRichTextEditorComponent_swiper_slide_61_Template_button_keydown_1_listener","ctx_r18","ctx_r6","rteEnabled","CoreEditorRichTextEditorComponent_swiper_slide_66_Template_button_click_1_listener","_r20","ctx_r19","hideToolbar","CoreEditorRichTextEditorComponent_swiper_slide_66_Template_button_keyup_1_listener","ctx_r21","CoreEditorRichTextEditorComponent_swiper_slide_66_Template_button_mousedown_1_listener","ctx_r22","CoreEditorRichTextEditorComponent_swiper_slide_66_Template_button_keydown_1_listener","ctx_r23","CoreEditorRichTextEditorComponent_button_67_Template_button_click_0_listener","_r25","ctx_r24","toolbarNext","CoreEditorRichTextEditorComponent_button_67_Template_button_keyup_0_listener","ctx_r26","CoreEditorRichTextEditorComponent_button_67_Template_button_mousedown_0_listener","ctx_r27","CoreEditorRichTextEditorComponent_button_67_Template_button_keydown_0_listener","ctx_r28","ctx_r8","toolbarNextHidden","CoreEditorRichTextEditorComponent","swiperRef","setTimeout","_swiperRef$nativeElem","nativeElement","swiper","toolbarSlides","changeLanguageDirection","isRTL","Object","keys","swiperOpts","forEach","key","params","constructor","content","elementRef","placeholder","name","DRAFT_AUTOSAVE_FREQUENCY","RESTORE_MESSAGE_CLEAR_TIME","SAVE_MESSAGE_CLEAR_TIME","minHeight","isCurrentView","toolbarButtonWidth","toolbarArrowWidth","lastDraft","draftWasRestored","isPhone","toolbarHidden","toolbarArrows","canScanQR","toolbarStyles","strong","em","u","strike","p","h3","h4","h5","ul","ol","modules","slidesPerView","centerInsufficientSlides","watchSlidesProgress","contentChanged","element","pageInstance","Date","now","ngOnInit","isMobile","ngAfterViewInit","_this","_asyncToGenerator","_this$editor","_this$control","_this$control2","_this$control3","isRichTextEditorEnabled","waitLoadingsDone","editorElement","editor","setContent","control","value","originalContent","document","execCommand","maximizeEditorSize","setListeners","updateToolbarButtons","elementId","setAttribute","replaceTags","shouldAutoSaveDrafts","restoreDraft","autoSaveDrafts","deleteDraftOnSubmitOrCancel","ionItem","closest","classList","add","label","querySelector","updateArialabelledBy","_label$getAttribute","ariaLabelledBy","getAttribute","undefined","labelObserver","MutationObserver","observe","attributes","attributeFilter","_this$control4","valueChangeSubscription","valueChanges","subscribe","newValue","_this$control5","setValue","emitEvent","saveDraft","contextLevel","contextInstanceId","draftExtraParams","resizeListener","onWindowResize","windowResized","addEventListener","selectionChangeFunction","updateToolbarStyles","keyboardObserver","on","KEYBOARD_CHANGE","languageChangedSubscription","onLangChange","_this$toolbarSlides","onKeyDown","event","onChange","shortcutId","getShortcutId","commands","getShortcutCommands","command","executeCommand","_this2","blankHeight","getBlankHeightInContent","newHeight","getBoundingClientRect","height","style","setProperty","removeProperty","_this3","domPromise","waitToBeInDOM","page","waitDirectivesReady","_this4","nextTicks","contentHeight","getContentHeight","scrollContentHeight","_content","children","Array","from","filter","slot","contains","map","reduce","a","b","_this$control10","isNullOrWhiteSpace","textContent","clearText","_this$control6","_this$control7","restoreExternalContent","innerHTML","markAsDirty","textarea","treatExternalContent","_this$control8","_this$control9","emit","setCurrentCursorPosition","parent","chars","setRange","node","range","count","setEnd","hasChildNodes","lp","childNodes","length","createRange","selectNode","selectNodeContents","setStart","selection","window","getSelection","collapse","removeAllRanges","addRange","toggleEditor","_this5","_this5$control","type","isValidKeyboardKey","_this5$editorElement","_this5$textarea","_this5$editorElement2","removeAttribute","textareaInputElement","getInputElement","focus","_this5$editorElement3","_this5$textarea2","_this5$textarea3","setFocus","_this6","isLoggedIn","elements","querySelectorAll","site","getCurrentSite","siteId","getCurrentSiteId","canDownloadFiles","_ref","el","url","src","isDownloadableUrl","isSitePluginFileUrl","finalUrl","getSrcByUrl","component","componentId","_x","apply","arguments","originalUrl","replace","split","join","_this$control11","buttonAction","parameters","originTags","destinationTags","focusRTE","_this$editorElement","_this$textarea","force","target","remove","showToolbar","_this$editorElement2","preventDefault","stopPropagation","_window$getSelection","toString","activeElement","_this7","_this7$toolbarSlides","_this7$toolbarSlides2","currentIndex","activeIndex","slideTo","slidesPerViewDynamic","updateToolbarArrows","_this8","_this8$toolbarSlides","_this8$toolbarSlides2","_this9","_this9$buttonsDomProm","toolbar","offsetParent","slides","buttonsDomPromise","cancel","width","Math","floor","nextTick","update","_this10","_window$getSelection2","focusNode","nodeType","parentElement","styles","tagName","toLowerCase","assign","autoSave","isTrueOrOne","_this11","entry","resumeDraft","draftText","drafttext","originalcontent","showMessage","_unused","_this12","autoSaveInterval","setInterval","newText","error","_this13","resetObserver","FORM_ACTION","_ref3","data","form","deleteDraft","_x2","message","timeout","clearTimeout","hideMessageTimeout","_this14","text","_this14$editorElement","_this15","waitForResizeDone","ionViewDidEnter","ionViewDidLeave","ngOnDestroy","_this$valueChangeSubs","_this$languageChanged","_this$resetObserver","_this$keyboardObserve","_this$labelObserver","_this$resizeListener","_this$domPromise","_this$buttonsDomPromi","unsubscribe","removeEventListener","clearInterval","initHeightInterval","off","disconnect","shortcutCommands","isIOS","metaKey","shiftKey","shortcuts","code","modifiers","id","altKey","includes","ctrlKey","shortcut","ɵɵdirectiveInject","i1","IonContent","ElementRef","selectors","viewQuery","CoreEditorRichTextEditorComponent_Query","rf","ctx","CoreEditorRichTextEditorComponent_Template_div_click_0_listener","CoreEditorRichTextEditorComponent_Template_div_focus_1_listener","CoreEditorRichTextEditorComponent_Template_div_blur_1_listener","CoreEditorRichTextEditorComponent_Template_div_keydown_1_listener","CoreEditorRichTextEditorComponent_Template_div_keyup_1_listener","CoreEditorRichTextEditorComponent_Template_div_change_1_listener","CoreEditorRichTextEditorComponent_Template_div_paste_1_listener","CoreEditorRichTextEditorComponent_Template_div_input_1_listener","CoreEditorRichTextEditorComponent_Template_ion_textarea_ionChange_3_listener","CoreEditorRichTextEditorComponent_Template_ion_textarea_ionFocus_3_listener","CoreEditorRichTextEditorComponent_Template_ion_textarea_ionBlur_3_listener","ɵɵtemplate","CoreEditorRichTextEditorComponent_div_5_Template","CoreEditorRichTextEditorComponent_button_8_Template","CoreEditorRichTextEditorComponent_Template_swiper_container_slidechangetransitionend_9_listener","CoreEditorRichTextEditorComponent_Template_button_click_12_listener","CoreEditorRichTextEditorComponent_Template_button_keyup_12_listener","CoreEditorRichTextEditorComponent_Template_button_mousedown_12_listener","CoreEditorRichTextEditorComponent_Template_button_keydown_12_listener","CoreEditorRichTextEditorComponent_Template_button_click_16_listener","CoreEditorRichTextEditorComponent_Template_button_keyup_16_listener","CoreEditorRichTextEditorComponent_Template_button_mousedown_16_listener","CoreEditorRichTextEditorComponent_Template_button_keydown_16_listener","CoreEditorRichTextEditorComponent_Template_button_click_20_listener","CoreEditorRichTextEditorComponent_Template_button_keyup_20_listener","CoreEditorRichTextEditorComponent_Template_button_mousedown_20_listener","CoreEditorRichTextEditorComponent_Template_button_keydown_20_listener","CoreEditorRichTextEditorComponent_Template_button_click_24_listener","CoreEditorRichTextEditorComponent_Template_button_keyup_24_listener","CoreEditorRichTextEditorComponent_Template_button_mousedown_24_listener","CoreEditorRichTextEditorComponent_Template_button_keydown_24_listener","CoreEditorRichTextEditorComponent_Template_button_click_28_listener","CoreEditorRichTextEditorComponent_Template_button_keyup_28_listener","CoreEditorRichTextEditorComponent_Template_button_mousedown_28_listener","CoreEditorRichTextEditorComponent_Template_button_keydown_28_listener","CoreEditorRichTextEditorComponent_Template_button_click_32_listener","CoreEditorRichTextEditorComponent_Template_button_keyup_32_listener","CoreEditorRichTextEditorComponent_Template_button_mousedown_32_listener","CoreEditorRichTextEditorComponent_Template_button_keydown_32_listener","CoreEditorRichTextEditorComponent_Template_button_click_38_listener","CoreEditorRichTextEditorComponent_Template_button_keyup_38_listener","CoreEditorRichTextEditorComponent_Template_button_mousedown_38_listener","CoreEditorRichTextEditorComponent_Template_button_keydown_38_listener","CoreEditorRichTextEditorComponent_Template_button_click_44_listener","CoreEditorRichTextEditorComponent_Template_button_keyup_44_listener","CoreEditorRichTextEditorComponent_Template_button_mousedown_44_listener","CoreEditorRichTextEditorComponent_Template_button_keydown_44_listener","CoreEditorRichTextEditorComponent_Template_button_click_50_listener","CoreEditorRichTextEditorComponent_Template_button_mousedown_50_listener","CoreEditorRichTextEditorComponent_Template_button_keydown_50_listener","CoreEditorRichTextEditorComponent_Template_button_click_54_listener","CoreEditorRichTextEditorComponent_Template_button_keyup_54_listener","CoreEditorRichTextEditorComponent_Template_button_mousedown_54_listener","CoreEditorRichTextEditorComponent_Template_button_keydown_54_listener","CoreEditorRichTextEditorComponent_Template_button_click_58_listener","CoreEditorRichTextEditorComponent_Template_button_keyup_58_listener","CoreEditorRichTextEditorComponent_Template_button_mousedown_58_listener","CoreEditorRichTextEditorComponent_Template_button_keydown_58_listener","CoreEditorRichTextEditorComponent_swiper_slide_61_Template","CoreEditorRichTextEditorComponent_Template_button_click_63_listener","CoreEditorRichTextEditorComponent_Template_button_keyup_63_listener","CoreEditorRichTextEditorComponent_Template_button_mousedown_63_listener","CoreEditorRichTextEditorComponent_Template_button_keydown_63_listener","CoreEditorRichTextEditorComponent_swiper_slide_66_Template","CoreEditorRichTextEditorComponent_button_67_Template","ɵɵclassProp"],"sources":["/home/toon/works/gitionic7/ionic-github/ionic/src/core/features/editor/components/rich-text-editor/rich-text-editor.ts","/home/toon/works/gitionic7/ionic-github/ionic/src/core/features/editor/components/rich-text-editor/core-editor-rich-text-editor.html"],"sourcesContent":["// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {\n    Component,\n    Input,\n    Output,\n    EventEmitter,\n    ViewChild,\n    ElementRef,\n    OnInit,\n    OnDestroy,\n    Optional,\n    AfterViewInit,\n} from '@angular/core';\nimport { FormControl } from '@angular/forms';\nimport { IonTextarea, IonContent, IonicSlides } from '@ionic/angular';\nimport { Subscription } from 'rxjs';\n\nimport { CoreSites } from '@services/sites';\nimport { CoreFilepool } from '@services/filepool';\nimport { CoreDomUtils } from '@services/utils/dom';\nimport { CoreUrlUtils } from '@services/utils/url';\nimport { CoreUtils } from '@services/utils/utils';\nimport { Translate } from '@singletons';\nimport { CoreEventFormActionData, CoreEventObserver, CoreEvents } from '@singletons/events';\nimport { CoreEditorOffline } from '../../services/editor-offline';\nimport { CoreDirectivesRegistry } from '@singletons/directives-registry';\nimport { CoreLoadingComponent } from '@components/loading/loading';\nimport { CoreScreen } from '@services/screen';\nimport { CoreCancellablePromise } from '@classes/cancellable-promise';\nimport { CoreDom } from '@singletons/dom';\nimport { CorePlatform } from '@services/platform';\nimport { Swiper } from 'swiper';\nimport { SwiperOptions } from 'swiper/types';\n\n/**\n * Component to display a rich text editor if enabled.\n *\n * If enabled, this component will show a rich text editor. Otherwise it'll show a regular textarea.\n *\n * Example:\n * <core-rich-text-editor [control]=\"control\" [placeholder]=\"field.name\"></core-rich-text-editor>\n */\n@Component({\n    selector: 'core-rich-text-editor',\n    templateUrl: 'core-editor-rich-text-editor.html',\n    styleUrls: ['rich-text-editor.scss'],\n})\nexport class CoreEditorRichTextEditorComponent implements OnInit, AfterViewInit, OnDestroy {\n\n    // Based on: https://github.com/judgewest2000/Ionic3RichText/\n    // @todo Anchor button, fullscreen...\n    // @todo Textarea height is not being updated when editor is resized. Height is calculated if any css is changed.\n    // @todo Implement ControlValueAccessor https://angular.io/api/forms/ControlValueAccessor.\n\n    @Input() placeholder = ''; // Placeholder to set in textarea.\n    @Input() control?: FormControl; // Form control.\n    @Input() name = 'core-rich-text-editor'; // Name to set to the textarea.\n    @Input() component?: string; // The component to link the files to.\n    @Input() componentId?: number; // An ID to use in conjunction with the component.\n    @Input() autoSave?: boolean | string; // Whether to auto-save the contents in a draft. Defaults to true.\n    @Input() contextLevel?: string; // The context level of the text.\n    @Input() contextInstanceId?: number; // The instance ID related to the context.\n    @Input() elementId?: string; // An ID to set to the element.\n    @Input() draftExtraParams?: Record<string, unknown>; // Extra params to identify the draft.\n    @Output() contentChanged: EventEmitter<string>;\n\n    @ViewChild('editor') editor?: ElementRef; // WYSIWYG editor.\n    @ViewChild('textarea') textarea?: IonTextarea; // Textarea editor.\n    @ViewChild('toolbar') toolbar?: ElementRef;\n    protected toolbarSlides?: Swiper;\n    @ViewChild('swiperRef')\n    set swiperRef(swiperRef: ElementRef) {\n        /**\n         * This setTimeout waits for Ionic's async initialization to complete.\n         * Otherwise, an outdated swiper reference will be used.\n         */\n        setTimeout(() => {\n            if (swiperRef.nativeElement?.swiper) {\n                this.toolbarSlides = swiperRef.nativeElement.swiper as Swiper;\n\n                this.toolbarSlides.changeLanguageDirection(CorePlatform.isRTL ? 'rtl' : 'ltr');\n\n                Object.keys(this.swiperOpts).forEach((key) => {\n                    if (this.toolbarSlides) {\n                        this.toolbarSlides.params[key] = this.swiperOpts[key];\n                    }\n                });\n            }\n        }, 0);\n    }\n\n    protected readonly DRAFT_AUTOSAVE_FREQUENCY = 30000;\n    protected readonly RESTORE_MESSAGE_CLEAR_TIME = 6000;\n    protected readonly SAVE_MESSAGE_CLEAR_TIME = 2000;\n\n    protected element: HTMLDivElement;\n    protected editorElement?: HTMLDivElement;\n    protected minHeight = 200; // Minimum height of the editor.\n\n    protected valueChangeSubscription?: Subscription;\n    protected keyboardObserver?: CoreEventObserver;\n    protected resetObserver?: CoreEventObserver;\n    protected labelObserver?: MutationObserver;\n    protected initHeightInterval?: number;\n    protected isCurrentView = true;\n    protected toolbarButtonWidth = 44;\n    protected toolbarArrowWidth = 44;\n    protected pageInstance: string;\n    protected autoSaveInterval?: number;\n    protected hideMessageTimeout?: number;\n    protected lastDraft = '';\n    protected draftWasRestored = false;\n    protected originalContent?: string;\n    protected resizeFunction?: () => Promise<number>;\n    protected selectionChangeFunction?: () => void;\n    protected languageChangedSubscription?: Subscription;\n    protected resizeListener?: CoreEventObserver;\n    protected domPromise?: CoreCancellablePromise<void>;\n    protected buttonsDomPromise?: CoreCancellablePromise<void>;\n    protected shortcutCommands?: Record<string, EditorCommand>;\n\n    rteEnabled = false;\n    isPhone = false;\n    toolbarHidden = false;\n    toolbarArrows = false;\n    toolbarPrevHidden = true;\n    toolbarNextHidden = false;\n    canScanQR = false;\n    ariaLabelledBy?: string;\n    infoMessage?: string;\n    toolbarStyles = {\n        strong: 'false',\n        em: 'false',\n        u: 'false',\n        strike: 'false',\n        p: 'false',\n        h3: 'false',\n        h4: 'false',\n        h5: 'false',\n        ul: 'false',\n        ol: 'false',\n    };\n\n    swiperOpts: SwiperOptions = {\n        modules: [IonicSlides],\n        slidesPerView: 6,\n        centerInsufficientSlides: true,\n        watchSlidesProgress: true,\n    };\n\n    constructor(\n        @Optional() protected content: IonContent,\n        elementRef: ElementRef,\n    ) {\n        this.contentChanged = new EventEmitter<string>();\n        this.element = elementRef.nativeElement as HTMLDivElement;\n        this.pageInstance = 'app_' + Date.now(); // Generate a \"unique\" ID based on timestamp.\n    }\n\n    /**\n     * @inheritdoc\n     */\n    ngOnInit(): void {\n        this.canScanQR = CoreUtils.canScanQR();\n        this.isPhone = CoreScreen.isMobile;\n        this.toolbarHidden = this.isPhone;\n    }\n\n    /**\n     * @inheritdoc\n     */\n    async ngAfterViewInit(): Promise<void> {\n        this.rteEnabled = await CoreDomUtils.isRichTextEditorEnabled();\n\n        await this.waitLoadingsDone();\n\n        // Setup the editor.\n        this.editorElement = this.editor?.nativeElement as HTMLDivElement;\n        this.setContent(this.control?.value);\n        this.originalContent = this.control?.value;\n        this.lastDraft = this.control?.value;\n\n        // Use paragraph on enter.\n        // eslint-disable-next-line deprecation/deprecation\n        document.execCommand('DefaultParagraphSeparator', false, 'p');\n\n        this.maximizeEditorSize();\n\n        this.setListeners();\n        this.updateToolbarButtons();\n\n        if (this.elementId) {\n            // Prepend elementId with 'id_' like in web. Don't use a setter for this because the value shouldn't change.\n            this.elementId = 'id_' + this.elementId;\n            this.element.setAttribute('id', this.elementId);\n        }\n\n        // Update tags for a11y.\n        this.replaceTags(['b', 'i'], ['strong', 'em']);\n\n        if (this.shouldAutoSaveDrafts()) {\n            this.restoreDraft();\n\n            this.autoSaveDrafts();\n\n            this.deleteDraftOnSubmitOrCancel();\n        }\n\n        const ionItem = this.element.closest<HTMLIonItemElement>('ion-item');\n        if (!ionItem) {\n            return;\n        }\n        ionItem.classList.add('item-rte');\n\n        const label = ionItem.querySelector('ion-label');\n\n        if (!label) {\n            return;\n        }\n\n        const updateArialabelledBy = () => this.ariaLabelledBy = label.getAttribute('id') ?? undefined;\n\n        this.labelObserver = new MutationObserver(updateArialabelledBy);\n        this.labelObserver.observe(label, { attributes: true, attributeFilter: ['id'] });\n\n        updateArialabelledBy();\n    }\n\n    /**\n     * Set listeners and observers.\n     */\n    protected setListeners(): void {\n        // Listen for changes on the control to update the editor (if it is updated from outside of this component).\n        this.valueChangeSubscription = this.control?.valueChanges.subscribe((newValue) => {\n            if (this.draftWasRestored && this.originalContent == newValue) {\n                // A draft was restored and the content hasn't changed in the site. Use the draft value instead of this one.\n                this.control?.setValue(this.lastDraft, { emitEvent: false });\n\n                return;\n            }\n\n            // Apply the new content.\n            this.setContent(newValue);\n            this.originalContent = newValue;\n            this.infoMessage = undefined;\n\n            // Save a draft so the original content is saved.\n            this.lastDraft = newValue;\n            CoreEditorOffline.saveDraft(\n                this.contextLevel || '',\n                this.contextInstanceId || 0,\n                this.elementId || '',\n                this.draftExtraParams || {},\n                this.pageInstance,\n                newValue,\n                newValue,\n            );\n        });\n\n        this.resizeListener = CoreDom.onWindowResize(() => {\n            this.windowResized();\n        }, 50);\n\n        document.addEventListener('selectionchange', this.selectionChangeFunction = () => this.updateToolbarStyles());\n\n        this.keyboardObserver = CoreEvents.on(CoreEvents.KEYBOARD_CHANGE, () => {\n            // Opening or closing the keyboard also calls the resize function, but sometimes the resize is called too soon.\n            // Check the height again, now the window height should have been updated.\n            this.maximizeEditorSize();\n        });\n\n        // Change the side when the language changes.\n        this.languageChangedSubscription = Translate.onLangChange.subscribe(() => {\n            setTimeout(() => {\n                this.toolbarSlides?.changeLanguageDirection(CorePlatform.isRTL ? 'rtl' : 'ltr');\n            });\n        });\n    }\n\n    /**\n     * Handle keydown events in the editor.\n     *\n     * @param event Event\n     */\n    onKeyDown(event: KeyboardEvent): void {\n        this.onChange();\n\n        const shortcutId = this.getShortcutId(event);\n        const commands = this.getShortcutCommands();\n        const command = commands[shortcutId];\n\n        if (!command) {\n            return;\n        }\n\n        this.stopBubble(event);\n        this.executeCommand(command);\n    }\n\n    /**\n     * Resize editor to maximize the space occupied.\n     */\n    protected async maximizeEditorSize(): Promise<void> {\n        // Editor is ready, adjust Height if needed.\n        const blankHeight = await this.getBlankHeightInContent();\n        const newHeight = blankHeight + this.element.getBoundingClientRect().height;\n\n        if (newHeight > this.minHeight) {\n            this.element.style.setProperty('--core-rte-height', (newHeight - 1)  + 'px');\n        } else {\n            this.element.style.removeProperty('--core-rte-height');\n        }\n    }\n\n    /**\n     * Wait until all <core-loading> children inside the page.\n     *\n     * @returns Promise resolved when loadings are done.\n     */\n    protected async waitLoadingsDone(): Promise<void> {\n        this.domPromise = CoreDom.waitToBeInDOM(this.element);\n\n        await this.domPromise;\n\n        const page = this.element.closest('.ion-page');\n        if (!page) {\n            return;\n        }\n\n        await CoreDirectivesRegistry.waitDirectivesReady(page, 'core-loading', CoreLoadingComponent);\n    }\n\n    /**\n     * Get the height of the space in blank at the end of the page.\n     *\n     * @returns Blank height in px. Will be negative if no blank space.\n     */\n    protected async getBlankHeightInContent(): Promise<number> {\n        await CoreUtils.nextTicks(5); // Ensure content is completely loaded in the DOM.\n\n        let content: Element | null = this.element.closest('ion-content');\n        const contentHeight = await CoreDomUtils.getContentHeight(this.content);\n\n        // Get first children with content, not fixed.\n        let scrollContentHeight = 0;\n        while (scrollContentHeight == 0 && content?.children) {\n            const children = Array.from(content.children)\n                .filter((element) => element.slot !== 'fixed' && !element.classList.contains('core-loading-container'));\n\n            scrollContentHeight = children\n                .map((element) => element.getBoundingClientRect().height)\n                .reduce((a,b) => a + b, 0);\n\n            content = children[0];\n        }\n\n        return contentHeight - scrollContentHeight;\n    }\n\n    /**\n     * On change function to sync with form data.\n     */\n    onChange(): void {\n        if (this.rteEnabled) {\n            if (!this.editorElement) {\n                return;\n            }\n\n            if (this.isNullOrWhiteSpace(this.editorElement.textContent)) {\n                this.clearText();\n            } else {\n                // The textarea and the form control must receive the original URLs.\n                this.restoreExternalContent();\n                // Don't emit event so our valueChanges doesn't get notified by this change.\n                this.control?.setValue(this.editorElement.innerHTML, { emitEvent: false });\n                this.control?.markAsDirty();\n                if (this.textarea) {\n                    this.textarea.value = this.editorElement.innerHTML;\n                }\n                // Treat URLs again for the editor.\n                this.treatExternalContent();\n            }\n        } else {\n            if (!this.textarea) {\n                return;\n            }\n\n            if (this.isNullOrWhiteSpace(this.textarea.value || '')) {\n                this.clearText();\n            } else {\n                // Don't emit event so our valueChanges doesn't get notified by this change.\n                this.control?.setValue(this.textarea.value, { emitEvent: false });\n                this.control?.markAsDirty();\n            }\n        }\n\n        this.contentChanged.emit(this.control?.value);\n    }\n\n    /**\n     * Set the caret position on the character number.\n     *\n     * @param parent Parent where to set the position.\n     * @param chars Number of chars where to place the caret. If not defined it will go to the end.\n     */\n    protected setCurrentCursorPosition(parent: Node, chars?: number): void {\n        /**\n         * Loops round all the child text nodes within the supplied node and sets a range from the start of the initial node to\n         * the characters.\n         *\n         * @param node Node where to start.\n         * @param range Previous calculated range.\n         * @param chars Object with counting of characters (input-output param).\n         * @param chars.count Count of characters.\n         * @returns Selection range.\n         */\n        const setRange = (node: Node, range: Range, chars: { count: number }): Range => {\n            if (chars.count === 0) {\n                range.setEnd(node, 0);\n            } else if (node && chars.count > 0) {\n                if (node.hasChildNodes()) {\n                    // Navigate through children.\n                    for (let lp = 0; lp < node.childNodes.length; lp++) {\n                        range = setRange(node.childNodes[lp], range, chars);\n\n                        if (chars.count === 0) {\n                            break;\n                        }\n                    }\n                } else if ((node.textContent || '').length < chars.count) {\n                    // Jump this node.\n                    // @todo empty nodes will be omitted.\n                    chars.count -= (node.textContent || '').length;\n                } else {\n                    // The cursor will be placed in this element.\n                    range.setEnd(node, chars.count);\n                    chars.count = 0;\n                }\n            }\n\n            return range;\n        };\n\n        let range = document.createRange();\n        if (chars === undefined) {\n            // Select all so it will go to the end.\n            range.selectNode(parent);\n            range.selectNodeContents(parent);\n        } else if (chars < 0 || chars > (parent.textContent || '').length) {\n            return;\n        } else {\n            range.selectNode(parent);\n            range.setStart(parent, 0);\n            range = setRange(parent, range, { count: chars });\n        }\n\n        if (range) {\n            const selection = window.getSelection();\n            range.collapse(false);\n            selection?.removeAllRanges();\n            selection?.addRange(range);\n        }\n    }\n\n    /**\n     * Toggle from rte editor to textarea syncing values.\n     *\n     * @param event The event.\n     */\n    async toggleEditor(event: Event): Promise<void> {\n        if (event.type == 'keyup' && !this.isValidKeyboardKey(<KeyboardEvent>event)) {\n            return;\n        }\n\n        this.stopBubble(event);\n\n        this.setContent(this.control?.value || '');\n\n        this.rteEnabled = !this.rteEnabled;\n\n        // Set focus and cursor at the end.\n        // Modify the DOM directly so the keyboard stays open.\n        if (this.rteEnabled) {\n            // Update tags for a11y.\n            this.replaceTags(['b', 'i'], ['strong', 'em']);\n\n            this.editorElement?.removeAttribute('hidden');\n            const textareaInputElement = await this.textarea?.getInputElement();\n            textareaInputElement?.setAttribute('hidden', '');\n            this.editorElement?.focus();\n        } else {\n            this.editorElement?.setAttribute('hidden', '');\n            const textareaInputElement = await this.textarea?.getInputElement();\n            textareaInputElement?.removeAttribute('hidden');\n            this.textarea?.setFocus();\n        }\n    }\n\n    /**\n     * Treat elements that can contain external content.\n     * We only search for images because the editor should receive unfiltered text, so the multimedia filter won't be applied.\n     * Treating videos and audios in here is complex, so if a user manually adds one he won't be able to play it in the editor.\n     */\n    protected treatExternalContent(): void {\n        if (!CoreSites.isLoggedIn() || !this.editorElement) {\n            // Only treat external content if the user is logged in.\n            return;\n        }\n\n        const elements = Array.from(this.editorElement.querySelectorAll('img'));\n        const site = CoreSites.getCurrentSite();\n        const siteId = CoreSites.getCurrentSiteId();\n        const canDownloadFiles = !site || site.canDownloadFiles();\n        elements.forEach(async (el) => {\n            if (el.getAttribute('data-original-src')) {\n                // Already treated.\n                return;\n            }\n\n            const url = el.src;\n\n            if (!url || !CoreUrlUtils.isDownloadableUrl(url) || (!canDownloadFiles && site?.isSitePluginFileUrl(url))) {\n                // Nothing to treat.\n                return;\n            }\n\n            // Check if it's downloaded.\n            const finalUrl = await CoreFilepool.getSrcByUrl(siteId, url, this.component, this.componentId);\n\n            // Check again if it's already treated, this function can be called concurrently more than once.\n            if (!el.getAttribute('data-original-src')) {\n                el.setAttribute('data-original-src', el.src);\n                el.setAttribute('src', finalUrl);\n            }\n        });\n    }\n\n    /**\n     * Reverts changes made by treatExternalContent.\n     */\n    protected restoreExternalContent(): void {\n        if (!this.editorElement) {\n            return;\n        }\n\n        const elements = Array.from(this.editorElement.querySelectorAll('img'));\n        elements.forEach((el) => {\n            const originalUrl = el.getAttribute('data-original-src');\n            if (originalUrl) {\n                el.setAttribute('src', originalUrl);\n                el.removeAttribute('data-original-src');\n            }\n        });\n    }\n\n    /**\n     * Check if text is empty.\n     *\n     * @param value text\n     * @returns If value is null only a white space.\n     */\n    protected isNullOrWhiteSpace(value: string | null): boolean {\n        if (value == null || value === undefined) {\n            return true;\n        }\n\n        value = value.replace(/[\\n\\r]/g, '');\n        value = value.split(' ').join('');\n\n        return value.length === 0;\n    }\n\n    /**\n     * Set the content of the textarea and the editor element.\n     *\n     * @param value New content.\n     */\n    protected setContent(value: string | null): void {\n        if (!this.editorElement || !this.textarea) {\n            return;\n        }\n\n        if (this.isNullOrWhiteSpace(value)) {\n            this.editorElement.innerHTML = '<p></p>';\n            this.textarea.value = '';\n        } else {\n            this.editorElement.innerHTML = value || '';\n            this.textarea.value = value;\n            this.treatExternalContent();\n        }\n    }\n\n    /**\n     * Clear the text.\n     */\n    clearText(): void {\n        this.setContent(null);\n\n        // Don't emit event so our valueChanges doesn't get notified by this change.\n        this.control?.setValue(null, { emitEvent: false });\n\n        setTimeout(() => {\n            if (this.rteEnabled && this.editorElement) {\n                this.setCurrentCursorPosition(this.editorElement);\n            }\n        }, 1);\n    }\n\n    /**\n     * Execute an action over the selected text when a button is activated.\n     *  API docs: https://developer.mozilla.org/en-US/docs/Web/API/Document/execCommand\n     *\n     * @param event Event data\n     * @param command Command to execute.\n     * @param parameters If parameters is set to block, a formatBlock command will be performed. Otherwise it will switch the\n     *                      toolbar styles button when set.\n     */\n    buttonAction(event: Event, command: string, parameters?: string): void {\n        if (event.type == 'keyup' && !this.isValidKeyboardKey(<KeyboardEvent>event)) {\n            return;\n        }\n\n        this.stopBubble(event);\n\n        if (!command) {\n            return;\n        }\n\n        this.executeCommand({ name: command, parameters });\n    }\n\n    /**\n     * Execute an action over the selected text.\n     *  API docs: https://developer.mozilla.org/en-US/docs/Web/API/Document/execCommand\n     *\n     * @param command Editor command.\n     * @param command.name Command name.\n     * @param command.parameters Command parameters.\n     */\n    protected executeCommand({ name: command, parameters }: EditorCommand): void {\n        if (parameters == 'block') {\n            // eslint-disable-next-line deprecation/deprecation\n            document.execCommand('formatBlock', false, '<' + command + '>');\n\n            return;\n        }\n\n        if (parameters) {\n            this.toolbarStyles[parameters] = this.toolbarStyles[parameters] == 'true' ? 'false' : 'true';\n        }\n\n        // eslint-disable-next-line deprecation/deprecation\n        document.execCommand(command, false);\n\n        // Modern browsers are using non a11y tags, so replace them.\n        if (command === 'bold') {\n            this.replaceTags(['b'], ['strong']);\n        } else if (command == 'italic') {\n            this.replaceTags(['i'], ['em']);\n        }\n    }\n\n    /**\n     * Replace tags for a11y.\n     *\n     * @param originTags      Origin tags to be replaced.\n     * @param destinationTags Destination tags to replace.\n     */\n    protected replaceTags(originTags: string[], destinationTags: string[]): void {\n        if (!this.editorElement) {\n            return;\n        }\n\n        this.editorElement =\n            CoreDom.replaceTags(this.editorElement, originTags, destinationTags);\n\n        this.onChange();\n    }\n\n    /**\n     * Focus editor when click the area.\n     */\n    focusRTE(): void {\n        if (this.rteEnabled) {\n            this.editorElement?.focus();\n        } else {\n            this.textarea?.setFocus();\n        }\n    }\n\n    /**\n     * Hide the toolbar in phone mode.\n     *\n     * @param event Event.\n     * @param force If true it will not check the target of the event.\n     */\n    hideToolbar(event: Event, force = false): void {\n        if (!force && event.target && this.element.contains(event.target as HTMLElement)) {\n            // Do not hide if clicked inside the editor area, except forced.\n\n            return;\n        }\n\n        if (event.type == 'keyup' && !this.isValidKeyboardKey(<KeyboardEvent>event)) {\n            return;\n        }\n\n        this.element.classList.remove('has-focus');\n\n        this.stopBubble(event);\n\n        if (this.isPhone) {\n            this.toolbarHidden = true;\n        }\n    }\n\n    /**\n     * Checks if Space or Enter have been pressed.\n     *\n     * @param event Keyboard Event.\n     * @returns Wether space or enter have been pressed.\n     */\n    protected isValidKeyboardKey(event: KeyboardEvent): boolean {\n        return event.key === ' ' || event.key === 'Enter';\n    }\n\n    /**\n     * Show the toolbar.\n     */\n    showToolbar(event: Event): void {\n        this.updateToolbarButtons();\n\n        this.element.classList.add('ion-touched');\n        this.element.classList.remove('ion-untouched');\n        this.element.classList.add('has-focus');\n\n        this.stopBubble(event);\n\n        this.editorElement?.focus();\n        this.toolbarHidden = false;\n    }\n\n    /**\n     * Stop event default and propagation.\n     *\n     * @param event Event.\n     */\n    stopBubble(event: Event): void {\n        if (event.type != 'touchend' && event.type != 'mouseup' && event.type != 'keyup') {\n            event.preventDefault();\n        }\n        event.stopPropagation();\n    }\n\n    /**\n     * When a button is clicked first we should stop event propagation, but it has some cases to not.\n     *\n     * @param event Event.\n     */\n    downAction(event: Event): void {\n        if (event.type == 'keydown' && !this.isValidKeyboardKey(<KeyboardEvent>event)) {\n            return;\n        }\n\n        const selection = window.getSelection()?.toString();\n\n        // When RTE is focused with a whole paragraph in desktop the stopBubble will not fire click.\n        if (CorePlatform.isMobile() || !this.rteEnabled || document.activeElement != this.editorElement || selection == '') {\n            this.stopBubble(event);\n        }\n    }\n\n    /**\n     * Method that shows the next toolbar buttons.\n     */\n    async toolbarNext(event: Event): Promise<void> {\n        if (event.type == 'keyup' && !this.isValidKeyboardKey(<KeyboardEvent>event)) {\n            return;\n        }\n\n        this.stopBubble(event);\n\n        if (!this.toolbarNextHidden) {\n            const currentIndex = this.toolbarSlides?.activeIndex;\n            this.toolbarSlides?.slideTo((currentIndex || 0) + this.toolbarSlides.slidesPerViewDynamic());\n        }\n\n        await this.updateToolbarArrows();\n    }\n\n    /**\n     * Method that shows the previous toolbar buttons.\n     */\n    async toolbarPrev(event: Event): Promise<void> {\n        if (event.type == 'keyup' && !this.isValidKeyboardKey(<KeyboardEvent>event)) {\n            return;\n        }\n\n        this.stopBubble(event);\n\n        if (!this.toolbarPrevHidden) {\n            const currentIndex = this.toolbarSlides?.activeIndex;\n            this.toolbarSlides?.slideTo((currentIndex || 0) - this.toolbarSlides.slidesPerViewDynamic());\n        }\n\n        await this.updateToolbarArrows();\n    }\n\n    /**\n     * Update the number of toolbar buttons displayed.\n     */\n    async updateToolbarButtons(): Promise<void> {\n        if (!this.isCurrentView || !this.toolbar || !this.toolbarSlides || this.element.offsetParent == null) {\n            // Don't calculate if component isn't in current view, the calculations are wrong.\n            return;\n        }\n\n        const length = this.toolbarSlides.slides.length;\n\n        // Cancel previous one, if any.\n        this.buttonsDomPromise?.cancel();\n        this.buttonsDomPromise = CoreDom.waitToBeInDOM(this.toolbar.nativeElement);\n        await this.buttonsDomPromise;\n\n        const width = this.toolbar.nativeElement.getBoundingClientRect().width;\n\n        if (length > 0 && width > length * this.toolbarButtonWidth) {\n            this.swiperOpts.slidesPerView = length;\n            this.toolbarArrows = false;\n        } else {\n            this.swiperOpts.slidesPerView = Math.floor((width - this.toolbarArrowWidth * 2) / this.toolbarButtonWidth);\n            this.toolbarArrows = true;\n        }\n\n        await CoreUtils.nextTick();\n\n        this.toolbarSlides.update();\n\n        await this.updateToolbarArrows();\n    }\n\n    /**\n     * Show or hide next/previous toolbar arrows.\n     */\n    async updateToolbarArrows(): Promise<void> {\n        if (!this.toolbarSlides) {\n            return;\n        }\n\n        const currentIndex = this.toolbarSlides.activeIndex;\n        const length = this.toolbarSlides.slides.length;\n        this.toolbarPrevHidden = currentIndex <= 0;\n        this.toolbarNextHidden = currentIndex + this.toolbarSlides.slidesPerViewDynamic() >= length;\n    }\n\n    /**\n     * Update highlighted toolbar styles.\n     */\n    updateToolbarStyles(): void {\n        const node = window.getSelection()?.focusNode;\n        if (!node) {\n            return;\n        }\n\n        let element = node.nodeType == 1 ? node as HTMLElement : node.parentElement;\n        const styles = {};\n\n        while (element != null && element !== this.editorElement) {\n            const tagName = element.tagName.toLowerCase();\n            if (this.toolbarStyles[tagName]) {\n                styles[tagName] = 'true';\n            }\n            element = element.parentElement;\n        }\n\n        for (const tagName in this.toolbarStyles) {\n            this.toolbarStyles[tagName] = 'false';\n        }\n\n        if (element === this.editorElement) {\n            Object.assign(this.toolbarStyles, styles);\n        }\n    }\n\n    /**\n     * Check if should auto save drafts.\n     *\n     * @returns {boolean} Whether it should auto save drafts.\n     */\n    protected shouldAutoSaveDrafts(): boolean {\n        return !!CoreSites.getCurrentSite() &&\n                (this.autoSave === undefined || CoreUtils.isTrueOrOne(this.autoSave)) &&\n                this.contextLevel !== undefined &&\n                this.contextInstanceId !== undefined &&\n                this.elementId !== undefined;\n    }\n\n    /**\n     * Restore a draft if there is any.\n     *\n     * @returns Promise resolved when done.\n     */\n    protected async restoreDraft(): Promise<void> {\n        try {\n            const entry = await CoreEditorOffline.resumeDraft(\n                this.contextLevel || '',\n                this.contextInstanceId || 0,\n                this.elementId || '',\n                this.draftExtraParams || {},\n                this.pageInstance,\n                this.originalContent,\n            );\n\n            if (entry === undefined) {\n                // No draft found.\n                return;\n            }\n\n            this.element.classList.add('ion-touched');\n            this.element.classList.remove('ion-untouched');\n\n            let draftText = entry.drafttext || '';\n\n            // Revert untouched editor contents to an empty string.\n            if (draftText == '<p></p>' || draftText == '<p><br></p>' || draftText == '<br>' ||\n                    draftText == '<p>&nbsp;</p>' || draftText == '<p><br>&nbsp;</p>') {\n                draftText = '';\n            }\n\n            if (draftText !== '' && this.control && draftText != this.control.value) {\n                // Restore the draft.\n                this.control.setValue(draftText, { emitEvent: false });\n                this.setContent(draftText);\n                this.lastDraft = draftText;\n                this.draftWasRestored = true;\n                this.originalContent = entry.originalcontent;\n\n                if (entry.drafttext != entry.originalcontent) {\n                    // Notify the user.\n                    this.showMessage('core.editor.textrecovered', this.RESTORE_MESSAGE_CLEAR_TIME);\n                }\n            }\n        } catch {\n            // Ignore errors, shouldn't happen.\n        }\n    }\n\n    /**\n     * Automatically save drafts every certain time.\n     */\n    protected autoSaveDrafts(): void {\n        this.autoSaveInterval = window.setInterval(async () => {\n            if (!this.control) {\n                return;\n            }\n\n            const newText = this.control.value;\n\n            if (this.lastDraft == newText) {\n                // Text hasn't changed, nothing to save.\n                return;\n            }\n\n            try {\n                await CoreEditorOffline.saveDraft(\n                    this.contextLevel || '',\n                    this.contextInstanceId || 0,\n                    this.elementId || '',\n                    this.draftExtraParams || {},\n                    this.pageInstance,\n                    newText,\n                    this.originalContent,\n                );\n\n                // Draft saved, notify the user.\n                this.lastDraft = newText;\n                this.showMessage('core.editor.autosavesucceeded', this.SAVE_MESSAGE_CLEAR_TIME);\n            } catch (error) {\n                // Error saving draft.\n            }\n        }, this.DRAFT_AUTOSAVE_FREQUENCY);\n    }\n\n    /**\n     * Delete the draft when the form is submitted or cancelled.\n     */\n    protected deleteDraftOnSubmitOrCancel(): void {\n        this.resetObserver = CoreEvents.on(CoreEvents.FORM_ACTION, async (data: CoreEventFormActionData) => {\n            const form = this.element.closest('form');\n\n            if (data.form && form && data.form == form) {\n                try {\n                    await CoreEditorOffline.deleteDraft(\n                        this.contextLevel || '',\n                        this.contextInstanceId || 0,\n                        this.elementId || '',\n                        this.draftExtraParams || {},\n                    );\n                } catch (error) {\n                    // Error deleting draft. Shouldn't happen.\n                }\n            }\n        }, CoreSites.getCurrentSiteId());\n    }\n\n    /**\n     * Show a message.\n     *\n     * @param message Identifier of the message to display.\n     * @param timeout Number of milliseconds when to remove the message.\n     */\n    protected showMessage(message: string, timeout: number): void {\n        clearTimeout(this.hideMessageTimeout);\n\n        this.infoMessage = message;\n\n        this.hideMessageTimeout = window.setTimeout(() => {\n            this.hideMessageTimeout = undefined;\n            this.infoMessage = undefined;\n        }, timeout);\n    }\n\n    /**\n     * Scan a QR code and put its text in the editor.\n     *\n     * @param event Event data\n     * @returns Promise resolved when done.\n     */\n    async scanQR(event: Event): Promise<void> {\n        if (event.type == 'keyup' && !this.isValidKeyboardKey(<KeyboardEvent>event)) {\n            return;\n        }\n\n        this.stopBubble(event);\n\n        // Scan for a QR code.\n        const text = await CoreUtils.scanQR();\n\n        if (text) {\n            this.editorElement?.focus(); // Make sure the editor is focused.\n            // eslint-disable-next-line deprecation/deprecation\n            document.execCommand('insertText', false, text);\n        }\n    }\n\n    /**\n     * Window resized.\n     */\n    protected async windowResized(): Promise<void> {\n        await CoreDomUtils.waitForResizeDone();\n        this.isPhone = CoreScreen.isMobile;\n\n        this.maximizeEditorSize();\n        this.updateToolbarButtons();\n    }\n\n    /**\n     * User entered the page that contains the component.\n     */\n    ionViewDidEnter(): void {\n        this.isCurrentView = true;\n\n        this.updateToolbarButtons();\n    }\n\n    /**\n     * User left the page that contains the component.\n     */\n    ionViewDidLeave(): void {\n        this.isCurrentView = false;\n    }\n\n    /**\n     * @inheritdoc\n     */\n    ngOnDestroy(): void {\n        this.valueChangeSubscription?.unsubscribe();\n        this.languageChangedSubscription?.unsubscribe();\n        this.selectionChangeFunction && document.removeEventListener('selectionchange', this.selectionChangeFunction);\n        clearInterval(this.initHeightInterval);\n        clearInterval(this.autoSaveInterval);\n        clearTimeout(this.hideMessageTimeout);\n        this.resetObserver?.off();\n        this.keyboardObserver?.off();\n        this.labelObserver?.disconnect();\n        this.resizeListener?.off();\n        this.domPromise?.cancel();\n        this.buttonsDomPromise?.cancel();\n    }\n\n    /**\n     * Get commands triggered by keyboard shortcuts.\n     *\n     * @returns Commands dictionary indexed by their corresponding keyboard shortcut id.\n     */\n    getShortcutCommands(): Record<string, EditorCommand> {\n        if (!this.shortcutCommands) {\n            const isIOS = CorePlatform.isIOS();\n            const metaKey = isIOS ? 'metaKey' : 'ctrlKey';\n            const shiftKey = isIOS ? 'ctrlKey' : 'shiftKey';\n\n            // Same shortcuts as TinyMCE:\n            // @see https://www.tiny.cloud/docs/advanced/keyboard-shortcuts/\n            const shortcuts: { code: string; modifiers: (keyof KeyboardShortcut)[]; command: EditorCommand }[] = [\n                {\n                    code: 'KeyB',\n                    modifiers: [metaKey],\n                    command: {\n                        name: 'bold',\n                        parameters: 'strong',\n                    },\n                },\n                {\n                    code: 'KeyI',\n                    modifiers: [metaKey],\n                    command: {\n                        name: 'italic',\n                        parameters: 'em',\n                    },\n                },\n                {\n                    code: 'KeyU',\n                    modifiers: [metaKey],\n                    command: {\n                        name: 'underline',\n                        parameters: 'u',\n                    },\n                },\n                {\n                    code: 'Digit3',\n                    modifiers: ['altKey', shiftKey],\n                    command: {\n                        name: 'h3',\n                        parameters: 'block',\n                    },\n                },\n                {\n                    code: 'Digit4',\n                    modifiers: ['altKey', shiftKey],\n                    command: {\n                        name: 'h4',\n                        parameters: 'block',\n                    },\n                },\n                {\n                    code: 'Digit5',\n                    modifiers: ['altKey', shiftKey],\n                    command: {\n                        name: 'h5',\n                        parameters: 'block',\n                    },\n                },\n                {\n                    code: 'Digit7',\n                    modifiers: ['altKey', shiftKey],\n                    command: {\n                        name: 'p',\n                        parameters: 'block',\n                    },\n                },\n            ];\n\n            this.shortcutCommands = shortcuts.reduce((shortcuts, { code, modifiers, command }) => {\n                const id = this.getShortcutId({\n                    code: code,\n                    altKey: modifiers.includes('altKey'),\n                    metaKey: modifiers.includes('metaKey'),\n                    shiftKey: modifiers.includes('shiftKey'),\n                    ctrlKey: modifiers.includes('ctrlKey'),\n                });\n\n                shortcuts[id] = command;\n\n                return shortcuts;\n            }, {} as Record<string, EditorCommand>);\n        }\n\n        return this.shortcutCommands;\n    }\n\n    /**\n     * Get a unique identifier for a given keyboard shortcut.\n     *\n     * @param shortcut Shortcut.\n     * @returns Identifier.\n     */\n    protected getShortcutId(shortcut: KeyboardShortcut): string {\n        return (shortcut.altKey ? '1' : '0')\n            + (shortcut.metaKey ? '1' : '0')\n            + (shortcut.shiftKey ? '1' : '0')\n            + (shortcut.ctrlKey ? '1' : '0')\n            + shortcut.code;\n    }\n\n}\n\n/**\n * Combination\n */\ntype KeyboardShortcut = Pick<KeyboardEvent, 'code' | 'altKey' | 'metaKey' | 'ctrlKey' | 'shiftKey'>;\n\n/**\n * Editor command.\n */\ninterface EditorCommand {\n    name: string;\n    parameters?: string;\n}\n","<div class=\"core-rte-editor-container\" (click)=\"focusRTE()\" [class.toolbar-hidden]=\"toolbarHidden\">\n    <div [hidden]=\"!rteEnabled\" #editor class=\"core-rte-editor\" role=\"textbox\" contenteditable=\"true\"\n        [attr.aria-labelledby]=\"ariaLabelledBy\" [attr.data-placeholder-text]=\"placeholder\" (focus)=\"showToolbar($event)\"\n        (blur)=\"hideToolbar($event)\" (keydown)=\"onKeyDown($event)\" (keyup)=\"onChange()\" (change)=\"onChange()\" (paste)=\"onChange()\"\n        (input)=\"onChange()\">\n    </div>\n\n    <ion-textarea [hidden]=\"rteEnabled\" #textarea class=\"core-textarea\" role=\"textbox\" [attr.name]=\"name\" ngControl=\"control\"\n        [placeholder]=\"placeholder\" (ionChange)=\"onChange()\" (ionFocus)=\"showToolbar($event)\" (ionBlur)=\"hideToolbar($event)\" />\n\n    <div class=\"core-rte-info-message\" *ngIf=\"infoMessage\">\n        <ion-icon name=\"fas-circle-info\" aria-hidden=\"true\" />\n        {{ infoMessage | translate }}\n    </div>\n</div>\n\n<div #toolbar class=\"core-rte-toolbar\" [class.toolbar-hidden]=\"toolbarHidden\">\n    <button *ngIf=\"toolbarArrows\" class=\"toolbar-arrow\" [attr.disabled]=\"toolbarPrevHidden ? 'true' : null\" (click)=\"toolbarPrev($event)\"\n        (keyup)=\"toolbarPrev($event)\" (mousedown)=\"downAction($event)\" (keydown)=\"downAction($event)\"\n        [attr.aria-label]=\"'core.previous' | translate\" [tabindex]=\"toolbarPrevHidden ? -1 : 0\">\n        <ion-icon name=\"fas-chevron-left\" aria-hidden=\"true\" />\n    </button>\n    <swiper-container #swiperRef [slidesPerView]=\"swiperOpts.slidesPerView\" (slidechangetransitionend)=\"updateToolbarArrows()\">\n        <!-- https://developer.mozilla.org/en-US/docs/Web/API/Document/execCommand -->\n        <swiper-slide>\n            <button [disabled]=\"!rteEnabled\" [attr.aria-pressed]=\"toolbarStyles.strong\" [title]=\"'core.editor.bold' | translate\"\n                (click)=\"buttonAction($event, 'bold', 'strong')\" (keyup)=\"buttonAction($event, 'bold', 'strong')\"\n                (mousedown)=\"downAction($event)\" (keydown)=\"downAction($event)\" tabindex=\"0\">\n                <ion-icon name=\"fas-bold\" aria-hidden=\"true\" />\n            </button>\n        </swiper-slide>\n        <swiper-slide>\n            <button [disabled]=\"!rteEnabled\" [attr.aria-pressed]=\"toolbarStyles.em\" [title]=\"'core.editor.italic' | translate\"\n                (click)=\"buttonAction($event, 'italic', 'em')\" (keyup)=\"buttonAction($event, 'italic', 'em')\"\n                (mousedown)=\"downAction($event)\" (keydown)=\"downAction($event)\" tabindex=\"0\">\n                <ion-icon name=\"fas-italic\" aria-hidden=\"true\" />\n            </button>\n        </swiper-slide>\n        <swiper-slide>\n            <button [disabled]=\"!rteEnabled\" [attr.aria-pressed]=\"toolbarStyles.u\" [title]=\"'core.editor.underline' | translate\"\n                (click)=\"buttonAction($event, 'underline', 'u')\" (keyup)=\"buttonAction($event, 'underline', 'u')\"\n                (mousedown)=\"downAction($event)\" (keydown)=\"downAction($event)\" tabindex=\"0\">\n                <ion-icon name=\"fas-underline\" aria-hidden=\"true\" />\n            </button>\n        </swiper-slide>\n        <swiper-slide>\n            <button [disabled]=\"!rteEnabled\" [attr.aria-pressed]=\"toolbarStyles.strike\" [title]=\"'core.editor.strikethrough' | translate\"\n                (click)=\"buttonAction($event, 'strikethrough', 'strike')\" (keyup)=\"buttonAction($event, 'strikethrough', 'strike')\"\n                (mousedown)=\"downAction($event)\" (keydown)=\"downAction($event)\" tabindex=\"0\">\n                <ion-icon name=\"fas-strikethrough\" aria-hidden=\"true\" />\n            </button>\n        </swiper-slide>\n        <swiper-slide>\n            <button [disabled]=\"!rteEnabled\" [attr.aria-pressed]=\"toolbarStyles.p\" [title]=\"'core.editor.p' | translate\"\n                (click)=\"buttonAction($event, 'p', 'block')\" (keyup)=\"buttonAction($event, 'p', 'block')\" (mousedown)=\"downAction($event)\"\n                (keydown)=\"downAction($event)\" tabindex=\"0\">\n                <ion-icon name=\"fas-paragraph\" aria-hidden=\"true\" />\n            </button>\n        </swiper-slide>\n        <swiper-slide>\n            <button [disabled]=\"!rteEnabled\" [attr.aria-pressed]=\"toolbarStyles.h3\" [title]=\"'core.editor.h3' | translate\"\n                (click)=\"buttonAction($event, 'h3', 'block')\" (keyup)=\"buttonAction($event, 'h3', 'block')\" (mousedown)=\"downAction($event)\"\n                (keydown)=\"downAction($event)\" tabindex=\"0\">\n                <ion-icon name=\"fas-heading\" aria-hidden=\"true\" /><span aria-hidden=\"true\">3</span>\n            </button>\n        </swiper-slide>\n        <swiper-slide>\n            <button [disabled]=\"!rteEnabled\" [attr.aria-pressed]=\"toolbarStyles.h4\" [title]=\"'core.editor.h4' | translate\"\n                (click)=\"buttonAction($event, 'h4', 'block')\" (keyup)=\"buttonAction($event, 'h4', 'block')\" (mousedown)=\"downAction($event)\"\n                (keydown)=\"downAction($event)\" tabindex=\"0\">\n                <ion-icon name=\"fas-heading\" aria-hidden=\"true\" /><span aria-hidden=\"true\">4</span>\n            </button>\n        </swiper-slide>\n        <swiper-slide>\n            <button [disabled]=\"!rteEnabled\" [attr.aria-pressed]=\"toolbarStyles.h5\" [title]=\"'core.editor.h5' | translate\"\n                (click)=\"buttonAction($event, 'h5', 'block')\" (keyup)=\"buttonAction($event, 'h5', 'block')\" (mousedown)=\"downAction($event)\"\n                (keydown)=\"downAction($event)\" tabindex=\"0\">\n                <ion-icon name=\"fas-heading\" aria-hidden=\"true\" /><span aria-hidden=\"true\">5</span>\n            </button>\n        </swiper-slide>\n        <swiper-slide>\n            <button [disabled]=\"!rteEnabled\" [attr.aria-pressed]=\"toolbarStyles.ul\" [title]=\"'core.editor.unorderedlist' | translate\"\n                (click)=\"buttonAction($event, 'insertUnorderedList')\" (mousedown)=\"downAction($event)\" (keydown)=\"downAction($event)\"\n                tabindex=\"0\">\n                <ion-icon name=\"fas-list-ul\" aria-hidden=\"true\" />\n            </button>\n        </swiper-slide>\n        <swiper-slide>\n            <button [disabled]=\"!rteEnabled\" [attr.aria-pressed]=\"toolbarStyles.ol\" [title]=\"'core.editor.orderedlist' | translate\"\n                (click)=\"buttonAction($event, 'insertOrderedList')\" (keyup)=\"buttonAction($event, 'insertOrderedList')\"\n                (mousedown)=\"downAction($event)\" (keydown)=\"downAction($event)\" tabindex=\"0\">\n                <ion-icon name=\"fas-list-ol\" aria-hidden=\"true\" />\n            </button>\n        </swiper-slide>\n        <swiper-slide>\n            <button [disabled]=\"!rteEnabled\" (click)=\"buttonAction($event, 'removeFormat')\" (keyup)=\"buttonAction($event, 'removeFormat')\"\n                (mousedown)=\"downAction($event)\" (keydown)=\"downAction($event)\" [title]=\"'core.editor.clear' | translate\">\n                <ion-icon name=\"fas-eraser\" aria-hidden=\"true\" />\n            </button>\n        </swiper-slide>\n        <swiper-slide *ngIf=\"canScanQR\">\n            <button [disabled]=\"!rteEnabled\" (click)=\"scanQR($event)\" (keyup)=\"scanQR($event)\" (mousedown)=\"stopBubble($event)\"\n                (keydown)=\"stopBubble($event)\" [title]=\"'core.scanqr' | translate\">\n                <ion-icon name=\"fas-qrcode\" aria-hidden=\"true\" />\n            </button>\n        </swiper-slide>\n        <swiper-slide>\n            <button [attr.aria-pressed]=\"!rteEnabled\" [title]=\"'core.editor.toggle' | translate\" (click)=\"toggleEditor($event)\"\n                (keyup)=\"toggleEditor($event)\" (mousedown)=\"downAction($event)\" (keydown)=\"downAction($event)\" tabindex=\"0\">\n                <ion-icon name=\"fas-code\" aria-hidden=\"true\" />\n            </button>\n        </swiper-slide>\n        <swiper-slide *ngIf=\"isPhone\">\n            <button [title]=\"'core.editor.hidetoolbar' | translate\" (click)=\"hideToolbar($event, true)\" (keyup)=\"hideToolbar($event, true)\"\n                (mousedown)=\"downAction($event)\" (keydown)=\"downAction($event)\" tabindex=\"0\">\n                <ion-icon name=\"fas-xmark\" aria-hidden=\"true\" />\n            </button>\n        </swiper-slide>\n    </swiper-container>\n    <button *ngIf=\"toolbarArrows\" class=\"toolbar-arrow\" [attr.disabled]=\"toolbarNextHidden ? 'true' : null\"\n        [attr.aria-label]=\"'core.next' | translate\" (click)=\"toolbarNext($event)\" (keyup)=\"toolbarNext($event)\"\n        (mousedown)=\"downAction($event)\" (keydown)=\"downAction($event)\" [tabindex]=\"toolbarNextHidden ? -1 : 0\">\n        <ion-icon name=\"fas-chevron-right\" aria-hidden=\"true\" />\n    </button>\n</div>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
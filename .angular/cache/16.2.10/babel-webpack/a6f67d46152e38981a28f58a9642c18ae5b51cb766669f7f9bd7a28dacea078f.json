{"ast":null,"code":"// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nimport { CoreSites } from '@services/sites';\nimport { CoreUserSupportConfig } from './support-config';\n/**\n * Support config for an authenticated user.\n */\nexport class CoreUserAuthenticatedSupportConfig extends CoreUserSupportConfig {\n  /**\n   * Get config for the current site.\n   *\n   * @returns Support config.\n   */\n  static forCurrentSite() {\n    return new CoreUserAuthenticatedSupportConfig(CoreSites.getRequiredCurrentSite());\n  }\n  constructor(site) {\n    super();\n    this.site = site;\n  }\n  /**\n   * @inheritdoc\n   */\n  canContactSupport() {\n    if (this.site.isFeatureDisabled('NoDelegate_CoreUserSupport')) {\n      return false;\n    }\n    if (this.site.isVersionGreaterEqualThan('4.1')) {\n      if (!('config' in this.site) || !this.site.config || !('supportavailability' in this.site.config)) {\n        return false;\n      }\n      const supportAvailability = Number(this.site.config.supportavailability);\n      return supportAvailability === 1 /* CoreSiteConfigSupportAvailability.Authenticated */ || supportAvailability === 2 /* CoreSiteConfigSupportAvailability.Anyone */;\n    }\n\n    if (this.site.isVersionGreaterEqualThan('4.0')) {\n      // This feature was always available in 4.0.\n      return true;\n    }\n    // This feature wasn't available before 4.0.\n    return false;\n  }\n  /**\n   * @inheritdoc\n   */\n  getSupportPageLang() {\n    var _this$site$infos$lang, _this$site$infos;\n    return (_this$site$infos$lang = (_this$site$infos = this.site.infos) === null || _this$site$infos === void 0 ? void 0 : _this$site$infos.lang) !== null && _this$site$infos$lang !== void 0 ? _this$site$infos$lang : null;\n  }\n  /**\n   * @inheritdoc\n   */\n  buildSupportPageUrl() {\n    var _config$supportpage, _ref, _config$httpswwwroot;\n    const config = 'config' in this.site ? this.site.config : undefined;\n    return (config === null || config === void 0 || (_config$supportpage = config.supportpage) === null || _config$supportpage === void 0 ? void 0 : _config$supportpage.trim()) || `${(_ref = (_config$httpswwwroot = config === null || config === void 0 ? void 0 : config.httpswwwroot) !== null && _config$httpswwwroot !== void 0 ? _config$httpswwwroot : config === null || config === void 0 ? void 0 : config.wwwroot) !== null && _ref !== void 0 ? _ref : this.site.siteUrl}/user/contactsitesupport.php`;\n  }\n}","map":{"version":3,"names":["CoreSites","CoreUserSupportConfig","CoreUserAuthenticatedSupportConfig","forCurrentSite","getRequiredCurrentSite","constructor","site","canContactSupport","isFeatureDisabled","isVersionGreaterEqualThan","config","supportAvailability","Number","supportavailability","getSupportPageLang","_this$site$infos$lang","_this$site$infos","infos","lang","buildSupportPageUrl","_config$supportpage","_ref","_config$httpswwwroot","undefined","supportpage","trim","httpswwwroot","wwwroot","siteUrl"],"sources":["/home/toon/works/gitionic7/ionic-github/ionic/src/core/features/user/classes/support/authenticated-support-config.ts"],"sourcesContent":["// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { CoreSite } from '@classes/sites/site';\nimport { CoreSites } from '@services/sites';\nimport { CoreUserSupportConfig } from './support-config';\nimport { CoreSiteConfigSupportAvailability } from '@classes/sites/unauthenticated-site';\nimport { CoreAuthenticatedSite } from '@classes/sites/authenticated-site';\n\n/**\n * Support config for an authenticated user.\n */\nexport class CoreUserAuthenticatedSupportConfig extends CoreUserSupportConfig {\n\n    /**\n     * Get config for the current site.\n     *\n     * @returns Support config.\n     */\n    static forCurrentSite(): CoreUserAuthenticatedSupportConfig {\n        return new CoreUserAuthenticatedSupportConfig(CoreSites.getRequiredCurrentSite());\n    }\n\n    private site: CoreSite | CoreAuthenticatedSite;\n\n    constructor(site: CoreSite | CoreAuthenticatedSite) {\n        super();\n\n        this.site = site;\n    }\n\n    /**\n     * @inheritdoc\n     */\n    canContactSupport(): boolean {\n        if (this.site.isFeatureDisabled('NoDelegate_CoreUserSupport')) {\n            return false;\n        }\n\n        if (this.site.isVersionGreaterEqualThan('4.1')) {\n            if (!('config' in this.site) || !this.site.config || !('supportavailability' in this.site.config)) {\n                return false;\n            }\n\n            const supportAvailability = Number(this.site.config.supportavailability);\n\n            return supportAvailability === CoreSiteConfigSupportAvailability.Authenticated\n                || supportAvailability === CoreSiteConfigSupportAvailability.Anyone;\n        }\n\n        if (this.site.isVersionGreaterEqualThan('4.0')) {\n            // This feature was always available in 4.0.\n            return true;\n        }\n\n        // This feature wasn't available before 4.0.\n        return false;\n    }\n\n    /**\n     * @inheritdoc\n     */\n    getSupportPageLang(): string | null {\n        return this.site.infos?.lang ?? null;\n    }\n\n    /**\n     * @inheritdoc\n     */\n    protected buildSupportPageUrl(): string {\n        const config = 'config' in this.site ? this.site.config : undefined;\n\n        return config?.supportpage?.trim()\n            || `${config?.httpswwwroot ?? config?.wwwroot ?? this.site.siteUrl}/user/contactsitesupport.php`;\n    }\n\n}\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA,SAASA,SAAS,QAAQ,iBAAiB;AAC3C,SAASC,qBAAqB,QAAQ,kBAAkB;AAIxD;;;AAGA,OAAM,MAAOC,kCAAmC,SAAQD,qBAAqB;EAEzE;;;;;EAKA,OAAOE,cAAcA,CAAA;IACjB,OAAO,IAAID,kCAAkC,CAACF,SAAS,CAACI,sBAAsB,EAAE,CAAC;EACrF;EAIAC,YAAYC,IAAsC;IAC9C,KAAK,EAAE;IAEP,IAAI,CAACA,IAAI,GAAGA,IAAI;EACpB;EAEA;;;EAGAC,iBAAiBA,CAAA;IACb,IAAI,IAAI,CAACD,IAAI,CAACE,iBAAiB,CAAC,4BAA4B,CAAC,EAAE;MAC3D,OAAO,KAAK;;IAGhB,IAAI,IAAI,CAACF,IAAI,CAACG,yBAAyB,CAAC,KAAK,CAAC,EAAE;MAC5C,IAAI,EAAE,QAAQ,IAAI,IAAI,CAACH,IAAI,CAAC,IAAI,CAAC,IAAI,CAACA,IAAI,CAACI,MAAM,IAAI,EAAE,qBAAqB,IAAI,IAAI,CAACJ,IAAI,CAACI,MAAM,CAAC,EAAE;QAC/F,OAAO,KAAK;;MAGhB,MAAMC,mBAAmB,GAAGC,MAAM,CAAC,IAAI,CAACN,IAAI,CAACI,MAAM,CAACG,mBAAmB,CAAC;MAExE,OAAOF,mBAAmB,gEACnBA,mBAAmB;;;IAG9B,IAAI,IAAI,CAACL,IAAI,CAACG,yBAAyB,CAAC,KAAK,CAAC,EAAE;MAC5C;MACA,OAAO,IAAI;;IAGf;IACA,OAAO,KAAK;EAChB;EAEA;;;EAGAK,kBAAkBA,CAAA;IAAA,IAAAC,qBAAA,EAAAC,gBAAA;IACd,QAAAD,qBAAA,IAAAC,gBAAA,GAAO,IAAI,CAACV,IAAI,CAACW,KAAK,cAAAD,gBAAA,uBAAfA,gBAAA,CAAiBE,IAAI,cAAAH,qBAAA,cAAAA,qBAAA,GAAI,IAAI;EACxC;EAEA;;;EAGUI,mBAAmBA,CAAA;IAAA,IAAAC,mBAAA,EAAAC,IAAA,EAAAC,oBAAA;IACzB,MAAMZ,MAAM,GAAG,QAAQ,IAAI,IAAI,CAACJ,IAAI,GAAG,IAAI,CAACA,IAAI,CAACI,MAAM,GAAGa,SAAS;IAEnE,OAAO,CAAAb,MAAM,aAANA,MAAM,gBAAAU,mBAAA,GAANV,MAAM,CAAEc,WAAW,cAAAJ,mBAAA,uBAAnBA,mBAAA,CAAqBK,IAAI,EAAE,KAC3B,IAAAJ,IAAA,IAAAC,oBAAA,GAAGZ,MAAM,aAANA,MAAM,uBAANA,MAAM,CAAEgB,YAAY,cAAAJ,oBAAA,cAAAA,oBAAA,GAAIZ,MAAM,aAANA,MAAM,uBAANA,MAAM,CAAEiB,OAAO,cAAAN,IAAA,cAAAA,IAAA,GAAI,IAAI,CAACf,IAAI,CAACsB,OAAO,8BAA8B;EACxG"},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"import _asyncToGenerator from \"/home/toon/works/gitionic7/ionic-github/ionic/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _class;\nimport { AddonModAssign, AddonModAssignProvider } from '@addons/mod/assign/services/assign';\nimport { CoreTextUtils } from '@services/utils/text';\nimport { AddonModAssignFeedbackCommentsHandler } from '../services/handler';\nimport { AddonModAssignFeedbackDelegate } from '@addons/mod/assign/services/feedback-delegate';\nimport { AddonModAssignOffline } from '@addons/mod/assign/services/assign-offline';\nimport { CoreUtils } from '@services/utils/utils';\nimport { AddonModAssignFeedbackPluginBaseComponent } from '@addons/mod/assign/classes/base-feedback-plugin-component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nfunction AddonModAssignFeedbackCommentsComponent_ion_item_0_ion_button_8_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-button\", 7);\n    i0.ɵɵlistener(\"click\", function AddonModAssignFeedbackCommentsComponent_ion_item_0_ion_button_8_Template_ion_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r4 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r4.editComment());\n    });\n    i0.ɵɵpipe(1, \"translate\");\n    i0.ɵɵelement(2, \"ion-icon\", 8);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵattribute(\"aria-label\", i0.ɵɵpipeBind1(1, 1, \"core.edit\"));\n  }\n}\nfunction AddonModAssignFeedbackCommentsComponent_ion_item_0_ion_note_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-note\", 9);\n    i0.ɵɵelement(1, \"ion-icon\", 10);\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(3, 1, \"core.notsent\"), \" \");\n  }\n}\nfunction AddonModAssignFeedbackCommentsComponent_ion_item_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-item\", 1)(1, \"ion-label\")(2, \"h2\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"p\");\n    i0.ɵɵelement(5, \"core-format-text\", 2);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(6, \"div\", 3)(7, \"div\", 4);\n    i0.ɵɵtemplate(8, AddonModAssignFeedbackCommentsComponent_ion_item_0_ion_button_8_Template, 3, 3, \"ion-button\", 5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(9, AddonModAssignFeedbackCommentsComponent_ion_item_0_ion_note_9_Template, 4, 3, \"ion-note\", 6);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(ctx_r0.plugin.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"component\", ctx_r0.component)(\"componentId\", ctx_r0.assign.cmid)(\"text\", ctx_r0.text)(\"contextInstanceId\", ctx_r0.assign.cmid)(\"courseId\", ctx_r0.assign.course);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.canEdit);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r0.isSent);\n  }\n}\nconst _c0 = function (a0) {\n  return {\n    userid: a0,\n    action: \"grade\"\n  };\n};\nfunction AddonModAssignFeedbackCommentsComponent_ion_item_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-item\", 1)(1, \"ion-label\", 11);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(3, \"core-rich-text-editor\", 12);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r1.plugin.name);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"control\", ctx_r1.control)(\"placeholder\", ctx_r1.plugin.name)(\"component\", ctx_r1.component)(\"componentId\", ctx_r1.assign.cmid)(\"autoSave\", true)(\"contextInstanceId\", ctx_r1.assign.cmid)(\"draftExtraParams\", i0.ɵɵpureFunction1(8, _c0, ctx_r1.userId));\n  }\n}\n/**\n * Component to render a comments feedback plugin.\n */\nexport class AddonModAssignFeedbackCommentsComponent extends AddonModAssignFeedbackPluginBaseComponent {\n  constructor(element, fb) {\n    super();\n    this.fb = fb;\n    this.component = AddonModAssignProvider.COMPONENT;\n    this.text = '';\n    this.isSent = false;\n    this.loaded = false;\n    this.element = element.nativeElement;\n  }\n  /**\n   * @inheritdoc\n   */\n  ngOnInit() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      try {\n        _this.text = yield _this.getText();\n        if (!_this.canEdit && !_this.edit) {\n          // User cannot edit the comment. Show it full when clicked.\n          _this.element.addEventListener('click', e => {\n            e.preventDefault();\n            e.stopPropagation();\n            if (_this.text) {\n              // Open a new state with the text.\n              CoreTextUtils.viewText(_this.plugin.name, _this.text, {\n                component: _this.component,\n                componentId: _this.assign.cmid,\n                filter: true,\n                contextLevel: 'module',\n                instanceId: _this.assign.cmid,\n                courseId: _this.assign.course\n              });\n            }\n          });\n        } else if (_this.edit) {\n          _this.control = _this.fb.control(_this.text);\n        }\n      } finally {\n        _this.loaded = true;\n      }\n    })();\n  }\n  /**\n   * Edit the comment.\n   */\n  editComment() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      try {\n        const inputData = yield _this2.editFeedback();\n        const text = AddonModAssignFeedbackCommentsHandler.getTextFromInputData(_this2.plugin, inputData);\n        // Update the text and save it as draft.\n        _this2.isSent = false;\n        _this2.text = _this2.replacePluginfileUrls(text || '');\n        AddonModAssignFeedbackDelegate.saveFeedbackDraft(_this2.assign.id, _this2.userId, _this2.plugin, {\n          text: text,\n          format: 1\n        });\n      } catch (_unused) {\n        // User cancelled, nothing to do.\n      }\n    })();\n  }\n  /**\n   * Get the text for the plugin.\n   *\n   * @returns Promise resolved with the text.\n   */\n  getText() {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      // Check if the user already modified the comment.\n      const draft = yield AddonModAssignFeedbackDelegate.getPluginDraftData(_this3.assign.id, _this3.userId, _this3.plugin);\n      if (draft) {\n        _this3.isSent = false;\n        return _this3.replacePluginfileUrls(draft.text);\n      }\n      // There is no draft saved. Check if we have anything offline.\n      const offlineData = yield CoreUtils.ignoreErrors(AddonModAssignOffline.getSubmissionGrade(_this3.assign.id, _this3.userId), undefined);\n      if (offlineData && offlineData.plugindata && offlineData.plugindata.assignfeedbackcomments_editor) {\n        const pluginData = offlineData.plugindata;\n        // Save offline as draft.\n        _this3.isSent = false;\n        AddonModAssignFeedbackDelegate.saveFeedbackDraft(_this3.assign.id, _this3.userId, _this3.plugin, pluginData.assignfeedbackcomments_editor);\n        return _this3.replacePluginfileUrls(pluginData.assignfeedbackcomments_editor.text);\n      }\n      // No offline data found, return online text.\n      _this3.isSent = true;\n      return AddonModAssign.getSubmissionPluginText(_this3.plugin);\n    })();\n  }\n  /**\n   * Replace @@PLUGINFILE@@ wildcards with the real URL of embedded files.\n   *\n   * @param text Text to treat.\n   * @returns Treated text.\n   */\n  replacePluginfileUrls(text) {\n    const files = this.plugin.fileareas && this.plugin.fileareas[0] && this.plugin.fileareas[0].files;\n    return CoreTextUtils.replacePluginfileUrls(text, files || []);\n  }\n}\n_class = AddonModAssignFeedbackCommentsComponent;\n_class.ɵfac = function AddonModAssignFeedbackCommentsComponent_Factory(t) {\n  return new (t || _class)(i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i1.FormBuilder));\n};\n_class.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: _class,\n  selectors: [[\"addon-mod-assign-feedback-comments\"]],\n  features: [i0.ɵɵInheritDefinitionFeature],\n  decls: 2,\n  vars: 2,\n  consts: [[\"class\", \"ion-text-wrap\", 4, \"ngIf\"], [1, \"ion-text-wrap\"], [\"collapsible-item\", \"\", \"contextLevel\", \"module\", 3, \"component\", \"componentId\", \"text\", \"contextInstanceId\", \"courseId\"], [\"slot\", \"end\"], [1, \"ion-text-end\"], [\"fill\", \"clear\", 3, \"click\", 4, \"ngIf\"], [\"color\", \"dark\", 4, \"ngIf\"], [\"fill\", \"clear\", 3, \"click\"], [\"name\", \"fas-pen\", \"slot\", \"icon-only\", \"aria-hidden\", \"true\"], [\"color\", \"dark\"], [\"name\", \"fas-clock\", \"aria-hidden\", \"true\"], [1, \"sr-only\"], [\"name\", \"assignfeedbackcomments_editor\", \"contextLevel\", \"module\", \"elementId\", \"assignfeedbackcomments_editor\", 3, \"control\", \"placeholder\", \"component\", \"componentId\", \"autoSave\", \"contextInstanceId\", \"draftExtraParams\"]],\n  template: function AddonModAssignFeedbackCommentsComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵtemplate(0, AddonModAssignFeedbackCommentsComponent_ion_item_0_Template, 10, 8, \"ion-item\", 0);\n      i0.ɵɵtemplate(1, AddonModAssignFeedbackCommentsComponent_ion_item_1_Template, 4, 10, \"ion-item\", 0);\n    }\n    if (rf & 2) {\n      i0.ɵɵproperty(\"ngIf\", (ctx.text || ctx.canEdit) && !ctx.edit);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.edit && ctx.loaded);\n    }\n  },\n  encapsulation: 2\n});","map":{"version":3,"names":["AddonModAssign","AddonModAssignProvider","CoreTextUtils","AddonModAssignFeedbackCommentsHandler","AddonModAssignFeedbackDelegate","AddonModAssignOffline","CoreUtils","AddonModAssignFeedbackPluginBaseComponent","i0","ɵɵelementStart","ɵɵlistener","AddonModAssignFeedbackCommentsComponent_ion_item_0_ion_button_8_Template_ion_button_click_0_listener","ɵɵrestoreView","_r5","ctx_r4","ɵɵnextContext","ɵɵresetView","editComment","ɵɵelement","ɵɵelementEnd","ɵɵattribute","ɵɵpipeBind1","ɵɵtext","ɵɵadvance","ɵɵtextInterpolate1","ɵɵtemplate","AddonModAssignFeedbackCommentsComponent_ion_item_0_ion_button_8_Template","AddonModAssignFeedbackCommentsComponent_ion_item_0_ion_note_9_Template","ɵɵtextInterpolate","ctx_r0","plugin","name","ɵɵproperty","component","assign","cmid","text","course","canEdit","isSent","ctx_r1","control","ɵɵpureFunction1","_c0","userId","AddonModAssignFeedbackCommentsComponent","constructor","element","fb","COMPONENT","loaded","nativeElement","ngOnInit","_this","_asyncToGenerator","getText","edit","addEventListener","e","preventDefault","stopPropagation","viewText","componentId","filter","contextLevel","instanceId","courseId","_this2","inputData","editFeedback","getTextFromInputData","replacePluginfileUrls","saveFeedbackDraft","id","format","_unused","_this3","draft","getPluginDraftData","offlineData","ignoreErrors","getSubmissionGrade","undefined","plugindata","assignfeedbackcomments_editor","pluginData","getSubmissionPluginText","files","fileareas","ɵɵdirectiveInject","ElementRef","i1","FormBuilder","selectors","features","ɵɵInheritDefinitionFeature","decls","vars","consts","template","AddonModAssignFeedbackCommentsComponent_Template","rf","ctx","AddonModAssignFeedbackCommentsComponent_ion_item_0_Template","AddonModAssignFeedbackCommentsComponent_ion_item_1_Template"],"sources":["/home/toon/works/gitionic7/ionic-github/ionic/src/addons/mod/assign/feedback/comments/component/comments.ts","/home/toon/works/gitionic7/ionic-github/ionic/src/addons/mod/assign/feedback/comments/component/addon-mod-assign-feedback-comments.html"],"sourcesContent":["// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Component, OnInit, ElementRef } from '@angular/core';\nimport { FormBuilder, FormControl } from '@angular/forms';\nimport { AddonModAssign, AddonModAssignProvider } from '@addons/mod/assign/services/assign';\nimport { CoreTextUtils } from '@services/utils/text';\nimport {\n    AddonModAssignFeedbackCommentsDraftData,\n    AddonModAssignFeedbackCommentsHandler,\n    AddonModAssignFeedbackCommentsPluginData,\n} from '../services/handler';\nimport { AddonModAssignFeedbackDelegate } from '@addons/mod/assign/services/feedback-delegate';\nimport { AddonModAssignOffline } from '@addons/mod/assign/services/assign-offline';\nimport { CoreUtils } from '@services/utils/utils';\nimport { AddonModAssignFeedbackPluginBaseComponent } from '@addons/mod/assign/classes/base-feedback-plugin-component';\n/**\n * Component to render a comments feedback plugin.\n */\n@Component({\n    selector: 'addon-mod-assign-feedback-comments',\n    templateUrl: 'addon-mod-assign-feedback-comments.html',\n})\nexport class AddonModAssignFeedbackCommentsComponent extends AddonModAssignFeedbackPluginBaseComponent implements OnInit {\n\n    control?: FormControl;\n    component = AddonModAssignProvider.COMPONENT;\n    text = '';\n    isSent = false;\n    loaded = false;\n\n    protected element: HTMLElement;\n\n    constructor(\n        element: ElementRef,\n        protected fb: FormBuilder,\n    ) {\n        super();\n        this.element = element.nativeElement;\n    }\n\n    /**\n     * @inheritdoc\n     */\n    async ngOnInit(): Promise<void> {\n        try {\n            this.text = await this.getText();\n\n            if (!this.canEdit && !this.edit) {\n                // User cannot edit the comment. Show it full when clicked.\n                this.element.addEventListener('click', (e) => {\n                    e.preventDefault();\n                    e.stopPropagation();\n\n                    if (this.text) {\n                        // Open a new state with the text.\n                        CoreTextUtils.viewText(this.plugin.name, this.text, {\n                            component: this.component,\n                            componentId: this.assign.cmid,\n                            filter: true,\n                            contextLevel: 'module',\n                            instanceId: this.assign.cmid,\n                            courseId: this.assign.course,\n                        });\n                    }\n                });\n            } else if (this.edit) {\n                this.control = this.fb.control(this.text);\n            }\n        } finally {\n            this.loaded = true;\n        }\n    }\n\n    /**\n     * Edit the comment.\n     */\n    async editComment(): Promise<void> {\n        try {\n            const inputData = await this.editFeedback();\n            const text = AddonModAssignFeedbackCommentsHandler.getTextFromInputData(this.plugin, inputData);\n\n            // Update the text and save it as draft.\n            this.isSent = false;\n            this.text = this.replacePluginfileUrls(text || '');\n            AddonModAssignFeedbackDelegate.saveFeedbackDraft(this.assign.id, this.userId, this.plugin, {\n                text: text,\n                format: 1,\n            });\n        } catch {\n            // User cancelled, nothing to do.\n        }\n    }\n\n    /**\n     * Get the text for the plugin.\n     *\n     * @returns Promise resolved with the text.\n     */\n    protected async getText(): Promise<string> {\n        // Check if the user already modified the comment.\n        const draft: AddonModAssignFeedbackCommentsDraftData | undefined =\n            await AddonModAssignFeedbackDelegate.getPluginDraftData(this.assign.id, this.userId, this.plugin);\n\n        if (draft) {\n            this.isSent = false;\n\n            return this.replacePluginfileUrls(draft.text);\n        }\n\n        // There is no draft saved. Check if we have anything offline.\n        const offlineData = await CoreUtils.ignoreErrors(\n            AddonModAssignOffline.getSubmissionGrade(this.assign.id, this.userId),\n            undefined,\n        );\n\n        if (offlineData && offlineData.plugindata && offlineData.plugindata.assignfeedbackcomments_editor) {\n            const pluginData = <AddonModAssignFeedbackCommentsPluginData>offlineData.plugindata;\n\n            // Save offline as draft.\n            this.isSent = false;\n            AddonModAssignFeedbackDelegate.saveFeedbackDraft(\n                this.assign.id,\n                this.userId,\n                this.plugin,\n                pluginData.assignfeedbackcomments_editor,\n            );\n\n            return this.replacePluginfileUrls(pluginData.assignfeedbackcomments_editor.text);\n        }\n\n        // No offline data found, return online text.\n        this.isSent = true;\n\n        return AddonModAssign.getSubmissionPluginText(this.plugin);\n    }\n\n    /**\n     * Replace @@PLUGINFILE@@ wildcards with the real URL of embedded files.\n     *\n     * @param text Text to treat.\n     * @returns Treated text.\n     */\n    replacePluginfileUrls(text: string): string {\n        const files = this.plugin.fileareas && this.plugin.fileareas[0] && this.plugin.fileareas[0].files;\n\n        return CoreTextUtils.replacePluginfileUrls(text, files || []);\n    }\n\n}\n","<!-- Read only. -->\n<ion-item class=\"ion-text-wrap\" *ngIf=\"(text || canEdit) && !edit\">\n    <ion-label>\n        <h2>{{ plugin.name }}</h2>\n        <p>\n            <core-format-text [component]=\"component\" [componentId]=\"assign.cmid\" collapsible-item [text]=\"text\" contextLevel=\"module\"\n                [contextInstanceId]=\"assign.cmid\" [courseId]=\"assign.course\" />\n        </p>\n    </ion-label>\n    <div slot=\"end\">\n        <div class=\"ion-text-end\">\n            <ion-button fill=\"clear\" *ngIf=\"canEdit\" (click)=\"editComment()\" [attr.aria-label]=\"'core.edit' | translate\">\n                <ion-icon name=\"fas-pen\" slot=\"icon-only\" aria-hidden=\"true\" />\n            </ion-button>\n        </div>\n        <ion-note *ngIf=\"!isSent\" color=\"dark\">\n            <ion-icon name=\"fas-clock\" aria-hidden=\"true\" /> {{ 'core.notsent' | translate }}\n        </ion-note>\n    </div>\n</ion-item>\n\n<!-- Edit -->\n<ion-item class=\"ion-text-wrap\" *ngIf=\"edit && loaded\">\n    <ion-label class=\"sr-only\">{{ plugin.name }}</ion-label>\n    <core-rich-text-editor [control]=\"control\" [placeholder]=\"plugin.name\" name=\"assignfeedbackcomments_editor\" [component]=\"component\"\n        [componentId]=\"assign.cmid\" [autoSave]=\"true\" contextLevel=\"module\" [contextInstanceId]=\"assign.cmid\"\n        elementId=\"assignfeedbackcomments_editor\" [draftExtraParams]=\"{userid: userId, action: 'grade'}\" />\n</ion-item>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"import _asyncToGenerator from \"/home/toon/works/gitionic7/ionic-github/ionic/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _class;\nimport { CoreDynamicComponent } from '@components/dynamic-component/dynamic-component';\nimport { AddonModAssignProvider, AddonModAssign } from '../../services/assign';\nimport { AddonModAssignHelper } from '../../services/assign-helper';\nimport { AddonModAssignSubmissionDelegate } from '../../services/submission-delegate';\nimport * as i0 from \"@angular/core\";\nfunction AddonModAssignSubmissionPluginComponent_ion_item_2_ion_badge_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-badge\", 7);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(2, 1, \"addon.mod_assign.submissionnotsupported\"), \" \");\n  }\n}\nfunction AddonModAssignSubmissionPluginComponent_ion_item_2_p_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵelement(1, \"core-format-text\", 8);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"component\", ctx_r2.component)(\"componentId\", ctx_r2.assign.cmid)(\"text\", ctx_r2.text)(\"contextInstanceId\", ctx_r2.assign.cmid)(\"courseId\", ctx_r2.assign.course);\n  }\n}\nfunction AddonModAssignSubmissionPluginComponent_ion_item_2_core_file_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"core-file\", 9);\n  }\n  if (rf & 2) {\n    const file_r4 = ctx.$implicit;\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"file\", file_r4)(\"component\", ctx_r3.component)(\"componentId\", ctx_r3.assign.cmid)(\"alwaysDownload\", true);\n  }\n}\nfunction AddonModAssignSubmissionPluginComponent_ion_item_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-item\", 3)(1, \"ion-label\")(2, \"h2\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(4, AddonModAssignSubmissionPluginComponent_ion_item_2_ion_badge_4_Template, 3, 3, \"ion-badge\", 4);\n    i0.ɵɵtemplate(5, AddonModAssignSubmissionPluginComponent_ion_item_2_p_5_Template, 2, 5, \"p\", 5);\n    i0.ɵɵtemplate(6, AddonModAssignSubmissionPluginComponent_ion_item_2_core_file_6_Template, 1, 4, \"core-file\", 6);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(ctx_r0.plugin.name);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.notSupported);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.text);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.files);\n  }\n}\n/**\n * Component that displays an assignment submission plugin.\n */\nexport class AddonModAssignSubmissionPluginComponent {\n  constructor() {\n    this.edit = false; // Whether the user is editing.\n    this.allowOffline = false; // Whether to allow offline.\n    // Data to render the plugin if it isn't supported.\n    this.component = AddonModAssignProvider.COMPONENT;\n    this.text = '';\n    this.files = [];\n    this.notSupported = false;\n    this.pluginLoaded = false;\n  }\n  /**\n   * @inheritdoc\n   */\n  ngOnInit() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      if (!_this.plugin) {\n        _this.pluginLoaded = true;\n        return;\n      }\n      const name = AddonModAssignSubmissionDelegate.getPluginName(_this.plugin);\n      if (!name) {\n        _this.pluginLoaded = true;\n        return;\n      }\n      _this.plugin.name = name;\n      // Check if the plugin has defined its own component to render itself.\n      _this.pluginComponent = yield AddonModAssignSubmissionDelegate.getComponentForPlugin(_this.plugin, _this.edit);\n      if (_this.pluginComponent) {\n        // Prepare the data to pass to the component.\n        _this.data = {\n          assign: _this.assign,\n          submission: _this.submission,\n          plugin: _this.plugin,\n          configs: AddonModAssignHelper.getPluginConfig(_this.assign, 'assignsubmission', _this.plugin.type),\n          edit: _this.edit,\n          allowOffline: _this.allowOffline\n        };\n      } else {\n        // Data to render the plugin.\n        _this.text = AddonModAssign.getSubmissionPluginText(_this.plugin);\n        _this.files = AddonModAssign.getSubmissionPluginAttachments(_this.plugin);\n        _this.notSupported = AddonModAssignSubmissionDelegate.isPluginSupported(_this.plugin.type);\n        _this.pluginLoaded = true;\n      }\n    })();\n  }\n  /**\n   * Invalidate the plugin data.\n   *\n   * @returns Promise resolved when done.\n   */\n  invalidate() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      yield _this2.dynamicComponent.callComponentMethod('invalidate');\n    })();\n  }\n}\n_class = AddonModAssignSubmissionPluginComponent;\n_class.ɵfac = function AddonModAssignSubmissionPluginComponent_Factory(t) {\n  return new (t || _class)();\n};\n_class.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: _class,\n  selectors: [[\"addon-mod-assign-submission-plugin\"]],\n  viewQuery: function AddonModAssignSubmissionPluginComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(CoreDynamicComponent, 5);\n    }\n    if (rf & 2) {\n      let _t;\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.dynamicComponent = _t.first);\n    }\n  },\n  inputs: {\n    assign: \"assign\",\n    submission: \"submission\",\n    plugin: \"plugin\",\n    edit: \"edit\",\n    allowOffline: \"allowOffline\"\n  },\n  decls: 3,\n  vars: 4,\n  consts: [[3, \"component\", \"data\"], [3, \"hideUntil\"], [\"class\", \"ion-text-wrap\", 4, \"ngIf\"], [1, \"ion-text-wrap\"], [\"color\", \"primary\", 4, \"ngIf\"], [4, \"ngIf\"], [3, \"file\", \"component\", \"componentId\", \"alwaysDownload\", 4, \"ngFor\", \"ngForOf\"], [\"color\", \"primary\"], [\"collapsible-item\", \"\", \"contextLevel\", \"module\", 3, \"component\", \"componentId\", \"text\", \"contextInstanceId\", \"courseId\"], [3, \"file\", \"component\", \"componentId\", \"alwaysDownload\"]],\n  template: function AddonModAssignSubmissionPluginComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"core-dynamic-component\", 0)(1, \"core-loading\", 1);\n      i0.ɵɵtemplate(2, AddonModAssignSubmissionPluginComponent_ion_item_2_Template, 7, 4, \"ion-item\", 2);\n      i0.ɵɵelementEnd()();\n    }\n    if (rf & 2) {\n      i0.ɵɵproperty(\"component\", ctx.pluginComponent)(\"data\", ctx.data);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"hideUntil\", ctx.pluginLoaded);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.text.length > 0 || ctx.files.length > 0);\n    }\n  },\n  encapsulation: 2\n});","map":{"version":3,"names":["CoreDynamicComponent","AddonModAssignProvider","AddonModAssign","AddonModAssignHelper","AddonModAssignSubmissionDelegate","i0","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵadvance","ɵɵtextInterpolate1","ɵɵpipeBind1","ɵɵelement","ɵɵproperty","ctx_r2","component","assign","cmid","text","course","file_r4","ctx_r3","ɵɵtemplate","AddonModAssignSubmissionPluginComponent_ion_item_2_ion_badge_4_Template","AddonModAssignSubmissionPluginComponent_ion_item_2_p_5_Template","AddonModAssignSubmissionPluginComponent_ion_item_2_core_file_6_Template","ɵɵtextInterpolate","ctx_r0","plugin","name","notSupported","files","AddonModAssignSubmissionPluginComponent","constructor","edit","allowOffline","COMPONENT","pluginLoaded","ngOnInit","_this","_asyncToGenerator","getPluginName","pluginComponent","getComponentForPlugin","data","submission","configs","getPluginConfig","type","getSubmissionPluginText","getSubmissionPluginAttachments","isPluginSupported","invalidate","_this2","dynamicComponent","callComponentMethod","selectors","viewQuery","AddonModAssignSubmissionPluginComponent_Query","rf","ctx","AddonModAssignSubmissionPluginComponent_ion_item_2_Template","length"],"sources":["/home/toon/works/gitionic7/ionic-github/ionic/src/addons/mod/assign/components/submission-plugin/submission-plugin.ts","/home/toon/works/gitionic7/ionic-github/ionic/src/addons/mod/assign/components/submission-plugin/addon-mod-assign-submission-plugin.html"],"sourcesContent":["// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Component, Input, OnInit, Type, ViewChild } from '@angular/core';\nimport { CoreDynamicComponent } from '@components/dynamic-component/dynamic-component';\nimport {\n    AddonModAssignAssign,\n    AddonModAssignSubmission,\n    AddonModAssignPlugin,\n    AddonModAssignProvider,\n    AddonModAssign,\n} from '../../services/assign';\nimport { AddonModAssignHelper, AddonModAssignPluginConfig } from '../../services/assign-helper';\nimport { AddonModAssignSubmissionDelegate } from '../../services/submission-delegate';\nimport { CoreFileEntry } from '@services/file-helper';\nimport type { AddonModAssignSubmissionPluginBaseComponent } from '@addons/mod/assign/classes/base-submission-plugin-component';\n\n/**\n * Component that displays an assignment submission plugin.\n */\n@Component({\n    selector: 'addon-mod-assign-submission-plugin',\n    templateUrl: 'addon-mod-assign-submission-plugin.html',\n})\nexport class AddonModAssignSubmissionPluginComponent implements OnInit {\n\n    @ViewChild(CoreDynamicComponent) dynamicComponent!: CoreDynamicComponent<AddonModAssignSubmissionPluginBaseComponent>;\n\n    @Input() assign!: AddonModAssignAssign; // The assignment.\n    @Input() submission!: AddonModAssignSubmission; // The submission.\n    @Input() plugin!: AddonModAssignPlugin; // The plugin object.\n    @Input() edit = false; // Whether the user is editing.\n    @Input() allowOffline = false; // Whether to allow offline.\n\n    pluginComponent?: Type<AddonModAssignSubmissionPluginBaseComponent>; // Component to render the plugin.\n    data?: AddonModAssignSubmissionPluginData; // Data to pass to the component.\n\n    // Data to render the plugin if it isn't supported.\n    component = AddonModAssignProvider.COMPONENT;\n    text = '';\n    files: CoreFileEntry[] = [];\n    notSupported = false;\n    pluginLoaded = false;\n\n    /**\n     * @inheritdoc\n     */\n    async ngOnInit(): Promise<void> {\n        if (!this.plugin) {\n            this.pluginLoaded = true;\n\n            return;\n        }\n\n        const name = AddonModAssignSubmissionDelegate.getPluginName(this.plugin);\n\n        if (!name) {\n            this.pluginLoaded = true;\n\n            return;\n        }\n        this.plugin.name = name;\n\n        // Check if the plugin has defined its own component to render itself.\n        this.pluginComponent = await AddonModAssignSubmissionDelegate.getComponentForPlugin(this.plugin, this.edit);\n\n        if (this.pluginComponent) {\n            // Prepare the data to pass to the component.\n            this.data = {\n                assign: this.assign,\n                submission: this.submission,\n                plugin: this.plugin,\n                configs: AddonModAssignHelper.getPluginConfig(this.assign, 'assignsubmission', this.plugin.type),\n                edit: this.edit,\n                allowOffline: this.allowOffline,\n            };\n        } else {\n            // Data to render the plugin.\n            this.text = AddonModAssign.getSubmissionPluginText(this.plugin);\n            this.files = AddonModAssign.getSubmissionPluginAttachments(this.plugin);\n            this.notSupported = AddonModAssignSubmissionDelegate.isPluginSupported(this.plugin.type);\n            this.pluginLoaded = true;\n        }\n    }\n\n    /**\n     * Invalidate the plugin data.\n     *\n     * @returns Promise resolved when done.\n     */\n    async invalidate(): Promise<void> {\n        await this.dynamicComponent.callComponentMethod('invalidate');\n    }\n\n}\n\nexport type AddonModAssignSubmissionPluginData = {\n    assign: AddonModAssignAssign;\n    submission: AddonModAssignSubmission;\n    plugin: AddonModAssignPlugin;\n    configs: AddonModAssignPluginConfig;\n    edit: boolean;\n    allowOffline: boolean;\n};\n","<core-dynamic-component [component]=\"pluginComponent\" [data]=\"data\">\n    <!-- This content will be replaced by the component if found. -->\n    <core-loading [hideUntil]=\"pluginLoaded\">\n        <ion-item class=\"ion-text-wrap\" *ngIf=\"text.length > 0 || files.length > 0\">\n            <ion-label>\n                <h2>{{ plugin.name }}</h2>\n                <ion-badge *ngIf=\"notSupported\" color=\"primary\">\n                    {{ 'addon.mod_assign.submissionnotsupported' | translate }}\n                </ion-badge>\n                <p *ngIf=\"text\">\n                    <core-format-text [component]=\"component\" [componentId]=\"assign.cmid\" collapsible-item [text]=\"text\"\n                        contextLevel=\"module\" [contextInstanceId]=\"assign.cmid\" [courseId]=\"assign.course\" />\n                </p>\n                <core-file *ngFor=\"let file of files\" [file]=\"file\" [component]=\"component\" [componentId]=\"assign.cmid\"\n                    [alwaysDownload]=\"true\" />\n            </ion-label>\n        </ion-item>\n    </core-loading>\n</core-dynamic-component>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
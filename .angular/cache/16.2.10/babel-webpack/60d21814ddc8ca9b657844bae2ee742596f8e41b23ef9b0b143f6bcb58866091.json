{"ast":null,"code":"import _asyncToGenerator from \"/home/toon/works/gitionic7/ionic-github/ionic/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _class;\nimport { Translate } from '@singletons';\nimport { CoreDomUtils } from '@services/utils/dom';\nimport { CoreUtils } from '@services/utils/utils';\nimport { CoreNavigator } from '@services/navigator';\nimport { CoreSitePluginsCallWSOnClickBaseDirective } from '../classes/call-ws-click-directive';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../components/plugin-content/plugin-content\";\n/**\n * Directive to call a WS when the element is clicked. The action to do when the WS call is successful depends on the input data:\n * display a message, go back or refresh current view.\n *\n * If you want to load a new content when the WS call is done, @see CoreSitePluginsCallWSNewContentDirective.\n *\n * @see CoreSitePluginsCallWSOnClickBaseDirective.\n *\n * Example usages:\n *\n * A button to send some data to the server without using cache, displaying default messages and refreshing on success:\n *\n * <ion-button core-site-plugins-call-ws name=\"mod_certificate_view_certificate\"\n *             [params]=\"{certificateid: <% certificate.id %>}\" [preSets]=\"{getFromCache: 0, saveToCache: 0}\" confirmMessage\n *             successMessage refreshOnSuccess=\"true\">\n *     {{ 'plugin.mod_certificate_coursecertificate.senddata' | translate }}\n * </ion-button>\n *\n * A button to send some data to the server using cache, without confirm, going back on success and using userid from otherdata:\n *\n * <ion-button core-site-plugins-call-ws name=\"mod_certificate_view_certificate\"\n *             [params]=\"{certificateid: <% certificate.id %>}\" goBackOnSuccess=\"true\" [useOtherData]=\"['userid']\">\n *     {{ 'plugin.mod_certificate_coursecertificate.senddata' | translate }}\n * </ion-button>\n */\nexport class CoreSitePluginsCallWSDirective extends CoreSitePluginsCallWSOnClickBaseDirective {\n  constructor(element, parentContent) {\n    super(element, parentContent);\n  }\n  /**\n   * @inheritdoc\n   */\n  wsCallSuccess() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      if (CoreUtils.isTrueOrOne(_this.goBackOnSuccess)) {\n        yield CoreNavigator.back();\n      } else if (CoreUtils.isTrueOrOne(_this.refreshOnSuccess) && _this.parentContent) {\n        _this.parentContent.refreshContent(true);\n      }\n      if (_this.successMessage !== undefined) {\n        // Display the success message.\n        CoreDomUtils.showToast(_this.successMessage || Translate.instant('core.success'));\n      }\n    })();\n  }\n}\n_class = CoreSitePluginsCallWSDirective;\n_class.ɵfac = function CoreSitePluginsCallWSDirective_Factory(t) {\n  return new (t || _class)(i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i1.CoreSitePluginsPluginContentComponent, 8));\n};\n_class.ɵdir = /*@__PURE__*/i0.ɵɵdefineDirective({\n  type: _class,\n  selectors: [[\"\", \"core-site-plugins-call-ws\", \"\"]],\n  inputs: {\n    successMessage: \"successMessage\",\n    goBackOnSuccess: \"goBackOnSuccess\",\n    refreshOnSuccess: \"refreshOnSuccess\"\n  },\n  features: [i0.ɵɵInheritDefinitionFeature]\n});","map":{"version":3,"names":["Translate","CoreDomUtils","CoreUtils","CoreNavigator","CoreSitePluginsCallWSOnClickBaseDirective","CoreSitePluginsCallWSDirective","constructor","element","parentContent","wsCallSuccess","_this","_asyncToGenerator","isTrueOrOne","goBackOnSuccess","back","refreshOnSuccess","refreshContent","successMessage","undefined","showToast","instant","i0","ɵɵdirectiveInject","ElementRef","i1","CoreSitePluginsPluginContentComponent","selectors","inputs","features","ɵɵInheritDefinitionFeature"],"sources":["/home/toon/works/gitionic7/ionic-github/ionic/src/core/features/siteplugins/directives/call-ws.ts"],"sourcesContent":["// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Directive, Input, ElementRef, Optional } from '@angular/core';\n\nimport { Translate } from '@singletons';\nimport { CoreDomUtils } from '@services/utils/dom';\nimport { CoreUtils } from '@services/utils/utils';\nimport { CoreNavigator } from '@services/navigator';\nimport { CoreSitePluginsCallWSOnClickBaseDirective } from '../classes/call-ws-click-directive';\nimport { CoreSitePluginsPluginContentComponent } from '../components/plugin-content/plugin-content';\n\n/**\n * Directive to call a WS when the element is clicked. The action to do when the WS call is successful depends on the input data:\n * display a message, go back or refresh current view.\n *\n * If you want to load a new content when the WS call is done, @see CoreSitePluginsCallWSNewContentDirective.\n *\n * @see CoreSitePluginsCallWSOnClickBaseDirective.\n *\n * Example usages:\n *\n * A button to send some data to the server without using cache, displaying default messages and refreshing on success:\n *\n * <ion-button core-site-plugins-call-ws name=\"mod_certificate_view_certificate\"\n *             [params]=\"{certificateid: <% certificate.id %>}\" [preSets]=\"{getFromCache: 0, saveToCache: 0}\" confirmMessage\n *             successMessage refreshOnSuccess=\"true\">\n *     {{ 'plugin.mod_certificate_coursecertificate.senddata' | translate }}\n * </ion-button>\n *\n * A button to send some data to the server using cache, without confirm, going back on success and using userid from otherdata:\n *\n * <ion-button core-site-plugins-call-ws name=\"mod_certificate_view_certificate\"\n *             [params]=\"{certificateid: <% certificate.id %>}\" goBackOnSuccess=\"true\" [useOtherData]=\"['userid']\">\n *     {{ 'plugin.mod_certificate_coursecertificate.senddata' | translate }}\n * </ion-button>\n */\n@Directive({\n    selector: '[core-site-plugins-call-ws]',\n})\nexport class CoreSitePluginsCallWSDirective extends CoreSitePluginsCallWSOnClickBaseDirective {\n\n    @Input() successMessage?: string; // Message to show on success. If not supplied, no message. If empty, default message.\n    @Input() goBackOnSuccess?: boolean | string; // Whether to go back if the WS call is successful.\n    @Input() refreshOnSuccess?: boolean | string; // Whether to refresh the current view if the WS call is successful.\n\n    constructor(\n        element: ElementRef,\n        @Optional() parentContent: CoreSitePluginsPluginContentComponent,\n    ) {\n        super(element, parentContent);\n    }\n\n    /**\n     * @inheritdoc\n     */\n    protected async wsCallSuccess(): Promise<void> {\n        if (CoreUtils.isTrueOrOne(this.goBackOnSuccess)) {\n            await CoreNavigator.back();\n        } else if (CoreUtils.isTrueOrOne(this.refreshOnSuccess) && this.parentContent) {\n            this.parentContent.refreshContent(true);\n        }\n\n        if (this.successMessage !== undefined) {\n            // Display the success message.\n            CoreDomUtils.showToast(this.successMessage || Translate.instant('core.success'));\n        }\n    }\n\n}\n"],"mappings":";;AAgBA,SAASA,SAAS,QAAQ,aAAa;AACvC,SAASC,YAAY,QAAQ,qBAAqB;AAClD,SAASC,SAAS,QAAQ,uBAAuB;AACjD,SAASC,aAAa,QAAQ,qBAAqB;AACnD,SAASC,yCAAyC,QAAQ,oCAAoC;;;AAG9F;;;;;;;;;;;;;;;;;;;;;;;;;AA4BA,OAAM,MAAOC,8BAA+B,SAAQD,yCAAyC;EAMzFE,YACIC,OAAmB,EACPC,aAAoD;IAEhE,KAAK,CAACD,OAAO,EAAEC,aAAa,CAAC;EACjC;EAEA;;;EAGgBC,aAAaA,CAAA;IAAA,IAAAC,KAAA;IAAA,OAAAC,iBAAA;MACzB,IAAIT,SAAS,CAACU,WAAW,CAACF,KAAI,CAACG,eAAe,CAAC,EAAE;QAC7C,MAAMV,aAAa,CAACW,IAAI,EAAE;OAC7B,MAAM,IAAIZ,SAAS,CAACU,WAAW,CAACF,KAAI,CAACK,gBAAgB,CAAC,IAAIL,KAAI,CAACF,aAAa,EAAE;QAC3EE,KAAI,CAACF,aAAa,CAACQ,cAAc,CAAC,IAAI,CAAC;;MAG3C,IAAIN,KAAI,CAACO,cAAc,KAAKC,SAAS,EAAE;QACnC;QACAjB,YAAY,CAACkB,SAAS,CAACT,KAAI,CAACO,cAAc,IAAIjB,SAAS,CAACoB,OAAO,CAAC,cAAc,CAAC,CAAC;;IACnF;EACL;;SA3BSf,8BAA+B;;mBAA/BA,MAA8B,EAAAgB,EAAA,CAAAC,iBAAA,CAAAD,EAAA,CAAAE,UAAA,GAAAF,EAAA,CAAAC,iBAAA,CAAAE,EAAA,CAAAC,qCAAA;AAAA;;QAA9BpB,MAA8B;EAAAqB,SAAA;EAAAC,MAAA;IAAAV,cAAA;IAAAJ,eAAA;IAAAE,gBAAA;EAAA;EAAAa,QAAA,GAAAP,EAAA,CAAAQ,0BAAA;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}
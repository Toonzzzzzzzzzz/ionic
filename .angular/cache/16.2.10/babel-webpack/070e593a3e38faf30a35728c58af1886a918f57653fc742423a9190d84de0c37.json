{"ast":null,"code":"import _asyncToGenerator from \"/home/toon/works/gitionic7/ionic-github/ionic/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\n// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nimport { CoreRoutedItemsManagerSource } from '@classes/items-management/routed-items-manager-source';\nimport { CoreUser, CoreUserProvider } from '../services/user';\n/**\n * Provides a collection of course participants.\n */\nexport class CoreUserParticipantsSource extends CoreRoutedItemsManagerSource {\n  /**\n   * @inheritdoc\n   */\n  static getSourceId(courseId, searchQuery = null) {\n    var _searchQuery;\n    searchQuery = (_searchQuery = searchQuery) !== null && _searchQuery !== void 0 ? _searchQuery : '__empty__';\n    return `participants-${courseId}-${searchQuery}`;\n  }\n  constructor(courseId, searchQuery = null) {\n    super();\n    this.COURSE_ID = courseId;\n    this.SEARCH_QUERY = searchQuery;\n  }\n  /**\n   * @inheritdoc\n   */\n  getItemPath(user) {\n    return user.id.toString();\n  }\n  /**\n   * @inheritdoc\n   */\n  getItemQueryParams() {\n    return {\n      search: this.SEARCH_QUERY\n    };\n  }\n  /**\n   * @inheritdoc\n   */\n  loadPageItems(page) {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      if (_this.SEARCH_QUERY) {\n        const {\n          participants,\n          canLoadMore\n        } = yield CoreUser.searchParticipants(_this.COURSE_ID, _this.SEARCH_QUERY, true, page, CoreUserProvider.PARTICIPANTS_LIST_LIMIT);\n        return {\n          items: participants,\n          hasMoreItems: canLoadMore\n        };\n      }\n      const {\n        participants,\n        canLoadMore\n      } = yield CoreUser.getParticipants(_this.COURSE_ID, page * CoreUserProvider.PARTICIPANTS_LIST_LIMIT, CoreUserProvider.PARTICIPANTS_LIST_LIMIT);\n      return {\n        items: participants,\n        hasMoreItems: canLoadMore\n      };\n    })();\n  }\n  /**\n   * @inheritdoc\n   */\n  getPageLength() {\n    return CoreUserProvider.PARTICIPANTS_LIST_LIMIT;\n  }\n}","map":{"version":3,"names":["CoreRoutedItemsManagerSource","CoreUser","CoreUserProvider","CoreUserParticipantsSource","getSourceId","courseId","searchQuery","_searchQuery","constructor","COURSE_ID","SEARCH_QUERY","getItemPath","user","id","toString","getItemQueryParams","search","loadPageItems","page","_this","_asyncToGenerator","participants","canLoadMore","searchParticipants","PARTICIPANTS_LIST_LIMIT","items","hasMoreItems","getParticipants","getPageLength"],"sources":["/home/toon/works/gitionic7/ionic-github/ionic/src/core/features/user/classes/participants-source.ts"],"sourcesContent":["// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Params } from '@angular/router';\nimport { CoreRoutedItemsManagerSource } from '@classes/items-management/routed-items-manager-source';\n\nimport { CoreUser, CoreUserData, CoreUserParticipant, CoreUserProvider } from '../services/user';\n\n/**\n * Provides a collection of course participants.\n */\nexport class CoreUserParticipantsSource extends CoreRoutedItemsManagerSource<CoreUserParticipant | CoreUserData> {\n\n    /**\n     * @inheritdoc\n     */\n    static getSourceId(courseId: number, searchQuery: string | null = null): string {\n        searchQuery = searchQuery ?? '__empty__';\n\n        return `participants-${courseId}-${searchQuery}`;\n    }\n\n    readonly COURSE_ID: number;\n    readonly SEARCH_QUERY: string | null;\n\n    constructor(courseId: number, searchQuery: string | null = null) {\n        super();\n\n        this.COURSE_ID = courseId;\n        this.SEARCH_QUERY = searchQuery;\n    }\n\n    /**\n     * @inheritdoc\n     */\n    getItemPath(user: CoreUserParticipant | CoreUserData): string {\n        return user.id.toString();\n    }\n\n    /**\n     * @inheritdoc\n     */\n    getItemQueryParams(): Params {\n        return { search: this.SEARCH_QUERY };\n    }\n\n    /**\n     * @inheritdoc\n     */\n    protected async loadPageItems(page: number): Promise<{ items: (CoreUserParticipant | CoreUserData)[]; hasMoreItems: boolean }> {\n        if (this.SEARCH_QUERY) {\n            const { participants, canLoadMore } = await CoreUser.searchParticipants(\n                this.COURSE_ID,\n                this.SEARCH_QUERY,\n                true,\n                page,\n                CoreUserProvider.PARTICIPANTS_LIST_LIMIT,\n            );\n\n            return {\n                items: participants,\n                hasMoreItems: canLoadMore,\n            };\n        }\n\n        const { participants, canLoadMore } = await CoreUser.getParticipants(\n            this.COURSE_ID,\n            page * CoreUserProvider.PARTICIPANTS_LIST_LIMIT,\n            CoreUserProvider.PARTICIPANTS_LIST_LIMIT,\n        );\n\n        return {\n            items: participants,\n            hasMoreItems: canLoadMore,\n        };\n    }\n\n    /**\n     * @inheritdoc\n     */\n    protected getPageLength(): number {\n        return CoreUserProvider.PARTICIPANTS_LIST_LIMIT;\n    }\n\n}\n"],"mappings":";AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA,SAASA,4BAA4B,QAAQ,uDAAuD;AAEpG,SAASC,QAAQ,EAAqCC,gBAAgB,QAAQ,kBAAkB;AAEhG;;;AAGA,OAAM,MAAOC,0BAA2B,SAAQH,4BAAgE;EAE5G;;;EAGA,OAAOI,WAAWA,CAACC,QAAgB,EAAEC,WAAA,GAA6B,IAAI;IAAA,IAAAC,YAAA;IAClED,WAAW,IAAAC,YAAA,GAAGD,WAAW,cAAAC,YAAA,cAAAA,YAAA,GAAI,WAAW;IAExC,OAAO,gBAAgBF,QAAQ,IAAIC,WAAW,EAAE;EACpD;EAKAE,YAAYH,QAAgB,EAAEC,WAAA,GAA6B,IAAI;IAC3D,KAAK,EAAE;IAEP,IAAI,CAACG,SAAS,GAAGJ,QAAQ;IACzB,IAAI,CAACK,YAAY,GAAGJ,WAAW;EACnC;EAEA;;;EAGAK,WAAWA,CAACC,IAAwC;IAChD,OAAOA,IAAI,CAACC,EAAE,CAACC,QAAQ,EAAE;EAC7B;EAEA;;;EAGAC,kBAAkBA,CAAA;IACd,OAAO;MAAEC,MAAM,EAAE,IAAI,CAACN;IAAY,CAAE;EACxC;EAEA;;;EAGgBO,aAAaA,CAACC,IAAY;IAAA,IAAAC,KAAA;IAAA,OAAAC,iBAAA;MACtC,IAAID,KAAI,CAACT,YAAY,EAAE;QACnB,MAAM;UAAEW,YAAY;UAAEC;QAAW,CAAE,SAASrB,QAAQ,CAACsB,kBAAkB,CACnEJ,KAAI,CAACV,SAAS,EACdU,KAAI,CAACT,YAAY,EACjB,IAAI,EACJQ,IAAI,EACJhB,gBAAgB,CAACsB,uBAAuB,CAC3C;QAED,OAAO;UACHC,KAAK,EAAEJ,YAAY;UACnBK,YAAY,EAAEJ;SACjB;;MAGL,MAAM;QAAED,YAAY;QAAEC;MAAW,CAAE,SAASrB,QAAQ,CAAC0B,eAAe,CAChER,KAAI,CAACV,SAAS,EACdS,IAAI,GAAGhB,gBAAgB,CAACsB,uBAAuB,EAC/CtB,gBAAgB,CAACsB,uBAAuB,CAC3C;MAED,OAAO;QACHC,KAAK,EAAEJ,YAAY;QACnBK,YAAY,EAAEJ;OACjB;IAAC;EACN;EAEA;;;EAGUM,aAAaA,CAAA;IACnB,OAAO1B,gBAAgB,CAACsB,uBAAuB;EACnD"},"metadata":{},"sourceType":"module","externalDependencies":[]}
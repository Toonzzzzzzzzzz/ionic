{"ast":null,"code":"// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nimport { CoreUtils } from '@services/utils/utils';\nimport { CoreSitePlugins } from '../services/siteplugins';\n/**\n * Base class for components that will display a component using core-compile-html and want to call a\n * componentInit function returned by the handler JS.\n */\nexport class CoreSitePluginsCompileInitComponent {\n  constructor() {\n    this.content = ''; // Content.\n    this.jsData = {}; // Data to pass to the component.\n  }\n  /**\n   * Function called when the component is created.\n   *\n   * @param instance The component instance.\n   */\n  componentCreated(instance) {\n    var _this$handlerSchema;\n    // Check if the JS defined an init function.\n    if (instance && (_this$handlerSchema = this.handlerSchema) !== null && _this$handlerSchema !== void 0 && (_this$handlerSchema = _this$handlerSchema.methodJSResult) !== null && _this$handlerSchema !== void 0 && _this$handlerSchema.componentInit) {\n      this.handlerSchema.methodJSResult.componentInit.apply(instance);\n    }\n  }\n  /**\n   * Get the handler data.\n   *\n   * @param name The name of the handler.\n   */\n  getHandlerData(name) {\n    var _this$handlerSchema$m;\n    // Retrieve the handler data.\n    const handler = CoreSitePlugins.getSitePluginHandler(name);\n    this.handlerSchema = handler === null || handler === void 0 ? void 0 : handler.handlerSchema;\n    if (!this.handlerSchema) {\n      return;\n    }\n    // Load first template.\n    if ((_this$handlerSchema$m = this.handlerSchema.methodTemplates) !== null && _this$handlerSchema$m !== void 0 && _this$handlerSchema$m.length) {\n      this.content = this.handlerSchema.methodTemplates[0].html;\n      this.jsData.CONTENT_TEMPLATES = CoreUtils.objectToKeyValueMap(this.handlerSchema.methodTemplates, 'id', 'html');\n    }\n    // Pass data from the method result to the component.\n    if (this.handlerSchema.methodOtherdata) {\n      this.jsData.CONTENT_OTHERDATA = this.handlerSchema.methodOtherdata;\n    }\n    if (this.handlerSchema.methodJSResult) {\n      this.jsData.CONTENT_JS_RESULT = this.handlerSchema.methodJSResult;\n    }\n  }\n}","map":{"version":3,"names":["CoreUtils","CoreSitePlugins","CoreSitePluginsCompileInitComponent","constructor","content","jsData","componentCreated","instance","_this$handlerSchema","handlerSchema","methodJSResult","componentInit","apply","getHandlerData","name","_this$handlerSchema$m","handler","getSitePluginHandler","methodTemplates","length","html","CONTENT_TEMPLATES","objectToKeyValueMap","methodOtherdata","CONTENT_OTHERDATA","CONTENT_JS_RESULT"],"sources":["/home/toon/works/gitionic7/ionic-github/ionic/src/core/features/siteplugins/classes/compile-init-component.ts"],"sourcesContent":["// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { CoreUtils } from '@services/utils/utils';\nimport { CoreSitePlugins, CoreSitePluginsInitHandlerData } from '../services/siteplugins';\n\n/**\n * Base class for components that will display a component using core-compile-html and want to call a\n * componentInit function returned by the handler JS.\n */\nexport class CoreSitePluginsCompileInitComponent {\n\n    content = ''; // Content.\n    jsData: Record<string, unknown> = {}; // Data to pass to the component.\n    protected handlerSchema?: CoreSitePluginsInitHandlerData; // The handler data.\n\n    /**\n     * Function called when the component is created.\n     *\n     * @param instance The component instance.\n     */\n    componentCreated(instance: unknown): void {\n        // Check if the JS defined an init function.\n        if (instance && this.handlerSchema?.methodJSResult?.componentInit) {\n            this.handlerSchema.methodJSResult.componentInit.apply(instance);\n        }\n    }\n\n    /**\n     * Get the handler data.\n     *\n     * @param name The name of the handler.\n     */\n    getHandlerData(name: string): void {\n        // Retrieve the handler data.\n        const handler = CoreSitePlugins.getSitePluginHandler(name);\n\n        this.handlerSchema = handler?.handlerSchema;\n\n        if (!this.handlerSchema) {\n            return;\n        }\n\n        // Load first template.\n        if (this.handlerSchema.methodTemplates?.length) {\n            this.content = this.handlerSchema.methodTemplates[0].html;\n            this.jsData.CONTENT_TEMPLATES = CoreUtils.objectToKeyValueMap(\n                this.handlerSchema.methodTemplates,\n                'id',\n                'html',\n            );\n        }\n\n        // Pass data from the method result to the component.\n        if (this.handlerSchema.methodOtherdata) {\n            this.jsData.CONTENT_OTHERDATA = this.handlerSchema.methodOtherdata;\n        }\n\n        if (this.handlerSchema.methodJSResult) {\n            this.jsData.CONTENT_JS_RESULT = this.handlerSchema.methodJSResult;\n        }\n    }\n\n}\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,SAASA,SAAS,QAAQ,uBAAuB;AACjD,SAASC,eAAe,QAAwC,yBAAyB;AAEzF;;;;AAIA,OAAM,MAAOC,mCAAmC;EAAhDC,YAAA;IAEI,KAAAC,OAAO,GAAG,EAAE,CAAC,CAAC;IACd,KAAAC,MAAM,GAA4B,EAAE,CAAC,CAAC;EAkD1C;EA/CI;;;;;EAKAC,gBAAgBA,CAACC,QAAiB;IAAA,IAAAC,mBAAA;IAC9B;IACA,IAAID,QAAQ,KAAAC,mBAAA,GAAI,IAAI,CAACC,aAAa,cAAAD,mBAAA,gBAAAA,mBAAA,GAAlBA,mBAAA,CAAoBE,cAAc,cAAAF,mBAAA,eAAlCA,mBAAA,CAAoCG,aAAa,EAAE;MAC/D,IAAI,CAACF,aAAa,CAACC,cAAc,CAACC,aAAa,CAACC,KAAK,CAACL,QAAQ,CAAC;;EAEvE;EAEA;;;;;EAKAM,cAAcA,CAACC,IAAY;IAAA,IAAAC,qBAAA;IACvB;IACA,MAAMC,OAAO,GAAGf,eAAe,CAACgB,oBAAoB,CAACH,IAAI,CAAC;IAE1D,IAAI,CAACL,aAAa,GAAGO,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEP,aAAa;IAE3C,IAAI,CAAC,IAAI,CAACA,aAAa,EAAE;MACrB;;IAGJ;IACA,KAAAM,qBAAA,GAAI,IAAI,CAACN,aAAa,CAACS,eAAe,cAAAH,qBAAA,eAAlCA,qBAAA,CAAoCI,MAAM,EAAE;MAC5C,IAAI,CAACf,OAAO,GAAG,IAAI,CAACK,aAAa,CAACS,eAAe,CAAC,CAAC,CAAC,CAACE,IAAI;MACzD,IAAI,CAACf,MAAM,CAACgB,iBAAiB,GAAGrB,SAAS,CAACsB,mBAAmB,CACzD,IAAI,CAACb,aAAa,CAACS,eAAe,EAClC,IAAI,EACJ,MAAM,CACT;;IAGL;IACA,IAAI,IAAI,CAACT,aAAa,CAACc,eAAe,EAAE;MACpC,IAAI,CAAClB,MAAM,CAACmB,iBAAiB,GAAG,IAAI,CAACf,aAAa,CAACc,eAAe;;IAGtE,IAAI,IAAI,CAACd,aAAa,CAACC,cAAc,EAAE;MACnC,IAAI,CAACL,MAAM,CAACoB,iBAAiB,GAAG,IAAI,CAAChB,aAAa,CAACC,cAAc;;EAEzE"},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"import _objectSpread from \"/home/toon/works/gitionic7/ionic-github/ionic/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _objectWithoutProperties from \"/home/toon/works/gitionic7/ionic-github/ionic/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";\nimport _asyncToGenerator from \"/home/toon/works/gitionic7/ionic-github/ionic/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nconst _excluded = [\"getFocusedElement\"];\nvar _class;\nimport { CoreUserTours } from '@features/usertours/services/user-tours';\nimport { CoreDom } from '@singletons/dom';\nimport * as i0 from \"@angular/core\";\n/**\n * Directive to control a User Tour linked to the lifecycle of the element where it's defined.\n */\nexport class CoreUserTourDirective {\n  constructor(element) {\n    this.element = element.nativeElement;\n  }\n  /**\n   * @inheritdoc\n   */\n  ngOnInit() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      var _getFocusedElement;\n      _this.visiblePromise = CoreDom.waitToBeInViewport(_this.element);\n      yield _this.visiblePromise;\n      const _this$userTour = _this.userTour,\n        {\n          getFocusedElement\n        } = _this$userTour,\n        options = _objectWithoutProperties(_this$userTour, _excluded);\n      _this.tour = yield CoreUserTours.showIfPending(_objectSpread(_objectSpread({}, options), {}, {\n        focus: (_getFocusedElement = getFocusedElement === null || getFocusedElement === void 0 ? void 0 : getFocusedElement(_this.element)) !== null && _getFocusedElement !== void 0 ? _getFocusedElement : _this.element\n      }));\n    })();\n  }\n  /**\n   * @inheritdoc\n   */\n  ngOnDestroy() {\n    var _this$tour, _this$visiblePromise;\n    (_this$tour = this.tour) === null || _this$tour === void 0 || _this$tour.cancel();\n    (_this$visiblePromise = this.visiblePromise) === null || _this$visiblePromise === void 0 || _this$visiblePromise.cancel();\n  }\n}\n_class = CoreUserTourDirective;\n_class.ɵfac = function CoreUserTourDirective_Factory(t) {\n  return new (t || _class)(i0.ɵɵdirectiveInject(i0.ElementRef));\n};\n_class.ɵdir = /*@__PURE__*/i0.ɵɵdefineDirective({\n  type: _class,\n  selectors: [[\"\", \"userTour\", \"\"]],\n  inputs: {\n    userTour: \"userTour\"\n  }\n});","map":{"version":3,"names":["CoreUserTours","CoreDom","CoreUserTourDirective","constructor","element","nativeElement","ngOnInit","_this","_asyncToGenerator","_getFocusedElement","visiblePromise","waitToBeInViewport","_this$userTour","userTour","getFocusedElement","options","_objectWithoutProperties","_excluded","tour","showIfPending","_objectSpread","focus","ngOnDestroy","_this$tour","_this$visiblePromise","cancel","i0","ɵɵdirectiveInject","ElementRef","selectors","inputs"],"sources":["/home/toon/works/gitionic7/ionic-github/ionic/src/core/directives/user-tour.ts"],"sourcesContent":["// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Directive, ElementRef, Input, OnDestroy, OnInit } from '@angular/core';\nimport { CoreCancellablePromise } from '@classes/cancellable-promise';\nimport { CoreUserTours, CoreUserToursFocusedOptions, CoreUserToursUserTour } from '@features/usertours/services/user-tours';\nimport { CoreDom } from '@singletons/dom';\n\n/**\n * Directive to control a User Tour linked to the lifecycle of the element where it's defined.\n */\n@Directive({\n    selector: '[userTour]',\n})\nexport class CoreUserTourDirective implements OnInit, OnDestroy {\n\n    @Input() userTour!: CoreUserTourDirectiveOptions;\n\n    private tour?: CoreUserToursUserTour | null;\n    private element: HTMLElement;\n    protected visiblePromise?: CoreCancellablePromise<void>;\n\n    constructor(element: ElementRef) {\n        this.element = element.nativeElement;\n    }\n\n    /**\n     * @inheritdoc\n     */\n    async ngOnInit(): Promise<void> {\n        this.visiblePromise = CoreDom.waitToBeInViewport(this.element);\n\n        await this.visiblePromise;\n\n        const { getFocusedElement, ...options } = this.userTour;\n\n        this.tour = await CoreUserTours.showIfPending({\n            ...options,\n            focus: getFocusedElement?.(this.element) ?? this.element,\n        });\n    }\n\n    /**\n     * @inheritdoc\n     */\n    ngOnDestroy(): void {\n        this.tour?.cancel();\n        this.visiblePromise?.cancel();\n    }\n\n}\n\n/**\n * User Tour options to control with this directive.\n */\nexport type CoreUserTourDirectiveOptions = Omit<CoreUserToursFocusedOptions, 'focus'> & {\n\n    /**\n     * Getter to obtain element to focus in the User Tour. If this isn't provided, the element where the\n     * directive is defined will be used.\n     *\n     * @param element Element where the directive is defined.\n     */\n    getFocusedElement?(element: HTMLElement): HTMLElement;\n\n};\n"],"mappings":";;;;;AAgBA,SAASA,aAAa,QAA4D,yCAAyC;AAC3H,SAASC,OAAO,QAAQ,iBAAiB;;AAEzC;;;AAMA,OAAM,MAAOC,qBAAqB;EAQ9BC,YAAYC,OAAmB;IAC3B,IAAI,CAACA,OAAO,GAAGA,OAAO,CAACC,aAAa;EACxC;EAEA;;;EAGMC,QAAQA,CAAA;IAAA,IAAAC,KAAA;IAAA,OAAAC,iBAAA;MAAA,IAAAC,kBAAA;MACVF,KAAI,CAACG,cAAc,GAAGT,OAAO,CAACU,kBAAkB,CAACJ,KAAI,CAACH,OAAO,CAAC;MAE9D,MAAMG,KAAI,CAACG,cAAc;MAEzB,MAAAE,cAAA,GAA0CL,KAAI,CAACM,QAAQ;QAAjD;UAAEC;QAA6B,CAAE,GAAAF,cAAA;QAATG,OAAO,GAAAC,wBAAA,CAAAJ,cAAA,EAAAK,SAAA;MAErCV,KAAI,CAACW,IAAI,SAASlB,aAAa,CAACmB,aAAa,CAAAC,aAAA,CAAAA,aAAA,KACtCL,OAAO;QACVM,KAAK,GAAAZ,kBAAA,GAAEK,iBAAiB,aAAjBA,iBAAiB,uBAAjBA,iBAAiB,CAAGP,KAAI,CAACH,OAAO,CAAC,cAAAK,kBAAA,cAAAA,kBAAA,GAAIF,KAAI,CAACH;MAAO,EAC3D,CAAC;IAAC;EACP;EAEA;;;EAGAkB,WAAWA,CAAA;IAAA,IAAAC,UAAA,EAAAC,oBAAA;IACP,CAAAD,UAAA,OAAI,CAACL,IAAI,cAAAK,UAAA,eAATA,UAAA,CAAWE,MAAM,EAAE;IACnB,CAAAD,oBAAA,OAAI,CAACd,cAAc,cAAAc,oBAAA,eAAnBA,oBAAA,CAAqBC,MAAM,EAAE;EACjC;;SAlCSvB,qBAAqB;;mBAArBA,MAAqB,EAAAwB,EAAA,CAAAC,iBAAA,CAAAD,EAAA,CAAAE,UAAA;AAAA;;QAArB1B,MAAqB;EAAA2B,SAAA;EAAAC,MAAA;IAAAjB,QAAA;EAAA;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}
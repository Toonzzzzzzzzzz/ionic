{"ast":null,"code":"import _asyncToGenerator from \"/home/toon/works/gitionic7/ionic-github/ionic/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _class;\n// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nimport { EventEmitter } from '@angular/core';\nimport { CoreFile } from '@services/file';\nimport { CoreFileHelper } from '@services/file-helper';\nimport { CoreSites } from '@services/sites';\nimport { CoreDomUtils } from '@services/utils/dom';\nimport { CoreMimetypeUtils } from '@services/utils/mimetype';\nimport { CoreTextUtils } from '@services/utils/text';\nimport { CoreTimeUtils } from '@services/utils/time';\nimport { CoreUtils, OpenFileAction } from '@services/utils/utils';\nimport { CoreForms } from '@singletons/form';\nimport { CorePath } from '@singletons/path';\nimport { CorePlatform } from '@services/platform';\nimport * as i0 from \"@angular/core\";\nconst _c0 = [\"nameForm\"];\nfunction CoreLocalFileComponent_ion_label_6_p_3_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r6 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r6.size);\n  }\n}\nfunction CoreLocalFileComponent_ion_label_6_p_3_ng_container_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtext(1, \" \\u00B7 \");\n    i0.ɵɵelementContainerEnd();\n  }\n}\nfunction CoreLocalFileComponent_ion_label_6_p_3_ng_container_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r8 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r8.timemodified);\n  }\n}\nfunction CoreLocalFileComponent_ion_label_6_p_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵtemplate(1, CoreLocalFileComponent_ion_label_6_p_3_ng_container_1_Template, 2, 1, \"ng-container\", 6);\n    i0.ɵɵtemplate(2, CoreLocalFileComponent_ion_label_6_p_3_ng_container_2_Template, 2, 0, \"ng-container\", 6);\n    i0.ɵɵtemplate(3, CoreLocalFileComponent_ion_label_6_p_3_ng_container_3_Template, 2, 1, \"ng-container\", 6);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r5.size);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r5.size && ctx_r5.timemodified);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r5.timemodified);\n  }\n}\nfunction CoreLocalFileComponent_ion_label_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-label\")(1, \"p\", 10);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(3, CoreLocalFileComponent_ion_label_6_p_3_Template, 4, 3, \"p\", 6);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r1.fileName);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.size || ctx_r1.timemodified);\n  }\n}\nfunction CoreLocalFileComponent_ion_input_7_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-input\", 11);\n    i0.ɵɵlistener(\"click\", function CoreLocalFileComponent_ion_input_7_Template_ion_input_click_0_listener($event) {\n      return $event.stopPropagation();\n    })(\"ngModelChange\", function CoreLocalFileComponent_ion_input_7_Template_ion_input_ngModelChange_0_listener($event) {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r10 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r10.newFileName = $event);\n    });\n    i0.ɵɵpipe(1, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"placeholder\", i0.ɵɵpipeBind1(1, 2, \"core.filename\"))(\"ngModel\", ctx_r2.newFileName);\n  }\n}\nfunction CoreLocalFileComponent_ion_button_9_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r13 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-button\", 12);\n    i0.ɵɵlistener(\"click\", function CoreLocalFileComponent_ion_button_9_Template_ion_button_click_0_listener($event) {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r12 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r12.openFile($event, true));\n    });\n    i0.ɵɵpipe(1, \"translate\");\n    i0.ɵɵelement(2, \"ion-icon\", 13);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵattribute(\"aria-label\", i0.ɵɵpipeBind1(1, 2, ctx_r3.openButtonLabel));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"name\", ctx_r3.openButtonIcon);\n  }\n}\nfunction CoreLocalFileComponent_ng_container_10_ion_button_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-button\", 17);\n    i0.ɵɵpipe(1, \"translate\");\n    i0.ɵɵelement(2, \"ion-icon\", 18);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵattribute(\"aria-label\", i0.ɵɵpipeBind1(1, 1, \"core.save\"));\n  }\n}\nfunction CoreLocalFileComponent_ng_container_10_ion_button_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r18 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-button\", 19);\n    i0.ɵɵlistener(\"onClick\", function CoreLocalFileComponent_ng_container_10_ion_button_2_Template_ion_button_onClick_0_listener($event) {\n      i0.ɵɵrestoreView(_r18);\n      const ctx_r17 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r17.activateEdit($event));\n    });\n    i0.ɵɵpipe(1, \"translate\");\n    i0.ɵɵelement(2, \"ion-icon\", 20);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵattribute(\"aria-label\", i0.ɵɵpipeBind1(1, 1, \"core.edit\"));\n  }\n}\nfunction CoreLocalFileComponent_ng_container_10_ion_button_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r20 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-button\", 21);\n    i0.ɵɵlistener(\"click\", function CoreLocalFileComponent_ng_container_10_ion_button_3_Template_ion_button_click_0_listener($event) {\n      i0.ɵɵrestoreView(_r20);\n      const ctx_r19 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r19.deleteFile($event));\n    });\n    i0.ɵɵpipe(1, \"translate\");\n    i0.ɵɵelement(2, \"ion-icon\", 22);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵattribute(\"aria-label\", i0.ɵɵpipeBind1(1, 1, \"core.delete\"));\n  }\n}\nfunction CoreLocalFileComponent_ng_container_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, CoreLocalFileComponent_ng_container_10_ion_button_1_Template, 3, 3, \"ion-button\", 14);\n    i0.ɵɵtemplate(2, CoreLocalFileComponent_ng_container_10_ion_button_2_Template, 3, 3, \"ion-button\", 15);\n    i0.ɵɵtemplate(3, CoreLocalFileComponent_ng_container_10_ion_button_3_Template, 3, 3, \"ion-button\", 16);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r4.editMode);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r4.editMode);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r4.editMode);\n  }\n}\n/**\n * Component to handle a local file. Only files inside the app folder can be managed.\n *\n * Shows the file name, icon (depending on extension), size and time modified.\n * Also, if managing is enabled it will also show buttons to rename and delete the file.\n */\nexport class CoreLocalFileComponent {\n  constructor() {\n    this.onDelete = new EventEmitter(); // Will notify when the file is deleted.\n    this.onRename = new EventEmitter(); // Will notify when the file is renamed.\n    this.onClick = new EventEmitter(); // Will notify when the file is clicked. Only if overrideClick is true.\n    this.newFileName = '';\n    this.editMode = false;\n    this.relativePath = '';\n    this.isIOS = false;\n    this.openButtonIcon = '';\n    this.openButtonLabel = '';\n    this.defaultIsOpenWithPicker = false;\n  }\n  /**\n   * @inheritdoc\n   */\n  ngOnInit() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      _this.manage = CoreUtils.isTrueOrOne(_this.manage);\n      if (!_this.file) {\n        return;\n      }\n      _this.loadFileBasicData(_this.file);\n      // Get the size and timemodified.\n      const metadata = yield CoreFile.getMetadata(_this.file);\n      if (metadata.size >= 0) {\n        _this.size = CoreTextUtils.bytesToSize(metadata.size, 2);\n      }\n      _this.timemodified = CoreTimeUtils.userDate(metadata.modificationTime.getTime(), 'core.strftimedatetimeshort');\n      _this.isIOS = CorePlatform.isIOS();\n      _this.defaultIsOpenWithPicker = CoreFileHelper.defaultIsOpenWithPicker();\n      _this.openButtonIcon = _this.defaultIsOpenWithPicker ? 'fas-file' : 'fas-share-from-square';\n      _this.openButtonLabel = _this.defaultIsOpenWithPicker ? 'core.openfile' : 'core.openwith';\n    })();\n  }\n  /**\n   * Load the basic data for the file.\n   */\n  loadFileBasicData(file) {\n    this.fileName = file.name;\n    this.fileIcon = CoreMimetypeUtils.getFileIcon(file.name);\n    this.fileExtension = CoreMimetypeUtils.getFileExtension(file.name);\n    // Let's calculate the relative path for the file.\n    this.relativePath = CoreFile.removeBasePath(file.toURL());\n    if (!this.relativePath) {\n      // Didn't find basePath, use fullPath but if the user tries to manage the file it'll probably fail.\n      this.relativePath = file.fullPath;\n    }\n  }\n  /**\n   * Open file.\n   *\n   * @param e Click event.\n   * @param isOpenButton Whether the open button was clicked.\n   */\n  openFile(e, isOpenButton = false) {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      if (_this2.editMode || !_this2.file) {\n        return;\n      }\n      e.preventDefault();\n      e.stopPropagation();\n      if (!isOpenButton && CoreUtils.isTrueOrOne(_this2.overrideClick) && _this2.onClick.observed) {\n        _this2.onClick.emit();\n        return;\n      }\n      if (!CoreFileHelper.isOpenableInApp(_this2.file)) {\n        try {\n          yield CoreFileHelper.showConfirmOpenUnsupportedFile(false, _this2.file);\n        } catch (error) {\n          return; // Cancelled, stop.\n        }\n      }\n\n      const options = {};\n      if (isOpenButton) {\n        // Use the non-default method.\n        options.iOSOpenFileAction = _this2.defaultIsOpenWithPicker ? OpenFileAction.OPEN : OpenFileAction.OPEN_WITH;\n      }\n      CoreUtils.openFile(_this2.file.toURL(), options);\n    })();\n  }\n  /**\n   * Activate the edit mode.\n   *\n   * @param e Click event.\n   */\n  activateEdit(e) {\n    if (!this.file) {\n      return;\n    }\n    e.preventDefault();\n    e.stopPropagation();\n    this.editMode = true;\n    this.newFileName = this.file.name;\n  }\n  /**\n   * Rename the file.\n   *\n   * @param newName New name.\n   * @param e Click event.\n   */\n  changeName(newName, e) {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      if (!_this3.file) {\n        return;\n      }\n      e.preventDefault();\n      e.stopPropagation();\n      if (newName == _this3.file.name) {\n        // Name hasn't changed, stop.\n        _this3.editMode = false;\n        CoreForms.triggerFormCancelledEvent(_this3.formElement, CoreSites.getCurrentSiteId());\n        return;\n      }\n      const modal = yield CoreDomUtils.showModalLoading();\n      const fileAndDir = CoreFile.getFileAndDirectoryFromPath(_this3.relativePath);\n      const newPath = CorePath.concatenatePaths(fileAndDir.directory, newName);\n      try {\n        // Check if there's a file with this name.\n        yield CoreFile.getFile(newPath);\n        // There's a file with this name, show error and stop.\n        CoreDomUtils.showErrorModal('core.errorfileexistssamename', true);\n      } catch (_unused) {\n        try {\n          // File doesn't exist, move it.\n          const fileEntry = yield CoreFile.moveFile(_this3.relativePath, newPath);\n          CoreForms.triggerFormSubmittedEvent(_this3.formElement, false, CoreSites.getCurrentSiteId());\n          _this3.editMode = false;\n          _this3.file = fileEntry;\n          _this3.loadFileBasicData(_this3.file);\n          _this3.onRename.emit({\n            file: _this3.file\n          });\n        } catch (error) {\n          CoreDomUtils.showErrorModalDefault(error, 'core.errorrenamefile', true);\n        }\n      } finally {\n        modal.dismiss();\n      }\n    })();\n  }\n  /**\n   * Delete the file.\n   *\n   * @param e Click event.\n   */\n  deleteFile(e) {\n    var _this4 = this;\n    return _asyncToGenerator(function* () {\n      e.preventDefault();\n      e.stopPropagation();\n      let modal;\n      try {\n        // Ask confirmation.\n        yield CoreDomUtils.showDeleteConfirm('core.confirmdeletefile');\n        modal = yield CoreDomUtils.showModalLoading('core.deleting', true);\n        yield CoreFile.removeFile(_this4.relativePath);\n        _this4.onDelete.emit();\n      } catch (error) {\n        CoreDomUtils.showErrorModalDefault(error, 'core.errordeletefile', true);\n      } finally {\n        var _modal;\n        (_modal = modal) === null || _modal === void 0 || _modal.dismiss();\n      }\n    })();\n  }\n}\n_class = CoreLocalFileComponent;\n_class.ɵfac = function CoreLocalFileComponent_Factory(t) {\n  return new (t || _class)();\n};\n_class.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: _class,\n  selectors: [[\"core-local-file\"]],\n  viewQuery: function CoreLocalFileComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(_c0, 5);\n    }\n    if (rf & 2) {\n      let _t;\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.formElement = _t.first);\n    }\n  },\n  inputs: {\n    file: \"file\",\n    manage: \"manage\",\n    overrideClick: \"overrideClick\"\n  },\n  outputs: {\n    onDelete: \"onDelete\",\n    onRename: \"onRename\",\n    onClick: \"onClick\"\n  },\n  decls: 11,\n  vars: 7,\n  consts: [[3, \"ngSubmit\"], [\"nameForm\", \"\"], [1, \"card-file\"], [\"button\", \"\", 1, \"ion-text-wrap\", \"item-file\", 3, \"detail\", \"click\"], [\"slot\", \"start\"], [\"role\", \"presentation\", 3, \"src\", \"alt\"], [4, \"ngIf\"], [\"type\", \"text\", \"name\", \"filename\", \"autocapitalize\", \"none\", \"autocorrect\", \"off\", \"core-auto-focus\", \"\", 3, \"placeholder\", \"ngModel\", \"click\", \"ngModelChange\", 4, \"ngIf\"], [\"slot\", \"end\", 1, \"buttons\"], [\"fill\", \"clear\", 3, \"click\", 4, \"ngIf\"], [1, \"item-heading\"], [\"type\", \"text\", \"name\", \"filename\", \"autocapitalize\", \"none\", \"autocorrect\", \"off\", \"core-auto-focus\", \"\", 3, \"placeholder\", \"ngModel\", \"click\", \"ngModelChange\"], [\"fill\", \"clear\", 3, \"click\"], [\"slot\", \"icon-only\", \"aria-hidden\", \"true\", 3, \"name\"], [\"fill\", \"clear\", \"color\", \"success\", \"type\", \"submit\", 4, \"ngIf\"], [\"fill\", \"clear\", 3, \"core-suppress-events\", \"onClick\", 4, \"ngIf\"], [\"fill\", \"clear\", \"color\", \"danger\", 3, \"click\", 4, \"ngIf\"], [\"fill\", \"clear\", \"color\", \"success\", \"type\", \"submit\"], [\"name\", \"fas-check\", \"slot\", \"icon-only\", \"aria-hidden\", \"true\"], [\"fill\", \"clear\", 3, \"core-suppress-events\", \"onClick\"], [\"name\", \"fas-pen\", \"slot\", \"icon-only\", \"aria-hidden\", \"true\"], [\"fill\", \"clear\", \"color\", \"danger\", 3, \"click\"], [\"name\", \"fas-trash\", \"slot\", \"icon-only\", \"aria-hidden\", \"true\"]],\n  template: function CoreLocalFileComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"form\", 0, 1);\n      i0.ɵɵlistener(\"ngSubmit\", function CoreLocalFileComponent_Template_form_ngSubmit_0_listener($event) {\n        return ctx.changeName(ctx.newFileName, $event);\n      });\n      i0.ɵɵelementStart(2, \"ion-card\", 2)(3, \"ion-item\", 3);\n      i0.ɵɵlistener(\"click\", function CoreLocalFileComponent_Template_ion_item_click_3_listener($event) {\n        return ctx.openFile($event);\n      });\n      i0.ɵɵelementStart(4, \"ion-thumbnail\", 4);\n      i0.ɵɵelement(5, \"img\", 5);\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(6, CoreLocalFileComponent_ion_label_6_Template, 4, 2, \"ion-label\", 6);\n      i0.ɵɵtemplate(7, CoreLocalFileComponent_ion_input_7_Template, 2, 4, \"ion-input\", 7);\n      i0.ɵɵelementStart(8, \"div\", 8);\n      i0.ɵɵtemplate(9, CoreLocalFileComponent_ion_button_9_Template, 3, 4, \"ion-button\", 9);\n      i0.ɵɵtemplate(10, CoreLocalFileComponent_ng_container_10_Template, 4, 3, \"ng-container\", 6);\n      i0.ɵɵelementEnd()()()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"detail\", false);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"src\", ctx.fileIcon, i0.ɵɵsanitizeUrl)(\"alt\", ctx.fileExtension);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", !ctx.editMode);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.editMode);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", ctx.isIOS && !ctx.editMode);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.manage);\n    }\n  },\n  encapsulation: 2\n});","map":{"version":3,"names":["EventEmitter","CoreFile","CoreFileHelper","CoreSites","CoreDomUtils","CoreMimetypeUtils","CoreTextUtils","CoreTimeUtils","CoreUtils","OpenFileAction","CoreForms","CorePath","CorePlatform","i0","ɵɵelementContainerStart","ɵɵtext","ɵɵelementContainerEnd","ɵɵadvance","ɵɵtextInterpolate","ctx_r6","size","ctx_r8","timemodified","ɵɵelementStart","ɵɵtemplate","CoreLocalFileComponent_ion_label_6_p_3_ng_container_1_Template","CoreLocalFileComponent_ion_label_6_p_3_ng_container_2_Template","CoreLocalFileComponent_ion_label_6_p_3_ng_container_3_Template","ɵɵelementEnd","ɵɵproperty","ctx_r5","CoreLocalFileComponent_ion_label_6_p_3_Template","ctx_r1","fileName","ɵɵlistener","CoreLocalFileComponent_ion_input_7_Template_ion_input_click_0_listener","$event","stopPropagation","CoreLocalFileComponent_ion_input_7_Template_ion_input_ngModelChange_0_listener","ɵɵrestoreView","_r11","ctx_r10","ɵɵnextContext","ɵɵresetView","newFileName","ɵɵpipeBind1","ctx_r2","CoreLocalFileComponent_ion_button_9_Template_ion_button_click_0_listener","_r13","ctx_r12","openFile","ɵɵelement","ɵɵattribute","ctx_r3","openButtonLabel","openButtonIcon","CoreLocalFileComponent_ng_container_10_ion_button_2_Template_ion_button_onClick_0_listener","_r18","ctx_r17","activateEdit","CoreLocalFileComponent_ng_container_10_ion_button_3_Template_ion_button_click_0_listener","_r20","ctx_r19","deleteFile","CoreLocalFileComponent_ng_container_10_ion_button_1_Template","CoreLocalFileComponent_ng_container_10_ion_button_2_Template","CoreLocalFileComponent_ng_container_10_ion_button_3_Template","ctx_r4","editMode","CoreLocalFileComponent","constructor","onDelete","onRename","onClick","relativePath","isIOS","defaultIsOpenWithPicker","ngOnInit","_this","_asyncToGenerator","manage","isTrueOrOne","file","loadFileBasicData","metadata","getMetadata","bytesToSize","userDate","modificationTime","getTime","name","fileIcon","getFileIcon","fileExtension","getFileExtension","removeBasePath","toURL","fullPath","e","isOpenButton","_this2","preventDefault","overrideClick","observed","emit","isOpenableInApp","showConfirmOpenUnsupportedFile","error","options","iOSOpenFileAction","OPEN","OPEN_WITH","changeName","newName","_this3","triggerFormCancelledEvent","formElement","getCurrentSiteId","modal","showModalLoading","fileAndDir","getFileAndDirectoryFromPath","newPath","concatenatePaths","directory","getFile","showErrorModal","_unused","fileEntry","moveFile","triggerFormSubmittedEvent","showErrorModalDefault","dismiss","_this4","showDeleteConfirm","removeFile","_modal","selectors","viewQuery","CoreLocalFileComponent_Query","rf","ctx","CoreLocalFileComponent_Template_form_ngSubmit_0_listener","CoreLocalFileComponent_Template_ion_item_click_3_listener","CoreLocalFileComponent_ion_label_6_Template","CoreLocalFileComponent_ion_input_7_Template","CoreLocalFileComponent_ion_button_9_Template","CoreLocalFileComponent_ng_container_10_Template","ɵɵsanitizeUrl"],"sources":["/home/toon/works/gitionic7/ionic-github/ionic/src/core/components/local-file/local-file.ts","/home/toon/works/gitionic7/ionic-github/ionic/src/core/components/local-file/core-local-file.html"],"sourcesContent":["// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Component, Input, Output, OnInit, EventEmitter, ViewChild, ElementRef } from '@angular/core';\nimport { FileEntry } from '@awesome-cordova-plugins/file/ngx';\n\nimport { CoreIonLoadingElement } from '@classes/ion-loading';\nimport { CoreFile } from '@services/file';\nimport { CoreFileHelper } from '@services/file-helper';\nimport { CoreSites } from '@services/sites';\nimport { CoreDomUtils } from '@services/utils/dom';\nimport { CoreMimetypeUtils } from '@services/utils/mimetype';\nimport { CoreTextUtils } from '@services/utils/text';\nimport { CoreTimeUtils } from '@services/utils/time';\nimport { CoreUtils, CoreUtilsOpenFileOptions, OpenFileAction } from '@services/utils/utils';\nimport { CoreForms } from '@singletons/form';\nimport { CorePath } from '@singletons/path';\nimport { CorePlatform } from '@services/platform';\n\n/**\n * Component to handle a local file. Only files inside the app folder can be managed.\n *\n * Shows the file name, icon (depending on extension), size and time modified.\n * Also, if managing is enabled it will also show buttons to rename and delete the file.\n */\n@Component({\n    selector: 'core-local-file',\n    templateUrl: 'core-local-file.html',\n})\nexport class CoreLocalFileComponent implements OnInit {\n\n    @Input() file?: FileEntry; // A fileEntry retrieved using CoreFileProvider.getFile or similar.\n    @Input() manage?: boolean | string; // Whether the user can manage the file (edit and delete).\n    @Input() overrideClick?: boolean | string; // Whether the default item click should be overridden.\n    @Output() onDelete = new EventEmitter<void>(); // Will notify when the file is deleted.\n    @Output() onRename = new EventEmitter<{ file: FileEntry }>(); // Will notify when the file is renamed.\n    @Output() onClick = new EventEmitter<void>(); // Will notify when the file is clicked. Only if overrideClick is true.\n\n    @ViewChild('nameForm') formElement?: ElementRef;\n\n    fileName?: string;\n    fileIcon?: string;\n    fileExtension?: string;\n    size?: string;\n    timemodified?: string;\n    newFileName = '';\n    editMode = false;\n    relativePath = '';\n    isIOS = false;\n    openButtonIcon = '';\n    openButtonLabel = '';\n\n    protected defaultIsOpenWithPicker = false;\n\n    /**\n     * @inheritdoc\n     */\n    async ngOnInit(): Promise<void> {\n        this.manage = CoreUtils.isTrueOrOne(this.manage);\n\n        if (!this.file) {\n            return;\n        }\n\n        this.loadFileBasicData(this.file);\n\n        // Get the size and timemodified.\n        const metadata = await CoreFile.getMetadata(this.file);\n        if (metadata.size >= 0) {\n            this.size = CoreTextUtils.bytesToSize(metadata.size, 2);\n        }\n\n        this.timemodified = CoreTimeUtils.userDate(metadata.modificationTime.getTime(), 'core.strftimedatetimeshort');\n\n        this.isIOS = CorePlatform.isIOS();\n        this.defaultIsOpenWithPicker = CoreFileHelper.defaultIsOpenWithPicker();\n        this.openButtonIcon = this.defaultIsOpenWithPicker ? 'fas-file' : 'fas-share-from-square';\n        this.openButtonLabel = this.defaultIsOpenWithPicker ? 'core.openfile' : 'core.openwith';\n    }\n\n    /**\n     * Load the basic data for the file.\n     */\n    protected loadFileBasicData(file: FileEntry): void {\n        this.fileName = file.name;\n        this.fileIcon = CoreMimetypeUtils.getFileIcon(file.name);\n        this.fileExtension = CoreMimetypeUtils.getFileExtension(file.name);\n\n        // Let's calculate the relative path for the file.\n        this.relativePath = CoreFile.removeBasePath(file.toURL());\n        if (!this.relativePath) {\n            // Didn't find basePath, use fullPath but if the user tries to manage the file it'll probably fail.\n            this.relativePath = file.fullPath;\n        }\n    }\n\n    /**\n     * Open file.\n     *\n     * @param e Click event.\n     * @param isOpenButton Whether the open button was clicked.\n     */\n    async openFile(e: Event, isOpenButton = false): Promise<void> {\n        if (this.editMode || !this.file) {\n            return;\n        }\n\n        e.preventDefault();\n        e.stopPropagation();\n\n        if (!isOpenButton && CoreUtils.isTrueOrOne(this.overrideClick) && this.onClick.observed) {\n            this.onClick.emit();\n\n            return;\n        }\n\n        if (!CoreFileHelper.isOpenableInApp(this.file)) {\n            try {\n                await CoreFileHelper.showConfirmOpenUnsupportedFile(false, this.file);\n            } catch (error) {\n                return; // Cancelled, stop.\n            }\n        }\n\n        const options: CoreUtilsOpenFileOptions = {};\n        if (isOpenButton) {\n            // Use the non-default method.\n            options.iOSOpenFileAction = this.defaultIsOpenWithPicker ? OpenFileAction.OPEN : OpenFileAction.OPEN_WITH;\n        }\n\n        CoreUtils.openFile(this.file.toURL(), options);\n    }\n\n    /**\n     * Activate the edit mode.\n     *\n     * @param e Click event.\n     */\n    activateEdit(e: Event): void {\n        if (!this.file) {\n            return;\n        }\n\n        e.preventDefault();\n        e.stopPropagation();\n\n        this.editMode = true;\n        this.newFileName = this.file.name;\n    }\n\n    /**\n     * Rename the file.\n     *\n     * @param newName New name.\n     * @param e Click event.\n     */\n    async changeName(newName: string, e: Event): Promise<void> {\n        if (!this.file) {\n            return;\n        }\n\n        e.preventDefault();\n        e.stopPropagation();\n\n        if (newName == this.file.name) {\n            // Name hasn't changed, stop.\n            this.editMode = false;\n            CoreForms.triggerFormCancelledEvent(this.formElement, CoreSites.getCurrentSiteId());\n\n            return;\n        }\n\n        const modal = await CoreDomUtils.showModalLoading();\n        const fileAndDir = CoreFile.getFileAndDirectoryFromPath(this.relativePath);\n        const newPath = CorePath.concatenatePaths(fileAndDir.directory, newName);\n\n        try {\n            // Check if there's a file with this name.\n            await CoreFile.getFile(newPath);\n\n            // There's a file with this name, show error and stop.\n            CoreDomUtils.showErrorModal('core.errorfileexistssamename', true);\n        } catch {\n            try {\n                // File doesn't exist, move it.\n                const fileEntry = await CoreFile.moveFile(this.relativePath, newPath);\n\n                CoreForms.triggerFormSubmittedEvent(this.formElement, false, CoreSites.getCurrentSiteId());\n\n                this.editMode = false;\n                this.file = fileEntry;\n                this.loadFileBasicData(this.file);\n                this.onRename.emit({ file: this.file });\n            } catch (error) {\n                CoreDomUtils.showErrorModalDefault(error, 'core.errorrenamefile', true);\n            }\n        } finally {\n            modal.dismiss();\n        }\n    }\n\n    /**\n     * Delete the file.\n     *\n     * @param e Click event.\n     */\n    async deleteFile(e: Event): Promise<void> {\n        e.preventDefault();\n        e.stopPropagation();\n\n        let modal: CoreIonLoadingElement | undefined;\n\n        try {\n            // Ask confirmation.\n            await CoreDomUtils.showDeleteConfirm('core.confirmdeletefile');\n\n            modal = await CoreDomUtils.showModalLoading('core.deleting', true);\n\n            await CoreFile.removeFile(this.relativePath);\n\n            this.onDelete.emit();\n        } catch (error) {\n            CoreDomUtils.showErrorModalDefault(error, 'core.errordeletefile', true);\n        } finally {\n            modal?.dismiss();\n        }\n    }\n\n}\n","<form (ngSubmit)=\"changeName(newFileName, $event)\" #nameForm>\n    <ion-card class=\"card-file\">\n        <ion-item class=\"ion-text-wrap item-file\" (click)=\"openFile($event)\" button [detail]=\"false\">\n            <ion-thumbnail slot=\"start\">\n                <img [src]=\"fileIcon\" [alt]=\"fileExtension\" role=\"presentation\" />\n            </ion-thumbnail>\n\n            <ion-label *ngIf=\"!editMode\">\n                <!-- File name and edit button (if editable). -->\n                <p class=\"item-heading\">{{fileName}}</p>\n                <!-- More data about the file. -->\n                <p *ngIf=\"size || timemodified\">\n                    <ng-container *ngIf=\"size\">{{ size }}</ng-container>\n                    <ng-container *ngIf=\"size && timemodified\"> · </ng-container>\n                    <ng-container *ngIf=\"timemodified\">{{ timemodified }}</ng-container>\n                </p>\n            </ion-label>\n\n            <!-- Form to edit the file's name. -->\n            <ion-input type=\"text\" name=\"filename\" [placeholder]=\"'core.filename' | translate\" autocapitalize=\"none\" autocorrect=\"off\"\n                (click)=\"$event.stopPropagation()\" core-auto-focus [(ngModel)]=\"newFileName\" *ngIf=\"editMode\" />\n\n            <div class=\"buttons\" slot=\"end\">\n                <ion-button fill=\"clear\" *ngIf=\"isIOS && !editMode\" (click)=\"openFile($event, true)\"\n                    [attr.aria-label]=\"openButtonLabel | translate\">\n                    <ion-icon slot=\"icon-only\" [name]=\"openButtonIcon\" aria-hidden=\"true\" />\n                </ion-button>\n\n                <ng-container *ngIf=\"manage\">\n                    <ion-button *ngIf=\"editMode\" fill=\"clear\" [attr.aria-label]=\"'core.save' | translate\" color=\"success\" type=\"submit\">\n                        <ion-icon name=\"fas-check\" slot=\"icon-only\" aria-hidden=\"true\" />\n                    </ion-button>\n\n                    <ion-button *ngIf=\"!editMode\" fill=\"clear\" [core-suppress-events] (onClick)=\"activateEdit($event)\"\n                        [attr.aria-label]=\"'core.edit' | translate\">\n                        <ion-icon name=\"fas-pen\" slot=\"icon-only\" aria-hidden=\"true\" />\n                    </ion-button>\n\n                    <ion-button *ngIf=\"!editMode\" fill=\"clear\" (click)=\"deleteFile($event)\" [attr.aria-label]=\"'core.delete' | translate\"\n                        color=\"danger\">\n                        <ion-icon name=\"fas-trash\" slot=\"icon-only\" aria-hidden=\"true\" />\n                    </ion-button>\n                </ng-container>\n            </div>\n        </ion-item>\n    </ion-card>\n</form>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
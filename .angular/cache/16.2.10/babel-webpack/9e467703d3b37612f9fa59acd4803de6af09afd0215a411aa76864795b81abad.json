{"ast":null,"code":"import _asyncToGenerator from \"/home/toon/works/gitionic7/ionic-github/ionic/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _class;\nimport { IonContent } from '@ionic/angular';\nimport { CoreEvents } from '@singletons/events';\nimport { CoreSites } from '@services/sites';\nimport { AddonMessagesProvider, AddonMessages } from '../../services/messages';\nimport { AddonMessagesOffline } from '../../services/messages-offline';\nimport { AddonMessagesSync, AddonMessagesSyncProvider } from '../../services/messages-sync';\nimport { CoreUser } from '@features/user/services/user';\nimport { CoreDomUtils } from '@services/utils/dom';\nimport { CoreUtils } from '@services/utils/utils';\nimport { CoreTextUtils } from '@services/utils/text';\nimport { CoreLogger } from '@singletons/logger';\nimport { CoreApp } from '@services/app';\nimport { CoreInfiniteLoadingComponent } from '@components/infinite-loading/infinite-loading';\nimport { Md5 } from 'ts-md5/dist/md5';\nimport moment from 'moment-timezone';\nimport { CoreError } from '@classes/errors/error';\nimport { Translate } from '@singletons';\nimport { CoreNavigator } from '@services/navigator';\nimport { CoreConstants } from '@/core/constants';\nimport { CoreDom } from '@singletons/dom';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"../../../../core/components/context-menu/context-menu\";\nimport * as i4 from \"../../../../core/components/context-menu/context-menu-item\";\nimport * as i5 from \"../../../../core/components/empty-box/empty-box\";\nimport * as i6 from \"../../../../core/components/infinite-loading/infinite-loading\";\nimport * as i7 from \"../../../../core/components/loading/loading\";\nimport * as i8 from \"../../../../core/components/message/message\";\nimport * as i9 from \"../../../../core/components/navbar-buttons/navbar-buttons\";\nimport * as i10 from \"../../../../core/components/send-message-form/send-message-form\";\nimport * as i11 from \"../../../../core/components/user-avatar/user-avatar\";\nimport * as i12 from \"../../../../core/directives/external-content\";\nimport * as i13 from \"../../../../core/directives/fab\";\nimport * as i14 from \"../../../../core/directives/fa-icon\";\nimport * as i15 from \"../../../../core/directives/format-text\";\nimport * as i16 from \"../../../../core/directives/content\";\nimport * as i17 from \"../../../../core/directives/update-non-reactive-attributes\";\nimport * as i18 from \"@ionic/angular\";\nimport * as i19 from \"../../../../core/pipes/format-date\";\nimport * as i20 from \"@ngx-translate/core\";\nfunction AddonMessagesDiscussionPage_img_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"img\", 25);\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"src\", ctx_r0.conversationImage, i0.ɵɵsanitizeUrl)(\"siteId\", ctx_r0.siteId);\n  }\n}\nfunction AddonMessagesDiscussionPage_core_user_avatar_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"core-user-avatar\", 26);\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"user\", ctx_r1.otherMember)(\"linkProfile\", false)(\"checkOnline\", ctx_r1.otherMember.showonlinestatus);\n  }\n}\nfunction AddonMessagesDiscussionPage_ion_icon_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"ion-icon\", 27);\n    i0.ɵɵpipe(1, \"translate\");\n  }\n  if (rf & 2) {\n    i0.ɵɵattribute(\"aria-label\", i0.ɵɵpipeBind1(1, 1, \"core.favourites\"));\n  }\n}\nfunction AddonMessagesDiscussionPage_ion_icon_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"ion-icon\", 28);\n    i0.ɵɵpipe(1, \"translate\");\n  }\n  if (rf & 2) {\n    i0.ɵɵattribute(\"aria-label\", i0.ɵɵpipeBind1(1, 1, \"addon.messages.mutedconversation\"));\n  }\n}\nfunction AddonMessagesDiscussionPage_ng_container_39_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"p\", 29);\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"p\", 29)(5, \"em\");\n    i0.ɵɵtext(6);\n    i0.ɵɵpipe(7, \"translate\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(3, 2, \"addon.messages.selfconversation\"));\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(7, 4, \"addon.messages.selfconversationdefaultmessage\"));\n  }\n}\nfunction AddonMessagesDiscussionPage_ng_container_43_h3_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h3\", 33);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"coreFormatDate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const message_r9 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind2(2, 1, message_r9.timecreated, \"strftimedayshort\"), \" \");\n  }\n}\nfunction AddonMessagesDiscussionPage_ng_container_43_ion_chip_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-chip\", 34)(1, \"ion-label\");\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(4, \"ion-icon\", 35);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(3, 1, \"addon.messages.newmessages\"));\n  }\n}\nfunction AddonMessagesDiscussionPage_ng_container_43_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r16 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, AddonMessagesDiscussionPage_ng_container_43_h3_1_Template, 3, 4, \"h3\", 30);\n    i0.ɵɵtemplate(2, AddonMessagesDiscussionPage_ng_container_43_ion_chip_2_Template, 5, 3, \"ion-chip\", 31);\n    i0.ɵɵelementStart(3, \"core-message\", 32);\n    i0.ɵɵlistener(\"afterRender\", function AddonMessagesDiscussionPage_ng_container_43_Template_core_message_afterRender_3_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r16);\n      const last_r11 = restoredCtx.last;\n      const ctx_r15 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(last_r11 && ctx_r15.scrollToBottom());\n    })(\"onDeleteMessage\", function AddonMessagesDiscussionPage_ng_container_43_Template_core_message_onDeleteMessage_3_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r16);\n      const message_r9 = restoredCtx.$implicit;\n      const index_r10 = restoredCtx.index;\n      const ctx_r17 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r17.deleteMessage(message_r9, index_r10));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const message_r9 = ctx.$implicit;\n    const ctx_r5 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", message_r9.showDate);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r5.unreadMessageFrom > 0 && message_r9.id === ctx_r5.unreadMessageFrom);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"message\", message_r9)(\"user\", ctx_r5.members[message_r9.useridfrom])(\"text\", message_r9.text)(\"showDelete\", ctx_r5.showDelete)(\"time\", message_r9.timecreated);\n  }\n}\nfunction AddonMessagesDiscussionPage_core_empty_box_44_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"core-empty-box\", 36);\n    i0.ɵɵpipe(1, \"translate\");\n  }\n  if (rf & 2) {\n    i0.ɵɵproperty(\"message\", i0.ɵɵpipeBind1(1, 1, \"addon.messages.nomessagesfound\"));\n  }\n}\nfunction AddonMessagesDiscussionPage_ion_fab_45_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r19 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-fab\", 37)(1, \"ion-fab-button\", 38);\n    i0.ɵɵlistener(\"click\", function AddonMessagesDiscussionPage_ion_fab_45_Template_ion_fab_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r19);\n      const ctx_r18 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r18.scrollToFirstUnreadMessage());\n    });\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelement(3, \"ion-icon\", 35);\n    i0.ɵɵelementStart(4, \"span\", 19);\n    i0.ɵɵtext(5);\n    i0.ɵɵpipe(6, \"translate\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(7, \"ion-badge\", 39);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r7 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵattribute(\"aria-label\", i0.ɵɵpipeBind1(2, 3, \"addon.messages.newmessages\"));\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(6, 5, \"addon.messages.newmessages\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(ctx_r7.newMessages);\n  }\n}\nfunction AddonMessagesDiscussionPage_ion_footer_46_p_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 45);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(2, 1, \"addon.messages.unabletomessage\"), \" \");\n  }\n}\nfunction AddonMessagesDiscussionPage_ion_footer_46_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r27 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 46)(1, \"p\", 29);\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"ion-button\", 47);\n    i0.ɵɵlistener(\"click\", function AddonMessagesDiscussionPage_ion_footer_46_div_3_Template_ion_button_click_4_listener() {\n      i0.ɵɵrestoreView(_r27);\n      const ctx_r26 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r26.unblockUser());\n    });\n    i0.ɵɵtext(5);\n    i0.ɵɵpipe(6, \"translate\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(3, 2, \"addon.messages.youhaveblockeduser\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(6, 4, \"addon.messages.unblockuser\"), \" \");\n  }\n}\nconst _c0 = function (a0) {\n  return {\n    $a: a0\n  };\n};\nfunction AddonMessagesDiscussionPage_ion_footer_46_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r29 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 46)(1, \"p\", 29)(2, \"strong\");\n    i0.ɵɵtext(3);\n    i0.ɵɵpipe(4, \"translate\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"p\", 29);\n    i0.ɵɵtext(6);\n    i0.ɵɵpipe(7, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"ion-button\", 47);\n    i0.ɵɵlistener(\"click\", function AddonMessagesDiscussionPage_ion_footer_46_div_4_Template_ion_button_click_8_listener() {\n      i0.ɵɵrestoreView(_r29);\n      const ctx_r28 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r28.createContactRequest());\n    });\n    i0.ɵɵtext(9);\n    i0.ɵɵpipe(10, \"translate\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r22 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(4, 3, \"addon.messages.isnotinyourcontacts\", i0.ɵɵpureFunction1(11, _c0, ctx_r22.otherMember.fullname)));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(7, 6, \"addon.messages.requirecontacttomessage\", i0.ɵɵpureFunction1(13, _c0, ctx_r22.otherMember.fullname)));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(10, 9, \"addon.messages.sendcontactrequest\"), \" \");\n  }\n}\nfunction AddonMessagesDiscussionPage_ion_footer_46_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r31 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 46)(1, \"p\", 29);\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"ion-button\", 47);\n    i0.ɵɵlistener(\"click\", function AddonMessagesDiscussionPage_ion_footer_46_div_5_Template_ion_button_click_4_listener() {\n      i0.ɵɵrestoreView(_r31);\n      const ctx_r30 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r30.confirmContactRequest());\n    });\n    i0.ɵɵtext(5);\n    i0.ɵɵpipe(6, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"ion-button\", 48);\n    i0.ɵɵlistener(\"click\", function AddonMessagesDiscussionPage_ion_footer_46_div_5_Template_ion_button_click_7_listener() {\n      i0.ɵɵrestoreView(_r31);\n      const ctx_r32 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r32.declineContactRequest());\n    });\n    i0.ɵɵtext(8);\n    i0.ɵɵpipe(9, \"translate\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r23 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(3, 3, \"addon.messages.userwouldliketocontactyou\", i0.ɵɵpureFunction1(10, _c0, ctx_r23.otherMember.fullname)));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(6, 6, \"addon.messages.acceptandaddcontact\"), \" \");\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(9, 8, \"addon.messages.decline\"), \" \");\n  }\n}\nfunction AddonMessagesDiscussionPage_ion_footer_46_div_6_p_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 29);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r33 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind2(2, 1, \"addon.messages.yourcontactrequestpending\", i0.ɵɵpureFunction1(4, _c0, ctx_r33.otherMember.fullname)), \" \");\n  }\n}\nfunction AddonMessagesDiscussionPage_ion_footer_46_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 46)(1, \"p\", 29)(2, \"strong\");\n    i0.ɵɵtext(3);\n    i0.ɵɵpipe(4, \"translate\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(5, AddonMessagesDiscussionPage_ion_footer_46_div_6_p_5_Template, 3, 6, \"p\", 49);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r24 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(4, 2, \"addon.messages.contactrequestsent\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r24.otherMember);\n  }\n}\nfunction AddonMessagesDiscussionPage_ion_footer_46_core_send_message_form_7_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r35 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"core-send-message-form\", 50);\n    i0.ɵɵlistener(\"onSubmit\", function AddonMessagesDiscussionPage_ion_footer_46_core_send_message_form_7_Template_core_send_message_form_onSubmit_0_listener($event) {\n      i0.ɵɵrestoreView(_r35);\n      const ctx_r34 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r34.sendMessage($event));\n    });\n    i0.ɵɵpipe(1, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r25 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"showKeyboard\", ctx_r25.showKeyboard)(\"placeholder\", i0.ɵɵpipeBind1(1, 2, \"addon.messages.newmessage\"));\n  }\n}\nfunction AddonMessagesDiscussionPage_ion_footer_46_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-footer\", 40)(1, \"ion-toolbar\", 41);\n    i0.ɵɵtemplate(2, AddonMessagesDiscussionPage_ion_footer_46_p_2_Template, 3, 3, \"p\", 42);\n    i0.ɵɵtemplate(3, AddonMessagesDiscussionPage_ion_footer_46_div_3_Template, 7, 6, \"div\", 43);\n    i0.ɵɵtemplate(4, AddonMessagesDiscussionPage_ion_footer_46_div_4_Template, 11, 15, \"div\", 43);\n    i0.ɵɵtemplate(5, AddonMessagesDiscussionPage_ion_footer_46_div_5_Template, 10, 12, \"div\", 43);\n    i0.ɵɵtemplate(6, AddonMessagesDiscussionPage_ion_footer_46_div_6_Template, 6, 4, \"div\", 43);\n    i0.ɵɵtemplate(7, AddonMessagesDiscussionPage_ion_footer_46_core_send_message_form_7_Template, 2, 4, \"core-send-message-form\", 44);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r8 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"color\", ctx_r8.footerType === \"message\" ? null : \"light\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r8.footerType === \"unable\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r8.footerType === \"blocked\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r8.footerType === \"requiresContact\" && ctx_r8.otherMember);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r8.footerType === \"requestReceived\" && ctx_r8.otherMember);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r8.footerType === \"requestSent\" || ctx_r8.footerType === \"message\" && ctx_r8.requestContactSent);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r8.footerType === \"message\");\n  }\n}\n/**\n * Page that displays a message discussion page.\n */\nexport class AddonMessagesDiscussionPage {\n  constructor(route, elementRef) {\n    this.route = route;\n    this.elementRef = elementRef;\n    this.fetching = false;\n    this.messagesBeingSent = 0;\n    this.pagesLoaded = 1;\n    this.keepMessageMap = {};\n    this.oldContentHeight = 0;\n    this.scrollBottom = true;\n    this.viewDestroyed = false;\n    this.showLoadingModal = false; // Whether to show a loading modal while fetching data.\n    this.showInfo = false;\n    this.loaded = false;\n    this.showKeyboard = false;\n    this.canLoadMore = false;\n    this.loadMoreError = false;\n    this.messages = [];\n    this.showDelete = false;\n    this.canDelete = false;\n    this.isGroup = false;\n    this.members = {}; // Members that wrote a message, indexed by ID.\n    this.favouriteIcon = 'fa-star';\n    this.deleteIcon = 'fas-trash';\n    this.blockIcon = 'fas-user-lock';\n    this.addRemoveIcon = 'fas-user-plus';\n    this.muteIcon = 'fas-bell-slash';\n    this.favouriteIconSlash = false;\n    this.muteEnabled = false;\n    this.footerType = 'unable';\n    this.requestContactSent = false;\n    this.requestContactReceived = false;\n    this.isSelf = false;\n    this.newMessages = 0;\n    this.unreadMessageFrom = 0;\n    this.initialized = false;\n    this.hostElement = elementRef.nativeElement;\n    this.siteId = CoreSites.getCurrentSiteId();\n    this.currentUserId = CoreSites.getCurrentSiteUserId();\n    this.groupMessagingEnabled = AddonMessages.isGroupMessagingEnabled();\n    this.muteEnabled = AddonMessages.isMuteConversationEnabled();\n    this.logger = CoreLogger.getInstance('AddonMessagesDiscussionPage');\n    // Refresh data if this discussion is synchronized automatically.\n    this.syncObserver = CoreEvents.on(AddonMessagesSyncProvider.AUTO_SYNCED, data => {\n      if (data.userId && data.userId == this.userId || data.conversationId && data.conversationId == this.conversationId) {\n        // Fetch messages.\n        this.fetchMessages();\n        // Show first warning if any.\n        if (data.warnings && data.warnings[0]) {\n          CoreDomUtils.showAlert(undefined, data.warnings[0]);\n        }\n      }\n    }, this.siteId);\n    // Refresh data if info of a mamber of the conversation have changed.\n    this.memberInfoObserver = CoreEvents.on(AddonMessagesProvider.MEMBER_INFO_CHANGED_EVENT, data => {\n      if (data.userId && (this.members[data.userId] || this.otherMember && data.userId == this.otherMember.id)) {\n        this.fetchData();\n      }\n    }, this.siteId);\n  }\n  /**\n   * Runs when the page has loaded. This event only happens once per page being created.\n   * If a page leaves but is cached, then this event will not fire again on a subsequent viewing.\n   * Setup code for the page.\n   */\n  ngOnInit() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      _this.conversationId = CoreNavigator.getRouteNumberParam('conversationId');\n      _this.userId = CoreNavigator.getRouteNumberParam('userId');\n      _this.showInfo = !CoreNavigator.getRouteBooleanParam('hideInfo');\n      _this.showKeyboard = !!CoreNavigator.getRouteBooleanParam('showKeyboard');\n      yield _this.fetchData();\n      _this.scrollToBottom(true);\n    })();\n  }\n  /**\n   * View has been initialized.\n   */\n  ngAfterViewInit() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      var _this2$content;\n      _this2.scrollElement = yield (_this2$content = _this2.content) === null || _this2$content === void 0 ? void 0 : _this2$content.getScrollElement();\n    })();\n  }\n  /**\n   * Adds a new message to the message list.\n   *\n   * @param message Message to be added.\n   * @param keep If set the keep flag or not.\n   * @returns If message is not mine and was recently added.\n   */\n  addMessage(message, keep = true) {\n    /* Create a hash to identify the message. The text of online messages isn't reliable because it can have random data\n       like VideoJS ID. Try to use id and fallback to text for offline messages. */\n    const id = 'id' in message ? message.id : '';\n    message.hash = Md5.hashAsciiStr(String(id || message.text || '')) + '#' + message.timecreated + '#' + message.useridfrom;\n    let added = false;\n    if (this.keepMessageMap[message.hash] === undefined) {\n      // Message not added to the list. Add it now.\n      this.messages.push(message);\n      added = message.useridfrom != this.currentUserId;\n    }\n    // Message needs to be kept in the list.\n    this.keepMessageMap[message.hash] = keep;\n    return added;\n  }\n  /**\n   * Remove a message if it shouldn't be in the list anymore.\n   *\n   * @param hash Hash of the message to be removed.\n   */\n  removeMessage(hash) {\n    if (this.keepMessageMap[hash]) {\n      // Selected to keep it, clear the flag.\n      this.keepMessageMap[hash] = false;\n      return;\n    }\n    delete this.keepMessageMap[hash];\n    const position = this.messages.findIndex(message => message.hash == hash);\n    if (position >= 0) {\n      this.messages.splice(position, 1);\n    }\n  }\n  /**\n   * Convenience function to fetch the conversation data.\n   *\n   * @returns Resolved when done.\n   */\n  fetchData() {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      let loader;\n      if (_this3.showLoadingModal) {\n        loader = yield CoreDomUtils.showModalLoading();\n      }\n      if (!_this3.groupMessagingEnabled && _this3.userId) {\n        // Get the user profile to retrieve the user fullname and image.\n        CoreUser.getProfile(_this3.userId, undefined, true).then(user => {\n          if (!_this3.title) {\n            _this3.title = user.fullname;\n          }\n          _this3.conversationImage = user.profileimageurl;\n          _this3.members[user.id] = user;\n          return;\n        }).catch(() => {\n          // Ignore errors.\n        });\n      }\n      // Synchronize messages if needed.\n      try {\n        const syncResult = yield AddonMessagesSync.syncDiscussion(_this3.conversationId, _this3.userId);\n        if (syncResult.warnings && syncResult.warnings[0]) {\n          CoreDomUtils.showAlert(undefined, syncResult.warnings[0]);\n        }\n      } catch (_unused) {\n        // Ignore errors;\n      }\n      try {\n        const promises = [];\n        if (_this3.groupMessagingEnabled) {\n          // Get the conversation ID if it exists and we don't have it yet.\n          const exists = yield _this3.getConversation(_this3.conversationId, _this3.userId);\n          if (exists) {\n            // Fetch the messages for the first time.\n            promises.push(_this3.fetchMessages());\n          }\n          if (_this3.userId) {\n            const userId = _this3.userId;\n            // Get the member info. Invalidate first to make sure we get the latest status.\n            promises.push(AddonMessages.invalidateMemberInfo(_this3.userId).then( /*#__PURE__*/_asyncToGenerator(function* () {\n              _this3.otherMember = yield AddonMessages.getMemberInfo(userId);\n              if (!exists && _this3.otherMember) {\n                _this3.conversationImage = _this3.otherMember.profileimageurl;\n                _this3.title = _this3.otherMember.fullname;\n              }\n              _this3.blockIcon = _this3.otherMember.isblocked ? 'fas-user-check' : 'fas-user-lock';\n              return;\n            })));\n          } else {\n            _this3.otherMember = undefined;\n          }\n        } else {\n          if (_this3.userId) {\n            const userId = _this3.userId;\n            // Fake the user member info.\n            promises.push(CoreUser.getProfile(_this3.userId).then( /*#__PURE__*/function () {\n              var _ref2 = _asyncToGenerator(function* (user) {\n                _this3.otherMember = {\n                  id: user.id,\n                  fullname: user.fullname,\n                  profileurl: '',\n                  profileimageurl: user.profileimageurl || '',\n                  profileimageurlsmall: user.profileimageurlsmall || '',\n                  isonline: false,\n                  showonlinestatus: false,\n                  isblocked: false,\n                  iscontact: false,\n                  isdeleted: false,\n                  canmessageevenifblocked: true,\n                  canmessage: true,\n                  requirescontact: false\n                };\n                _this3.otherMember.isblocked = yield AddonMessages.isBlocked(userId);\n                _this3.otherMember.iscontact = yield AddonMessages.isContact(userId);\n                _this3.blockIcon = _this3.otherMember.isblocked ? 'fas-user-check' : 'fas-user-lock';\n                return;\n              });\n              return function (_x) {\n                return _ref2.apply(this, arguments);\n              };\n            }()));\n          }\n          // Fetch the messages for the first time.\n          promises.push(_this3.fetchMessages().then(() => {\n            if (!_this3.title && _this3.messages.length) {\n              // Didn't receive the fullname via argument. Try to get it from messages.\n              // It's possible that name cannot be resolved when no messages were yet exchanged.\n              const firstMessage = _this3.messages[0];\n              if ('usertofullname' in firstMessage) {\n                if (firstMessage.useridto != _this3.currentUserId) {\n                  _this3.title = firstMessage.usertofullname || '';\n                } else {\n                  _this3.title = firstMessage.userfromfullname || '';\n                }\n              }\n            }\n            return;\n          }));\n        }\n        yield Promise.all(promises);\n      } catch (error) {\n        CoreDomUtils.showErrorModalDefault(error, 'addon.messages.errorwhileretrievingmessages', true);\n      } finally {\n        _this3.checkCanDelete();\n        _this3.loaded = true;\n        _this3.setPolling(); // Make sure we're polling messages.\n        _this3.setContactRequestInfo();\n        _this3.setFooterType();\n        loader && loader.dismiss();\n      }\n    })();\n  }\n  /**\n   * Runs when the page has fully entered and is now the active page.\n   * This event will fire, whether it was the first load or a cached page.\n   */\n  ionViewDidEnter() {\n    this.setPolling();\n  }\n  /**\n   * Runs when the page is about to leave and no longer be the active page.\n   */\n  ionViewWillLeave() {\n    this.unsetPolling();\n  }\n  /**\n   * Convenience function to fetch messages.\n   *\n   * @param messagesAreNew If messages loaded are new messages.\n   * @returns Resolved when done.\n   */\n  fetchMessages(messagesAreNew = true) {\n    var _this4 = this;\n    return _asyncToGenerator(function* () {\n      _this4.loadMoreError = false;\n      if (_this4.messagesBeingSent > 0) {\n        // We do not poll while a message is being sent or we could confuse the user.\n        // Otherwise, his message would disappear from the list, and he'd have to wait for the interval to check for messages.\n        return;\n      } else if (_this4.fetching) {\n        // Already fetching.\n        return;\n      } else if (_this4.groupMessagingEnabled && !_this4.conversationId) {\n        // Don't have enough data to fetch messages.\n        throw new CoreError('No enough data provided to fetch messages');\n      }\n      if (_this4.conversationId) {\n        _this4.logger.debug(`Polling new messages for conversation '${_this4.conversationId}'`);\n      } else if (_this4.userId) {\n        _this4.logger.debug(`Polling new messages for discussion with user '${_this4.userId}'`);\n      } else {\n        // Should not happen.\n        throw new CoreError('No enough data provided to fetch messages');\n      }\n      _this4.fetching = true;\n      try {\n        // Wait for synchronization process to finish.\n        yield AddonMessagesSync.waitForSyncConversation(_this4.conversationId, _this4.userId);\n        let messages = [];\n        // Fetch messages. Invalidate the cache before fetching.\n        if (_this4.groupMessagingEnabled) {\n          yield AddonMessages.invalidateConversationMessages(_this4.conversationId);\n          messages = yield _this4.getConversationMessages(_this4.pagesLoaded);\n        } else {\n          yield AddonMessages.invalidateDiscussionCache(_this4.userId);\n          messages = yield _this4.getDiscussionMessages(_this4.pagesLoaded);\n        }\n        _this4.loadMessages(messages, messagesAreNew);\n      } finally {\n        _this4.fetching = false;\n      }\n    })();\n  }\n  /**\n   * Format and load a list of messages into the view.\n   *\n   * @param messages Messages to load.\n   * @param messagesAreNew If messages loaded are new messages.\n   */\n  loadMessages(messages, messagesAreNew = true) {\n    if (this.viewDestroyed) {\n      return;\n    }\n    // Check if we are at the bottom to scroll it after render.\n    // Use a 5px error margin because in iOS there is 1px difference for some reason.\n    this.scrollBottom = CoreDom.scrollIsBottom(this.scrollElement, 5);\n    if (this.messagesBeingSent > 0) {\n      // Ignore polling due to a race condition.\n      return;\n    }\n    // Add new messages to the list and mark the messages that should still be displayed.\n    const newMessages = messages.reduce((val, message) => val + (this.addMessage(message) ? 1 : 0), 0);\n    // Set the new badges message if we're loading new messages.\n    if (messagesAreNew) {\n      this.setNewMessagesBadge(this.newMessages + newMessages);\n    }\n    // Remove messages that shouldn't be in the list anymore.\n    for (const hash in this.keepMessageMap) {\n      this.removeMessage(hash);\n    }\n    // Sort the messages.\n    AddonMessages.sortMessages(this.messages);\n    // Calculate which messages need to display the date or user data.\n    this.messages.forEach((message, index) => {\n      message.showDate = this.showDate(message, this.messages[index - 1]);\n      message.showUserData = this.showUserData(message, this.messages[index - 1]);\n      message.showTail = this.showTail(message, this.messages[index + 1]);\n    });\n    // If we received a new message while using group messaging, force mark messages as read.\n    const last = this.messages[this.messages.length - 1];\n    const forceMark = this.groupMessagingEnabled && last && last.useridfrom !== this.currentUserId && !!this.lastMessage && (last.text !== this.lastMessage.text || last.timecreated !== this.lastMessage.timecreated);\n    // Notify that there can be a new message.\n    this.notifyNewMessage();\n    // Mark retrieved messages as read if they are not.\n    this.markMessagesAsRead(forceMark);\n  }\n  /**\n   * Set the new message badge number and set scroll listener if needed.\n   *\n   * @param addMessages Number of messages still to be read.\n   */\n  setNewMessagesBadge(addMessages) {\n    if (this.newMessages == 0 && addMessages > 0) {\n      this.scrollFunction();\n    }\n    this.newMessages = addMessages;\n  }\n  /**\n   * The scroll was moved. Update new messages count.\n   */\n  scrollFunction() {\n    var _this$scrollElement;\n    if (this.newMessages == 0) {\n      return;\n    }\n    if (CoreDom.scrollIsBottom(this.scrollElement, 40)) {\n      // At the bottom, reset.\n      this.setNewMessagesBadge(0);\n      return;\n    }\n    const scrollElRect = (_this$scrollElement = this.scrollElement) === null || _this$scrollElement === void 0 ? void 0 : _this$scrollElement.getBoundingClientRect();\n    const scrollBottomPos = scrollElRect && scrollElRect.bottom || 0;\n    if (scrollBottomPos == 0) {\n      return;\n    }\n    const messages = Array.from(this.hostElement.querySelectorAll('core-message:not(.is-mine)')).slice(-this.newMessages).reverse();\n    const newMessagesUnread = messages.findIndex(message => {\n      const elementRect = message.getBoundingClientRect();\n      if (!elementRect) {\n        return false;\n      }\n      return elementRect.bottom <= scrollBottomPos;\n    });\n    if (newMessagesUnread > 0 && newMessagesUnread < this.newMessages) {\n      this.setNewMessagesBadge(newMessagesUnread);\n    }\n  }\n  /**\n   * Get the conversation.\n   *\n   * @param conversationId Conversation ID.\n   * @param userId User ID.\n   * @returns Promise resolved with a boolean: whether the conversation exists or not.\n   */\n  getConversation(conversationId, userId) {\n    var _this5 = this;\n    return _asyncToGenerator(function* () {\n      let fallbackConversation;\n      // Try to get the conversationId if we don't have it.\n      if (!conversationId && userId) {\n        try {\n          if (userId === _this5.currentUserId && AddonMessages.isSelfConversationEnabled()) {\n            fallbackConversation = yield AddonMessages.getSelfConversation();\n          } else {\n            fallbackConversation = yield AddonMessages.getConversationBetweenUsers(userId, undefined, true);\n          }\n          conversationId = fallbackConversation.id;\n        } catch (error) {\n          // Probably conversation does not exist or user is offline. Try to load offline messages.\n          _this5.isSelf = userId === _this5.currentUserId;\n          const messages = yield AddonMessagesOffline.getMessages(userId);\n          if (messages && messages.length) {\n            // We have offline messages, this probably means that the conversation didn't exist. Don't display error.\n            messages.forEach(message => {\n              message.pending = true;\n              message.text = message.smallmessage;\n            });\n            _this5.loadMessages(messages);\n          } else if (error.errorcode != 'errorconversationdoesnotexist') {\n            // Display the error.\n            throw error;\n          }\n          return false;\n        }\n      }\n      if (!conversationId) {\n        return false;\n      }\n      // Retrieve the conversation. Invalidate data first to get the right unreadcount.\n      yield AddonMessages.invalidateConversation(conversationId);\n      try {\n        _this5.conversation = yield AddonMessages.getConversation(conversationId, undefined, true);\n      } catch (error) {\n        // Get conversation failed, use the fallback one if we have it.\n        if (fallbackConversation) {\n          _this5.conversation = fallbackConversation;\n        } else {\n          throw error;\n        }\n      }\n      if (_this5.conversation) {\n        _this5.conversationId = _this5.conversation.id;\n        _this5.title = _this5.conversation.name;\n        _this5.conversationImage = _this5.conversation.imageurl;\n        _this5.isGroup = _this5.conversation.type == AddonMessagesProvider.MESSAGE_CONVERSATION_TYPE_GROUP;\n        _this5.favouriteIcon = 'fas-star';\n        _this5.favouriteIconSlash = _this5.conversation.isfavourite;\n        _this5.muteIcon = _this5.conversation.ismuted ? 'fas-bell' : 'fas-bell-slash';\n        if (!_this5.isGroup) {\n          _this5.userId = _this5.conversation.userid;\n        }\n        _this5.isSelf = _this5.conversation.type == AddonMessagesProvider.MESSAGE_CONVERSATION_TYPE_SELF;\n        return true;\n      } else {\n        return false;\n      }\n    })();\n  }\n  /**\n   * Get the messages of the conversation. Used if group messaging is supported.\n   *\n   * @param pagesToLoad Number of \"pages\" to load.\n   * @param offset Offset for message list.\n   * @returns Promise resolved with the list of messages.\n   */\n  getConversationMessages(pagesToLoad, offset = 0) {\n    var _this6 = this;\n    return _asyncToGenerator(function* () {\n      if (!_this6.conversationId) {\n        return [];\n      }\n      const excludePending = offset > 0;\n      const result = yield AddonMessages.getConversationMessages(_this6.conversationId, {\n        excludePending: excludePending,\n        limitFrom: offset\n      });\n      pagesToLoad--;\n      // Treat members. Don't use CoreUtilsProvider.arrayToObject because we don't want to override the existing object.\n      if (result.members) {\n        result.members.forEach(member => {\n          _this6.members[member.id] = member;\n        });\n      }\n      const messages = result.messages;\n      if (pagesToLoad > 0 && result.canLoadMore) {\n        offset += AddonMessagesProvider.LIMIT_MESSAGES;\n        // Get more messages.\n        const nextMessages = yield _this6.getConversationMessages(pagesToLoad, offset);\n        return messages.concat(nextMessages);\n      }\n      // No more messages to load, return them.\n      _this6.canLoadMore = !!result.canLoadMore;\n      return messages;\n    })();\n  }\n  /**\n   * Get a discussion. Can load several \"pages\".\n   *\n   * @param pagesToLoad Number of pages to load.\n   * @param lfReceivedUnread Number of unread received messages already fetched, so fetch will be done from this.\n   * @param lfReceivedRead Number of read received messages already fetched, so fetch will be done from this.\n   * @param lfSentUnread Number of unread sent messages already fetched, so fetch will be done from this.\n   * @param lfSentRead Number of read sent messages already fetched, so fetch will be done from this.\n   * @returns Resolved when done.\n   */\n  getDiscussionMessages(pagesToLoad, lfReceivedUnread = 0, lfReceivedRead = 0, lfSentUnread = 0, lfSentRead = 0) {\n    var _this7 = this;\n    return _asyncToGenerator(function* () {\n      // Only get offline messages if we're loading the first \"page\".\n      const excludePending = lfReceivedUnread > 0 || lfReceivedRead > 0 || lfSentUnread > 0 || lfSentRead > 0;\n      // Get next messages.\n      const result = yield AddonMessages.getDiscussion(_this7.userId, excludePending, lfReceivedUnread, lfReceivedRead, lfSentUnread, lfSentRead);\n      pagesToLoad--;\n      if (pagesToLoad > 0 && result.canLoadMore) {\n        // More pages to load. Calculate new limit froms.\n        result.messages.forEach(message => {\n          if (!message.pending && 'read' in message) {\n            if (message.useridfrom == _this7.userId) {\n              if (message.read) {\n                lfReceivedRead++;\n              } else {\n                lfReceivedUnread++;\n              }\n            } else {\n              if (message.read) {\n                lfSentRead++;\n              } else {\n                lfSentUnread++;\n              }\n            }\n          }\n        });\n        // Get next messages.\n        const nextMessages = yield _this7.getDiscussionMessages(pagesToLoad, lfReceivedUnread, lfReceivedRead, lfSentUnread, lfSentRead);\n        return result.messages.concat(nextMessages);\n      } else {\n        // No more messages to load, return them.\n        _this7.canLoadMore = result.canLoadMore;\n        return result.messages;\n      }\n    })();\n  }\n  /**\n   * Mark messages as read.\n   */\n  markMessagesAsRead(forceMark) {\n    var _this8 = this;\n    return _asyncToGenerator(function* () {\n      let readChanged = false;\n      let messageUnreadFound = false;\n      // Mark all messages at a time if there is any unread message.\n      if (forceMark) {\n        messageUnreadFound = true;\n      } else if (_this8.groupMessagingEnabled) {\n        var _this8$conversation, _this8$conversation2;\n        messageUnreadFound = !!((_this8$conversation = _this8.conversation) !== null && _this8$conversation !== void 0 && _this8$conversation.unreadcount && ((_this8$conversation2 = _this8.conversation) === null || _this8$conversation2 === void 0 ? void 0 : _this8$conversation2.unreadcount) > 0 && _this8.conversationId && _this8.conversationId > 0);\n      } else {\n        // If an unread message is found, mark all messages as read.\n        messageUnreadFound = _this8.messages.some(message => message.useridfrom != _this8.currentUserId && 'read' in message && !message.read);\n      }\n      if (messageUnreadFound) {\n        _this8.setUnreadLabelPosition();\n        if (_this8.groupMessagingEnabled) {\n          yield AddonMessages.markAllConversationMessagesRead(_this8.conversationId);\n        } else {\n          yield AddonMessages.markAllMessagesRead(_this8.userId);\n          // Mark all messages as read.\n          _this8.messages.forEach(message => {\n            if ('read' in message) {\n              message.read = true;\n            }\n          });\n        }\n        readChanged = true;\n      }\n      if (readChanged) {\n        CoreEvents.trigger(AddonMessagesProvider.READ_CHANGED_EVENT, {\n          conversationId: _this8.conversationId,\n          userId: _this8.userId\n        }, _this8.siteId);\n      }\n    })();\n  }\n  /**\n   * Notify the last message found so discussions list controller can tell if last message should be updated.\n   */\n  notifyNewMessage() {\n    var _this$lastMessage, _this$lastMessage2;\n    const last = this.messages[this.messages.length - 1];\n    let trigger = false;\n    if (!last) {\n      this.lastMessage = undefined;\n      trigger = true;\n    } else if (last.text !== ((_this$lastMessage = this.lastMessage) === null || _this$lastMessage === void 0 ? void 0 : _this$lastMessage.text) || last.timecreated !== ((_this$lastMessage2 = this.lastMessage) === null || _this$lastMessage2 === void 0 ? void 0 : _this$lastMessage2.timecreated)) {\n      this.lastMessage = {\n        text: last.text || '',\n        timecreated: last.timecreated\n      };\n      trigger = true;\n    }\n    if (trigger) {\n      var _this$lastMessage3, _this$lastMessage$tim, _this$lastMessage4, _this$conversation, _this$conversation2;\n      // Update discussions last message.\n      CoreEvents.trigger(AddonMessagesProvider.NEW_MESSAGE_EVENT, {\n        conversationId: this.conversationId,\n        userId: this.userId,\n        message: (_this$lastMessage3 = this.lastMessage) === null || _this$lastMessage3 === void 0 ? void 0 : _this$lastMessage3.text,\n        timecreated: (_this$lastMessage$tim = (_this$lastMessage4 = this.lastMessage) === null || _this$lastMessage4 === void 0 ? void 0 : _this$lastMessage4.timecreated) !== null && _this$lastMessage$tim !== void 0 ? _this$lastMessage$tim : 0,\n        userFrom: last !== null && last !== void 0 && last.useridfrom ? this.members[last.useridfrom] : undefined,\n        isfavourite: !!((_this$conversation = this.conversation) !== null && _this$conversation !== void 0 && _this$conversation.isfavourite),\n        type: (_this$conversation2 = this.conversation) === null || _this$conversation2 === void 0 ? void 0 : _this$conversation2.type\n      }, this.siteId);\n      // Update navBar links and buttons.\n      const newCanDelete = last && 'id' in last && last.id && this.messages.length == 1 || this.messages.length > 1;\n      if (this.canDelete != newCanDelete) {\n        this.checkCanDelete();\n      }\n    }\n  }\n  /**\n   * Set the place where the unread label position has to be.\n   */\n  setUnreadLabelPosition() {\n    if (this.unreadMessageFrom != 0) {\n      return;\n    }\n    if (this.groupMessagingEnabled) {\n      var _this$conversation3, _this$conversation4;\n      // Use the unreadcount from the conversation to calculate where should the label be placed.\n      if (this.conversation && (_this$conversation3 = this.conversation) !== null && _this$conversation3 !== void 0 && _this$conversation3.unreadcount && ((_this$conversation4 = this.conversation) === null || _this$conversation4 === void 0 ? void 0 : _this$conversation4.unreadcount) > 0 && this.messages) {\n        // Iterate over messages to find the right message using the unreadcount. Skip offline messages and own messages.\n        let found = 0;\n        for (let i = this.messages.length - 1; i >= 0; i--) {\n          const message = this.messages[i];\n          if (!message.pending && message.useridfrom != this.currentUserId && 'id' in message) {\n            found++;\n            if (found == this.conversation.unreadcount) {\n              this.unreadMessageFrom = Number(message.id);\n              break;\n            }\n          }\n        }\n      }\n    } else {\n      let previousMessageRead = false;\n      for (const x in this.messages) {\n        const message = this.messages[x];\n        if (message.useridfrom != this.currentUserId && 'read' in message) {\n          const unreadFrom = !message.read && previousMessageRead;\n          if (unreadFrom) {\n            // Save where the label is placed.\n            this.unreadMessageFrom = Number(message.id);\n            break;\n          }\n          previousMessageRead = !!message.read;\n        }\n      }\n    }\n    // Do not update the message unread from label on next refresh.\n    if (this.unreadMessageFrom == 0) {\n      // Using negative to indicate the label is not placed but should not be placed.\n      this.unreadMessageFrom = -1;\n    }\n  }\n  /**\n   * Check if there's any message in the list that can be deleted.\n   */\n  checkCanDelete() {\n    // All messages being sent should be at the end of the list.\n    const first = this.messages[0];\n    this.canDelete = first && !first.sending;\n  }\n  /**\n   * Hide unread label when sending messages.\n   */\n  hideUnreadLabel() {\n    if (this.unreadMessageFrom > 0) {\n      this.unreadMessageFrom = -1;\n    }\n  }\n  /**\n   * Wait until fetching is false.\n   *\n   * @returns Resolved when done.\n   */\n  waitForFetch() {\n    var _this9 = this;\n    return _asyncToGenerator(function* () {\n      if (!_this9.fetching) {\n        return;\n      }\n      yield CoreUtils.wait(400);\n      yield CoreUtils.ignoreErrors(_this9.waitForFetch());\n    })();\n  }\n  /**\n   * Set a polling to get new messages every certain time.\n   */\n  setPolling() {\n    if (this.groupMessagingEnabled && !this.conversationId) {\n      // Don't have enough data to poll messages.\n      return;\n    }\n    if (!this.polling) {\n      // Start polling.\n      this.polling = window.setInterval(() => {\n        this.fetchMessages().catch(() => {\n          // Ignore errors.\n        });\n      }, AddonMessagesProvider.POLL_INTERVAL);\n    }\n  }\n  /**\n   * Unset polling.\n   */\n  unsetPolling() {\n    if (this.polling) {\n      this.logger.debug(`Cancelling polling for conversation with user '${this.userId}'`);\n      clearInterval(this.polling);\n      this.polling = undefined;\n    }\n  }\n  /**\n   * Copy message to clipboard.\n   *\n   * @param message Message to be copied.\n   */\n  copyMessage(message) {\n    const text = 'smallmessage' in message ? message.smallmessage || message.text || '' : message.text || '';\n    CoreUtils.copyToClipboard(CoreTextUtils.decodeHTMLEntities(text));\n  }\n  /**\n   * Function to delete a message.\n   *\n   * @param message Message object to delete.\n   * @param index Index where the message is to delete it from the view.\n   */\n  deleteMessage(message, index) {\n    var _this10 = this;\n    return _asyncToGenerator(function* () {\n      const canDeleteAll = _this10.conversation && _this10.conversation.candeletemessagesforallusers;\n      const langKey = message.pending || canDeleteAll || _this10.isSelf ? 'core.areyousure' : 'addon.messages.deletemessageconfirmation';\n      const options = {};\n      if (canDeleteAll && !message.pending) {\n        // Show delete for all checkbox.\n        options.inputs = [{\n          type: 'checkbox',\n          name: 'deleteforall',\n          checked: false,\n          value: true,\n          label: Translate.instant('addon.messages.deleteforeveryone')\n        }];\n      }\n      try {\n        const data = yield CoreDomUtils.showConfirm(Translate.instant(langKey), undefined, undefined, undefined, options);\n        const modal = yield CoreDomUtils.showModalLoading('core.deleting', true);\n        try {\n          yield AddonMessages.deleteMessage(message, data && data[0]);\n          // Remove message from the list without having to wait for re-fetch.\n          _this10.messages.splice(index, 1);\n          _this10.removeMessage(message.hash);\n          _this10.notifyNewMessage();\n          _this10.fetchMessages(); // Re-fetch messages to update cached data.\n        } finally {\n          modal.dismiss();\n        }\n      } catch (error) {\n        CoreDomUtils.showErrorModalDefault(error, 'addon.messages.errordeletemessage', true);\n      }\n    })();\n  }\n  /**\n   * Function to load previous messages.\n   *\n   * @param infiniteComplete Infinite scroll complete function. Only used from core-infinite-loading.\n   * @returns Resolved when done.\n   */\n  loadPrevious(infiniteComplete) {\n    var _this11 = this;\n    return _asyncToGenerator(function* () {\n      var _this11$infinite, _this11$scrollElement;\n      if (!_this11.initialized) {\n        // Don't load previous if the view isn't fully initialized.\n        // Don't put the initialized condition in the \"enabled\" input because then the load more is hidden and\n        // the scroll height changes when it appears.\n        infiniteComplete && infiniteComplete();\n        return;\n      }\n      let infiniteHeight = ((_this11$infinite = _this11.infinite) === null || _this11$infinite === void 0 ? void 0 : _this11$infinite.hostElement.getBoundingClientRect().height) || 0;\n      const scrollHeight = ((_this11$scrollElement = _this11.scrollElement) === null || _this11$scrollElement === void 0 ? void 0 : _this11$scrollElement.scrollHeight) || 0;\n      // If there is an ongoing fetch, wait for it to finish.\n      try {\n        yield _this11.waitForFetch();\n      } finally {\n        _this11.pagesLoaded++;\n        try {\n          var _this11$scrollElement2, _this11$infinite2;\n          yield _this11.fetchMessages(false);\n          // Try to keep the scroll position.\n          const scrollBottom = scrollHeight - (((_this11$scrollElement2 = _this11.scrollElement) === null || _this11$scrollElement2 === void 0 ? void 0 : _this11$scrollElement2.scrollTop) || 0);\n          const height = ((_this11$infinite2 = _this11.infinite) === null || _this11$infinite2 === void 0 ? void 0 : _this11$infinite2.hostElement.getBoundingClientRect().height) || 0;\n          if (_this11.canLoadMore && infiniteHeight && _this11.infinite) {\n            // The height of the infinite is different while spinner is shown. Add that difference.\n            infiniteHeight = infiniteHeight - height;\n          } else if (!_this11.canLoadMore) {\n            // Can't load more, take into account the full height of the infinite loading since it will disappear now.\n            infiniteHeight = infiniteHeight || height;\n          }\n          _this11.keepScroll(scrollHeight, scrollBottom, infiniteHeight);\n        } catch (error) {\n          _this11.loadMoreError = true; // Set to prevent infinite calls with infinite-loading.\n          _this11.pagesLoaded--;\n          CoreDomUtils.showErrorModalDefault(error, 'addon.messages.errorwhileretrievingmessages', true);\n        } finally {\n          infiniteComplete && infiniteComplete();\n        }\n      }\n    })();\n  }\n  /**\n   * Keep scroll position after loading previous messages.\n   */\n  keepScroll(oldScrollHeight, oldScrollBottom, infiniteHeight, retries = 0) {\n    setTimeout(() => {\n      var _this$scrollElement2;\n      const newScrollHeight = ((_this$scrollElement2 = this.scrollElement) === null || _this$scrollElement2 === void 0 ? void 0 : _this$scrollElement2.scrollHeight) || 0;\n      if (newScrollHeight == oldScrollHeight) {\n        // Height hasn't changed yet. Retry if max retries haven't been reached.\n        if (retries <= 10) {\n          this.keepScroll(oldScrollHeight, oldScrollBottom, infiniteHeight, retries + 1);\n        }\n        return;\n      }\n      // Scroll has changed, but maybe it hasn't reached the full height yet.\n      setTimeout(() => {\n        var _this$scrollElement3;\n        const newScrollHeight = ((_this$scrollElement3 = this.scrollElement) === null || _this$scrollElement3 === void 0 ? void 0 : _this$scrollElement3.scrollHeight) || 0;\n        const scrollTo = newScrollHeight - oldScrollBottom + infiniteHeight;\n        this.content.scrollToPoint(0, scrollTo, 0);\n      }, 30);\n    }, 30);\n  }\n  /**\n   * Scroll bottom when render has finished.\n   *\n   * @param force Whether to force scroll to bottom.\n   */\n  scrollToBottom(force = false) {\n    var _this12 = this;\n    return _asyncToGenerator(function* () {\n      // Check if scroll is at bottom. If so, scroll bottom after rendering since there might be something new.\n      if (_this12.scrollBottom || force) {\n        _this12.scrollBottom = false;\n        // Reset the badge.\n        _this12.setNewMessagesBadge(0);\n        // Leave time for the view to be rendered.\n        yield CoreUtils.nextTicks(5);\n        if (!_this12.viewDestroyed && _this12.content) {\n          _this12.content.scrollToBottom(0);\n        }\n        if (force) {\n          _this12.initialized = true;\n        }\n      }\n    })();\n  }\n  /**\n   * Scroll to the first new unread message.\n   */\n  scrollToFirstUnreadMessage() {\n    if (this.newMessages > 0) {\n      const messages = Array.from(this.hostElement.querySelectorAll('core-message:not(.is-mine)'));\n      CoreDom.scrollToElement(messages[messages.length - this.newMessages]);\n    }\n  }\n  /**\n   * Sends a message to the server.\n   *\n   * @param text Message text.\n   */\n  sendMessage(text) {\n    var _this13 = this;\n    return _asyncToGenerator(function* () {\n      _this13.hideUnreadLabel();\n      _this13.showDelete = false;\n      _this13.scrollBottom = true;\n      _this13.setNewMessagesBadge(0);\n      const message = {\n        id: -1,\n        pending: true,\n        sending: true,\n        useridfrom: _this13.currentUserId,\n        smallmessage: text,\n        text: text,\n        timecreated: Date.now()\n      };\n      message.showDate = _this13.showDate(message, _this13.messages[_this13.messages.length - 1]);\n      _this13.addMessage(message, false);\n      _this13.messagesBeingSent++;\n      // If there is an ongoing fetch, wait for it to finish.\n      // Otherwise, if a message is sent while fetching it could disappear until the next fetch.\n      try {\n        yield _this13.waitForFetch();\n      } finally {\n        try {\n          let data;\n          if (_this13.conversationId) {\n            data = yield AddonMessages.sendMessageToConversation(_this13.conversation, text);\n          } else {\n            data = yield AddonMessages.sendMessage(_this13.userId, text);\n          }\n          _this13.messagesBeingSent--;\n          let failure = false;\n          if (data.sent) {\n            try {\n              if (!_this13.conversationId && data.message && 'conversationid' in data.message) {\n                // Message sent to a new conversation, try to load the conversation.\n                yield _this13.getConversation(data.message.conversationid, _this13.userId);\n                // Now fetch messages.\n                try {\n                  yield _this13.fetchMessages();\n                } finally {\n                  // Start polling messages now that the conversation exists.\n                  _this13.setPolling();\n                }\n              } else {\n                // Message was sent, fetch messages right now.\n                yield _this13.fetchMessages();\n              }\n            } catch (_unused2) {\n              failure = true;\n            }\n          }\n          if (failure || !data.sent) {\n            // Fetch failed or is offline message, mark the message as sent.\n            // If fetch is successful there's no need to mark it because the fetch will already show the message received.\n            message.sending = false;\n            if (data.sent) {\n              // Message sent to server, not pending anymore.\n              message.pending = false;\n            } else if (data.message) {\n              message.timecreated = data.message.timecreated || 0;\n            }\n            _this13.notifyNewMessage();\n          }\n        } catch (error) {\n          _this13.messagesBeingSent--;\n          // Only close the keyboard if an error happens.\n          // We want the user to be able to send multiple messages without the keyboard being closed.\n          CoreApp.closeKeyboard();\n          CoreDomUtils.showErrorModalDefault(error, 'addon.messages.messagenotsent', true);\n          _this13.removeMessage(message.hash);\n        }\n      }\n    })();\n  }\n  /**\n   * Check date should be shown on message list for the current message.\n   * If date has changed from previous to current message it should be shown.\n   *\n   * @param message Current message where to show the date.\n   * @param prevMessage Previous message where to compare the date with.\n   * @returns If date has changed and should be shown.\n   */\n  showDate(message, prevMessage) {\n    if (!prevMessage) {\n      // First message, show it.\n      return true;\n    }\n    // Check if day has changed.\n    return !moment(message.timecreated).isSame(prevMessage.timecreated, 'day');\n  }\n  /**\n   * Check if the user info should be displayed for the current message.\n   * User data is only displayed for group conversations if the previous message was from another user.\n   *\n   * @param message Current message where to show the user info.\n   * @param prevMessage Previous message.\n   * @returns Whether user data should be shown.\n   */\n  showUserData(message, prevMessage) {\n    return this.isGroup && message.useridfrom != this.currentUserId && this.members[message.useridfrom || 0] && (!prevMessage || prevMessage.useridfrom != message.useridfrom || !!message.showDate);\n  }\n  /**\n   * Check if a css tail should be shown.\n   *\n   * @param message Current message where to show the user info.\n   * @param nextMessage Next message.\n   * @returns Whether user data should be shown.\n   */\n  showTail(message, nextMessage) {\n    return !nextMessage || nextMessage.useridfrom != message.useridfrom || !!nextMessage.showDate;\n  }\n  /**\n   * View info. If it's an individual conversation, go to the user profile.\n   * If it's a group conversation, view info about the group.\n   */\n  viewInfo() {\n    var _this14 = this;\n    return _asyncToGenerator(function* () {\n      if (_this14.isGroup) {\n        const {\n          AddonMessagesConversationInfoComponent\n        } = yield import('@addons/messages/components/conversation-info/conversation-info.module');\n        // Display the group information.\n        const userId = yield CoreDomUtils.openSideModal({\n          component: AddonMessagesConversationInfoComponent,\n          componentProps: {\n            conversationId: _this14.conversationId\n          }\n        });\n        if (userId !== undefined) {\n          const splitViewLoaded = CoreNavigator.isCurrentPathInTablet('**/messages/**/discussion/**');\n          // Open user conversation.\n          if (splitViewLoaded) {\n            // Notify the left pane to load it, this way the right conversation will be highlighted.\n            CoreEvents.trigger(AddonMessagesProvider.OPEN_CONVERSATION_EVENT, {\n              userId\n            }, _this14.siteId);\n          } else {\n            // Open the discussion in a new view.\n            CoreNavigator.navigateToSitePath(`/messages/discussion/user/${userId}`);\n          }\n        }\n      } else {\n        // Open the user profile.\n        CoreNavigator.navigateToSitePath('/user/profile', {\n          params: {\n            userId: _this14.userId\n          }\n        });\n      }\n    })();\n  }\n  /**\n   * Change the favourite state of the current conversation.\n   *\n   * @param done Function to call when done.\n   */\n  changeFavourite(done) {\n    var _this15 = this;\n    return _asyncToGenerator(function* () {\n      if (!_this15.conversation) {\n        return;\n      }\n      _this15.favouriteIcon = CoreConstants.ICON_LOADING;\n      try {\n        yield AddonMessages.setFavouriteConversation(_this15.conversation.id, !_this15.conversation.isfavourite);\n        _this15.conversation.isfavourite = !_this15.conversation.isfavourite;\n        // Get the conversation data so it's cached. Don't block the user for this.\n        AddonMessages.getConversation(_this15.conversation.id, undefined, true);\n        CoreEvents.trigger(AddonMessagesProvider.UPDATE_CONVERSATION_LIST_EVENT, {\n          conversationId: _this15.conversation.id,\n          action: 'favourite',\n          value: _this15.conversation.isfavourite\n        }, _this15.siteId);\n      } catch (error) {\n        CoreDomUtils.showErrorModalDefault(error, 'Error changing favourite state.');\n      } finally {\n        _this15.favouriteIcon = 'fas-star';\n        _this15.favouriteIconSlash = _this15.conversation.isfavourite;\n        done && done();\n      }\n    })();\n  }\n  /**\n   * Change the mute state of the current conversation.\n   *\n   * @param done Function to call when done.\n   */\n  changeMute(done) {\n    var _this16 = this;\n    return _asyncToGenerator(function* () {\n      if (!_this16.conversation) {\n        return;\n      }\n      _this16.muteIcon = CoreConstants.ICON_LOADING;\n      try {\n        yield AddonMessages.muteConversation(_this16.conversation.id, !_this16.conversation.ismuted);\n        _this16.conversation.ismuted = !_this16.conversation.ismuted;\n        // Get the conversation data so it's cached. Don't block the user for this.\n        AddonMessages.getConversation(_this16.conversation.id, undefined, true);\n        CoreEvents.trigger(AddonMessagesProvider.UPDATE_CONVERSATION_LIST_EVENT, {\n          conversationId: _this16.conversation.id,\n          action: 'mute',\n          value: _this16.conversation.ismuted\n        }, _this16.siteId);\n      } catch (error) {\n        CoreDomUtils.showErrorModalDefault(error, 'Error changing muted state.');\n      } finally {\n        _this16.muteIcon = _this16.conversation.ismuted ? 'fas-bell' : 'fas-bell-slash';\n        done && done();\n      }\n    })();\n  }\n  /**\n   * Calculate whether there are pending contact requests.\n   */\n  setContactRequestInfo() {\n    this.requestContactSent = false;\n    this.requestContactReceived = false;\n    if (this.otherMember && !this.otherMember.iscontact) {\n      var _this$otherMember$con, _this$otherMember$con2;\n      this.requestContactSent = !!((_this$otherMember$con = this.otherMember.contactrequests) !== null && _this$otherMember$con !== void 0 && _this$otherMember$con.some(request => request.userid == this.currentUserId && request.requesteduserid == this.otherMember.id));\n      this.requestContactReceived = !!((_this$otherMember$con2 = this.otherMember.contactrequests) !== null && _this$otherMember$con2 !== void 0 && _this$otherMember$con2.some(request => request.userid == this.otherMember.id && request.requesteduserid == this.currentUserId));\n    }\n  }\n  /**\n   * Calculate what to display in the footer.\n   */\n  setFooterType() {\n    if (!this.otherMember) {\n      // Group conversation or group messaging not available.\n      this.footerType = 'message';\n    } else if (this.otherMember.isblocked) {\n      this.footerType = 'blocked';\n    } else if (this.requestContactReceived) {\n      this.footerType = 'requestReceived';\n    } else if (this.otherMember.canmessage) {\n      this.footerType = 'message';\n    } else if (this.requestContactSent) {\n      this.footerType = 'requestSent';\n    } else if (this.otherMember.requirescontact) {\n      this.footerType = 'requiresContact';\n    } else {\n      this.footerType = 'unable';\n    }\n  }\n  /**\n   * Displays a confirmation modal to block the user of the individual conversation.\n   *\n   * @returns Promise resolved when user is blocked or dialog is cancelled.\n   */\n  blockUser() {\n    var _this17 = this;\n    return _asyncToGenerator(function* () {\n      if (!_this17.otherMember) {\n        // Should never happen.\n        throw new CoreError('No member selected to be blocked.');\n      }\n      if (_this17.otherMember.canmessageevenifblocked) {\n        CoreDomUtils.showErrorModal(Translate.instant('addon.messages.cantblockuser', {\n          $a: _this17.otherMember.fullname\n        }));\n        return;\n      }\n      const template = Translate.instant('addon.messages.blockuserconfirm', {\n        $a: _this17.otherMember.fullname\n      });\n      const okText = Translate.instant('addon.messages.blockuser');\n      try {\n        yield CoreDomUtils.showConfirm(template, undefined, okText);\n        _this17.blockIcon = CoreConstants.ICON_LOADING;\n        const modal = yield CoreDomUtils.showModalLoading('core.sending', true);\n        _this17.showLoadingModal = true;\n        try {\n          try {\n            yield AddonMessages.blockContact(_this17.otherMember.id);\n          } finally {\n            modal.dismiss();\n            _this17.showLoadingModal = false;\n          }\n        } catch (error) {\n          CoreDomUtils.showErrorModalDefault(error, 'core.error', true);\n        } finally {\n          _this17.blockIcon = _this17.otherMember.isblocked ? 'fas-user-check' : 'fas-user-lock';\n        }\n      } catch (_unused3) {\n        // User cancelled.\n      }\n    })();\n  }\n  /**\n   * Delete the conversation.\n   *\n   * @param done Function to call when done.\n   */\n  deleteConversation(done) {\n    var _this18 = this;\n    return _asyncToGenerator(function* () {\n      if (!_this18.conversation) {\n        return;\n      }\n      const confirmMessage = 'addon.messages.' + (_this18.isSelf ? 'deleteallselfconfirm' : 'deleteallconfirm');\n      try {\n        yield CoreDomUtils.showDeleteConfirm(confirmMessage);\n        _this18.deleteIcon = CoreConstants.ICON_LOADING;\n        try {\n          try {\n            yield AddonMessages.deleteConversation(_this18.conversation.id);\n            CoreEvents.trigger(AddonMessagesProvider.UPDATE_CONVERSATION_LIST_EVENT, {\n              conversationId: _this18.conversation.id,\n              action: 'delete'\n            }, _this18.siteId);\n            _this18.messages = [];\n          } finally {\n            done && done();\n          }\n        } catch (error) {\n          CoreDomUtils.showErrorModalDefault(error, 'Error deleting conversation.');\n        } finally {\n          _this18.deleteIcon = 'fas-trash';\n        }\n      } catch (_unused4) {\n        // User cancelled.\n      }\n    })();\n  }\n  /**\n   * Displays a confirmation modal to unblock the user of the individual conversation.\n   *\n   * @returns Promise resolved when user is unblocked or dialog is cancelled.\n   */\n  unblockUser() {\n    var _this19 = this;\n    return _asyncToGenerator(function* () {\n      if (!_this19.otherMember) {\n        // Should never happen.\n        throw new CoreError('No member selected to be unblocked.');\n      }\n      const template = Translate.instant('addon.messages.unblockuserconfirm', {\n        $a: _this19.otherMember.fullname\n      });\n      const okText = Translate.instant('addon.messages.unblockuser');\n      try {\n        yield CoreDomUtils.showConfirm(template, undefined, okText);\n        _this19.blockIcon = CoreConstants.ICON_LOADING;\n        const modal = yield CoreDomUtils.showModalLoading('core.sending', true);\n        _this19.showLoadingModal = true;\n        try {\n          try {\n            yield AddonMessages.unblockContact(_this19.otherMember.id);\n          } finally {\n            modal.dismiss();\n            _this19.showLoadingModal = false;\n          }\n        } catch (error) {\n          CoreDomUtils.showErrorModalDefault(error, 'core.error', true);\n        } finally {\n          _this19.blockIcon = _this19.otherMember.isblocked ? 'fas-user-check' : 'fas-user-lock';\n        }\n      } catch (_unused5) {\n        // User cancelled.\n      }\n    })();\n  }\n  /**\n   * Displays a confirmation modal to send a contact request to the other user of the individual conversation.\n   *\n   * @returns Promise resolved when the request is sent or the dialog is cancelled.\n   */\n  createContactRequest() {\n    var _this20 = this;\n    return _asyncToGenerator(function* () {\n      if (!_this20.otherMember) {\n        // Should never happen.\n        throw new CoreError('No member selected to be requested.');\n      }\n      const template = Translate.instant('addon.messages.addcontactconfirm', {\n        $a: _this20.otherMember.fullname\n      });\n      const okText = Translate.instant('core.add');\n      try {\n        yield CoreDomUtils.showConfirm(template, undefined, okText);\n        _this20.addRemoveIcon = CoreConstants.ICON_LOADING;\n        const modal = yield CoreDomUtils.showModalLoading('core.sending', true);\n        _this20.showLoadingModal = true;\n        try {\n          try {\n            yield AddonMessages.createContactRequest(_this20.otherMember.id);\n          } finally {\n            modal.dismiss();\n            _this20.showLoadingModal = false;\n          }\n        } catch (error) {\n          CoreDomUtils.showErrorModalDefault(error, 'core.error', true);\n        } finally {\n          _this20.addRemoveIcon = 'fas-user-plus';\n        }\n      } catch (_unused6) {\n        // User cancelled.\n      }\n    })();\n  }\n  /**\n   * Confirms the contact request of the other user of the individual conversation.\n   *\n   * @returns Promise resolved when the request is confirmed.\n   */\n  confirmContactRequest() {\n    var _this21 = this;\n    return _asyncToGenerator(function* () {\n      if (!_this21.otherMember) {\n        // Should never happen.\n        throw new CoreError('No member selected to be confirmed.');\n      }\n      const modal = yield CoreDomUtils.showModalLoading('core.sending', true);\n      _this21.showLoadingModal = true;\n      try {\n        try {\n          yield AddonMessages.confirmContactRequest(_this21.otherMember.id);\n        } finally {\n          modal.dismiss();\n          _this21.showLoadingModal = false;\n        }\n      } catch (error) {\n        CoreDomUtils.showErrorModalDefault(error, 'core.error', true);\n      }\n    })();\n  }\n  /**\n   * Declines the contact request of the other user of the individual conversation.\n   *\n   * @returns Promise resolved when the request is confirmed.\n   */\n  declineContactRequest() {\n    var _this22 = this;\n    return _asyncToGenerator(function* () {\n      if (!_this22.otherMember) {\n        // Should never happen.\n        throw new CoreError('No member selected to be declined.');\n      }\n      const modal = yield CoreDomUtils.showModalLoading('core.sending', true);\n      _this22.showLoadingModal = true;\n      try {\n        try {\n          yield AddonMessages.declineContactRequest(_this22.otherMember.id);\n        } finally {\n          modal.dismiss();\n          _this22.showLoadingModal = false;\n        }\n      } catch (error) {\n        CoreDomUtils.showErrorModalDefault(error, 'core.error', true);\n      }\n    })();\n  }\n  /**\n   * Displays a confirmation modal to remove the other user of the conversation from contacts.\n   *\n   * @returns Promise resolved when the request is sent or the dialog is cancelled.\n   */\n  removeContact() {\n    var _this23 = this;\n    return _asyncToGenerator(function* () {\n      if (!_this23.otherMember) {\n        // Should never happen.\n        throw new CoreError('No member selected to be removed.');\n      }\n      const template = Translate.instant('addon.messages.removecontactconfirm', {\n        $a: _this23.otherMember.fullname\n      });\n      const okText = Translate.instant('core.remove');\n      try {\n        yield CoreDomUtils.showConfirm(template, undefined, okText);\n        _this23.addRemoveIcon = CoreConstants.ICON_LOADING;\n        const modal = yield CoreDomUtils.showModalLoading('core.sending', true);\n        _this23.showLoadingModal = true;\n        try {\n          try {\n            yield AddonMessages.removeContact(_this23.otherMember.id);\n          } finally {\n            modal.dismiss();\n            _this23.showLoadingModal = false;\n          }\n        } catch (error) {\n          CoreDomUtils.showErrorModalDefault(error, 'core.error', true);\n        } finally {\n          _this23.addRemoveIcon = 'fas-user-plus';\n        }\n      } catch (_unused7) {\n        // User cancelled.\n      }\n    })();\n  }\n  /**\n   * Page destroyed.\n   */\n  ngOnDestroy() {\n    var _this$syncObserver, _this$memberInfoObser;\n    // Unset again, just in case.\n    this.unsetPolling();\n    (_this$syncObserver = this.syncObserver) === null || _this$syncObserver === void 0 || _this$syncObserver.off();\n    (_this$memberInfoObser = this.memberInfoObserver) === null || _this$memberInfoObser === void 0 || _this$memberInfoObser.off();\n    this.viewDestroyed = true;\n  }\n}\n_class = AddonMessagesDiscussionPage;\n_class.ɵfac = function AddonMessagesDiscussionPage_Factory(t) {\n  return new (t || _class)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i0.ElementRef));\n};\n_class.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: _class,\n  selectors: [[\"page-addon-messages-discussion\"]],\n  viewQuery: function AddonMessagesDiscussionPage_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(IonContent, 5);\n      i0.ɵɵviewQuery(CoreInfiniteLoadingComponent, 5);\n    }\n    if (rf & 2) {\n      let _t;\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.content = _t.first);\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.infinite = _t.first);\n    }\n  },\n  decls: 47,\n  vars: 87,\n  consts: [[\"slot\", \"start\"], [3, \"text\"], [\"class\", \"core-bar-button-image\", \"alt\", \"\", \"onError\", \"this.src='assets/img/group-avatar.svg'\", \"core-external-content\", \"\", \"role\", \"presentation\", 3, \"src\", \"siteId\", 4, \"ngIf\"], [\"class\", \"core-bar-button-image\", 3, \"user\", \"linkProfile\", \"checkOnline\", 4, \"ngIf\"], [\"contextLevel\", \"system\", 3, \"text\", \"contextInstanceId\"], [\"name\", \"fas-star\", 4, \"ngIf\"], [\"name\", \"fas-bell-slash\", 4, \"ngIf\"], [\"slot\", \"end\"], [\"iconAction\", \"fas-circle-info\", 3, \"hidden\", \"priority\", \"content\", \"action\"], [3, \"hidden\", \"priority\", \"closeOnClick\", \"content\", \"iconAction\", \"iconSlash\", \"action\"], [3, \"hidden\", \"priority\", \"content\", \"iconAction\", \"action\"], [3, \"hidden\", \"priority\", \"closeOnClick\", \"content\", \"iconAction\", \"action\"], [\"iconAction\", \"toggle\", 3, \"hidden\", \"priority\", \"content\", \"toggle\", \"toggleChange\"], [3, \"hidden\", \"priority\", \"content\", \"closeOnClick\", \"iconAction\", \"action\"], [3, \"hidden\", \"priority\", \"content\", \"iconAction\", \"iconSlash\", \"action\"], [3, \"ionScroll\"], [3, \"hideUntil\"], [\"position\", \"top\", 3, \"enabled\", \"error\", \"action\"], [4, \"ngIf\"], [1, \"sr-only\"], [1, \"addon-messages-discussion-container\"], [4, \"ngFor\", \"ngForOf\"], [\"icon\", \"far-comments\", 3, \"message\", 4, \"ngIf\"], [\"slot\", \"fixed\", \"core-fab\", \"\", \"vertical\", \"bottom\", \"horizontal\", \"end\", 4, \"ngIf\"], [\"class\", \"footer-adjustable\", 4, \"ngIf\"], [\"alt\", \"\", \"onError\", \"this.src='assets/img/group-avatar.svg'\", \"core-external-content\", \"\", \"role\", \"presentation\", 1, \"core-bar-button-image\", 3, \"src\", \"siteId\"], [1, \"core-bar-button-image\", 3, \"user\", \"linkProfile\", \"checkOnline\"], [\"name\", \"fas-star\"], [\"name\", \"fas-bell-slash\"], [1, \"ion-text-center\"], [\"class\", \"ion-text-center addon-messages-date\", 4, \"ngIf\"], [\"class\", \"addon-messages-unreadfrom\", \"color\", \"light\", 4, \"ngIf\"], [3, \"message\", \"user\", \"text\", \"showDelete\", \"time\", \"afterRender\", \"onDeleteMessage\"], [1, \"ion-text-center\", \"addon-messages-date\"], [\"color\", \"light\", 1, \"addon-messages-unreadfrom\"], [\"name\", \"fas-arrow-down\", \"aria-hidden\", \"true\"], [\"icon\", \"far-comments\", 3, \"message\"], [\"slot\", \"fixed\", \"core-fab\", \"\", \"vertical\", \"bottom\", \"horizontal\", \"end\"], [\"size\", \"small\", \"color\", \"light\", 3, \"click\"], [1, \"core-discussion-messages-badge\"], [1, \"footer-adjustable\"], [3, \"color\"], [\"class\", \"ion-text-center ion-margin-horizontal\", 4, \"ngIf\"], [\"class\", \"ion-padding-horizontal\", 4, \"ngIf\"], [3, \"showKeyboard\", \"placeholder\", \"onSubmit\", 4, \"ngIf\"], [1, \"ion-text-center\", \"ion-margin-horizontal\"], [1, \"ion-padding-horizontal\"], [\"expand\", \"block\", 1, \"ion-text-wrap\", \"ion-margin-bottom\", 3, \"click\"], [\"expand\", \"block\", \"fill\", \"outline\", 1, \"ion-text-wrap\", \"ion-margin-bottom\", 3, \"click\"], [\"class\", \"ion-text-center\", 4, \"ngIf\"], [3, \"showKeyboard\", \"placeholder\", \"onSubmit\"]],\n  template: function AddonMessagesDiscussionPage_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"ion-header\")(1, \"ion-toolbar\")(2, \"ion-buttons\", 0);\n      i0.ɵɵelement(3, \"ion-back-button\", 1);\n      i0.ɵɵpipe(4, \"translate\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(5, \"ion-title\")(6, \"h1\");\n      i0.ɵɵtemplate(7, AddonMessagesDiscussionPage_img_7_Template, 1, 2, \"img\", 2);\n      i0.ɵɵtemplate(8, AddonMessagesDiscussionPage_core_user_avatar_8_Template, 1, 3, \"core-user-avatar\", 3);\n      i0.ɵɵelement(9, \"core-format-text\", 4);\n      i0.ɵɵtemplate(10, AddonMessagesDiscussionPage_ion_icon_10_Template, 2, 3, \"ion-icon\", 5);\n      i0.ɵɵtemplate(11, AddonMessagesDiscussionPage_ion_icon_11_Template, 2, 3, \"ion-icon\", 6);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelement(12, \"ion-buttons\", 7);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(13, \"core-navbar-buttons\", 7)(14, \"core-context-menu\");\n      i0.ɵɵpipe(15, \"translate\");\n      i0.ɵɵelementStart(16, \"core-context-menu-item\", 8);\n      i0.ɵɵlistener(\"action\", function AddonMessagesDiscussionPage_Template_core_context_menu_item_action_16_listener() {\n        return ctx.viewInfo();\n      });\n      i0.ɵɵpipe(17, \"translate\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(18, \"core-context-menu-item\", 8);\n      i0.ɵɵlistener(\"action\", function AddonMessagesDiscussionPage_Template_core_context_menu_item_action_18_listener() {\n        return ctx.viewInfo();\n      });\n      i0.ɵɵpipe(19, \"translate\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(20, \"core-context-menu-item\", 9);\n      i0.ɵɵlistener(\"action\", function AddonMessagesDiscussionPage_Template_core_context_menu_item_action_20_listener($event) {\n        return ctx.changeFavourite($event);\n      });\n      i0.ɵɵpipe(21, \"translate\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(22, \"core-context-menu-item\", 10);\n      i0.ɵɵlistener(\"action\", function AddonMessagesDiscussionPage_Template_core_context_menu_item_action_22_listener() {\n        return ctx.blockUser();\n      });\n      i0.ɵɵpipe(23, \"translate\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(24, \"core-context-menu-item\", 10);\n      i0.ɵɵlistener(\"action\", function AddonMessagesDiscussionPage_Template_core_context_menu_item_action_24_listener() {\n        return ctx.unblockUser();\n      });\n      i0.ɵɵpipe(25, \"translate\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(26, \"core-context-menu-item\", 11);\n      i0.ɵɵlistener(\"action\", function AddonMessagesDiscussionPage_Template_core_context_menu_item_action_26_listener($event) {\n        return ctx.changeMute($event);\n      });\n      i0.ɵɵpipe(27, \"translate\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(28, \"core-context-menu-item\", 12);\n      i0.ɵɵlistener(\"toggleChange\", function AddonMessagesDiscussionPage_Template_core_context_menu_item_toggleChange_28_listener($event) {\n        return ctx.showDelete = $event;\n      });\n      i0.ɵɵpipe(29, \"translate\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(30, \"core-context-menu-item\", 13);\n      i0.ɵɵlistener(\"action\", function AddonMessagesDiscussionPage_Template_core_context_menu_item_action_30_listener($event) {\n        return ctx.deleteConversation($event);\n      });\n      i0.ɵɵpipe(31, \"translate\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(32, \"core-context-menu-item\", 10);\n      i0.ɵɵlistener(\"action\", function AddonMessagesDiscussionPage_Template_core_context_menu_item_action_32_listener() {\n        return ctx.createContactRequest();\n      });\n      i0.ɵɵpipe(33, \"translate\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(34, \"core-context-menu-item\", 14);\n      i0.ɵɵlistener(\"action\", function AddonMessagesDiscussionPage_Template_core_context_menu_item_action_34_listener() {\n        return ctx.removeContact();\n      });\n      i0.ɵɵpipe(35, \"translate\");\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(36, \"ion-content\", 15);\n      i0.ɵɵlistener(\"ionScroll\", function AddonMessagesDiscussionPage_Template_ion_content_ionScroll_36_listener() {\n        return ctx.scrollFunction();\n      });\n      i0.ɵɵelementStart(37, \"core-loading\", 16)(38, \"core-infinite-loading\", 17);\n      i0.ɵɵlistener(\"action\", function AddonMessagesDiscussionPage_Template_core_infinite_loading_action_38_listener($event) {\n        return ctx.loadPrevious($event);\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(39, AddonMessagesDiscussionPage_ng_container_39_Template, 8, 6, \"ng-container\", 18);\n      i0.ɵɵelementStart(40, \"h2\", 19);\n      i0.ɵɵtext(41);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(42, \"ion-list\", 20);\n      i0.ɵɵtemplate(43, AddonMessagesDiscussionPage_ng_container_43_Template, 4, 7, \"ng-container\", 21);\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(44, AddonMessagesDiscussionPage_core_empty_box_44_Template, 2, 3, \"core-empty-box\", 22);\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(45, AddonMessagesDiscussionPage_ion_fab_45_Template, 9, 7, \"ion-fab\", 23);\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(46, AddonMessagesDiscussionPage_ion_footer_46_Template, 8, 7, \"ion-footer\", 24);\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"text\", i0.ɵɵpipeBind1(4, 63, \"core.back\"));\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngIf\", ctx.loaded && !ctx.otherMember && ctx.conversationImage);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.loaded && ctx.otherMember);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"text\", ctx.title)(\"contextInstanceId\", 0);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.conversation && ctx.conversation.isfavourite);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.conversation && ctx.conversation.ismuted);\n      i0.ɵɵadvance(3);\n      i0.ɵɵattribute(\"aria-label\", i0.ɵɵpipeBind1(15, 65, \"addon.messages.conversationactions\"));\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"hidden\", ctx.isSelf || !ctx.showInfo || ctx.isGroup)(\"priority\", 1000)(\"content\", i0.ɵɵpipeBind1(17, 67, \"addon.messages.info\"));\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"hidden\", ctx.isSelf || !ctx.showInfo || !ctx.isGroup)(\"priority\", 1000)(\"content\", i0.ɵɵpipeBind1(19, 69, \"addon.messages.groupinfo\"));\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"hidden\", !ctx.groupMessagingEnabled || !ctx.conversation)(\"priority\", 800)(\"closeOnClick\", false)(\"content\", i0.ɵɵpipeBind1(21, 71, ctx.conversation && ctx.conversation.isfavourite ? \"addon.messages.removefromfavourites\" : \"addon.messages.addtofavourites\"))(\"iconAction\", ctx.favouriteIcon)(\"iconSlash\", ctx.favouriteIconSlash);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"hidden\", ctx.isSelf || !ctx.otherMember || ctx.otherMember.isblocked)(\"priority\", 700)(\"content\", i0.ɵɵpipeBind1(23, 73, \"addon.messages.blockuser\"))(\"iconAction\", ctx.blockIcon);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"hidden\", ctx.isSelf || !ctx.otherMember || !ctx.otherMember.isblocked)(\"priority\", 700)(\"content\", i0.ɵɵpipeBind1(25, 75, \"addon.messages.unblockuser\"))(\"iconAction\", ctx.blockIcon);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"hidden\", ctx.isSelf || !ctx.muteEnabled || !ctx.conversation)(\"priority\", 600)(\"closeOnClick\", false)(\"content\", i0.ɵɵpipeBind1(27, 77, ctx.conversation && ctx.conversation.ismuted ? \"addon.messages.unmuteconversation\" : \"addon.messages.muteconversation\"))(\"iconAction\", ctx.muteIcon);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"hidden\", !ctx.canDelete || !ctx.messages || !ctx.messages.length)(\"priority\", 400)(\"content\", i0.ɵɵpipeBind1(29, 79, \"addon.messages.showdeletemessages\"))(\"toggle\", ctx.showDelete);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"hidden\", !ctx.groupMessagingEnabled || !ctx.conversationId || ctx.isGroup || !ctx.messages || !ctx.messages.length)(\"priority\", 200)(\"content\", i0.ɵɵpipeBind1(31, 81, \"addon.messages.deleteconversation\"))(\"closeOnClick\", false)(\"iconAction\", ctx.deleteIcon);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"hidden\", ctx.isSelf || !ctx.otherMember || ctx.otherMember.iscontact || ctx.requestContactSent || ctx.requestContactReceived)(\"priority\", 100)(\"content\", i0.ɵɵpipeBind1(33, 83, \"addon.messages.addtoyourcontacts\"))(\"iconAction\", ctx.addRemoveIcon);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"hidden\", ctx.isSelf || !ctx.otherMember || !ctx.otherMember.iscontact)(\"priority\", 100)(\"content\", i0.ɵɵpipeBind1(35, 85, \"addon.messages.removefromyourcontacts\"))(\"iconAction\", ctx.addRemoveIcon)(\"iconSlash\", true);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"hideUntil\", ctx.loaded);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"enabled\", ctx.canLoadMore)(\"error\", ctx.loadMoreError);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.isSelf && !ctx.canLoadMore);\n      i0.ɵɵadvance(2);\n      i0.ɵɵtextInterpolate(ctx.title);\n      i0.ɵɵadvance(1);\n      i0.ɵɵclassProp(\"addon-messages-discussion-group\", ctx.isGroup);\n      i0.ɵɵattribute(\"aria-live\", \"polite\");\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngForOf\", ctx.messages);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", !ctx.messages || ctx.messages.length <= 0);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.loaded && ctx.newMessages > 0);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.loaded && (!ctx.conversationId || ctx.conversation));\n    }\n  },\n  dependencies: [i2.NgForOf, i2.NgIf, i3.CoreContextMenuComponent, i4.CoreContextMenuItemComponent, i5.CoreEmptyBoxComponent, i6.CoreInfiniteLoadingComponent, i7.CoreLoadingComponent, i8.CoreMessageComponent, i9.CoreNavBarButtonsComponent, i10.CoreSendMessageFormComponent, i11.CoreUserAvatarComponent, i12.CoreExternalContentDirective, i13.CoreFabDirective, i14.CoreFaIconDirective, i15.CoreFormatTextDirective, i16.CoreContentDirective, i17.CoreUpdateNonReactiveAttributesDirective, i18.IonBadge, i18.IonButton, i18.IonButtons, i18.IonChip, i18.IonContent, i18.IonFab, i18.IonFabButton, i18.IonFooter, i18.IonHeader, i18.IonIcon, i18.IonLabel, i18.IonList, i18.IonTitle, i18.IonToolbar, i18.IonBackButton, i19.CoreFormatDatePipe, i20.TranslatePipe],\n  styles: [\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n.ios[_nghost-%COMP%]   ion-footer[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]:last-child, .ios   [_nghost-%COMP%]   ion-footer[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]:last-child {\\n  padding-bottom: 4px;\\n  min-height: 0;\\n}\\n\\nion-content[_ngcontent-%COMP%] {\\n  --content-background: var(--background-alternative);\\n  --background: var(--content-background);\\n}\\nion-content[_ngcontent-%COMP%]::part(scroll) {\\n  padding-bottom: 0 !important;\\n}\\n\\n.addon-messages-discussion-container[_ngcontent-%COMP%] {\\n  display: flex;\\n  flex-direction: column;\\n  padding-bottom: 16px !important;\\n  background: var(--content-background);\\n}\\n\\n.addon-messages-date[_ngcontent-%COMP%] {\\n  font-weight: normal;\\n  font-size: 0.9rem;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy90aGVtZS9nbG9iYWxzLnNjc3MiLCJ3ZWJwYWNrOi8vLi9zcmMvdGhlbWUvaGVscGVycy9pb25pYy5mdW5jdGlvbnMuc3RyaW5nLnNjc3MiLCJ3ZWJwYWNrOi8vLi9zcmMvdGhlbWUvaGVscGVycy9pb25pYy5mdW5jdGlvbnMuY29sb3Iuc2NzcyIsIndlYnBhY2s6Ly8uL3NyYy90aGVtZS9oZWxwZXJzL2lvbmljLm1peGlucy5zY3NzIiwid2VicGFjazovLy4vc3JjL3RoZW1lL2hlbHBlcnMvaW9uaWMuY29tcG9uZW50cy5taXhpbnMuc2NzcyIsIndlYnBhY2s6Ly8uL3NyYy90aGVtZS9oZWxwZXJzL2N1c3RvbS5taXhpbnMuc2NzcyIsIndlYnBhY2s6Ly8uL3NyYy90aGVtZS9nbG9iYWxzLmN1c3RvbS5zY3NzIiwid2VicGFjazovLy4vc3JjL3RoZW1lL2dsb2JhbHMudmFyaWFibGVzLnNjc3MiLCJ3ZWJwYWNrOi8vLi9zcmMvdGhlbWUvY29tcG9uZW50cy9kaXNjdXNzaW9uLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7RUFBQTtBQ0FBOzs7OztFQUFBO0FDQUE7Ozs7O0VBQUE7QUNBQTs7Ozs7RUFBQTtBQ0FBOzs7Ozs7RUFBQTtBQ0VBOzs7O0VBQUE7QUE0R0E7O0VBQUE7QUM5R0E7Ozs7RUFBQTtBQ0FBOzs7O0VBQUE7QUErREE7Ozs7RUFBQTtBQzVESTtFQUNJLG1CQUFBO0VBQ0EsYUFBQTtBQW1EUjs7QUEvQ0E7RUFDSSxtREFBQTtFQUNBLHVDQUFBO0FBa0RKO0FBaERJO0VBQ0ksNEJBQUE7QUFrRFI7O0FBOUNBO0VBQ0ksYUFBQTtFQUNBLHNCQUFBO0VBQ0EsK0JBQUE7RUFDQSxxQ0FBQTtBQWlESjs7QUE5Q0E7RUFDSSxtQkFBQTtFQUNBLGlCQUFBO0FBaURKIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBBcHAgR2xvYmFsIHZhcmlhYmxlcyBTQ1NTXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiBQbGFjZSBoZXJlIHRoZSBkaWZmZXJlbnQgZmlsZXMgeW91IHNob3VsZCBpbXBvcnQgdG8gdXNlIGdsb2JhbCB2YXJpYWJsZXMuXG4gKi9cblxuJGZvbnQtcGF0aDogXCIuLi9hc3NldHMvZm9udHNcIjtcbiRhc3NldHMtcGF0aDogXCIuLi9hc3NldHNcIjtcblxuQGltcG9ydCBcIi4vaGVscGVycy9oZWxwZXJzLnNjc3NcIjtcbkBpbXBvcnQgXCIuL2dsb2JhbHMuY3VzdG9tLnNjc3NcIjtcbkBpbXBvcnQgXCIuL2dsb2JhbHMudmFyaWFibGVzLnNjc3NcIjtcbiIsIi8qKlxuICogSW1wb3J0ZWQgaW9uaWMgc3RyaW5nIGZ1bmN0aW9ucyBmb3IgU0NTU1xuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogRXh0cmFjdGVkIGZyb21cbiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9pb25pYy10ZWFtL2lvbmljLWZyYW1ld29yay9ibG9iL21hc3Rlci9jb3JlL3NyYy90aGVtZXMvaW9uaWMuZnVuY3Rpb25zLnN0cmluZy5zY3NzXG4gKi9cblxuXG4vLyBTdHJpbmcgVXRpbGl0eSBGdW5jdGlvbnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbi8vIFN0cmluZyBSZXBsYWNlIEZ1bmN0aW9uXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5AZnVuY3Rpb24gc3RyLXJlcGxhY2UoJHN0cmluZywgJHNlYXJjaCwgJHJlcGxhY2U6IFwiXCIpIHtcbiAgJGluZGV4OiBzdHItaW5kZXgoJHN0cmluZywgJHNlYXJjaCk7XG5cbiAgQGlmICRpbmRleCB7XG4gICAgQHJldHVybiBzdHItc2xpY2UoJHN0cmluZywgMSwgJGluZGV4IC0gMSkgKyAkcmVwbGFjZSArIHN0ci1yZXBsYWNlKHN0ci1zbGljZSgkc3RyaW5nLCAkaW5kZXggKyBzdHItbGVuZ3RoKCRzZWFyY2gpKSwgJHNlYXJjaCwgJHJlcGxhY2UpO1xuICB9XG5cbiAgQHJldHVybiAkc3RyaW5nO1xufVxuXG4vLyBTdHJpbmcgU3BsaXQgRnVuY3Rpb25cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cblxuQGZ1bmN0aW9uIHN0ci1zcGxpdCgkc3RyaW5nLCAkc2VwYXJhdG9yKSB7XG4gIC8vIGVtcHR5IGFycmF5L2xpc3RcbiAgJHNwbGl0LWFycjogKCk7XG4gIC8vIGZpcnN0IGluZGV4IG9mIHNlcGFyYXRvciBpbiBzdHJpbmdcbiAgJGluZGV4OiBzdHItaW5kZXgoJHN0cmluZywgJHNlcGFyYXRvcik7XG4gIC8vIGxvb3AgdGhyb3VnaCBzdHJpbmdcbiAgQHdoaWxlICRpbmRleCAhPSBudWxsIHtcbiAgICAvLyBnZXQgdGhlIHN1YnN0cmluZyBmcm9tIHRoZSBmaXJzdCBjaGFyYWN0ZXIgdG8gdGhlIHNlcGFyYXRvclxuICAgICRpdGVtOiBzdHItc2xpY2UoJHN0cmluZywgMSwgJGluZGV4IC0gMSk7XG4gICAgLy8gcHVzaCBpdGVtIHRvIGFycmF5XG4gICAgJHNwbGl0LWFycjogYXBwZW5kKCRzcGxpdC1hcnIsICRpdGVtKTtcbiAgICAvLyByZW1vdmUgaXRlbSBhbmQgc2VwYXJhdG9yIGZyb20gc3RyaW5nXG4gICAgJHN0cmluZzogc3RyLXNsaWNlKCRzdHJpbmcsICRpbmRleCArIDEpO1xuICAgIC8vIGZpbmQgbmV3IGluZGV4IG9mIHNlcGFyYXRvclxuICAgICRpbmRleDogc3RyLWluZGV4KCRzdHJpbmcsICRzZXBhcmF0b3IpO1xuICB9XG4gIC8vIGFkZCB0aGUgcmVtYWluaW5nIHN0cmluZyB0byBsaXN0ICh0aGUgbGFzdCBpdGVtKVxuICAkc3BsaXQtYXJyOiBhcHBlbmQoJHNwbGl0LWFyciwgJHN0cmluZyk7XG5cbiAgQHJldHVybiAkc3BsaXQtYXJyO1xufVxuXG5cbi8vIFN0cmluZyBFeHRyYWN0IEZ1bmN0aW9uXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5AZnVuY3Rpb24gc3RyLWV4dHJhY3QoJHN0cmluZywgJHN0YXJ0LCAkZW5kKSB7XG4gICRzdGFydC1pbmRleDogc3RyLWluZGV4KCRzdHJpbmcsICRzdGFydCk7XG5cbiAgQGlmICRzdGFydC1pbmRleCB7XG4gICAgJHBvc3Q6IHN0ci1zbGljZSgkc3RyaW5nLCAkc3RhcnQtaW5kZXggKyBzdHItbGVuZ3RoKCRzdGFydCkpO1xuICAgICRlbmQtaW5kZXg6IHN0ci1pbmRleCgkcG9zdCwgJGVuZCk7XG5cbiAgICBAaWYgJGVuZC1pbmRleCB7XG4gICAgICBAcmV0dXJuIHN0ci1zbGljZSgkcG9zdCwgMSwgJGVuZC1pbmRleCAtIDEpO1xuICAgIH1cbiAgfVxuXG4gIEByZXR1cm4gbnVsbDtcbn1cblxuXG4vLyBTdHJpbmcgQ29udGFpbnMgRnVuY3Rpb25cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbkBmdW5jdGlvbiBzdHItY29udGFpbnMoJHN0cmluZywgJG5lZWRsZSkge1xuICBAaWYgKHR5cGUtb2YoJHN0cmluZykgPT0gc3RyaW5nKSB7XG4gICAgQHJldHVybiBzdHItaW5kZXgoJHN0cmluZywgJG5lZWRsZSkgIT0gbnVsbDtcbiAgfVxuXG4gIEByZXR1cm4gZmFsc2U7XG59XG5cblxuLy8gVVJMIEVuY29kZSBGdW5jdGlvblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuQGZ1bmN0aW9uIHVybC1lbmNvZGUoJHZhbCkge1xuICAkc3BhY2VzOiBzdHItcmVwbGFjZSgkdmFsLCBcIiBcIiwgXCIlMjBcIik7XG4gICRlbmNvZGVkOiBzdHItcmVwbGFjZSgkc3BhY2VzLCBcIiNcIiwgXCIlMjNcIik7XG4gIEByZXR1cm4gJGVuY29kZWQ7XG59XG5cblxuLy8gQWRkIFJvb3QgU2VsZWN0b3Jcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBBZGRzIGEgcm9vdCBzZWxlY3RvciB1c2luZyBob3N0IGJhc2VkIG9uIHRoZSBzZWxlY3RvciBwYXNzZWRcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbkBmdW5jdGlvbiBhZGQtcm9vdC1zZWxlY3Rvcigkcm9vdCwgJGFkZEhvc3RTZWxlY3Rvcikge1xuICAkc2VsZWN0b3JzOiBzdHItc3BsaXQoJHJvb3QsIFwiLFwiKTtcblxuICAkbGlzdDogKCk7XG5cbiAgQGVhY2ggJHNlbGVjdG9yIGluICRzZWxlY3RvcnMge1xuICAgIC8vIElmIHRoZSBzZWxlY3RvciBjb250YWlucyA6aG9zdCggaXQgbWVhbnMgaXQgaXMgdGFyZ2V0aW5nIGEgY2xhc3Mgb24gdGhlIGhvc3RcbiAgICAvLyBlbGVtZW50IHNvIHdlIG5lZWQgdG8gY2hhbmdlIGhvdyB3ZSB0YXJnZXQgaXQ6XG4gICAgLy8gQGluY2x1ZGUgYWRkLXJvb3Qtc2VsZWN0b3IoXCI6aG9zdCguZml4ZWQpXCIsIFwiW2Rpcj1ydGxdXCIpXG4gICAgLy8gLS0+IDpob3N0LWNvbnRleHQoW2Rpcj1ydGxdKTpob3N0KC5maXhlZClcbiAgICAvLyAtLT4gOmhvc3QtY29udGV4dChbZGlyPXJ0bF0pLmZpeGVkXG4gICAgQGlmIHN0ci1jb250YWlucygkc2VsZWN0b3IsIFwiOmhvc3QoXCIpIHtcbiAgICAgIC8vIEBpbmNsdWRlIGFkZC1yb290LXNlbGVjdG9yKFwiOmhvc3QoLmZpeGVkKVwiLCBcIltkaXI9cnRsXVwiKVxuICAgICAgLy8gLS0+IDpob3N0LWNvbnRleHQoW2Rpcj1ydGxdKTpob3N0KC5maXhlZClcbiAgICAgICRzaGFkb3ctZWxlbWVudDogc3RyLXJlcGxhY2UoJHNlbGVjdG9yLCBcIjpob3N0KFwiLCBcIjpob3N0LWNvbnRleHQoI3skYWRkSG9zdFNlbGVjdG9yfSk6aG9zdChcIik7XG4gICAgICAkbGlzdDogYXBwZW5kKCRsaXN0LCAkc2hhZG93LWVsZW1lbnQsIGNvbW1hKTtcblxuICAgICAgJG5ldy1lbGVtZW50OiAoKTtcbiAgICAgICRlbGVtZW50czogc3RyLXNwbGl0KCRzZWxlY3RvciwgXCIgXCIpO1xuXG4gICAgICBAZWFjaCAkZWxlbWVudCBpbiAkZWxlbWVudHMge1xuICAgICAgICBAaWYgc3RyLWNvbnRhaW5zKCRlbGVtZW50LCBcIjpob3N0KFwiKSB7XG4gICAgICAgICAgJHNjb3BlZC1lbGVtZW50OiAkZWxlbWVudDtcblxuICAgICAgICAgIC8vIFJlcGxhY2UgdGhlIDpob3N0KCBhbmQgKSBzbyBhbGwgd2UgaGF2ZSBsZWZ0IGlzIHRoZSBjbGFzc1xuICAgICAgICAgIC8vIGluc2lkZSBvZiBpdDpcbiAgICAgICAgICAvLyA6aG9zdCguZml4ZWQpIC0+IC5maXhlZFxuICAgICAgICAgICRzY29wZWQtZWxlbWVudDogc3RyLXJlcGxhY2UoJHNjb3BlZC1lbGVtZW50LCBcIilcIiwgXCJcIik7XG4gICAgICAgICAgJHNjb3BlZC1lbGVtZW50OiBzdHItcmVwbGFjZSgkc2NvcGVkLWVsZW1lbnQsIFwiOmhvc3QoXCIsIFwiXCIpO1xuXG4gICAgICAgICAgLy8gQWRkIHRoZSBjbGFzcyBiYWNrIGluc2lkZSBvZiBob3N0IHdpdGggdGhlIHJ0bCBzZWxlY3RvcjpcbiAgICAgICAgICAvLyAuZml4ZWQgLT4gOmhvc3QtY29udGV4dChbZGlyPXJ0bF0pLmZpeGVkXG4gICAgICAgICAgJHNjb3BlZC1lbGVtZW50OiBzdHItcmVwbGFjZSgkc2NvcGVkLWVsZW1lbnQsICRzY29wZWQtZWxlbWVudCwgXCI6aG9zdC1jb250ZXh0KCN7JGFkZEhvc3RTZWxlY3Rvcn0pI3skc2NvcGVkLWVsZW1lbnR9XCIpO1xuXG4gICAgICAgICAgLy8gQGluY2x1ZGUgYWRkLXJvb3Qtc2VsZWN0b3IoXCI6aG9zdCguZml4ZWQpXCIsIFwiW2Rpcj1ydGxdXCIpXG4gICAgICAgICAgLy8gLS0+IDpob3N0LWNvbnRleHQoW2Rpcj1ydGxdKS5maXhlZFxuICAgICAgICAgICRuZXctZWxlbWVudDogYXBwZW5kKCRuZXctZWxlbWVudCwgJHNjb3BlZC1lbGVtZW50LCBzcGFjZSk7XG4gICAgICAgIH0gQGVsc2Uge1xuICAgICAgICAgIC8vIEFkZCBiYWNrIGFueSBzZWxlY3RvcnMgdGhhdCBmb2xsb3dlZCB0aGUgaG9zdCBhZnRlciB0cmFuc2Zvcm1pbmcgdGhlXG4gICAgICAgICAgLy8gZmlyc3Qgc2VsZWN0b3I6XG4gICAgICAgICAgLy8gOmhvc3QoLmZpeGVkKSA6OnNsb3R0ZWQoaW9uLWljb24pXG4gICAgICAgICAgLy8gLS0+IDpob3N0LWNvbnRleHQoW2Rpcj1ydGxdKTpob3N0KC5maXhlZCkgOjpzbG90dGVkKGlvbi1pY29uKVxuICAgICAgICAgIC8vIC0tPiA6aG9zdC1jb250ZXh0KFtkaXI9cnRsXSkuZml4ZWQgOjpzbG90dGVkKGlvbi1pY29uKVxuICAgICAgICAgICRuZXctZWxlbWVudDogYXBwZW5kKCRuZXctZWxlbWVudCwgJGVsZW1lbnQsIHNwYWNlKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAkbGlzdDogYXBwZW5kKCRsaXN0LCAkbmV3LWVsZW1lbnQsIGNvbW1hKTtcbiAgICAvLyBJZiB0aGUgc2VsZWN0b3IgY29udGFpbnMgOmhvc3Qgd2l0aG91dCBhIHBhcmFudGhlc2VzXG4gICAgLy8gaXQgbWVhbnMgaXQgaXMgdGFyZ2V0aW5nIGp1c3QgdGhlIGhvc3RcbiAgICAvLyBlbGVtZW50IHNvIHdlIGNhbiBjaGFuZ2UgaXQgdG8gbG9vayBmb3IgaG9zdC1jb250ZXh0XG4gICAgLy8gQGluY2x1ZGUgYWRkLXJvb3Qtc2VsZWN0b3IoXCI6aG9zdFwiLCBcIltkaXI9cnRsXVwiKVxuICAgIC8vIC0tPiA6aG9zdC1jb250ZXh0KFtkaXI9cnRsXSlcbiAgICAvLyAtLT4gOmhvc3Q6ZGlyKHJ0bClcbiAgICB9IEBlbHNlIGlmIHN0ci1jb250YWlucygkc2VsZWN0b3IsIFwiOmhvc3RcIikge1xuICAgICAgJG5ldy1lbGVtZW50OiAoKTtcbiAgICAgICRlbGVtZW50czogc3RyLXNwbGl0KCRzZWxlY3RvciwgXCIgXCIpO1xuXG4gICAgICBAZWFjaCAkZWxlbWVudCBpbiAkZWxlbWVudHMge1xuICAgICAgICBAaWYgc3RyLWNvbnRhaW5zKCRlbGVtZW50LCBcIjpob3N0XCIpIHtcbiAgICAgICAgICAvLyBSZXBsYWNlIHRoZSA6aG9zdCB3aXRoIHRoZSBhZGRIb3N0U2VsZWN0b3I6XG4gICAgICAgICAgLy8gOmhvc3QgLT4gOmhvc3QtY29udGV4dChbZGlyPXJ0bF0pXG4gICAgICAgICAgJHVwZGF0ZWQtZWxlbWVudDogc3RyLXJlcGxhY2UoJGVsZW1lbnQsIFwiOmhvc3RcIiwgXCI6aG9zdC1jb250ZXh0KCN7JGFkZEhvc3RTZWxlY3Rvcn0pXCIpO1xuXG4gICAgICAgICAgLy8gQWRkIHRoZSBmaW5hbCBzZWxlY3RvciBhZnRlciBhbGwgdHJhbnNmb3JtYXRpb25zOlxuICAgICAgICAgIC8vIDpob3N0IC0+IDpob3N0LWNvbnRleHQoW2Rpcj1ydGxdKVxuICAgICAgICAgICRuZXctZWxlbWVudDogYXBwZW5kKCRuZXctZWxlbWVudCwgJHVwZGF0ZWQtZWxlbWVudCwgc3BhY2UpO1xuICAgICAgICB9IEBlbHNlIHtcbiAgICAgICAgICAvLyBBZGQgYmFjayBhbnkgc2VsZWN0b3JzIHRoYXQgZm9sbG93ZWQgdGhlIGhvc3QgYWZ0ZXIgdHJhbnNmb3JtaW5nIHRoZVxuICAgICAgICAgIC8vIGZpcnN0IHNlbGVjdG9yOlxuICAgICAgICAgIC8vIDpob3N0IDo6c2xvdHRlZChpb24taWNvbikgLT4gOmhvc3QtY29udGV4dChbZGlyPXJ0bF0pIDo6c2xvdHRlZChpb24taWNvbilcbiAgICAgICAgICAkbmV3LWVsZW1lbnQ6IGFwcGVuZCgkbmV3LWVsZW1lbnQsICRlbGVtZW50LCBzcGFjZSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgJGxpc3Q6IGFwcGVuZCgkbGlzdCwgJG5ldy1lbGVtZW50LCBjb21tYSk7XG4gICAgLy8gSWYgdGhlIHNlbGVjdG9yIGRvZXMgbm90IGNvbnRhaW4gaG9zdCBhdCBhbGwgaXQgaXMgZWl0aGVyIGEgc2hhZG93XG4gICAgLy8gb3Igbm9ybWFsIGVsZW1lbnQgc28gYXBwZW5kIGJvdGggdGhlIGFkZEhvc3RTZWxlY3RvciBhbmQgaG9zdC1jb250ZXh0XG4gICAgLy8gQGluY2x1ZGUgYWRkLXJvb3Qtc2VsZWN0b3IoXCJpb24tY29tcG9uZW50XCIsIFwiW2Rpcj1ydGxdXCIpXG4gICAgLy8gLS0+IDpob3N0LWNvbnRleHQoW2Rpcj1ydGxdKSBpb24tY29tcG9uZW50XG4gICAgLy8gLS0+IFtkaXI9cnRsXSBpb24tY29tcG9uZW50XG4gICAgfSBAZWxzZSB7XG4gICAgICAkbGlzdDogYXBwZW5kKCRsaXN0LCBcIiN7JGFkZEhvc3RTZWxlY3Rvcn0gI3skc2VsZWN0b3J9XCIsIGNvbW1hKTtcbiAgICAgICRsaXN0OiBhcHBlbmQoJGxpc3QsIFwiOmhvc3QtY29udGV4dCgjeyRhZGRIb3N0U2VsZWN0b3J9KSAjeyRzZWxlY3Rvcn1cIiwgY29tbWEpO1xuICAgIH1cbiAgfVxuXG4gIEByZXR1cm4gJGxpc3Q7XG59XG4iLCIvKipcbiAqIEltcG9ydGVkIGlvbmljIGNvbG9yIGZ1bmN0aW9ucyBmb3IgU0NTU1xuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogRXh0cmFjdGVkIGZyb21cbiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9pb25pYy10ZWFtL2lvbmljLWZyYW1ld29yay9ibG9iL21hc3Rlci9jb3JlL3NyYy90aGVtZXMvaW9uaWMuZnVuY3Rpb25zLmNvbG9yLnNjc3NcbiAqL1xuXG4vLyBHZXRzIHRoZSBhY3RpdmUgY29sb3IncyBjc3MgdmFyaWFibGUgZnJvbSBhIHZhcmlhdGlvbi4gQWxwaGEgaXMgb3B0aW9uYWwuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gRXhhbXBsZSB1c2FnZTpcbi8vIGN1cnJlbnQtY29sb3IoYmFzZSkgPT4gdmFyKC0taW9uLWNvbG9yLWJhc2UpXG4vLyBjdXJyZW50LWNvbG9yKGNvbnRyYXN0LCAwLjEpID0+IHJnYmEodmFyKC0taW9uLWNvbG9yLWNvbnRyYXN0LXJnYiksIDAuMSlcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5AZnVuY3Rpb24gY3VycmVudC1jb2xvcigkdmFyaWF0aW9uLCAkYWxwaGE6IG51bGwpIHtcbiAgQGlmICRhbHBoYSA9PSBudWxsIHtcbiAgICBAcmV0dXJuIHZhcigtLWlvbi1jb2xvci0jeyR2YXJpYXRpb259KTtcbiAgfSBAZWxzZSB7XG4gICAgQHJldHVybiByZ2JhKHZhcigtLWlvbi1jb2xvci0jeyR2YXJpYXRpb259LXJnYiksICN7JGFscGhhfSk7XG4gIH1cbn1cblxuLy8gR2V0cyB0aGUgc3BlY2lmaWMgY29sb3IncyBjc3MgdmFyaWFibGUgZnJvbSB0aGUgbmFtZSBhbmQgdmFyaWF0aW9uLiBBbHBoYS9yZ2IgYXJlIG9wdGlvbmFsLlxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIEV4YW1wbGUgdXNhZ2U6XG4vLyBpb24tY29sb3IocHJpbWFyeSwgYmFzZSkgPT4gdmFyKC0taW9uLWNvbG9yLXByaW1hcnksICMzODgwZmYpXG4vLyBpb24tY29sb3Ioc2Vjb25kYXJ5LCBjb250cmFzdCkgPT4gdmFyKC0taW9uLWNvbG9yLXNlY29uZGFyeS1jb250cmFzdClcbi8vIGlvbi1jb2xvcihwcmltYXJ5LCBiYXNlLCAwLjUpID0+IHJnYmEodmFyKC0taW9uLWNvbG9yLXByaW1hcnktcmdiLCA1NiwgMTI4LCAyNTUpLCAwLjUpXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQGZ1bmN0aW9uIGlvbi1jb2xvcigkbmFtZSwgJHZhcmlhdGlvbiwgJGFscGhhOiBudWxsLCAkcmdiOiBudWxsKSB7XG4gICR2YWx1ZXM6IG1hcC1nZXQoJGNvbG9ycywgJG5hbWUpO1xuICAkdmFsdWU6IG1hcC1nZXQoJHZhbHVlcywgJHZhcmlhdGlvbik7XG4gICR2YXJpYWJsZTogLS1pb24tY29sb3ItI3skbmFtZX0tI3skdmFyaWF0aW9ufTtcblxuICBAaWYgKCR2YXJpYXRpb24gPT0gYmFzZSkge1xuICAgICR2YXJpYWJsZTogLS1pb24tY29sb3ItI3skbmFtZX07XG4gIH1cblxuICBAaWYgKCRhbHBoYSkge1xuICAgICR2YWx1ZTogY29sb3ItdG8tcmdiLWxpc3QoJHZhbHVlKTtcbiAgICBAcmV0dXJuIHJnYmEodmFyKCN7JHZhcmlhYmxlfS1yZ2IsICR2YWx1ZSksICRhbHBoYSk7XG4gIH1cbiAgQGlmICgkcmdiKSB7XG4gICAgJHZhbHVlOiBjb2xvci10by1yZ2ItbGlzdCgkdmFsdWUpO1xuICAgICR2YXJpYWJsZTogI3skdmFyaWFibGV9LXJnYjtcbiAgfVxuXG4gIEByZXR1cm4gdmFyKCN7JHZhcmlhYmxlfSwgJHZhbHVlKTtcbn1cblxuLy8gTWl4ZXMgYSBjb2xvciB3aXRoIGJsYWNrIHRvIGNyZWF0ZSBpdHMgc2hhZGUuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQGZ1bmN0aW9uIGdldC1jb2xvci1zaGFkZSgkY29sb3IpIHtcbiAgQHJldHVybiBtaXgoIzAwMCwgJGNvbG9yLCAxMiUpO1xufVxuXG4vLyBNaXhlcyBhIGNvbG9yIHdpdGggd2hpdGUgdG8gY3JlYXRlIGl0cyB0aW50LlxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbkBmdW5jdGlvbiBnZXQtY29sb3ItdGludCgkY29sb3IpIHtcbiAgQHJldHVybiBtaXgoI2ZmZiwgJGNvbG9yLCAxMCUpO1xufVxuXG4vLyBDb252ZXJ0cyBhIGNvbG9yIHRvIGEgY29tbWEgc2VwYXJhdGVkIHJnYi5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5AZnVuY3Rpb24gY29sb3ItdG8tcmdiLWxpc3QoJGNvbG9yKSB7XG4gIEByZXR1cm4gI3tyZWQoJGNvbG9yKX0sI3tncmVlbigkY29sb3IpfSwje2JsdWUoJGNvbG9yKX07XG59XG4iLCIvKipcbiAqIEltcG9ydGVkIGlvbmljIG1peGlucyBmb3IgU0NTU1xuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogRXh0cmFjdGVkIGZyb21cbiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9pb25pYy10ZWFtL2lvbmljLWZyYW1ld29yay9ibG9iL21hc3Rlci9jb3JlL3NyYy90aGVtZXMvaW9uaWMubWl4aW5zLnNjc3NcbiAqL1xuXG5AbWl4aW4gaW5wdXQtY292ZXIoKSB7XG4gIEBpbmNsdWRlIHBvc2l0aW9uKDAsIG51bGwsIG51bGwsIDApO1xuICBAaW5jbHVkZSBtYXJnaW4oMCk7XG5cbiAgcG9zaXRpb246IGFic29sdXRlO1xuXG4gIHdpZHRoOiAxMDAlO1xuICBoZWlnaHQ6IDEwMCU7XG5cbiAgYm9yZGVyOiAwO1xuICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDtcbiAgY3Vyc29yOiBwb2ludGVyO1xuXG4gIGFwcGVhcmFuY2U6IG5vbmU7XG4gIG91dGxpbmU6IG5vbmU7XG5cbiAgJjo6LW1vei1mb2N1cy1pbm5lciB7XG4gICAgYm9yZGVyOiAwO1xuICB9XG59XG5cbkBtaXhpbiB2aXN1YWxseS1oaWRkZW4oKSB7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcblxuICB0b3A6IDA7XG4gIGxlZnQ6IDA7XG4gIHJpZ2h0OiAwO1xuICBib3R0b206IDA7XG5cbiAgd2lkdGg6IDEwMCU7XG4gIGhlaWdodDogMTAwJTtcblxuICBtYXJnaW46IDA7XG4gIHBhZGRpbmc6IDA7XG5cbiAgYm9yZGVyOiAwO1xuICBvdXRsaW5lOiAwO1xuICBjbGlwOiByZWN0KDAgMCAwIDApO1xuXG4gIG9wYWNpdHk6IDA7XG4gIG92ZXJmbG93OiBoaWRkZW47XG5cbiAgLXdlYmtpdC1hcHBlYXJhbmNlOiBub25lO1xuICAtbW96LWFwcGVhcmFuY2U6IG5vbmU7XG59XG5cbkBtaXhpbiB0ZXh0LWluaGVyaXQoKSB7XG4gIGZvbnQtZmFtaWx5OiBpbmhlcml0O1xuICBmb250LXNpemU6IGluaGVyaXQ7XG4gIGZvbnQtc3R5bGU6IGluaGVyaXQ7XG4gIGZvbnQtd2VpZ2h0OiBpbmhlcml0O1xuICBsZXR0ZXItc3BhY2luZzogaW5oZXJpdDtcbiAgdGV4dC1kZWNvcmF0aW9uOiBpbmhlcml0O1xuICB0ZXh0LWluZGVudDogaW5oZXJpdDtcbiAgdGV4dC1vdmVyZmxvdzogaW5oZXJpdDtcbiAgdGV4dC10cmFuc2Zvcm06IGluaGVyaXQ7XG4gIHRleHQtYWxpZ246IGluaGVyaXQ7XG4gIHdoaXRlLXNwYWNlOiBpbmhlcml0O1xuICBjb2xvcjogaW5oZXJpdDtcbn1cblxuQG1peGluIGJ1dHRvbi1zdGF0ZSgpIHtcbiAgQGluY2x1ZGUgcG9zaXRpb24oMCwgMCwgMCwgMCk7XG5cbiAgcG9zaXRpb246IGFic29sdXRlO1xuXG4gIGNvbnRlbnQ6IFwiXCI7XG5cbiAgb3BhY2l0eTogMDtcbn1cblxuLy8gRm9udCBzbW9vdGhpbmdcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbkBtaXhpbiBmb250LXNtb290aGluZygpIHtcbiAgLW1vei1vc3gtZm9udC1zbW9vdGhpbmc6IGdyYXlzY2FsZTtcbiAgLXdlYmtpdC1mb250LXNtb290aGluZzogYW50aWFsaWFzZWQ7XG59XG5cbi8vIEdldCB0aGUga2V5IGZyb20gYSBtYXAgYmFzZWQgb24gdGhlIGluZGV4XG5AZnVuY3Rpb24gaW5kZXgtdG8ta2V5KCRtYXAsICRpbmRleCkge1xuICAka2V5czogbWFwLWtleXMoJG1hcCk7XG5cbiAgQHJldHVybiBudGgoJGtleXMsICRpbmRleCk7XG59XG5cblxuLy8gQnJlYWtwb2ludCBNaXhpbnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4vLyBCcmVha3BvaW50IHZpZXdwb3J0IHNpemVzIGFuZCBtZWRpYSBxdWVyaWVzLlxuLy9cbi8vIEJyZWFrcG9pbnRzIGFyZSBkZWZpbmVkIGFzIGEgbWFwIG9mIChuYW1lOiBtaW5pbXVtIHdpZHRoKSwgb3JkZXIgZnJvbSBzbWFsbCB0byBsYXJnZTpcbi8vXG4vLyAgICAoeHM6IDAsIHNtOiA1NzZweCwgbWQ6IDc2OHB4LCBsZzogOTkycHgsIHhsOiAxMjAwcHgpXG4vL1xuLy8gVGhlIG1hcCBkZWZpbmVkIGluIHRoZSBgJHNjcmVlbi1icmVha3BvaW50c2AgZ2xvYmFsIHZhcmlhYmxlIGlzIHVzZWQgYXMgdGhlIGAkYnJlYWtwb2ludHNgIGFyZ3VtZW50IGJ5IGRlZmF1bHQuXG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4vLyBNaW5pbXVtIGJyZWFrcG9pbnQgd2lkdGguIE51bGwgZm9yIHRoZSBzbWFsbGVzdCAoZmlyc3QpIGJyZWFrcG9pbnQuXG4vL1xuLy8gICAgPj4gYnJlYWtwb2ludC1taW4oc20sICh4czogMCwgc206IDU3NnB4LCBtZDogNzY4cHgsIGxnOiA5OTJweCwgeGw6IDEyMDBweCkpXG4vLyAgICA1NzZweFxuQGZ1bmN0aW9uIGJyZWFrcG9pbnQtbWluKCRuYW1lLCAkYnJlYWtwb2ludHM6ICRzY3JlZW4tYnJlYWtwb2ludHMpIHtcbiAgJG1pbjogbWFwLWdldCgkYnJlYWtwb2ludHMsICRuYW1lKTtcblxuICBAcmV0dXJuIGlmKCRuYW1lICE9IGluZGV4LXRvLWtleSgkYnJlYWtwb2ludHMsIDEpLCAkbWluLCBudWxsKTtcbn1cblxuLy8gUmV0dXJucyBhIGJsYW5rIHN0cmluZyBpZiBzbWFsbGVzdCBicmVha3BvaW50LCBvdGhlcndpc2UgcmV0dXJucyB0aGUgbmFtZSB3aXRoIGEgZGFzaCBpbmZyb250LlxuLy8gVXNlZnVsIGZvciBtYWtpbmcgcmVzcG9uc2l2ZSB1dGlsaXRpZXMuXG4vL1xuLy8gICAgPj4gYnJlYWtwb2ludC1pbmZpeCh4cywgKHhzOiAwLCBzbTogNTc2cHgsIG1kOiA3NjhweCwgbGc6IDk5MnB4LCB4bDogMTIwMHB4KSlcbi8vICAgIFwiXCIgIChSZXR1cm5zIGEgYmxhbmsgc3RyaW5nKVxuLy8gICAgPj4gYnJlYWtwb2ludC1pbmZpeChzbSwgKHhzOiAwLCBzbTogNTc2cHgsIG1kOiA3NjhweCwgbGc6IDk5MnB4LCB4bDogMTIwMHB4KSlcbi8vICAgIFwiLXNtXCJcbkBmdW5jdGlvbiBicmVha3BvaW50LWluZml4KCRuYW1lLCAkYnJlYWtwb2ludHM6ICRzY3JlZW4tYnJlYWtwb2ludHMpIHtcbiAgQHJldHVybiBpZihicmVha3BvaW50LW1pbigkbmFtZSwgJGJyZWFrcG9pbnRzKSA9PSBudWxsLCBcIlwiLCBcIi0jeyRuYW1lfVwiKTtcbn1cblxuLy8gTWVkaWEgb2YgYXQgbGVhc3QgdGhlIG1pbmltdW0gYnJlYWtwb2ludCB3aWR0aC4gTm8gcXVlcnkgZm9yIHRoZSBzbWFsbGVzdCBicmVha3BvaW50LlxuLy8gTWFrZXMgdGhlIEBjb250ZW50IGFwcGx5IHRvIHRoZSBnaXZlbiBicmVha3BvaW50IGFuZCB3aWRlci5cbkBtaXhpbiBtZWRpYS1icmVha3BvaW50LXVwKCRuYW1lLCAkYnJlYWtwb2ludHM6ICRzY3JlZW4tYnJlYWtwb2ludHMpIHtcbiAgJG1pbjogYnJlYWtwb2ludC1taW4oJG5hbWUsICRicmVha3BvaW50cyk7XG4gIEBpZiAkbWluIHtcbiAgICBAbWVkaWEgKG1pbi13aWR0aDogJG1pbikge1xuICAgICAgQGNvbnRlbnQ7XG4gICAgfVxuICB9IEBlbHNlIHtcbiAgICBAY29udGVudDtcbiAgfVxufVxuXG4vLyBOYW1lIG9mIHRoZSBuZXh0IGJyZWFrcG9pbnQsIG9yIG51bGwgZm9yIHRoZSBsYXN0IGJyZWFrcG9pbnQuXG4vL1xuLy8gICAgPj4gYnJlYWtwb2ludC1uZXh0KHNtKVxuLy8gICAgbWRcbi8vICAgID4+IGJyZWFrcG9pbnQtbmV4dChzbSwgKHhzOiAwLCBzbTogNTc2cHgsIG1kOiA3NjhweCwgbGc6IDk5MnB4LCB4bDogMTIwMHB4KSlcbi8vICAgIG1kXG4vLyAgICA+PiBicmVha3BvaW50LW5leHQoc20sICRicmVha3BvaW50LW5hbWVzOiAoeHMgc20gbWQgbGcgeGwpKVxuLy8gICAgbWRcbkBmdW5jdGlvbiBicmVha3BvaW50LW5leHQoJG5hbWUsICRicmVha3BvaW50czogJHNjcmVlbi1icmVha3BvaW50cywgJGJyZWFrcG9pbnQtbmFtZXM6IG1hcC1rZXlzKCRicmVha3BvaW50cykpIHtcbiAgJG46IGluZGV4KCRicmVha3BvaW50LW5hbWVzLCAkbmFtZSk7XG4gIEByZXR1cm4gaWYoJG4gPCBsZW5ndGgoJGJyZWFrcG9pbnQtbmFtZXMpLCBudGgoJGJyZWFrcG9pbnQtbmFtZXMsICRuICsgMSksIG51bGwpO1xufVxuXG4vLyBNYXhpbXVtIGJyZWFrcG9pbnQgd2lkdGguIE51bGwgZm9yIHRoZSBzbWFsbGVzdCAoZmlyc3QpIGJyZWFrcG9pbnQuXG4vLyBUaGUgbWF4aW11bSB2YWx1ZSBpcyByZWR1Y2VkIGJ5IDAuMDJweCB0byB3b3JrIGFyb3VuZCB0aGUgbGltaXRhdGlvbnMgb2Zcbi8vIGBtaW4tYCBhbmQgYG1heC1gIHByZWZpeGVzIGFuZCB2aWV3cG9ydHMgd2l0aCBmcmFjdGlvbmFsIHdpZHRocy5cbi8vXG4vLyBTZWUgaHR0cHM6Ly93d3cudzMub3JnL1RSL21lZGlhcXVlcmllcy00LyNtcS1taW4tbWF4XG4vLyBVc2VzIDAuMDJweCByYXRoZXIgdGhhbiAwLjAxcHggdG8gd29yayBhcm91bmQgYSBjdXJyZW50IHJvdW5kaW5nIGJ1ZyBpbiBTYWZhcmkuXHQvLyBVc2VzIDAuMDJweCByYXRoZXIgdGhhbiAwLjAxcHggdG8gd29yayBhcm91bmQgYSBjdXJyZW50IHJvdW5kaW5nIGJ1ZyBpbiBTYWZhcmkuXG4vLyBTZWUgaHR0cHM6Ly9idWdzLndlYmtpdC5vcmcvc2hvd19idWcuY2dpP2lkPTE3ODI2MVx0Ly8gU2VlIGh0dHBzOi8vYnVncy53ZWJraXQub3JnL3Nob3dfYnVnLmNnaT9pZD0xNzgyNjFcbi8vXG4vLyAgICA+PiBicmVha3BvaW50LW1heChtZCwgKHhzOiAwLCBzbTogNTc2cHgsIG1kOiA3NjhweCwgbGc6IDk5MnB4LCB4bDogMTIwMHB4KSlcbi8vICAgIDc2Ny45OHB4XG5AZnVuY3Rpb24gYnJlYWtwb2ludC1tYXgoJG5hbWUsICRicmVha3BvaW50czogJHNjcmVlbi1icmVha3BvaW50cykge1xuICAkbWF4OiBtYXAtZ2V0KCRicmVha3BvaW50cywgJG5hbWUpO1xuICBAcmV0dXJuIGlmKCRtYXggYW5kICRtYXggPiAwLCAkbWF4IC0gLjAyLCBudWxsKTtcbn1cblxuLy8gTWVkaWEgb2YgYXQgbW9zdCB0aGUgbWF4aW11bSBicmVha3BvaW50IHdpZHRoLiBObyBxdWVyeSBmb3IgdGhlIGxhcmdlc3QgYnJlYWtwb2ludC5cbi8vIE1ha2VzIHRoZSBAY29udGVudCBhcHBseSB0byB0aGUgZ2l2ZW4gYnJlYWtwb2ludCBhbmQgbmFycm93ZXIuXG5AbWl4aW4gbWVkaWEtYnJlYWtwb2ludC1kb3duKCRuYW1lLCAkYnJlYWtwb2ludHM6ICRzY3JlZW4tYnJlYWtwb2ludHMpIHtcbiAgJG1heDogYnJlYWtwb2ludC1tYXgoJG5hbWUsICRicmVha3BvaW50cyk7XG4gIEBpZiAkbWF4IHtcbiAgICBAbWVkaWEgKG1heC13aWR0aDogJG1heCkge1xuICAgICAgQGNvbnRlbnQ7XG4gICAgfVxuICB9IEBlbHNlIHtcbiAgICBAY29udGVudDtcbiAgfVxufVxuXG5cbi8vIFRleHQgRGlyZWN0aW9uIC0gbHRyIC8gcnRsXG4vL1xuLy8gQ1NTIGRlZmF1bHRzIHRvIHVzZSB0aGUgbHRyIGNzcywgYW5kIGFkZHMgW2Rpcj1ydGxdIHNlbGVjdG9yc1xuLy8gdG8gb3ZlcnJpZGUgbHRyIGRlZmF1bHRzLlxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5AbWl4aW4gbXVsdGktZGlyKCkge1xuICBAY29udGVudDtcblxuICAvLyAkcm9vdDogI3smfTtcbiAgLy8gQGF0LXJvb3QgW2Rpcl0ge1xuICAvLyAgICN7JHJvb3R9IHtcbiAgLy8gICAgIEBjb250ZW50O1xuICAvLyAgIH1cbiAgLy8gfVxufVxuXG5AbWl4aW4gcnRsKCkge1xuICAkcm9vdDogI3smfTtcblxuICAkcm9vdFNwbGl0OiBzdHItc3BsaXQoJHJvb3QsIFwiLFwiKTtcbiAgJHNlbGVjdG9yczogI3thZGQtcm9vdC1zZWxlY3Rvcigkcm9vdCwgXCJbZGlyPXJ0bF1cIil9O1xuICAkc2VsZWN0b3JzU3BsaXQ6IHN0ci1zcGxpdCgkc2VsZWN0b3JzLCBcIixcIik7XG5cbiAgJGhvc3RDb250ZXh0U2VsZWN0b3JzOiAoKTtcbiAgJHJlc3RTZWxlY3RvcnM6ICgpO1xuICAkZGlyU2VsZWN0b3JzOiAoKTtcblxuICAvLyBTZWxlY3RvcnMgbXVzdCBiZSBzcGxpdCBpbnRvIGluZGl2aWR1YWwgc2VsZWN0b3JzIGluIGNhc2UgdGhlIGJyb3dzZXJcbiAgLy8gZG9lc24ndCBzdXBwb3J0IGEgc3BlY2lmaWMgc2VsZWN0b3IuXG4gIC8vIEZvciBleGFtcGxlLCBGaXJlZm94IGFuZCBTYWZhcmkgZG9lc24ndCBzdXBwb3J0IGA6aG9zdC1jb250ZXh0KClgLlxuICAvLyBJZiBhbiBpbnZhbGlkIHNlbGVjdG9yIGlzIHVzZWQsIHRoZW4gdGhlIGVudGlyZSBncm91cCBvZiBzZWxlY3RvcnNcbiAgLy8gd2lsbCBiZSBpZ25vcmVkLlxuICAvLyBAbGluayBodHRwczovL3d3dy53My5vcmcvVFIvc2VsZWN0b3JzLTMvI2dyb3VwaW5nXG4gIEBlYWNoICRzZWxlY3RvciBpbiAkc2VsZWN0b3JzU3BsaXQge1xuICAgIC8vIEdyb3VwIHRoZSBzZWxlY3RvcnMgYmFjayBpbnRvIGEgc2luZ2xlIHNlbGVjdG9yIHRvIG9wdGltaXplIHRoZSBvdXRwdXQuXG4gICAgQGlmIHN0ci1pbmRleCgkc2VsZWN0b3IsIFwiOmhvc3QtY29udGV4dFwiKSB7XG4gICAgICAkaG9zdENvbnRleHRTZWxlY3RvcnM6IGFwcGVuZCgkaG9zdENvbnRleHRTZWxlY3RvcnMsICRzZWxlY3RvciwgY29tbWEpO1xuICAgIH0gQGVsc2Uge1xuICAgICAgLy8gR3JvdXAgdGhlIHNlbGVjdG9ycyBiYWNrIGludG8gYSBzaW5nbGUgc2VsZWN0b3IgdG8gb3B0aW1pemUgdGhlIG91dHB1dC5cbiAgICAgICRyZXN0U2VsZWN0b3JzOiBhcHBlbmQoJHJlc3RTZWxlY3RvcnMsICRzZWxlY3RvciwgY29tbWEpO1xuICAgIH1cbiAgfVxuXG4gIC8vIFN1cHBvcnRlZCBieSBDaHJvbWUuXG4gIEBpZiBsZW5ndGgoJGhvc3RDb250ZXh0U2VsZWN0b3JzKSA+IDAge1xuICAgIEBhdC1yb290ICN7JGhvc3RDb250ZXh0U2VsZWN0b3JzfSB7XG4gICAgICBAY29udGVudDtcbiAgICB9XG4gIH1cblxuICAvLyBTdXBwb3J0ZWQgYnkgYWxsIGJyb3dzZXJzLlxuICBAaWYgbGVuZ3RoKCRyZXN0U2VsZWN0b3JzKSA+IDAge1xuICAgIEBhdC1yb290ICN7JHJlc3RTZWxlY3RvcnN9IHtcbiAgICAgIEBjb250ZW50O1xuICAgIH1cbiAgfVxuXG4gIC8vIElmIGJyb3dzZXIgY2FuIHN1cHBvcnQgYDpkaXIoKWAsIHRoZW4gYWRkIHRoZSBgOmRpcigpYCBzZWxlY3RvcnMuXG4gIC8vIEBzdXBwb3J0cyBzZWxlY3Rvcig6ZGlyKHJ0bCkpIHsgLy8gQCBJTVBPVEFOVCBOT1RFOiBUaGlzIGhhcyBiZWVuIHJlbW92ZWQgYmVjYXVzZSBzZWxlY3RvciBmdW5jdGlvbiBpcyBub3Qgc3VwcG9ydGVkIGluIGN1cnJlbnQgU0NTU1xuICAvLyBBZGRpbmcgOmRpcigpIGluIGNhc2UgdGhlIGJyb3dzZXIgZG9lc24ndCBzdXBwb3J0IGA6aG9zdC1jb250ZXh0KClgIGFuZCBkb2VzIHN1cHBvcnQgYDpkaXIoKWAuXG4gIC8vIGA6aG9zdC1jb250ZXh0KClgIGlzIGFkZGVkOlxuICAvLyAtIHRocm91Z2ggdGhlIGBhZGQtcm9vdC1zZWxlY3RvcigpYCBmdW5jdGlvbi5cbiAgLy8gLSBmaXJzdCBzbyB0aGF0IGl0IHRha2VzIHByZWNlZGVuY2Ugb3ZlciBgOmRpcigpYC5cbiAgLy8gRm9yIGV4YW1wbGUsXG4gIC8vIC0gRmlyZWZveCBkb2Vzbid0IHN1cHBvcnQgYDpob3N0LWNvbnRleHQoKWAsIGJ1dCBkb2VzIHN1cHBvcnQgYDpkaXIoKWAuXG4gIC8vIC0gU2FmYXJpIGRvZXNuJ3Qgc3VwcG9ydCBgOmhvc3QtY29udGV4dCgpYCwgYnV0IFNhZmFyaSAxNi40KyBzdXBwb3J0cyBgOmRpcigpYFxuICAvLyBAbGluayBodHRwczovL3dlYmtpdC5vcmcvYmxvZy8xMzk2Ni93ZWJraXQtZmVhdHVyZXMtaW4tc2FmYXJpLTE2LTQvXG4gIEBlYWNoICRzZWxlY3RvciBpbiAkcm9vdFNwbGl0IHtcbiAgICAkZGlyU2VsZWN0b3I6IFwiI3skc2VsZWN0b3J9OmRpcihydGwpXCI7XG4gICAgLy8gR3JvdXAgdGhlIHNlbGVjdG9ycyBiYWNrIGludG8gYSBzaW5nbGUgc2VsZWN0b3IgdG8gb3B0aW1pemUgdGhlIG91dHB1dC5cbiAgICAkZGlyU2VsZWN0b3JzOiBhcHBlbmQoJGRpclNlbGVjdG9ycywgJGRpclNlbGVjdG9yLCBjb21tYSk7XG4gIH1cblxuICAvLyBTdXBwb3J0ZWQgYnkgRmlyZWZveC5cbiAgQGlmIGxlbmd0aCgkZGlyU2VsZWN0b3JzKSA+IDAge1xuICAgIEBhdC1yb290ICN7JGRpclNlbGVjdG9yc30ge1xuICAgICAgQGNvbnRlbnQ7XG4gICAgfVxuICB9XG4gIC8vfVxufVxuXG5AbWl4aW4gbHRyKCkge1xuICBAY29udGVudDtcbn1cblxuXG4vLyBTVkcgQmFja2dyb3VuZCBJbWFnZSBNaXhpblxuLy8gQHBhcmFtIHtzdHJpbmd9ICRzdmdcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbkBtaXhpbiBzdmctYmFja2dyb3VuZC1pbWFnZSgkc3ZnLCAkZmxpcC1ydGw6IGZhbHNlKSB7XG4gICR1cmw6IHVybC1lbmNvZGUoJHN2Zyk7XG4gICR2aWV3Qm94OiBzdHItc3BsaXQoc3RyLWV4dHJhY3QoJHN2ZywgXCJ2aWV3Qm94PSdcIiwgXCInXCIpLCBcIiBcIik7XG5cbiAgQGlmICRmbGlwLXJ0bCAhPSB0cnVlIG9yICR2aWV3Qm94ID09IG51bGwge1xuICAgIEBpbmNsdWRlIG11bHRpLWRpcigpIHtcbiAgICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChcImRhdGE6aW1hZ2Uvc3ZnK3htbDtjaGFyc2V0PXV0Zi04LCN7JHVybH1cIik7XG4gICAgfVxuICB9IEBlbHNlIHtcbiAgICAkdHJhbnNmb3JtOiBcInRyYW5zZm9ybT0ndHJhbnNsYXRlKCN7bnRoKCR2aWV3Qm94LCAzKX0sIDApIHNjYWxlKC0xLCAxKSdcIjtcbiAgICAkZmxpcHBlZC11cmw6ICRzdmc7XG4gICAgJGZsaXBwZWQtdXJsOiBzdHItcmVwbGFjZSgkZmxpcHBlZC11cmwsIFwiPHBhdGhcIiwgXCI8cGF0aCAjeyR0cmFuc2Zvcm19XCIpO1xuICAgICRmbGlwcGVkLXVybDogc3RyLXJlcGxhY2UoJGZsaXBwZWQtdXJsLCBcIjxsaW5lXCIsIFwiPGxpbmUgI3skdHJhbnNmb3JtfVwiKTtcbiAgICAkZmxpcHBlZC11cmw6IHN0ci1yZXBsYWNlKCRmbGlwcGVkLXVybCwgXCI8cG9seWdvblwiLCBcIjxwb2x5Z29uICN7JHRyYW5zZm9ybX1cIik7XG4gICAgJGZsaXBwZWQtdXJsOiB1cmwtZW5jb2RlKCRmbGlwcGVkLXVybCk7XG5cbiAgICBAaW5jbHVkZSBsdHIgKCkge1xuICAgICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKFwiZGF0YTppbWFnZS9zdmcreG1sO2NoYXJzZXQ9dXRmLTgsI3skdXJsfVwiKTtcbiAgICB9XG4gICAgQGluY2x1ZGUgcnRsKCkge1xuICAgICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKFwiZGF0YTppbWFnZS9zdmcreG1sO2NoYXJzZXQ9dXRmLTgsI3skZmxpcHBlZC11cmx9XCIpO1xuICAgIH1cbiAgfVxufVxuXG4vLyBBZGQgcHJvcGVydHkgaG9yaXpvbnRhbFxuLy8gQHBhcmFtIHtzdHJpbmd9ICRzdGFydFxuLy8gQHBhcmFtIHtzdHJpbmd9ICRlbmRcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbkBtaXhpbiBwcm9wZXJ0eS1ob3Jpem9udGFsKCRwcm9wLCAkc3RhcnQsICRlbmQ6ICRzdGFydCkge1xuICBAaWYgJHN0YXJ0ID09IDAgYW5kICRlbmQgPT0gMCB7XG4gICAgI3skcHJvcH0tbGVmdDogJHN0YXJ0O1xuICAgICN7JHByb3B9LXJpZ2h0OiAkZW5kO1xuXG4gIH0gQGVsc2Uge1xuICAgIC13ZWJraXQtI3skcHJvcH0tc3RhcnQ6ICRzdGFydDtcbiAgICAjeyRwcm9wfS1pbmxpbmUtc3RhcnQ6ICRzdGFydDtcbiAgICAtd2Via2l0LSN7JHByb3B9LWVuZDogJGVuZDtcbiAgICAjeyRwcm9wfS1pbmxpbmUtZW5kOiAkZW5kO1xuICB9XG59XG5cbi8vIEFkZCBwcm9wZXJ0eSBmb3IgYWxsIGRpcmVjdGlvbnNcbi8vIEBwYXJhbSB7c3RyaW5nfSAkcHJvcFxuLy8gQHBhcmFtIHtzdHJpbmd9ICR0b3Bcbi8vIEBwYXJhbSB7c3RyaW5nfSAkZW5kXG4vLyBAcGFyYW0ge3N0cmluZ30gJGJvdHRvbVxuLy8gQHBhcmFtIHtzdHJpbmd9ICRzdGFydFxuLy8gQHBhcmFtIHtib29sZWFufSAkY29udGVudCBpbmNsdWRlIGNvbnRlbnQgb3IgdXNlIGRlZmF1bHRcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbkBtaXhpbiBwcm9wZXJ0eSgkcHJvcCwgJHRvcCwgJGVuZDogJHRvcCwgJGJvdHRvbTogJHRvcCwgJHN0YXJ0OiAkZW5kKSB7XG4gIEBpbmNsdWRlIHByb3BlcnR5LWhvcml6b250YWwoJHByb3AsICRzdGFydCwgJGVuZCk7XG4gICN7JHByb3B9LXRvcDogJHRvcDtcbiAgI3skcHJvcH0tYm90dG9tOiAkYm90dG9tO1xufVxuXG4vLyBBZGQgcGFkZGluZyBob3Jpem9udGFsXG4vLyBAcGFyYW0ge3N0cmluZ30gJHN0YXJ0XG4vLyBAcGFyYW0ge3N0cmluZ30gJGVuZFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQG1peGluIHBhZGRpbmctaG9yaXpvbnRhbCgkc3RhcnQsICRlbmQ6ICRzdGFydCkge1xuICBAaW5jbHVkZSBwcm9wZXJ0eS1ob3Jpem9udGFsKHBhZGRpbmcsICRzdGFydCwgJGVuZCk7XG59XG5cbi8vIEFkZCBwYWRkaW5nIGZvciBhbGwgZGlyZWN0aW9uc1xuLy8gQHBhcmFtIHtzdHJpbmd9ICR0b3Bcbi8vIEBwYXJhbSB7c3RyaW5nfSAkZW5kXG4vLyBAcGFyYW0ge3N0cmluZ30gJGJvdHRvbVxuLy8gQHBhcmFtIHtzdHJpbmd9ICRzdGFydFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQG1peGluIHBhZGRpbmcoJHRvcCwgJGVuZDogJHRvcCwgJGJvdHRvbTogJHRvcCwgJHN0YXJ0OiAkZW5kKSB7XG4gIEBpbmNsdWRlIHByb3BlcnR5KHBhZGRpbmcsICR0b3AsICRlbmQsICRib3R0b20sICRzdGFydCk7XG59XG5cbi8vIEFkZCBtYXJnaW4gaG9yaXpvbnRhbFxuLy8gQHBhcmFtIHtzdHJpbmd9ICRzdGFydFxuLy8gQHBhcmFtIHtzdHJpbmd9ICRlbmRcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbkBtaXhpbiBtYXJnaW4taG9yaXpvbnRhbCgkc3RhcnQsICRlbmQ6ICRzdGFydCkge1xuICBAaW5jbHVkZSBwcm9wZXJ0eS1ob3Jpem9udGFsKG1hcmdpbiwgJHN0YXJ0LCAkZW5kKTtcbn1cblxuLy8gQWRkIG1hcmdpbiBmb3IgYWxsIGRpcmVjdGlvbnNcbi8vIEBwYXJhbSB7c3RyaW5nfSAkdG9wXG4vLyBAcGFyYW0ge3N0cmluZ30gJGVuZFxuLy8gQHBhcmFtIHtzdHJpbmd9ICRib3R0b21cbi8vIEBwYXJhbSB7c3RyaW5nfSAkc3RhcnRcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbkBtaXhpbiBtYXJnaW4oJHRvcCwgJGVuZDogJHRvcCwgJGJvdHRvbTogJHRvcCwgJHN0YXJ0OiAkZW5kKSB7XG4gIEBpbmNsdWRlIHByb3BlcnR5KG1hcmdpbiwgJHRvcCwgJGVuZCwgJGJvdHRvbSwgJHN0YXJ0KTtcbn1cblxuLy8gQWRkIHBvc2l0aW9uIGhvcml6b250YWxcbi8vIEBwYXJhbSB7c3RyaW5nfSAkc3RhcnQgLSBhbW91bnQgdG8gcG9zaXRpb24gc3RhcnRcbi8vIEBwYXJhbSB7c3RyaW5nfSAkZW5kIC0gYW1vdW50IHRvIGxlZnQ6IDA7IGVuZFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQG1peGluIHBvc2l0aW9uLWhvcml6b250YWwoJHN0YXJ0OiBudWxsLCAkZW5kOiBudWxsKSB7XG4gIEBpZiAkc3RhcnQgPT0gJGVuZCB7XG4gICAgQGluY2x1ZGUgbXVsdGktZGlyKCkge1xuICAgICAgbGVmdDogJHN0YXJ0O1xuICAgICAgcmlnaHQ6ICRlbmQ7XG4gICAgfVxuICB9IEBlbHNlIHtcbiAgICBAYXQtcm9vdCB7XG4gICAgICBAc3VwcG9ydHMgKGluc2V0LWlubGluZS1zdGFydDogMCkge1xuICAgICAgICAmIHtcbiAgICAgICAgICBpbnNldC1pbmxpbmUtc3RhcnQ6ICRzdGFydDtcbiAgICAgICAgICBpbnNldC1pbmxpbmUtZW5kOiAkZW5kO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gVE9ETyBGVy0zNzY2XG4gICAgQGF0LXJvb3Qge1xuICAgICAgQHN1cHBvcnRzIG5vdCAoaW5zZXQtaW5saW5lLXN0YXJ0OiAwKSB7XG4gICAgICAgICYge1xuICAgICAgICAgIEBpbmNsdWRlIGx0cigpIHtcbiAgICAgICAgICAgIGxlZnQ6ICRzdGFydDtcbiAgICAgICAgICAgIHJpZ2h0OiAkZW5kO1xuICAgICAgICAgIH1cbiAgICAgICAgICBAaW5jbHVkZSBydGwoKSB7XG4gICAgICAgICAgICBsZWZ0OiB1bnNldDtcbiAgICAgICAgICAgIHJpZ2h0OiB1bnNldDtcblxuICAgICAgICAgICAgbGVmdDogJGVuZDtcbiAgICAgICAgICAgIHJpZ2h0OiAkc3RhcnQ7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG59XG5cbi8vIEFkZCBwb3NpdGlvbiBmb3IgYWxsIGRpcmVjdGlvbnNcbi8vIEBwYXJhbSB7c3RyaW5nfSAkdG9wXG4vLyBAcGFyYW0ge3N0cmluZ30gJGVuZFxuLy8gQHBhcmFtIHtzdHJpbmd9ICRib3R0b21cbi8vIEBwYXJhbSB7c3RyaW5nfSAkc3RhcnRcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbkBtaXhpbiBwb3NpdGlvbigkdG9wOiBudWxsLCAkZW5kOiBudWxsLCAkYm90dG9tOiBudWxsLCAkc3RhcnQ6IG51bGwpIHtcbiAgQGluY2x1ZGUgcG9zaXRpb24taG9yaXpvbnRhbCgkc3RhcnQsICRlbmQpO1xuICB0b3A6ICR0b3A7XG4gIGJvdHRvbTogJGJvdHRvbTtcbn1cblxuLy8gQWRkIGJvcmRlciBmb3IgYWxsIGRpcmVjdGlvbnNcbi8vIEBwYXJhbSB7c3RyaW5nfSAkdG9wXG4vLyBAcGFyYW0ge3N0cmluZ30gJGVuZFxuLy8gQHBhcmFtIHtzdHJpbmd9ICRib3R0b21cbi8vIEBwYXJhbSB7c3RyaW5nfSAkc3RhcnRcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbkBtaXhpbiBib3JkZXIoJHRvcCwgJGVuZDogJHRvcCwgJGJvdHRvbTogJHRvcCwgJHN0YXJ0OiAkZW5kKSB7XG4gIEBpbmNsdWRlIHByb3BlcnR5KGJvcmRlciwgJHRvcCwgJGVuZCwgJGJvdHRvbSwgJHN0YXJ0KTtcbn1cblxuLy8gQWRkIGJvcmRlciByYWRpdXMgZm9yIGFsbCBkaXJlY3Rpb25zXG4vLyBAcGFyYW0ge3N0cmluZ30gJHRvcC1zdGFydFxuLy8gQHBhcmFtIHtzdHJpbmd9ICR0b3AtZW5kXG4vLyBAcGFyYW0ge3N0cmluZ30gJGJvdHRvbS1lbmRcbi8vIEBwYXJhbSB7c3RyaW5nfSAkYm90dG9tLXN0YXJ0XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5AbWl4aW4gYm9yZGVyLXJhZGl1cygkdG9wLXN0YXJ0LCAkdG9wLWVuZDogJHRvcC1zdGFydCwgJGJvdHRvbS1lbmQ6ICR0b3Atc3RhcnQsICRib3R0b20tc3RhcnQ6ICR0b3AtZW5kKSB7XG4gIEBpZiAkdG9wLXN0YXJ0ID09ICR0b3AtZW5kIGFuZCAkdG9wLXN0YXJ0ID09ICRib3R0b20tZW5kIGFuZCAkdG9wLXN0YXJ0ID09ICRib3R0b20tc3RhcnQge1xuICAgIEBpbmNsdWRlIG11bHRpLWRpcigpIHtcbiAgICAgIGJvcmRlci1yYWRpdXM6ICR0b3Atc3RhcnQ7XG4gICAgfVxuICB9IEBlbHNlIHtcbiAgICBAaW5jbHVkZSBsdHIoKSB7XG4gICAgICBib3JkZXItdG9wLWxlZnQtcmFkaXVzOiAkdG9wLXN0YXJ0O1xuICAgICAgYm9yZGVyLXRvcC1yaWdodC1yYWRpdXM6ICR0b3AtZW5kO1xuICAgICAgYm9yZGVyLWJvdHRvbS1yaWdodC1yYWRpdXM6ICRib3R0b20tZW5kO1xuICAgICAgYm9yZGVyLWJvdHRvbS1sZWZ0LXJhZGl1czogJGJvdHRvbS1zdGFydDtcbiAgICB9XG5cbiAgICBAaW5jbHVkZSBydGwoKSB7XG4gICAgICBib3JkZXItdG9wLWxlZnQtcmFkaXVzOiAkdG9wLWVuZDtcbiAgICAgIGJvcmRlci10b3AtcmlnaHQtcmFkaXVzOiAkdG9wLXN0YXJ0O1xuICAgICAgYm9yZGVyLWJvdHRvbS1yaWdodC1yYWRpdXM6ICRib3R0b20tc3RhcnQ7XG4gICAgICBib3JkZXItYm90dG9tLWxlZnQtcmFkaXVzOiAkYm90dG9tLWVuZDtcbiAgICB9XG4gIH1cbn1cblxuLy8gQWRkIGRpcmVjdGlvbiBmb3IgYWxsIGRpcmVjdGlvbnNcbi8vIEBwYXJhbSB7c3RyaW5nfSAkZGlyIC0gRGlyZWN0aW9uIG9uIExUUlxuQG1peGluIGRpcmVjdGlvbigkZGlyKSB7XG4gICRvdGhlci1kaXI6IG51bGw7XG5cbiAgQGlmICRkaXIgPT0gbHRyIHtcbiAgICAkb3RoZXItZGlyOiBydGw7XG4gIH0gQGVsc2Uge1xuICAgICRvdGhlci1kaXI6IGx0cjtcbiAgfVxuXG4gIEBpbmNsdWRlIGx0cigpIHtcbiAgICBkaXJlY3Rpb246ICRkaXI7XG4gIH1cbiAgQGluY2x1ZGUgcnRsKCkge1xuICAgIGRpcmVjdGlvbjogJG90aGVyLWRpcjtcbiAgfVxufVxuXG4vLyBBZGQgZmxvYXQgZm9yIGFsbCBkaXJlY3Rpb25zXG4vLyBAcGFyYW0ge3N0cmluZ30gJHNpZGVcbi8vIEBwYXJhbSB7c3RyaW5nfSAkZGVjb3JhdG9yIC0gIWltcG9ydGFudFxuQG1peGluIGZsb2F0KCRzaWRlLCAkZGVjb3JhdG9yOiBudWxsKSB7XG4gIEBpZiAkc2lkZSA9PSBzdGFydCB7XG4gICAgQGluY2x1ZGUgbHRyKCkge1xuICAgICAgZmxvYXQ6IGxlZnQgJGRlY29yYXRvcjtcbiAgICB9XG4gICAgQGluY2x1ZGUgcnRsKCkge1xuICAgICAgZmxvYXQ6IHJpZ2h0ICRkZWNvcmF0b3I7XG4gICAgfVxuICB9IEBlbHNlIGlmICRzaWRlID09IGVuZCB7XG4gICAgQGluY2x1ZGUgbHRyKCkge1xuICAgICAgZmxvYXQ6IHJpZ2h0ICRkZWNvcmF0b3I7XG4gICAgfVxuICAgIEBpbmNsdWRlIHJ0bCgpIHtcbiAgICAgIGZsb2F0OiBsZWZ0ICRkZWNvcmF0b3I7XG4gICAgfVxuICB9IEBlbHNlIHtcbiAgICBAaW5jbHVkZSBtdWx0aS1kaXIoKSB7XG4gICAgICBmbG9hdDogJHNpZGUgJGRlY29yYXRvcjtcbiAgICB9XG4gIH1cbn1cblxuQG1peGluIGJhY2tncm91bmQtcG9zaXRpb24oJGhvcml6b250YWwsICRob3Jpem9udGFsLWFtb3VudDogbnVsbCwgJHZlcnRpY2FsOiBudWxsLCAkdmVydGljYWwtYW1vdW50OiBudWxsKSB7XG4gIEBpZiAkaG9yaXpvbnRhbCA9PSBzdGFydCBvciAkaG9yaXpvbnRhbCA9PSBlbmQge1xuICAgICRob3Jpem9udGFsLWx0cjogbnVsbDtcbiAgICAkaG9yaXpvbnRhbC1ydGw6IG51bGw7XG4gICAgQGlmICRob3Jpem9udGFsID09IHN0YXJ0IHtcbiAgICAgICRob3Jpem9udGFsLWx0cjogbGVmdDtcbiAgICAgICRob3Jpem9udGFsLXJ0bDogcmlnaHQ7XG4gICAgfSBAZWxzZSB7XG4gICAgICAkaG9yaXpvbnRhbC1sdHI6IHJpZ2h0O1xuICAgICAgJGhvcml6b250YWwtcnRsOiBsZWZ0O1xuICAgIH1cblxuICAgIEBpbmNsdWRlIGx0cigpIHtcbiAgICAgIGJhY2tncm91bmQtcG9zaXRpb246ICRob3Jpem9udGFsLWx0ciAkaG9yaXpvbnRhbC1hbW91bnQgJHZlcnRpY2FsICR2ZXJ0aWNhbC1hbW91bnQ7XG4gICAgfVxuICAgIEBpbmNsdWRlIHJ0bCgpIHtcbiAgICAgIGJhY2tncm91bmQtcG9zaXRpb246ICRob3Jpem9udGFsLXJ0bCAkaG9yaXpvbnRhbC1hbW91bnQgJHZlcnRpY2FsICR2ZXJ0aWNhbC1hbW91bnQ7XG4gICAgfVxuICB9IEBlbHNlIHtcbiAgICBAaW5jbHVkZSBtdWx0aS1kaXIoKSB7XG4gICAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAkaG9yaXpvbnRhbCAkaG9yaXpvbnRhbC1hbW91bnQgJHZlcnRpY2FsICR2ZXJ0aWNhbC1hbW91bnQ7XG4gICAgfVxuICB9XG59XG5cbkBtaXhpbiB0cmFuc2Zvcm0tb3JpZ2luKCR4LWF4aXMsICR5LWF4aXM6IG51bGwpIHtcbiAgQGlmICR4LWF4aXMgPT0gc3RhcnQge1xuICAgIEBpbmNsdWRlIGx0cigpIHtcbiAgICAgIHRyYW5zZm9ybS1vcmlnaW46IGxlZnQgJHktYXhpcztcbiAgICB9XG4gICAgQGluY2x1ZGUgcnRsKCkge1xuICAgICAgdHJhbnNmb3JtLW9yaWdpbjogcmlnaHQgJHktYXhpcztcbiAgICB9XG4gIH0gQGVsc2UgaWYgJHgtYXhpcyA9PSBlbmQge1xuICAgIEBpbmNsdWRlIGx0cigpIHtcbiAgICAgIHRyYW5zZm9ybS1vcmlnaW46IHJpZ2h0ICR5LWF4aXM7XG4gICAgfVxuICAgIEBpbmNsdWRlIHJ0bCgpIHtcbiAgICAgIHRyYW5zZm9ybS1vcmlnaW46IGxlZnQgJHktYXhpcztcbiAgICB9XG4gIH0gQGVsc2UgaWYgJHgtYXhpcyA9PSBsZWZ0IG9yICR4LWF4aXMgPT0gcmlnaHQge1xuICAgIEBpbmNsdWRlIG11bHRpLWRpcigpIHtcbiAgICAgIHRyYW5zZm9ybS1vcmlnaW46ICR4LWF4aXMgJHktYXhpcztcbiAgICB9XG4gIH0gQGVsc2Uge1xuICAgIEBpbmNsdWRlIGx0cigpIHtcbiAgICAgIHRyYW5zZm9ybS1vcmlnaW46ICR4LWF4aXMgJHktYXhpcztcbiAgICB9XG4gICAgQGluY2x1ZGUgcnRsKCkge1xuICAgICAgdHJhbnNmb3JtLW9yaWdpbjogY2FsYygxMDAlIC0gI3skeC1heGlzfSkgJHktYXhpcztcbiAgICB9XG4gIH1cbn1cblxuLy8gQWRkIHRyYW5zZm9ybSBmb3IgYWxsIGRpcmVjdGlvbnNcbi8vIEBwYXJhbSB7c3RyaW5nfSAkdHJhbnNmb3JtcyAtIGNvbW1hIHNlcGFyYXRlZCBsaXN0IG9mIHRyYW5zZm9ybXNcbkBtaXhpbiB0cmFuc2Zvcm0oJHRyYW5zZm9ybXMuLi4pIHtcbiAgJGV4dHJhOiBudWxsO1xuXG4gICR4OiBudWxsO1xuICAkbHRyLXRyYW5zbGF0ZTogbnVsbDtcbiAgJHJ0bC10cmFuc2xhdGU6IG51bGw7XG5cbiAgQGVhY2ggJHRyYW5zZm9ybSBpbiAkdHJhbnNmb3JtcyB7XG4gICAgQGlmIChzdHItaW5kZXgoJHRyYW5zZm9ybSwgdHJhbnNsYXRlM2QpKSB7XG4gICAgICAkdHJhbnNmb3JtOiBzdHItcmVwbGFjZSgkdHJhbnNmb3JtLCAndHJhbnNsYXRlM2QoJyk7XG4gICAgICAkdHJhbnNmb3JtOiBzdHItcmVwbGFjZSgkdHJhbnNmb3JtLCAnKScpO1xuXG4gICAgICAkY29vcmRpbmF0ZXM6IHN0ci1zcGxpdCgkdHJhbnNmb3JtLCAnLCcpO1xuXG4gICAgICAkeDogbnRoKCRjb29yZGluYXRlcywgMSk7XG4gICAgICAkeTogbnRoKCRjb29yZGluYXRlcywgMik7XG4gICAgICAkejogbnRoKCRjb29yZGluYXRlcywgMyk7XG5cbiAgICAgICRsdHItdHJhbnNsYXRlOiB0cmFuc2xhdGUzZCgkeCwgJHksICR6KTtcbiAgICAgICRydGwtdHJhbnNsYXRlOiB0cmFuc2xhdGUzZChjYWxjKC0xICogI3skeH0pLCAkeSwgJHopO1xuICAgIH0gQGVsc2Uge1xuICAgICAgQGlmICRleHRyYSA9PSBudWxsIHtcbiAgICAgICAgJGV4dHJhOiAkdHJhbnNmb3JtO1xuICAgICAgfSBAZWxzZSB7XG4gICAgICAgICRleHRyYTogJGV4dHJhICR0cmFuc2Zvcm07XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgQGlmICR4ID09ICcwJyBvciAkeCA9PSBudWxsIHtcbiAgICBAaW5jbHVkZSBtdWx0aS1kaXIoKSB7XG4gICAgICB0cmFuc2Zvcm06ICRsdHItdHJhbnNsYXRlICRleHRyYTtcbiAgICB9XG4gIH0gQGVsc2Uge1xuICAgIEBpbmNsdWRlIGx0cigpIHtcbiAgICAgIHRyYW5zZm9ybTogJGx0ci10cmFuc2xhdGUgJGV4dHJhO1xuICAgIH1cblxuICAgIEBpbmNsdWRlIHJ0bCgpIHtcbiAgICAgIHRyYW5zZm9ybTogJHJ0bC10cmFuc2xhdGUgJGV4dHJhO1xuICAgIH1cbiAgfVxufVxuIiwiLyoqXG4gKiBJbXBvcnRlZCBpb25pYyBtaXhpbnMgZm9yIFNDU1MgZnJvbSBkaWZmZXJlbnQgY29tcG9uZW50c1xuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogRXh0cmFjdGVkIGZyb21cbiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9pb25pYy10ZWFtL2lvbmljLWZyYW1ld29yay9ibG9iL21hc3Rlci9jb3JlL3NyYy9jb21wb25lbnRzL2dyaWQvZ3JpZC5taXhpbnMuc2Nzc1xuICogaHR0cHM6Ly9naXRodWIuY29tL2lvbmljLXRlYW0vaW9uaWMtZnJhbWV3b3JrL2Jsb2IvbWFzdGVyL2NvcmUvc3JjL2NvbXBvbmVudHMvaXRlbS9pdGVtLm1peGlucy5zY3NzXG4gKi9cblxuLy8gUmVzcG9uc2l2ZSBNaXhpbnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cblxuLy8gQ3JlYXRlcyBhIGZpeGVkIHdpZHRoIGZvciB0aGUgZ3JpZCBiYXNlZCBvbiB0aGUgc2NyZWVuIHNpemVcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5AbWl4aW4gbWFrZS1ncmlkLXdpZHRocygkd2lkdGhzOiAkZ3JpZC13aWR0aHMsICRicmVha3BvaW50czogJHNjcmVlbi1icmVha3BvaW50cykge1xuICBAZWFjaCAkYnJlYWtwb2ludCwgJHdpZHRoIGluICR3aWR0aHMge1xuICAgIEBpbmNsdWRlIG1lZGlhLWJyZWFrcG9pbnQtdXAoJGJyZWFrcG9pbnQsICRicmVha3BvaW50cykge1xuICAgICAgd2lkdGg6ICR3aWR0aDtcbiAgICB9XG4gIH1cblxuICBtYXgtd2lkdGg6IDEwMCU7XG59XG5cblxuLy8gQWRkcyBwYWRkaW5nIHRvIHRoZSBlbGVtZW50IGJhc2VkIG9uIGJyZWFrcG9pbnRzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuQG1peGluIG1ha2UtYnJlYWtwb2ludC1wYWRkaW5nKCRwYWRkaW5ncykge1xuICBAZWFjaCAkYnJlYWtwb2ludCBpbiBtYXAta2V5cygkcGFkZGluZ3MpIHtcbiAgICBAaW5jbHVkZSBtZWRpYS1icmVha3BvaW50LXVwKCRicmVha3BvaW50KSB7XG4gICAgICAkcGFkZGluZzogbWFwLWdldCgkcGFkZGluZ3MsICRicmVha3BvaW50KTtcblxuICAgICAgQGluY2x1ZGUgcGFkZGluZygkcGFkZGluZyk7XG4gICAgfVxuICB9XG59XG5cblxuLy8gSXRlbSBNaXhpbnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbkBtaXhpbiBpdGVtLXB1c2gtc3ZnLXVybCgkZmlsbCkge1xuICAkaXRlbS1kZXRhaWwtcHVzaC1zdmc6IFwiPHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHZpZXdCb3g9JzAgMCAxMiAyMCc+PHBhdGggZD0nTTIsMjBsLTItMmw4LThMMCwybDItMmwxMCwxMEwyLDIweicgZmlsbD0nI3skZmlsbH0nLz48L3N2Zz5cIjtcblxuICBAaW5jbHVkZSBzdmctYmFja2dyb3VuZC1pbWFnZSgkaXRlbS1kZXRhaWwtcHVzaC1zdmcsIHRydWUpO1xufVxuIiwiQHVzZSBcInNhc3M6bWF0aFwiIGFzIG1hdGg7XG5cbi8qKlxuICogQXBwIGN1c3RvbSBtaXhpbnMgZm9yIFNDU1NcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqIFBsYWNlIGhlcmUgb3VyIGN1c3RvbSBtaXhpbnMuXG4gKi9cblxuLy8gTWl4ZXMgYSBjb2xvciB3aXRoIGJsYWNrIHRvIGNyZWF0ZSBpdHMgc2hhZGUuXG4vLyBEZWZhdWx0IHRvIGJvb3RzdHJhcCBsZXZlbCA2LlxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbkBmdW5jdGlvbiBnZXQtY29sb3Itc2hhZGUtcGVyY2VudCgkY29sb3IsICRwZXJjZW50OiA0OCUpIHtcbiAgICBAcmV0dXJuIG1peCgjMDAwLCAkY29sb3IsICRwZXJjZW50KTtcbn1cblxuLy8gTWl4ZXMgYSBjb2xvciB3aXRoIHdoaXRlIHRvIGNyZWF0ZSBpdHMgdGludC5cbi8vIERlZmF1bHQgdG8gYm9vdHN0cmFwIGxldmVsIC0xMC5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5AZnVuY3Rpb24gZ2V0LWNvbG9yLXRpbnQtcGVyY2VudCgkY29sb3IsICRwZXJjZW50OiA4MCUpIHtcbiAgICBAcmV0dXJuIG1peCgjZmZmLCAkY29sb3IsICRwZXJjZW50KTtcbn1cblxuLy8gSW9uaWMgQ29sb3JzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gR2VuZXJhdGVzIHRoZSBjb2xvciBjbGFzc2VzIGFuZCB2YXJpYWJsZXMgYmFzZWQgb24gdGhlXG4vLyBjb2xvcnMgbWFwXG5cbkBtaXhpbiBnZW5lcmF0ZS1jb2xvcigkY29sb3ItbmFtZSwgJGNvbG9ycywgJHRoZW1lKSB7XG4gICAgJGNvbG9yLXRoZW1lczogbWFwLWdldCgkY29sb3JzLCAkY29sb3ItbmFtZSk7XG4gICAgJGJhc2U6IG1hcC1nZXQoJGNvbG9yLXRoZW1lcywgJHRoZW1lKTtcblxuICAgIEBpZiAkdGhlbWUgPT0gJ2RhcmsnIHtcbiAgICAgICAgJGJhc2U6IG1peChtYXAtZ2V0KCRjb2xvci10aGVtZXMsICdsaWdodCcpLCB3aGl0ZSwgODAlKSAhZGVmYXVsdDtcbiAgICB9XG5cbiAgICBAaW5jbHVkZSBnZW5lcmF0ZS1jb2xvci12YXJpYW50cygkY29sb3ItbmFtZSwgJGJhc2UpO1xufVxuXG5AbWl4aW4gZ2VuZXJhdGUtY29sb3ItdmFyaWFudHMoJGNvbG9yLW5hbWUsICRiYXNlKSB7XG4gICAgJGNvbnRyYXN0OiBnZXRfY29udHJhc3RfY29sb3IoJGJhc2UpO1xuICAgICRzaGFkZTogZ2V0LWNvbG9yLXNoYWRlLXBlcmNlbnQoJGJhc2UpO1xuICAgICR0aW50OiBnZXQtY29sb3ItdGludC1wZXJjZW50KCRiYXNlKTtcblxuICAgIC0tI3skY29sb3ItbmFtZX06ICN7JGJhc2V9O1xuICAgIC0tI3skY29sb3ItbmFtZX0tc2hhZGU6ICN7JHNoYWRlfTtcbiAgICAtLSN7JGNvbG9yLW5hbWV9LXRpbnQ6ICN7JHRpbnR9O1xuICAgIC0tI3skY29sb3ItbmFtZX0tY29udHJhc3Q6ICN7JGNvbnRyYXN0fTtcblxuICAgIC8vIEludGVybmFsIGlvbmljIHVzZSBvbmx5LlxuICAgIC0taW9uLWNvbG9yLSN7JGNvbG9yLW5hbWV9OiB2YXIoLS0jeyRjb2xvci1uYW1lfSk7XG4gICAgLS1pb24tY29sb3ItI3skY29sb3ItbmFtZX0tYmFzZTogdmFyKC0taW9uLWNvbG9yLSN7JGNvbG9yLW5hbWV9KTtcbiAgICAtLWlvbi1jb2xvci0jeyRjb2xvci1uYW1lfS1yZ2I6ICN7Y29sb3ItdG8tcmdiLWxpc3QoJGJhc2UpfTtcbiAgICAtLWlvbi1jb2xvci0jeyRjb2xvci1uYW1lfS1jb250cmFzdDogI3skY29udHJhc3R9O1xuICAgIC0taW9uLWNvbG9yLSN7JGNvbG9yLW5hbWV9LWNvbnRyYXN0LXJnYjogI3tjb2xvci10by1yZ2ItbGlzdCgkY29udHJhc3QpfTtcbiAgICAtLWlvbi1jb2xvci0jeyRjb2xvci1uYW1lfS1zaGFkZTogI3skc2hhZGV9O1xuICAgIC0taW9uLWNvbG9yLSN7JGNvbG9yLW5hbWV9LXRpbnQ6ICN7JHRpbnR9O1xuXG4gICAgLmlvbi1jb2xvci0jeyRjb2xvci1uYW1lfSB7XG4gICAgICAgIC0taW9uLWNvbG9yOiB2YXIoLS1pb24tY29sb3ItI3skY29sb3ItbmFtZX0pO1xuICAgICAgICAtLWlvbi1jb2xvci1iYXNlOiB2YXIoLS1pb24tY29sb3ItI3skY29sb3ItbmFtZX0tYmFzZSk7XG4gICAgICAgIC0taW9uLWNvbG9yLXJnYjogdmFyKC0taW9uLWNvbG9yLSN7JGNvbG9yLW5hbWV9LXJnYik7XG4gICAgICAgIC0taW9uLWNvbG9yLWNvbnRyYXN0OiB2YXIoLS1pb24tY29sb3ItI3skY29sb3ItbmFtZX0tY29udHJhc3QpO1xuICAgICAgICAtLWlvbi1jb2xvci1jb250cmFzdC1yZ2I6IHZhcigtLWlvbi1jb2xvci0jeyRjb2xvci1uYW1lfS1jb250cmFzdC1yZ2IpO1xuICAgICAgICAtLWlvbi1jb2xvci1zaGFkZTogdmFyKC0taW9uLWNvbG9yLSN7JGNvbG9yLW5hbWV9LXNoYWRlKTtcbiAgICAgICAgLS1pb24tY29sb3ItdGludDogdmFyKC0taW9uLWNvbG9yLSN7JGNvbG9yLW5hbWV9LXRpbnQpO1xuICAgIH1cbn1cblxuQG1peGluIGNvcmUtZm9jdXMoKSB7XG4gICAgb3V0bGluZTogbm9uZTtcbiAgICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gICAgJjo6YWZ0ZXIge1xuICAgICAgICBAaW5jbHVkZSBwb3NpdGlvbigwLCAwLCAwLCAwKTtcbiAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgICBjb250ZW50OiBcIlwiO1xuICAgICAgICBvcGFjaXR5OiAxO1xuICAgICAgICB6LWluZGV4OiAxO1xuICAgICAgICBAaW5jbHVkZSBjb3JlLWZvY3VzLXN0eWxlKCk7XG4gICAgfVxufVxuXG5AbWl4aW4gY29yZS1mb2N1cy1zdHlsZSgpIHtcbiAgICBib3gtc2hhZG93OiBpbnNldCAwIDAgdmFyKC0tYTExeS1mb2N1cy13aWR0aCkgMXB4IHZhcigtLWExMXktZm9jdXMtY29sb3IpO1xuICAgIGJvcmRlci1yYWRpdXM6IHZhcigtLWJvcmRlci1yYWRpdXMpO1xuICAgIC8vIFRoaWNrZXIgb3B0aW9uOlxuICAgIC8vIGJvcmRlcjogdmFyKC0tYTExeS1mb2N1cy13aWR0aCkgc29saWQgdmFyKC0tYTExeS1mb2N1cy1jb2xvcik7XG59XG5cbkBtaXhpbiBjb3JlLXRyYW5zaXRpb24oJHByb3BlcnRpZXM6IGFsbCwgJGR1cmF0aW9uOiA1MDBtcywgJHRpbWluZy1mdW5jdGlvbjogZWFzZS1pbi1vdXQpIHtcbiAgICAkdHJhbnNpdGlvbnM6ICgpO1xuICAgIEBlYWNoICRwcm9wZXJ0eSBpbiAkcHJvcGVydGllcyB7XG4gICAgICAkdHJhbnNpdGlvbnM6IGFwcGVuZCgkdHJhbnNpdGlvbnMsICRwcm9wZXJ0eSAkZHVyYXRpb24gJHRpbWluZy1mdW5jdGlvbiwgY29tbWEpO1xuICAgIH1cblxuICAgIC13ZWJraXQtdHJhbnNpdGlvbjogJHRyYW5zaXRpb25zO1xuICAgIHRyYW5zaXRpb246ICR0cmFuc2l0aW9ucztcbn1cblxuQG1peGluIHNyLW9ubHkoKSB7XG4gICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgIHdpZHRoOiAxcHg7XG4gICAgaGVpZ2h0OiAxcHg7XG4gICAgcGFkZGluZzogMDtcbiAgICBtYXJnaW46IC0xcHg7XG4gICAgb3ZlcmZsb3c6IGhpZGRlbjtcbiAgICBjbGlwOiByZWN0KDAsIDAsIDAsIDApO1xuICAgIHdoaXRlLXNwYWNlOiBub3dyYXA7XG4gICAgYm9yZGVyOiAwO1xufVxuXG4vKipcbiAqIFNhbWUgYXMgaXRlbS1wdXNoLXN2Zy11cmwgYnV0IGFkbWl0cyBmbGlwLXJ0bFxuICovXG5AbWl4aW4gcHVzaC1hcnJvdy1jb2xvcigkZmlsbDogNjI2MjYyLCAkZmxpcC1ydGw6IGZhbHNlKSB7XG4gICAgJGl0ZW0tZGV0YWlsLXB1c2gtc3ZnOiBcIjxzdmcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB2aWV3Qm94PScwIDAgMTIgMjAnPjxwYXRoIGQ9J00yLDIwbC0yLTJsOC04TDAsMmwyLTJsMTAsMTBMMiwyMHonIGZpbGw9JyN7JGZpbGx9Jy8+PC9zdmc+XCI7XG5cbiAgICBAaW5jbHVkZSBzdmctYmFja2dyb3VuZC1pbWFnZSgkaXRlbS1kZXRhaWwtcHVzaC1zdmcsICRmbGlwLXJ0bCk7XG59XG5cbkBtaXhpbiBib3JkZXItc3RhcnQoJHB4LCAkdHlwZTogbnVsbCwgJGNvbG9yOiBudWxsKSB7XG4gICAgQGluY2x1ZGUgcHJvcGVydHktaG9yaXpvbnRhbChib3JkZXIsICRweCAkdHlwZSAkY29sb3IsIG51bGwpO1xufVxuXG5AbWl4aW4gYm9yZGVyLWVuZCgkcHgsICR0eXBlOiBudWxsLCAkY29sb3I6IG51bGwpIHtcbiAgICBAaW5jbHVkZSBwcm9wZXJ0eS1ob3Jpem9udGFsKGJvcmRlciwgbnVsbCwgJHB4ICR0eXBlICRjb2xvcik7XG59XG5cbkBtaXhpbiBzYWZlLWFyZWEtYm9yZGVyLXN0YXJ0KCRweCwgJHR5cGUsICRjb2xvcikge1xuICAgICRzYWZlLWFyZWEtcG9zaXRpb246IGNhbGModmFyKC0taW9uLXNhZmUtYXJlYS1sZWZ0KSArICN7JHB4fSk7XG5cbiAgICBAaW5jbHVkZSBib3JkZXItc3RhcnQoJHNhZmUtYXJlYS1wb3NpdGlvbiwgJHR5cGUsICRjb2xvcik7XG59XG5cbkBtaXhpbiBzYWZlLWFyZWEtYm9yZGVyLWVuZCgkcHgsICR0eXBlLCAkY29sb3IpIHtcbiAgICAkc2FmZS1hcmVhLXBvc2l0aW9uOiBjYWxjKHZhcigtLWlvbi1zYWZlLWFyZWEtcmlnaHQpICsgI3skcHh9KTtcblxuICAgIEBpbmNsdWRlIGJvcmRlci1lbmQoJHNhZmUtYXJlYS1wb3NpdGlvbiwgJHR5cGUsICRjb2xvcik7XG59XG5cbkBtaXhpbiBzYWZlLWFyZWEtbWFyZ2luLWhvcml6b250YWwoJHN0YXJ0LCAkZW5kOiAkc3RhcnQpIHtcbiAgICAkc2FmZS1hcmVhLWVuZDogbnVsbDtcbiAgICAkc2FmZS1hcmVhLXN0YXJ0OiBudWxsO1xuXG4gICAgQGlmICgkZW5kKSB7XG4gICAgICAgICRzYWZlLWFyZWEtZW5kOiBjYWxjKHZhcigtLWlvbi1zYWZlLWFyZWEtcmlnaHQpICsgI3skZW5kfSk7XG4gICAgfVxuICAgIEBpZiAoJHN0YXJ0KSB7XG4gICAgICAgICRzYWZlLWFyZWEtc3RhcnQ6IGNhbGModmFyKC0taW9uLXNhZmUtYXJlYS1sZWZ0KSArICN7JHN0YXJ0fSk7XG4gICAgfVxuXG4gICAgQGluY2x1ZGUgbWFyZ2luLWhvcml6b250YWwoJHNhZmUtYXJlYS1zdGFydCwgJHNhZmUtYXJlYS1lbmQpO1xufVxuXG5AbWl4aW4gc2FmZS1hcmVhLW1hcmdpbi1zdGFydCgkc3RhcnQsICRlbmQpIHtcbiAgICAkc2FmZS1hcmVhLXN0YXJ0OiBjYWxjKHZhcigtLWlvbi1zYWZlLWFyZWEtbGVmdCkgKyAjeyRzdGFydH0pO1xuXG4gICAgQGluY2x1ZGUgbWFyZ2luLWhvcml6b250YWwoJHNhZmUtYXJlYS1zdGFydCwgJGVuZCk7XG59XG5cbkBtaXhpbiBzYWZlLWFyZWEtbWFyZ2luLWVuZCgkc3RhcnQsICRlbmQpIHtcbiAgICAkc2FmZS1hcmVhLWVuZDogY2FsYyh2YXIoLS1pb24tc2FmZS1hcmVhLXJpZ2h0KSArICN7JGVuZH0pO1xuXG4gICAgQGluY2x1ZGUgbWFyZ2luLWhvcml6b250YWwoJHN0YXJ0LCAkc2FmZS1hcmVhLWVuZCk7XG59XG5cbkBtaXhpbiBzYWZlLWFyZWEtcGFkZGluZy1ob3Jpem9udGFsKCRzdGFydCwgJGVuZDogJHN0YXJ0KSB7XG4gICAgJHNhZmUtYXJlYS1lbmQ6IG51bGw7XG4gICAgJHNhZmUtYXJlYS1zdGFydDogbnVsbDtcblxuICAgIEBpZiAoJGVuZCkge1xuICAgICAgICAkc2FmZS1hcmVhLWVuZDogY2FsYyh2YXIoLS1pb24tc2FmZS1hcmVhLXJpZ2h0KSArICN7JGVuZH0pO1xuICAgIH1cbiAgICBAaWYgKCRzdGFydCkge1xuICAgICAgICAkc2FmZS1hcmVhLXN0YXJ0OiBjYWxjKHZhcigtLWlvbi1zYWZlLWFyZWEtbGVmdCkgKyAjeyRzdGFydH0pO1xuICAgIH1cblxuICAgIEBpbmNsdWRlIHBhZGRpbmctaG9yaXpvbnRhbCgkc2FmZS1hcmVhLXN0YXJ0LCAkc2FmZS1hcmVhLWVuZCk7XG59XG5cbkBtaXhpbiBzYWZlLWFyZWEtcGFkZGluZy1zdGFydCgkc3RhcnQsICRlbmQpIHtcbiAgICAkc2FmZS1hcmVhLXN0YXJ0OiBjYWxjKHZhcigtLWlvbi1zYWZlLWFyZWEtbGVmdCkgKyAjeyRzdGFydH0pO1xuXG4gICAgQGluY2x1ZGUgcGFkZGluZy1ob3Jpem9udGFsKCRzYWZlLWFyZWEtc3RhcnQsICRlbmQpO1xufVxuXG5AbWl4aW4gc2FmZS1hcmVhLXBhZGRpbmctZW5kKCRzdGFydCwgJGVuZCkge1xuICAgICRzYWZlLWFyZWEtZW5kOiBjYWxjKHZhcigtLWlvbi1zYWZlLWFyZWEtcmlnaHQpICsgI3skZW5kfSk7XG5cbiAgICBAaW5jbHVkZSBwYWRkaW5nLWhvcml6b250YWwoJHN0YXJ0LCAkc2FmZS1hcmVhLWVuZCk7XG59XG5cbkBtaXhpbiBzYWZlLWFyZWEtcG9zaXRpb24oJHRvcDogbnVsbCwgJGVuZDogbnVsbCwgJGJvdHRvbTogbnVsbCwgJHN0YXJ0OiBudWxsKSB7XG4gICAgJHNhZmUtYXJlYS1zdGFydDogY2FsYyh2YXIoLS1pb24tc2FmZS1hcmVhLWxlZnQpICsgI3skc3RhcnR9KTtcbiAgICAkc2FmZS1hcmVhLWVuZDogY2FsYyh2YXIoLS1pb24tc2FmZS1hcmVhLXJpZ2h0KSArICN7JGVuZH0pO1xuXG4gICAgQGluY2x1ZGUgcG9zaXRpb24oJHRvcCwgJHNhZmUtYXJlYS1lbmQsICRib3R0b20sICRzYWZlLWFyZWEtc3RhcnQpO1xufVxuXG5AbWl4aW4gY29yZS1oZWFkaW5ncygpIHtcbiAgICBoMSB7XG4gICAgICAgIGZvbnQtc2l6ZTogMjZweDtcbiAgICB9XG4gICAgaDIsIC5pdGVtLWhlYWRpbmcge1xuICAgICAgICBmb250LXNpemU6IDI0cHg7XG4gICAgfVxuICAgIGgzIHtcbiAgICAgICAgZm9udC1zaXplOiAyMnB4O1xuICAgIH1cbiAgICBoNCB7XG4gICAgICAgIGZvbnQtc2l6ZTogMjBweDtcbiAgICB9XG4gICAgaDUge1xuICAgICAgICBmb250LXNpemU6IDE4cHg7XG4gICAgfVxuICAgIGg2IHtcbiAgICAgICAgZm9udC1zaXplOiAxNnB4O1xuICAgIH1cbn1cblxuQG1peGluIGRhcmttb2RlKCkge1xuICAgICRyb290OiAjeyZ9O1xuXG4gICAgQGF0LXJvb3QgI3thZGQtcm9vdC1zZWxlY3Rvcigkcm9vdCwgXCJodG1sLmRhcmtcIil9IHtcbiAgICAgICAgQGNvbnRlbnQ7XG4gICAgfVxufVxuXG5AbWl4aW4gaG9yaXpvbnRhbF9zY3JvbGxfaXRlbSgkd2lkdGgsICRtaW4td2lkdGgsICRtYXgtd2lkdGgpIHtcbiAgICBmbGV4OiAwIDAgJHdpZHRoO1xuICAgIG1pbi13aWR0aDogJG1pbi13aWR0aDtcbiAgICBtYXgtd2lkdGg6ICRtYXgtd2lkdGg7XG4gICAgYWxpZ24tc2VsZjogc3RyZXRjaDtcbiAgICBkaXNwbGF5OiBibG9jaztcblxuICAgIGlvbi1jYXJkIHtcbiAgICAgICAgLS12ZXJ0aWNhbC1tYXJnaW46IDEwcHg7XG4gICAgICAgIC0taG9yaXpvbnRhbC1tYXJnaW46IDEwcHg7XG5cbiAgICAgICAgd2lkdGg6IGNhbGMoMTAwJSAtIHZhcigtLWhvcml6b250YWwtbWFyZ2luKSAtIHZhcigtLWhvcml6b250YWwtbWFyZ2luKSk7XG4gICAgICAgIGhlaWdodDogY2FsYygxMDAlIC0gdmFyKC0tdmVydGljYWwtbWFyZ2luKSAtIHZhcigtLXZlcnRpY2FsLW1hcmdpbikpO1xuICAgICAgICBtYXJnaW46IHZhcigtLXZlcnRpY2FsLW1hcmdpbikgdmFyKC0taG9yaXpvbnRhbC1tYXJnaW4pO1xuXG4gICAgICAgIEBtZWRpYSAobWF4LXdpZHRoOiAzNjBweCkge1xuICAgICAgICAgICAgLS1ob3Jpem9udGFsLW1hcmdpbjogNnB4O1xuICAgICAgICB9XG4gICAgfVxufVxuXG4vLyBDb2xvciBtaXhpbnMuXG5AZnVuY3Rpb24gZ2V0X2JyaWdodG5lc3MoJGNvbG9yKSB7XG4gICAgQHJldHVybiBtYXRoLmRpdihyZWQoJGNvbG9yKSArIGdyZWVuKCRjb2xvcikgKyBibHVlKCRjb2xvciksIDMpO1xufVxuXG4vLyBHZXQgdGhlIGJldHRlciBjb2xvciBjb250cmFzdCB1c2luZyBXQ0FHIGFsZ29yeXRobS5cbkBmdW5jdGlvbiBnZXRfY29udHJhc3RfY29sb3IoJGNvbG9yKSB7XG4gICAgJGx1bWlhbmNlOiBsdW1pbmFuY2UoJGNvbG9yKTtcblxuICAgIC8vIFdoaXRlIGx1bWlhbmNlIGlzIDEuXG4gICAgJHdoaXRlQ29udHJhc3Q6IG1hdGguZGl2KCRsdW1pYW5jZSArIDAuMDUsIDEgKyAwLjA1KTtcbiAgICAvLyBXaGl0ZSBsdW1pYW5jZSBpcyAwLlxuICAgICRibGFja0NvbnRyYXN0OiBtYXRoLmRpdigwLjA1LCAkbHVtaWFuY2UgKyAwLjA1KTtcblxuICAgIEByZXR1cm4gaWYoJHdoaXRlQ29udHJhc3QgPCAkYmxhY2tDb250cmFzdCwgd2hpdGUsIGJsYWNrKTtcbn1cblxuLy8gQ29sb3IgY29udHJhc3QgdXNpbmcgeWlxIGFwcm94aW1hdGlvbiB3aXRoIDE1MCB0aHJlc2hvbGQuXG5AZnVuY3Rpb24gZ2V0X2NvbnRyYXN0X2NvbG9yX3lpcSgkY29sb3IsICRkYXJrOiBibGFjaywgJGxpZ2h0OiB3aGl0ZSkge1xuICAgICRyOiByZWQoJGNvbG9yKTtcbiAgICAkZzogZ3JlZW4oJGNvbG9yKTtcbiAgICAkYjogYmx1ZSgkY29sb3IpO1xuXG4gICAgJHlpcTogbWF0aC5kaXYoKCRyICogMjk5KSArICgkZyAqIDU4NykgKyAoJGIgKiAxMTQpLCAxMDAwKTtcblxuICAgIEByZXR1cm4gaWYoJHlpcSA+PSAxMjgsICRkYXJrLCAkbGlnaHQpO1xufVxuXG4vLyBXQ0FHIGNvbnRyYXN0IGFsZ29yaXRobVxuQGZ1bmN0aW9uIGNoZWNrLWNvbnRyYXN0KCRmb3JlZ3JvdW5kLCAkYmFja2dyb3VuZCkge1xuICAgICRmb3JlZ3JvdW5kTHVtaWFuY2U6IGx1bWluYW5jZSgkZm9yZWdyb3VuZCk7XG4gICAgJGJhY2tncm91bmRMdW1pbmFuY2U6IGx1bWluYW5jZSgkYmFja2dyb3VuZCk7XG5cbiAgICBAaWYgKCRiYWNrZ3JvdW5kTHVtaW5hbmNlIDwgJGZvcmVncm91bmRMdW1pYW5jZSkge1xuICAgICAgICBAcmV0dXJuIG1hdGguZGl2KCRiYWNrZ3JvdW5kTHVtaW5hbmNlICsgMC4wNSwgJGZvcmVncm91bmRMdW1pYW5jZSArIDAuMDUpO1xuICAgIH0gQGVsc2Uge1xuICAgICAgICBAcmV0dXJuIG1hdGguZGl2KCRmb3JlZ3JvdW5kTHVtaWFuY2UgKyAwLjA1LCAkYmFja2dyb3VuZEx1bWluYW5jZSArIDAuMDUpO1xuICAgIH1cbn1cblxuQGZ1bmN0aW9uIGx1bWluYW5jZSgkY29sb3IpIHtcbiAgICAkcjogcmVkKCRjb2xvcik7XG4gICAgJGc6IGdyZWVuKCRjb2xvcik7XG4gICAgJGI6IGJsdWUoJGNvbG9yKTtcblxuICAgICRyOiBjb21wb25lbnQtbHVtaW5hbmNlKCRyKTtcbiAgICAkZzogY29tcG9uZW50LWx1bWluYW5jZSgkZyk7XG4gICAgJGI6IGNvbXBvbmVudC1sdW1pbmFuY2UoJGIpO1xuXG4gICAgQHJldHVybiAkciAqIDAuMjEyNiArICRnICogMC43MTUyICsgJGIgKiAwLjA3MjI7XG59XG5cbkBmdW5jdGlvbiBjb21wb25lbnQtbHVtaW5hbmNlKCR2YWx1ZSkge1xuICAgICR2YWx1ZTogbWF0aC5kaXYoJHZhbHVlLCAyNTUpO1xuXG4gICAgQGlmICgkdmFsdWUgPD0gMC4wMzkyOCkge1xuICAgICAgICBAcmV0dXJuIG1hdGguZGl2KCR2YWx1ZSwgMTIuOTIpO1xuICAgIH0gQGVsc2Uge1xuICAgICAgICBAcmV0dXJuIG1hdGgucG93KG1hdGguZGl2KCR2YWx1ZSArIDAuMDU1LCAxLjA1NSksIDIuNCk7XG4gICAgfVxufVxuIiwiLypcbiAqIEFwcCBDdXN0b20gQXBwIHZhcmlhYmxlcyBTQ1NTXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiBQbGFjZSBoZXJlIGFsbCBjdXN0b20gYXBwIHZhcmlhYmxlcy5cbiAqL1xuIiwiLypcbiAqIEFwcCBHbG9iYWwgdmFyaWFibGVzIFNDU1NcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqIFBsYWNlIGhlcmUgYWxsIGdsb2JhbCB2YXJpYWJsZXMuXG4gKi9cblxuJHdoaXRlOiAgICAgICAjZmZmZmZmICFkZWZhdWx0O1xuJGdyYXktMTAwOiAgICAjZjhmOWZhICFkZWZhdWx0O1xuJGdyYXktMjAwOiAgICAjZTllY2VmICFkZWZhdWx0O1xuJGdyYXktMzAwOiAgICAjZGVlMmU2ICFkZWZhdWx0OyAvLyBTdHJva2VcbiRncmF5LTQwMDogICAgI2NlZDRkYSAhZGVmYXVsdDtcbiRncmF5LTUwMDogICAgIzhmOTU5ZSAhZGVmYXVsdDsgLy8gU3Ryb2tlIG9uIGlucHV0c1xuJGdyYXktNjAwOiAgICAjNmE3MzdiICFkZWZhdWx0O1xuJGdyYXktNzAwOiAgICAjNDk1MDU3ICFkZWZhdWx0O1xuJGdyYXktODAwOiAgICAjMzQzYTQwICFkZWZhdWx0O1xuJGdyYXktOTAwOiAgICAjMjgyODI4ICFkZWZhdWx0OyAvLyBDb3B5IHRleHRcbiRibGFjazogICAgICAgIzAwMDAwMCAhZGVmYXVsdDsgLy8gQXZvaWQgdXNhZ2VcblxuJGJsdWU6ICAgICAgICAjMGY2Y2JmICFkZWZhdWx0O1xuJGN5YW46ICAgICAgICAjMDA4MTk2ICFkZWZhdWx0OyAvLyBOb3QgdXNlZC5cbiRncmVlbjogICAgICAgIzM1N2EzMiAhZGVmYXVsdDtcbiRyZWQ6ICAgICAgICAgI2NhMzEyMCAhZGVmYXVsdDtcbiR5ZWxsb3c6ICAgICAgI2YwYWQ0ZSAhZGVmYXVsdDtcblxuJGJyYW5kLWNvbG9yOiAjZjk4MDEyICFkZWZhdWx0O1xuXG4kdGV4dC1jb2xvcjogICAgICAgICAgICAgICAkZ3JheS05MDAgIWRlZmF1bHQ7XG4kdGV4dC1jb2xvci1yZ2I6ICAgICAgICAgICBjb2xvci10by1yZ2ItbGlzdCgkdGV4dC1jb2xvcikgIWRlZmF1bHQ7XG4kdGV4dC1jb2xvci1kYXJrOiAgICAgICAgICAkd2hpdGUgIWRlZmF1bHQ7XG4kdGV4dC1jb2xvci1kYXJrLXJnYjogICAgICBjb2xvci10by1yZ2ItbGlzdCgkdGV4dC1jb2xvci1kYXJrKSAhZGVmYXVsdDtcblxuJGJhY2tncm91bmQtY29sb3I6ICAgICAgICAgICR3aGl0ZSAhZGVmYXVsdDtcbiRiYWNrZ3JvdW5kLWNvbG9yLXJnYjogICAgICBjb2xvci10by1yZ2ItbGlzdCgkYmFja2dyb3VuZC1jb2xvcikgIWRlZmF1bHQ7XG4kYmFja2dyb3VuZC1jb2xvci1kYXJrOiAgICAgJGdyYXktOTAwICFkZWZhdWx0OyAvLyAjMWExYTFhXG4kYmFja2dyb3VuZC1jb2xvci1kYXJrLXJnYjogY29sb3ItdG8tcmdiLWxpc3QoJGJhY2tncm91bmQtY29sb3ItZGFyaykgIWRlZmF1bHQ7XG5cbiRpb24taXRlbS1iYWNrZ3JvdW5kOiAgICAgICR3aGl0ZSAhZGVmYXVsdDtcbiRpb24taXRlbS1iYWNrZ3JvdW5kLXJnYjogIGNvbG9yLXRvLXJnYi1saXN0KCRpb24taXRlbS1iYWNrZ3JvdW5kKSAhZGVmYXVsdDtcbiRpb24taXRlbS1iYWNrZ3JvdW5kLWRhcms6ICRncmF5LTkwMCAhZGVmYXVsdDtcbiRpb24taXRlbS1iYWNrZ3JvdW5kLWRhcmstcmdiOiBjb2xvci10by1yZ2ItbGlzdCgkaW9uLWl0ZW0tYmFja2dyb3VuZC1kYXJrKSAhZGVmYXVsdDtcblxuJHByaW1hcnk6ICAgICRicmFuZC1jb2xvciAhZGVmYXVsdDtcbiRzZWNvbmRhcnk6ICAkZ3JheS0zMDAgIWRlZmF1bHQ7XG4kZGFuZ2VyOiAgICAgJHJlZCAhZGVmYXVsdDtcbiR3YXJuaW5nOiAgICAkeWVsbG93ICFkZWZhdWx0O1xuJHN1Y2Nlc3M6ICAgICRncmVlbiAhZGVmYXVsdDtcbiRpbmZvOiAgICAgICAkYmx1ZSAhZGVmYXVsdDtcbiRsaWdodDogICAgICAkZ3JheS0xMDAgIWRlZmF1bHQ7XG4kbWVkaXVtOiAgICAgJGdyYXktNzAwICFkZWZhdWx0O1xuJGRhcms6ICAgICAgICRncmF5LTkwMCAhZGVmYXVsdDtcblxuJGNvbG9yczogIChcbiAgICBwcmltYXJ5OiAobGlnaHQ6ICRwcmltYXJ5LCBkYXJrOiAkcHJpbWFyeSksXG4gICAgc2Vjb25kYXJ5OiAobGlnaHQ6ICRzZWNvbmRhcnksIGRhcms6ICRncmF5LTcwMCksXG4gICAgc3VjY2VzczogKGxpZ2h0OiAkc3VjY2VzcyksXG4gICAgd2FybmluZzogKGxpZ2h0OiAkd2FybmluZyksXG4gICAgZGFuZ2VyOiAgKGxpZ2h0OiAkZGFuZ2VyKSxcbiAgICBpbmZvOiAobGlnaHQ6ICRpbmZvKSxcbiAgICBsaWdodDogKGxpZ2h0OiAkbGlnaHQsIGRhcms6ICRkYXJrKSxcbiAgICBtZWRpdW06IChsaWdodDogJG1lZGl1bSwgZGFyazogJGdyYXktMjAwKSxcbiAgICBkYXJrOiAobGlnaHQ6ICRkYXJrLCBkYXJrOiAkbGlnaHQpLFxuKSAhZGVmYXVsdDtcblxuLyoqXG4gKiBMYXlvdXQgQnJlYWtwb2ludHNcbiAqXG4gKiBodHRwczovL2lvbmljZnJhbWV3b3JrLmNvbS9kb2NzL2xheW91dC9ncmlkI2RlZmF1bHQtYnJlYWtwb2ludHNcbiAqL1xuXG4vLyBUaGUgbWluaW11bSBkaW1lbnNpb25zIGF0IHdoaWNoIHlvdXIgbGF5b3V0IHdpbGwgY2hhbmdlLFxuLy8gYWRhcHRpbmcgdG8gZGlmZmVyZW50IHNjcmVlbiBzaXplcywgZm9yIHVzZSBpbiBtZWRpYSBxdWVyaWVzXG4kc2NyZWVuLWJyZWFrcG9pbnRzOiAoXG4gICAgeHM6IDBweCxcbiAgICBzbTogNTc2cHgsXG4gICAgbWQ6IDc2OHB4LFxuICAgIGxnOiA5OTJweCxcbiAgICB0YWJsZXQ6IDk5MnB4LFxuICAgIHhsOiAxMjAwcHhcbikgIWRlZmF1bHQ7XG5cbiRjb3JlLWNvdXJzZS1pbWFnZS1iYWNrZ3JvdW5kOiAjODFlY2VjLCAjNzRiOWZmLCAjYTI5YmZlLCAjZGZlNmU5LCAjMDBiODk0LCAjMDk4NGUzLCAjYjJiZWMzLCAjZmRjYjZlLCAjZmQ3OWE4LCAjNmM1Y2U3ICFkZWZhdWx0O1xuJGNvcmUtZGQtcXVlc3Rpb24tY29sb3JzOiAjRkZGRkZGLCAjQjBDNERFLCAjRENEQ0RDLCAjRDhCRkQ4LCAjODdDRUZBLCAjREFBNTIwLCAjRkZENzAwLCAjRjBFNjhDICFkZWZhdWx0O1xuJGNvcmUtdGV4dC1oaWdodGxpZ2h0LWJhY2tncm91bmQtY29sb3I6IGxpZ2h0ZW4oJGJsdWUsIDQwJSkgIWRlZmF1bHQ7XG5cbiRjb3JlLWZpeGVkLXVybDogZmFsc2UgIWRlZmF1bHQ7XG4kY29yZS1kYXNoYm9hcmQtbG9nbzogZmFsc2UgIWRlZmF1bHQ7XG4kY29yZS1hbHdheXMtc2hvdy1tYWluLW1lbnU6IGZhbHNlICFkZWZhdWx0O1xuJGNvcmUtZm9ybWF0LXRleHQtbmV2ZXItc2hvcnRlbjogZmFsc2UgIWRlZmF1bHQ7XG5cbiRjb3JlLWhpZGUtY291cnNlaW1hZ2Utb24tY291cnNlOiBmYWxzZSAhZGVmYXVsdDtcbiRjb3JlLWhpZGUtcHJvZ3Jlc3Mtb24tY291cnNlOiBmYWxzZSAhZGVmYXVsdDtcbiRjb3JlLWhpZGUtcHJvZ3Jlc3Mtb24tc2VjdGlvbi1zZWxlY3RvcjogZmFsc2UgIWRlZmF1bHQ7XG5cbiRjb3JlLWNvdXJzZS1oaWRlLXRodW1iLW9uLWNhcmRzOiBmYWxzZSAhZGVmYXVsdDtcbiRjb3JlLWNvdXJzZS10aHVtYi1vbi1jYXJkcy1iYWNrZ3JvdW5kOiBudWxsICFkZWZhdWx0O1xuJGNvcmUtY291cnNlLWhpZGUtcHJvZ3Jlc3Mtb24tY2FyZHM6IGZhbHNlICFkZWZhdWx0O1xuXG4vLyBDb25maWd1cmF0aW9uIG9wdGlvbnMgZm9yIGxvZ2luIHBhZ2UuXG4kY29yZS1sb2dpbi1idXR0b24tb3V0bGluZTogZmFsc2UgIWRlZmF1bHQ7XG4kY29yZS1sb2dpbi1idXR0b24tb3V0bGluZS1kYXJrOiAkY29yZS1sb2dpbi1idXR0b24tb3V0bGluZSAhZGVmYXVsdDtcbiRjb3JlLWxvZ2luLWxvYWRpbmctY29sb3I6IGZhbHNlICFkZWZhdWx0O1xuJGNvcmUtbG9naW4tbG9hZGluZy1jb2xvci1kYXJrOiAkdGV4dC1jb2xvci1kYXJrICFkZWZhdWx0O1xuJGNvcmUtbG9naW4taGlkZS1mb3Jnb3QtcGFzc3dvcmQ6IGZhbHNlICFkZWZhdWx0O1xuJGNvcmUtbG9naW4taGlkZS1uZWVkLWhlbHA6IGZhbHNlICFkZWZhdWx0O1xuJGNvcmUtbG9naW4taGlkZS1xcmNvZGU6IGZhbHNlICFkZWZhdWx0O1xuXG4vLyBDb25maWd1cmF0aW9uIG9wdGlvbnMgZm9yIG1vcmUgcGFnZS4gKGRlcHJlY2F0ZWQgb24gNC4wKVxuJGNvcmUtbW9yZS1oaWRlLXNpdGVpbmZvOiBmYWxzZSAhZGVmYXVsdDtcbiRjb3JlLW1vcmUtaGlkZS1zaXRlbmFtZTogZmFsc2UgIWRlZmF1bHQ7XG4kY29yZS1tb3JlLWhpZGUtc2l0ZXVybDogZmFsc2UgIWRlZmF1bHQ7XG5cbi8vIENvbmZpZ3VyYXRpb24gb3B0aW9ucyBmb3IgdXNlciBwYWdlLlxuJGNvcmUtdXNlci1oaWRlLXNpdGVpbmZvOiAkY29yZS1tb3JlLWhpZGUtc2l0ZWluZm8gIWRlZmF1bHQ7XG4kY29yZS11c2VyLWhpZGUtc2l0ZW5hbWU6ICRjb3JlLW1vcmUtaGlkZS1zaXRlbmFtZSAhZGVmYXVsdDtcbiRjb3JlLXVzZXItaGlkZS1zaXRldXJsOiAkY29yZS1tb3JlLWhpZGUtc2l0ZXVybCAhZGVmYXVsdDtcblxuLy8gQWN0aXZpdHkgaWNvbiBiYWNrZ3JvdW5kIGNvbG9ycy5cbiRhY3Rpdml0eS1pY29uLWNvbG9yczogKFxuICAgIGFkbWluaXN0cmF0aW9uOiAjNWQ2M2Y2LFxuICAgIGFzc2Vzc21lbnQ6ICNlYjY2YTIsXG4gICAgY29sbGFib3JhdGlvbjogI2Y3NjM0ZCxcbiAgICBjb21tdW5pY2F0aW9uOiAjMTFhNjc2LFxuICAgIGNvbnRlbnQ6ICMzOTliZTIsXG4gICAgaW50ZXJmYWNlOiAjYTM3OGZmXG4pICFkZWZhdWx0O1xuXG4kY2FsZW5kYXItZXZlbnQtY2F0ZWdvcnktY2F0ZWdvcnk6ICM4ZTI0YWEgIWRlZmF1bHQ7XG4kY2FsZW5kYXItZXZlbnQtY2F0ZWdvcnktY291cnNlOiAkcmVkICFkZWZhdWx0O1xuJGNhbGVuZGFyLWV2ZW50LWNhdGVnb3J5LWdyb3VwOiAkeWVsbG93ICFkZWZhdWx0O1xuJGNhbGVuZGFyLWV2ZW50LWNhdGVnb3J5LXVzZXI6ICRibHVlICFkZWZhdWx0O1xuJGNhbGVuZGFyLWV2ZW50LWNhdGVnb3J5LXNpdGU6ICRncmVlbiAhZGVmYXVsdDtcblxuLy8gQ2FsZW5kYXIgZXZlbnQgY2F0ZWdvcnkgYmFja2dyb3VuZCBjb2xvcnMuXG4kY2FsZW5kYXItZXZlbnQtY2F0ZWdvcnktY29sb3JzOiAoXG4gICAgY2F0ZWdvcnk6ICRjYWxlbmRhci1ldmVudC1jYXRlZ29yeS1jYXRlZ29yeSxcbiAgICBjb3Vyc2U6ICRjYWxlbmRhci1ldmVudC1jYXRlZ29yeS1jb3Vyc2UsXG4gICAgZ3JvdXA6ICRjYWxlbmRhci1ldmVudC1jYXRlZ29yeS1ncm91cCxcbiAgICB1c2VyOiAkY2FsZW5kYXItZXZlbnQtY2F0ZWdvcnktdXNlcixcbiAgICBzaXRlOiAkY2FsZW5kYXItZXZlbnQtY2F0ZWdvcnktc2l0ZSxcbikgIWRlZmF1bHQ7XG4iLCJAdXNlIFwidGhlbWUvZ2xvYmFsc1wiIGFzICo7XG5cbjpob3N0LWNvbnRleHQoLmlvcykge1xuICAgIGlvbi1mb290ZXIgLnRvb2xiYXI6bGFzdC1jaGlsZCB7XG4gICAgICAgIHBhZGRpbmctYm90dG9tOiA0cHg7XG4gICAgICAgIG1pbi1oZWlnaHQ6IDA7XG4gICAgfVxufVxuXG5pb24tY29udGVudCB7XG4gICAgLS1jb250ZW50LWJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtYWx0ZXJuYXRpdmUpO1xuICAgIC0tYmFja2dyb3VuZDogdmFyKC0tY29udGVudC1iYWNrZ3JvdW5kKTtcblxuICAgICY6OnBhcnQoc2Nyb2xsKSB7XG4gICAgICAgIHBhZGRpbmctYm90dG9tOiAwICFpbXBvcnRhbnQ7XG4gICAgfVxufVxuXG4uYWRkb24tbWVzc2FnZXMtZGlzY3Vzc2lvbi1jb250YWluZXIge1xuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgICBwYWRkaW5nLWJvdHRvbTogMTZweCAhaW1wb3J0YW50O1xuICAgIGJhY2tncm91bmQ6IHZhcigtLWNvbnRlbnQtYmFja2dyb3VuZCk7XG59XG5cbi5hZGRvbi1tZXNzYWdlcy1kYXRlIHtcbiAgICBmb250LXdlaWdodDogbm9ybWFsO1xuICAgIGZvbnQtc2l6ZTogMC45cmVtO1xufVxuIl0sInNvdXJjZVJvb3QiOiIifQ== */\", \"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n[_nghost-%COMP%]   .addon-messages-unreadfrom[_ngcontent-%COMP%] {\\n  color: var(--primary);\\n  background-color: transparent;\\n  margin-top: 6px;\\n  margin-left: auto;\\n  margin-right: auto;\\n}\\n[_nghost-%COMP%]   .addon-messages-unreadfrom[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%] {\\n  color: var(--primary);\\n  background-color: transparent;\\n}\\n[_nghost-%COMP%]   .has-fab[_ngcontent-%COMP%]   .scroll-content[_ngcontent-%COMP%] {\\n  padding-bottom: 0;\\n}\\n[_nghost-%COMP%]   ion-fab[_ngcontent-%COMP%]   .core-discussion-messages-badge[_ngcontent-%COMP%] {\\n  position: absolute;\\n  color: var(--addon-messages-discussion-badge-text);\\n  background-color: var(--addon-messages-discussion-badge);\\n  display: block;\\n  top: 0;\\n}\\n@supports (inset-inline-start: 0) {\\n  [_nghost-%COMP%]   ion-fab[_ngcontent-%COMP%]   .core-discussion-messages-badge[_ngcontent-%COMP%] {\\n    inset-inline-end: 0;\\n  }\\n}\\n@supports not (inset-inline-start: 0) {\\n  [_nghost-%COMP%]   ion-fab[_ngcontent-%COMP%]   .core-discussion-messages-badge[_ngcontent-%COMP%] {\\n    right: 0;\\n  }\\n  [dir=rtl][_nghost-%COMP%]   ion-fab[_ngcontent-%COMP%]   .core-discussion-messages-badge[_ngcontent-%COMP%], [dir=rtl]   [_nghost-%COMP%]   ion-fab[_ngcontent-%COMP%]   .core-discussion-messages-badge[_ngcontent-%COMP%] {\\n    left: unset;\\n    right: unset;\\n    left: 0;\\n  }\\n  [_nghost-%COMP%]   ion-fab[_ngcontent-%COMP%]   .core-discussion-messages-badge[_ngcontent-%COMP%]:dir(rtl) {\\n    left: unset;\\n    right: unset;\\n    left: 0;\\n  }\\n}\\n[_nghost-%COMP%]   ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%] {\\n  padding: 0;\\n}\\n[_nghost-%COMP%]   ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%] {\\n  display: flex;\\n  align-items: center;\\n  padding: 0;\\n}\\n[_nghost-%COMP%]   ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]   .core-bar-button-image[_ngcontent-%COMP%] {\\n  -webkit-margin-end: 6px;\\n  margin-inline-end: 6px;\\n}\\n[_nghost-%COMP%]   ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]   core-format-text[_ngcontent-%COMP%] {\\n  overflow: hidden;\\n  text-overflow: ellipsis;\\n  white-space: nowrap;\\n  flex-shrink: 1;\\n  display: block;\\n}\\n[_nghost-%COMP%]   ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%] {\\n  -webkit-margin-start: 6px;\\n  margin-inline-start: 6px;\\n}\\n\\n.ios[_nghost-%COMP%]   ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], .ios   [_nghost-%COMP%]   ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%] {\\n  justify-content: center;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy90aGVtZS9nbG9iYWxzLnNjc3MiLCJ3ZWJwYWNrOi8vLi9zcmMvdGhlbWUvaGVscGVycy9pb25pYy5mdW5jdGlvbnMuc3RyaW5nLnNjc3MiLCJ3ZWJwYWNrOi8vLi9zcmMvdGhlbWUvaGVscGVycy9pb25pYy5mdW5jdGlvbnMuY29sb3Iuc2NzcyIsIndlYnBhY2s6Ly8uL3NyYy90aGVtZS9oZWxwZXJzL2lvbmljLm1peGlucy5zY3NzIiwid2VicGFjazovLy4vc3JjL3RoZW1lL2hlbHBlcnMvaW9uaWMuY29tcG9uZW50cy5taXhpbnMuc2NzcyIsIndlYnBhY2s6Ly8uL3NyYy90aGVtZS9oZWxwZXJzL2N1c3RvbS5taXhpbnMuc2NzcyIsIndlYnBhY2s6Ly8uL3NyYy90aGVtZS9nbG9iYWxzLmN1c3RvbS5zY3NzIiwid2VicGFjazovLy4vc3JjL3RoZW1lL2dsb2JhbHMudmFyaWFibGVzLnNjc3MiLCJ3ZWJwYWNrOi8vLi9zcmMvYWRkb25zL21lc3NhZ2VzL3BhZ2VzL2Rpc2N1c3Npb24vZGlzY3Vzc2lvbi5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7O0VBQUE7QUNBQTs7Ozs7RUFBQTtBQ0FBOzs7OztFQUFBO0FDQUE7Ozs7O0VBQUE7QUNBQTs7Ozs7O0VBQUE7QUNFQTs7OztFQUFBO0FBNEdBOztFQUFBO0FDOUdBOzs7O0VBQUE7QUNBQTs7OztFQUFBO0FBK0RBOzs7O0VBQUE7QUMzREk7RUFDSSxxQkFBQTtFQUNBLDZCQUFBO0VBQ0EsZUFBQTtFQUNBLGlCQUFBO0VBQ0Esa0JBQUE7QUFrRFI7QUFqRFE7RUFDSSxxQkFBQTtFQUNBLDZCQUFBO0FBbURaO0FBL0NHO0VBQ0ssaUJBQUE7QUFpRFI7QUE5Q0k7RUFDSSxrQkFBQTtFQUNBLGtEQUFBO0VBQ0Esd0RBQUE7RUFDQSxjQUFBO0VMdVlOLE1LdFl3QjtBQWdEMUI7QUxpVE07RUFDRTtJQUVFLG1CS3BXbUI7RUFvRDNCO0FBQ0Y7QUxzVE07RUFDRTtJQUdJLFFLL1dpQjtFQXlEM0I7RUxtSlc7SUFzS0QsV0FBQTtJQUNBLFlBQUE7SUFFQSxPS3JYaUI7RUE4RDNCO0VMNEtXO0lBd0lELFdBQUE7SUFDQSxZQUFBO0lBRUEsT0tyWGlCO0VBbUUzQjtBQUNGO0FBakVJO0VBQ0ksVUFBQTtBQW1FUjtBQWpFUTtFQUNJLGFBQUE7RUFDQSxtQkFBQTtFQUNBLFVBQUE7QUFtRVo7QUFqRVk7RUxtUlIsdUJLbFI2QztFTG1SN0Msc0JLblI2QztBQW9FakQ7QUFqRVk7RUFDSSxnQkFBQTtFQUNBLHVCQUFBO0VBQ0EsbUJBQUE7RUFDQSxjQUFBO0VBQ0EsY0FBQTtBQW1FaEI7QUFoRVk7RUxxUVIseUJLcFF1QztFTHFRdkMsd0JLclF1QztBQW1FM0M7O0FBNURJO0VBQ0ksdUJBQUE7QUErRFIiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEFwcCBHbG9iYWwgdmFyaWFibGVzIFNDU1NcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqIFBsYWNlIGhlcmUgdGhlIGRpZmZlcmVudCBmaWxlcyB5b3Ugc2hvdWxkIGltcG9ydCB0byB1c2UgZ2xvYmFsIHZhcmlhYmxlcy5cbiAqL1xuXG4kZm9udC1wYXRoOiBcIi4uL2Fzc2V0cy9mb250c1wiO1xuJGFzc2V0cy1wYXRoOiBcIi4uL2Fzc2V0c1wiO1xuXG5AaW1wb3J0IFwiLi9oZWxwZXJzL2hlbHBlcnMuc2Nzc1wiO1xuQGltcG9ydCBcIi4vZ2xvYmFscy5jdXN0b20uc2Nzc1wiO1xuQGltcG9ydCBcIi4vZ2xvYmFscy52YXJpYWJsZXMuc2Nzc1wiO1xuIiwiLyoqXG4gKiBJbXBvcnRlZCBpb25pYyBzdHJpbmcgZnVuY3Rpb25zIGZvciBTQ1NTXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiBFeHRyYWN0ZWQgZnJvbVxuICogaHR0cHM6Ly9naXRodWIuY29tL2lvbmljLXRlYW0vaW9uaWMtZnJhbWV3b3JrL2Jsb2IvbWFzdGVyL2NvcmUvc3JjL3RoZW1lcy9pb25pYy5mdW5jdGlvbnMuc3RyaW5nLnNjc3NcbiAqL1xuXG5cbi8vIFN0cmluZyBVdGlsaXR5IEZ1bmN0aW9uc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuLy8gU3RyaW5nIFJlcGxhY2UgRnVuY3Rpb25cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbkBmdW5jdGlvbiBzdHItcmVwbGFjZSgkc3RyaW5nLCAkc2VhcmNoLCAkcmVwbGFjZTogXCJcIikge1xuICAkaW5kZXg6IHN0ci1pbmRleCgkc3RyaW5nLCAkc2VhcmNoKTtcblxuICBAaWYgJGluZGV4IHtcbiAgICBAcmV0dXJuIHN0ci1zbGljZSgkc3RyaW5nLCAxLCAkaW5kZXggLSAxKSArICRyZXBsYWNlICsgc3RyLXJlcGxhY2Uoc3RyLXNsaWNlKCRzdHJpbmcsICRpbmRleCArIHN0ci1sZW5ndGgoJHNlYXJjaCkpLCAkc2VhcmNoLCAkcmVwbGFjZSk7XG4gIH1cblxuICBAcmV0dXJuICRzdHJpbmc7XG59XG5cbi8vIFN0cmluZyBTcGxpdCBGdW5jdGlvblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuXG5AZnVuY3Rpb24gc3RyLXNwbGl0KCRzdHJpbmcsICRzZXBhcmF0b3IpIHtcbiAgLy8gZW1wdHkgYXJyYXkvbGlzdFxuICAkc3BsaXQtYXJyOiAoKTtcbiAgLy8gZmlyc3QgaW5kZXggb2Ygc2VwYXJhdG9yIGluIHN0cmluZ1xuICAkaW5kZXg6IHN0ci1pbmRleCgkc3RyaW5nLCAkc2VwYXJhdG9yKTtcbiAgLy8gbG9vcCB0aHJvdWdoIHN0cmluZ1xuICBAd2hpbGUgJGluZGV4ICE9IG51bGwge1xuICAgIC8vIGdldCB0aGUgc3Vic3RyaW5nIGZyb20gdGhlIGZpcnN0IGNoYXJhY3RlciB0byB0aGUgc2VwYXJhdG9yXG4gICAgJGl0ZW06IHN0ci1zbGljZSgkc3RyaW5nLCAxLCAkaW5kZXggLSAxKTtcbiAgICAvLyBwdXNoIGl0ZW0gdG8gYXJyYXlcbiAgICAkc3BsaXQtYXJyOiBhcHBlbmQoJHNwbGl0LWFyciwgJGl0ZW0pO1xuICAgIC8vIHJlbW92ZSBpdGVtIGFuZCBzZXBhcmF0b3IgZnJvbSBzdHJpbmdcbiAgICAkc3RyaW5nOiBzdHItc2xpY2UoJHN0cmluZywgJGluZGV4ICsgMSk7XG4gICAgLy8gZmluZCBuZXcgaW5kZXggb2Ygc2VwYXJhdG9yXG4gICAgJGluZGV4OiBzdHItaW5kZXgoJHN0cmluZywgJHNlcGFyYXRvcik7XG4gIH1cbiAgLy8gYWRkIHRoZSByZW1haW5pbmcgc3RyaW5nIHRvIGxpc3QgKHRoZSBsYXN0IGl0ZW0pXG4gICRzcGxpdC1hcnI6IGFwcGVuZCgkc3BsaXQtYXJyLCAkc3RyaW5nKTtcblxuICBAcmV0dXJuICRzcGxpdC1hcnI7XG59XG5cblxuLy8gU3RyaW5nIEV4dHJhY3QgRnVuY3Rpb25cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbkBmdW5jdGlvbiBzdHItZXh0cmFjdCgkc3RyaW5nLCAkc3RhcnQsICRlbmQpIHtcbiAgJHN0YXJ0LWluZGV4OiBzdHItaW5kZXgoJHN0cmluZywgJHN0YXJ0KTtcblxuICBAaWYgJHN0YXJ0LWluZGV4IHtcbiAgICAkcG9zdDogc3RyLXNsaWNlKCRzdHJpbmcsICRzdGFydC1pbmRleCArIHN0ci1sZW5ndGgoJHN0YXJ0KSk7XG4gICAgJGVuZC1pbmRleDogc3RyLWluZGV4KCRwb3N0LCAkZW5kKTtcblxuICAgIEBpZiAkZW5kLWluZGV4IHtcbiAgICAgIEByZXR1cm4gc3RyLXNsaWNlKCRwb3N0LCAxLCAkZW5kLWluZGV4IC0gMSk7XG4gICAgfVxuICB9XG5cbiAgQHJldHVybiBudWxsO1xufVxuXG5cbi8vIFN0cmluZyBDb250YWlucyBGdW5jdGlvblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuQGZ1bmN0aW9uIHN0ci1jb250YWlucygkc3RyaW5nLCAkbmVlZGxlKSB7XG4gIEBpZiAodHlwZS1vZigkc3RyaW5nKSA9PSBzdHJpbmcpIHtcbiAgICBAcmV0dXJuIHN0ci1pbmRleCgkc3RyaW5nLCAkbmVlZGxlKSAhPSBudWxsO1xuICB9XG5cbiAgQHJldHVybiBmYWxzZTtcbn1cblxuXG4vLyBVUkwgRW5jb2RlIEZ1bmN0aW9uXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5AZnVuY3Rpb24gdXJsLWVuY29kZSgkdmFsKSB7XG4gICRzcGFjZXM6IHN0ci1yZXBsYWNlKCR2YWwsIFwiIFwiLCBcIiUyMFwiKTtcbiAgJGVuY29kZWQ6IHN0ci1yZXBsYWNlKCRzcGFjZXMsIFwiI1wiLCBcIiUyM1wiKTtcbiAgQHJldHVybiAkZW5jb2RlZDtcbn1cblxuXG4vLyBBZGQgUm9vdCBTZWxlY3RvclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIEFkZHMgYSByb290IHNlbGVjdG9yIHVzaW5nIGhvc3QgYmFzZWQgb24gdGhlIHNlbGVjdG9yIHBhc3NlZFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuQGZ1bmN0aW9uIGFkZC1yb290LXNlbGVjdG9yKCRyb290LCAkYWRkSG9zdFNlbGVjdG9yKSB7XG4gICRzZWxlY3RvcnM6IHN0ci1zcGxpdCgkcm9vdCwgXCIsXCIpO1xuXG4gICRsaXN0OiAoKTtcblxuICBAZWFjaCAkc2VsZWN0b3IgaW4gJHNlbGVjdG9ycyB7XG4gICAgLy8gSWYgdGhlIHNlbGVjdG9yIGNvbnRhaW5zIDpob3N0KCBpdCBtZWFucyBpdCBpcyB0YXJnZXRpbmcgYSBjbGFzcyBvbiB0aGUgaG9zdFxuICAgIC8vIGVsZW1lbnQgc28gd2UgbmVlZCB0byBjaGFuZ2UgaG93IHdlIHRhcmdldCBpdDpcbiAgICAvLyBAaW5jbHVkZSBhZGQtcm9vdC1zZWxlY3RvcihcIjpob3N0KC5maXhlZClcIiwgXCJbZGlyPXJ0bF1cIilcbiAgICAvLyAtLT4gOmhvc3QtY29udGV4dChbZGlyPXJ0bF0pOmhvc3QoLmZpeGVkKVxuICAgIC8vIC0tPiA6aG9zdC1jb250ZXh0KFtkaXI9cnRsXSkuZml4ZWRcbiAgICBAaWYgc3RyLWNvbnRhaW5zKCRzZWxlY3RvciwgXCI6aG9zdChcIikge1xuICAgICAgLy8gQGluY2x1ZGUgYWRkLXJvb3Qtc2VsZWN0b3IoXCI6aG9zdCguZml4ZWQpXCIsIFwiW2Rpcj1ydGxdXCIpXG4gICAgICAvLyAtLT4gOmhvc3QtY29udGV4dChbZGlyPXJ0bF0pOmhvc3QoLmZpeGVkKVxuICAgICAgJHNoYWRvdy1lbGVtZW50OiBzdHItcmVwbGFjZSgkc2VsZWN0b3IsIFwiOmhvc3QoXCIsIFwiOmhvc3QtY29udGV4dCgjeyRhZGRIb3N0U2VsZWN0b3J9KTpob3N0KFwiKTtcbiAgICAgICRsaXN0OiBhcHBlbmQoJGxpc3QsICRzaGFkb3ctZWxlbWVudCwgY29tbWEpO1xuXG4gICAgICAkbmV3LWVsZW1lbnQ6ICgpO1xuICAgICAgJGVsZW1lbnRzOiBzdHItc3BsaXQoJHNlbGVjdG9yLCBcIiBcIik7XG5cbiAgICAgIEBlYWNoICRlbGVtZW50IGluICRlbGVtZW50cyB7XG4gICAgICAgIEBpZiBzdHItY29udGFpbnMoJGVsZW1lbnQsIFwiOmhvc3QoXCIpIHtcbiAgICAgICAgICAkc2NvcGVkLWVsZW1lbnQ6ICRlbGVtZW50O1xuXG4gICAgICAgICAgLy8gUmVwbGFjZSB0aGUgOmhvc3QoIGFuZCApIHNvIGFsbCB3ZSBoYXZlIGxlZnQgaXMgdGhlIGNsYXNzXG4gICAgICAgICAgLy8gaW5zaWRlIG9mIGl0OlxuICAgICAgICAgIC8vIDpob3N0KC5maXhlZCkgLT4gLmZpeGVkXG4gICAgICAgICAgJHNjb3BlZC1lbGVtZW50OiBzdHItcmVwbGFjZSgkc2NvcGVkLWVsZW1lbnQsIFwiKVwiLCBcIlwiKTtcbiAgICAgICAgICAkc2NvcGVkLWVsZW1lbnQ6IHN0ci1yZXBsYWNlKCRzY29wZWQtZWxlbWVudCwgXCI6aG9zdChcIiwgXCJcIik7XG5cbiAgICAgICAgICAvLyBBZGQgdGhlIGNsYXNzIGJhY2sgaW5zaWRlIG9mIGhvc3Qgd2l0aCB0aGUgcnRsIHNlbGVjdG9yOlxuICAgICAgICAgIC8vIC5maXhlZCAtPiA6aG9zdC1jb250ZXh0KFtkaXI9cnRsXSkuZml4ZWRcbiAgICAgICAgICAkc2NvcGVkLWVsZW1lbnQ6IHN0ci1yZXBsYWNlKCRzY29wZWQtZWxlbWVudCwgJHNjb3BlZC1lbGVtZW50LCBcIjpob3N0LWNvbnRleHQoI3skYWRkSG9zdFNlbGVjdG9yfSkjeyRzY29wZWQtZWxlbWVudH1cIik7XG5cbiAgICAgICAgICAvLyBAaW5jbHVkZSBhZGQtcm9vdC1zZWxlY3RvcihcIjpob3N0KC5maXhlZClcIiwgXCJbZGlyPXJ0bF1cIilcbiAgICAgICAgICAvLyAtLT4gOmhvc3QtY29udGV4dChbZGlyPXJ0bF0pLmZpeGVkXG4gICAgICAgICAgJG5ldy1lbGVtZW50OiBhcHBlbmQoJG5ldy1lbGVtZW50LCAkc2NvcGVkLWVsZW1lbnQsIHNwYWNlKTtcbiAgICAgICAgfSBAZWxzZSB7XG4gICAgICAgICAgLy8gQWRkIGJhY2sgYW55IHNlbGVjdG9ycyB0aGF0IGZvbGxvd2VkIHRoZSBob3N0IGFmdGVyIHRyYW5zZm9ybWluZyB0aGVcbiAgICAgICAgICAvLyBmaXJzdCBzZWxlY3RvcjpcbiAgICAgICAgICAvLyA6aG9zdCguZml4ZWQpIDo6c2xvdHRlZChpb24taWNvbilcbiAgICAgICAgICAvLyAtLT4gOmhvc3QtY29udGV4dChbZGlyPXJ0bF0pOmhvc3QoLmZpeGVkKSA6OnNsb3R0ZWQoaW9uLWljb24pXG4gICAgICAgICAgLy8gLS0+IDpob3N0LWNvbnRleHQoW2Rpcj1ydGxdKS5maXhlZCA6OnNsb3R0ZWQoaW9uLWljb24pXG4gICAgICAgICAgJG5ldy1lbGVtZW50OiBhcHBlbmQoJG5ldy1lbGVtZW50LCAkZWxlbWVudCwgc3BhY2UpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgICRsaXN0OiBhcHBlbmQoJGxpc3QsICRuZXctZWxlbWVudCwgY29tbWEpO1xuICAgIC8vIElmIHRoZSBzZWxlY3RvciBjb250YWlucyA6aG9zdCB3aXRob3V0IGEgcGFyYW50aGVzZXNcbiAgICAvLyBpdCBtZWFucyBpdCBpcyB0YXJnZXRpbmcganVzdCB0aGUgaG9zdFxuICAgIC8vIGVsZW1lbnQgc28gd2UgY2FuIGNoYW5nZSBpdCB0byBsb29rIGZvciBob3N0LWNvbnRleHRcbiAgICAvLyBAaW5jbHVkZSBhZGQtcm9vdC1zZWxlY3RvcihcIjpob3N0XCIsIFwiW2Rpcj1ydGxdXCIpXG4gICAgLy8gLS0+IDpob3N0LWNvbnRleHQoW2Rpcj1ydGxdKVxuICAgIC8vIC0tPiA6aG9zdDpkaXIocnRsKVxuICAgIH0gQGVsc2UgaWYgc3RyLWNvbnRhaW5zKCRzZWxlY3RvciwgXCI6aG9zdFwiKSB7XG4gICAgICAkbmV3LWVsZW1lbnQ6ICgpO1xuICAgICAgJGVsZW1lbnRzOiBzdHItc3BsaXQoJHNlbGVjdG9yLCBcIiBcIik7XG5cbiAgICAgIEBlYWNoICRlbGVtZW50IGluICRlbGVtZW50cyB7XG4gICAgICAgIEBpZiBzdHItY29udGFpbnMoJGVsZW1lbnQsIFwiOmhvc3RcIikge1xuICAgICAgICAgIC8vIFJlcGxhY2UgdGhlIDpob3N0IHdpdGggdGhlIGFkZEhvc3RTZWxlY3RvcjpcbiAgICAgICAgICAvLyA6aG9zdCAtPiA6aG9zdC1jb250ZXh0KFtkaXI9cnRsXSlcbiAgICAgICAgICAkdXBkYXRlZC1lbGVtZW50OiBzdHItcmVwbGFjZSgkZWxlbWVudCwgXCI6aG9zdFwiLCBcIjpob3N0LWNvbnRleHQoI3skYWRkSG9zdFNlbGVjdG9yfSlcIik7XG5cbiAgICAgICAgICAvLyBBZGQgdGhlIGZpbmFsIHNlbGVjdG9yIGFmdGVyIGFsbCB0cmFuc2Zvcm1hdGlvbnM6XG4gICAgICAgICAgLy8gOmhvc3QgLT4gOmhvc3QtY29udGV4dChbZGlyPXJ0bF0pXG4gICAgICAgICAgJG5ldy1lbGVtZW50OiBhcHBlbmQoJG5ldy1lbGVtZW50LCAkdXBkYXRlZC1lbGVtZW50LCBzcGFjZSk7XG4gICAgICAgIH0gQGVsc2Uge1xuICAgICAgICAgIC8vIEFkZCBiYWNrIGFueSBzZWxlY3RvcnMgdGhhdCBmb2xsb3dlZCB0aGUgaG9zdCBhZnRlciB0cmFuc2Zvcm1pbmcgdGhlXG4gICAgICAgICAgLy8gZmlyc3Qgc2VsZWN0b3I6XG4gICAgICAgICAgLy8gOmhvc3QgOjpzbG90dGVkKGlvbi1pY29uKSAtPiA6aG9zdC1jb250ZXh0KFtkaXI9cnRsXSkgOjpzbG90dGVkKGlvbi1pY29uKVxuICAgICAgICAgICRuZXctZWxlbWVudDogYXBwZW5kKCRuZXctZWxlbWVudCwgJGVsZW1lbnQsIHNwYWNlKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAkbGlzdDogYXBwZW5kKCRsaXN0LCAkbmV3LWVsZW1lbnQsIGNvbW1hKTtcbiAgICAvLyBJZiB0aGUgc2VsZWN0b3IgZG9lcyBub3QgY29udGFpbiBob3N0IGF0IGFsbCBpdCBpcyBlaXRoZXIgYSBzaGFkb3dcbiAgICAvLyBvciBub3JtYWwgZWxlbWVudCBzbyBhcHBlbmQgYm90aCB0aGUgYWRkSG9zdFNlbGVjdG9yIGFuZCBob3N0LWNvbnRleHRcbiAgICAvLyBAaW5jbHVkZSBhZGQtcm9vdC1zZWxlY3RvcihcImlvbi1jb21wb25lbnRcIiwgXCJbZGlyPXJ0bF1cIilcbiAgICAvLyAtLT4gOmhvc3QtY29udGV4dChbZGlyPXJ0bF0pIGlvbi1jb21wb25lbnRcbiAgICAvLyAtLT4gW2Rpcj1ydGxdIGlvbi1jb21wb25lbnRcbiAgICB9IEBlbHNlIHtcbiAgICAgICRsaXN0OiBhcHBlbmQoJGxpc3QsIFwiI3skYWRkSG9zdFNlbGVjdG9yfSAjeyRzZWxlY3Rvcn1cIiwgY29tbWEpO1xuICAgICAgJGxpc3Q6IGFwcGVuZCgkbGlzdCwgXCI6aG9zdC1jb250ZXh0KCN7JGFkZEhvc3RTZWxlY3Rvcn0pICN7JHNlbGVjdG9yfVwiLCBjb21tYSk7XG4gICAgfVxuICB9XG5cbiAgQHJldHVybiAkbGlzdDtcbn1cbiIsIi8qKlxuICogSW1wb3J0ZWQgaW9uaWMgY29sb3IgZnVuY3Rpb25zIGZvciBTQ1NTXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiBFeHRyYWN0ZWQgZnJvbVxuICogaHR0cHM6Ly9naXRodWIuY29tL2lvbmljLXRlYW0vaW9uaWMtZnJhbWV3b3JrL2Jsb2IvbWFzdGVyL2NvcmUvc3JjL3RoZW1lcy9pb25pYy5mdW5jdGlvbnMuY29sb3Iuc2Nzc1xuICovXG5cbi8vIEdldHMgdGhlIGFjdGl2ZSBjb2xvcidzIGNzcyB2YXJpYWJsZSBmcm9tIGEgdmFyaWF0aW9uLiBBbHBoYSBpcyBvcHRpb25hbC5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBFeGFtcGxlIHVzYWdlOlxuLy8gY3VycmVudC1jb2xvcihiYXNlKSA9PiB2YXIoLS1pb24tY29sb3ItYmFzZSlcbi8vIGN1cnJlbnQtY29sb3IoY29udHJhc3QsIDAuMSkgPT4gcmdiYSh2YXIoLS1pb24tY29sb3ItY29udHJhc3QtcmdiKSwgMC4xKVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbkBmdW5jdGlvbiBjdXJyZW50LWNvbG9yKCR2YXJpYXRpb24sICRhbHBoYTogbnVsbCkge1xuICBAaWYgJGFscGhhID09IG51bGwge1xuICAgIEByZXR1cm4gdmFyKC0taW9uLWNvbG9yLSN7JHZhcmlhdGlvbn0pO1xuICB9IEBlbHNlIHtcbiAgICBAcmV0dXJuIHJnYmEodmFyKC0taW9uLWNvbG9yLSN7JHZhcmlhdGlvbn0tcmdiKSwgI3skYWxwaGF9KTtcbiAgfVxufVxuXG4vLyBHZXRzIHRoZSBzcGVjaWZpYyBjb2xvcidzIGNzcyB2YXJpYWJsZSBmcm9tIHRoZSBuYW1lIGFuZCB2YXJpYXRpb24uIEFscGhhL3JnYiBhcmUgb3B0aW9uYWwuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gRXhhbXBsZSB1c2FnZTpcbi8vIGlvbi1jb2xvcihwcmltYXJ5LCBiYXNlKSA9PiB2YXIoLS1pb24tY29sb3ItcHJpbWFyeSwgIzM4ODBmZilcbi8vIGlvbi1jb2xvcihzZWNvbmRhcnksIGNvbnRyYXN0KSA9PiB2YXIoLS1pb24tY29sb3Itc2Vjb25kYXJ5LWNvbnRyYXN0KVxuLy8gaW9uLWNvbG9yKHByaW1hcnksIGJhc2UsIDAuNSkgPT4gcmdiYSh2YXIoLS1pb24tY29sb3ItcHJpbWFyeS1yZ2IsIDU2LCAxMjgsIDI1NSksIDAuNSlcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5AZnVuY3Rpb24gaW9uLWNvbG9yKCRuYW1lLCAkdmFyaWF0aW9uLCAkYWxwaGE6IG51bGwsICRyZ2I6IG51bGwpIHtcbiAgJHZhbHVlczogbWFwLWdldCgkY29sb3JzLCAkbmFtZSk7XG4gICR2YWx1ZTogbWFwLWdldCgkdmFsdWVzLCAkdmFyaWF0aW9uKTtcbiAgJHZhcmlhYmxlOiAtLWlvbi1jb2xvci0jeyRuYW1lfS0jeyR2YXJpYXRpb259O1xuXG4gIEBpZiAoJHZhcmlhdGlvbiA9PSBiYXNlKSB7XG4gICAgJHZhcmlhYmxlOiAtLWlvbi1jb2xvci0jeyRuYW1lfTtcbiAgfVxuXG4gIEBpZiAoJGFscGhhKSB7XG4gICAgJHZhbHVlOiBjb2xvci10by1yZ2ItbGlzdCgkdmFsdWUpO1xuICAgIEByZXR1cm4gcmdiYSh2YXIoI3skdmFyaWFibGV9LXJnYiwgJHZhbHVlKSwgJGFscGhhKTtcbiAgfVxuICBAaWYgKCRyZ2IpIHtcbiAgICAkdmFsdWU6IGNvbG9yLXRvLXJnYi1saXN0KCR2YWx1ZSk7XG4gICAgJHZhcmlhYmxlOiAjeyR2YXJpYWJsZX0tcmdiO1xuICB9XG5cbiAgQHJldHVybiB2YXIoI3skdmFyaWFibGV9LCAkdmFsdWUpO1xufVxuXG4vLyBNaXhlcyBhIGNvbG9yIHdpdGggYmxhY2sgdG8gY3JlYXRlIGl0cyBzaGFkZS5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5AZnVuY3Rpb24gZ2V0LWNvbG9yLXNoYWRlKCRjb2xvcikge1xuICBAcmV0dXJuIG1peCgjMDAwLCAkY29sb3IsIDEyJSk7XG59XG5cbi8vIE1peGVzIGEgY29sb3Igd2l0aCB3aGl0ZSB0byBjcmVhdGUgaXRzIHRpbnQuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQGZ1bmN0aW9uIGdldC1jb2xvci10aW50KCRjb2xvcikge1xuICBAcmV0dXJuIG1peCgjZmZmLCAkY29sb3IsIDEwJSk7XG59XG5cbi8vIENvbnZlcnRzIGEgY29sb3IgdG8gYSBjb21tYSBzZXBhcmF0ZWQgcmdiLlxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbkBmdW5jdGlvbiBjb2xvci10by1yZ2ItbGlzdCgkY29sb3IpIHtcbiAgQHJldHVybiAje3JlZCgkY29sb3IpfSwje2dyZWVuKCRjb2xvcil9LCN7Ymx1ZSgkY29sb3IpfTtcbn1cbiIsIi8qKlxuICogSW1wb3J0ZWQgaW9uaWMgbWl4aW5zIGZvciBTQ1NTXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiBFeHRyYWN0ZWQgZnJvbVxuICogaHR0cHM6Ly9naXRodWIuY29tL2lvbmljLXRlYW0vaW9uaWMtZnJhbWV3b3JrL2Jsb2IvbWFzdGVyL2NvcmUvc3JjL3RoZW1lcy9pb25pYy5taXhpbnMuc2Nzc1xuICovXG5cbkBtaXhpbiBpbnB1dC1jb3ZlcigpIHtcbiAgQGluY2x1ZGUgcG9zaXRpb24oMCwgbnVsbCwgbnVsbCwgMCk7XG4gIEBpbmNsdWRlIG1hcmdpbigwKTtcblxuICBwb3NpdGlvbjogYWJzb2x1dGU7XG5cbiAgd2lkdGg6IDEwMCU7XG4gIGhlaWdodDogMTAwJTtcblxuICBib3JkZXI6IDA7XG4gIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50O1xuICBjdXJzb3I6IHBvaW50ZXI7XG5cbiAgYXBwZWFyYW5jZTogbm9uZTtcbiAgb3V0bGluZTogbm9uZTtcblxuICAmOjotbW96LWZvY3VzLWlubmVyIHtcbiAgICBib3JkZXI6IDA7XG4gIH1cbn1cblxuQG1peGluIHZpc3VhbGx5LWhpZGRlbigpIHtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuXG4gIHRvcDogMDtcbiAgbGVmdDogMDtcbiAgcmlnaHQ6IDA7XG4gIGJvdHRvbTogMDtcblxuICB3aWR0aDogMTAwJTtcbiAgaGVpZ2h0OiAxMDAlO1xuXG4gIG1hcmdpbjogMDtcbiAgcGFkZGluZzogMDtcblxuICBib3JkZXI6IDA7XG4gIG91dGxpbmU6IDA7XG4gIGNsaXA6IHJlY3QoMCAwIDAgMCk7XG5cbiAgb3BhY2l0eTogMDtcbiAgb3ZlcmZsb3c6IGhpZGRlbjtcblxuICAtd2Via2l0LWFwcGVhcmFuY2U6IG5vbmU7XG4gIC1tb3otYXBwZWFyYW5jZTogbm9uZTtcbn1cblxuQG1peGluIHRleHQtaW5oZXJpdCgpIHtcbiAgZm9udC1mYW1pbHk6IGluaGVyaXQ7XG4gIGZvbnQtc2l6ZTogaW5oZXJpdDtcbiAgZm9udC1zdHlsZTogaW5oZXJpdDtcbiAgZm9udC13ZWlnaHQ6IGluaGVyaXQ7XG4gIGxldHRlci1zcGFjaW5nOiBpbmhlcml0O1xuICB0ZXh0LWRlY29yYXRpb246IGluaGVyaXQ7XG4gIHRleHQtaW5kZW50OiBpbmhlcml0O1xuICB0ZXh0LW92ZXJmbG93OiBpbmhlcml0O1xuICB0ZXh0LXRyYW5zZm9ybTogaW5oZXJpdDtcbiAgdGV4dC1hbGlnbjogaW5oZXJpdDtcbiAgd2hpdGUtc3BhY2U6IGluaGVyaXQ7XG4gIGNvbG9yOiBpbmhlcml0O1xufVxuXG5AbWl4aW4gYnV0dG9uLXN0YXRlKCkge1xuICBAaW5jbHVkZSBwb3NpdGlvbigwLCAwLCAwLCAwKTtcblxuICBwb3NpdGlvbjogYWJzb2x1dGU7XG5cbiAgY29udGVudDogXCJcIjtcblxuICBvcGFjaXR5OiAwO1xufVxuXG4vLyBGb250IHNtb290aGluZ1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuQG1peGluIGZvbnQtc21vb3RoaW5nKCkge1xuICAtbW96LW9zeC1mb250LXNtb290aGluZzogZ3JheXNjYWxlO1xuICAtd2Via2l0LWZvbnQtc21vb3RoaW5nOiBhbnRpYWxpYXNlZDtcbn1cblxuLy8gR2V0IHRoZSBrZXkgZnJvbSBhIG1hcCBiYXNlZCBvbiB0aGUgaW5kZXhcbkBmdW5jdGlvbiBpbmRleC10by1rZXkoJG1hcCwgJGluZGV4KSB7XG4gICRrZXlzOiBtYXAta2V5cygkbWFwKTtcblxuICBAcmV0dXJuIG50aCgka2V5cywgJGluZGV4KTtcbn1cblxuXG4vLyBCcmVha3BvaW50IE1peGluc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbi8vIEJyZWFrcG9pbnQgdmlld3BvcnQgc2l6ZXMgYW5kIG1lZGlhIHF1ZXJpZXMuXG4vL1xuLy8gQnJlYWtwb2ludHMgYXJlIGRlZmluZWQgYXMgYSBtYXAgb2YgKG5hbWU6IG1pbmltdW0gd2lkdGgpLCBvcmRlciBmcm9tIHNtYWxsIHRvIGxhcmdlOlxuLy9cbi8vICAgICh4czogMCwgc206IDU3NnB4LCBtZDogNzY4cHgsIGxnOiA5OTJweCwgeGw6IDEyMDBweClcbi8vXG4vLyBUaGUgbWFwIGRlZmluZWQgaW4gdGhlIGAkc2NyZWVuLWJyZWFrcG9pbnRzYCBnbG9iYWwgdmFyaWFibGUgaXMgdXNlZCBhcyB0aGUgYCRicmVha3BvaW50c2AgYXJndW1lbnQgYnkgZGVmYXVsdC5cblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbi8vIE1pbmltdW0gYnJlYWtwb2ludCB3aWR0aC4gTnVsbCBmb3IgdGhlIHNtYWxsZXN0IChmaXJzdCkgYnJlYWtwb2ludC5cbi8vXG4vLyAgICA+PiBicmVha3BvaW50LW1pbihzbSwgKHhzOiAwLCBzbTogNTc2cHgsIG1kOiA3NjhweCwgbGc6IDk5MnB4LCB4bDogMTIwMHB4KSlcbi8vICAgIDU3NnB4XG5AZnVuY3Rpb24gYnJlYWtwb2ludC1taW4oJG5hbWUsICRicmVha3BvaW50czogJHNjcmVlbi1icmVha3BvaW50cykge1xuICAkbWluOiBtYXAtZ2V0KCRicmVha3BvaW50cywgJG5hbWUpO1xuXG4gIEByZXR1cm4gaWYoJG5hbWUgIT0gaW5kZXgtdG8ta2V5KCRicmVha3BvaW50cywgMSksICRtaW4sIG51bGwpO1xufVxuXG4vLyBSZXR1cm5zIGEgYmxhbmsgc3RyaW5nIGlmIHNtYWxsZXN0IGJyZWFrcG9pbnQsIG90aGVyd2lzZSByZXR1cm5zIHRoZSBuYW1lIHdpdGggYSBkYXNoIGluZnJvbnQuXG4vLyBVc2VmdWwgZm9yIG1ha2luZyByZXNwb25zaXZlIHV0aWxpdGllcy5cbi8vXG4vLyAgICA+PiBicmVha3BvaW50LWluZml4KHhzLCAoeHM6IDAsIHNtOiA1NzZweCwgbWQ6IDc2OHB4LCBsZzogOTkycHgsIHhsOiAxMjAwcHgpKVxuLy8gICAgXCJcIiAgKFJldHVybnMgYSBibGFuayBzdHJpbmcpXG4vLyAgICA+PiBicmVha3BvaW50LWluZml4KHNtLCAoeHM6IDAsIHNtOiA1NzZweCwgbWQ6IDc2OHB4LCBsZzogOTkycHgsIHhsOiAxMjAwcHgpKVxuLy8gICAgXCItc21cIlxuQGZ1bmN0aW9uIGJyZWFrcG9pbnQtaW5maXgoJG5hbWUsICRicmVha3BvaW50czogJHNjcmVlbi1icmVha3BvaW50cykge1xuICBAcmV0dXJuIGlmKGJyZWFrcG9pbnQtbWluKCRuYW1lLCAkYnJlYWtwb2ludHMpID09IG51bGwsIFwiXCIsIFwiLSN7JG5hbWV9XCIpO1xufVxuXG4vLyBNZWRpYSBvZiBhdCBsZWFzdCB0aGUgbWluaW11bSBicmVha3BvaW50IHdpZHRoLiBObyBxdWVyeSBmb3IgdGhlIHNtYWxsZXN0IGJyZWFrcG9pbnQuXG4vLyBNYWtlcyB0aGUgQGNvbnRlbnQgYXBwbHkgdG8gdGhlIGdpdmVuIGJyZWFrcG9pbnQgYW5kIHdpZGVyLlxuQG1peGluIG1lZGlhLWJyZWFrcG9pbnQtdXAoJG5hbWUsICRicmVha3BvaW50czogJHNjcmVlbi1icmVha3BvaW50cykge1xuICAkbWluOiBicmVha3BvaW50LW1pbigkbmFtZSwgJGJyZWFrcG9pbnRzKTtcbiAgQGlmICRtaW4ge1xuICAgIEBtZWRpYSAobWluLXdpZHRoOiAkbWluKSB7XG4gICAgICBAY29udGVudDtcbiAgICB9XG4gIH0gQGVsc2Uge1xuICAgIEBjb250ZW50O1xuICB9XG59XG5cbi8vIE5hbWUgb2YgdGhlIG5leHQgYnJlYWtwb2ludCwgb3IgbnVsbCBmb3IgdGhlIGxhc3QgYnJlYWtwb2ludC5cbi8vXG4vLyAgICA+PiBicmVha3BvaW50LW5leHQoc20pXG4vLyAgICBtZFxuLy8gICAgPj4gYnJlYWtwb2ludC1uZXh0KHNtLCAoeHM6IDAsIHNtOiA1NzZweCwgbWQ6IDc2OHB4LCBsZzogOTkycHgsIHhsOiAxMjAwcHgpKVxuLy8gICAgbWRcbi8vICAgID4+IGJyZWFrcG9pbnQtbmV4dChzbSwgJGJyZWFrcG9pbnQtbmFtZXM6ICh4cyBzbSBtZCBsZyB4bCkpXG4vLyAgICBtZFxuQGZ1bmN0aW9uIGJyZWFrcG9pbnQtbmV4dCgkbmFtZSwgJGJyZWFrcG9pbnRzOiAkc2NyZWVuLWJyZWFrcG9pbnRzLCAkYnJlYWtwb2ludC1uYW1lczogbWFwLWtleXMoJGJyZWFrcG9pbnRzKSkge1xuICAkbjogaW5kZXgoJGJyZWFrcG9pbnQtbmFtZXMsICRuYW1lKTtcbiAgQHJldHVybiBpZigkbiA8IGxlbmd0aCgkYnJlYWtwb2ludC1uYW1lcyksIG50aCgkYnJlYWtwb2ludC1uYW1lcywgJG4gKyAxKSwgbnVsbCk7XG59XG5cbi8vIE1heGltdW0gYnJlYWtwb2ludCB3aWR0aC4gTnVsbCBmb3IgdGhlIHNtYWxsZXN0IChmaXJzdCkgYnJlYWtwb2ludC5cbi8vIFRoZSBtYXhpbXVtIHZhbHVlIGlzIHJlZHVjZWQgYnkgMC4wMnB4IHRvIHdvcmsgYXJvdW5kIHRoZSBsaW1pdGF0aW9ucyBvZlxuLy8gYG1pbi1gIGFuZCBgbWF4LWAgcHJlZml4ZXMgYW5kIHZpZXdwb3J0cyB3aXRoIGZyYWN0aW9uYWwgd2lkdGhzLlxuLy9cbi8vIFNlZSBodHRwczovL3d3dy53My5vcmcvVFIvbWVkaWFxdWVyaWVzLTQvI21xLW1pbi1tYXhcbi8vIFVzZXMgMC4wMnB4IHJhdGhlciB0aGFuIDAuMDFweCB0byB3b3JrIGFyb3VuZCBhIGN1cnJlbnQgcm91bmRpbmcgYnVnIGluIFNhZmFyaS5cdC8vIFVzZXMgMC4wMnB4IHJhdGhlciB0aGFuIDAuMDFweCB0byB3b3JrIGFyb3VuZCBhIGN1cnJlbnQgcm91bmRpbmcgYnVnIGluIFNhZmFyaS5cbi8vIFNlZSBodHRwczovL2J1Z3Mud2Via2l0Lm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MTc4MjYxXHQvLyBTZWUgaHR0cHM6Ly9idWdzLndlYmtpdC5vcmcvc2hvd19idWcuY2dpP2lkPTE3ODI2MVxuLy9cbi8vICAgID4+IGJyZWFrcG9pbnQtbWF4KG1kLCAoeHM6IDAsIHNtOiA1NzZweCwgbWQ6IDc2OHB4LCBsZzogOTkycHgsIHhsOiAxMjAwcHgpKVxuLy8gICAgNzY3Ljk4cHhcbkBmdW5jdGlvbiBicmVha3BvaW50LW1heCgkbmFtZSwgJGJyZWFrcG9pbnRzOiAkc2NyZWVuLWJyZWFrcG9pbnRzKSB7XG4gICRtYXg6IG1hcC1nZXQoJGJyZWFrcG9pbnRzLCAkbmFtZSk7XG4gIEByZXR1cm4gaWYoJG1heCBhbmQgJG1heCA+IDAsICRtYXggLSAuMDIsIG51bGwpO1xufVxuXG4vLyBNZWRpYSBvZiBhdCBtb3N0IHRoZSBtYXhpbXVtIGJyZWFrcG9pbnQgd2lkdGguIE5vIHF1ZXJ5IGZvciB0aGUgbGFyZ2VzdCBicmVha3BvaW50LlxuLy8gTWFrZXMgdGhlIEBjb250ZW50IGFwcGx5IHRvIHRoZSBnaXZlbiBicmVha3BvaW50IGFuZCBuYXJyb3dlci5cbkBtaXhpbiBtZWRpYS1icmVha3BvaW50LWRvd24oJG5hbWUsICRicmVha3BvaW50czogJHNjcmVlbi1icmVha3BvaW50cykge1xuICAkbWF4OiBicmVha3BvaW50LW1heCgkbmFtZSwgJGJyZWFrcG9pbnRzKTtcbiAgQGlmICRtYXgge1xuICAgIEBtZWRpYSAobWF4LXdpZHRoOiAkbWF4KSB7XG4gICAgICBAY29udGVudDtcbiAgICB9XG4gIH0gQGVsc2Uge1xuICAgIEBjb250ZW50O1xuICB9XG59XG5cblxuLy8gVGV4dCBEaXJlY3Rpb24gLSBsdHIgLyBydGxcbi8vXG4vLyBDU1MgZGVmYXVsdHMgdG8gdXNlIHRoZSBsdHIgY3NzLCBhbmQgYWRkcyBbZGlyPXJ0bF0gc2VsZWN0b3JzXG4vLyB0byBvdmVycmlkZSBsdHIgZGVmYXVsdHMuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbkBtaXhpbiBtdWx0aS1kaXIoKSB7XG4gIEBjb250ZW50O1xuXG4gIC8vICRyb290OiAjeyZ9O1xuICAvLyBAYXQtcm9vdCBbZGlyXSB7XG4gIC8vICAgI3skcm9vdH0ge1xuICAvLyAgICAgQGNvbnRlbnQ7XG4gIC8vICAgfVxuICAvLyB9XG59XG5cbkBtaXhpbiBydGwoKSB7XG4gICRyb290OiAjeyZ9O1xuXG4gICRyb290U3BsaXQ6IHN0ci1zcGxpdCgkcm9vdCwgXCIsXCIpO1xuICAkc2VsZWN0b3JzOiAje2FkZC1yb290LXNlbGVjdG9yKCRyb290LCBcIltkaXI9cnRsXVwiKX07XG4gICRzZWxlY3RvcnNTcGxpdDogc3RyLXNwbGl0KCRzZWxlY3RvcnMsIFwiLFwiKTtcblxuICAkaG9zdENvbnRleHRTZWxlY3RvcnM6ICgpO1xuICAkcmVzdFNlbGVjdG9yczogKCk7XG4gICRkaXJTZWxlY3RvcnM6ICgpO1xuXG4gIC8vIFNlbGVjdG9ycyBtdXN0IGJlIHNwbGl0IGludG8gaW5kaXZpZHVhbCBzZWxlY3RvcnMgaW4gY2FzZSB0aGUgYnJvd3NlclxuICAvLyBkb2Vzbid0IHN1cHBvcnQgYSBzcGVjaWZpYyBzZWxlY3Rvci5cbiAgLy8gRm9yIGV4YW1wbGUsIEZpcmVmb3ggYW5kIFNhZmFyaSBkb2Vzbid0IHN1cHBvcnQgYDpob3N0LWNvbnRleHQoKWAuXG4gIC8vIElmIGFuIGludmFsaWQgc2VsZWN0b3IgaXMgdXNlZCwgdGhlbiB0aGUgZW50aXJlIGdyb3VwIG9mIHNlbGVjdG9yc1xuICAvLyB3aWxsIGJlIGlnbm9yZWQuXG4gIC8vIEBsaW5rIGh0dHBzOi8vd3d3LnczLm9yZy9UUi9zZWxlY3RvcnMtMy8jZ3JvdXBpbmdcbiAgQGVhY2ggJHNlbGVjdG9yIGluICRzZWxlY3RvcnNTcGxpdCB7XG4gICAgLy8gR3JvdXAgdGhlIHNlbGVjdG9ycyBiYWNrIGludG8gYSBzaW5nbGUgc2VsZWN0b3IgdG8gb3B0aW1pemUgdGhlIG91dHB1dC5cbiAgICBAaWYgc3RyLWluZGV4KCRzZWxlY3RvciwgXCI6aG9zdC1jb250ZXh0XCIpIHtcbiAgICAgICRob3N0Q29udGV4dFNlbGVjdG9yczogYXBwZW5kKCRob3N0Q29udGV4dFNlbGVjdG9ycywgJHNlbGVjdG9yLCBjb21tYSk7XG4gICAgfSBAZWxzZSB7XG4gICAgICAvLyBHcm91cCB0aGUgc2VsZWN0b3JzIGJhY2sgaW50byBhIHNpbmdsZSBzZWxlY3RvciB0byBvcHRpbWl6ZSB0aGUgb3V0cHV0LlxuICAgICAgJHJlc3RTZWxlY3RvcnM6IGFwcGVuZCgkcmVzdFNlbGVjdG9ycywgJHNlbGVjdG9yLCBjb21tYSk7XG4gICAgfVxuICB9XG5cbiAgLy8gU3VwcG9ydGVkIGJ5IENocm9tZS5cbiAgQGlmIGxlbmd0aCgkaG9zdENvbnRleHRTZWxlY3RvcnMpID4gMCB7XG4gICAgQGF0LXJvb3QgI3skaG9zdENvbnRleHRTZWxlY3RvcnN9IHtcbiAgICAgIEBjb250ZW50O1xuICAgIH1cbiAgfVxuXG4gIC8vIFN1cHBvcnRlZCBieSBhbGwgYnJvd3NlcnMuXG4gIEBpZiBsZW5ndGgoJHJlc3RTZWxlY3RvcnMpID4gMCB7XG4gICAgQGF0LXJvb3QgI3skcmVzdFNlbGVjdG9yc30ge1xuICAgICAgQGNvbnRlbnQ7XG4gICAgfVxuICB9XG5cbiAgLy8gSWYgYnJvd3NlciBjYW4gc3VwcG9ydCBgOmRpcigpYCwgdGhlbiBhZGQgdGhlIGA6ZGlyKClgIHNlbGVjdG9ycy5cbiAgLy8gQHN1cHBvcnRzIHNlbGVjdG9yKDpkaXIocnRsKSkgeyAvLyBAIElNUE9UQU5UIE5PVEU6IFRoaXMgaGFzIGJlZW4gcmVtb3ZlZCBiZWNhdXNlIHNlbGVjdG9yIGZ1bmN0aW9uIGlzIG5vdCBzdXBwb3J0ZWQgaW4gY3VycmVudCBTQ1NTXG4gIC8vIEFkZGluZyA6ZGlyKCkgaW4gY2FzZSB0aGUgYnJvd3NlciBkb2Vzbid0IHN1cHBvcnQgYDpob3N0LWNvbnRleHQoKWAgYW5kIGRvZXMgc3VwcG9ydCBgOmRpcigpYC5cbiAgLy8gYDpob3N0LWNvbnRleHQoKWAgaXMgYWRkZWQ6XG4gIC8vIC0gdGhyb3VnaCB0aGUgYGFkZC1yb290LXNlbGVjdG9yKClgIGZ1bmN0aW9uLlxuICAvLyAtIGZpcnN0IHNvIHRoYXQgaXQgdGFrZXMgcHJlY2VkZW5jZSBvdmVyIGA6ZGlyKClgLlxuICAvLyBGb3IgZXhhbXBsZSxcbiAgLy8gLSBGaXJlZm94IGRvZXNuJ3Qgc3VwcG9ydCBgOmhvc3QtY29udGV4dCgpYCwgYnV0IGRvZXMgc3VwcG9ydCBgOmRpcigpYC5cbiAgLy8gLSBTYWZhcmkgZG9lc24ndCBzdXBwb3J0IGA6aG9zdC1jb250ZXh0KClgLCBidXQgU2FmYXJpIDE2LjQrIHN1cHBvcnRzIGA6ZGlyKClgXG4gIC8vIEBsaW5rIGh0dHBzOi8vd2Via2l0Lm9yZy9ibG9nLzEzOTY2L3dlYmtpdC1mZWF0dXJlcy1pbi1zYWZhcmktMTYtNC9cbiAgQGVhY2ggJHNlbGVjdG9yIGluICRyb290U3BsaXQge1xuICAgICRkaXJTZWxlY3RvcjogXCIjeyRzZWxlY3Rvcn06ZGlyKHJ0bClcIjtcbiAgICAvLyBHcm91cCB0aGUgc2VsZWN0b3JzIGJhY2sgaW50byBhIHNpbmdsZSBzZWxlY3RvciB0byBvcHRpbWl6ZSB0aGUgb3V0cHV0LlxuICAgICRkaXJTZWxlY3RvcnM6IGFwcGVuZCgkZGlyU2VsZWN0b3JzLCAkZGlyU2VsZWN0b3IsIGNvbW1hKTtcbiAgfVxuXG4gIC8vIFN1cHBvcnRlZCBieSBGaXJlZm94LlxuICBAaWYgbGVuZ3RoKCRkaXJTZWxlY3RvcnMpID4gMCB7XG4gICAgQGF0LXJvb3QgI3skZGlyU2VsZWN0b3JzfSB7XG4gICAgICBAY29udGVudDtcbiAgICB9XG4gIH1cbiAgLy99XG59XG5cbkBtaXhpbiBsdHIoKSB7XG4gIEBjb250ZW50O1xufVxuXG5cbi8vIFNWRyBCYWNrZ3JvdW5kIEltYWdlIE1peGluXG4vLyBAcGFyYW0ge3N0cmluZ30gJHN2Z1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQG1peGluIHN2Zy1iYWNrZ3JvdW5kLWltYWdlKCRzdmcsICRmbGlwLXJ0bDogZmFsc2UpIHtcbiAgJHVybDogdXJsLWVuY29kZSgkc3ZnKTtcbiAgJHZpZXdCb3g6IHN0ci1zcGxpdChzdHItZXh0cmFjdCgkc3ZnLCBcInZpZXdCb3g9J1wiLCBcIidcIiksIFwiIFwiKTtcblxuICBAaWYgJGZsaXAtcnRsICE9IHRydWUgb3IgJHZpZXdCb3ggPT0gbnVsbCB7XG4gICAgQGluY2x1ZGUgbXVsdGktZGlyKCkge1xuICAgICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKFwiZGF0YTppbWFnZS9zdmcreG1sO2NoYXJzZXQ9dXRmLTgsI3skdXJsfVwiKTtcbiAgICB9XG4gIH0gQGVsc2Uge1xuICAgICR0cmFuc2Zvcm06IFwidHJhbnNmb3JtPSd0cmFuc2xhdGUoI3tudGgoJHZpZXdCb3gsIDMpfSwgMCkgc2NhbGUoLTEsIDEpJ1wiO1xuICAgICRmbGlwcGVkLXVybDogJHN2ZztcbiAgICAkZmxpcHBlZC11cmw6IHN0ci1yZXBsYWNlKCRmbGlwcGVkLXVybCwgXCI8cGF0aFwiLCBcIjxwYXRoICN7JHRyYW5zZm9ybX1cIik7XG4gICAgJGZsaXBwZWQtdXJsOiBzdHItcmVwbGFjZSgkZmxpcHBlZC11cmwsIFwiPGxpbmVcIiwgXCI8bGluZSAjeyR0cmFuc2Zvcm19XCIpO1xuICAgICRmbGlwcGVkLXVybDogc3RyLXJlcGxhY2UoJGZsaXBwZWQtdXJsLCBcIjxwb2x5Z29uXCIsIFwiPHBvbHlnb24gI3skdHJhbnNmb3JtfVwiKTtcbiAgICAkZmxpcHBlZC11cmw6IHVybC1lbmNvZGUoJGZsaXBwZWQtdXJsKTtcblxuICAgIEBpbmNsdWRlIGx0ciAoKSB7XG4gICAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoXCJkYXRhOmltYWdlL3N2Zyt4bWw7Y2hhcnNldD11dGYtOCwjeyR1cmx9XCIpO1xuICAgIH1cbiAgICBAaW5jbHVkZSBydGwoKSB7XG4gICAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoXCJkYXRhOmltYWdlL3N2Zyt4bWw7Y2hhcnNldD11dGYtOCwjeyRmbGlwcGVkLXVybH1cIik7XG4gICAgfVxuICB9XG59XG5cbi8vIEFkZCBwcm9wZXJ0eSBob3Jpem9udGFsXG4vLyBAcGFyYW0ge3N0cmluZ30gJHN0YXJ0XG4vLyBAcGFyYW0ge3N0cmluZ30gJGVuZFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQG1peGluIHByb3BlcnR5LWhvcml6b250YWwoJHByb3AsICRzdGFydCwgJGVuZDogJHN0YXJ0KSB7XG4gIEBpZiAkc3RhcnQgPT0gMCBhbmQgJGVuZCA9PSAwIHtcbiAgICAjeyRwcm9wfS1sZWZ0OiAkc3RhcnQ7XG4gICAgI3skcHJvcH0tcmlnaHQ6ICRlbmQ7XG5cbiAgfSBAZWxzZSB7XG4gICAgLXdlYmtpdC0jeyRwcm9wfS1zdGFydDogJHN0YXJ0O1xuICAgICN7JHByb3B9LWlubGluZS1zdGFydDogJHN0YXJ0O1xuICAgIC13ZWJraXQtI3skcHJvcH0tZW5kOiAkZW5kO1xuICAgICN7JHByb3B9LWlubGluZS1lbmQ6ICRlbmQ7XG4gIH1cbn1cblxuLy8gQWRkIHByb3BlcnR5IGZvciBhbGwgZGlyZWN0aW9uc1xuLy8gQHBhcmFtIHtzdHJpbmd9ICRwcm9wXG4vLyBAcGFyYW0ge3N0cmluZ30gJHRvcFxuLy8gQHBhcmFtIHtzdHJpbmd9ICRlbmRcbi8vIEBwYXJhbSB7c3RyaW5nfSAkYm90dG9tXG4vLyBAcGFyYW0ge3N0cmluZ30gJHN0YXJ0XG4vLyBAcGFyYW0ge2Jvb2xlYW59ICRjb250ZW50IGluY2x1ZGUgY29udGVudCBvciB1c2UgZGVmYXVsdFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQG1peGluIHByb3BlcnR5KCRwcm9wLCAkdG9wLCAkZW5kOiAkdG9wLCAkYm90dG9tOiAkdG9wLCAkc3RhcnQ6ICRlbmQpIHtcbiAgQGluY2x1ZGUgcHJvcGVydHktaG9yaXpvbnRhbCgkcHJvcCwgJHN0YXJ0LCAkZW5kKTtcbiAgI3skcHJvcH0tdG9wOiAkdG9wO1xuICAjeyRwcm9wfS1ib3R0b206ICRib3R0b207XG59XG5cbi8vIEFkZCBwYWRkaW5nIGhvcml6b250YWxcbi8vIEBwYXJhbSB7c3RyaW5nfSAkc3RhcnRcbi8vIEBwYXJhbSB7c3RyaW5nfSAkZW5kXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5AbWl4aW4gcGFkZGluZy1ob3Jpem9udGFsKCRzdGFydCwgJGVuZDogJHN0YXJ0KSB7XG4gIEBpbmNsdWRlIHByb3BlcnR5LWhvcml6b250YWwocGFkZGluZywgJHN0YXJ0LCAkZW5kKTtcbn1cblxuLy8gQWRkIHBhZGRpbmcgZm9yIGFsbCBkaXJlY3Rpb25zXG4vLyBAcGFyYW0ge3N0cmluZ30gJHRvcFxuLy8gQHBhcmFtIHtzdHJpbmd9ICRlbmRcbi8vIEBwYXJhbSB7c3RyaW5nfSAkYm90dG9tXG4vLyBAcGFyYW0ge3N0cmluZ30gJHN0YXJ0XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5AbWl4aW4gcGFkZGluZygkdG9wLCAkZW5kOiAkdG9wLCAkYm90dG9tOiAkdG9wLCAkc3RhcnQ6ICRlbmQpIHtcbiAgQGluY2x1ZGUgcHJvcGVydHkocGFkZGluZywgJHRvcCwgJGVuZCwgJGJvdHRvbSwgJHN0YXJ0KTtcbn1cblxuLy8gQWRkIG1hcmdpbiBob3Jpem9udGFsXG4vLyBAcGFyYW0ge3N0cmluZ30gJHN0YXJ0XG4vLyBAcGFyYW0ge3N0cmluZ30gJGVuZFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQG1peGluIG1hcmdpbi1ob3Jpem9udGFsKCRzdGFydCwgJGVuZDogJHN0YXJ0KSB7XG4gIEBpbmNsdWRlIHByb3BlcnR5LWhvcml6b250YWwobWFyZ2luLCAkc3RhcnQsICRlbmQpO1xufVxuXG4vLyBBZGQgbWFyZ2luIGZvciBhbGwgZGlyZWN0aW9uc1xuLy8gQHBhcmFtIHtzdHJpbmd9ICR0b3Bcbi8vIEBwYXJhbSB7c3RyaW5nfSAkZW5kXG4vLyBAcGFyYW0ge3N0cmluZ30gJGJvdHRvbVxuLy8gQHBhcmFtIHtzdHJpbmd9ICRzdGFydFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQG1peGluIG1hcmdpbigkdG9wLCAkZW5kOiAkdG9wLCAkYm90dG9tOiAkdG9wLCAkc3RhcnQ6ICRlbmQpIHtcbiAgQGluY2x1ZGUgcHJvcGVydHkobWFyZ2luLCAkdG9wLCAkZW5kLCAkYm90dG9tLCAkc3RhcnQpO1xufVxuXG4vLyBBZGQgcG9zaXRpb24gaG9yaXpvbnRhbFxuLy8gQHBhcmFtIHtzdHJpbmd9ICRzdGFydCAtIGFtb3VudCB0byBwb3NpdGlvbiBzdGFydFxuLy8gQHBhcmFtIHtzdHJpbmd9ICRlbmQgLSBhbW91bnQgdG8gbGVmdDogMDsgZW5kXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5AbWl4aW4gcG9zaXRpb24taG9yaXpvbnRhbCgkc3RhcnQ6IG51bGwsICRlbmQ6IG51bGwpIHtcbiAgQGlmICRzdGFydCA9PSAkZW5kIHtcbiAgICBAaW5jbHVkZSBtdWx0aS1kaXIoKSB7XG4gICAgICBsZWZ0OiAkc3RhcnQ7XG4gICAgICByaWdodDogJGVuZDtcbiAgICB9XG4gIH0gQGVsc2Uge1xuICAgIEBhdC1yb290IHtcbiAgICAgIEBzdXBwb3J0cyAoaW5zZXQtaW5saW5lLXN0YXJ0OiAwKSB7XG4gICAgICAgICYge1xuICAgICAgICAgIGluc2V0LWlubGluZS1zdGFydDogJHN0YXJ0O1xuICAgICAgICAgIGluc2V0LWlubGluZS1lbmQ6ICRlbmQ7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBUT0RPIEZXLTM3NjZcbiAgICBAYXQtcm9vdCB7XG4gICAgICBAc3VwcG9ydHMgbm90IChpbnNldC1pbmxpbmUtc3RhcnQ6IDApIHtcbiAgICAgICAgJiB7XG4gICAgICAgICAgQGluY2x1ZGUgbHRyKCkge1xuICAgICAgICAgICAgbGVmdDogJHN0YXJ0O1xuICAgICAgICAgICAgcmlnaHQ6ICRlbmQ7XG4gICAgICAgICAgfVxuICAgICAgICAgIEBpbmNsdWRlIHJ0bCgpIHtcbiAgICAgICAgICAgIGxlZnQ6IHVuc2V0O1xuICAgICAgICAgICAgcmlnaHQ6IHVuc2V0O1xuXG4gICAgICAgICAgICBsZWZ0OiAkZW5kO1xuICAgICAgICAgICAgcmlnaHQ6ICRzdGFydDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cblxuLy8gQWRkIHBvc2l0aW9uIGZvciBhbGwgZGlyZWN0aW9uc1xuLy8gQHBhcmFtIHtzdHJpbmd9ICR0b3Bcbi8vIEBwYXJhbSB7c3RyaW5nfSAkZW5kXG4vLyBAcGFyYW0ge3N0cmluZ30gJGJvdHRvbVxuLy8gQHBhcmFtIHtzdHJpbmd9ICRzdGFydFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQG1peGluIHBvc2l0aW9uKCR0b3A6IG51bGwsICRlbmQ6IG51bGwsICRib3R0b206IG51bGwsICRzdGFydDogbnVsbCkge1xuICBAaW5jbHVkZSBwb3NpdGlvbi1ob3Jpem9udGFsKCRzdGFydCwgJGVuZCk7XG4gIHRvcDogJHRvcDtcbiAgYm90dG9tOiAkYm90dG9tO1xufVxuXG4vLyBBZGQgYm9yZGVyIGZvciBhbGwgZGlyZWN0aW9uc1xuLy8gQHBhcmFtIHtzdHJpbmd9ICR0b3Bcbi8vIEBwYXJhbSB7c3RyaW5nfSAkZW5kXG4vLyBAcGFyYW0ge3N0cmluZ30gJGJvdHRvbVxuLy8gQHBhcmFtIHtzdHJpbmd9ICRzdGFydFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQG1peGluIGJvcmRlcigkdG9wLCAkZW5kOiAkdG9wLCAkYm90dG9tOiAkdG9wLCAkc3RhcnQ6ICRlbmQpIHtcbiAgQGluY2x1ZGUgcHJvcGVydHkoYm9yZGVyLCAkdG9wLCAkZW5kLCAkYm90dG9tLCAkc3RhcnQpO1xufVxuXG4vLyBBZGQgYm9yZGVyIHJhZGl1cyBmb3IgYWxsIGRpcmVjdGlvbnNcbi8vIEBwYXJhbSB7c3RyaW5nfSAkdG9wLXN0YXJ0XG4vLyBAcGFyYW0ge3N0cmluZ30gJHRvcC1lbmRcbi8vIEBwYXJhbSB7c3RyaW5nfSAkYm90dG9tLWVuZFxuLy8gQHBhcmFtIHtzdHJpbmd9ICRib3R0b20tc3RhcnRcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbkBtaXhpbiBib3JkZXItcmFkaXVzKCR0b3Atc3RhcnQsICR0b3AtZW5kOiAkdG9wLXN0YXJ0LCAkYm90dG9tLWVuZDogJHRvcC1zdGFydCwgJGJvdHRvbS1zdGFydDogJHRvcC1lbmQpIHtcbiAgQGlmICR0b3Atc3RhcnQgPT0gJHRvcC1lbmQgYW5kICR0b3Atc3RhcnQgPT0gJGJvdHRvbS1lbmQgYW5kICR0b3Atc3RhcnQgPT0gJGJvdHRvbS1zdGFydCB7XG4gICAgQGluY2x1ZGUgbXVsdGktZGlyKCkge1xuICAgICAgYm9yZGVyLXJhZGl1czogJHRvcC1zdGFydDtcbiAgICB9XG4gIH0gQGVsc2Uge1xuICAgIEBpbmNsdWRlIGx0cigpIHtcbiAgICAgIGJvcmRlci10b3AtbGVmdC1yYWRpdXM6ICR0b3Atc3RhcnQ7XG4gICAgICBib3JkZXItdG9wLXJpZ2h0LXJhZGl1czogJHRvcC1lbmQ7XG4gICAgICBib3JkZXItYm90dG9tLXJpZ2h0LXJhZGl1czogJGJvdHRvbS1lbmQ7XG4gICAgICBib3JkZXItYm90dG9tLWxlZnQtcmFkaXVzOiAkYm90dG9tLXN0YXJ0O1xuICAgIH1cblxuICAgIEBpbmNsdWRlIHJ0bCgpIHtcbiAgICAgIGJvcmRlci10b3AtbGVmdC1yYWRpdXM6ICR0b3AtZW5kO1xuICAgICAgYm9yZGVyLXRvcC1yaWdodC1yYWRpdXM6ICR0b3Atc3RhcnQ7XG4gICAgICBib3JkZXItYm90dG9tLXJpZ2h0LXJhZGl1czogJGJvdHRvbS1zdGFydDtcbiAgICAgIGJvcmRlci1ib3R0b20tbGVmdC1yYWRpdXM6ICRib3R0b20tZW5kO1xuICAgIH1cbiAgfVxufVxuXG4vLyBBZGQgZGlyZWN0aW9uIGZvciBhbGwgZGlyZWN0aW9uc1xuLy8gQHBhcmFtIHtzdHJpbmd9ICRkaXIgLSBEaXJlY3Rpb24gb24gTFRSXG5AbWl4aW4gZGlyZWN0aW9uKCRkaXIpIHtcbiAgJG90aGVyLWRpcjogbnVsbDtcblxuICBAaWYgJGRpciA9PSBsdHIge1xuICAgICRvdGhlci1kaXI6IHJ0bDtcbiAgfSBAZWxzZSB7XG4gICAgJG90aGVyLWRpcjogbHRyO1xuICB9XG5cbiAgQGluY2x1ZGUgbHRyKCkge1xuICAgIGRpcmVjdGlvbjogJGRpcjtcbiAgfVxuICBAaW5jbHVkZSBydGwoKSB7XG4gICAgZGlyZWN0aW9uOiAkb3RoZXItZGlyO1xuICB9XG59XG5cbi8vIEFkZCBmbG9hdCBmb3IgYWxsIGRpcmVjdGlvbnNcbi8vIEBwYXJhbSB7c3RyaW5nfSAkc2lkZVxuLy8gQHBhcmFtIHtzdHJpbmd9ICRkZWNvcmF0b3IgLSAhaW1wb3J0YW50XG5AbWl4aW4gZmxvYXQoJHNpZGUsICRkZWNvcmF0b3I6IG51bGwpIHtcbiAgQGlmICRzaWRlID09IHN0YXJ0IHtcbiAgICBAaW5jbHVkZSBsdHIoKSB7XG4gICAgICBmbG9hdDogbGVmdCAkZGVjb3JhdG9yO1xuICAgIH1cbiAgICBAaW5jbHVkZSBydGwoKSB7XG4gICAgICBmbG9hdDogcmlnaHQgJGRlY29yYXRvcjtcbiAgICB9XG4gIH0gQGVsc2UgaWYgJHNpZGUgPT0gZW5kIHtcbiAgICBAaW5jbHVkZSBsdHIoKSB7XG4gICAgICBmbG9hdDogcmlnaHQgJGRlY29yYXRvcjtcbiAgICB9XG4gICAgQGluY2x1ZGUgcnRsKCkge1xuICAgICAgZmxvYXQ6IGxlZnQgJGRlY29yYXRvcjtcbiAgICB9XG4gIH0gQGVsc2Uge1xuICAgIEBpbmNsdWRlIG11bHRpLWRpcigpIHtcbiAgICAgIGZsb2F0OiAkc2lkZSAkZGVjb3JhdG9yO1xuICAgIH1cbiAgfVxufVxuXG5AbWl4aW4gYmFja2dyb3VuZC1wb3NpdGlvbigkaG9yaXpvbnRhbCwgJGhvcml6b250YWwtYW1vdW50OiBudWxsLCAkdmVydGljYWw6IG51bGwsICR2ZXJ0aWNhbC1hbW91bnQ6IG51bGwpIHtcbiAgQGlmICRob3Jpem9udGFsID09IHN0YXJ0IG9yICRob3Jpem9udGFsID09IGVuZCB7XG4gICAgJGhvcml6b250YWwtbHRyOiBudWxsO1xuICAgICRob3Jpem9udGFsLXJ0bDogbnVsbDtcbiAgICBAaWYgJGhvcml6b250YWwgPT0gc3RhcnQge1xuICAgICAgJGhvcml6b250YWwtbHRyOiBsZWZ0O1xuICAgICAgJGhvcml6b250YWwtcnRsOiByaWdodDtcbiAgICB9IEBlbHNlIHtcbiAgICAgICRob3Jpem9udGFsLWx0cjogcmlnaHQ7XG4gICAgICAkaG9yaXpvbnRhbC1ydGw6IGxlZnQ7XG4gICAgfVxuXG4gICAgQGluY2x1ZGUgbHRyKCkge1xuICAgICAgYmFja2dyb3VuZC1wb3NpdGlvbjogJGhvcml6b250YWwtbHRyICRob3Jpem9udGFsLWFtb3VudCAkdmVydGljYWwgJHZlcnRpY2FsLWFtb3VudDtcbiAgICB9XG4gICAgQGluY2x1ZGUgcnRsKCkge1xuICAgICAgYmFja2dyb3VuZC1wb3NpdGlvbjogJGhvcml6b250YWwtcnRsICRob3Jpem9udGFsLWFtb3VudCAkdmVydGljYWwgJHZlcnRpY2FsLWFtb3VudDtcbiAgICB9XG4gIH0gQGVsc2Uge1xuICAgIEBpbmNsdWRlIG11bHRpLWRpcigpIHtcbiAgICAgIGJhY2tncm91bmQtcG9zaXRpb246ICRob3Jpem9udGFsICRob3Jpem9udGFsLWFtb3VudCAkdmVydGljYWwgJHZlcnRpY2FsLWFtb3VudDtcbiAgICB9XG4gIH1cbn1cblxuQG1peGluIHRyYW5zZm9ybS1vcmlnaW4oJHgtYXhpcywgJHktYXhpczogbnVsbCkge1xuICBAaWYgJHgtYXhpcyA9PSBzdGFydCB7XG4gICAgQGluY2x1ZGUgbHRyKCkge1xuICAgICAgdHJhbnNmb3JtLW9yaWdpbjogbGVmdCAkeS1heGlzO1xuICAgIH1cbiAgICBAaW5jbHVkZSBydGwoKSB7XG4gICAgICB0cmFuc2Zvcm0tb3JpZ2luOiByaWdodCAkeS1heGlzO1xuICAgIH1cbiAgfSBAZWxzZSBpZiAkeC1heGlzID09IGVuZCB7XG4gICAgQGluY2x1ZGUgbHRyKCkge1xuICAgICAgdHJhbnNmb3JtLW9yaWdpbjogcmlnaHQgJHktYXhpcztcbiAgICB9XG4gICAgQGluY2x1ZGUgcnRsKCkge1xuICAgICAgdHJhbnNmb3JtLW9yaWdpbjogbGVmdCAkeS1heGlzO1xuICAgIH1cbiAgfSBAZWxzZSBpZiAkeC1heGlzID09IGxlZnQgb3IgJHgtYXhpcyA9PSByaWdodCB7XG4gICAgQGluY2x1ZGUgbXVsdGktZGlyKCkge1xuICAgICAgdHJhbnNmb3JtLW9yaWdpbjogJHgtYXhpcyAkeS1heGlzO1xuICAgIH1cbiAgfSBAZWxzZSB7XG4gICAgQGluY2x1ZGUgbHRyKCkge1xuICAgICAgdHJhbnNmb3JtLW9yaWdpbjogJHgtYXhpcyAkeS1heGlzO1xuICAgIH1cbiAgICBAaW5jbHVkZSBydGwoKSB7XG4gICAgICB0cmFuc2Zvcm0tb3JpZ2luOiBjYWxjKDEwMCUgLSAjeyR4LWF4aXN9KSAkeS1heGlzO1xuICAgIH1cbiAgfVxufVxuXG4vLyBBZGQgdHJhbnNmb3JtIGZvciBhbGwgZGlyZWN0aW9uc1xuLy8gQHBhcmFtIHtzdHJpbmd9ICR0cmFuc2Zvcm1zIC0gY29tbWEgc2VwYXJhdGVkIGxpc3Qgb2YgdHJhbnNmb3Jtc1xuQG1peGluIHRyYW5zZm9ybSgkdHJhbnNmb3Jtcy4uLikge1xuICAkZXh0cmE6IG51bGw7XG5cbiAgJHg6IG51bGw7XG4gICRsdHItdHJhbnNsYXRlOiBudWxsO1xuICAkcnRsLXRyYW5zbGF0ZTogbnVsbDtcblxuICBAZWFjaCAkdHJhbnNmb3JtIGluICR0cmFuc2Zvcm1zIHtcbiAgICBAaWYgKHN0ci1pbmRleCgkdHJhbnNmb3JtLCB0cmFuc2xhdGUzZCkpIHtcbiAgICAgICR0cmFuc2Zvcm06IHN0ci1yZXBsYWNlKCR0cmFuc2Zvcm0sICd0cmFuc2xhdGUzZCgnKTtcbiAgICAgICR0cmFuc2Zvcm06IHN0ci1yZXBsYWNlKCR0cmFuc2Zvcm0sICcpJyk7XG5cbiAgICAgICRjb29yZGluYXRlczogc3RyLXNwbGl0KCR0cmFuc2Zvcm0sICcsJyk7XG5cbiAgICAgICR4OiBudGgoJGNvb3JkaW5hdGVzLCAxKTtcbiAgICAgICR5OiBudGgoJGNvb3JkaW5hdGVzLCAyKTtcbiAgICAgICR6OiBudGgoJGNvb3JkaW5hdGVzLCAzKTtcblxuICAgICAgJGx0ci10cmFuc2xhdGU6IHRyYW5zbGF0ZTNkKCR4LCAkeSwgJHopO1xuICAgICAgJHJ0bC10cmFuc2xhdGU6IHRyYW5zbGF0ZTNkKGNhbGMoLTEgKiAjeyR4fSksICR5LCAkeik7XG4gICAgfSBAZWxzZSB7XG4gICAgICBAaWYgJGV4dHJhID09IG51bGwge1xuICAgICAgICAkZXh0cmE6ICR0cmFuc2Zvcm07XG4gICAgICB9IEBlbHNlIHtcbiAgICAgICAgJGV4dHJhOiAkZXh0cmEgJHRyYW5zZm9ybTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBAaWYgJHggPT0gJzAnIG9yICR4ID09IG51bGwge1xuICAgIEBpbmNsdWRlIG11bHRpLWRpcigpIHtcbiAgICAgIHRyYW5zZm9ybTogJGx0ci10cmFuc2xhdGUgJGV4dHJhO1xuICAgIH1cbiAgfSBAZWxzZSB7XG4gICAgQGluY2x1ZGUgbHRyKCkge1xuICAgICAgdHJhbnNmb3JtOiAkbHRyLXRyYW5zbGF0ZSAkZXh0cmE7XG4gICAgfVxuXG4gICAgQGluY2x1ZGUgcnRsKCkge1xuICAgICAgdHJhbnNmb3JtOiAkcnRsLXRyYW5zbGF0ZSAkZXh0cmE7XG4gICAgfVxuICB9XG59XG4iLCIvKipcbiAqIEltcG9ydGVkIGlvbmljIG1peGlucyBmb3IgU0NTUyBmcm9tIGRpZmZlcmVudCBjb21wb25lbnRzXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiBFeHRyYWN0ZWQgZnJvbVxuICogaHR0cHM6Ly9naXRodWIuY29tL2lvbmljLXRlYW0vaW9uaWMtZnJhbWV3b3JrL2Jsb2IvbWFzdGVyL2NvcmUvc3JjL2NvbXBvbmVudHMvZ3JpZC9ncmlkLm1peGlucy5zY3NzXG4gKiBodHRwczovL2dpdGh1Yi5jb20vaW9uaWMtdGVhbS9pb25pYy1mcmFtZXdvcmsvYmxvYi9tYXN0ZXIvY29yZS9zcmMvY29tcG9uZW50cy9pdGVtL2l0ZW0ubWl4aW5zLnNjc3NcbiAqL1xuXG4vLyBSZXNwb25zaXZlIE1peGluc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuXG4vLyBDcmVhdGVzIGEgZml4ZWQgd2lkdGggZm9yIHRoZSBncmlkIGJhc2VkIG9uIHRoZSBzY3JlZW4gc2l6ZVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbkBtaXhpbiBtYWtlLWdyaWQtd2lkdGhzKCR3aWR0aHM6ICRncmlkLXdpZHRocywgJGJyZWFrcG9pbnRzOiAkc2NyZWVuLWJyZWFrcG9pbnRzKSB7XG4gIEBlYWNoICRicmVha3BvaW50LCAkd2lkdGggaW4gJHdpZHRocyB7XG4gICAgQGluY2x1ZGUgbWVkaWEtYnJlYWtwb2ludC11cCgkYnJlYWtwb2ludCwgJGJyZWFrcG9pbnRzKSB7XG4gICAgICB3aWR0aDogJHdpZHRoO1xuICAgIH1cbiAgfVxuXG4gIG1heC13aWR0aDogMTAwJTtcbn1cblxuXG4vLyBBZGRzIHBhZGRpbmcgdG8gdGhlIGVsZW1lbnQgYmFzZWQgb24gYnJlYWtwb2ludHNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5AbWl4aW4gbWFrZS1icmVha3BvaW50LXBhZGRpbmcoJHBhZGRpbmdzKSB7XG4gIEBlYWNoICRicmVha3BvaW50IGluIG1hcC1rZXlzKCRwYWRkaW5ncykge1xuICAgIEBpbmNsdWRlIG1lZGlhLWJyZWFrcG9pbnQtdXAoJGJyZWFrcG9pbnQpIHtcbiAgICAgICRwYWRkaW5nOiBtYXAtZ2V0KCRwYWRkaW5ncywgJGJyZWFrcG9pbnQpO1xuXG4gICAgICBAaW5jbHVkZSBwYWRkaW5nKCRwYWRkaW5nKTtcbiAgICB9XG4gIH1cbn1cblxuXG4vLyBJdGVtIE1peGluc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuQG1peGluIGl0ZW0tcHVzaC1zdmctdXJsKCRmaWxsKSB7XG4gICRpdGVtLWRldGFpbC1wdXNoLXN2ZzogXCI8c3ZnIHhtbG5zPSdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Zycgdmlld0JveD0nMCAwIDEyIDIwJz48cGF0aCBkPSdNMiwyMGwtMi0ybDgtOEwwLDJsMi0ybDEwLDEwTDIsMjB6JyBmaWxsPScjeyRmaWxsfScvPjwvc3ZnPlwiO1xuXG4gIEBpbmNsdWRlIHN2Zy1iYWNrZ3JvdW5kLWltYWdlKCRpdGVtLWRldGFpbC1wdXNoLXN2ZywgdHJ1ZSk7XG59XG4iLCJAdXNlIFwic2FzczptYXRoXCIgYXMgbWF0aDtcblxuLyoqXG4gKiBBcHAgY3VzdG9tIG1peGlucyBmb3IgU0NTU1xuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogUGxhY2UgaGVyZSBvdXIgY3VzdG9tIG1peGlucy5cbiAqL1xuXG4vLyBNaXhlcyBhIGNvbG9yIHdpdGggYmxhY2sgdG8gY3JlYXRlIGl0cyBzaGFkZS5cbi8vIERlZmF1bHQgdG8gYm9vdHN0cmFwIGxldmVsIDYuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQGZ1bmN0aW9uIGdldC1jb2xvci1zaGFkZS1wZXJjZW50KCRjb2xvciwgJHBlcmNlbnQ6IDQ4JSkge1xuICAgIEByZXR1cm4gbWl4KCMwMDAsICRjb2xvciwgJHBlcmNlbnQpO1xufVxuXG4vLyBNaXhlcyBhIGNvbG9yIHdpdGggd2hpdGUgdG8gY3JlYXRlIGl0cyB0aW50LlxuLy8gRGVmYXVsdCB0byBib290c3RyYXAgbGV2ZWwgLTEwLlxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbkBmdW5jdGlvbiBnZXQtY29sb3ItdGludC1wZXJjZW50KCRjb2xvciwgJHBlcmNlbnQ6IDgwJSkge1xuICAgIEByZXR1cm4gbWl4KCNmZmYsICRjb2xvciwgJHBlcmNlbnQpO1xufVxuXG4vLyBJb25pYyBDb2xvcnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBHZW5lcmF0ZXMgdGhlIGNvbG9yIGNsYXNzZXMgYW5kIHZhcmlhYmxlcyBiYXNlZCBvbiB0aGVcbi8vIGNvbG9ycyBtYXBcblxuQG1peGluIGdlbmVyYXRlLWNvbG9yKCRjb2xvci1uYW1lLCAkY29sb3JzLCAkdGhlbWUpIHtcbiAgICAkY29sb3ItdGhlbWVzOiBtYXAtZ2V0KCRjb2xvcnMsICRjb2xvci1uYW1lKTtcbiAgICAkYmFzZTogbWFwLWdldCgkY29sb3ItdGhlbWVzLCAkdGhlbWUpO1xuXG4gICAgQGlmICR0aGVtZSA9PSAnZGFyaycge1xuICAgICAgICAkYmFzZTogbWl4KG1hcC1nZXQoJGNvbG9yLXRoZW1lcywgJ2xpZ2h0JyksIHdoaXRlLCA4MCUpICFkZWZhdWx0O1xuICAgIH1cblxuICAgIEBpbmNsdWRlIGdlbmVyYXRlLWNvbG9yLXZhcmlhbnRzKCRjb2xvci1uYW1lLCAkYmFzZSk7XG59XG5cbkBtaXhpbiBnZW5lcmF0ZS1jb2xvci12YXJpYW50cygkY29sb3ItbmFtZSwgJGJhc2UpIHtcbiAgICAkY29udHJhc3Q6IGdldF9jb250cmFzdF9jb2xvcigkYmFzZSk7XG4gICAgJHNoYWRlOiBnZXQtY29sb3Itc2hhZGUtcGVyY2VudCgkYmFzZSk7XG4gICAgJHRpbnQ6IGdldC1jb2xvci10aW50LXBlcmNlbnQoJGJhc2UpO1xuXG4gICAgLS0jeyRjb2xvci1uYW1lfTogI3skYmFzZX07XG4gICAgLS0jeyRjb2xvci1uYW1lfS1zaGFkZTogI3skc2hhZGV9O1xuICAgIC0tI3skY29sb3ItbmFtZX0tdGludDogI3skdGludH07XG4gICAgLS0jeyRjb2xvci1uYW1lfS1jb250cmFzdDogI3skY29udHJhc3R9O1xuXG4gICAgLy8gSW50ZXJuYWwgaW9uaWMgdXNlIG9ubHkuXG4gICAgLS1pb24tY29sb3ItI3skY29sb3ItbmFtZX06IHZhcigtLSN7JGNvbG9yLW5hbWV9KTtcbiAgICAtLWlvbi1jb2xvci0jeyRjb2xvci1uYW1lfS1iYXNlOiB2YXIoLS1pb24tY29sb3ItI3skY29sb3ItbmFtZX0pO1xuICAgIC0taW9uLWNvbG9yLSN7JGNvbG9yLW5hbWV9LXJnYjogI3tjb2xvci10by1yZ2ItbGlzdCgkYmFzZSl9O1xuICAgIC0taW9uLWNvbG9yLSN7JGNvbG9yLW5hbWV9LWNvbnRyYXN0OiAjeyRjb250cmFzdH07XG4gICAgLS1pb24tY29sb3ItI3skY29sb3ItbmFtZX0tY29udHJhc3QtcmdiOiAje2NvbG9yLXRvLXJnYi1saXN0KCRjb250cmFzdCl9O1xuICAgIC0taW9uLWNvbG9yLSN7JGNvbG9yLW5hbWV9LXNoYWRlOiAjeyRzaGFkZX07XG4gICAgLS1pb24tY29sb3ItI3skY29sb3ItbmFtZX0tdGludDogI3skdGludH07XG5cbiAgICAuaW9uLWNvbG9yLSN7JGNvbG9yLW5hbWV9IHtcbiAgICAgICAgLS1pb24tY29sb3I6IHZhcigtLWlvbi1jb2xvci0jeyRjb2xvci1uYW1lfSk7XG4gICAgICAgIC0taW9uLWNvbG9yLWJhc2U6IHZhcigtLWlvbi1jb2xvci0jeyRjb2xvci1uYW1lfS1iYXNlKTtcbiAgICAgICAgLS1pb24tY29sb3ItcmdiOiB2YXIoLS1pb24tY29sb3ItI3skY29sb3ItbmFtZX0tcmdiKTtcbiAgICAgICAgLS1pb24tY29sb3ItY29udHJhc3Q6IHZhcigtLWlvbi1jb2xvci0jeyRjb2xvci1uYW1lfS1jb250cmFzdCk7XG4gICAgICAgIC0taW9uLWNvbG9yLWNvbnRyYXN0LXJnYjogdmFyKC0taW9uLWNvbG9yLSN7JGNvbG9yLW5hbWV9LWNvbnRyYXN0LXJnYik7XG4gICAgICAgIC0taW9uLWNvbG9yLXNoYWRlOiB2YXIoLS1pb24tY29sb3ItI3skY29sb3ItbmFtZX0tc2hhZGUpO1xuICAgICAgICAtLWlvbi1jb2xvci10aW50OiB2YXIoLS1pb24tY29sb3ItI3skY29sb3ItbmFtZX0tdGludCk7XG4gICAgfVxufVxuXG5AbWl4aW4gY29yZS1mb2N1cygpIHtcbiAgICBvdXRsaW5lOiBub25lO1xuICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgICAmOjphZnRlciB7XG4gICAgICAgIEBpbmNsdWRlIHBvc2l0aW9uKDAsIDAsIDAsIDApO1xuICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICAgIGNvbnRlbnQ6IFwiXCI7XG4gICAgICAgIG9wYWNpdHk6IDE7XG4gICAgICAgIHotaW5kZXg6IDE7XG4gICAgICAgIEBpbmNsdWRlIGNvcmUtZm9jdXMtc3R5bGUoKTtcbiAgICB9XG59XG5cbkBtaXhpbiBjb3JlLWZvY3VzLXN0eWxlKCkge1xuICAgIGJveC1zaGFkb3c6IGluc2V0IDAgMCB2YXIoLS1hMTF5LWZvY3VzLXdpZHRoKSAxcHggdmFyKC0tYTExeS1mb2N1cy1jb2xvcik7XG4gICAgYm9yZGVyLXJhZGl1czogdmFyKC0tYm9yZGVyLXJhZGl1cyk7XG4gICAgLy8gVGhpY2tlciBvcHRpb246XG4gICAgLy8gYm9yZGVyOiB2YXIoLS1hMTF5LWZvY3VzLXdpZHRoKSBzb2xpZCB2YXIoLS1hMTF5LWZvY3VzLWNvbG9yKTtcbn1cblxuQG1peGluIGNvcmUtdHJhbnNpdGlvbigkcHJvcGVydGllczogYWxsLCAkZHVyYXRpb246IDUwMG1zLCAkdGltaW5nLWZ1bmN0aW9uOiBlYXNlLWluLW91dCkge1xuICAgICR0cmFuc2l0aW9uczogKCk7XG4gICAgQGVhY2ggJHByb3BlcnR5IGluICRwcm9wZXJ0aWVzIHtcbiAgICAgICR0cmFuc2l0aW9uczogYXBwZW5kKCR0cmFuc2l0aW9ucywgJHByb3BlcnR5ICRkdXJhdGlvbiAkdGltaW5nLWZ1bmN0aW9uLCBjb21tYSk7XG4gICAgfVxuXG4gICAgLXdlYmtpdC10cmFuc2l0aW9uOiAkdHJhbnNpdGlvbnM7XG4gICAgdHJhbnNpdGlvbjogJHRyYW5zaXRpb25zO1xufVxuXG5AbWl4aW4gc3Itb25seSgpIHtcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgd2lkdGg6IDFweDtcbiAgICBoZWlnaHQ6IDFweDtcbiAgICBwYWRkaW5nOiAwO1xuICAgIG1hcmdpbjogLTFweDtcbiAgICBvdmVyZmxvdzogaGlkZGVuO1xuICAgIGNsaXA6IHJlY3QoMCwgMCwgMCwgMCk7XG4gICAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcbiAgICBib3JkZXI6IDA7XG59XG5cbi8qKlxuICogU2FtZSBhcyBpdGVtLXB1c2gtc3ZnLXVybCBidXQgYWRtaXRzIGZsaXAtcnRsXG4gKi9cbkBtaXhpbiBwdXNoLWFycm93LWNvbG9yKCRmaWxsOiA2MjYyNjIsICRmbGlwLXJ0bDogZmFsc2UpIHtcbiAgICAkaXRlbS1kZXRhaWwtcHVzaC1zdmc6IFwiPHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHZpZXdCb3g9JzAgMCAxMiAyMCc+PHBhdGggZD0nTTIsMjBsLTItMmw4LThMMCwybDItMmwxMCwxMEwyLDIweicgZmlsbD0nI3skZmlsbH0nLz48L3N2Zz5cIjtcblxuICAgIEBpbmNsdWRlIHN2Zy1iYWNrZ3JvdW5kLWltYWdlKCRpdGVtLWRldGFpbC1wdXNoLXN2ZywgJGZsaXAtcnRsKTtcbn1cblxuQG1peGluIGJvcmRlci1zdGFydCgkcHgsICR0eXBlOiBudWxsLCAkY29sb3I6IG51bGwpIHtcbiAgICBAaW5jbHVkZSBwcm9wZXJ0eS1ob3Jpem9udGFsKGJvcmRlciwgJHB4ICR0eXBlICRjb2xvciwgbnVsbCk7XG59XG5cbkBtaXhpbiBib3JkZXItZW5kKCRweCwgJHR5cGU6IG51bGwsICRjb2xvcjogbnVsbCkge1xuICAgIEBpbmNsdWRlIHByb3BlcnR5LWhvcml6b250YWwoYm9yZGVyLCBudWxsLCAkcHggJHR5cGUgJGNvbG9yKTtcbn1cblxuQG1peGluIHNhZmUtYXJlYS1ib3JkZXItc3RhcnQoJHB4LCAkdHlwZSwgJGNvbG9yKSB7XG4gICAgJHNhZmUtYXJlYS1wb3NpdGlvbjogY2FsYyh2YXIoLS1pb24tc2FmZS1hcmVhLWxlZnQpICsgI3skcHh9KTtcblxuICAgIEBpbmNsdWRlIGJvcmRlci1zdGFydCgkc2FmZS1hcmVhLXBvc2l0aW9uLCAkdHlwZSwgJGNvbG9yKTtcbn1cblxuQG1peGluIHNhZmUtYXJlYS1ib3JkZXItZW5kKCRweCwgJHR5cGUsICRjb2xvcikge1xuICAgICRzYWZlLWFyZWEtcG9zaXRpb246IGNhbGModmFyKC0taW9uLXNhZmUtYXJlYS1yaWdodCkgKyAjeyRweH0pO1xuXG4gICAgQGluY2x1ZGUgYm9yZGVyLWVuZCgkc2FmZS1hcmVhLXBvc2l0aW9uLCAkdHlwZSwgJGNvbG9yKTtcbn1cblxuQG1peGluIHNhZmUtYXJlYS1tYXJnaW4taG9yaXpvbnRhbCgkc3RhcnQsICRlbmQ6ICRzdGFydCkge1xuICAgICRzYWZlLWFyZWEtZW5kOiBudWxsO1xuICAgICRzYWZlLWFyZWEtc3RhcnQ6IG51bGw7XG5cbiAgICBAaWYgKCRlbmQpIHtcbiAgICAgICAgJHNhZmUtYXJlYS1lbmQ6IGNhbGModmFyKC0taW9uLXNhZmUtYXJlYS1yaWdodCkgKyAjeyRlbmR9KTtcbiAgICB9XG4gICAgQGlmICgkc3RhcnQpIHtcbiAgICAgICAgJHNhZmUtYXJlYS1zdGFydDogY2FsYyh2YXIoLS1pb24tc2FmZS1hcmVhLWxlZnQpICsgI3skc3RhcnR9KTtcbiAgICB9XG5cbiAgICBAaW5jbHVkZSBtYXJnaW4taG9yaXpvbnRhbCgkc2FmZS1hcmVhLXN0YXJ0LCAkc2FmZS1hcmVhLWVuZCk7XG59XG5cbkBtaXhpbiBzYWZlLWFyZWEtbWFyZ2luLXN0YXJ0KCRzdGFydCwgJGVuZCkge1xuICAgICRzYWZlLWFyZWEtc3RhcnQ6IGNhbGModmFyKC0taW9uLXNhZmUtYXJlYS1sZWZ0KSArICN7JHN0YXJ0fSk7XG5cbiAgICBAaW5jbHVkZSBtYXJnaW4taG9yaXpvbnRhbCgkc2FmZS1hcmVhLXN0YXJ0LCAkZW5kKTtcbn1cblxuQG1peGluIHNhZmUtYXJlYS1tYXJnaW4tZW5kKCRzdGFydCwgJGVuZCkge1xuICAgICRzYWZlLWFyZWEtZW5kOiBjYWxjKHZhcigtLWlvbi1zYWZlLWFyZWEtcmlnaHQpICsgI3skZW5kfSk7XG5cbiAgICBAaW5jbHVkZSBtYXJnaW4taG9yaXpvbnRhbCgkc3RhcnQsICRzYWZlLWFyZWEtZW5kKTtcbn1cblxuQG1peGluIHNhZmUtYXJlYS1wYWRkaW5nLWhvcml6b250YWwoJHN0YXJ0LCAkZW5kOiAkc3RhcnQpIHtcbiAgICAkc2FmZS1hcmVhLWVuZDogbnVsbDtcbiAgICAkc2FmZS1hcmVhLXN0YXJ0OiBudWxsO1xuXG4gICAgQGlmICgkZW5kKSB7XG4gICAgICAgICRzYWZlLWFyZWEtZW5kOiBjYWxjKHZhcigtLWlvbi1zYWZlLWFyZWEtcmlnaHQpICsgI3skZW5kfSk7XG4gICAgfVxuICAgIEBpZiAoJHN0YXJ0KSB7XG4gICAgICAgICRzYWZlLWFyZWEtc3RhcnQ6IGNhbGModmFyKC0taW9uLXNhZmUtYXJlYS1sZWZ0KSArICN7JHN0YXJ0fSk7XG4gICAgfVxuXG4gICAgQGluY2x1ZGUgcGFkZGluZy1ob3Jpem9udGFsKCRzYWZlLWFyZWEtc3RhcnQsICRzYWZlLWFyZWEtZW5kKTtcbn1cblxuQG1peGluIHNhZmUtYXJlYS1wYWRkaW5nLXN0YXJ0KCRzdGFydCwgJGVuZCkge1xuICAgICRzYWZlLWFyZWEtc3RhcnQ6IGNhbGModmFyKC0taW9uLXNhZmUtYXJlYS1sZWZ0KSArICN7JHN0YXJ0fSk7XG5cbiAgICBAaW5jbHVkZSBwYWRkaW5nLWhvcml6b250YWwoJHNhZmUtYXJlYS1zdGFydCwgJGVuZCk7XG59XG5cbkBtaXhpbiBzYWZlLWFyZWEtcGFkZGluZy1lbmQoJHN0YXJ0LCAkZW5kKSB7XG4gICAgJHNhZmUtYXJlYS1lbmQ6IGNhbGModmFyKC0taW9uLXNhZmUtYXJlYS1yaWdodCkgKyAjeyRlbmR9KTtcblxuICAgIEBpbmNsdWRlIHBhZGRpbmctaG9yaXpvbnRhbCgkc3RhcnQsICRzYWZlLWFyZWEtZW5kKTtcbn1cblxuQG1peGluIHNhZmUtYXJlYS1wb3NpdGlvbigkdG9wOiBudWxsLCAkZW5kOiBudWxsLCAkYm90dG9tOiBudWxsLCAkc3RhcnQ6IG51bGwpIHtcbiAgICAkc2FmZS1hcmVhLXN0YXJ0OiBjYWxjKHZhcigtLWlvbi1zYWZlLWFyZWEtbGVmdCkgKyAjeyRzdGFydH0pO1xuICAgICRzYWZlLWFyZWEtZW5kOiBjYWxjKHZhcigtLWlvbi1zYWZlLWFyZWEtcmlnaHQpICsgI3skZW5kfSk7XG5cbiAgICBAaW5jbHVkZSBwb3NpdGlvbigkdG9wLCAkc2FmZS1hcmVhLWVuZCwgJGJvdHRvbSwgJHNhZmUtYXJlYS1zdGFydCk7XG59XG5cbkBtaXhpbiBjb3JlLWhlYWRpbmdzKCkge1xuICAgIGgxIHtcbiAgICAgICAgZm9udC1zaXplOiAyNnB4O1xuICAgIH1cbiAgICBoMiwgLml0ZW0taGVhZGluZyB7XG4gICAgICAgIGZvbnQtc2l6ZTogMjRweDtcbiAgICB9XG4gICAgaDMge1xuICAgICAgICBmb250LXNpemU6IDIycHg7XG4gICAgfVxuICAgIGg0IHtcbiAgICAgICAgZm9udC1zaXplOiAyMHB4O1xuICAgIH1cbiAgICBoNSB7XG4gICAgICAgIGZvbnQtc2l6ZTogMThweDtcbiAgICB9XG4gICAgaDYge1xuICAgICAgICBmb250LXNpemU6IDE2cHg7XG4gICAgfVxufVxuXG5AbWl4aW4gZGFya21vZGUoKSB7XG4gICAgJHJvb3Q6ICN7Jn07XG5cbiAgICBAYXQtcm9vdCAje2FkZC1yb290LXNlbGVjdG9yKCRyb290LCBcImh0bWwuZGFya1wiKX0ge1xuICAgICAgICBAY29udGVudDtcbiAgICB9XG59XG5cbkBtaXhpbiBob3Jpem9udGFsX3Njcm9sbF9pdGVtKCR3aWR0aCwgJG1pbi13aWR0aCwgJG1heC13aWR0aCkge1xuICAgIGZsZXg6IDAgMCAkd2lkdGg7XG4gICAgbWluLXdpZHRoOiAkbWluLXdpZHRoO1xuICAgIG1heC13aWR0aDogJG1heC13aWR0aDtcbiAgICBhbGlnbi1zZWxmOiBzdHJldGNoO1xuICAgIGRpc3BsYXk6IGJsb2NrO1xuXG4gICAgaW9uLWNhcmQge1xuICAgICAgICAtLXZlcnRpY2FsLW1hcmdpbjogMTBweDtcbiAgICAgICAgLS1ob3Jpem9udGFsLW1hcmdpbjogMTBweDtcblxuICAgICAgICB3aWR0aDogY2FsYygxMDAlIC0gdmFyKC0taG9yaXpvbnRhbC1tYXJnaW4pIC0gdmFyKC0taG9yaXpvbnRhbC1tYXJnaW4pKTtcbiAgICAgICAgaGVpZ2h0OiBjYWxjKDEwMCUgLSB2YXIoLS12ZXJ0aWNhbC1tYXJnaW4pIC0gdmFyKC0tdmVydGljYWwtbWFyZ2luKSk7XG4gICAgICAgIG1hcmdpbjogdmFyKC0tdmVydGljYWwtbWFyZ2luKSB2YXIoLS1ob3Jpem9udGFsLW1hcmdpbik7XG5cbiAgICAgICAgQG1lZGlhIChtYXgtd2lkdGg6IDM2MHB4KSB7XG4gICAgICAgICAgICAtLWhvcml6b250YWwtbWFyZ2luOiA2cHg7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbi8vIENvbG9yIG1peGlucy5cbkBmdW5jdGlvbiBnZXRfYnJpZ2h0bmVzcygkY29sb3IpIHtcbiAgICBAcmV0dXJuIG1hdGguZGl2KHJlZCgkY29sb3IpICsgZ3JlZW4oJGNvbG9yKSArIGJsdWUoJGNvbG9yKSwgMyk7XG59XG5cbi8vIEdldCB0aGUgYmV0dGVyIGNvbG9yIGNvbnRyYXN0IHVzaW5nIFdDQUcgYWxnb3J5dGhtLlxuQGZ1bmN0aW9uIGdldF9jb250cmFzdF9jb2xvcigkY29sb3IpIHtcbiAgICAkbHVtaWFuY2U6IGx1bWluYW5jZSgkY29sb3IpO1xuXG4gICAgLy8gV2hpdGUgbHVtaWFuY2UgaXMgMS5cbiAgICAkd2hpdGVDb250cmFzdDogbWF0aC5kaXYoJGx1bWlhbmNlICsgMC4wNSwgMSArIDAuMDUpO1xuICAgIC8vIFdoaXRlIGx1bWlhbmNlIGlzIDAuXG4gICAgJGJsYWNrQ29udHJhc3Q6IG1hdGguZGl2KDAuMDUsICRsdW1pYW5jZSArIDAuMDUpO1xuXG4gICAgQHJldHVybiBpZigkd2hpdGVDb250cmFzdCA8ICRibGFja0NvbnRyYXN0LCB3aGl0ZSwgYmxhY2spO1xufVxuXG4vLyBDb2xvciBjb250cmFzdCB1c2luZyB5aXEgYXByb3hpbWF0aW9uIHdpdGggMTUwIHRocmVzaG9sZC5cbkBmdW5jdGlvbiBnZXRfY29udHJhc3RfY29sb3JfeWlxKCRjb2xvciwgJGRhcms6IGJsYWNrLCAkbGlnaHQ6IHdoaXRlKSB7XG4gICAgJHI6IHJlZCgkY29sb3IpO1xuICAgICRnOiBncmVlbigkY29sb3IpO1xuICAgICRiOiBibHVlKCRjb2xvcik7XG5cbiAgICAkeWlxOiBtYXRoLmRpdigoJHIgKiAyOTkpICsgKCRnICogNTg3KSArICgkYiAqIDExNCksIDEwMDApO1xuXG4gICAgQHJldHVybiBpZigkeWlxID49IDEyOCwgJGRhcmssICRsaWdodCk7XG59XG5cbi8vIFdDQUcgY29udHJhc3QgYWxnb3JpdGhtXG5AZnVuY3Rpb24gY2hlY2stY29udHJhc3QoJGZvcmVncm91bmQsICRiYWNrZ3JvdW5kKSB7XG4gICAgJGZvcmVncm91bmRMdW1pYW5jZTogbHVtaW5hbmNlKCRmb3JlZ3JvdW5kKTtcbiAgICAkYmFja2dyb3VuZEx1bWluYW5jZTogbHVtaW5hbmNlKCRiYWNrZ3JvdW5kKTtcblxuICAgIEBpZiAoJGJhY2tncm91bmRMdW1pbmFuY2UgPCAkZm9yZWdyb3VuZEx1bWlhbmNlKSB7XG4gICAgICAgIEByZXR1cm4gbWF0aC5kaXYoJGJhY2tncm91bmRMdW1pbmFuY2UgKyAwLjA1LCAkZm9yZWdyb3VuZEx1bWlhbmNlICsgMC4wNSk7XG4gICAgfSBAZWxzZSB7XG4gICAgICAgIEByZXR1cm4gbWF0aC5kaXYoJGZvcmVncm91bmRMdW1pYW5jZSArIDAuMDUsICRiYWNrZ3JvdW5kTHVtaW5hbmNlICsgMC4wNSk7XG4gICAgfVxufVxuXG5AZnVuY3Rpb24gbHVtaW5hbmNlKCRjb2xvcikge1xuICAgICRyOiByZWQoJGNvbG9yKTtcbiAgICAkZzogZ3JlZW4oJGNvbG9yKTtcbiAgICAkYjogYmx1ZSgkY29sb3IpO1xuXG4gICAgJHI6IGNvbXBvbmVudC1sdW1pbmFuY2UoJHIpO1xuICAgICRnOiBjb21wb25lbnQtbHVtaW5hbmNlKCRnKTtcbiAgICAkYjogY29tcG9uZW50LWx1bWluYW5jZSgkYik7XG5cbiAgICBAcmV0dXJuICRyICogMC4yMTI2ICsgJGcgKiAwLjcxNTIgKyAkYiAqIDAuMDcyMjtcbn1cblxuQGZ1bmN0aW9uIGNvbXBvbmVudC1sdW1pbmFuY2UoJHZhbHVlKSB7XG4gICAgJHZhbHVlOiBtYXRoLmRpdigkdmFsdWUsIDI1NSk7XG5cbiAgICBAaWYgKCR2YWx1ZSA8PSAwLjAzOTI4KSB7XG4gICAgICAgIEByZXR1cm4gbWF0aC5kaXYoJHZhbHVlLCAxMi45Mik7XG4gICAgfSBAZWxzZSB7XG4gICAgICAgIEByZXR1cm4gbWF0aC5wb3cobWF0aC5kaXYoJHZhbHVlICsgMC4wNTUsIDEuMDU1KSwgMi40KTtcbiAgICB9XG59XG4iLCIvKlxuICogQXBwIEN1c3RvbSBBcHAgdmFyaWFibGVzIFNDU1NcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqIFBsYWNlIGhlcmUgYWxsIGN1c3RvbSBhcHAgdmFyaWFibGVzLlxuICovXG4iLCIvKlxuICogQXBwIEdsb2JhbCB2YXJpYWJsZXMgU0NTU1xuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogUGxhY2UgaGVyZSBhbGwgZ2xvYmFsIHZhcmlhYmxlcy5cbiAqL1xuXG4kd2hpdGU6ICAgICAgICNmZmZmZmYgIWRlZmF1bHQ7XG4kZ3JheS0xMDA6ICAgICNmOGY5ZmEgIWRlZmF1bHQ7XG4kZ3JheS0yMDA6ICAgICNlOWVjZWYgIWRlZmF1bHQ7XG4kZ3JheS0zMDA6ICAgICNkZWUyZTYgIWRlZmF1bHQ7IC8vIFN0cm9rZVxuJGdyYXktNDAwOiAgICAjY2VkNGRhICFkZWZhdWx0O1xuJGdyYXktNTAwOiAgICAjOGY5NTllICFkZWZhdWx0OyAvLyBTdHJva2Ugb24gaW5wdXRzXG4kZ3JheS02MDA6ICAgICM2YTczN2IgIWRlZmF1bHQ7XG4kZ3JheS03MDA6ICAgICM0OTUwNTcgIWRlZmF1bHQ7XG4kZ3JheS04MDA6ICAgICMzNDNhNDAgIWRlZmF1bHQ7XG4kZ3JheS05MDA6ICAgICMyODI4MjggIWRlZmF1bHQ7IC8vIENvcHkgdGV4dFxuJGJsYWNrOiAgICAgICAjMDAwMDAwICFkZWZhdWx0OyAvLyBBdm9pZCB1c2FnZVxuXG4kYmx1ZTogICAgICAgICMwZjZjYmYgIWRlZmF1bHQ7XG4kY3lhbjogICAgICAgICMwMDgxOTYgIWRlZmF1bHQ7IC8vIE5vdCB1c2VkLlxuJGdyZWVuOiAgICAgICAjMzU3YTMyICFkZWZhdWx0O1xuJHJlZDogICAgICAgICAjY2EzMTIwICFkZWZhdWx0O1xuJHllbGxvdzogICAgICAjZjBhZDRlICFkZWZhdWx0O1xuXG4kYnJhbmQtY29sb3I6ICNmOTgwMTIgIWRlZmF1bHQ7XG5cbiR0ZXh0LWNvbG9yOiAgICAgICAgICAgICAgICRncmF5LTkwMCAhZGVmYXVsdDtcbiR0ZXh0LWNvbG9yLXJnYjogICAgICAgICAgIGNvbG9yLXRvLXJnYi1saXN0KCR0ZXh0LWNvbG9yKSAhZGVmYXVsdDtcbiR0ZXh0LWNvbG9yLWRhcms6ICAgICAgICAgICR3aGl0ZSAhZGVmYXVsdDtcbiR0ZXh0LWNvbG9yLWRhcmstcmdiOiAgICAgIGNvbG9yLXRvLXJnYi1saXN0KCR0ZXh0LWNvbG9yLWRhcmspICFkZWZhdWx0O1xuXG4kYmFja2dyb3VuZC1jb2xvcjogICAgICAgICAgJHdoaXRlICFkZWZhdWx0O1xuJGJhY2tncm91bmQtY29sb3ItcmdiOiAgICAgIGNvbG9yLXRvLXJnYi1saXN0KCRiYWNrZ3JvdW5kLWNvbG9yKSAhZGVmYXVsdDtcbiRiYWNrZ3JvdW5kLWNvbG9yLWRhcms6ICAgICAkZ3JheS05MDAgIWRlZmF1bHQ7IC8vICMxYTFhMWFcbiRiYWNrZ3JvdW5kLWNvbG9yLWRhcmstcmdiOiBjb2xvci10by1yZ2ItbGlzdCgkYmFja2dyb3VuZC1jb2xvci1kYXJrKSAhZGVmYXVsdDtcblxuJGlvbi1pdGVtLWJhY2tncm91bmQ6ICAgICAgJHdoaXRlICFkZWZhdWx0O1xuJGlvbi1pdGVtLWJhY2tncm91bmQtcmdiOiAgY29sb3ItdG8tcmdiLWxpc3QoJGlvbi1pdGVtLWJhY2tncm91bmQpICFkZWZhdWx0O1xuJGlvbi1pdGVtLWJhY2tncm91bmQtZGFyazogJGdyYXktOTAwICFkZWZhdWx0O1xuJGlvbi1pdGVtLWJhY2tncm91bmQtZGFyay1yZ2I6IGNvbG9yLXRvLXJnYi1saXN0KCRpb24taXRlbS1iYWNrZ3JvdW5kLWRhcmspICFkZWZhdWx0O1xuXG4kcHJpbWFyeTogICAgJGJyYW5kLWNvbG9yICFkZWZhdWx0O1xuJHNlY29uZGFyeTogICRncmF5LTMwMCAhZGVmYXVsdDtcbiRkYW5nZXI6ICAgICAkcmVkICFkZWZhdWx0O1xuJHdhcm5pbmc6ICAgICR5ZWxsb3cgIWRlZmF1bHQ7XG4kc3VjY2VzczogICAgJGdyZWVuICFkZWZhdWx0O1xuJGluZm86ICAgICAgICRibHVlICFkZWZhdWx0O1xuJGxpZ2h0OiAgICAgICRncmF5LTEwMCAhZGVmYXVsdDtcbiRtZWRpdW06ICAgICAkZ3JheS03MDAgIWRlZmF1bHQ7XG4kZGFyazogICAgICAgJGdyYXktOTAwICFkZWZhdWx0O1xuXG4kY29sb3JzOiAgKFxuICAgIHByaW1hcnk6IChsaWdodDogJHByaW1hcnksIGRhcms6ICRwcmltYXJ5KSxcbiAgICBzZWNvbmRhcnk6IChsaWdodDogJHNlY29uZGFyeSwgZGFyazogJGdyYXktNzAwKSxcbiAgICBzdWNjZXNzOiAobGlnaHQ6ICRzdWNjZXNzKSxcbiAgICB3YXJuaW5nOiAobGlnaHQ6ICR3YXJuaW5nKSxcbiAgICBkYW5nZXI6ICAobGlnaHQ6ICRkYW5nZXIpLFxuICAgIGluZm86IChsaWdodDogJGluZm8pLFxuICAgIGxpZ2h0OiAobGlnaHQ6ICRsaWdodCwgZGFyazogJGRhcmspLFxuICAgIG1lZGl1bTogKGxpZ2h0OiAkbWVkaXVtLCBkYXJrOiAkZ3JheS0yMDApLFxuICAgIGRhcms6IChsaWdodDogJGRhcmssIGRhcms6ICRsaWdodCksXG4pICFkZWZhdWx0O1xuXG4vKipcbiAqIExheW91dCBCcmVha3BvaW50c1xuICpcbiAqIGh0dHBzOi8vaW9uaWNmcmFtZXdvcmsuY29tL2RvY3MvbGF5b3V0L2dyaWQjZGVmYXVsdC1icmVha3BvaW50c1xuICovXG5cbi8vIFRoZSBtaW5pbXVtIGRpbWVuc2lvbnMgYXQgd2hpY2ggeW91ciBsYXlvdXQgd2lsbCBjaGFuZ2UsXG4vLyBhZGFwdGluZyB0byBkaWZmZXJlbnQgc2NyZWVuIHNpemVzLCBmb3IgdXNlIGluIG1lZGlhIHF1ZXJpZXNcbiRzY3JlZW4tYnJlYWtwb2ludHM6IChcbiAgICB4czogMHB4LFxuICAgIHNtOiA1NzZweCxcbiAgICBtZDogNzY4cHgsXG4gICAgbGc6IDk5MnB4LFxuICAgIHRhYmxldDogOTkycHgsXG4gICAgeGw6IDEyMDBweFxuKSAhZGVmYXVsdDtcblxuJGNvcmUtY291cnNlLWltYWdlLWJhY2tncm91bmQ6ICM4MWVjZWMsICM3NGI5ZmYsICNhMjliZmUsICNkZmU2ZTksICMwMGI4OTQsICMwOTg0ZTMsICNiMmJlYzMsICNmZGNiNmUsICNmZDc5YTgsICM2YzVjZTcgIWRlZmF1bHQ7XG4kY29yZS1kZC1xdWVzdGlvbi1jb2xvcnM6ICNGRkZGRkYsICNCMEM0REUsICNEQ0RDREMsICNEOEJGRDgsICM4N0NFRkEsICNEQUE1MjAsICNGRkQ3MDAsICNGMEU2OEMgIWRlZmF1bHQ7XG4kY29yZS10ZXh0LWhpZ2h0bGlnaHQtYmFja2dyb3VuZC1jb2xvcjogbGlnaHRlbigkYmx1ZSwgNDAlKSAhZGVmYXVsdDtcblxuJGNvcmUtZml4ZWQtdXJsOiBmYWxzZSAhZGVmYXVsdDtcbiRjb3JlLWRhc2hib2FyZC1sb2dvOiBmYWxzZSAhZGVmYXVsdDtcbiRjb3JlLWFsd2F5cy1zaG93LW1haW4tbWVudTogZmFsc2UgIWRlZmF1bHQ7XG4kY29yZS1mb3JtYXQtdGV4dC1uZXZlci1zaG9ydGVuOiBmYWxzZSAhZGVmYXVsdDtcblxuJGNvcmUtaGlkZS1jb3Vyc2VpbWFnZS1vbi1jb3Vyc2U6IGZhbHNlICFkZWZhdWx0O1xuJGNvcmUtaGlkZS1wcm9ncmVzcy1vbi1jb3Vyc2U6IGZhbHNlICFkZWZhdWx0O1xuJGNvcmUtaGlkZS1wcm9ncmVzcy1vbi1zZWN0aW9uLXNlbGVjdG9yOiBmYWxzZSAhZGVmYXVsdDtcblxuJGNvcmUtY291cnNlLWhpZGUtdGh1bWItb24tY2FyZHM6IGZhbHNlICFkZWZhdWx0O1xuJGNvcmUtY291cnNlLXRodW1iLW9uLWNhcmRzLWJhY2tncm91bmQ6IG51bGwgIWRlZmF1bHQ7XG4kY29yZS1jb3Vyc2UtaGlkZS1wcm9ncmVzcy1vbi1jYXJkczogZmFsc2UgIWRlZmF1bHQ7XG5cbi8vIENvbmZpZ3VyYXRpb24gb3B0aW9ucyBmb3IgbG9naW4gcGFnZS5cbiRjb3JlLWxvZ2luLWJ1dHRvbi1vdXRsaW5lOiBmYWxzZSAhZGVmYXVsdDtcbiRjb3JlLWxvZ2luLWJ1dHRvbi1vdXRsaW5lLWRhcms6ICRjb3JlLWxvZ2luLWJ1dHRvbi1vdXRsaW5lICFkZWZhdWx0O1xuJGNvcmUtbG9naW4tbG9hZGluZy1jb2xvcjogZmFsc2UgIWRlZmF1bHQ7XG4kY29yZS1sb2dpbi1sb2FkaW5nLWNvbG9yLWRhcms6ICR0ZXh0LWNvbG9yLWRhcmsgIWRlZmF1bHQ7XG4kY29yZS1sb2dpbi1oaWRlLWZvcmdvdC1wYXNzd29yZDogZmFsc2UgIWRlZmF1bHQ7XG4kY29yZS1sb2dpbi1oaWRlLW5lZWQtaGVscDogZmFsc2UgIWRlZmF1bHQ7XG4kY29yZS1sb2dpbi1oaWRlLXFyY29kZTogZmFsc2UgIWRlZmF1bHQ7XG5cbi8vIENvbmZpZ3VyYXRpb24gb3B0aW9ucyBmb3IgbW9yZSBwYWdlLiAoZGVwcmVjYXRlZCBvbiA0LjApXG4kY29yZS1tb3JlLWhpZGUtc2l0ZWluZm86IGZhbHNlICFkZWZhdWx0O1xuJGNvcmUtbW9yZS1oaWRlLXNpdGVuYW1lOiBmYWxzZSAhZGVmYXVsdDtcbiRjb3JlLW1vcmUtaGlkZS1zaXRldXJsOiBmYWxzZSAhZGVmYXVsdDtcblxuLy8gQ29uZmlndXJhdGlvbiBvcHRpb25zIGZvciB1c2VyIHBhZ2UuXG4kY29yZS11c2VyLWhpZGUtc2l0ZWluZm86ICRjb3JlLW1vcmUtaGlkZS1zaXRlaW5mbyAhZGVmYXVsdDtcbiRjb3JlLXVzZXItaGlkZS1zaXRlbmFtZTogJGNvcmUtbW9yZS1oaWRlLXNpdGVuYW1lICFkZWZhdWx0O1xuJGNvcmUtdXNlci1oaWRlLXNpdGV1cmw6ICRjb3JlLW1vcmUtaGlkZS1zaXRldXJsICFkZWZhdWx0O1xuXG4vLyBBY3Rpdml0eSBpY29uIGJhY2tncm91bmQgY29sb3JzLlxuJGFjdGl2aXR5LWljb24tY29sb3JzOiAoXG4gICAgYWRtaW5pc3RyYXRpb246ICM1ZDYzZjYsXG4gICAgYXNzZXNzbWVudDogI2ViNjZhMixcbiAgICBjb2xsYWJvcmF0aW9uOiAjZjc2MzRkLFxuICAgIGNvbW11bmljYXRpb246ICMxMWE2NzYsXG4gICAgY29udGVudDogIzM5OWJlMixcbiAgICBpbnRlcmZhY2U6ICNhMzc4ZmZcbikgIWRlZmF1bHQ7XG5cbiRjYWxlbmRhci1ldmVudC1jYXRlZ29yeS1jYXRlZ29yeTogIzhlMjRhYSAhZGVmYXVsdDtcbiRjYWxlbmRhci1ldmVudC1jYXRlZ29yeS1jb3Vyc2U6ICRyZWQgIWRlZmF1bHQ7XG4kY2FsZW5kYXItZXZlbnQtY2F0ZWdvcnktZ3JvdXA6ICR5ZWxsb3cgIWRlZmF1bHQ7XG4kY2FsZW5kYXItZXZlbnQtY2F0ZWdvcnktdXNlcjogJGJsdWUgIWRlZmF1bHQ7XG4kY2FsZW5kYXItZXZlbnQtY2F0ZWdvcnktc2l0ZTogJGdyZWVuICFkZWZhdWx0O1xuXG4vLyBDYWxlbmRhciBldmVudCBjYXRlZ29yeSBiYWNrZ3JvdW5kIGNvbG9ycy5cbiRjYWxlbmRhci1ldmVudC1jYXRlZ29yeS1jb2xvcnM6IChcbiAgICBjYXRlZ29yeTogJGNhbGVuZGFyLWV2ZW50LWNhdGVnb3J5LWNhdGVnb3J5LFxuICAgIGNvdXJzZTogJGNhbGVuZGFyLWV2ZW50LWNhdGVnb3J5LWNvdXJzZSxcbiAgICBncm91cDogJGNhbGVuZGFyLWV2ZW50LWNhdGVnb3J5LWdyb3VwLFxuICAgIHVzZXI6ICRjYWxlbmRhci1ldmVudC1jYXRlZ29yeS11c2VyLFxuICAgIHNpdGU6ICRjYWxlbmRhci1ldmVudC1jYXRlZ29yeS1zaXRlLFxuKSAhZGVmYXVsdDtcbiIsIkB1c2UgXCJ0aGVtZS9nbG9iYWxzXCIgYXMgKjtcblxuOmhvc3Qge1xuXG4gICAgLmFkZG9uLW1lc3NhZ2VzLXVucmVhZGZyb20ge1xuICAgICAgICBjb2xvcjogdmFyKC0tcHJpbWFyeSk7XG4gICAgICAgIGJhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50O1xuICAgICAgICBtYXJnaW4tdG9wOiA2cHg7XG4gICAgICAgIG1hcmdpbi1sZWZ0OiBhdXRvO1xuICAgICAgICBtYXJnaW4tcmlnaHQ6IGF1dG87XG4gICAgICAgIGlvbi1pY29uIHtcbiAgICAgICAgICAgIGNvbG9yOiB2YXIoLS1wcmltYXJ5KTtcbiAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAuaGFzLWZhYiAuc2Nyb2xsLWNvbnRlbnQge1xuICAgICAgICBwYWRkaW5nLWJvdHRvbTogMDtcbiAgICB9XG5cbiAgICBpb24tZmFiIC5jb3JlLWRpc2N1c3Npb24tbWVzc2FnZXMtYmFkZ2Uge1xuICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICAgIGNvbG9yOiB2YXIoLS1hZGRvbi1tZXNzYWdlcy1kaXNjdXNzaW9uLWJhZGdlLXRleHQpO1xuICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1hZGRvbi1tZXNzYWdlcy1kaXNjdXNzaW9uLWJhZGdlKTtcbiAgICAgICAgZGlzcGxheTogYmxvY2s7XG4gICAgICAgIEBpbmNsdWRlIHBvc2l0aW9uKDAsIDAsIG51bGwsIG51bGwpO1xuICAgIH1cblxuICAgIGlvbi1oZWFkZXIgaW9uLXRvb2xiYXIgaW9uLXRpdGxlIHtcbiAgICAgICAgcGFkZGluZzogMDtcblxuICAgICAgICBoMSB7XG4gICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgICAgIHBhZGRpbmc6IDA7XG5cbiAgICAgICAgICAgIC5jb3JlLWJhci1idXR0b24taW1hZ2Uge1xuICAgICAgICAgICAgICAgIEBpbmNsdWRlIG1hcmdpbi1ob3Jpem9udGFsKG51bGwsIDZweCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvcmUtZm9ybWF0LXRleHQge1xuICAgICAgICAgICAgICAgIG92ZXJmbG93OiBoaWRkZW47XG4gICAgICAgICAgICAgICAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7XG4gICAgICAgICAgICAgICAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcbiAgICAgICAgICAgICAgICBmbGV4LXNocmluazogMTtcbiAgICAgICAgICAgICAgICBkaXNwbGF5OiBibG9jaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaW9uLWljb24ge1xuICAgICAgICAgICAgICAgIEBpbmNsdWRlIG1hcmdpbi1ob3Jpem9udGFsKDZweCwgbnVsbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5cbjpob3N0LWNvbnRleHQoLmlvcykge1xuICAgIGlvbi1oZWFkZXIgaW9uLXRvb2xiYXIgaDEge1xuICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbiAgICB9XG59XG4iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n});","map":{"version":3,"names":["IonContent","CoreEvents","CoreSites","AddonMessagesProvider","AddonMessages","AddonMessagesOffline","AddonMessagesSync","AddonMessagesSyncProvider","CoreUser","CoreDomUtils","CoreUtils","CoreTextUtils","CoreLogger","CoreApp","CoreInfiniteLoadingComponent","Md5","moment","CoreError","Translate","CoreNavigator","CoreConstants","CoreDom","i0","ɵɵelement","ɵɵproperty","ctx_r0","conversationImage","ɵɵsanitizeUrl","siteId","ctx_r1","otherMember","showonlinestatus","ɵɵattribute","ɵɵpipeBind1","ɵɵelementContainerStart","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵelementContainerEnd","ɵɵadvance","ɵɵtextInterpolate","ɵɵtextInterpolate1","ɵɵpipeBind2","message_r9","timecreated","ɵɵtemplate","AddonMessagesDiscussionPage_ng_container_43_h3_1_Template","AddonMessagesDiscussionPage_ng_container_43_ion_chip_2_Template","ɵɵlistener","AddonMessagesDiscussionPage_ng_container_43_Template_core_message_afterRender_3_listener","restoredCtx","ɵɵrestoreView","_r16","last_r11","last","ctx_r15","ɵɵnextContext","ɵɵresetView","scrollToBottom","AddonMessagesDiscussionPage_ng_container_43_Template_core_message_onDeleteMessage_3_listener","$implicit","index_r10","index","ctx_r17","deleteMessage","showDate","ctx_r5","unreadMessageFrom","id","members","useridfrom","text","showDelete","AddonMessagesDiscussionPage_ion_fab_45_Template_ion_fab_button_click_1_listener","_r19","ctx_r18","scrollToFirstUnreadMessage","ctx_r7","newMessages","AddonMessagesDiscussionPage_ion_footer_46_div_3_Template_ion_button_click_4_listener","_r27","ctx_r26","unblockUser","AddonMessagesDiscussionPage_ion_footer_46_div_4_Template_ion_button_click_8_listener","_r29","ctx_r28","createContactRequest","ɵɵpureFunction1","_c0","ctx_r22","fullname","AddonMessagesDiscussionPage_ion_footer_46_div_5_Template_ion_button_click_4_listener","_r31","ctx_r30","confirmContactRequest","AddonMessagesDiscussionPage_ion_footer_46_div_5_Template_ion_button_click_7_listener","ctx_r32","declineContactRequest","ctx_r23","ctx_r33","AddonMessagesDiscussionPage_ion_footer_46_div_6_p_5_Template","ctx_r24","AddonMessagesDiscussionPage_ion_footer_46_core_send_message_form_7_Template_core_send_message_form_onSubmit_0_listener","$event","_r35","ctx_r34","sendMessage","ctx_r25","showKeyboard","AddonMessagesDiscussionPage_ion_footer_46_p_2_Template","AddonMessagesDiscussionPage_ion_footer_46_div_3_Template","AddonMessagesDiscussionPage_ion_footer_46_div_4_Template","AddonMessagesDiscussionPage_ion_footer_46_div_5_Template","AddonMessagesDiscussionPage_ion_footer_46_div_6_Template","AddonMessagesDiscussionPage_ion_footer_46_core_send_message_form_7_Template","ctx_r8","footerType","requestContactSent","AddonMessagesDiscussionPage","constructor","route","elementRef","fetching","messagesBeingSent","pagesLoaded","keepMessageMap","oldContentHeight","scrollBottom","viewDestroyed","showLoadingModal","showInfo","loaded","canLoadMore","loadMoreError","messages","canDelete","isGroup","favouriteIcon","deleteIcon","blockIcon","addRemoveIcon","muteIcon","favouriteIconSlash","muteEnabled","requestContactReceived","isSelf","initialized","hostElement","nativeElement","getCurrentSiteId","currentUserId","getCurrentSiteUserId","groupMessagingEnabled","isGroupMessagingEnabled","isMuteConversationEnabled","logger","getInstance","syncObserver","on","AUTO_SYNCED","data","userId","conversationId","fetchMessages","warnings","showAlert","undefined","memberInfoObserver","MEMBER_INFO_CHANGED_EVENT","fetchData","ngOnInit","_this","_asyncToGenerator","getRouteNumberParam","getRouteBooleanParam","ngAfterViewInit","_this2","_this2$content","scrollElement","content","getScrollElement","addMessage","message","keep","hash","hashAsciiStr","String","added","push","removeMessage","position","findIndex","splice","_this3","loader","showModalLoading","getProfile","then","user","title","profileimageurl","catch","syncResult","syncDiscussion","_unused","promises","exists","getConversation","invalidateMemberInfo","getMemberInfo","isblocked","_ref2","profileurl","profileimageurlsmall","isonline","iscontact","isdeleted","canmessageevenifblocked","canmessage","requirescontact","isBlocked","isContact","_x","apply","arguments","length","firstMessage","useridto","usertofullname","userfromfullname","Promise","all","error","showErrorModalDefault","checkCanDelete","setPolling","setContactRequestInfo","setFooterType","dismiss","ionViewDidEnter","ionViewWillLeave","unsetPolling","messagesAreNew","_this4","debug","waitForSyncConversation","invalidateConversationMessages","getConversationMessages","invalidateDiscussionCache","getDiscussionMessages","loadMessages","scrollIsBottom","reduce","val","setNewMessagesBadge","sortMessages","forEach","showUserData","showTail","forceMark","lastMessage","notifyNewMessage","markMessagesAsRead","addMessages","scrollFunction","_this$scrollElement","scrollElRect","getBoundingClientRect","scrollBottomPos","bottom","Array","from","querySelectorAll","slice","reverse","newMessagesUnread","elementRect","_this5","fallbackConversation","isSelfConversationEnabled","getSelfConversation","getConversationBetweenUsers","getMessages","pending","smallmessage","errorcode","invalidateConversation","conversation","name","imageurl","type","MESSAGE_CONVERSATION_TYPE_GROUP","isfavourite","ismuted","userid","MESSAGE_CONVERSATION_TYPE_SELF","pagesToLoad","offset","_this6","excludePending","result","limitFrom","member","LIMIT_MESSAGES","nextMessages","concat","lfReceivedUnread","lfReceivedRead","lfSentUnread","lfSentRead","_this7","getDiscussion","read","_this8","readChanged","messageUnreadFound","_this8$conversation","_this8$conversation2","unreadcount","some","setUnreadLabelPosition","markAllConversationMessagesRead","markAllMessagesRead","trigger","READ_CHANGED_EVENT","_this$lastMessage","_this$lastMessage2","_this$lastMessage3","_this$lastMessage$tim","_this$lastMessage4","_this$conversation","_this$conversation2","NEW_MESSAGE_EVENT","userFrom","newCanDelete","_this$conversation3","_this$conversation4","found","i","Number","previousMessageRead","x","unreadFrom","first","sending","hideUnreadLabel","waitForFetch","_this9","wait","ignoreErrors","polling","window","setInterval","POLL_INTERVAL","clearInterval","copyMessage","copyToClipboard","decodeHTMLEntities","_this10","canDeleteAll","candeletemessagesforallusers","langKey","options","inputs","checked","value","label","instant","showConfirm","modal","loadPrevious","infiniteComplete","_this11","_this11$infinite","_this11$scrollElement","infiniteHeight","infinite","height","scrollHeight","_this11$scrollElement2","_this11$infinite2","scrollTop","keepScroll","oldScrollHeight","oldScrollBottom","retries","setTimeout","_this$scrollElement2","newScrollHeight","_this$scrollElement3","scrollTo","scrollToPoint","force","_this12","nextTicks","scrollToElement","_this13","Date","now","sendMessageToConversation","failure","sent","conversationid","_unused2","closeKeyboard","prevMessage","isSame","nextMessage","viewInfo","_this14","AddonMessagesConversationInfoComponent","openSideModal","component","componentProps","splitViewLoaded","isCurrentPathInTablet","OPEN_CONVERSATION_EVENT","navigateToSitePath","params","changeFavourite","done","_this15","ICON_LOADING","setFavouriteConversation","UPDATE_CONVERSATION_LIST_EVENT","action","changeMute","_this16","muteConversation","_this$otherMember$con","_this$otherMember$con2","contactrequests","request","requesteduserid","blockUser","_this17","showErrorModal","$a","template","okText","blockContact","_unused3","deleteConversation","_this18","confirmMessage","showDeleteConfirm","_unused4","_this19","unblockContact","_unused5","_this20","_unused6","_this21","_this22","removeContact","_this23","_unused7","ngOnDestroy","_this$syncObserver","_this$memberInfoObser","off","ɵɵdirectiveInject","i1","ActivatedRoute","ElementRef","selectors","viewQuery","AddonMessagesDiscussionPage_Query","rf","ctx","AddonMessagesDiscussionPage_img_7_Template","AddonMessagesDiscussionPage_core_user_avatar_8_Template","AddonMessagesDiscussionPage_ion_icon_10_Template","AddonMessagesDiscussionPage_ion_icon_11_Template","AddonMessagesDiscussionPage_Template_core_context_menu_item_action_16_listener","AddonMessagesDiscussionPage_Template_core_context_menu_item_action_18_listener","AddonMessagesDiscussionPage_Template_core_context_menu_item_action_20_listener","AddonMessagesDiscussionPage_Template_core_context_menu_item_action_22_listener","AddonMessagesDiscussionPage_Template_core_context_menu_item_action_24_listener","AddonMessagesDiscussionPage_Template_core_context_menu_item_action_26_listener","AddonMessagesDiscussionPage_Template_core_context_menu_item_toggleChange_28_listener","AddonMessagesDiscussionPage_Template_core_context_menu_item_action_30_listener","AddonMessagesDiscussionPage_Template_core_context_menu_item_action_32_listener","AddonMessagesDiscussionPage_Template_core_context_menu_item_action_34_listener","AddonMessagesDiscussionPage_Template_ion_content_ionScroll_36_listener","AddonMessagesDiscussionPage_Template_core_infinite_loading_action_38_listener","AddonMessagesDiscussionPage_ng_container_39_Template","AddonMessagesDiscussionPage_ng_container_43_Template","AddonMessagesDiscussionPage_core_empty_box_44_Template","AddonMessagesDiscussionPage_ion_fab_45_Template","AddonMessagesDiscussionPage_ion_footer_46_Template","ɵɵclassProp"],"sources":["/home/toon/works/gitionic7/ionic-github/ionic/src/addons/messages/pages/discussion/discussion.ts","/home/toon/works/gitionic7/ionic-github/ionic/src/addons/messages/pages/discussion/discussion.html"],"sourcesContent":["// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { AfterViewInit, Component, ElementRef, OnDestroy, OnInit, ViewChild } from '@angular/core';\nimport { IonContent } from '@ionic/angular';\nimport { AlertOptions } from '@ionic/core';\nimport { CoreEventObserver, CoreEvents } from '@singletons/events';\nimport { CoreSites } from '@services/sites';\nimport {\n    AddonMessagesProvider,\n    AddonMessagesConversationFormatted,\n    AddonMessagesConversationMember,\n    AddonMessagesGetMessagesMessage,\n    AddonMessages,\n    AddonMessagesConversationMessageFormatted,\n    AddonMessagesSendMessageResults,\n} from '../../services/messages';\nimport { AddonMessagesOffline, AddonMessagesOfflineMessagesDBRecordFormatted } from '../../services/messages-offline';\nimport { AddonMessagesSync, AddonMessagesSyncProvider } from '../../services/messages-sync';\nimport { CoreUser } from '@features/user/services/user';\nimport { CoreDomUtils } from '@services/utils/dom';\nimport { CoreUtils } from '@services/utils/utils';\nimport { CoreTextUtils } from '@services/utils/text';\nimport { CoreLogger } from '@singletons/logger';\nimport { CoreApp } from '@services/app';\nimport { CoreInfiniteLoadingComponent } from '@components/infinite-loading/infinite-loading';\nimport { Md5 } from 'ts-md5/dist/md5';\nimport moment from 'moment-timezone';\nimport { CoreError } from '@classes/errors/error';\nimport { Translate } from '@singletons';\nimport { CoreNavigator } from '@services/navigator';\nimport { CoreIonLoadingElement } from '@classes/ion-loading';\nimport { ActivatedRoute } from '@angular/router';\nimport { CoreConstants } from '@/core/constants';\nimport { CoreDom } from '@singletons/dom';\n\n/**\n * Page that displays a message discussion page.\n */\n@Component({\n    selector: 'page-addon-messages-discussion',\n    templateUrl: 'discussion.html',\n    styleUrls: ['../../../../theme/components/discussion.scss', 'discussion.scss'],\n})\nexport class AddonMessagesDiscussionPage implements OnInit, OnDestroy, AfterViewInit {\n\n    @ViewChild(IonContent) content?: IonContent;\n    @ViewChild(CoreInfiniteLoadingComponent) infinite?: CoreInfiniteLoadingComponent;\n\n    protected fetching = false;\n    protected polling?: number;\n    protected logger: CoreLogger;\n\n    protected messagesBeingSent = 0;\n    protected pagesLoaded = 1;\n    protected lastMessage?: { text: string; timecreated: number };\n    protected keepMessageMap: {[hash: string]: boolean} = {};\n    protected syncObserver: CoreEventObserver;\n    protected oldContentHeight = 0;\n    protected scrollBottom = true;\n    protected viewDestroyed = false;\n    protected memberInfoObserver: CoreEventObserver;\n    protected showLoadingModal = false; // Whether to show a loading modal while fetching data.\n    protected hostElement: HTMLElement;\n\n    conversationId?: number; // Conversation ID. Undefined if it's a new individual conversation.\n    conversation?: AddonMessagesConversationFormatted; // The conversation object (if it exists).\n    userId?: number; // User ID you're talking to (only if group messaging not enabled or it's a new individual conversation).\n    currentUserId: number;\n    siteId: string;\n    title?: string;\n    showInfo = false;\n    conversationImage?: string;\n    loaded = false;\n    showKeyboard = false;\n    canLoadMore = false;\n    loadMoreError = false;\n    messages: AddonMessagesConversationMessageFormatted[] = [];\n    showDelete = false;\n    canDelete = false;\n    groupMessagingEnabled: boolean;\n    isGroup = false;\n    members: {[id: number]: AddonMessagesConversationMember} = {}; // Members that wrote a message, indexed by ID.\n    favouriteIcon = 'fa-star';\n    deleteIcon = 'fas-trash';\n    blockIcon = 'fas-user-lock';\n    addRemoveIcon = 'fas-user-plus';\n    muteIcon = 'fas-bell-slash';\n    favouriteIconSlash = false;\n    muteEnabled = false;\n    otherMember?: AddonMessagesConversationMember; // Other member information (individual conversations only).\n    footerType: 'message' | 'blocked' | 'requiresContact' | 'requestSent' | 'requestReceived' | 'unable' = 'unable';\n    requestContactSent = false;\n    requestContactReceived = false;\n    isSelf = false;\n    newMessages = 0;\n    scrollElement?: HTMLElement;\n    unreadMessageFrom = 0;\n    initialized = false;\n\n    constructor(\n        protected route: ActivatedRoute,\n        protected elementRef: ElementRef<HTMLElement>,\n    ) {\n        this.hostElement = elementRef.nativeElement;\n        this.siteId = CoreSites.getCurrentSiteId();\n        this.currentUserId = CoreSites.getCurrentSiteUserId();\n        this.groupMessagingEnabled = AddonMessages.isGroupMessagingEnabled();\n        this.muteEnabled = AddonMessages.isMuteConversationEnabled();\n\n        this.logger = CoreLogger.getInstance('AddonMessagesDiscussionPage');\n\n        // Refresh data if this discussion is synchronized automatically.\n        this.syncObserver = CoreEvents.on(AddonMessagesSyncProvider.AUTO_SYNCED, (data) => {\n            if ((data.userId && data.userId == this.userId) ||\n                    (data.conversationId && data.conversationId == this.conversationId)) {\n                // Fetch messages.\n                this.fetchMessages();\n\n                // Show first warning if any.\n                if (data.warnings && data.warnings[0]) {\n                    CoreDomUtils.showAlert(undefined, data.warnings[0]);\n                }\n            }\n        }, this.siteId);\n\n        // Refresh data if info of a mamber of the conversation have changed.\n        this.memberInfoObserver = CoreEvents.on(\n            AddonMessagesProvider.MEMBER_INFO_CHANGED_EVENT,\n            (data) => {\n                if (data.userId && (this.members[data.userId] || this.otherMember && data.userId == this.otherMember.id)) {\n                    this.fetchData();\n                }\n            },\n            this.siteId,\n        );\n    }\n\n    /**\n     * Runs when the page has loaded. This event only happens once per page being created.\n     * If a page leaves but is cached, then this event will not fire again on a subsequent viewing.\n     * Setup code for the page.\n     */\n    async ngOnInit(): Promise<void> {\n        this.conversationId = CoreNavigator.getRouteNumberParam('conversationId');\n        this.userId = CoreNavigator.getRouteNumberParam('userId');\n        this.showInfo = !CoreNavigator.getRouteBooleanParam('hideInfo');\n        this.showKeyboard = !!CoreNavigator.getRouteBooleanParam('showKeyboard');\n\n        await this.fetchData();\n\n        this.scrollToBottom(true);\n    }\n\n    /**\n     * View has been initialized.\n     */\n    async ngAfterViewInit(): Promise<void> {\n        this.scrollElement = await this.content?.getScrollElement();\n    }\n\n    /**\n     * Adds a new message to the message list.\n     *\n     * @param message Message to be added.\n     * @param keep If set the keep flag or not.\n     * @returns If message is not mine and was recently added.\n     */\n    protected addMessage(\n        message: AddonMessagesConversationMessageFormatted,\n        keep: boolean = true,\n    ): boolean {\n\n        /* Create a hash to identify the message. The text of online messages isn't reliable because it can have random data\n           like VideoJS ID. Try to use id and fallback to text for offline messages. */\n        const id = 'id' in message ? message.id : '';\n        message.hash = Md5.hashAsciiStr(String(id || message.text || '')) + '#' + message.timecreated + '#' +\n                message.useridfrom;\n\n        let added = false;\n        if (this.keepMessageMap[message.hash] === undefined) {\n            // Message not added to the list. Add it now.\n            this.messages.push(message);\n            added = message.useridfrom != this.currentUserId;\n        }\n        // Message needs to be kept in the list.\n        this.keepMessageMap[message.hash] = keep;\n\n        return added;\n    }\n\n    /**\n     * Remove a message if it shouldn't be in the list anymore.\n     *\n     * @param hash Hash of the message to be removed.\n     */\n    protected removeMessage(hash: string): void {\n        if (this.keepMessageMap[hash]) {\n            // Selected to keep it, clear the flag.\n            this.keepMessageMap[hash] = false;\n\n            return;\n        }\n\n        delete this.keepMessageMap[hash];\n\n        const position = this.messages.findIndex((message) => message.hash == hash);\n        if (position >= 0) {\n            this.messages.splice(position, 1);\n        }\n    }\n\n    /**\n     * Convenience function to fetch the conversation data.\n     *\n     * @returns Resolved when done.\n     */\n    protected async fetchData(): Promise<void> {\n        let loader: CoreIonLoadingElement | undefined;\n        if (this.showLoadingModal) {\n            loader = await CoreDomUtils.showModalLoading();\n        }\n\n        if (!this.groupMessagingEnabled && this.userId) {\n            // Get the user profile to retrieve the user fullname and image.\n            CoreUser.getProfile(this.userId, undefined, true).then((user) => {\n                if (!this.title) {\n                    this.title = user.fullname;\n                }\n                this.conversationImage = user.profileimageurl;\n                this.members[user.id] = <AddonMessagesConversationMember>user;\n\n                return;\n            }).catch(() => {\n                // Ignore errors.\n            });\n        }\n\n        // Synchronize messages if needed.\n        try {\n            const syncResult = await AddonMessagesSync.syncDiscussion(this.conversationId, this.userId);\n            if (syncResult.warnings && syncResult.warnings[0]) {\n                CoreDomUtils.showAlert(undefined, syncResult.warnings[0]);\n            }\n        } catch {\n            // Ignore errors;\n        }\n\n        try {\n            const promises: Promise<void>[] = [];\n            if (this.groupMessagingEnabled) {\n                // Get the conversation ID if it exists and we don't have it yet.\n                const exists = await this.getConversation(this.conversationId, this.userId);\n\n                if (exists) {\n                    // Fetch the messages for the first time.\n                    promises.push(this.fetchMessages());\n                }\n\n                if (this.userId) {\n                    const userId = this.userId;\n                    // Get the member info. Invalidate first to make sure we get the latest status.\n                    promises.push(AddonMessages.invalidateMemberInfo(this.userId).then(async () => {\n                        this.otherMember = await AddonMessages.getMemberInfo(userId);\n\n                        if (!exists && this.otherMember) {\n                            this.conversationImage = this.otherMember.profileimageurl;\n                            this.title = this.otherMember.fullname;\n                        }\n                        this.blockIcon = this.otherMember.isblocked ? 'fas-user-check' : 'fas-user-lock';\n\n                        return;\n                    }));\n                } else {\n                    this.otherMember = undefined;\n                }\n\n            } else {\n                if (this.userId) {\n                    const userId = this.userId;\n\n                    // Fake the user member info.\n                    promises.push(CoreUser.getProfile(this.userId).then(async (user) => {\n                        this.otherMember = {\n                            id: user.id,\n                            fullname: user.fullname,\n                            profileurl: '',\n                            profileimageurl: user.profileimageurl || '',\n                            profileimageurlsmall: user.profileimageurlsmall || '',\n                            isonline: false,\n                            showonlinestatus: false,\n                            isblocked: false,\n                            iscontact: false,\n                            isdeleted: false,\n                            canmessageevenifblocked: true,\n                            canmessage: true,\n                            requirescontact: false,\n                        };\n                        this.otherMember.isblocked = await AddonMessages.isBlocked(userId);\n                        this.otherMember.iscontact = await AddonMessages.isContact(userId);\n                        this.blockIcon = this.otherMember.isblocked ? 'fas-user-check' : 'fas-user-lock';\n\n                        return;\n                    }));\n\n                }\n\n                // Fetch the messages for the first time.\n                promises.push(this.fetchMessages().then(() => {\n                    if (!this.title && this.messages.length) {\n                        // Didn't receive the fullname via argument. Try to get it from messages.\n                        // It's possible that name cannot be resolved when no messages were yet exchanged.\n                        const firstMessage = this.messages[0];\n                        if ('usertofullname' in firstMessage) {\n                            if (firstMessage.useridto != this.currentUserId) {\n                                this.title = firstMessage.usertofullname || '';\n                            } else {\n                                this.title = firstMessage.userfromfullname || '';\n                            }\n                        }\n                    }\n\n                    return;\n                }));\n            }\n\n            await Promise.all(promises);\n        } catch (error) {\n            CoreDomUtils.showErrorModalDefault(error, 'addon.messages.errorwhileretrievingmessages', true);\n        } finally {\n            this.checkCanDelete();\n            this.loaded = true;\n            this.setPolling(); // Make sure we're polling messages.\n            this.setContactRequestInfo();\n            this.setFooterType();\n            loader && loader.dismiss();\n        }\n    }\n\n    /**\n     * Runs when the page has fully entered and is now the active page.\n     * This event will fire, whether it was the first load or a cached page.\n     */\n    ionViewDidEnter(): void {\n        this.setPolling();\n    }\n\n    /**\n     * Runs when the page is about to leave and no longer be the active page.\n     */\n    ionViewWillLeave(): void {\n        this.unsetPolling();\n    }\n\n    /**\n     * Convenience function to fetch messages.\n     *\n     * @param messagesAreNew If messages loaded are new messages.\n     * @returns Resolved when done.\n     */\n    protected async fetchMessages(messagesAreNew: boolean = true): Promise<void> {\n        this.loadMoreError = false;\n\n        if (this.messagesBeingSent > 0) {\n            // We do not poll while a message is being sent or we could confuse the user.\n            // Otherwise, his message would disappear from the list, and he'd have to wait for the interval to check for messages.\n            return;\n        } else if (this.fetching) {\n            // Already fetching.\n            return;\n        } else if (this.groupMessagingEnabled && !this.conversationId) {\n            // Don't have enough data to fetch messages.\n            throw new CoreError('No enough data provided to fetch messages');\n        }\n\n        if (this.conversationId) {\n            this.logger.debug(`Polling new messages for conversation '${this.conversationId}'`);\n        } else if (this.userId) {\n            this.logger.debug(`Polling new messages for discussion with user '${this.userId}'`);\n        } else {\n            // Should not happen.\n            throw new CoreError('No enough data provided to fetch messages');\n        }\n\n        this.fetching = true;\n\n        try {\n            // Wait for synchronization process to finish.\n            await AddonMessagesSync.waitForSyncConversation(this.conversationId, this.userId);\n\n            let messages: AddonMessagesConversationMessageFormatted[] = [];\n            // Fetch messages. Invalidate the cache before fetching.\n            if (this.groupMessagingEnabled) {\n                await AddonMessages.invalidateConversationMessages(this.conversationId!);\n                messages = await this.getConversationMessages(this.pagesLoaded);\n            } else {\n                await AddonMessages.invalidateDiscussionCache(this.userId!);\n                messages = await this.getDiscussionMessages(this.pagesLoaded);\n            }\n\n            this.loadMessages(messages, messagesAreNew);\n\n        } finally {\n            this.fetching = false;\n        }\n    }\n\n    /**\n     * Format and load a list of messages into the view.\n     *\n     * @param messages Messages to load.\n     * @param messagesAreNew If messages loaded are new messages.\n     */\n    protected loadMessages(\n        messages: AddonMessagesConversationMessageFormatted[],\n        messagesAreNew: boolean = true,\n    ): void {\n\n        if (this.viewDestroyed) {\n            return;\n        }\n\n        // Check if we are at the bottom to scroll it after render.\n        // Use a 5px error margin because in iOS there is 1px difference for some reason.\n        this.scrollBottom = CoreDom.scrollIsBottom(this.scrollElement, 5);\n\n        if (this.messagesBeingSent > 0) {\n            // Ignore polling due to a race condition.\n            return;\n        }\n\n        // Add new messages to the list and mark the messages that should still be displayed.\n        const newMessages = messages.reduce((val, message) => val + (this.addMessage(message) ? 1 : 0), 0);\n\n        // Set the new badges message if we're loading new messages.\n        if (messagesAreNew) {\n            this.setNewMessagesBadge(this.newMessages + newMessages);\n        }\n\n        // Remove messages that shouldn't be in the list anymore.\n        for (const hash in this.keepMessageMap) {\n            this.removeMessage(hash);\n        }\n\n        // Sort the messages.\n        AddonMessages.sortMessages(this.messages);\n\n        // Calculate which messages need to display the date or user data.\n        this.messages.forEach((message, index) => {\n            message.showDate = this.showDate(message, this.messages[index - 1]);\n            message.showUserData = this.showUserData(message, this.messages[index - 1]);\n            message.showTail = this.showTail(message, this.messages[index + 1]);\n        });\n\n        // If we received a new message while using group messaging, force mark messages as read.\n        const last = this.messages[this.messages.length - 1];\n        const forceMark = this.groupMessagingEnabled && last && last.useridfrom !== this.currentUserId && !!this.lastMessage\n                    && (last.text !== this.lastMessage.text || last.timecreated !== this.lastMessage.timecreated);\n\n        // Notify that there can be a new message.\n        this.notifyNewMessage();\n\n        // Mark retrieved messages as read if they are not.\n        this.markMessagesAsRead(forceMark);\n    }\n\n    /**\n     * Set the new message badge number and set scroll listener if needed.\n     *\n     * @param addMessages Number of messages still to be read.\n     */\n    protected setNewMessagesBadge(addMessages: number): void {\n        if (this.newMessages == 0 && addMessages > 0) {\n            this.scrollFunction();\n        }\n\n        this.newMessages = addMessages;\n    }\n\n    /**\n     * The scroll was moved. Update new messages count.\n     */\n    scrollFunction(): void {\n        if (this.newMessages == 0) {\n            return;\n        }\n\n        if (CoreDom.scrollIsBottom(this.scrollElement, 40)) {\n            // At the bottom, reset.\n            this.setNewMessagesBadge(0);\n\n            return;\n        }\n\n        const scrollElRect = this.scrollElement?.getBoundingClientRect();\n        const scrollBottomPos = (scrollElRect && scrollElRect.bottom) || 0;\n\n        if (scrollBottomPos == 0) {\n            return;\n        }\n\n        const messages = Array.from(this.hostElement.querySelectorAll('core-message:not(.is-mine)'))\n            .slice(-this.newMessages)\n            .reverse();\n\n        const newMessagesUnread = messages.findIndex((message) => {\n            const elementRect = message.getBoundingClientRect();\n            if (!elementRect) {\n                return false;\n            }\n\n            return elementRect.bottom <= scrollBottomPos;\n        });\n\n        if (newMessagesUnread > 0 && newMessagesUnread < this.newMessages) {\n            this.setNewMessagesBadge(newMessagesUnread);\n        }\n    }\n\n    /**\n     * Get the conversation.\n     *\n     * @param conversationId Conversation ID.\n     * @param userId User ID.\n     * @returns Promise resolved with a boolean: whether the conversation exists or not.\n     */\n    protected async getConversation(conversationId?: number, userId?: number): Promise<boolean> {\n        let fallbackConversation: AddonMessagesConversationFormatted | undefined;\n\n        // Try to get the conversationId if we don't have it.\n        if (!conversationId && userId) {\n            try {\n                if (userId === this.currentUserId && AddonMessages.isSelfConversationEnabled()) {\n                    fallbackConversation = await AddonMessages.getSelfConversation();\n                } else {\n                    fallbackConversation = await AddonMessages.getConversationBetweenUsers(userId, undefined, true);\n                }\n                conversationId = fallbackConversation.id;\n            } catch (error) {\n                // Probably conversation does not exist or user is offline. Try to load offline messages.\n                this.isSelf = userId === this.currentUserId;\n\n                const messages = await AddonMessagesOffline.getMessages(userId);\n\n                if (messages && messages.length) {\n                // We have offline messages, this probably means that the conversation didn't exist. Don't display error.\n                    messages.forEach((message) => {\n                        message.pending = true;\n                        message.text = message.smallmessage;\n                    });\n\n                    this.loadMessages(messages);\n                } else if (error.errorcode != 'errorconversationdoesnotexist') {\n                    // Display the error.\n                    throw error;\n                }\n\n                return false;\n            }\n        }\n\n        if (!conversationId) {\n            return false;\n        }\n\n        // Retrieve the conversation. Invalidate data first to get the right unreadcount.\n        await AddonMessages.invalidateConversation(conversationId);\n\n        try {\n            this.conversation = await AddonMessages.getConversation(conversationId, undefined, true);\n        } catch (error) {\n            // Get conversation failed, use the fallback one if we have it.\n            if (fallbackConversation) {\n                this.conversation = fallbackConversation;\n            } else {\n                throw error;\n            }\n        }\n\n        if (this.conversation) {\n            this.conversationId = this.conversation.id;\n            this.title = this.conversation.name;\n            this.conversationImage = this.conversation.imageurl;\n            this.isGroup = this.conversation.type == AddonMessagesProvider.MESSAGE_CONVERSATION_TYPE_GROUP;\n            this.favouriteIcon = 'fas-star';\n            this.favouriteIconSlash = this.conversation.isfavourite;\n            this.muteIcon = this.conversation.ismuted ? 'fas-bell' : 'fas-bell-slash';\n            if (!this.isGroup) {\n                this.userId = this.conversation.userid;\n            }\n            this.isSelf = this.conversation.type == AddonMessagesProvider.MESSAGE_CONVERSATION_TYPE_SELF;\n\n            return true;\n        } else {\n            return false;\n        }\n\n    }\n\n    /**\n     * Get the messages of the conversation. Used if group messaging is supported.\n     *\n     * @param pagesToLoad Number of \"pages\" to load.\n     * @param offset Offset for message list.\n     * @returns Promise resolved with the list of messages.\n     */\n    protected async getConversationMessages(\n        pagesToLoad: number,\n        offset: number = 0,\n    ): Promise<AddonMessagesConversationMessageFormatted[]> {\n\n        if (!this.conversationId) {\n            return [];\n        }\n\n        const excludePending = offset > 0;\n\n        const result = await AddonMessages.getConversationMessages(this.conversationId, {\n            excludePending: excludePending,\n            limitFrom: offset,\n        });\n\n        pagesToLoad--;\n\n        // Treat members. Don't use CoreUtilsProvider.arrayToObject because we don't want to override the existing object.\n        if (result.members) {\n            result.members.forEach((member) => {\n                this.members[member.id] = member;\n            });\n        }\n\n        const messages: AddonMessagesConversationMessageFormatted[] = result.messages;\n\n        if (pagesToLoad > 0 && result.canLoadMore) {\n            offset += AddonMessagesProvider.LIMIT_MESSAGES;\n\n            // Get more messages.\n            const nextMessages = await this.getConversationMessages(pagesToLoad, offset);\n\n            return messages.concat(nextMessages);\n        }\n\n        // No more messages to load, return them.\n        this.canLoadMore = !!result.canLoadMore;\n\n        return messages;\n\n    }\n\n    /**\n     * Get a discussion. Can load several \"pages\".\n     *\n     * @param pagesToLoad Number of pages to load.\n     * @param lfReceivedUnread Number of unread received messages already fetched, so fetch will be done from this.\n     * @param lfReceivedRead Number of read received messages already fetched, so fetch will be done from this.\n     * @param lfSentUnread Number of unread sent messages already fetched, so fetch will be done from this.\n     * @param lfSentRead Number of read sent messages already fetched, so fetch will be done from this.\n     * @returns Resolved when done.\n     */\n    protected async getDiscussionMessages(\n        pagesToLoad: number,\n        lfReceivedUnread: number = 0,\n        lfReceivedRead: number = 0,\n        lfSentUnread: number = 0,\n        lfSentRead: number = 0,\n    ): Promise<(AddonMessagesGetMessagesMessage | AddonMessagesOfflineMessagesDBRecordFormatted)[]> {\n\n        // Only get offline messages if we're loading the first \"page\".\n        const excludePending = lfReceivedUnread > 0 || lfReceivedRead > 0 || lfSentUnread > 0 || lfSentRead > 0;\n\n        // Get next messages.\n        const result = await AddonMessages.getDiscussion(\n            this.userId!,\n            excludePending,\n            lfReceivedUnread,\n            lfReceivedRead,\n            lfSentUnread,\n            lfSentRead,\n        );\n\n        pagesToLoad--;\n        if (pagesToLoad > 0 && result.canLoadMore) {\n            // More pages to load. Calculate new limit froms.\n            result.messages.forEach((message) => {\n                if (!message.pending && 'read' in message) {\n                    if (message.useridfrom == this.userId) {\n                        if (message.read) {\n                            lfReceivedRead++;\n                        } else {\n                            lfReceivedUnread++;\n                        }\n                    } else {\n                        if (message.read) {\n                            lfSentRead++;\n                        } else {\n                            lfSentUnread++;\n                        }\n                    }\n                }\n            });\n\n            // Get next messages.\n            const nextMessages =\n                await this.getDiscussionMessages(pagesToLoad, lfReceivedUnread, lfReceivedRead, lfSentUnread, lfSentRead);\n\n            return result.messages.concat(nextMessages);\n        } else {\n            // No more messages to load, return them.\n            this.canLoadMore = result.canLoadMore;\n\n            return result.messages;\n        }\n    }\n\n    /**\n     * Mark messages as read.\n     */\n    protected async markMessagesAsRead(forceMark: boolean): Promise<void> {\n        let readChanged = false;\n        let messageUnreadFound = false;\n\n        // Mark all messages at a time if there is any unread message.\n        if (forceMark) {\n            messageUnreadFound = true;\n        } else if (this.groupMessagingEnabled) {\n            messageUnreadFound = !!((this.conversation?.unreadcount && this.conversation?.unreadcount > 0) &&\n                (this.conversationId && this.conversationId > 0));\n        } else {\n            // If an unread message is found, mark all messages as read.\n            messageUnreadFound = this.messages.some((message) =>\n                message.useridfrom != this.currentUserId && ('read' in message && !message.read));\n        }\n\n        if (messageUnreadFound) {\n            this.setUnreadLabelPosition();\n\n            if (this.groupMessagingEnabled) {\n                await AddonMessages.markAllConversationMessagesRead(this.conversationId!);\n            } else {\n                await AddonMessages.markAllMessagesRead(this.userId);\n\n                // Mark all messages as read.\n                this.messages.forEach((message) => {\n                    if ('read' in message) {\n                        message.read = true;\n                    }\n                });\n            }\n\n            readChanged = true;\n        }\n\n        if (readChanged) {\n            CoreEvents.trigger(AddonMessagesProvider.READ_CHANGED_EVENT, {\n                conversationId: this.conversationId,\n                userId: this.userId,\n            }, this.siteId);\n        }\n    }\n\n    /**\n     * Notify the last message found so discussions list controller can tell if last message should be updated.\n     */\n    protected notifyNewMessage(): void {\n        const last = this.messages[this.messages.length - 1] as AddonMessagesConversationMessageFormatted | undefined;\n\n        let trigger = false;\n\n        if (!last) {\n            this.lastMessage = undefined;\n            trigger = true;\n        } else if (last.text !== this.lastMessage?.text || last.timecreated !== this.lastMessage?.timecreated) {\n            this.lastMessage = { text: last.text || '', timecreated: last.timecreated };\n            trigger = true;\n        }\n\n        if (trigger) {\n            // Update discussions last message.\n            CoreEvents.trigger(AddonMessagesProvider.NEW_MESSAGE_EVENT, {\n                conversationId: this.conversationId,\n                userId: this.userId,\n                message: this.lastMessage?.text,\n                timecreated: this.lastMessage?.timecreated ?? 0,\n                userFrom: last?.useridfrom ? this.members[last.useridfrom] : undefined,\n                isfavourite: !!this.conversation?.isfavourite,\n                type: this.conversation?.type,\n            }, this.siteId);\n\n            // Update navBar links and buttons.\n            const newCanDelete = (last && 'id' in last && last.id && this.messages.length == 1) || this.messages.length > 1;\n            if (this.canDelete != newCanDelete) {\n                this.checkCanDelete();\n            }\n        }\n    }\n\n    /**\n     * Set the place where the unread label position has to be.\n     */\n    protected setUnreadLabelPosition(): void {\n        if (this.unreadMessageFrom != 0) {\n            return;\n        }\n\n        if (this.groupMessagingEnabled) {\n            // Use the unreadcount from the conversation to calculate where should the label be placed.\n            if (this.conversation && (this.conversation?.unreadcount && this.conversation?.unreadcount > 0) && this.messages) {\n                // Iterate over messages to find the right message using the unreadcount. Skip offline messages and own messages.\n                let found = 0;\n\n                for (let i = this.messages.length - 1; i >= 0; i--) {\n                    const message = this.messages[i];\n                    if (!message.pending && message.useridfrom != this.currentUserId && 'id' in message) {\n                        found++;\n                        if (found == this.conversation.unreadcount) {\n                            this.unreadMessageFrom = Number(message.id);\n                            break;\n                        }\n                    }\n                }\n            }\n        } else {\n            let previousMessageRead = false;\n\n            for (const x in this.messages) {\n                const message = this.messages[x];\n                if (message.useridfrom != this.currentUserId && 'read' in message) {\n                    const unreadFrom = !message.read && previousMessageRead;\n\n                    if (unreadFrom) {\n                        // Save where the label is placed.\n                        this.unreadMessageFrom = Number(message.id);\n                        break;\n                    }\n\n                    previousMessageRead = !!message.read;\n                }\n            }\n        }\n\n        // Do not update the message unread from label on next refresh.\n        if (this.unreadMessageFrom == 0) {\n            // Using negative to indicate the label is not placed but should not be placed.\n            this.unreadMessageFrom = -1;\n        }\n    }\n\n    /**\n     * Check if there's any message in the list that can be deleted.\n     */\n    protected checkCanDelete(): void {\n        // All messages being sent should be at the end of the list.\n        const first = this.messages[0];\n        this.canDelete = first && !first.sending;\n    }\n\n    /**\n     * Hide unread label when sending messages.\n     */\n    protected hideUnreadLabel(): void {\n        if (this.unreadMessageFrom > 0) {\n            this.unreadMessageFrom = -1;\n        }\n    }\n\n    /**\n     * Wait until fetching is false.\n     *\n     * @returns Resolved when done.\n     */\n    protected async waitForFetch(): Promise<void> {\n        if (!this.fetching) {\n            return;\n        }\n\n        await CoreUtils.wait(400);\n        await CoreUtils.ignoreErrors(this.waitForFetch());\n    }\n\n    /**\n     * Set a polling to get new messages every certain time.\n     */\n    protected setPolling(): void {\n        if (this.groupMessagingEnabled && !this.conversationId) {\n            // Don't have enough data to poll messages.\n            return;\n        }\n\n        if (!this.polling) {\n            // Start polling.\n            this.polling = window.setInterval(() => {\n                this.fetchMessages().catch(() => {\n                    // Ignore errors.\n                });\n            }, AddonMessagesProvider.POLL_INTERVAL);\n        }\n    }\n\n    /**\n     * Unset polling.\n     */\n    protected unsetPolling(): void {\n        if (this.polling) {\n            this.logger.debug(`Cancelling polling for conversation with user '${this.userId}'`);\n            clearInterval(this.polling);\n            this.polling = undefined;\n        }\n    }\n\n    /**\n     * Copy message to clipboard.\n     *\n     * @param message Message to be copied.\n     */\n    copyMessage(message: AddonMessagesConversationMessageFormatted): void {\n        const text = 'smallmessage' in message ? message.smallmessage || message.text || '' : message.text || '';\n        CoreUtils.copyToClipboard(CoreTextUtils.decodeHTMLEntities(text));\n    }\n\n    /**\n     * Function to delete a message.\n     *\n     * @param message Message object to delete.\n     * @param index Index where the message is to delete it from the view.\n     */\n    async deleteMessage(\n        message: AddonMessagesConversationMessageFormatted,\n        index: number,\n    ): Promise<void> {\n        const canDeleteAll = this.conversation && this.conversation.candeletemessagesforallusers;\n        const langKey = message.pending || canDeleteAll || this.isSelf ? 'core.areyousure' :\n            'addon.messages.deletemessageconfirmation';\n        const options: AlertOptions = {};\n\n        if (canDeleteAll && !message.pending) {\n            // Show delete for all checkbox.\n            options.inputs = [{\n                type: 'checkbox',\n                name: 'deleteforall',\n                checked: false,\n                value: true,\n                label: Translate.instant('addon.messages.deleteforeveryone'),\n            }];\n        }\n\n        try {\n            const data: boolean[] = await CoreDomUtils.showConfirm(\n                Translate.instant(langKey),\n                undefined,\n                undefined,\n                undefined,\n                options,\n            );\n\n            const modal = await CoreDomUtils.showModalLoading('core.deleting', true);\n\n            try {\n                await AddonMessages.deleteMessage(message, data && data[0]);\n                // Remove message from the list without having to wait for re-fetch.\n                this.messages.splice(index, 1);\n                this.removeMessage(message.hash!);\n                this.notifyNewMessage();\n\n                this.fetchMessages(); // Re-fetch messages to update cached data.\n            } finally {\n                modal.dismiss();\n            }\n        } catch (error) {\n            CoreDomUtils.showErrorModalDefault(error, 'addon.messages.errordeletemessage', true);\n        }\n    }\n\n    /**\n     * Function to load previous messages.\n     *\n     * @param infiniteComplete Infinite scroll complete function. Only used from core-infinite-loading.\n     * @returns Resolved when done.\n     */\n    async loadPrevious(infiniteComplete?: () => void): Promise<void> {\n        if (!this.initialized) {\n            // Don't load previous if the view isn't fully initialized.\n            // Don't put the initialized condition in the \"enabled\" input because then the load more is hidden and\n            // the scroll height changes when it appears.\n            infiniteComplete && infiniteComplete();\n\n            return;\n        }\n\n        let infiniteHeight = this.infinite?.hostElement.getBoundingClientRect().height || 0;\n        const scrollHeight = (this.scrollElement?.scrollHeight || 0);\n\n        // If there is an ongoing fetch, wait for it to finish.\n        try {\n            await this.waitForFetch();\n        } finally {\n            this.pagesLoaded++;\n\n            try {\n                await this.fetchMessages(false);\n\n                // Try to keep the scroll position.\n                const scrollBottom = scrollHeight - (this.scrollElement?.scrollTop || 0);\n\n                const height = this.infinite?.hostElement.getBoundingClientRect().height || 0;\n                if (this.canLoadMore && infiniteHeight && this.infinite) {\n                    // The height of the infinite is different while spinner is shown. Add that difference.\n                    infiniteHeight = infiniteHeight - height;\n                } else if (!this.canLoadMore) {\n                    // Can't load more, take into account the full height of the infinite loading since it will disappear now.\n                    infiniteHeight = infiniteHeight || height;\n                }\n\n                this.keepScroll(scrollHeight, scrollBottom, infiniteHeight);\n            } catch (error) {\n                this.loadMoreError = true; // Set to prevent infinite calls with infinite-loading.\n                this.pagesLoaded--;\n                CoreDomUtils.showErrorModalDefault(error, 'addon.messages.errorwhileretrievingmessages', true);\n            } finally {\n                infiniteComplete && infiniteComplete();\n            }\n        }\n    }\n\n    /**\n     * Keep scroll position after loading previous messages.\n     */\n    protected keepScroll(oldScrollHeight: number, oldScrollBottom: number, infiniteHeight: number, retries = 0): void {\n        setTimeout(() => {\n            const newScrollHeight = (this.scrollElement?.scrollHeight || 0);\n\n            if (newScrollHeight == oldScrollHeight) {\n                // Height hasn't changed yet. Retry if max retries haven't been reached.\n                if (retries <= 10) {\n                    this.keepScroll(oldScrollHeight, oldScrollBottom, infiniteHeight, retries + 1);\n                }\n\n                return;\n            }\n\n            // Scroll has changed, but maybe it hasn't reached the full height yet.\n            setTimeout(() => {\n                const newScrollHeight = (this.scrollElement?.scrollHeight || 0);\n                const scrollTo = newScrollHeight - oldScrollBottom + infiniteHeight;\n\n                this.content!.scrollToPoint(0, scrollTo, 0);\n            }, 30);\n        }, 30);\n    }\n\n    /**\n     * Scroll bottom when render has finished.\n     *\n     * @param force Whether to force scroll to bottom.\n     */\n    async scrollToBottom(force = false): Promise<void> {\n        // Check if scroll is at bottom. If so, scroll bottom after rendering since there might be something new.\n        if (this.scrollBottom || force) {\n            this.scrollBottom = false;\n\n            // Reset the badge.\n            this.setNewMessagesBadge(0);\n\n            // Leave time for the view to be rendered.\n            await CoreUtils.nextTicks(5);\n\n            if (!this.viewDestroyed && this.content) {\n                this.content.scrollToBottom(0);\n            }\n\n            if (force) {\n                this.initialized = true;\n            }\n        }\n    }\n\n    /**\n     * Scroll to the first new unread message.\n     */\n    scrollToFirstUnreadMessage(): void {\n        if (this.newMessages > 0) {\n            const messages = Array.from(this.hostElement.querySelectorAll<HTMLElement>('core-message:not(.is-mine)'));\n\n            CoreDom.scrollToElement(messages[messages.length - this.newMessages]);\n        }\n    }\n\n    /**\n     * Sends a message to the server.\n     *\n     * @param text Message text.\n     */\n    async sendMessage(text: string): Promise<void> {\n        this.hideUnreadLabel();\n\n        this.showDelete = false;\n        this.scrollBottom = true;\n        this.setNewMessagesBadge(0);\n\n        const message: AddonMessagesConversationMessageFormatted = {\n            id: -1,\n            pending: true,\n            sending: true,\n            useridfrom: this.currentUserId,\n            smallmessage: text,\n            text: text,\n            timecreated: Date.now(),\n        };\n        message.showDate = this.showDate(message, this.messages[this.messages.length - 1]);\n        this.addMessage(message, false);\n\n        this.messagesBeingSent++;\n\n        // If there is an ongoing fetch, wait for it to finish.\n        // Otherwise, if a message is sent while fetching it could disappear until the next fetch.\n        try {\n            await this.waitForFetch();\n        } finally {\n\n            try {\n                let data: AddonMessagesSendMessageResults;\n                if (this.conversationId) {\n                    data = await AddonMessages.sendMessageToConversation(this.conversation!, text);\n                } else {\n                    data = await AddonMessages.sendMessage(this.userId!, text);\n                }\n\n                this.messagesBeingSent--;\n                let failure = false;\n                if (data.sent) {\n                    try {\n\n                        if (!this.conversationId && data.message && 'conversationid' in data.message) {\n                            // Message sent to a new conversation, try to load the conversation.\n                            await this.getConversation(data.message.conversationid, this.userId);\n                            // Now fetch messages.\n                            try {\n                                await this.fetchMessages();\n                            } finally {\n                                // Start polling messages now that the conversation exists.\n                                this.setPolling();\n                            }\n                        } else {\n                            // Message was sent, fetch messages right now.\n                            await this.fetchMessages();\n                        }\n                    } catch {\n                        failure = true;\n                    }\n                }\n\n                if (failure || !data.sent) {\n                    // Fetch failed or is offline message, mark the message as sent.\n                    // If fetch is successful there's no need to mark it because the fetch will already show the message received.\n                    message.sending = false;\n                    if (data.sent) {\n                        // Message sent to server, not pending anymore.\n                        message.pending = false;\n                    } else if (data.message) {\n                        message.timecreated = data.message.timecreated || 0;\n                    }\n\n                    this.notifyNewMessage();\n                }\n\n            } catch (error) {\n                this.messagesBeingSent--;\n\n                // Only close the keyboard if an error happens.\n                // We want the user to be able to send multiple messages without the keyboard being closed.\n                CoreApp.closeKeyboard();\n\n                CoreDomUtils.showErrorModalDefault(error, 'addon.messages.messagenotsent', true);\n                this.removeMessage(message.hash!);\n            }\n        }\n    }\n\n    /**\n     * Check date should be shown on message list for the current message.\n     * If date has changed from previous to current message it should be shown.\n     *\n     * @param message Current message where to show the date.\n     * @param prevMessage Previous message where to compare the date with.\n     * @returns If date has changed and should be shown.\n     */\n    showDate(\n        message: AddonMessagesConversationMessageFormatted,\n        prevMessage?: AddonMessagesConversationMessageFormatted,\n    ): boolean {\n\n        if (!prevMessage) {\n            // First message, show it.\n            return true;\n        }\n\n        // Check if day has changed.\n        return !moment(message.timecreated).isSame(prevMessage.timecreated, 'day');\n    }\n\n    /**\n     * Check if the user info should be displayed for the current message.\n     * User data is only displayed for group conversations if the previous message was from another user.\n     *\n     * @param message Current message where to show the user info.\n     * @param prevMessage Previous message.\n     * @returns Whether user data should be shown.\n     */\n    showUserData(\n        message: AddonMessagesConversationMessageFormatted,\n        prevMessage?: AddonMessagesConversationMessageFormatted,\n    ): boolean {\n\n        return this.isGroup && message.useridfrom != this.currentUserId && this.members[(message.useridfrom || 0)] &&\n            (!prevMessage || prevMessage.useridfrom != message.useridfrom || !!message.showDate);\n    }\n\n    /**\n     * Check if a css tail should be shown.\n     *\n     * @param message Current message where to show the user info.\n     * @param nextMessage Next message.\n     * @returns Whether user data should be shown.\n     */\n    showTail(\n        message: AddonMessagesConversationMessageFormatted,\n        nextMessage?: AddonMessagesConversationMessageFormatted,\n    ): boolean {\n        return !nextMessage || nextMessage.useridfrom != message.useridfrom || !!nextMessage.showDate;\n    }\n\n    /**\n     * View info. If it's an individual conversation, go to the user profile.\n     * If it's a group conversation, view info about the group.\n     */\n    async viewInfo(): Promise<void> {\n        if (this.isGroup) {\n            const { AddonMessagesConversationInfoComponent } =\n                await import('@addons/messages/components/conversation-info/conversation-info.module');\n\n            // Display the group information.\n            const userId = await CoreDomUtils.openSideModal<number>({\n                component: AddonMessagesConversationInfoComponent,\n                componentProps: {\n                    conversationId: this.conversationId,\n                },\n            });\n\n            if (userId !== undefined) {\n                const splitViewLoaded = CoreNavigator.isCurrentPathInTablet('**/messages/**/discussion/**');\n\n                // Open user conversation.\n                if (splitViewLoaded) {\n                    // Notify the left pane to load it, this way the right conversation will be highlighted.\n                    CoreEvents.trigger(\n                        AddonMessagesProvider.OPEN_CONVERSATION_EVENT,\n                        { userId },\n                        this.siteId,\n                    );\n                } else {\n                    // Open the discussion in a new view.\n                    CoreNavigator.navigateToSitePath(`/messages/discussion/user/${userId}`);\n                }\n            }\n        } else {\n            // Open the user profile.\n            CoreNavigator.navigateToSitePath('/user/profile', { params: { userId: this.userId } });\n        }\n    }\n\n    /**\n     * Change the favourite state of the current conversation.\n     *\n     * @param done Function to call when done.\n     */\n    async changeFavourite(done?: () => void): Promise<void> {\n        if (!this.conversation) {\n            return;\n        }\n\n        this.favouriteIcon = CoreConstants.ICON_LOADING;\n\n        try {\n            await AddonMessages.setFavouriteConversation(this.conversation.id, !this.conversation.isfavourite);\n\n            this.conversation.isfavourite = !this.conversation.isfavourite;\n\n            // Get the conversation data so it's cached. Don't block the user for this.\n            AddonMessages.getConversation(this.conversation.id, undefined, true);\n\n            CoreEvents.trigger(AddonMessagesProvider.UPDATE_CONVERSATION_LIST_EVENT, {\n                conversationId: this.conversation.id,\n                action: 'favourite',\n                value: this.conversation.isfavourite,\n            }, this.siteId);\n        } catch (error) {\n            CoreDomUtils.showErrorModalDefault(error, 'Error changing favourite state.');\n        } finally {\n            this.favouriteIcon = 'fas-star';\n            this.favouriteIconSlash = this.conversation.isfavourite;\n            done && done();\n        }\n    }\n\n    /**\n     * Change the mute state of the current conversation.\n     *\n     * @param done Function to call when done.\n     */\n    async changeMute(done?: () => void): Promise<void> {\n        if (!this.conversation) {\n            return;\n        }\n\n        this.muteIcon = CoreConstants.ICON_LOADING;\n\n        try {\n            await AddonMessages.muteConversation(this.conversation.id, !this.conversation.ismuted);\n            this.conversation.ismuted = !this.conversation.ismuted;\n\n            // Get the conversation data so it's cached. Don't block the user for this.\n            AddonMessages.getConversation(this.conversation.id, undefined, true);\n\n            CoreEvents.trigger(AddonMessagesProvider.UPDATE_CONVERSATION_LIST_EVENT, {\n                conversationId: this.conversation.id,\n                action: 'mute',\n                value: this.conversation.ismuted,\n            }, this.siteId);\n\n        } catch (error) {\n            CoreDomUtils.showErrorModalDefault(error, 'Error changing muted state.');\n        } finally {\n            this.muteIcon = this.conversation.ismuted ? 'fas-bell' : 'fas-bell-slash';\n            done && done();\n        }\n    }\n\n    /**\n     * Calculate whether there are pending contact requests.\n     */\n    protected setContactRequestInfo(): void {\n        this.requestContactSent = false;\n        this.requestContactReceived = false;\n        if (this.otherMember && !this.otherMember.iscontact) {\n            this.requestContactSent = !!this.otherMember.contactrequests?.some((request) =>\n                request.userid == this.currentUserId && request.requesteduserid == this.otherMember!.id);\n            this.requestContactReceived = !!this.otherMember.contactrequests?.some((request) =>\n                request.userid == this.otherMember!.id && request.requesteduserid == this.currentUserId);\n        }\n    }\n\n    /**\n     * Calculate what to display in the footer.\n     */\n    protected setFooterType(): void {\n        if (!this.otherMember) {\n            // Group conversation or group messaging not available.\n            this.footerType = 'message';\n        } else if (this.otherMember.isblocked) {\n            this.footerType = 'blocked';\n        } else if (this.requestContactReceived) {\n            this.footerType = 'requestReceived';\n        } else if (this.otherMember.canmessage) {\n            this.footerType = 'message';\n        } else if (this.requestContactSent) {\n            this.footerType = 'requestSent';\n        } else if (this.otherMember.requirescontact) {\n            this.footerType = 'requiresContact';\n        } else {\n            this.footerType = 'unable';\n        }\n    }\n\n    /**\n     * Displays a confirmation modal to block the user of the individual conversation.\n     *\n     * @returns Promise resolved when user is blocked or dialog is cancelled.\n     */\n    async blockUser(): Promise<void> {\n        if (!this.otherMember) {\n            // Should never happen.\n            throw new CoreError('No member selected to be blocked.');\n        }\n\n        if (this.otherMember.canmessageevenifblocked) {\n            CoreDomUtils.showErrorModal(Translate.instant('addon.messages.cantblockuser', { $a: this.otherMember.fullname }));\n\n            return;\n        }\n\n        const template = Translate.instant('addon.messages.blockuserconfirm', { $a: this.otherMember.fullname });\n        const okText = Translate.instant('addon.messages.blockuser');\n\n        try {\n            await CoreDomUtils.showConfirm(template, undefined, okText);\n            this.blockIcon = CoreConstants.ICON_LOADING;\n\n            const modal = await CoreDomUtils.showModalLoading('core.sending', true);\n            this.showLoadingModal = true;\n\n            try {\n                try {\n                    await AddonMessages.blockContact(this.otherMember.id);\n                } finally {\n                    modal.dismiss();\n                    this.showLoadingModal = false;\n                }\n            } catch (error) {\n                CoreDomUtils.showErrorModalDefault(error, 'core.error', true);\n            } finally {\n                this.blockIcon = this.otherMember.isblocked ? 'fas-user-check' : 'fas-user-lock';\n            }\n        } catch {\n            // User cancelled.\n        }\n    }\n\n    /**\n     * Delete the conversation.\n     *\n     * @param done Function to call when done.\n     */\n    async deleteConversation(done?: () => void): Promise<void> {\n        if (!this.conversation) {\n            return;\n        }\n\n        const confirmMessage = 'addon.messages.' + (this.isSelf ? 'deleteallselfconfirm' : 'deleteallconfirm');\n\n        try {\n            await CoreDomUtils.showDeleteConfirm(confirmMessage);\n            this.deleteIcon = CoreConstants.ICON_LOADING;\n\n            try {\n                try {\n                    await AddonMessages.deleteConversation(this.conversation.id);\n\n                    CoreEvents.trigger(\n                        AddonMessagesProvider.UPDATE_CONVERSATION_LIST_EVENT,\n                        {\n                            conversationId: this.conversation.id,\n                            action: 'delete',\n                        },\n                        this.siteId,\n                    );\n\n                    this.messages = [];\n                } finally {\n                    done && done();\n                }\n            } catch (error) {\n                CoreDomUtils.showErrorModalDefault(error, 'Error deleting conversation.');\n            } finally {\n                this.deleteIcon = 'fas-trash';\n            }\n        } catch {\n            // User cancelled.\n        }\n    }\n\n    /**\n     * Displays a confirmation modal to unblock the user of the individual conversation.\n     *\n     * @returns Promise resolved when user is unblocked or dialog is cancelled.\n     */\n    async unblockUser(): Promise<void> {\n        if (!this.otherMember) {\n            // Should never happen.\n            throw new CoreError('No member selected to be unblocked.');\n        }\n\n        const template = Translate.instant('addon.messages.unblockuserconfirm', { $a: this.otherMember.fullname });\n        const okText = Translate.instant('addon.messages.unblockuser');\n\n        try {\n            await CoreDomUtils.showConfirm(template, undefined, okText);\n\n            this.blockIcon = CoreConstants.ICON_LOADING;\n\n            const modal = await CoreDomUtils.showModalLoading('core.sending', true);\n            this.showLoadingModal = true;\n\n            try {\n                try {\n                    await AddonMessages.unblockContact(this.otherMember.id);\n                } finally {\n                    modal.dismiss();\n                    this.showLoadingModal = false;\n                }\n            } catch (error) {\n                CoreDomUtils.showErrorModalDefault(error, 'core.error', true);\n            } finally {\n                this.blockIcon = this.otherMember.isblocked ? 'fas-user-check' : 'fas-user-lock';\n            }\n        } catch {\n            // User cancelled.\n        }\n    }\n\n    /**\n     * Displays a confirmation modal to send a contact request to the other user of the individual conversation.\n     *\n     * @returns Promise resolved when the request is sent or the dialog is cancelled.\n     */\n    async createContactRequest(): Promise<void> {\n        if (!this.otherMember) {\n            // Should never happen.\n            throw new CoreError('No member selected to be requested.');\n        }\n\n        const template = Translate.instant('addon.messages.addcontactconfirm', { $a: this.otherMember.fullname });\n        const okText = Translate.instant('core.add');\n\n        try {\n            await CoreDomUtils.showConfirm(template, undefined, okText);\n\n            this.addRemoveIcon = CoreConstants.ICON_LOADING;\n\n            const modal = await CoreDomUtils.showModalLoading('core.sending', true);\n            this.showLoadingModal = true;\n\n            try {\n                try {\n                    await AddonMessages.createContactRequest(this.otherMember.id);\n                } finally {\n                    modal.dismiss();\n                    this.showLoadingModal = false;\n                }\n            } catch (error) {\n                CoreDomUtils.showErrorModalDefault(error, 'core.error', true);\n            } finally {\n                this.addRemoveIcon = 'fas-user-plus';\n            }\n        } catch {\n            // User cancelled.\n        }\n    }\n\n    /**\n     * Confirms the contact request of the other user of the individual conversation.\n     *\n     * @returns Promise resolved when the request is confirmed.\n     */\n    async confirmContactRequest(): Promise<void> {\n        if (!this.otherMember) {\n            // Should never happen.\n            throw new CoreError('No member selected to be confirmed.');\n        }\n\n        const modal = await CoreDomUtils.showModalLoading('core.sending', true);\n        this.showLoadingModal = true;\n\n        try {\n            try {\n                await AddonMessages.confirmContactRequest(this.otherMember.id);\n            } finally {\n                modal.dismiss();\n                this.showLoadingModal = false;\n            }\n        } catch (error) {\n            CoreDomUtils.showErrorModalDefault(error, 'core.error', true);\n        }\n    }\n\n    /**\n     * Declines the contact request of the other user of the individual conversation.\n     *\n     * @returns Promise resolved when the request is confirmed.\n     */\n    async declineContactRequest(): Promise<void> {\n        if (!this.otherMember) {\n            // Should never happen.\n            throw new CoreError('No member selected to be declined.');\n        }\n\n        const modal = await CoreDomUtils.showModalLoading('core.sending', true);\n        this.showLoadingModal = true;\n\n        try {\n            try {\n                await AddonMessages.declineContactRequest(this.otherMember.id);\n            } finally {\n                modal.dismiss();\n                this.showLoadingModal = false;\n            }\n        } catch (error) {\n            CoreDomUtils.showErrorModalDefault(error, 'core.error', true);\n        }\n    }\n\n    /**\n     * Displays a confirmation modal to remove the other user of the conversation from contacts.\n     *\n     * @returns Promise resolved when the request is sent or the dialog is cancelled.\n     */\n    async removeContact(): Promise<void> {\n        if (!this.otherMember) {\n            // Should never happen.\n            throw new CoreError('No member selected to be removed.');\n        }\n\n        const template = Translate.instant('addon.messages.removecontactconfirm', { $a: this.otherMember.fullname });\n        const okText = Translate.instant('core.remove');\n\n        try {\n            await CoreDomUtils.showConfirm(template, undefined, okText);\n\n            this.addRemoveIcon = CoreConstants.ICON_LOADING;\n\n            const modal = await CoreDomUtils.showModalLoading('core.sending', true);\n            this.showLoadingModal = true;\n\n            try {\n                try {\n                    await AddonMessages.removeContact(this.otherMember.id);\n                } finally {\n                    modal.dismiss();\n                    this.showLoadingModal = false;\n                }\n            } catch (error) {\n                CoreDomUtils.showErrorModalDefault(error, 'core.error', true);\n            } finally {\n                this.addRemoveIcon = 'fas-user-plus';\n            }\n        } catch {\n            // User cancelled.\n        }\n\n    }\n\n    /**\n     * Page destroyed.\n     */\n    ngOnDestroy(): void {\n        // Unset again, just in case.\n        this.unsetPolling();\n        this.syncObserver?.off();\n        this.memberInfoObserver?.off();\n        this.viewDestroyed = true;\n    }\n\n}\n","<ion-header>\n    <ion-toolbar>\n        <ion-buttons slot=\"start\">\n            <ion-back-button [text]=\"'core.back' | translate\" />\n        </ion-buttons>\n        <ion-title>\n            <h1>\n                <img *ngIf=\"loaded && !otherMember && conversationImage\" class=\"core-bar-button-image\" [src]=\"conversationImage\" alt=\"\"\n                    onError=\"this.src='assets/img/group-avatar.svg'\" core-external-content role=\"presentation\" [siteId]=\"siteId\">\n                <core-user-avatar *ngIf=\"loaded && otherMember\" class=\"core-bar-button-image\" [user]=\"otherMember\" [linkProfile]=\"false\"\n                    [checkOnline]=\"otherMember.showonlinestatus\" />\n                <core-format-text [text]=\"title\" contextLevel=\"system\" [contextInstanceId]=\"0\" />\n                <ion-icon *ngIf=\"conversation && conversation.isfavourite\" name=\"fas-star\"\n                    [attr.aria-label]=\"'core.favourites' | translate\" />\n                <ion-icon *ngIf=\"conversation && conversation.ismuted\" name=\"fas-bell-slash\"\n                    [attr.aria-label]=\"'addon.messages.mutedconversation' | translate\" />\n            </h1>\n        </ion-title>\n        <ion-buttons slot=\"end\" />\n    </ion-toolbar>\n    <core-navbar-buttons slot=\"end\">\n        <core-context-menu [attr.aria-label]=\"'addon.messages.conversationactions' | translate\">\n            <core-context-menu-item [hidden]=\"isSelf || !showInfo || isGroup\" [priority]=\"1000\"\n                [content]=\"'addon.messages.info' | translate\" (action)=\"viewInfo()\" iconAction=\"fas-circle-info\" />\n            <core-context-menu-item [hidden]=\"isSelf || !showInfo || !isGroup\" [priority]=\"1000\"\n                [content]=\"'addon.messages.groupinfo' | translate\" (action)=\"viewInfo()\" iconAction=\"fas-circle-info\" />\n            <core-context-menu-item [hidden]=\"!groupMessagingEnabled || !conversation\" [priority]=\"800\" (action)=\"changeFavourite($event)\"\n                [closeOnClick]=\"false\" [content]=\"(conversation && conversation.isfavourite ? 'addon.messages.removefromfavourites' :\n                'addon.messages.addtofavourites') | translate\" [iconAction]=\"favouriteIcon\" [iconSlash]=\"favouriteIconSlash\" />\n            <core-context-menu-item [hidden]=\"isSelf || !otherMember || otherMember.isblocked\" [priority]=\"700\"\n                [content]=\"'addon.messages.blockuser' | translate\" (action)=\"blockUser()\" [iconAction]=\"blockIcon\" />\n            <core-context-menu-item [hidden]=\"isSelf || !otherMember || !otherMember.isblocked\" [priority]=\"700\"\n                [content]=\"'addon.messages.unblockuser' | translate\" (action)=\"unblockUser()\" [iconAction]=\"blockIcon\" />\n            <core-context-menu-item [hidden]=\"isSelf || !muteEnabled || !conversation\" [priority]=\"600\" (action)=\"changeMute($event)\"\n                [closeOnClick]=\"false\" [content]=\"(conversation && conversation.ismuted ? 'addon.messages.unmuteconversation' :\n                'addon.messages.muteconversation') | translate\" [iconAction]=\"muteIcon\" />\n            <core-context-menu-item [hidden]=\"!canDelete || !messages || !messages.length\" [priority]=\"400\"\n                [content]=\"'addon.messages.showdeletemessages' | translate\" iconAction=\"toggle\" [(toggle)]=\"showDelete\" />\n            <core-context-menu-item [hidden]=\"!groupMessagingEnabled || !conversationId || isGroup || !messages || !messages.length\"\n                [priority]=\"200\" [content]=\"'addon.messages.deleteconversation' | translate\" (action)=\"deleteConversation($event)\"\n                [closeOnClick]=\"false\" [iconAction]=\"deleteIcon\" />\n            <core-context-menu-item\n                [hidden]=\"isSelf || !otherMember || otherMember.iscontact || requestContactSent || requestContactReceived\" [priority]=\"100\"\n                [content]=\"'addon.messages.addtoyourcontacts' | translate\" (action)=\"createContactRequest()\" [iconAction]=\"addRemoveIcon\" />\n            <core-context-menu-item [hidden]=\"isSelf || !otherMember || !otherMember.iscontact\" [priority]=\"100\"\n                [content]=\"'addon.messages.removefromyourcontacts' | translate\" (action)=\"removeContact()\" [iconAction]=\"addRemoveIcon\"\n                [iconSlash]=\"true\" />\n        </core-context-menu>\n    </core-navbar-buttons>\n</ion-header>\n<ion-content (ionScroll)=\"scrollFunction()\">\n    <core-loading [hideUntil]=\"loaded\">\n        <!-- Load previous messages. -->\n        <core-infinite-loading [enabled]=\"canLoadMore\" (action)=\"loadPrevious($event)\" position=\"top\" [error]=\"loadMoreError\" />\n\n        <ng-container *ngIf=\"isSelf && !canLoadMore\">\n            <p class=\"ion-text-center\">{{ 'addon.messages.selfconversation' | translate }}</p>\n            <p class=\"ion-text-center\"><em>{{ 'addon.messages.selfconversationdefaultmessage' | translate }}</em></p>\n        </ng-container>\n\n        <h2 class=\"sr-only\">{{ title }}</h2>\n\n        <ion-list class=\"addon-messages-discussion-container\" [class.addon-messages-discussion-group]=\"isGroup\" [attr.aria-live]=\"'polite'\">\n            <ng-container *ngFor=\"let message of messages; index as index; last as last\">\n                <h3 class=\"ion-text-center addon-messages-date\" *ngIf=\"message.showDate\">\n                    {{ message.timecreated | coreFormatDate: \"strftimedayshort\" }}\n                </h3>\n\n                <ion-chip class=\"addon-messages-unreadfrom\" *ngIf=\"unreadMessageFrom > 0 && message.id === unreadMessageFrom\" color=\"light\">\n                    <ion-label>{{ 'addon.messages.newmessages' | translate }}</ion-label>\n                    <ion-icon name=\"fas-arrow-down\" aria-hidden=\"true\" />\n                </ion-chip>\n\n                <core-message [message]=\"message\" [user]=\"members[message.useridfrom]\" (afterRender)=\"last && scrollToBottom()\"\n                    [text]=\"message.text\" (onDeleteMessage)=\"deleteMessage(message, index)\" [showDelete]=\"showDelete\"\n                    [time]=\"message.timecreated\" />\n            </ng-container>\n        </ion-list>\n\n        <core-empty-box *ngIf=\"!messages || messages.length <= 0\" icon=\"far-comments\"\n            [message]=\"'addon.messages.nomessagesfound' | translate\" />\n    </core-loading>\n    <!-- Scroll bottom. -->\n    <ion-fab slot=\"fixed\" core-fab vertical=\"bottom\" horizontal=\"end\" *ngIf=\"loaded && newMessages > 0\">\n        <ion-fab-button size=\"small\" (click)=\"scrollToFirstUnreadMessage()\" color=\"light\"\n            [attr.aria-label]=\"'addon.messages.newmessages' | translate\">\n            <ion-icon name=\"fas-arrow-down\" aria-hidden=\"true\" />\n            <span class=\"sr-only\">{{ 'addon.messages.newmessages' | translate }}</span>\n        </ion-fab-button>\n        <ion-badge class=\"core-discussion-messages-badge\">{{ newMessages }}</ion-badge>\n    </ion-fab>\n</ion-content>\n<ion-footer class=\"footer-adjustable\" *ngIf=\"loaded && (!conversationId || conversation)\">\n    <ion-toolbar [color]=\"footerType === 'message' ? null : 'light'\">\n        <p *ngIf=\"footerType === 'unable'\" class=\"ion-text-center ion-margin-horizontal\">\n            {{ 'addon.messages.unabletomessage' | translate }}\n        </p>\n        <div *ngIf=\"footerType === 'blocked'\" class=\"ion-padding-horizontal\">\n            <p class=\"ion-text-center\">{{ 'addon.messages.youhaveblockeduser' | translate }}</p>\n            <ion-button expand=\"block\" class=\"ion-text-wrap ion-margin-bottom\" (click)=\"unblockUser()\">\n                {{ 'addon.messages.unblockuser' | translate }}\n            </ion-button>\n        </div>\n        <div *ngIf=\"footerType === 'requiresContact' && otherMember\" class=\"ion-padding-horizontal\">\n            <p class=\"ion-text-center\">\n                <strong>{{ 'addon.messages.isnotinyourcontacts' | translate: {$a: otherMember.fullname} }}</strong>\n            </p>\n            <p class=\"ion-text-center\">{{ 'addon.messages.requirecontacttomessage' | translate: {$a: otherMember.fullname} }}</p>\n            <ion-button expand=\"block\" class=\"ion-text-wrap ion-margin-bottom\" (click)=\"createContactRequest()\">\n                {{ 'addon.messages.sendcontactrequest' | translate }}\n            </ion-button>\n        </div>\n        <div *ngIf=\"footerType === 'requestReceived' && otherMember\" class=\"ion-padding-horizontal\">\n            <p class=\"ion-text-center\">{{ 'addon.messages.userwouldliketocontactyou' | translate: {$a: otherMember.fullname} }}</p>\n            <ion-button expand=\"block\" class=\"ion-text-wrap ion-margin-bottom\" (click)=\"confirmContactRequest()\">\n                {{ 'addon.messages.acceptandaddcontact' | translate }}\n            </ion-button>\n            <ion-button expand=\"block\" class=\"ion-text-wrap ion-margin-bottom\" fill=\"outline\" (click)=\"declineContactRequest()\">\n                {{ 'addon.messages.decline' | translate }}\n            </ion-button>\n        </div>\n        <div *ngIf=\"footerType === 'requestSent' || (footerType === 'message' && requestContactSent)\" class=\"ion-padding-horizontal\">\n            <p class=\"ion-text-center\"><strong>{{ 'addon.messages.contactrequestsent' | translate }}</strong></p>\n            <p class=\"ion-text-center\" *ngIf=\"otherMember\">\n                {{ 'addon.messages.yourcontactrequestpending' | translate: {$a: otherMember.fullname} }}\n            </p>\n        </div>\n        <core-send-message-form *ngIf=\"footerType === 'message'\" (onSubmit)=\"sendMessage($event)\" [showKeyboard]=\"showKeyboard\"\n            [placeholder]=\"'addon.messages.newmessage' | translate\" />\n    </ion-toolbar>\n</ion-footer>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
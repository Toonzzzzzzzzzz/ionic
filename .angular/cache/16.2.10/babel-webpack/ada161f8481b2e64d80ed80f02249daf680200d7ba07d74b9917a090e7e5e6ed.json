{"ast":null,"code":"import _asyncToGenerator from \"/home/toon/works/gitionic7/ionic-github/ionic/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _class;\nimport { CoreUserDelegateService } from '@features/user/services/user-delegate';\nimport { CoreNavigator } from '@services/navigator';\nimport { CoreSites } from '@services/sites';\nimport { makeSingleton } from '@singletons';\nimport { AddonMessages } from '../messages';\nimport * as i0 from \"@angular/core\";\n/**\n * Profile send message handler.\n */\nexport class AddonMessagesSendMessageUserHandlerService {\n  constructor() {\n    this.name = 'AddonMessages:sendMessage';\n    this.priority = 1000;\n    this.type = CoreUserDelegateService.TYPE_COMMUNICATION;\n  }\n  /**\n   * @inheritdoc\n   */\n  isEnabled() {\n    return AddonMessages.isPluginEnabled();\n  }\n  /**\n   * @inheritdoc\n   */\n  isEnabledForContext() {\n    return _asyncToGenerator(function* () {\n      return !!CoreSites.getCurrentSite();\n    })();\n  }\n  /**\n   * @inheritdoc\n   */\n  isEnabledForUser(user) {\n    return _asyncToGenerator(function* () {\n      const currentSite = CoreSites.getRequiredCurrentSite();\n      // From 3.7 you can send messages to yourself.\n      return user.id != CoreSites.getCurrentSiteUserId() || currentSite.isVersionGreaterEqualThan('3.7');\n    })();\n  }\n  /**\n   * Returns the data needed to render the handler.\n   *\n   * @returns Data needed to render the handler.\n   */\n  getDisplayData() {\n    return {\n      icon: 'fas-paper-plane',\n      title: 'addon.messages.message',\n      class: 'addon-messages-send-message-handler',\n      action: (event, user) => {\n        event.preventDefault();\n        event.stopPropagation();\n        const pageParams = {\n          showKeyboard: true,\n          hideInfo: true\n        };\n        CoreNavigator.navigateToSitePath(`/messages/discussion/user/${user.id}`, {\n          params: pageParams\n        });\n      }\n    };\n  }\n}\n_class = AddonMessagesSendMessageUserHandlerService;\n_class.ɵfac = function AddonMessagesSendMessageUserHandlerService_Factory(t) {\n  return new (t || _class)();\n};\n_class.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: _class,\n  factory: _class.ɵfac,\n  providedIn: 'root'\n});\nexport const AddonMessagesSendMessageUserHandler = makeSingleton(AddonMessagesSendMessageUserHandlerService);","map":{"version":3,"names":["CoreUserDelegateService","CoreNavigator","CoreSites","makeSingleton","AddonMessages","AddonMessagesSendMessageUserHandlerService","constructor","name","priority","type","TYPE_COMMUNICATION","isEnabled","isPluginEnabled","isEnabledForContext","_asyncToGenerator","getCurrentSite","isEnabledForUser","user","currentSite","getRequiredCurrentSite","id","getCurrentSiteUserId","isVersionGreaterEqualThan","getDisplayData","icon","title","class","action","event","preventDefault","stopPropagation","pageParams","showKeyboard","hideInfo","navigateToSitePath","params","factory","ɵfac","providedIn","AddonMessagesSendMessageUserHandler"],"sources":["/home/toon/works/gitionic7/ionic-github/ionic/src/addons/messages/services/handlers/user-send-message.ts"],"sourcesContent":["// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Injectable } from '@angular/core';\nimport { Params } from '@angular/router';\nimport { CoreUserProfile } from '@features/user/services/user';\nimport { CoreUserDelegateService, CoreUserProfileHandler, CoreUserProfileHandlerData } from '@features/user/services/user-delegate';\nimport { CoreNavigator } from '@services/navigator';\nimport { CoreSites } from '@services/sites';\nimport { makeSingleton } from '@singletons';\nimport { AddonMessages } from '../messages';\n\n/**\n * Profile send message handler.\n */\n@Injectable({ providedIn: 'root' })\nexport class AddonMessagesSendMessageUserHandlerService implements CoreUserProfileHandler {\n\n    name = 'AddonMessages:sendMessage';\n    priority = 1000;\n    type = CoreUserDelegateService.TYPE_COMMUNICATION;\n\n    /**\n     * @inheritdoc\n     */\n    isEnabled(): Promise<boolean> {\n        return AddonMessages.isPluginEnabled();\n    }\n\n    /**\n     * @inheritdoc\n     */\n    async isEnabledForContext(): Promise<boolean> {\n        return !!CoreSites.getCurrentSite();\n    }\n\n    /**\n     * @inheritdoc\n     */\n    async isEnabledForUser(user: CoreUserProfile): Promise<boolean> {\n        const currentSite = CoreSites.getRequiredCurrentSite();\n\n        // From 3.7 you can send messages to yourself.\n        return user.id != CoreSites.getCurrentSiteUserId() || currentSite.isVersionGreaterEqualThan('3.7');\n    }\n\n    /**\n     * Returns the data needed to render the handler.\n     *\n     * @returns Data needed to render the handler.\n     */\n    getDisplayData(): CoreUserProfileHandlerData {\n        return {\n            icon: 'fas-paper-plane',\n            title: 'addon.messages.message',\n            class: 'addon-messages-send-message-handler',\n            action: (event: Event, user: CoreUserProfile): void => {\n                event.preventDefault();\n                event.stopPropagation();\n\n                const pageParams: Params = {\n                    showKeyboard: true,\n                    hideInfo: true,\n                };\n                CoreNavigator.navigateToSitePath(`/messages/discussion/user/${user.id}`, { params: pageParams });\n            },\n        };\n    }\n\n}\n\nexport const AddonMessagesSendMessageUserHandler = makeSingleton(AddonMessagesSendMessageUserHandlerService);\n"],"mappings":";;AAiBA,SAASA,uBAAuB,QAA4D,uCAAuC;AACnI,SAASC,aAAa,QAAQ,qBAAqB;AACnD,SAASC,SAAS,QAAQ,iBAAiB;AAC3C,SAASC,aAAa,QAAQ,aAAa;AAC3C,SAASC,aAAa,QAAQ,aAAa;;AAE3C;;;AAIA,OAAM,MAAOC,0CAA0C;EADvDC,YAAA;IAGI,KAAAC,IAAI,GAAG,2BAA2B;IAClC,KAAAC,QAAQ,GAAG,IAAI;IACf,KAAAC,IAAI,GAAGT,uBAAuB,CAACU,kBAAkB;;EAEjD;;;EAGAC,SAASA,CAAA;IACL,OAAOP,aAAa,CAACQ,eAAe,EAAE;EAC1C;EAEA;;;EAGMC,mBAAmBA,CAAA;IAAA,OAAAC,iBAAA;MACrB,OAAO,CAAC,CAACZ,SAAS,CAACa,cAAc,EAAE;IAAC;EACxC;EAEA;;;EAGMC,gBAAgBA,CAACC,IAAqB;IAAA,OAAAH,iBAAA;MACxC,MAAMI,WAAW,GAAGhB,SAAS,CAACiB,sBAAsB,EAAE;MAEtD;MACA,OAAOF,IAAI,CAACG,EAAE,IAAIlB,SAAS,CAACmB,oBAAoB,EAAE,IAAIH,WAAW,CAACI,yBAAyB,CAAC,KAAK,CAAC;IAAC;EACvG;EAEA;;;;;EAKAC,cAAcA,CAAA;IACV,OAAO;MACHC,IAAI,EAAE,iBAAiB;MACvBC,KAAK,EAAE,wBAAwB;MAC/BC,KAAK,EAAE,qCAAqC;MAC5CC,MAAM,EAAEA,CAACC,KAAY,EAAEX,IAAqB,KAAU;QAClDW,KAAK,CAACC,cAAc,EAAE;QACtBD,KAAK,CAACE,eAAe,EAAE;QAEvB,MAAMC,UAAU,GAAW;UACvBC,YAAY,EAAE,IAAI;UAClBC,QAAQ,EAAE;SACb;QACDhC,aAAa,CAACiC,kBAAkB,CAAC,6BAA6BjB,IAAI,CAACG,EAAE,EAAE,EAAE;UAAEe,MAAM,EAAEJ;QAAU,CAAE,CAAC;MACpG;KACH;EACL;;SAnDS1B,0CAA0C;;mBAA1CA,MAA0C;AAAA;;SAA1CA,MAA0C;EAAA+B,OAAA,EAA1C/B,MAA0C,CAAAgC,IAAA;EAAAC,UAAA,EAD7B;AAAM;AAwDhC,OAAO,MAAMC,mCAAmC,GAAGpC,aAAa,CAACE,0CAA0C,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}
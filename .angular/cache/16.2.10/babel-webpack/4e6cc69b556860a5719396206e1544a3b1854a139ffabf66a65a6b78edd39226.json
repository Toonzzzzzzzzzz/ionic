{"ast":null,"code":"import _asyncToGenerator from \"/home/toon/works/gitionic7/ionic-github/ionic/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _class;\n// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nimport { EventEmitter } from '@angular/core';\nimport { FormControl } from '@angular/forms';\nimport { CoreDomUtils } from '@services/utils/dom';\nimport { CoreEvents } from '@singletons/events';\nimport { CoreSites } from '@services/sites';\nimport { AddonModForum, AddonModForumProvider } from '../../services/forum';\nimport { CoreTag } from '@features/tag/services/tag';\nimport { Translate } from '@singletons';\nimport { CoreFileUploader } from '@features/fileuploader/services/fileuploader';\nimport { AddonModForumSync } from '../../services/forum-sync';\nimport { CoreSync } from '@services/sync';\nimport { CoreTextUtils } from '@services/utils/text';\nimport { AddonModForumHelper } from '../../services/forum-helper';\nimport { AddonModForumOffline } from '../../services/forum-offline';\nimport { CoreUtils } from '@services/utils/utils';\nimport { AddonModForumPostOptionsMenuComponent } from '../post-options-menu/post-options-menu';\nimport { CoreForms } from '@singletons/form';\nimport { CoreDom } from '@singletons/dom';\nimport { CoreAnalytics, CoreAnalyticsEventType } from '@services/analytics';\nimport * as i0 from \"@angular/core\";\nconst _c0 = [\"replyFormEl\"];\nfunction AddonModForumPostComponent_ng_container_1_div_4_ion_icon_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"ion-icon\", 23);\n    i0.ɵɵpipe(1, \"translate\");\n  }\n  if (rf & 2) {\n    i0.ɵɵattribute(\"aria-label\", i0.ɵɵpipeBind1(1, 1, \"addon.mod_forum.discussionpinned\"));\n  }\n}\nfunction AddonModForumPostComponent_ng_container_1_div_4_ion_icon_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"ion-icon\", 24);\n    i0.ɵɵpipe(1, \"translate\");\n  }\n  if (rf & 2) {\n    i0.ɵɵattribute(\"aria-label\", i0.ɵɵpipeBind1(1, 1, \"addon.mod_forum.favourites\"));\n  }\n}\nfunction AddonModForumPostComponent_ng_container_1_div_4_ion_note_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-note\", 25);\n    i0.ɵɵpipe(1, \"translate\");\n    i0.ɵɵelement(2, \"ion-icon\", 26);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵattribute(\"aria-label\", i0.ɵɵpipeBind1(1, 1, \"addon.mod_forum.unread\"));\n  }\n}\nfunction AddonModForumPostComponent_ng_container_1_div_4_ion_button_6_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r21 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-button\", 27);\n    i0.ɵɵlistener(\"click\", function AddonModForumPostComponent_ng_container_1_div_4_ion_button_6_Template_ion_button_click_0_listener($event) {\n      i0.ɵɵrestoreView(_r21);\n      const ctx_r20 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r20.showOptionsMenu($event));\n    });\n    i0.ɵɵpipe(1, \"translate\");\n    i0.ɵɵelement(2, \"ion-icon\", 28);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵattribute(\"aria-label\", i0.ɵɵpipeBind1(1, 1, \"core.displayoptions\"));\n  }\n}\nfunction AddonModForumPostComponent_ng_container_1_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 17)(1, \"h2\", 4);\n    i0.ɵɵtemplate(2, AddonModForumPostComponent_ng_container_1_div_4_ion_icon_2_Template, 2, 3, \"ion-icon\", 18);\n    i0.ɵɵtemplate(3, AddonModForumPostComponent_ng_container_1_div_4_ion_icon_3_Template, 2, 3, \"ion-icon\", 19);\n    i0.ɵɵelement(4, \"core-format-text\", 20);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(5, AddonModForumPostComponent_ng_container_1_div_4_ion_note_5_Template, 3, 3, \"ion-note\", 21);\n    i0.ɵɵtemplate(6, AddonModForumPostComponent_ng_container_1_div_4_ion_button_6_Template, 3, 3, \"ion-button\", 22);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.discussion && !ctx_r2.post.parentid && ctx_r2.discussion.pinned);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.discussion && !ctx_r2.post.parentid && !ctx_r2.discussion.pinned && ctx_r2.discussion.starred);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"text\", ctx_r2.post.subject)(\"contextInstanceId\", ctx_r2.forum && ctx_r2.forum.cmid)(\"courseId\", ctx_r2.courseId);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.trackPosts && ctx_r2.post.unread);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.optionsMenuEnabled);\n  }\n}\nfunction AddonModForumPostComponent_ng_container_1_core_user_avatar_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"core-user-avatar\", 29);\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"user\", ctx_r3.post.author)(\"courseId\", ctx_r3.courseId);\n  }\n}\nfunction AddonModForumPostComponent_ng_container_1_span_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 30);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r4.post.author.fullname, \" \");\n  }\n}\nfunction AddonModForumPostComponent_ng_container_1_div_9_p_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 32);\n    i0.ɵɵelement(1, \"ion-icon\", 33);\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelement(3, \"core-format-text\", 34);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const group_r23 = ctx.$implicit;\n    const ctx_r22 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵattribute(\"aria-label\", i0.ɵɵpipeBind1(2, 4, \"addon.mod_forum.group\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"text\", group_r23.name)(\"contextInstanceId\", ctx_r22.courseId)(\"wsNotFiltered\", true);\n  }\n}\nfunction AddonModForumPostComponent_ng_container_1_div_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, AddonModForumPostComponent_ng_container_1_div_9_p_1_Template, 4, 6, \"p\", 31);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r5.post.author.groups);\n  }\n}\nfunction AddonModForumPostComponent_ng_container_1_p_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"coreFormatDate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r6 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(2, 1, ctx_r6.post.timecreated * 1000, \"strftimerecentfull\"));\n  }\n}\nfunction AddonModForumPostComponent_ng_container_1_p_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵelement(1, \"ion-icon\", 35);\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(3, 1, \"core.notsent\"), \" \");\n  }\n}\nfunction AddonModForumPostComponent_ng_container_1_ng_container_12_ion_note_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-note\", 25);\n    i0.ɵɵpipe(1, \"translate\");\n    i0.ɵɵelement(2, \"ion-icon\", 26);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵattribute(\"aria-label\", i0.ɵɵpipeBind1(1, 1, \"addon.mod_forum.unread\"));\n  }\n}\nfunction AddonModForumPostComponent_ng_container_1_ng_container_12_ion_button_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r27 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-button\", 27);\n    i0.ɵɵlistener(\"click\", function AddonModForumPostComponent_ng_container_1_ng_container_12_ion_button_2_Template_ion_button_click_0_listener($event) {\n      i0.ɵɵrestoreView(_r27);\n      const ctx_r26 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r26.showOptionsMenu($event));\n    });\n    i0.ɵɵpipe(1, \"translate\");\n    i0.ɵɵelement(2, \"ion-icon\", 28);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵattribute(\"aria-label\", i0.ɵɵpipeBind1(1, 1, \"core.displayoptions\"));\n  }\n}\nfunction AddonModForumPostComponent_ng_container_1_ng_container_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, AddonModForumPostComponent_ng_container_1_ng_container_12_ion_note_1_Template, 3, 3, \"ion-note\", 21);\n    i0.ɵɵtemplate(2, AddonModForumPostComponent_ng_container_1_ng_container_12_ion_button_2_Template, 3, 3, \"ion-button\", 22);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r8 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r8.trackPosts && ctx_r8.post.unread);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r8.optionsMenuEnabled);\n  }\n}\nfunction AddonModForumPostComponent_ng_container_1_div_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 36)(1, \"ion-note\", 37);\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"translate\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(3, 1, \"addon.mod_forum.postisprivatereply\"));\n  }\n}\nconst _c1 = function (a0) {\n  return {\n    \"$a\": a0\n  };\n};\nfunction AddonModForumPostComponent_ng_container_1_p_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\")(1, \"em\");\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"translate\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r10 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(3, 1, \"core.numwords\", i0.ɵɵpureFunction1(4, _c1, ctx_r10.post.wordcount)));\n  }\n}\nfunction AddonModForumPostComponent_ng_container_1_div_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelement(1, \"core-files\", 38);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r11 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"files\", ctx_r11.post.attachments)(\"component\", ctx_r11.component)(\"componentId\", ctx_r11.componentId);\n  }\n}\nfunction AddonModForumPostComponent_ng_container_1_ion_item_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-item\", 4)(1, \"div\", 39);\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"ion-label\");\n    i0.ɵɵelement(5, \"core-tag-list\", 40);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r12 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\", i0.ɵɵpipeBind1(3, 2, \"core.tag.tags\"), \":\");\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"tags\", ctx_r12.post.tags);\n  }\n}\nfunction AddonModForumPostComponent_ng_container_1_core_rating_rate_20_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r29 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"core-rating-rate\", 41);\n    i0.ɵɵlistener(\"onUpdate\", function AddonModForumPostComponent_ng_container_1_core_rating_rate_20_Template_core_rating_rate_onUpdate_0_listener() {\n      i0.ɵɵrestoreView(_r29);\n      const ctx_r28 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r28.ratingUpdated());\n    });\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r13 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"ratingInfo\", ctx_r13.ratingInfo)(\"instanceId\", ctx_r13.componentId)(\"itemId\", ctx_r13.post.id)(\"itemSetId\", ctx_r13.discussionId)(\"courseId\", ctx_r13.courseId)(\"aggregateMethod\", ctx_r13.forum.assessed)(\"scaleId\", ctx_r13.forum.scale)(\"userId\", ctx_r13.post.author.id);\n  }\n}\nfunction AddonModForumPostComponent_ng_container_1_core_rating_aggregate_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"core-rating-aggregate\", 42);\n  }\n  if (rf & 2) {\n    const ctx_r14 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"ratingInfo\", ctx_r14.ratingInfo)(\"instanceId\", ctx_r14.componentId)(\"itemId\", ctx_r14.post.id)(\"courseId\", ctx_r14.courseId)(\"aggregateMethod\", ctx_r14.forum.assessed)(\"scaleId\", ctx_r14.forum.scale);\n  }\n}\nfunction AddonModForumPostComponent_ng_container_1_ion_item_22_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r31 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-item\", 43)(1, \"ion-label\")(2, \"ion-button\", 44);\n    i0.ɵɵlistener(\"click\", function AddonModForumPostComponent_ng_container_1_ion_item_22_Template_ion_button_click_2_listener($event) {\n      i0.ɵɵrestoreView(_r31);\n      const ctx_r30 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r30.showReplyForm($event));\n    });\n    i0.ɵɵelement(3, \"ion-icon\", 45);\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"translate\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r15 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵattribute(\"aria-controls\", \"addon-forum-reply-edit-form-\" + ctx_r15.uniqueId)(\"aria-expanded\", ctx_r15.formData.replyingTo === ctx_r15.post.id);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(5, 3, \"addon.mod_forum.reply\"), \" \");\n  }\n}\nfunction AddonModForumPostComponent_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"ion-card-header\", 3)(2, \"ion-item\", 4)(3, \"ion-label\");\n    i0.ɵɵtemplate(4, AddonModForumPostComponent_ng_container_1_div_4_Template, 7, 7, \"div\", 5);\n    i0.ɵɵelementStart(5, \"div\", 6);\n    i0.ɵɵtemplate(6, AddonModForumPostComponent_ng_container_1_core_user_avatar_6_Template, 1, 2, \"core-user-avatar\", 7);\n    i0.ɵɵelementStart(7, \"div\", 8);\n    i0.ɵɵtemplate(8, AddonModForumPostComponent_ng_container_1_span_8_Template, 2, 1, \"span\", 9);\n    i0.ɵɵtemplate(9, AddonModForumPostComponent_ng_container_1_div_9_Template, 2, 1, \"div\", 1);\n    i0.ɵɵtemplate(10, AddonModForumPostComponent_ng_container_1_p_10_Template, 3, 4, \"p\", 1);\n    i0.ɵɵtemplate(11, AddonModForumPostComponent_ng_container_1_p_11_Template, 4, 3, \"p\", 1);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(12, AddonModForumPostComponent_ng_container_1_ng_container_12_Template, 3, 2, \"ng-container\", 1);\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵelementStart(13, \"ion-card-content\");\n    i0.ɵɵtemplate(14, AddonModForumPostComponent_ng_container_1_div_14_Template, 4, 3, \"div\", 10);\n    i0.ɵɵelement(15, \"core-format-text\", 11);\n    i0.ɵɵtemplate(16, AddonModForumPostComponent_ng_container_1_p_16_Template, 4, 6, \"p\", 1);\n    i0.ɵɵtemplate(17, AddonModForumPostComponent_ng_container_1_div_17_Template, 2, 3, \"div\", 1);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(18, \"div\", 12);\n    i0.ɵɵtemplate(19, AddonModForumPostComponent_ng_container_1_ion_item_19_Template, 6, 4, \"ion-item\", 13);\n    i0.ɵɵtemplate(20, AddonModForumPostComponent_ng_container_1_core_rating_rate_20_Template, 1, 8, \"core-rating-rate\", 14);\n    i0.ɵɵtemplate(21, AddonModForumPostComponent_ng_container_1_core_rating_aggregate_21_Template, 1, 6, \"core-rating-aggregate\", 15);\n    i0.ɵɵtemplate(22, AddonModForumPostComponent_ng_container_1_ion_item_22_Template, 6, 5, \"ion-item\", 16);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate1(\"id\", \"addon-mod_forum-post-\", ctx_r0.post.id, \"\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵclassProp(\"highlight\", ctx_r0.highlight);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.displaySubject);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.post.author && ctx_r0.post.author.fullname);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.post.author && ctx_r0.post.author.fullname);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.post.author && ctx_r0.post.author.groups);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.post.timecreated);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r0.post.timecreated);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r0.displaySubject);\n    i0.ɵɵadvance(1);\n    i0.ɵɵclassMap(ctx_r0.post.parentid === 0 ? \"ion-padding-top\" : \"\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.post.isprivatereply);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"component\", ctx_r0.component)(\"componentId\", ctx_r0.componentId)(\"text\", ctx_r0.post.message)(\"contextInstanceId\", ctx_r0.forum && ctx_r0.forum.cmid)(\"courseId\", ctx_r0.courseId);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.post.haswordcount && ctx_r0.post.wordcount);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.post.attachments && ctx_r0.post.attachments.length > 0);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.tagsEnabled && ctx_r0.post.tags && ctx_r0.post.tags.length > 0);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.forum && ctx_r0.ratingInfo);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.forum && ctx_r0.ratingInfo);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.post.id > 0 && ctx_r0.post.capabilities.reply && !ctx_r0.post.isprivatereply);\n  }\n}\nfunction AddonModForumPostComponent_form_2_ion_item_14_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r38 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-item\", 4)(1, \"ion-label\");\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"ion-checkbox\", 53);\n    i0.ɵɵlistener(\"ngModelChange\", function AddonModForumPostComponent_form_2_ion_item_14_Template_ion_checkbox_ngModelChange_4_listener($event) {\n      i0.ɵɵrestoreView(_r38);\n      const ctx_r37 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r37.formData.isprivatereply = $event);\n    });\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r33 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(3, 2, \"addon.mod_forum.privatereply\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngModel\", ctx_r33.formData.isprivatereply);\n  }\n}\nfunction AddonModForumPostComponent_form_2_ng_container_15_ion_icon_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"ion-icon\", 58);\n  }\n}\nfunction AddonModForumPostComponent_form_2_ng_container_15_ion_icon_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"ion-icon\", 59);\n  }\n}\nfunction AddonModForumPostComponent_form_2_ng_container_15_div_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 46);\n    i0.ɵɵelement(1, \"core-attachments\", 60);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r41 = i0.ɵɵnextContext(3);\n    i0.ɵɵproperty(\"id\", \"addon-forum-reply-edit-form-advanced-\" + ctx_r41.uniqueId);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"files\", ctx_r41.formData.files)(\"maxSize\", ctx_r41.forum.maxbytes)(\"maxSubmissions\", ctx_r41.forum.maxattachments)(\"component\", ctx_r41.component)(\"componentId\", ctx_r41.forum.cmid)(\"allowOffline\", true)(\"courseId\", ctx_r41.courseId);\n  }\n}\nfunction AddonModForumPostComponent_form_2_ng_container_15_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r43 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"ion-item\", 54);\n    i0.ɵɵlistener(\"click\", function AddonModForumPostComponent_form_2_ng_container_15_Template_ion_item_click_1_listener() {\n      i0.ɵɵrestoreView(_r43);\n      const ctx_r42 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r42.toggleAdvanced());\n    });\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵtemplate(3, AddonModForumPostComponent_form_2_ng_container_15_ion_icon_3_Template, 1, 0, \"ion-icon\", 55);\n    i0.ɵɵtemplate(4, AddonModForumPostComponent_form_2_ng_container_15_ion_icon_4_Template, 1, 0, \"ion-icon\", 56);\n    i0.ɵɵelementStart(5, \"ion-label\")(6, \"h3\", 57);\n    i0.ɵɵtext(7);\n    i0.ɵɵpipe(8, \"translate\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵtemplate(9, AddonModForumPostComponent_form_2_ng_container_15_div_9_Template, 2, 8, \"div\", 2);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r34 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"detail\", false);\n    i0.ɵɵattribute(\"aria-expanded\", ctx_r34.advanced)(\"aria-controls\", \"addon-forum-reply-edit-form-advanced-\" + ctx_r34.uniqueId)(\"aria-label\", i0.ɵɵpipeBind1(2, 8, ctx_r34.advanced ? \"core.hideadvanced\" : \"core.showadvanced\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r34.advanced);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r34.advanced);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(8, 10, \"addon.mod_forum.advanced\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r34.advanced);\n  }\n}\nfunction AddonModForumPostComponent_form_2_span_24_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(2, 1, \"core.savechanges\"));\n  }\n}\nfunction AddonModForumPostComponent_form_2_span_25_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(2, 1, \"addon.mod_forum.posttoforum\"));\n  }\n}\nconst _c2 = function (a0) {\n  return {\n    reply: a0\n  };\n};\nfunction AddonModForumPostComponent_form_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r45 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"form\", 46, 47)(2, \"ion-item\")(3, \"ion-label\", 48);\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"ion-input\", 49);\n    i0.ɵɵlistener(\"ngModelChange\", function AddonModForumPostComponent_form_2_Template_ion_input_ngModelChange_6_listener($event) {\n      i0.ɵɵrestoreView(_r45);\n      const ctx_r44 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r44.formData.subject = $event);\n    });\n    i0.ɵɵpipe(7, \"translate\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"ion-item\")(9, \"ion-label\", 48);\n    i0.ɵɵtext(10);\n    i0.ɵɵpipe(11, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"core-rich-text-editor\", 50);\n    i0.ɵɵlistener(\"contentChanged\", function AddonModForumPostComponent_form_2_Template_core_rich_text_editor_contentChanged_12_listener($event) {\n      i0.ɵɵrestoreView(_r45);\n      const ctx_r46 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r46.onMessageChange($event));\n    });\n    i0.ɵɵpipe(13, \"translate\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(14, AddonModForumPostComponent_form_2_ion_item_14_Template, 5, 4, \"ion-item\", 13);\n    i0.ɵɵtemplate(15, AddonModForumPostComponent_form_2_ng_container_15_Template, 10, 12, \"ng-container\", 1);\n    i0.ɵɵelementStart(16, \"ion-grid\")(17, \"ion-row\")(18, \"ion-col\")(19, \"ion-button\", 51);\n    i0.ɵɵlistener(\"click\", function AddonModForumPostComponent_form_2_Template_ion_button_click_19_listener() {\n      i0.ɵɵrestoreView(_r45);\n      const ctx_r47 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r47.cancel());\n    });\n    i0.ɵɵtext(20);\n    i0.ɵɵpipe(21, \"translate\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(22, \"ion-col\")(23, \"ion-button\", 52);\n    i0.ɵɵlistener(\"click\", function AddonModForumPostComponent_form_2_Template_ion_button_click_23_listener() {\n      i0.ɵɵrestoreView(_r45);\n      const ctx_r48 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r48.send());\n    });\n    i0.ɵɵtemplate(24, AddonModForumPostComponent_form_2_span_24_Template, 3, 3, \"span\", 1);\n    i0.ɵɵtemplate(25, AddonModForumPostComponent_form_2_span_25_Template, 3, 3, \"span\", 1);\n    i0.ɵɵelementEnd()()()()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"id\", \"addon-forum-reply-edit-form-\" + ctx_r1.uniqueId);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(5, 19, \"addon.mod_forum.subject\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"placeholder\", i0.ɵɵpipeBind1(7, 21, \"addon.mod_forum.subject\"))(\"ngModel\", ctx_r1.formData.subject);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(11, 23, \"addon.mod_forum.message\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"control\", ctx_r1.messageControl)(\"placeholder\", i0.ɵɵpipeBind1(13, 25, \"addon.mod_forum.replyplaceholder\"))(\"name\", \"mod_forum_reply_\" + ctx_r1.post.id)(\"component\", ctx_r1.component)(\"componentId\", ctx_r1.componentId)(\"autoSave\", true)(\"contextInstanceId\", ctx_r1.forum && ctx_r1.forum.cmid)(\"draftExtraParams\", i0.ɵɵpureFunction1(29, _c2, ctx_r1.post.id));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.accessInfo.canpostprivatereply);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.forum.id && ctx_r1.forum.maxattachments > 0);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(21, 27, \"core.cancel\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"disabled\", ctx_r1.formData.subject === \"\" || ctx_r1.formData.message === null);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.formData.isEditing);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r1.formData.isEditing);\n  }\n}\n/**\n * Components that shows a discussion post, its attachments and the action buttons allowed (reply, etc.).\n */\nexport class AddonModForumPostComponent {\n  constructor(elementRef) {\n    this.elementRef = elementRef;\n    this.highlight = false;\n    this.onPostChange = new EventEmitter(); // Event emitted when a reply is posted or modified.\n    this.messageControl = new FormControl();\n    this.advanced = false; // Display all form fields.\n    this.displaySubject = true;\n    this.optionsMenuEnabled = false;\n  }\n  get showForm() {\n    return this.post.id > 0 ? !this.formData.isEditing && this.formData.replyingTo === this.post.id || !!this.formData.isEditing && this.formData.id === this.post.id : !!this.formData.isEditing && this.formData.replyingTo === this.post.parentid;\n  }\n  /**\n   * @inheritdoc\n   */\n  ngOnInit() {\n    this.tagsEnabled = CoreTag.areTagsAvailableInSite();\n    this.uniqueId = this.post.id > 0 ? 'reply' + this.post.id : 'edit' + this.post.parentid;\n    const reTranslated = Translate.instant('addon.mod_forum.re');\n    this.displaySubject = !this.parentSubject || this.post.subject != this.parentSubject && this.post.subject != `Re: ${this.parentSubject}` && this.post.subject != `${reTranslated} ${this.parentSubject}`;\n    this.defaultReplySubject = this.post.replysubject || (this.post.subject.startsWith('Re: ') || this.post.subject.startsWith(reTranslated) ? this.post.subject : `${reTranslated} ${this.post.subject}`);\n    if (this.post.id < 0) {\n      this.optionsMenuEnabled = true;\n    } else if (this.post.capabilities.delete !== undefined) {\n      this.optionsMenuEnabled = this.post.capabilities.delete === true || this.post.capabilities.edit === true;\n    } else {\n      // Cannot know if the user can edit/delete or not, display the menu if the WebServices are available.\n      this.optionsMenuEnabled = this.post.id < 0 || AddonModForum.isGetDiscussionPostAvailable() && (AddonModForum.isDeletePostAvailable() || AddonModForum.isUpdatePostAvailable());\n    }\n  }\n  /**\n   * Detect changes on input properties.\n   */\n  ngOnChanges(changes) {\n    if (changes.leavingPage && this.leavingPage) {\n      // Download all courses is enabled now, initialize it.\n      CoreForms.triggerFormCancelledEvent(this.formElement, CoreSites.getCurrentSiteId());\n    }\n  }\n  /**\n   * Deletes an online post.\n   */\n  deletePost() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      // Log analytics even if the user cancels for consistency with LMS.\n      _this.analyticsLogEvent('mod_forum_delete_post', `/mod/forum/post.php?delete=${_this.post.id}`);\n      try {\n        yield CoreDomUtils.showDeleteConfirm('addon.mod_forum.deletesure');\n        const modal = yield CoreDomUtils.showModalLoading('core.deleting', true);\n        try {\n          const response = yield AddonModForum.deletePost(_this.post.id);\n          const data = {\n            forumId: _this.forum.id,\n            discussionId: _this.discussionId,\n            cmId: _this.forum.cmid,\n            deleted: response.status,\n            post: _this.post\n          };\n          CoreEvents.trigger(AddonModForumProvider.CHANGE_DISCUSSION_EVENT, data, CoreSites.getCurrentSiteId());\n          CoreDomUtils.showToast('addon.mod_forum.deletedpost', true);\n        } catch (error) {\n          CoreDomUtils.showErrorModal(error);\n        } finally {\n          modal.dismiss();\n        }\n      } catch (error) {\n        // Do nothing.\n      }\n    })();\n  }\n  /**\n   * Set data to new/edit post, clearing temporary files and updating original data.\n   *\n   * @param replyingTo Id of post beeing replied.\n   * @param isEditing True it's an offline reply beeing edited, false otherwise.\n   * @param subject Subject of the reply.\n   * @param message Message of the reply.\n   * @param files Reply attachments.\n   * @param isPrivate True if it's private reply.\n   * @param postId The post ID if user is editing an online post.\n   */\n  setFormData(replyingTo, isEditing, subject, message, files, isPrivate, postId) {\n    // Delete the local files from the tmp folder if any.\n    CoreFileUploader.clearTmpFiles(this.formData.files);\n    this.formData.replyingTo = replyingTo || 0;\n    this.formData.isEditing = !!isEditing;\n    this.formData.subject = subject || this.defaultReplySubject || '';\n    this.formData.message = message || null;\n    this.formData.files = files || [];\n    this.formData.isprivatereply = !!isPrivate;\n    this.formData.id = postId;\n    // Update rich text editor.\n    this.messageControl.setValue(this.formData.message);\n    // Update original data.\n    this.originalData.subject = this.formData.subject;\n    this.originalData.message = this.formData.message;\n    this.originalData.files = this.formData.files.slice();\n    this.originalData.isprivatereply = this.formData.isprivatereply;\n    // Show advanced fields if any of them has not the default value.\n    this.advanced = this.formData.files.length > 0;\n  }\n  /**\n   * Show the context menu.\n   *\n   * @param event Click Event.\n   */\n  showOptionsMenu(event) {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      const popoverData = yield CoreDomUtils.openPopover({\n        component: AddonModForumPostOptionsMenuComponent,\n        componentProps: {\n          post: _this2.post,\n          forumId: _this2.forum.id,\n          cmId: _this2.forum.cmid\n        },\n        event,\n        waitForDismissCompleted: true\n      });\n      if (popoverData && popoverData.action) {\n        switch (popoverData.action) {\n          case 'edit':\n            _this2.editPost();\n            break;\n          case 'delete':\n            _this2.deletePost();\n            break;\n          case 'deleteoffline':\n            _this2.discardOfflineReply();\n            break;\n        }\n      }\n    })();\n  }\n  /**\n   * Set this post as being replied to.\n   *\n   * @param event Click event.\n   */\n  showReplyForm(event) {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      event.preventDefault();\n      event.stopPropagation();\n      if (_this3.formData.isEditing) {\n        // User is editing a post, data needs to be resetted. Ask confirm if there is unsaved data.\n        try {\n          yield _this3.confirmDiscard();\n          _this3.setFormData(_this3.post.id);\n          _this3.scrollToForm();\n        } catch (_unused) {\n          // Cancelled.\n        }\n        return;\n      }\n      if (!_this3.formData.replyingTo) {\n        // User isn't replying, it's a brand new reply. Initialize the data.\n        _this3.setFormData(_this3.post.id);\n      } else {\n        // The post being replied has changed but the data will be kept.\n        _this3.formData.replyingTo = _this3.post.id;\n        if (_this3.formData.subject == _this3.originalData.subject) {\n          // Update subject only if it hadn't been modified\n          _this3.formData.subject = _this3.defaultReplySubject;\n          _this3.originalData.subject = _this3.defaultReplySubject;\n        }\n        _this3.messageControl.setValue(_this3.formData.message);\n      }\n      _this3.scrollToForm();\n      _this3.analyticsLogEvent('mod_forum_add_discussion_post', `/mod/forum/post.php?reply=${_this3.post.id}`);\n    })();\n  }\n  /**\n   * Set this post as being edited to.\n   */\n  editPost() {\n    var _this4 = this;\n    return _asyncToGenerator(function* () {\n      // Ask confirm if there is unsaved data.\n      try {\n        yield _this4.confirmDiscard();\n        _this4.formData.syncId = AddonModForumSync.getDiscussionSyncId(_this4.discussionId);\n        CoreSync.blockOperation(AddonModForumProvider.COMPONENT, _this4.formData.syncId);\n        _this4.setFormData(_this4.post.parentid, true, _this4.post.subject, _this4.post.message, _this4.post.attachments, _this4.post.isprivatereply, _this4.post.id > 0 ? _this4.post.id : undefined);\n        _this4.scrollToForm();\n        _this4.analyticsLogEvent('mod_forum_update_discussion_post', `/mod/forum/post.php?edit=${_this4.post.id}`);\n      } catch (_unused2) {\n        // Cancelled.\n      }\n    })();\n  }\n  /**\n   * Message changed.\n   *\n   * @param text The new text.\n   */\n  onMessageChange(text) {\n    this.formData.message = text !== null && text !== void 0 ? text : null;\n  }\n  /**\n   * Reply to this post or edit post data.\n   */\n  send() {\n    var _this5 = this;\n    return _asyncToGenerator(function* () {\n      if (!_this5.formData.subject) {\n        CoreDomUtils.showErrorModal('addon.mod_forum.erroremptysubject', true);\n        return;\n      }\n      if (!_this5.formData.message) {\n        CoreDomUtils.showErrorModal('addon.mod_forum.erroremptymessage', true);\n        return;\n      }\n      let saveOffline = false;\n      let message = _this5.formData.message;\n      const subject = _this5.formData.subject;\n      const replyingTo = _this5.formData.replyingTo;\n      const files = _this5.formData.files || [];\n      const isEditOnline = _this5.formData.id && _this5.formData.id > 0;\n      const modal = yield CoreDomUtils.showModalLoading('core.sending', true);\n      // Add some HTML to the message if needed.\n      message = CoreTextUtils.formatHtmlLines(message);\n      // Upload attachments first if any.\n      let attachments;\n      try {\n        if (files.length) {\n          try {\n            attachments = yield AddonModForumHelper.uploadOrStoreReplyFiles(_this5.forum.id, isEditOnline ? _this5.formData.id : replyingTo, files, false);\n          } catch (error) {\n            // Cannot upload them in online, save them in offline.\n            if (!_this5.forum.id || isEditOnline || CoreUtils.isWebServiceError(error)) {\n              // Cannot store them in offline. Reject.\n              throw error;\n            }\n            saveOffline = true;\n            attachments = yield AddonModForumHelper.uploadOrStoreReplyFiles(_this5.forum.id, replyingTo, files, true);\n          }\n        }\n        let sent = false;\n        if (isEditOnline) {\n          sent = yield AddonModForum.updatePost(_this5.formData.id, subject, message, {\n            attachmentsid: attachments\n          });\n        } else if (saveOffline) {\n          // Save post in offline.\n          yield AddonModForumOffline.replyPost(replyingTo, _this5.discussionId, _this5.forum.id, _this5.forum.name, _this5.courseId, subject, message, {\n            attachmentsid: attachments,\n            private: !!_this5.formData.isprivatereply\n          });\n          // Set sent to false since it wasn't sent to server.\n          sent = false;\n        } else {\n          // Try to send it to server.\n          // Don't allow offline if there are attachments since they were uploaded fine.\n          sent = yield AddonModForum.replyPost(replyingTo, _this5.discussionId, _this5.forum.id, _this5.forum.name, _this5.courseId, subject, message, {\n            attachmentsid: attachments,\n            private: !!_this5.formData.isprivatereply\n          }, undefined, !files.length);\n        }\n        if (sent && _this5.forum.id) {\n          // Data sent to server, delete stored files (if any).\n          AddonModForumHelper.deleteReplyStoredFiles(_this5.forum.id, replyingTo);\n        }\n        // Reset data.\n        _this5.setFormData();\n        _this5.onPostChange.emit();\n        CoreForms.triggerFormSubmittedEvent(_this5.formElement, sent, CoreSites.getCurrentSiteId());\n        _this5.unblockOperation();\n      } catch (error) {\n        CoreDomUtils.showErrorModalDefault(error, isEditOnline ? 'addon.mod_forum.couldnotupdate' : 'addon.mod_forum.couldnotadd', true);\n      } finally {\n        modal.dismiss();\n      }\n    })();\n  }\n  /**\n   * Cancel reply.\n   */\n  cancel() {\n    var _this6 = this;\n    return _asyncToGenerator(function* () {\n      try {\n        yield _this6.confirmDiscard();\n        // Reset data.\n        _this6.setFormData();\n        CoreForms.triggerFormCancelledEvent(_this6.formElement, CoreSites.getCurrentSiteId());\n        _this6.unblockOperation();\n      } catch (error) {\n        // Cancelled.\n      }\n    })();\n  }\n  /**\n   * Discard offline reply.\n   */\n  discardOfflineReply() {\n    var _this7 = this;\n    return _asyncToGenerator(function* () {\n      try {\n        yield CoreDomUtils.showDeleteConfirm();\n        const promises = [];\n        promises.push(AddonModForumOffline.deleteReply(_this7.post.parentid));\n        if (_this7.forum.id) {\n          promises.push(AddonModForumHelper.deleteReplyStoredFiles(_this7.forum.id, _this7.post.parentid).catch(() => {\n            // Ignore errors, maybe there are no files.\n          }));\n        }\n        yield CoreUtils.ignoreErrors(Promise.all(promises));\n        // Reset data.\n        _this7.setFormData();\n        _this7.onPostChange.emit();\n        _this7.unblockOperation();\n      } catch (error) {\n        // Cancelled.\n      }\n    })();\n  }\n  /**\n   * Function called when rating is updated online.\n   */\n  ratingUpdated() {\n    AddonModForum.invalidateDiscussionPosts(this.discussionId, this.forum.id);\n  }\n  /**\n   * Show or hide advanced form fields.\n   */\n  toggleAdvanced() {\n    this.advanced = !this.advanced;\n  }\n  /**\n   * @inheritdoc\n   */\n  ngOnDestroy() {\n    this.unblockOperation();\n  }\n  /**\n   * Confirm discard changes if any.\n   *\n   * @returns Promise resolved if the user confirms or data was not changed and rejected otherwise.\n   */\n  confirmDiscard() {\n    var _this8 = this;\n    return _asyncToGenerator(function* () {\n      if (AddonModForumHelper.hasPostDataChanged(_this8.formData, _this8.originalData)) {\n        // Show confirmation if some data has been modified.\n        yield CoreDomUtils.showConfirm(Translate.instant('core.confirmloss'));\n      }\n      _this8.unblockOperation();\n    })();\n  }\n  /**\n   * Unblock operation if there's any blocked operation.\n   */\n  unblockOperation() {\n    if (!this.formData.syncId) {\n      return;\n    }\n    CoreSync.unblockOperation(AddonModForumProvider.COMPONENT, this.formData.syncId);\n    delete this.formData.syncId;\n  }\n  /**\n   * Scroll to reply/edit form.\n   *\n   * @returns Promise resolved when done.\n   */\n  scrollToForm() {\n    var _this9 = this;\n    return _asyncToGenerator(function* () {\n      yield CoreDom.scrollToElement(_this9.elementRef.nativeElement, '#addon-forum-reply-edit-form-' + _this9.uniqueId);\n    })();\n  }\n  /**\n   * Log analytics event.\n   *\n   * @param wsName WS name.\n   * @param url URL.\n   */\n  analyticsLogEvent(wsName, url) {\n    if (this.post.id <= 0) {\n      return;\n    }\n    CoreAnalytics.logEvent({\n      type: CoreAnalyticsEventType.VIEW_ITEM,\n      ws: wsName,\n      name: this.post.subject,\n      data: {\n        id: this.post.id,\n        forumid: this.forum.id,\n        category: 'forum'\n      },\n      url\n    });\n  }\n}\n_class = AddonModForumPostComponent;\n_class.ɵfac = function AddonModForumPostComponent_Factory(t) {\n  return new (t || _class)(i0.ɵɵdirectiveInject(i0.ElementRef));\n};\n_class.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: _class,\n  selectors: [[\"addon-mod-forum-post\"]],\n  viewQuery: function AddonModForumPostComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(_c0, 5);\n    }\n    if (rf & 2) {\n      let _t;\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.formElement = _t.first);\n    }\n  },\n  inputs: {\n    post: \"post\",\n    courseId: \"courseId\",\n    discussionId: \"discussionId\",\n    discussion: \"discussion\",\n    component: \"component\",\n    componentId: \"componentId\",\n    formData: \"formData\",\n    originalData: \"originalData\",\n    trackPosts: \"trackPosts\",\n    forum: \"forum\",\n    accessInfo: \"accessInfo\",\n    parentSubject: \"parentSubject\",\n    ratingInfo: \"ratingInfo\",\n    leavingPage: \"leavingPage\",\n    highlight: \"highlight\"\n  },\n  outputs: {\n    onPostChange: \"onPostChange\"\n  },\n  features: [i0.ɵɵNgOnChangesFeature],\n  decls: 3,\n  vars: 2,\n  consts: [[1, \"addon-mod_forum-post\"], [4, \"ngIf\"], [3, \"id\", 4, \"ngIf\"], [1, \"ion-text-wrap\", \"ion-no-padding\", 3, \"id\"], [1, \"ion-text-wrap\"], [\"class\", \"addon-mod-forum-post-title\", 4, \"ngIf\"], [1, \"addon-mod-forum-post-info\"], [\"slot\", \"start\", 3, \"user\", \"courseId\", 4, \"ngIf\"], [1, \"addon-mod-forum-post-author\"], [\"class\", \"core-discussionusername\", 4, \"ngIf\"], [\"class\", \"ion-padding-bottom\", 4, \"ngIf\"], [\"contextLevel\", \"module\", 3, \"component\", \"componentId\", \"text\", \"contextInstanceId\", \"courseId\"], [1, \"addon-mod-forum-post-more-info\"], [\"class\", \"ion-text-wrap\", 4, \"ngIf\"], [\"contextLevel\", \"module\", 3, \"ratingInfo\", \"instanceId\", \"itemId\", \"itemSetId\", \"courseId\", \"aggregateMethod\", \"scaleId\", \"userId\", \"onUpdate\", 4, \"ngIf\"], [\"contextLevel\", \"module\", 3, \"ratingInfo\", \"instanceId\", \"itemId\", \"courseId\", \"aggregateMethod\", \"scaleId\", 4, \"ngIf\"], [\"class\", \"ion-no-padding ion-text-end addon-forum-reply-button\", 4, \"ngIf\"], [1, \"addon-mod-forum-post-title\"], [\"name\", \"fas-map-pin\", 4, \"ngIf\"], [\"name\", \"fas-star\", \"class\", \"addon-forum-star\", 4, \"ngIf\"], [\"contextLevel\", \"module\", 3, \"text\", \"contextInstanceId\", \"courseId\"], [\"class\", \"ion-float-end ion-padding-start ion-text-end\", 4, \"ngIf\"], [\"fill\", \"clear\", 3, \"click\", 4, \"ngIf\"], [\"name\", \"fas-map-pin\"], [\"name\", \"fas-star\", 1, \"addon-forum-star\"], [1, \"ion-float-end\", \"ion-padding-start\", \"ion-text-end\"], [\"name\", \"fas-circle\", \"color\", \"primary\", \"aria-hidden\", \"true\"], [\"fill\", \"clear\", 3, \"click\"], [\"name\", \"ellipsis-vertical\", \"slot\", \"icon-only\", \"aria-hidden\", \"true\"], [\"slot\", \"start\", 3, \"user\", \"courseId\"], [1, \"core-discussionusername\"], [\"class\", \"core-groupname\", 4, \"ngFor\", \"ngForOf\"], [1, \"core-groupname\"], [\"name\", \"fas-users\"], [\"contextLevel\", \"course\", 3, \"text\", \"contextInstanceId\", \"wsNotFiltered\"], [\"name\", \"fas-clock\", \"aria-hidden\", \"true\"], [1, \"ion-padding-bottom\"], [\"color\", \"danger\"], [\"showInline\", \"true\", 3, \"files\", \"component\", \"componentId\"], [\"slot\", \"start\"], [3, \"tags\"], [\"contextLevel\", \"module\", 3, \"ratingInfo\", \"instanceId\", \"itemId\", \"itemSetId\", \"courseId\", \"aggregateMethod\", \"scaleId\", \"userId\", \"onUpdate\"], [\"contextLevel\", \"module\", 3, \"ratingInfo\", \"instanceId\", \"itemId\", \"courseId\", \"aggregateMethod\", \"scaleId\"], [1, \"ion-no-padding\", \"ion-text-end\", \"addon-forum-reply-button\"], [\"fill\", \"clear\", \"size\", \"small\", 3, \"click\"], [\"name\", \"fas-reply\", \"slot\", \"start\", \"aria-hidden\", \"true\"], [3, \"id\"], [\"replyFormEl\", \"\"], [\"position\", \"stacked\"], [\"type\", \"text\", \"name\", \"subject\", 3, \"placeholder\", \"ngModel\", \"ngModelChange\"], [\"elementId\", \"message\", \"contextLevel\", \"module\", 3, \"control\", \"placeholder\", \"name\", \"component\", \"componentId\", \"autoSave\", \"contextInstanceId\", \"draftExtraParams\", \"contentChanged\"], [\"expand\", \"block\", \"fill\", \"outline\", 3, \"click\"], [\"expand\", \"block\", 3, \"disabled\", \"click\"], [\"slot\", \"end\", \"name\", \"isprivatereply\", 3, \"ngModel\", \"ngModelChange\"], [\"button\", \"\", 1, \"divider\", \"ion-text-wrap\", 3, \"detail\", \"click\"], [\"name\", \"fas-chevron-right\", \"flip-rtl\", \"\", \"slot\", \"start\", \"aria-hidden\", \"true\", \"class\", \"expandable-status-icon\", 4, \"ngIf\"], [\"name\", \"fas-chevron-down\", \"slot\", \"start\", \"aria-hidden\", \"true\", \"class\", \"expandable-status-icon\", 4, \"ngIf\"], [1, \"item-heading\"], [\"name\", \"fas-chevron-right\", \"flip-rtl\", \"\", \"slot\", \"start\", \"aria-hidden\", \"true\", 1, \"expandable-status-icon\"], [\"name\", \"fas-chevron-down\", \"slot\", \"start\", \"aria-hidden\", \"true\", 1, \"expandable-status-icon\"], [3, \"files\", \"maxSize\", \"maxSubmissions\", \"component\", \"componentId\", \"allowOffline\", \"courseId\"]],\n  template: function AddonModForumPostComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0);\n      i0.ɵɵtemplate(1, AddonModForumPostComponent_ng_container_1_Template, 23, 24, \"ng-container\", 1);\n      i0.ɵɵtemplate(2, AddonModForumPostComponent_form_2_Template, 26, 31, \"form\", 2);\n      i0.ɵɵelementEnd();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", !ctx.formData.isEditing || !ctx.showForm);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.showForm);\n    }\n  },\n  styles: [\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n[_nghost-%COMP%]   .addon-mod_forum-post[_ngcontent-%COMP%] {\\n  background-color: var(--ion-item-background);\\n  border-bottom: 1px solid var(--addon-forum-border-color);\\n}\\n[_nghost-%COMP%]   .addon-mod_forum-post[_ngcontent-%COMP%]   .addon-forum-star[_ngcontent-%COMP%] {\\n  color: var(--core-star-color);\\n}\\n[_nghost-%COMP%]   .addon-mod_forum-post[_ngcontent-%COMP%]   .core-discussionusername[_ngcontent-%COMP%] {\\n  font-size: 1.2em;\\n}\\n[_nghost-%COMP%]   .addon-mod_forum-post[_ngcontent-%COMP%]   .core-groupname[_ngcontent-%COMP%] {\\n  display: flex;\\n  align-items: center;\\n  gap: 4px;\\n}\\n[_nghost-%COMP%]   .addon-mod_forum-post[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]   .item.highlight[_ngcontent-%COMP%]::part(native) {\\n  background-color: var(--addon-forum-highlight-color);\\n}\\n[_nghost-%COMP%]   .addon-mod_forum-post[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%] {\\n  margin-top: 4px;\\n}\\n[_nghost-%COMP%]   .addon-mod_forum-post[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%] {\\n  margin-top: 8px;\\n  margin-bottom: 8px;\\n  font-weight: bold;\\n  flex-grow: 1;\\n}\\n[_nghost-%COMP%]   .addon-mod_forum-post[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%] {\\n  -webkit-margin-start: 0;\\n  margin-inline-start: 0;\\n  -webkit-margin-end: 6px;\\n  margin-inline-end: 6px;\\n  margin-top: 0;\\n  margin-bottom: 0;\\n}\\n[_nghost-%COMP%]   .addon-mod_forum-post[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   core-user-avatar[_ngcontent-%COMP%] {\\n  --core-avatar-size: var(--addon-forum-avatar-size);\\n  -webkit-margin-start: 0;\\n  margin-inline-start: 0;\\n  -webkit-margin-end: 8px;\\n  margin-inline-end: 8px;\\n  margin-top: 0;\\n  margin-bottom: 0;\\n}\\n[_nghost-%COMP%]   .addon-mod_forum-post[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .addon-mod-forum-post-title[_ngcontent-%COMP%], [_nghost-%COMP%]   .addon-mod_forum-post[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .addon-mod-forum-post-info[_ngcontent-%COMP%] {\\n  display: flex;\\n  align-items: center;\\n}\\n[_nghost-%COMP%]   .addon-mod_forum-post[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .addon-mod-forum-post-info[_ngcontent-%COMP%] {\\n  margin-top: 8px;\\n}\\n[_nghost-%COMP%]   .addon-mod_forum-post[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .addon-mod-forum-post-title[_ngcontent-%COMP%]    + .addon-mod-forum-post-info[_ngcontent-%COMP%] {\\n  margin-top: 0px;\\n}\\n[_nghost-%COMP%]   .addon-mod_forum-post[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .addon-mod-forum-post-title[_ngcontent-%COMP%]   .item-heading[_ngcontent-%COMP%], [_nghost-%COMP%]   .addon-mod_forum-post[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .addon-mod-forum-post-info[_ngcontent-%COMP%]   .addon-mod-forum-post-author[_ngcontent-%COMP%] {\\n  flex-grow: 1;\\n}\\n[_nghost-%COMP%]   .addon-mod_forum-post[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%] {\\n  padding-top: 14px;\\n}\\n[_nghost-%COMP%]   .addon-mod_forum-post[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .item-inner[_ngcontent-%COMP%] {\\n  border-bottom: 0;\\n}\\n[_nghost-%COMP%]   .addon-mod_forum-post[_ngcontent-%COMP%]   .addon-mod-forum-post-more-info[_ngcontent-%COMP%]   div[_ngcontent-%COMP%] {\\n  font-size: 1rem;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy90aGVtZS9nbG9iYWxzLnNjc3MiLCJ3ZWJwYWNrOi8vLi9zcmMvdGhlbWUvaGVscGVycy9pb25pYy5mdW5jdGlvbnMuc3RyaW5nLnNjc3MiLCJ3ZWJwYWNrOi8vLi9zcmMvdGhlbWUvaGVscGVycy9pb25pYy5mdW5jdGlvbnMuY29sb3Iuc2NzcyIsIndlYnBhY2s6Ly8uL3NyYy90aGVtZS9oZWxwZXJzL2lvbmljLm1peGlucy5zY3NzIiwid2VicGFjazovLy4vc3JjL3RoZW1lL2hlbHBlcnMvaW9uaWMuY29tcG9uZW50cy5taXhpbnMuc2NzcyIsIndlYnBhY2s6Ly8uL3NyYy90aGVtZS9oZWxwZXJzL2N1c3RvbS5taXhpbnMuc2NzcyIsIndlYnBhY2s6Ly8uL3NyYy90aGVtZS9nbG9iYWxzLmN1c3RvbS5zY3NzIiwid2VicGFjazovLy4vc3JjL3RoZW1lL2dsb2JhbHMudmFyaWFibGVzLnNjc3MiLCJ3ZWJwYWNrOi8vLi9zcmMvYWRkb25zL21vZC9mb3J1bS9jb21wb25lbnRzL3Bvc3QvcG9zdC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7O0VBQUE7QUNBQTs7Ozs7RUFBQTtBQ0FBOzs7OztFQUFBO0FDQUE7Ozs7O0VBQUE7QUNBQTs7Ozs7O0VBQUE7QUNFQTs7OztFQUFBO0FBNEdBOztFQUFBO0FDOUdBOzs7O0VBQUE7QUNBQTs7OztFQUFBO0FBK0RBOzs7O0VBQUE7QUM3REE7RUFDSSw0Q0FBQTtFQUNBLHdEQUFBO0FBb0RKO0FBbERJO0VBQ0ksNkJBQUE7QUFvRFI7QUFqREk7RUFDSSxnQkFBQTtBQW1EUjtBQWhESTtFQUNJLGFBQUE7RUFDQSxtQkFBQTtFQUNBLFFBQUE7QUFrRFI7QUE3Q1E7RUFDSSxvREFBQTtBQStDWjtBQTVDUTtFQUNJLGVBQUE7QUE4Q1o7QUE1Q1k7RUFDSSxlQUFBO0VBQ0Esa0JBQUE7RUFDQSxpQkFBQTtFQUNBLFlBQUE7QUE4Q2hCO0FBNUNnQjtFTGtSWix1QktqUjJDO0VMa1IzQyxzQktsUjJDO0VMbVIzQyx1QktuUm1DO0VMb1JuQyxzQktwUm1DO0VMa1NyQyxhS2xTa0M7RUxtU2xDLGdCS25TMEM7QUFtRDVDO0FBNUNRO0VBQ0ksa0RBQUE7RUx5UVIsdUJLdlFtQztFTHdRbkMsc0JLeFFtQztFTHlRbkMsdUJLelEyQjtFTDBRM0Isc0JLMVEyQjtFTHdSN0IsYUt4UjBCO0VMeVIxQixnQkt6UmtDO0FBa0RwQztBQS9DUTs7RUFFSSxhQUFBO0VBQ0EsbUJBQUE7QUFpRFo7QUE5Q1E7RUFDSSxlQUFBO0FBZ0RaO0FBN0NRO0VBQ0ksZUFBQTtBQStDWjtBQTVDUTs7RUFFSSxZQUFBO0FBOENaO0FBekNJO0VBQ0ksaUJBQUE7QUEyQ1I7QUF4Q0k7RUFDSSxnQkFBQTtBQTBDUjtBQXZDSTtFQUNJLGVBQUE7QUF5Q1IiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEFwcCBHbG9iYWwgdmFyaWFibGVzIFNDU1NcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqIFBsYWNlIGhlcmUgdGhlIGRpZmZlcmVudCBmaWxlcyB5b3Ugc2hvdWxkIGltcG9ydCB0byB1c2UgZ2xvYmFsIHZhcmlhYmxlcy5cbiAqL1xuXG4kZm9udC1wYXRoOiBcIi4uL2Fzc2V0cy9mb250c1wiO1xuJGFzc2V0cy1wYXRoOiBcIi4uL2Fzc2V0c1wiO1xuXG5AaW1wb3J0IFwiLi9oZWxwZXJzL2hlbHBlcnMuc2Nzc1wiO1xuQGltcG9ydCBcIi4vZ2xvYmFscy5jdXN0b20uc2Nzc1wiO1xuQGltcG9ydCBcIi4vZ2xvYmFscy52YXJpYWJsZXMuc2Nzc1wiO1xuIiwiLyoqXG4gKiBJbXBvcnRlZCBpb25pYyBzdHJpbmcgZnVuY3Rpb25zIGZvciBTQ1NTXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiBFeHRyYWN0ZWQgZnJvbVxuICogaHR0cHM6Ly9naXRodWIuY29tL2lvbmljLXRlYW0vaW9uaWMtZnJhbWV3b3JrL2Jsb2IvbWFzdGVyL2NvcmUvc3JjL3RoZW1lcy9pb25pYy5mdW5jdGlvbnMuc3RyaW5nLnNjc3NcbiAqL1xuXG5cbi8vIFN0cmluZyBVdGlsaXR5IEZ1bmN0aW9uc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuLy8gU3RyaW5nIFJlcGxhY2UgRnVuY3Rpb25cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbkBmdW5jdGlvbiBzdHItcmVwbGFjZSgkc3RyaW5nLCAkc2VhcmNoLCAkcmVwbGFjZTogXCJcIikge1xuICAkaW5kZXg6IHN0ci1pbmRleCgkc3RyaW5nLCAkc2VhcmNoKTtcblxuICBAaWYgJGluZGV4IHtcbiAgICBAcmV0dXJuIHN0ci1zbGljZSgkc3RyaW5nLCAxLCAkaW5kZXggLSAxKSArICRyZXBsYWNlICsgc3RyLXJlcGxhY2Uoc3RyLXNsaWNlKCRzdHJpbmcsICRpbmRleCArIHN0ci1sZW5ndGgoJHNlYXJjaCkpLCAkc2VhcmNoLCAkcmVwbGFjZSk7XG4gIH1cblxuICBAcmV0dXJuICRzdHJpbmc7XG59XG5cbi8vIFN0cmluZyBTcGxpdCBGdW5jdGlvblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuXG5AZnVuY3Rpb24gc3RyLXNwbGl0KCRzdHJpbmcsICRzZXBhcmF0b3IpIHtcbiAgLy8gZW1wdHkgYXJyYXkvbGlzdFxuICAkc3BsaXQtYXJyOiAoKTtcbiAgLy8gZmlyc3QgaW5kZXggb2Ygc2VwYXJhdG9yIGluIHN0cmluZ1xuICAkaW5kZXg6IHN0ci1pbmRleCgkc3RyaW5nLCAkc2VwYXJhdG9yKTtcbiAgLy8gbG9vcCB0aHJvdWdoIHN0cmluZ1xuICBAd2hpbGUgJGluZGV4ICE9IG51bGwge1xuICAgIC8vIGdldCB0aGUgc3Vic3RyaW5nIGZyb20gdGhlIGZpcnN0IGNoYXJhY3RlciB0byB0aGUgc2VwYXJhdG9yXG4gICAgJGl0ZW06IHN0ci1zbGljZSgkc3RyaW5nLCAxLCAkaW5kZXggLSAxKTtcbiAgICAvLyBwdXNoIGl0ZW0gdG8gYXJyYXlcbiAgICAkc3BsaXQtYXJyOiBhcHBlbmQoJHNwbGl0LWFyciwgJGl0ZW0pO1xuICAgIC8vIHJlbW92ZSBpdGVtIGFuZCBzZXBhcmF0b3IgZnJvbSBzdHJpbmdcbiAgICAkc3RyaW5nOiBzdHItc2xpY2UoJHN0cmluZywgJGluZGV4ICsgMSk7XG4gICAgLy8gZmluZCBuZXcgaW5kZXggb2Ygc2VwYXJhdG9yXG4gICAgJGluZGV4OiBzdHItaW5kZXgoJHN0cmluZywgJHNlcGFyYXRvcik7XG4gIH1cbiAgLy8gYWRkIHRoZSByZW1haW5pbmcgc3RyaW5nIHRvIGxpc3QgKHRoZSBsYXN0IGl0ZW0pXG4gICRzcGxpdC1hcnI6IGFwcGVuZCgkc3BsaXQtYXJyLCAkc3RyaW5nKTtcblxuICBAcmV0dXJuICRzcGxpdC1hcnI7XG59XG5cblxuLy8gU3RyaW5nIEV4dHJhY3QgRnVuY3Rpb25cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbkBmdW5jdGlvbiBzdHItZXh0cmFjdCgkc3RyaW5nLCAkc3RhcnQsICRlbmQpIHtcbiAgJHN0YXJ0LWluZGV4OiBzdHItaW5kZXgoJHN0cmluZywgJHN0YXJ0KTtcblxuICBAaWYgJHN0YXJ0LWluZGV4IHtcbiAgICAkcG9zdDogc3RyLXNsaWNlKCRzdHJpbmcsICRzdGFydC1pbmRleCArIHN0ci1sZW5ndGgoJHN0YXJ0KSk7XG4gICAgJGVuZC1pbmRleDogc3RyLWluZGV4KCRwb3N0LCAkZW5kKTtcblxuICAgIEBpZiAkZW5kLWluZGV4IHtcbiAgICAgIEByZXR1cm4gc3RyLXNsaWNlKCRwb3N0LCAxLCAkZW5kLWluZGV4IC0gMSk7XG4gICAgfVxuICB9XG5cbiAgQHJldHVybiBudWxsO1xufVxuXG5cbi8vIFN0cmluZyBDb250YWlucyBGdW5jdGlvblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuQGZ1bmN0aW9uIHN0ci1jb250YWlucygkc3RyaW5nLCAkbmVlZGxlKSB7XG4gIEBpZiAodHlwZS1vZigkc3RyaW5nKSA9PSBzdHJpbmcpIHtcbiAgICBAcmV0dXJuIHN0ci1pbmRleCgkc3RyaW5nLCAkbmVlZGxlKSAhPSBudWxsO1xuICB9XG5cbiAgQHJldHVybiBmYWxzZTtcbn1cblxuXG4vLyBVUkwgRW5jb2RlIEZ1bmN0aW9uXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5AZnVuY3Rpb24gdXJsLWVuY29kZSgkdmFsKSB7XG4gICRzcGFjZXM6IHN0ci1yZXBsYWNlKCR2YWwsIFwiIFwiLCBcIiUyMFwiKTtcbiAgJGVuY29kZWQ6IHN0ci1yZXBsYWNlKCRzcGFjZXMsIFwiI1wiLCBcIiUyM1wiKTtcbiAgQHJldHVybiAkZW5jb2RlZDtcbn1cblxuXG4vLyBBZGQgUm9vdCBTZWxlY3RvclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIEFkZHMgYSByb290IHNlbGVjdG9yIHVzaW5nIGhvc3QgYmFzZWQgb24gdGhlIHNlbGVjdG9yIHBhc3NlZFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuQGZ1bmN0aW9uIGFkZC1yb290LXNlbGVjdG9yKCRyb290LCAkYWRkSG9zdFNlbGVjdG9yKSB7XG4gICRzZWxlY3RvcnM6IHN0ci1zcGxpdCgkcm9vdCwgXCIsXCIpO1xuXG4gICRsaXN0OiAoKTtcblxuICBAZWFjaCAkc2VsZWN0b3IgaW4gJHNlbGVjdG9ycyB7XG4gICAgLy8gSWYgdGhlIHNlbGVjdG9yIGNvbnRhaW5zIDpob3N0KCBpdCBtZWFucyBpdCBpcyB0YXJnZXRpbmcgYSBjbGFzcyBvbiB0aGUgaG9zdFxuICAgIC8vIGVsZW1lbnQgc28gd2UgbmVlZCB0byBjaGFuZ2UgaG93IHdlIHRhcmdldCBpdDpcbiAgICAvLyBAaW5jbHVkZSBhZGQtcm9vdC1zZWxlY3RvcihcIjpob3N0KC5maXhlZClcIiwgXCJbZGlyPXJ0bF1cIilcbiAgICAvLyAtLT4gOmhvc3QtY29udGV4dChbZGlyPXJ0bF0pOmhvc3QoLmZpeGVkKVxuICAgIC8vIC0tPiA6aG9zdC1jb250ZXh0KFtkaXI9cnRsXSkuZml4ZWRcbiAgICBAaWYgc3RyLWNvbnRhaW5zKCRzZWxlY3RvciwgXCI6aG9zdChcIikge1xuICAgICAgLy8gQGluY2x1ZGUgYWRkLXJvb3Qtc2VsZWN0b3IoXCI6aG9zdCguZml4ZWQpXCIsIFwiW2Rpcj1ydGxdXCIpXG4gICAgICAvLyAtLT4gOmhvc3QtY29udGV4dChbZGlyPXJ0bF0pOmhvc3QoLmZpeGVkKVxuICAgICAgJHNoYWRvdy1lbGVtZW50OiBzdHItcmVwbGFjZSgkc2VsZWN0b3IsIFwiOmhvc3QoXCIsIFwiOmhvc3QtY29udGV4dCgjeyRhZGRIb3N0U2VsZWN0b3J9KTpob3N0KFwiKTtcbiAgICAgICRsaXN0OiBhcHBlbmQoJGxpc3QsICRzaGFkb3ctZWxlbWVudCwgY29tbWEpO1xuXG4gICAgICAkbmV3LWVsZW1lbnQ6ICgpO1xuICAgICAgJGVsZW1lbnRzOiBzdHItc3BsaXQoJHNlbGVjdG9yLCBcIiBcIik7XG5cbiAgICAgIEBlYWNoICRlbGVtZW50IGluICRlbGVtZW50cyB7XG4gICAgICAgIEBpZiBzdHItY29udGFpbnMoJGVsZW1lbnQsIFwiOmhvc3QoXCIpIHtcbiAgICAgICAgICAkc2NvcGVkLWVsZW1lbnQ6ICRlbGVtZW50O1xuXG4gICAgICAgICAgLy8gUmVwbGFjZSB0aGUgOmhvc3QoIGFuZCApIHNvIGFsbCB3ZSBoYXZlIGxlZnQgaXMgdGhlIGNsYXNzXG4gICAgICAgICAgLy8gaW5zaWRlIG9mIGl0OlxuICAgICAgICAgIC8vIDpob3N0KC5maXhlZCkgLT4gLmZpeGVkXG4gICAgICAgICAgJHNjb3BlZC1lbGVtZW50OiBzdHItcmVwbGFjZSgkc2NvcGVkLWVsZW1lbnQsIFwiKVwiLCBcIlwiKTtcbiAgICAgICAgICAkc2NvcGVkLWVsZW1lbnQ6IHN0ci1yZXBsYWNlKCRzY29wZWQtZWxlbWVudCwgXCI6aG9zdChcIiwgXCJcIik7XG5cbiAgICAgICAgICAvLyBBZGQgdGhlIGNsYXNzIGJhY2sgaW5zaWRlIG9mIGhvc3Qgd2l0aCB0aGUgcnRsIHNlbGVjdG9yOlxuICAgICAgICAgIC8vIC5maXhlZCAtPiA6aG9zdC1jb250ZXh0KFtkaXI9cnRsXSkuZml4ZWRcbiAgICAgICAgICAkc2NvcGVkLWVsZW1lbnQ6IHN0ci1yZXBsYWNlKCRzY29wZWQtZWxlbWVudCwgJHNjb3BlZC1lbGVtZW50LCBcIjpob3N0LWNvbnRleHQoI3skYWRkSG9zdFNlbGVjdG9yfSkjeyRzY29wZWQtZWxlbWVudH1cIik7XG5cbiAgICAgICAgICAvLyBAaW5jbHVkZSBhZGQtcm9vdC1zZWxlY3RvcihcIjpob3N0KC5maXhlZClcIiwgXCJbZGlyPXJ0bF1cIilcbiAgICAgICAgICAvLyAtLT4gOmhvc3QtY29udGV4dChbZGlyPXJ0bF0pLmZpeGVkXG4gICAgICAgICAgJG5ldy1lbGVtZW50OiBhcHBlbmQoJG5ldy1lbGVtZW50LCAkc2NvcGVkLWVsZW1lbnQsIHNwYWNlKTtcbiAgICAgICAgfSBAZWxzZSB7XG4gICAgICAgICAgLy8gQWRkIGJhY2sgYW55IHNlbGVjdG9ycyB0aGF0IGZvbGxvd2VkIHRoZSBob3N0IGFmdGVyIHRyYW5zZm9ybWluZyB0aGVcbiAgICAgICAgICAvLyBmaXJzdCBzZWxlY3RvcjpcbiAgICAgICAgICAvLyA6aG9zdCguZml4ZWQpIDo6c2xvdHRlZChpb24taWNvbilcbiAgICAgICAgICAvLyAtLT4gOmhvc3QtY29udGV4dChbZGlyPXJ0bF0pOmhvc3QoLmZpeGVkKSA6OnNsb3R0ZWQoaW9uLWljb24pXG4gICAgICAgICAgLy8gLS0+IDpob3N0LWNvbnRleHQoW2Rpcj1ydGxdKS5maXhlZCA6OnNsb3R0ZWQoaW9uLWljb24pXG4gICAgICAgICAgJG5ldy1lbGVtZW50OiBhcHBlbmQoJG5ldy1lbGVtZW50LCAkZWxlbWVudCwgc3BhY2UpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgICRsaXN0OiBhcHBlbmQoJGxpc3QsICRuZXctZWxlbWVudCwgY29tbWEpO1xuICAgIC8vIElmIHRoZSBzZWxlY3RvciBjb250YWlucyA6aG9zdCB3aXRob3V0IGEgcGFyYW50aGVzZXNcbiAgICAvLyBpdCBtZWFucyBpdCBpcyB0YXJnZXRpbmcganVzdCB0aGUgaG9zdFxuICAgIC8vIGVsZW1lbnQgc28gd2UgY2FuIGNoYW5nZSBpdCB0byBsb29rIGZvciBob3N0LWNvbnRleHRcbiAgICAvLyBAaW5jbHVkZSBhZGQtcm9vdC1zZWxlY3RvcihcIjpob3N0XCIsIFwiW2Rpcj1ydGxdXCIpXG4gICAgLy8gLS0+IDpob3N0LWNvbnRleHQoW2Rpcj1ydGxdKVxuICAgIC8vIC0tPiA6aG9zdDpkaXIocnRsKVxuICAgIH0gQGVsc2UgaWYgc3RyLWNvbnRhaW5zKCRzZWxlY3RvciwgXCI6aG9zdFwiKSB7XG4gICAgICAkbmV3LWVsZW1lbnQ6ICgpO1xuICAgICAgJGVsZW1lbnRzOiBzdHItc3BsaXQoJHNlbGVjdG9yLCBcIiBcIik7XG5cbiAgICAgIEBlYWNoICRlbGVtZW50IGluICRlbGVtZW50cyB7XG4gICAgICAgIEBpZiBzdHItY29udGFpbnMoJGVsZW1lbnQsIFwiOmhvc3RcIikge1xuICAgICAgICAgIC8vIFJlcGxhY2UgdGhlIDpob3N0IHdpdGggdGhlIGFkZEhvc3RTZWxlY3RvcjpcbiAgICAgICAgICAvLyA6aG9zdCAtPiA6aG9zdC1jb250ZXh0KFtkaXI9cnRsXSlcbiAgICAgICAgICAkdXBkYXRlZC1lbGVtZW50OiBzdHItcmVwbGFjZSgkZWxlbWVudCwgXCI6aG9zdFwiLCBcIjpob3N0LWNvbnRleHQoI3skYWRkSG9zdFNlbGVjdG9yfSlcIik7XG5cbiAgICAgICAgICAvLyBBZGQgdGhlIGZpbmFsIHNlbGVjdG9yIGFmdGVyIGFsbCB0cmFuc2Zvcm1hdGlvbnM6XG4gICAgICAgICAgLy8gOmhvc3QgLT4gOmhvc3QtY29udGV4dChbZGlyPXJ0bF0pXG4gICAgICAgICAgJG5ldy1lbGVtZW50OiBhcHBlbmQoJG5ldy1lbGVtZW50LCAkdXBkYXRlZC1lbGVtZW50LCBzcGFjZSk7XG4gICAgICAgIH0gQGVsc2Uge1xuICAgICAgICAgIC8vIEFkZCBiYWNrIGFueSBzZWxlY3RvcnMgdGhhdCBmb2xsb3dlZCB0aGUgaG9zdCBhZnRlciB0cmFuc2Zvcm1pbmcgdGhlXG4gICAgICAgICAgLy8gZmlyc3Qgc2VsZWN0b3I6XG4gICAgICAgICAgLy8gOmhvc3QgOjpzbG90dGVkKGlvbi1pY29uKSAtPiA6aG9zdC1jb250ZXh0KFtkaXI9cnRsXSkgOjpzbG90dGVkKGlvbi1pY29uKVxuICAgICAgICAgICRuZXctZWxlbWVudDogYXBwZW5kKCRuZXctZWxlbWVudCwgJGVsZW1lbnQsIHNwYWNlKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAkbGlzdDogYXBwZW5kKCRsaXN0LCAkbmV3LWVsZW1lbnQsIGNvbW1hKTtcbiAgICAvLyBJZiB0aGUgc2VsZWN0b3IgZG9lcyBub3QgY29udGFpbiBob3N0IGF0IGFsbCBpdCBpcyBlaXRoZXIgYSBzaGFkb3dcbiAgICAvLyBvciBub3JtYWwgZWxlbWVudCBzbyBhcHBlbmQgYm90aCB0aGUgYWRkSG9zdFNlbGVjdG9yIGFuZCBob3N0LWNvbnRleHRcbiAgICAvLyBAaW5jbHVkZSBhZGQtcm9vdC1zZWxlY3RvcihcImlvbi1jb21wb25lbnRcIiwgXCJbZGlyPXJ0bF1cIilcbiAgICAvLyAtLT4gOmhvc3QtY29udGV4dChbZGlyPXJ0bF0pIGlvbi1jb21wb25lbnRcbiAgICAvLyAtLT4gW2Rpcj1ydGxdIGlvbi1jb21wb25lbnRcbiAgICB9IEBlbHNlIHtcbiAgICAgICRsaXN0OiBhcHBlbmQoJGxpc3QsIFwiI3skYWRkSG9zdFNlbGVjdG9yfSAjeyRzZWxlY3Rvcn1cIiwgY29tbWEpO1xuICAgICAgJGxpc3Q6IGFwcGVuZCgkbGlzdCwgXCI6aG9zdC1jb250ZXh0KCN7JGFkZEhvc3RTZWxlY3Rvcn0pICN7JHNlbGVjdG9yfVwiLCBjb21tYSk7XG4gICAgfVxuICB9XG5cbiAgQHJldHVybiAkbGlzdDtcbn1cbiIsIi8qKlxuICogSW1wb3J0ZWQgaW9uaWMgY29sb3IgZnVuY3Rpb25zIGZvciBTQ1NTXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiBFeHRyYWN0ZWQgZnJvbVxuICogaHR0cHM6Ly9naXRodWIuY29tL2lvbmljLXRlYW0vaW9uaWMtZnJhbWV3b3JrL2Jsb2IvbWFzdGVyL2NvcmUvc3JjL3RoZW1lcy9pb25pYy5mdW5jdGlvbnMuY29sb3Iuc2Nzc1xuICovXG5cbi8vIEdldHMgdGhlIGFjdGl2ZSBjb2xvcidzIGNzcyB2YXJpYWJsZSBmcm9tIGEgdmFyaWF0aW9uLiBBbHBoYSBpcyBvcHRpb25hbC5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBFeGFtcGxlIHVzYWdlOlxuLy8gY3VycmVudC1jb2xvcihiYXNlKSA9PiB2YXIoLS1pb24tY29sb3ItYmFzZSlcbi8vIGN1cnJlbnQtY29sb3IoY29udHJhc3QsIDAuMSkgPT4gcmdiYSh2YXIoLS1pb24tY29sb3ItY29udHJhc3QtcmdiKSwgMC4xKVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbkBmdW5jdGlvbiBjdXJyZW50LWNvbG9yKCR2YXJpYXRpb24sICRhbHBoYTogbnVsbCkge1xuICBAaWYgJGFscGhhID09IG51bGwge1xuICAgIEByZXR1cm4gdmFyKC0taW9uLWNvbG9yLSN7JHZhcmlhdGlvbn0pO1xuICB9IEBlbHNlIHtcbiAgICBAcmV0dXJuIHJnYmEodmFyKC0taW9uLWNvbG9yLSN7JHZhcmlhdGlvbn0tcmdiKSwgI3skYWxwaGF9KTtcbiAgfVxufVxuXG4vLyBHZXRzIHRoZSBzcGVjaWZpYyBjb2xvcidzIGNzcyB2YXJpYWJsZSBmcm9tIHRoZSBuYW1lIGFuZCB2YXJpYXRpb24uIEFscGhhL3JnYiBhcmUgb3B0aW9uYWwuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gRXhhbXBsZSB1c2FnZTpcbi8vIGlvbi1jb2xvcihwcmltYXJ5LCBiYXNlKSA9PiB2YXIoLS1pb24tY29sb3ItcHJpbWFyeSwgIzM4ODBmZilcbi8vIGlvbi1jb2xvcihzZWNvbmRhcnksIGNvbnRyYXN0KSA9PiB2YXIoLS1pb24tY29sb3Itc2Vjb25kYXJ5LWNvbnRyYXN0KVxuLy8gaW9uLWNvbG9yKHByaW1hcnksIGJhc2UsIDAuNSkgPT4gcmdiYSh2YXIoLS1pb24tY29sb3ItcHJpbWFyeS1yZ2IsIDU2LCAxMjgsIDI1NSksIDAuNSlcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5AZnVuY3Rpb24gaW9uLWNvbG9yKCRuYW1lLCAkdmFyaWF0aW9uLCAkYWxwaGE6IG51bGwsICRyZ2I6IG51bGwpIHtcbiAgJHZhbHVlczogbWFwLWdldCgkY29sb3JzLCAkbmFtZSk7XG4gICR2YWx1ZTogbWFwLWdldCgkdmFsdWVzLCAkdmFyaWF0aW9uKTtcbiAgJHZhcmlhYmxlOiAtLWlvbi1jb2xvci0jeyRuYW1lfS0jeyR2YXJpYXRpb259O1xuXG4gIEBpZiAoJHZhcmlhdGlvbiA9PSBiYXNlKSB7XG4gICAgJHZhcmlhYmxlOiAtLWlvbi1jb2xvci0jeyRuYW1lfTtcbiAgfVxuXG4gIEBpZiAoJGFscGhhKSB7XG4gICAgJHZhbHVlOiBjb2xvci10by1yZ2ItbGlzdCgkdmFsdWUpO1xuICAgIEByZXR1cm4gcmdiYSh2YXIoI3skdmFyaWFibGV9LXJnYiwgJHZhbHVlKSwgJGFscGhhKTtcbiAgfVxuICBAaWYgKCRyZ2IpIHtcbiAgICAkdmFsdWU6IGNvbG9yLXRvLXJnYi1saXN0KCR2YWx1ZSk7XG4gICAgJHZhcmlhYmxlOiAjeyR2YXJpYWJsZX0tcmdiO1xuICB9XG5cbiAgQHJldHVybiB2YXIoI3skdmFyaWFibGV9LCAkdmFsdWUpO1xufVxuXG4vLyBNaXhlcyBhIGNvbG9yIHdpdGggYmxhY2sgdG8gY3JlYXRlIGl0cyBzaGFkZS5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5AZnVuY3Rpb24gZ2V0LWNvbG9yLXNoYWRlKCRjb2xvcikge1xuICBAcmV0dXJuIG1peCgjMDAwLCAkY29sb3IsIDEyJSk7XG59XG5cbi8vIE1peGVzIGEgY29sb3Igd2l0aCB3aGl0ZSB0byBjcmVhdGUgaXRzIHRpbnQuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQGZ1bmN0aW9uIGdldC1jb2xvci10aW50KCRjb2xvcikge1xuICBAcmV0dXJuIG1peCgjZmZmLCAkY29sb3IsIDEwJSk7XG59XG5cbi8vIENvbnZlcnRzIGEgY29sb3IgdG8gYSBjb21tYSBzZXBhcmF0ZWQgcmdiLlxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbkBmdW5jdGlvbiBjb2xvci10by1yZ2ItbGlzdCgkY29sb3IpIHtcbiAgQHJldHVybiAje3JlZCgkY29sb3IpfSwje2dyZWVuKCRjb2xvcil9LCN7Ymx1ZSgkY29sb3IpfTtcbn1cbiIsIi8qKlxuICogSW1wb3J0ZWQgaW9uaWMgbWl4aW5zIGZvciBTQ1NTXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiBFeHRyYWN0ZWQgZnJvbVxuICogaHR0cHM6Ly9naXRodWIuY29tL2lvbmljLXRlYW0vaW9uaWMtZnJhbWV3b3JrL2Jsb2IvbWFzdGVyL2NvcmUvc3JjL3RoZW1lcy9pb25pYy5taXhpbnMuc2Nzc1xuICovXG5cbkBtaXhpbiBpbnB1dC1jb3ZlcigpIHtcbiAgQGluY2x1ZGUgcG9zaXRpb24oMCwgbnVsbCwgbnVsbCwgMCk7XG4gIEBpbmNsdWRlIG1hcmdpbigwKTtcblxuICBwb3NpdGlvbjogYWJzb2x1dGU7XG5cbiAgd2lkdGg6IDEwMCU7XG4gIGhlaWdodDogMTAwJTtcblxuICBib3JkZXI6IDA7XG4gIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50O1xuICBjdXJzb3I6IHBvaW50ZXI7XG5cbiAgYXBwZWFyYW5jZTogbm9uZTtcbiAgb3V0bGluZTogbm9uZTtcblxuICAmOjotbW96LWZvY3VzLWlubmVyIHtcbiAgICBib3JkZXI6IDA7XG4gIH1cbn1cblxuQG1peGluIHZpc3VhbGx5LWhpZGRlbigpIHtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuXG4gIHRvcDogMDtcbiAgbGVmdDogMDtcbiAgcmlnaHQ6IDA7XG4gIGJvdHRvbTogMDtcblxuICB3aWR0aDogMTAwJTtcbiAgaGVpZ2h0OiAxMDAlO1xuXG4gIG1hcmdpbjogMDtcbiAgcGFkZGluZzogMDtcblxuICBib3JkZXI6IDA7XG4gIG91dGxpbmU6IDA7XG4gIGNsaXA6IHJlY3QoMCAwIDAgMCk7XG5cbiAgb3BhY2l0eTogMDtcbiAgb3ZlcmZsb3c6IGhpZGRlbjtcblxuICAtd2Via2l0LWFwcGVhcmFuY2U6IG5vbmU7XG4gIC1tb3otYXBwZWFyYW5jZTogbm9uZTtcbn1cblxuQG1peGluIHRleHQtaW5oZXJpdCgpIHtcbiAgZm9udC1mYW1pbHk6IGluaGVyaXQ7XG4gIGZvbnQtc2l6ZTogaW5oZXJpdDtcbiAgZm9udC1zdHlsZTogaW5oZXJpdDtcbiAgZm9udC13ZWlnaHQ6IGluaGVyaXQ7XG4gIGxldHRlci1zcGFjaW5nOiBpbmhlcml0O1xuICB0ZXh0LWRlY29yYXRpb246IGluaGVyaXQ7XG4gIHRleHQtaW5kZW50OiBpbmhlcml0O1xuICB0ZXh0LW92ZXJmbG93OiBpbmhlcml0O1xuICB0ZXh0LXRyYW5zZm9ybTogaW5oZXJpdDtcbiAgdGV4dC1hbGlnbjogaW5oZXJpdDtcbiAgd2hpdGUtc3BhY2U6IGluaGVyaXQ7XG4gIGNvbG9yOiBpbmhlcml0O1xufVxuXG5AbWl4aW4gYnV0dG9uLXN0YXRlKCkge1xuICBAaW5jbHVkZSBwb3NpdGlvbigwLCAwLCAwLCAwKTtcblxuICBwb3NpdGlvbjogYWJzb2x1dGU7XG5cbiAgY29udGVudDogXCJcIjtcblxuICBvcGFjaXR5OiAwO1xufVxuXG4vLyBGb250IHNtb290aGluZ1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuQG1peGluIGZvbnQtc21vb3RoaW5nKCkge1xuICAtbW96LW9zeC1mb250LXNtb290aGluZzogZ3JheXNjYWxlO1xuICAtd2Via2l0LWZvbnQtc21vb3RoaW5nOiBhbnRpYWxpYXNlZDtcbn1cblxuLy8gR2V0IHRoZSBrZXkgZnJvbSBhIG1hcCBiYXNlZCBvbiB0aGUgaW5kZXhcbkBmdW5jdGlvbiBpbmRleC10by1rZXkoJG1hcCwgJGluZGV4KSB7XG4gICRrZXlzOiBtYXAta2V5cygkbWFwKTtcblxuICBAcmV0dXJuIG50aCgka2V5cywgJGluZGV4KTtcbn1cblxuXG4vLyBCcmVha3BvaW50IE1peGluc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbi8vIEJyZWFrcG9pbnQgdmlld3BvcnQgc2l6ZXMgYW5kIG1lZGlhIHF1ZXJpZXMuXG4vL1xuLy8gQnJlYWtwb2ludHMgYXJlIGRlZmluZWQgYXMgYSBtYXAgb2YgKG5hbWU6IG1pbmltdW0gd2lkdGgpLCBvcmRlciBmcm9tIHNtYWxsIHRvIGxhcmdlOlxuLy9cbi8vICAgICh4czogMCwgc206IDU3NnB4LCBtZDogNzY4cHgsIGxnOiA5OTJweCwgeGw6IDEyMDBweClcbi8vXG4vLyBUaGUgbWFwIGRlZmluZWQgaW4gdGhlIGAkc2NyZWVuLWJyZWFrcG9pbnRzYCBnbG9iYWwgdmFyaWFibGUgaXMgdXNlZCBhcyB0aGUgYCRicmVha3BvaW50c2AgYXJndW1lbnQgYnkgZGVmYXVsdC5cblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbi8vIE1pbmltdW0gYnJlYWtwb2ludCB3aWR0aC4gTnVsbCBmb3IgdGhlIHNtYWxsZXN0IChmaXJzdCkgYnJlYWtwb2ludC5cbi8vXG4vLyAgICA+PiBicmVha3BvaW50LW1pbihzbSwgKHhzOiAwLCBzbTogNTc2cHgsIG1kOiA3NjhweCwgbGc6IDk5MnB4LCB4bDogMTIwMHB4KSlcbi8vICAgIDU3NnB4XG5AZnVuY3Rpb24gYnJlYWtwb2ludC1taW4oJG5hbWUsICRicmVha3BvaW50czogJHNjcmVlbi1icmVha3BvaW50cykge1xuICAkbWluOiBtYXAtZ2V0KCRicmVha3BvaW50cywgJG5hbWUpO1xuXG4gIEByZXR1cm4gaWYoJG5hbWUgIT0gaW5kZXgtdG8ta2V5KCRicmVha3BvaW50cywgMSksICRtaW4sIG51bGwpO1xufVxuXG4vLyBSZXR1cm5zIGEgYmxhbmsgc3RyaW5nIGlmIHNtYWxsZXN0IGJyZWFrcG9pbnQsIG90aGVyd2lzZSByZXR1cm5zIHRoZSBuYW1lIHdpdGggYSBkYXNoIGluZnJvbnQuXG4vLyBVc2VmdWwgZm9yIG1ha2luZyByZXNwb25zaXZlIHV0aWxpdGllcy5cbi8vXG4vLyAgICA+PiBicmVha3BvaW50LWluZml4KHhzLCAoeHM6IDAsIHNtOiA1NzZweCwgbWQ6IDc2OHB4LCBsZzogOTkycHgsIHhsOiAxMjAwcHgpKVxuLy8gICAgXCJcIiAgKFJldHVybnMgYSBibGFuayBzdHJpbmcpXG4vLyAgICA+PiBicmVha3BvaW50LWluZml4KHNtLCAoeHM6IDAsIHNtOiA1NzZweCwgbWQ6IDc2OHB4LCBsZzogOTkycHgsIHhsOiAxMjAwcHgpKVxuLy8gICAgXCItc21cIlxuQGZ1bmN0aW9uIGJyZWFrcG9pbnQtaW5maXgoJG5hbWUsICRicmVha3BvaW50czogJHNjcmVlbi1icmVha3BvaW50cykge1xuICBAcmV0dXJuIGlmKGJyZWFrcG9pbnQtbWluKCRuYW1lLCAkYnJlYWtwb2ludHMpID09IG51bGwsIFwiXCIsIFwiLSN7JG5hbWV9XCIpO1xufVxuXG4vLyBNZWRpYSBvZiBhdCBsZWFzdCB0aGUgbWluaW11bSBicmVha3BvaW50IHdpZHRoLiBObyBxdWVyeSBmb3IgdGhlIHNtYWxsZXN0IGJyZWFrcG9pbnQuXG4vLyBNYWtlcyB0aGUgQGNvbnRlbnQgYXBwbHkgdG8gdGhlIGdpdmVuIGJyZWFrcG9pbnQgYW5kIHdpZGVyLlxuQG1peGluIG1lZGlhLWJyZWFrcG9pbnQtdXAoJG5hbWUsICRicmVha3BvaW50czogJHNjcmVlbi1icmVha3BvaW50cykge1xuICAkbWluOiBicmVha3BvaW50LW1pbigkbmFtZSwgJGJyZWFrcG9pbnRzKTtcbiAgQGlmICRtaW4ge1xuICAgIEBtZWRpYSAobWluLXdpZHRoOiAkbWluKSB7XG4gICAgICBAY29udGVudDtcbiAgICB9XG4gIH0gQGVsc2Uge1xuICAgIEBjb250ZW50O1xuICB9XG59XG5cbi8vIE5hbWUgb2YgdGhlIG5leHQgYnJlYWtwb2ludCwgb3IgbnVsbCBmb3IgdGhlIGxhc3QgYnJlYWtwb2ludC5cbi8vXG4vLyAgICA+PiBicmVha3BvaW50LW5leHQoc20pXG4vLyAgICBtZFxuLy8gICAgPj4gYnJlYWtwb2ludC1uZXh0KHNtLCAoeHM6IDAsIHNtOiA1NzZweCwgbWQ6IDc2OHB4LCBsZzogOTkycHgsIHhsOiAxMjAwcHgpKVxuLy8gICAgbWRcbi8vICAgID4+IGJyZWFrcG9pbnQtbmV4dChzbSwgJGJyZWFrcG9pbnQtbmFtZXM6ICh4cyBzbSBtZCBsZyB4bCkpXG4vLyAgICBtZFxuQGZ1bmN0aW9uIGJyZWFrcG9pbnQtbmV4dCgkbmFtZSwgJGJyZWFrcG9pbnRzOiAkc2NyZWVuLWJyZWFrcG9pbnRzLCAkYnJlYWtwb2ludC1uYW1lczogbWFwLWtleXMoJGJyZWFrcG9pbnRzKSkge1xuICAkbjogaW5kZXgoJGJyZWFrcG9pbnQtbmFtZXMsICRuYW1lKTtcbiAgQHJldHVybiBpZigkbiA8IGxlbmd0aCgkYnJlYWtwb2ludC1uYW1lcyksIG50aCgkYnJlYWtwb2ludC1uYW1lcywgJG4gKyAxKSwgbnVsbCk7XG59XG5cbi8vIE1heGltdW0gYnJlYWtwb2ludCB3aWR0aC4gTnVsbCBmb3IgdGhlIHNtYWxsZXN0IChmaXJzdCkgYnJlYWtwb2ludC5cbi8vIFRoZSBtYXhpbXVtIHZhbHVlIGlzIHJlZHVjZWQgYnkgMC4wMnB4IHRvIHdvcmsgYXJvdW5kIHRoZSBsaW1pdGF0aW9ucyBvZlxuLy8gYG1pbi1gIGFuZCBgbWF4LWAgcHJlZml4ZXMgYW5kIHZpZXdwb3J0cyB3aXRoIGZyYWN0aW9uYWwgd2lkdGhzLlxuLy9cbi8vIFNlZSBodHRwczovL3d3dy53My5vcmcvVFIvbWVkaWFxdWVyaWVzLTQvI21xLW1pbi1tYXhcbi8vIFVzZXMgMC4wMnB4IHJhdGhlciB0aGFuIDAuMDFweCB0byB3b3JrIGFyb3VuZCBhIGN1cnJlbnQgcm91bmRpbmcgYnVnIGluIFNhZmFyaS5cdC8vIFVzZXMgMC4wMnB4IHJhdGhlciB0aGFuIDAuMDFweCB0byB3b3JrIGFyb3VuZCBhIGN1cnJlbnQgcm91bmRpbmcgYnVnIGluIFNhZmFyaS5cbi8vIFNlZSBodHRwczovL2J1Z3Mud2Via2l0Lm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MTc4MjYxXHQvLyBTZWUgaHR0cHM6Ly9idWdzLndlYmtpdC5vcmcvc2hvd19idWcuY2dpP2lkPTE3ODI2MVxuLy9cbi8vICAgID4+IGJyZWFrcG9pbnQtbWF4KG1kLCAoeHM6IDAsIHNtOiA1NzZweCwgbWQ6IDc2OHB4LCBsZzogOTkycHgsIHhsOiAxMjAwcHgpKVxuLy8gICAgNzY3Ljk4cHhcbkBmdW5jdGlvbiBicmVha3BvaW50LW1heCgkbmFtZSwgJGJyZWFrcG9pbnRzOiAkc2NyZWVuLWJyZWFrcG9pbnRzKSB7XG4gICRtYXg6IG1hcC1nZXQoJGJyZWFrcG9pbnRzLCAkbmFtZSk7XG4gIEByZXR1cm4gaWYoJG1heCBhbmQgJG1heCA+IDAsICRtYXggLSAuMDIsIG51bGwpO1xufVxuXG4vLyBNZWRpYSBvZiBhdCBtb3N0IHRoZSBtYXhpbXVtIGJyZWFrcG9pbnQgd2lkdGguIE5vIHF1ZXJ5IGZvciB0aGUgbGFyZ2VzdCBicmVha3BvaW50LlxuLy8gTWFrZXMgdGhlIEBjb250ZW50IGFwcGx5IHRvIHRoZSBnaXZlbiBicmVha3BvaW50IGFuZCBuYXJyb3dlci5cbkBtaXhpbiBtZWRpYS1icmVha3BvaW50LWRvd24oJG5hbWUsICRicmVha3BvaW50czogJHNjcmVlbi1icmVha3BvaW50cykge1xuICAkbWF4OiBicmVha3BvaW50LW1heCgkbmFtZSwgJGJyZWFrcG9pbnRzKTtcbiAgQGlmICRtYXgge1xuICAgIEBtZWRpYSAobWF4LXdpZHRoOiAkbWF4KSB7XG4gICAgICBAY29udGVudDtcbiAgICB9XG4gIH0gQGVsc2Uge1xuICAgIEBjb250ZW50O1xuICB9XG59XG5cblxuLy8gVGV4dCBEaXJlY3Rpb24gLSBsdHIgLyBydGxcbi8vXG4vLyBDU1MgZGVmYXVsdHMgdG8gdXNlIHRoZSBsdHIgY3NzLCBhbmQgYWRkcyBbZGlyPXJ0bF0gc2VsZWN0b3JzXG4vLyB0byBvdmVycmlkZSBsdHIgZGVmYXVsdHMuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbkBtaXhpbiBtdWx0aS1kaXIoKSB7XG4gIEBjb250ZW50O1xuXG4gIC8vICRyb290OiAjeyZ9O1xuICAvLyBAYXQtcm9vdCBbZGlyXSB7XG4gIC8vICAgI3skcm9vdH0ge1xuICAvLyAgICAgQGNvbnRlbnQ7XG4gIC8vICAgfVxuICAvLyB9XG59XG5cbkBtaXhpbiBydGwoKSB7XG4gICRyb290OiAjeyZ9O1xuXG4gICRyb290U3BsaXQ6IHN0ci1zcGxpdCgkcm9vdCwgXCIsXCIpO1xuICAkc2VsZWN0b3JzOiAje2FkZC1yb290LXNlbGVjdG9yKCRyb290LCBcIltkaXI9cnRsXVwiKX07XG4gICRzZWxlY3RvcnNTcGxpdDogc3RyLXNwbGl0KCRzZWxlY3RvcnMsIFwiLFwiKTtcblxuICAkaG9zdENvbnRleHRTZWxlY3RvcnM6ICgpO1xuICAkcmVzdFNlbGVjdG9yczogKCk7XG4gICRkaXJTZWxlY3RvcnM6ICgpO1xuXG4gIC8vIFNlbGVjdG9ycyBtdXN0IGJlIHNwbGl0IGludG8gaW5kaXZpZHVhbCBzZWxlY3RvcnMgaW4gY2FzZSB0aGUgYnJvd3NlclxuICAvLyBkb2Vzbid0IHN1cHBvcnQgYSBzcGVjaWZpYyBzZWxlY3Rvci5cbiAgLy8gRm9yIGV4YW1wbGUsIEZpcmVmb3ggYW5kIFNhZmFyaSBkb2Vzbid0IHN1cHBvcnQgYDpob3N0LWNvbnRleHQoKWAuXG4gIC8vIElmIGFuIGludmFsaWQgc2VsZWN0b3IgaXMgdXNlZCwgdGhlbiB0aGUgZW50aXJlIGdyb3VwIG9mIHNlbGVjdG9yc1xuICAvLyB3aWxsIGJlIGlnbm9yZWQuXG4gIC8vIEBsaW5rIGh0dHBzOi8vd3d3LnczLm9yZy9UUi9zZWxlY3RvcnMtMy8jZ3JvdXBpbmdcbiAgQGVhY2ggJHNlbGVjdG9yIGluICRzZWxlY3RvcnNTcGxpdCB7XG4gICAgLy8gR3JvdXAgdGhlIHNlbGVjdG9ycyBiYWNrIGludG8gYSBzaW5nbGUgc2VsZWN0b3IgdG8gb3B0aW1pemUgdGhlIG91dHB1dC5cbiAgICBAaWYgc3RyLWluZGV4KCRzZWxlY3RvciwgXCI6aG9zdC1jb250ZXh0XCIpIHtcbiAgICAgICRob3N0Q29udGV4dFNlbGVjdG9yczogYXBwZW5kKCRob3N0Q29udGV4dFNlbGVjdG9ycywgJHNlbGVjdG9yLCBjb21tYSk7XG4gICAgfSBAZWxzZSB7XG4gICAgICAvLyBHcm91cCB0aGUgc2VsZWN0b3JzIGJhY2sgaW50byBhIHNpbmdsZSBzZWxlY3RvciB0byBvcHRpbWl6ZSB0aGUgb3V0cHV0LlxuICAgICAgJHJlc3RTZWxlY3RvcnM6IGFwcGVuZCgkcmVzdFNlbGVjdG9ycywgJHNlbGVjdG9yLCBjb21tYSk7XG4gICAgfVxuICB9XG5cbiAgLy8gU3VwcG9ydGVkIGJ5IENocm9tZS5cbiAgQGlmIGxlbmd0aCgkaG9zdENvbnRleHRTZWxlY3RvcnMpID4gMCB7XG4gICAgQGF0LXJvb3QgI3skaG9zdENvbnRleHRTZWxlY3RvcnN9IHtcbiAgICAgIEBjb250ZW50O1xuICAgIH1cbiAgfVxuXG4gIC8vIFN1cHBvcnRlZCBieSBhbGwgYnJvd3NlcnMuXG4gIEBpZiBsZW5ndGgoJHJlc3RTZWxlY3RvcnMpID4gMCB7XG4gICAgQGF0LXJvb3QgI3skcmVzdFNlbGVjdG9yc30ge1xuICAgICAgQGNvbnRlbnQ7XG4gICAgfVxuICB9XG5cbiAgLy8gSWYgYnJvd3NlciBjYW4gc3VwcG9ydCBgOmRpcigpYCwgdGhlbiBhZGQgdGhlIGA6ZGlyKClgIHNlbGVjdG9ycy5cbiAgLy8gQHN1cHBvcnRzIHNlbGVjdG9yKDpkaXIocnRsKSkgeyAvLyBAIElNUE9UQU5UIE5PVEU6IFRoaXMgaGFzIGJlZW4gcmVtb3ZlZCBiZWNhdXNlIHNlbGVjdG9yIGZ1bmN0aW9uIGlzIG5vdCBzdXBwb3J0ZWQgaW4gY3VycmVudCBTQ1NTXG4gIC8vIEFkZGluZyA6ZGlyKCkgaW4gY2FzZSB0aGUgYnJvd3NlciBkb2Vzbid0IHN1cHBvcnQgYDpob3N0LWNvbnRleHQoKWAgYW5kIGRvZXMgc3VwcG9ydCBgOmRpcigpYC5cbiAgLy8gYDpob3N0LWNvbnRleHQoKWAgaXMgYWRkZWQ6XG4gIC8vIC0gdGhyb3VnaCB0aGUgYGFkZC1yb290LXNlbGVjdG9yKClgIGZ1bmN0aW9uLlxuICAvLyAtIGZpcnN0IHNvIHRoYXQgaXQgdGFrZXMgcHJlY2VkZW5jZSBvdmVyIGA6ZGlyKClgLlxuICAvLyBGb3IgZXhhbXBsZSxcbiAgLy8gLSBGaXJlZm94IGRvZXNuJ3Qgc3VwcG9ydCBgOmhvc3QtY29udGV4dCgpYCwgYnV0IGRvZXMgc3VwcG9ydCBgOmRpcigpYC5cbiAgLy8gLSBTYWZhcmkgZG9lc24ndCBzdXBwb3J0IGA6aG9zdC1jb250ZXh0KClgLCBidXQgU2FmYXJpIDE2LjQrIHN1cHBvcnRzIGA6ZGlyKClgXG4gIC8vIEBsaW5rIGh0dHBzOi8vd2Via2l0Lm9yZy9ibG9nLzEzOTY2L3dlYmtpdC1mZWF0dXJlcy1pbi1zYWZhcmktMTYtNC9cbiAgQGVhY2ggJHNlbGVjdG9yIGluICRyb290U3BsaXQge1xuICAgICRkaXJTZWxlY3RvcjogXCIjeyRzZWxlY3Rvcn06ZGlyKHJ0bClcIjtcbiAgICAvLyBHcm91cCB0aGUgc2VsZWN0b3JzIGJhY2sgaW50byBhIHNpbmdsZSBzZWxlY3RvciB0byBvcHRpbWl6ZSB0aGUgb3V0cHV0LlxuICAgICRkaXJTZWxlY3RvcnM6IGFwcGVuZCgkZGlyU2VsZWN0b3JzLCAkZGlyU2VsZWN0b3IsIGNvbW1hKTtcbiAgfVxuXG4gIC8vIFN1cHBvcnRlZCBieSBGaXJlZm94LlxuICBAaWYgbGVuZ3RoKCRkaXJTZWxlY3RvcnMpID4gMCB7XG4gICAgQGF0LXJvb3QgI3skZGlyU2VsZWN0b3JzfSB7XG4gICAgICBAY29udGVudDtcbiAgICB9XG4gIH1cbiAgLy99XG59XG5cbkBtaXhpbiBsdHIoKSB7XG4gIEBjb250ZW50O1xufVxuXG5cbi8vIFNWRyBCYWNrZ3JvdW5kIEltYWdlIE1peGluXG4vLyBAcGFyYW0ge3N0cmluZ30gJHN2Z1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQG1peGluIHN2Zy1iYWNrZ3JvdW5kLWltYWdlKCRzdmcsICRmbGlwLXJ0bDogZmFsc2UpIHtcbiAgJHVybDogdXJsLWVuY29kZSgkc3ZnKTtcbiAgJHZpZXdCb3g6IHN0ci1zcGxpdChzdHItZXh0cmFjdCgkc3ZnLCBcInZpZXdCb3g9J1wiLCBcIidcIiksIFwiIFwiKTtcblxuICBAaWYgJGZsaXAtcnRsICE9IHRydWUgb3IgJHZpZXdCb3ggPT0gbnVsbCB7XG4gICAgQGluY2x1ZGUgbXVsdGktZGlyKCkge1xuICAgICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKFwiZGF0YTppbWFnZS9zdmcreG1sO2NoYXJzZXQ9dXRmLTgsI3skdXJsfVwiKTtcbiAgICB9XG4gIH0gQGVsc2Uge1xuICAgICR0cmFuc2Zvcm06IFwidHJhbnNmb3JtPSd0cmFuc2xhdGUoI3tudGgoJHZpZXdCb3gsIDMpfSwgMCkgc2NhbGUoLTEsIDEpJ1wiO1xuICAgICRmbGlwcGVkLXVybDogJHN2ZztcbiAgICAkZmxpcHBlZC11cmw6IHN0ci1yZXBsYWNlKCRmbGlwcGVkLXVybCwgXCI8cGF0aFwiLCBcIjxwYXRoICN7JHRyYW5zZm9ybX1cIik7XG4gICAgJGZsaXBwZWQtdXJsOiBzdHItcmVwbGFjZSgkZmxpcHBlZC11cmwsIFwiPGxpbmVcIiwgXCI8bGluZSAjeyR0cmFuc2Zvcm19XCIpO1xuICAgICRmbGlwcGVkLXVybDogc3RyLXJlcGxhY2UoJGZsaXBwZWQtdXJsLCBcIjxwb2x5Z29uXCIsIFwiPHBvbHlnb24gI3skdHJhbnNmb3JtfVwiKTtcbiAgICAkZmxpcHBlZC11cmw6IHVybC1lbmNvZGUoJGZsaXBwZWQtdXJsKTtcblxuICAgIEBpbmNsdWRlIGx0ciAoKSB7XG4gICAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoXCJkYXRhOmltYWdlL3N2Zyt4bWw7Y2hhcnNldD11dGYtOCwjeyR1cmx9XCIpO1xuICAgIH1cbiAgICBAaW5jbHVkZSBydGwoKSB7XG4gICAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoXCJkYXRhOmltYWdlL3N2Zyt4bWw7Y2hhcnNldD11dGYtOCwjeyRmbGlwcGVkLXVybH1cIik7XG4gICAgfVxuICB9XG59XG5cbi8vIEFkZCBwcm9wZXJ0eSBob3Jpem9udGFsXG4vLyBAcGFyYW0ge3N0cmluZ30gJHN0YXJ0XG4vLyBAcGFyYW0ge3N0cmluZ30gJGVuZFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQG1peGluIHByb3BlcnR5LWhvcml6b250YWwoJHByb3AsICRzdGFydCwgJGVuZDogJHN0YXJ0KSB7XG4gIEBpZiAkc3RhcnQgPT0gMCBhbmQgJGVuZCA9PSAwIHtcbiAgICAjeyRwcm9wfS1sZWZ0OiAkc3RhcnQ7XG4gICAgI3skcHJvcH0tcmlnaHQ6ICRlbmQ7XG5cbiAgfSBAZWxzZSB7XG4gICAgLXdlYmtpdC0jeyRwcm9wfS1zdGFydDogJHN0YXJ0O1xuICAgICN7JHByb3B9LWlubGluZS1zdGFydDogJHN0YXJ0O1xuICAgIC13ZWJraXQtI3skcHJvcH0tZW5kOiAkZW5kO1xuICAgICN7JHByb3B9LWlubGluZS1lbmQ6ICRlbmQ7XG4gIH1cbn1cblxuLy8gQWRkIHByb3BlcnR5IGZvciBhbGwgZGlyZWN0aW9uc1xuLy8gQHBhcmFtIHtzdHJpbmd9ICRwcm9wXG4vLyBAcGFyYW0ge3N0cmluZ30gJHRvcFxuLy8gQHBhcmFtIHtzdHJpbmd9ICRlbmRcbi8vIEBwYXJhbSB7c3RyaW5nfSAkYm90dG9tXG4vLyBAcGFyYW0ge3N0cmluZ30gJHN0YXJ0XG4vLyBAcGFyYW0ge2Jvb2xlYW59ICRjb250ZW50IGluY2x1ZGUgY29udGVudCBvciB1c2UgZGVmYXVsdFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQG1peGluIHByb3BlcnR5KCRwcm9wLCAkdG9wLCAkZW5kOiAkdG9wLCAkYm90dG9tOiAkdG9wLCAkc3RhcnQ6ICRlbmQpIHtcbiAgQGluY2x1ZGUgcHJvcGVydHktaG9yaXpvbnRhbCgkcHJvcCwgJHN0YXJ0LCAkZW5kKTtcbiAgI3skcHJvcH0tdG9wOiAkdG9wO1xuICAjeyRwcm9wfS1ib3R0b206ICRib3R0b207XG59XG5cbi8vIEFkZCBwYWRkaW5nIGhvcml6b250YWxcbi8vIEBwYXJhbSB7c3RyaW5nfSAkc3RhcnRcbi8vIEBwYXJhbSB7c3RyaW5nfSAkZW5kXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5AbWl4aW4gcGFkZGluZy1ob3Jpem9udGFsKCRzdGFydCwgJGVuZDogJHN0YXJ0KSB7XG4gIEBpbmNsdWRlIHByb3BlcnR5LWhvcml6b250YWwocGFkZGluZywgJHN0YXJ0LCAkZW5kKTtcbn1cblxuLy8gQWRkIHBhZGRpbmcgZm9yIGFsbCBkaXJlY3Rpb25zXG4vLyBAcGFyYW0ge3N0cmluZ30gJHRvcFxuLy8gQHBhcmFtIHtzdHJpbmd9ICRlbmRcbi8vIEBwYXJhbSB7c3RyaW5nfSAkYm90dG9tXG4vLyBAcGFyYW0ge3N0cmluZ30gJHN0YXJ0XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5AbWl4aW4gcGFkZGluZygkdG9wLCAkZW5kOiAkdG9wLCAkYm90dG9tOiAkdG9wLCAkc3RhcnQ6ICRlbmQpIHtcbiAgQGluY2x1ZGUgcHJvcGVydHkocGFkZGluZywgJHRvcCwgJGVuZCwgJGJvdHRvbSwgJHN0YXJ0KTtcbn1cblxuLy8gQWRkIG1hcmdpbiBob3Jpem9udGFsXG4vLyBAcGFyYW0ge3N0cmluZ30gJHN0YXJ0XG4vLyBAcGFyYW0ge3N0cmluZ30gJGVuZFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQG1peGluIG1hcmdpbi1ob3Jpem9udGFsKCRzdGFydCwgJGVuZDogJHN0YXJ0KSB7XG4gIEBpbmNsdWRlIHByb3BlcnR5LWhvcml6b250YWwobWFyZ2luLCAkc3RhcnQsICRlbmQpO1xufVxuXG4vLyBBZGQgbWFyZ2luIGZvciBhbGwgZGlyZWN0aW9uc1xuLy8gQHBhcmFtIHtzdHJpbmd9ICR0b3Bcbi8vIEBwYXJhbSB7c3RyaW5nfSAkZW5kXG4vLyBAcGFyYW0ge3N0cmluZ30gJGJvdHRvbVxuLy8gQHBhcmFtIHtzdHJpbmd9ICRzdGFydFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQG1peGluIG1hcmdpbigkdG9wLCAkZW5kOiAkdG9wLCAkYm90dG9tOiAkdG9wLCAkc3RhcnQ6ICRlbmQpIHtcbiAgQGluY2x1ZGUgcHJvcGVydHkobWFyZ2luLCAkdG9wLCAkZW5kLCAkYm90dG9tLCAkc3RhcnQpO1xufVxuXG4vLyBBZGQgcG9zaXRpb24gaG9yaXpvbnRhbFxuLy8gQHBhcmFtIHtzdHJpbmd9ICRzdGFydCAtIGFtb3VudCB0byBwb3NpdGlvbiBzdGFydFxuLy8gQHBhcmFtIHtzdHJpbmd9ICRlbmQgLSBhbW91bnQgdG8gbGVmdDogMDsgZW5kXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5AbWl4aW4gcG9zaXRpb24taG9yaXpvbnRhbCgkc3RhcnQ6IG51bGwsICRlbmQ6IG51bGwpIHtcbiAgQGlmICRzdGFydCA9PSAkZW5kIHtcbiAgICBAaW5jbHVkZSBtdWx0aS1kaXIoKSB7XG4gICAgICBsZWZ0OiAkc3RhcnQ7XG4gICAgICByaWdodDogJGVuZDtcbiAgICB9XG4gIH0gQGVsc2Uge1xuICAgIEBhdC1yb290IHtcbiAgICAgIEBzdXBwb3J0cyAoaW5zZXQtaW5saW5lLXN0YXJ0OiAwKSB7XG4gICAgICAgICYge1xuICAgICAgICAgIGluc2V0LWlubGluZS1zdGFydDogJHN0YXJ0O1xuICAgICAgICAgIGluc2V0LWlubGluZS1lbmQ6ICRlbmQ7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBUT0RPIEZXLTM3NjZcbiAgICBAYXQtcm9vdCB7XG4gICAgICBAc3VwcG9ydHMgbm90IChpbnNldC1pbmxpbmUtc3RhcnQ6IDApIHtcbiAgICAgICAgJiB7XG4gICAgICAgICAgQGluY2x1ZGUgbHRyKCkge1xuICAgICAgICAgICAgbGVmdDogJHN0YXJ0O1xuICAgICAgICAgICAgcmlnaHQ6ICRlbmQ7XG4gICAgICAgICAgfVxuICAgICAgICAgIEBpbmNsdWRlIHJ0bCgpIHtcbiAgICAgICAgICAgIGxlZnQ6IHVuc2V0O1xuICAgICAgICAgICAgcmlnaHQ6IHVuc2V0O1xuXG4gICAgICAgICAgICBsZWZ0OiAkZW5kO1xuICAgICAgICAgICAgcmlnaHQ6ICRzdGFydDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cblxuLy8gQWRkIHBvc2l0aW9uIGZvciBhbGwgZGlyZWN0aW9uc1xuLy8gQHBhcmFtIHtzdHJpbmd9ICR0b3Bcbi8vIEBwYXJhbSB7c3RyaW5nfSAkZW5kXG4vLyBAcGFyYW0ge3N0cmluZ30gJGJvdHRvbVxuLy8gQHBhcmFtIHtzdHJpbmd9ICRzdGFydFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQG1peGluIHBvc2l0aW9uKCR0b3A6IG51bGwsICRlbmQ6IG51bGwsICRib3R0b206IG51bGwsICRzdGFydDogbnVsbCkge1xuICBAaW5jbHVkZSBwb3NpdGlvbi1ob3Jpem9udGFsKCRzdGFydCwgJGVuZCk7XG4gIHRvcDogJHRvcDtcbiAgYm90dG9tOiAkYm90dG9tO1xufVxuXG4vLyBBZGQgYm9yZGVyIGZvciBhbGwgZGlyZWN0aW9uc1xuLy8gQHBhcmFtIHtzdHJpbmd9ICR0b3Bcbi8vIEBwYXJhbSB7c3RyaW5nfSAkZW5kXG4vLyBAcGFyYW0ge3N0cmluZ30gJGJvdHRvbVxuLy8gQHBhcmFtIHtzdHJpbmd9ICRzdGFydFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQG1peGluIGJvcmRlcigkdG9wLCAkZW5kOiAkdG9wLCAkYm90dG9tOiAkdG9wLCAkc3RhcnQ6ICRlbmQpIHtcbiAgQGluY2x1ZGUgcHJvcGVydHkoYm9yZGVyLCAkdG9wLCAkZW5kLCAkYm90dG9tLCAkc3RhcnQpO1xufVxuXG4vLyBBZGQgYm9yZGVyIHJhZGl1cyBmb3IgYWxsIGRpcmVjdGlvbnNcbi8vIEBwYXJhbSB7c3RyaW5nfSAkdG9wLXN0YXJ0XG4vLyBAcGFyYW0ge3N0cmluZ30gJHRvcC1lbmRcbi8vIEBwYXJhbSB7c3RyaW5nfSAkYm90dG9tLWVuZFxuLy8gQHBhcmFtIHtzdHJpbmd9ICRib3R0b20tc3RhcnRcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbkBtaXhpbiBib3JkZXItcmFkaXVzKCR0b3Atc3RhcnQsICR0b3AtZW5kOiAkdG9wLXN0YXJ0LCAkYm90dG9tLWVuZDogJHRvcC1zdGFydCwgJGJvdHRvbS1zdGFydDogJHRvcC1lbmQpIHtcbiAgQGlmICR0b3Atc3RhcnQgPT0gJHRvcC1lbmQgYW5kICR0b3Atc3RhcnQgPT0gJGJvdHRvbS1lbmQgYW5kICR0b3Atc3RhcnQgPT0gJGJvdHRvbS1zdGFydCB7XG4gICAgQGluY2x1ZGUgbXVsdGktZGlyKCkge1xuICAgICAgYm9yZGVyLXJhZGl1czogJHRvcC1zdGFydDtcbiAgICB9XG4gIH0gQGVsc2Uge1xuICAgIEBpbmNsdWRlIGx0cigpIHtcbiAgICAgIGJvcmRlci10b3AtbGVmdC1yYWRpdXM6ICR0b3Atc3RhcnQ7XG4gICAgICBib3JkZXItdG9wLXJpZ2h0LXJhZGl1czogJHRvcC1lbmQ7XG4gICAgICBib3JkZXItYm90dG9tLXJpZ2h0LXJhZGl1czogJGJvdHRvbS1lbmQ7XG4gICAgICBib3JkZXItYm90dG9tLWxlZnQtcmFkaXVzOiAkYm90dG9tLXN0YXJ0O1xuICAgIH1cblxuICAgIEBpbmNsdWRlIHJ0bCgpIHtcbiAgICAgIGJvcmRlci10b3AtbGVmdC1yYWRpdXM6ICR0b3AtZW5kO1xuICAgICAgYm9yZGVyLXRvcC1yaWdodC1yYWRpdXM6ICR0b3Atc3RhcnQ7XG4gICAgICBib3JkZXItYm90dG9tLXJpZ2h0LXJhZGl1czogJGJvdHRvbS1zdGFydDtcbiAgICAgIGJvcmRlci1ib3R0b20tbGVmdC1yYWRpdXM6ICRib3R0b20tZW5kO1xuICAgIH1cbiAgfVxufVxuXG4vLyBBZGQgZGlyZWN0aW9uIGZvciBhbGwgZGlyZWN0aW9uc1xuLy8gQHBhcmFtIHtzdHJpbmd9ICRkaXIgLSBEaXJlY3Rpb24gb24gTFRSXG5AbWl4aW4gZGlyZWN0aW9uKCRkaXIpIHtcbiAgJG90aGVyLWRpcjogbnVsbDtcblxuICBAaWYgJGRpciA9PSBsdHIge1xuICAgICRvdGhlci1kaXI6IHJ0bDtcbiAgfSBAZWxzZSB7XG4gICAgJG90aGVyLWRpcjogbHRyO1xuICB9XG5cbiAgQGluY2x1ZGUgbHRyKCkge1xuICAgIGRpcmVjdGlvbjogJGRpcjtcbiAgfVxuICBAaW5jbHVkZSBydGwoKSB7XG4gICAgZGlyZWN0aW9uOiAkb3RoZXItZGlyO1xuICB9XG59XG5cbi8vIEFkZCBmbG9hdCBmb3IgYWxsIGRpcmVjdGlvbnNcbi8vIEBwYXJhbSB7c3RyaW5nfSAkc2lkZVxuLy8gQHBhcmFtIHtzdHJpbmd9ICRkZWNvcmF0b3IgLSAhaW1wb3J0YW50XG5AbWl4aW4gZmxvYXQoJHNpZGUsICRkZWNvcmF0b3I6IG51bGwpIHtcbiAgQGlmICRzaWRlID09IHN0YXJ0IHtcbiAgICBAaW5jbHVkZSBsdHIoKSB7XG4gICAgICBmbG9hdDogbGVmdCAkZGVjb3JhdG9yO1xuICAgIH1cbiAgICBAaW5jbHVkZSBydGwoKSB7XG4gICAgICBmbG9hdDogcmlnaHQgJGRlY29yYXRvcjtcbiAgICB9XG4gIH0gQGVsc2UgaWYgJHNpZGUgPT0gZW5kIHtcbiAgICBAaW5jbHVkZSBsdHIoKSB7XG4gICAgICBmbG9hdDogcmlnaHQgJGRlY29yYXRvcjtcbiAgICB9XG4gICAgQGluY2x1ZGUgcnRsKCkge1xuICAgICAgZmxvYXQ6IGxlZnQgJGRlY29yYXRvcjtcbiAgICB9XG4gIH0gQGVsc2Uge1xuICAgIEBpbmNsdWRlIG11bHRpLWRpcigpIHtcbiAgICAgIGZsb2F0OiAkc2lkZSAkZGVjb3JhdG9yO1xuICAgIH1cbiAgfVxufVxuXG5AbWl4aW4gYmFja2dyb3VuZC1wb3NpdGlvbigkaG9yaXpvbnRhbCwgJGhvcml6b250YWwtYW1vdW50OiBudWxsLCAkdmVydGljYWw6IG51bGwsICR2ZXJ0aWNhbC1hbW91bnQ6IG51bGwpIHtcbiAgQGlmICRob3Jpem9udGFsID09IHN0YXJ0IG9yICRob3Jpem9udGFsID09IGVuZCB7XG4gICAgJGhvcml6b250YWwtbHRyOiBudWxsO1xuICAgICRob3Jpem9udGFsLXJ0bDogbnVsbDtcbiAgICBAaWYgJGhvcml6b250YWwgPT0gc3RhcnQge1xuICAgICAgJGhvcml6b250YWwtbHRyOiBsZWZ0O1xuICAgICAgJGhvcml6b250YWwtcnRsOiByaWdodDtcbiAgICB9IEBlbHNlIHtcbiAgICAgICRob3Jpem9udGFsLWx0cjogcmlnaHQ7XG4gICAgICAkaG9yaXpvbnRhbC1ydGw6IGxlZnQ7XG4gICAgfVxuXG4gICAgQGluY2x1ZGUgbHRyKCkge1xuICAgICAgYmFja2dyb3VuZC1wb3NpdGlvbjogJGhvcml6b250YWwtbHRyICRob3Jpem9udGFsLWFtb3VudCAkdmVydGljYWwgJHZlcnRpY2FsLWFtb3VudDtcbiAgICB9XG4gICAgQGluY2x1ZGUgcnRsKCkge1xuICAgICAgYmFja2dyb3VuZC1wb3NpdGlvbjogJGhvcml6b250YWwtcnRsICRob3Jpem9udGFsLWFtb3VudCAkdmVydGljYWwgJHZlcnRpY2FsLWFtb3VudDtcbiAgICB9XG4gIH0gQGVsc2Uge1xuICAgIEBpbmNsdWRlIG11bHRpLWRpcigpIHtcbiAgICAgIGJhY2tncm91bmQtcG9zaXRpb246ICRob3Jpem9udGFsICRob3Jpem9udGFsLWFtb3VudCAkdmVydGljYWwgJHZlcnRpY2FsLWFtb3VudDtcbiAgICB9XG4gIH1cbn1cblxuQG1peGluIHRyYW5zZm9ybS1vcmlnaW4oJHgtYXhpcywgJHktYXhpczogbnVsbCkge1xuICBAaWYgJHgtYXhpcyA9PSBzdGFydCB7XG4gICAgQGluY2x1ZGUgbHRyKCkge1xuICAgICAgdHJhbnNmb3JtLW9yaWdpbjogbGVmdCAkeS1heGlzO1xuICAgIH1cbiAgICBAaW5jbHVkZSBydGwoKSB7XG4gICAgICB0cmFuc2Zvcm0tb3JpZ2luOiByaWdodCAkeS1heGlzO1xuICAgIH1cbiAgfSBAZWxzZSBpZiAkeC1heGlzID09IGVuZCB7XG4gICAgQGluY2x1ZGUgbHRyKCkge1xuICAgICAgdHJhbnNmb3JtLW9yaWdpbjogcmlnaHQgJHktYXhpcztcbiAgICB9XG4gICAgQGluY2x1ZGUgcnRsKCkge1xuICAgICAgdHJhbnNmb3JtLW9yaWdpbjogbGVmdCAkeS1heGlzO1xuICAgIH1cbiAgfSBAZWxzZSBpZiAkeC1heGlzID09IGxlZnQgb3IgJHgtYXhpcyA9PSByaWdodCB7XG4gICAgQGluY2x1ZGUgbXVsdGktZGlyKCkge1xuICAgICAgdHJhbnNmb3JtLW9yaWdpbjogJHgtYXhpcyAkeS1heGlzO1xuICAgIH1cbiAgfSBAZWxzZSB7XG4gICAgQGluY2x1ZGUgbHRyKCkge1xuICAgICAgdHJhbnNmb3JtLW9yaWdpbjogJHgtYXhpcyAkeS1heGlzO1xuICAgIH1cbiAgICBAaW5jbHVkZSBydGwoKSB7XG4gICAgICB0cmFuc2Zvcm0tb3JpZ2luOiBjYWxjKDEwMCUgLSAjeyR4LWF4aXN9KSAkeS1heGlzO1xuICAgIH1cbiAgfVxufVxuXG4vLyBBZGQgdHJhbnNmb3JtIGZvciBhbGwgZGlyZWN0aW9uc1xuLy8gQHBhcmFtIHtzdHJpbmd9ICR0cmFuc2Zvcm1zIC0gY29tbWEgc2VwYXJhdGVkIGxpc3Qgb2YgdHJhbnNmb3Jtc1xuQG1peGluIHRyYW5zZm9ybSgkdHJhbnNmb3Jtcy4uLikge1xuICAkZXh0cmE6IG51bGw7XG5cbiAgJHg6IG51bGw7XG4gICRsdHItdHJhbnNsYXRlOiBudWxsO1xuICAkcnRsLXRyYW5zbGF0ZTogbnVsbDtcblxuICBAZWFjaCAkdHJhbnNmb3JtIGluICR0cmFuc2Zvcm1zIHtcbiAgICBAaWYgKHN0ci1pbmRleCgkdHJhbnNmb3JtLCB0cmFuc2xhdGUzZCkpIHtcbiAgICAgICR0cmFuc2Zvcm06IHN0ci1yZXBsYWNlKCR0cmFuc2Zvcm0sICd0cmFuc2xhdGUzZCgnKTtcbiAgICAgICR0cmFuc2Zvcm06IHN0ci1yZXBsYWNlKCR0cmFuc2Zvcm0sICcpJyk7XG5cbiAgICAgICRjb29yZGluYXRlczogc3RyLXNwbGl0KCR0cmFuc2Zvcm0sICcsJyk7XG5cbiAgICAgICR4OiBudGgoJGNvb3JkaW5hdGVzLCAxKTtcbiAgICAgICR5OiBudGgoJGNvb3JkaW5hdGVzLCAyKTtcbiAgICAgICR6OiBudGgoJGNvb3JkaW5hdGVzLCAzKTtcblxuICAgICAgJGx0ci10cmFuc2xhdGU6IHRyYW5zbGF0ZTNkKCR4LCAkeSwgJHopO1xuICAgICAgJHJ0bC10cmFuc2xhdGU6IHRyYW5zbGF0ZTNkKGNhbGMoLTEgKiAjeyR4fSksICR5LCAkeik7XG4gICAgfSBAZWxzZSB7XG4gICAgICBAaWYgJGV4dHJhID09IG51bGwge1xuICAgICAgICAkZXh0cmE6ICR0cmFuc2Zvcm07XG4gICAgICB9IEBlbHNlIHtcbiAgICAgICAgJGV4dHJhOiAkZXh0cmEgJHRyYW5zZm9ybTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBAaWYgJHggPT0gJzAnIG9yICR4ID09IG51bGwge1xuICAgIEBpbmNsdWRlIG11bHRpLWRpcigpIHtcbiAgICAgIHRyYW5zZm9ybTogJGx0ci10cmFuc2xhdGUgJGV4dHJhO1xuICAgIH1cbiAgfSBAZWxzZSB7XG4gICAgQGluY2x1ZGUgbHRyKCkge1xuICAgICAgdHJhbnNmb3JtOiAkbHRyLXRyYW5zbGF0ZSAkZXh0cmE7XG4gICAgfVxuXG4gICAgQGluY2x1ZGUgcnRsKCkge1xuICAgICAgdHJhbnNmb3JtOiAkcnRsLXRyYW5zbGF0ZSAkZXh0cmE7XG4gICAgfVxuICB9XG59XG4iLCIvKipcbiAqIEltcG9ydGVkIGlvbmljIG1peGlucyBmb3IgU0NTUyBmcm9tIGRpZmZlcmVudCBjb21wb25lbnRzXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiBFeHRyYWN0ZWQgZnJvbVxuICogaHR0cHM6Ly9naXRodWIuY29tL2lvbmljLXRlYW0vaW9uaWMtZnJhbWV3b3JrL2Jsb2IvbWFzdGVyL2NvcmUvc3JjL2NvbXBvbmVudHMvZ3JpZC9ncmlkLm1peGlucy5zY3NzXG4gKiBodHRwczovL2dpdGh1Yi5jb20vaW9uaWMtdGVhbS9pb25pYy1mcmFtZXdvcmsvYmxvYi9tYXN0ZXIvY29yZS9zcmMvY29tcG9uZW50cy9pdGVtL2l0ZW0ubWl4aW5zLnNjc3NcbiAqL1xuXG4vLyBSZXNwb25zaXZlIE1peGluc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuXG4vLyBDcmVhdGVzIGEgZml4ZWQgd2lkdGggZm9yIHRoZSBncmlkIGJhc2VkIG9uIHRoZSBzY3JlZW4gc2l6ZVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbkBtaXhpbiBtYWtlLWdyaWQtd2lkdGhzKCR3aWR0aHM6ICRncmlkLXdpZHRocywgJGJyZWFrcG9pbnRzOiAkc2NyZWVuLWJyZWFrcG9pbnRzKSB7XG4gIEBlYWNoICRicmVha3BvaW50LCAkd2lkdGggaW4gJHdpZHRocyB7XG4gICAgQGluY2x1ZGUgbWVkaWEtYnJlYWtwb2ludC11cCgkYnJlYWtwb2ludCwgJGJyZWFrcG9pbnRzKSB7XG4gICAgICB3aWR0aDogJHdpZHRoO1xuICAgIH1cbiAgfVxuXG4gIG1heC13aWR0aDogMTAwJTtcbn1cblxuXG4vLyBBZGRzIHBhZGRpbmcgdG8gdGhlIGVsZW1lbnQgYmFzZWQgb24gYnJlYWtwb2ludHNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5AbWl4aW4gbWFrZS1icmVha3BvaW50LXBhZGRpbmcoJHBhZGRpbmdzKSB7XG4gIEBlYWNoICRicmVha3BvaW50IGluIG1hcC1rZXlzKCRwYWRkaW5ncykge1xuICAgIEBpbmNsdWRlIG1lZGlhLWJyZWFrcG9pbnQtdXAoJGJyZWFrcG9pbnQpIHtcbiAgICAgICRwYWRkaW5nOiBtYXAtZ2V0KCRwYWRkaW5ncywgJGJyZWFrcG9pbnQpO1xuXG4gICAgICBAaW5jbHVkZSBwYWRkaW5nKCRwYWRkaW5nKTtcbiAgICB9XG4gIH1cbn1cblxuXG4vLyBJdGVtIE1peGluc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuQG1peGluIGl0ZW0tcHVzaC1zdmctdXJsKCRmaWxsKSB7XG4gICRpdGVtLWRldGFpbC1wdXNoLXN2ZzogXCI8c3ZnIHhtbG5zPSdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Zycgdmlld0JveD0nMCAwIDEyIDIwJz48cGF0aCBkPSdNMiwyMGwtMi0ybDgtOEwwLDJsMi0ybDEwLDEwTDIsMjB6JyBmaWxsPScjeyRmaWxsfScvPjwvc3ZnPlwiO1xuXG4gIEBpbmNsdWRlIHN2Zy1iYWNrZ3JvdW5kLWltYWdlKCRpdGVtLWRldGFpbC1wdXNoLXN2ZywgdHJ1ZSk7XG59XG4iLCJAdXNlIFwic2FzczptYXRoXCIgYXMgbWF0aDtcblxuLyoqXG4gKiBBcHAgY3VzdG9tIG1peGlucyBmb3IgU0NTU1xuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogUGxhY2UgaGVyZSBvdXIgY3VzdG9tIG1peGlucy5cbiAqL1xuXG4vLyBNaXhlcyBhIGNvbG9yIHdpdGggYmxhY2sgdG8gY3JlYXRlIGl0cyBzaGFkZS5cbi8vIERlZmF1bHQgdG8gYm9vdHN0cmFwIGxldmVsIDYuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQGZ1bmN0aW9uIGdldC1jb2xvci1zaGFkZS1wZXJjZW50KCRjb2xvciwgJHBlcmNlbnQ6IDQ4JSkge1xuICAgIEByZXR1cm4gbWl4KCMwMDAsICRjb2xvciwgJHBlcmNlbnQpO1xufVxuXG4vLyBNaXhlcyBhIGNvbG9yIHdpdGggd2hpdGUgdG8gY3JlYXRlIGl0cyB0aW50LlxuLy8gRGVmYXVsdCB0byBib290c3RyYXAgbGV2ZWwgLTEwLlxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbkBmdW5jdGlvbiBnZXQtY29sb3ItdGludC1wZXJjZW50KCRjb2xvciwgJHBlcmNlbnQ6IDgwJSkge1xuICAgIEByZXR1cm4gbWl4KCNmZmYsICRjb2xvciwgJHBlcmNlbnQpO1xufVxuXG4vLyBJb25pYyBDb2xvcnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBHZW5lcmF0ZXMgdGhlIGNvbG9yIGNsYXNzZXMgYW5kIHZhcmlhYmxlcyBiYXNlZCBvbiB0aGVcbi8vIGNvbG9ycyBtYXBcblxuQG1peGluIGdlbmVyYXRlLWNvbG9yKCRjb2xvci1uYW1lLCAkY29sb3JzLCAkdGhlbWUpIHtcbiAgICAkY29sb3ItdGhlbWVzOiBtYXAtZ2V0KCRjb2xvcnMsICRjb2xvci1uYW1lKTtcbiAgICAkYmFzZTogbWFwLWdldCgkY29sb3ItdGhlbWVzLCAkdGhlbWUpO1xuXG4gICAgQGlmICR0aGVtZSA9PSAnZGFyaycge1xuICAgICAgICAkYmFzZTogbWl4KG1hcC1nZXQoJGNvbG9yLXRoZW1lcywgJ2xpZ2h0JyksIHdoaXRlLCA4MCUpICFkZWZhdWx0O1xuICAgIH1cblxuICAgIEBpbmNsdWRlIGdlbmVyYXRlLWNvbG9yLXZhcmlhbnRzKCRjb2xvci1uYW1lLCAkYmFzZSk7XG59XG5cbkBtaXhpbiBnZW5lcmF0ZS1jb2xvci12YXJpYW50cygkY29sb3ItbmFtZSwgJGJhc2UpIHtcbiAgICAkY29udHJhc3Q6IGdldF9jb250cmFzdF9jb2xvcigkYmFzZSk7XG4gICAgJHNoYWRlOiBnZXQtY29sb3Itc2hhZGUtcGVyY2VudCgkYmFzZSk7XG4gICAgJHRpbnQ6IGdldC1jb2xvci10aW50LXBlcmNlbnQoJGJhc2UpO1xuXG4gICAgLS0jeyRjb2xvci1uYW1lfTogI3skYmFzZX07XG4gICAgLS0jeyRjb2xvci1uYW1lfS1zaGFkZTogI3skc2hhZGV9O1xuICAgIC0tI3skY29sb3ItbmFtZX0tdGludDogI3skdGludH07XG4gICAgLS0jeyRjb2xvci1uYW1lfS1jb250cmFzdDogI3skY29udHJhc3R9O1xuXG4gICAgLy8gSW50ZXJuYWwgaW9uaWMgdXNlIG9ubHkuXG4gICAgLS1pb24tY29sb3ItI3skY29sb3ItbmFtZX06IHZhcigtLSN7JGNvbG9yLW5hbWV9KTtcbiAgICAtLWlvbi1jb2xvci0jeyRjb2xvci1uYW1lfS1iYXNlOiB2YXIoLS1pb24tY29sb3ItI3skY29sb3ItbmFtZX0pO1xuICAgIC0taW9uLWNvbG9yLSN7JGNvbG9yLW5hbWV9LXJnYjogI3tjb2xvci10by1yZ2ItbGlzdCgkYmFzZSl9O1xuICAgIC0taW9uLWNvbG9yLSN7JGNvbG9yLW5hbWV9LWNvbnRyYXN0OiAjeyRjb250cmFzdH07XG4gICAgLS1pb24tY29sb3ItI3skY29sb3ItbmFtZX0tY29udHJhc3QtcmdiOiAje2NvbG9yLXRvLXJnYi1saXN0KCRjb250cmFzdCl9O1xuICAgIC0taW9uLWNvbG9yLSN7JGNvbG9yLW5hbWV9LXNoYWRlOiAjeyRzaGFkZX07XG4gICAgLS1pb24tY29sb3ItI3skY29sb3ItbmFtZX0tdGludDogI3skdGludH07XG5cbiAgICAuaW9uLWNvbG9yLSN7JGNvbG9yLW5hbWV9IHtcbiAgICAgICAgLS1pb24tY29sb3I6IHZhcigtLWlvbi1jb2xvci0jeyRjb2xvci1uYW1lfSk7XG4gICAgICAgIC0taW9uLWNvbG9yLWJhc2U6IHZhcigtLWlvbi1jb2xvci0jeyRjb2xvci1uYW1lfS1iYXNlKTtcbiAgICAgICAgLS1pb24tY29sb3ItcmdiOiB2YXIoLS1pb24tY29sb3ItI3skY29sb3ItbmFtZX0tcmdiKTtcbiAgICAgICAgLS1pb24tY29sb3ItY29udHJhc3Q6IHZhcigtLWlvbi1jb2xvci0jeyRjb2xvci1uYW1lfS1jb250cmFzdCk7XG4gICAgICAgIC0taW9uLWNvbG9yLWNvbnRyYXN0LXJnYjogdmFyKC0taW9uLWNvbG9yLSN7JGNvbG9yLW5hbWV9LWNvbnRyYXN0LXJnYik7XG4gICAgICAgIC0taW9uLWNvbG9yLXNoYWRlOiB2YXIoLS1pb24tY29sb3ItI3skY29sb3ItbmFtZX0tc2hhZGUpO1xuICAgICAgICAtLWlvbi1jb2xvci10aW50OiB2YXIoLS1pb24tY29sb3ItI3skY29sb3ItbmFtZX0tdGludCk7XG4gICAgfVxufVxuXG5AbWl4aW4gY29yZS1mb2N1cygpIHtcbiAgICBvdXRsaW5lOiBub25lO1xuICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgICAmOjphZnRlciB7XG4gICAgICAgIEBpbmNsdWRlIHBvc2l0aW9uKDAsIDAsIDAsIDApO1xuICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICAgIGNvbnRlbnQ6IFwiXCI7XG4gICAgICAgIG9wYWNpdHk6IDE7XG4gICAgICAgIHotaW5kZXg6IDE7XG4gICAgICAgIEBpbmNsdWRlIGNvcmUtZm9jdXMtc3R5bGUoKTtcbiAgICB9XG59XG5cbkBtaXhpbiBjb3JlLWZvY3VzLXN0eWxlKCkge1xuICAgIGJveC1zaGFkb3c6IGluc2V0IDAgMCB2YXIoLS1hMTF5LWZvY3VzLXdpZHRoKSAxcHggdmFyKC0tYTExeS1mb2N1cy1jb2xvcik7XG4gICAgYm9yZGVyLXJhZGl1czogdmFyKC0tYm9yZGVyLXJhZGl1cyk7XG4gICAgLy8gVGhpY2tlciBvcHRpb246XG4gICAgLy8gYm9yZGVyOiB2YXIoLS1hMTF5LWZvY3VzLXdpZHRoKSBzb2xpZCB2YXIoLS1hMTF5LWZvY3VzLWNvbG9yKTtcbn1cblxuQG1peGluIGNvcmUtdHJhbnNpdGlvbigkcHJvcGVydGllczogYWxsLCAkZHVyYXRpb246IDUwMG1zLCAkdGltaW5nLWZ1bmN0aW9uOiBlYXNlLWluLW91dCkge1xuICAgICR0cmFuc2l0aW9uczogKCk7XG4gICAgQGVhY2ggJHByb3BlcnR5IGluICRwcm9wZXJ0aWVzIHtcbiAgICAgICR0cmFuc2l0aW9uczogYXBwZW5kKCR0cmFuc2l0aW9ucywgJHByb3BlcnR5ICRkdXJhdGlvbiAkdGltaW5nLWZ1bmN0aW9uLCBjb21tYSk7XG4gICAgfVxuXG4gICAgLXdlYmtpdC10cmFuc2l0aW9uOiAkdHJhbnNpdGlvbnM7XG4gICAgdHJhbnNpdGlvbjogJHRyYW5zaXRpb25zO1xufVxuXG5AbWl4aW4gc3Itb25seSgpIHtcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgd2lkdGg6IDFweDtcbiAgICBoZWlnaHQ6IDFweDtcbiAgICBwYWRkaW5nOiAwO1xuICAgIG1hcmdpbjogLTFweDtcbiAgICBvdmVyZmxvdzogaGlkZGVuO1xuICAgIGNsaXA6IHJlY3QoMCwgMCwgMCwgMCk7XG4gICAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcbiAgICBib3JkZXI6IDA7XG59XG5cbi8qKlxuICogU2FtZSBhcyBpdGVtLXB1c2gtc3ZnLXVybCBidXQgYWRtaXRzIGZsaXAtcnRsXG4gKi9cbkBtaXhpbiBwdXNoLWFycm93LWNvbG9yKCRmaWxsOiA2MjYyNjIsICRmbGlwLXJ0bDogZmFsc2UpIHtcbiAgICAkaXRlbS1kZXRhaWwtcHVzaC1zdmc6IFwiPHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHZpZXdCb3g9JzAgMCAxMiAyMCc+PHBhdGggZD0nTTIsMjBsLTItMmw4LThMMCwybDItMmwxMCwxMEwyLDIweicgZmlsbD0nI3skZmlsbH0nLz48L3N2Zz5cIjtcblxuICAgIEBpbmNsdWRlIHN2Zy1iYWNrZ3JvdW5kLWltYWdlKCRpdGVtLWRldGFpbC1wdXNoLXN2ZywgJGZsaXAtcnRsKTtcbn1cblxuQG1peGluIGJvcmRlci1zdGFydCgkcHgsICR0eXBlOiBudWxsLCAkY29sb3I6IG51bGwpIHtcbiAgICBAaW5jbHVkZSBwcm9wZXJ0eS1ob3Jpem9udGFsKGJvcmRlciwgJHB4ICR0eXBlICRjb2xvciwgbnVsbCk7XG59XG5cbkBtaXhpbiBib3JkZXItZW5kKCRweCwgJHR5cGU6IG51bGwsICRjb2xvcjogbnVsbCkge1xuICAgIEBpbmNsdWRlIHByb3BlcnR5LWhvcml6b250YWwoYm9yZGVyLCBudWxsLCAkcHggJHR5cGUgJGNvbG9yKTtcbn1cblxuQG1peGluIHNhZmUtYXJlYS1ib3JkZXItc3RhcnQoJHB4LCAkdHlwZSwgJGNvbG9yKSB7XG4gICAgJHNhZmUtYXJlYS1wb3NpdGlvbjogY2FsYyh2YXIoLS1pb24tc2FmZS1hcmVhLWxlZnQpICsgI3skcHh9KTtcblxuICAgIEBpbmNsdWRlIGJvcmRlci1zdGFydCgkc2FmZS1hcmVhLXBvc2l0aW9uLCAkdHlwZSwgJGNvbG9yKTtcbn1cblxuQG1peGluIHNhZmUtYXJlYS1ib3JkZXItZW5kKCRweCwgJHR5cGUsICRjb2xvcikge1xuICAgICRzYWZlLWFyZWEtcG9zaXRpb246IGNhbGModmFyKC0taW9uLXNhZmUtYXJlYS1yaWdodCkgKyAjeyRweH0pO1xuXG4gICAgQGluY2x1ZGUgYm9yZGVyLWVuZCgkc2FmZS1hcmVhLXBvc2l0aW9uLCAkdHlwZSwgJGNvbG9yKTtcbn1cblxuQG1peGluIHNhZmUtYXJlYS1tYXJnaW4taG9yaXpvbnRhbCgkc3RhcnQsICRlbmQ6ICRzdGFydCkge1xuICAgICRzYWZlLWFyZWEtZW5kOiBudWxsO1xuICAgICRzYWZlLWFyZWEtc3RhcnQ6IG51bGw7XG5cbiAgICBAaWYgKCRlbmQpIHtcbiAgICAgICAgJHNhZmUtYXJlYS1lbmQ6IGNhbGModmFyKC0taW9uLXNhZmUtYXJlYS1yaWdodCkgKyAjeyRlbmR9KTtcbiAgICB9XG4gICAgQGlmICgkc3RhcnQpIHtcbiAgICAgICAgJHNhZmUtYXJlYS1zdGFydDogY2FsYyh2YXIoLS1pb24tc2FmZS1hcmVhLWxlZnQpICsgI3skc3RhcnR9KTtcbiAgICB9XG5cbiAgICBAaW5jbHVkZSBtYXJnaW4taG9yaXpvbnRhbCgkc2FmZS1hcmVhLXN0YXJ0LCAkc2FmZS1hcmVhLWVuZCk7XG59XG5cbkBtaXhpbiBzYWZlLWFyZWEtbWFyZ2luLXN0YXJ0KCRzdGFydCwgJGVuZCkge1xuICAgICRzYWZlLWFyZWEtc3RhcnQ6IGNhbGModmFyKC0taW9uLXNhZmUtYXJlYS1sZWZ0KSArICN7JHN0YXJ0fSk7XG5cbiAgICBAaW5jbHVkZSBtYXJnaW4taG9yaXpvbnRhbCgkc2FmZS1hcmVhLXN0YXJ0LCAkZW5kKTtcbn1cblxuQG1peGluIHNhZmUtYXJlYS1tYXJnaW4tZW5kKCRzdGFydCwgJGVuZCkge1xuICAgICRzYWZlLWFyZWEtZW5kOiBjYWxjKHZhcigtLWlvbi1zYWZlLWFyZWEtcmlnaHQpICsgI3skZW5kfSk7XG5cbiAgICBAaW5jbHVkZSBtYXJnaW4taG9yaXpvbnRhbCgkc3RhcnQsICRzYWZlLWFyZWEtZW5kKTtcbn1cblxuQG1peGluIHNhZmUtYXJlYS1wYWRkaW5nLWhvcml6b250YWwoJHN0YXJ0LCAkZW5kOiAkc3RhcnQpIHtcbiAgICAkc2FmZS1hcmVhLWVuZDogbnVsbDtcbiAgICAkc2FmZS1hcmVhLXN0YXJ0OiBudWxsO1xuXG4gICAgQGlmICgkZW5kKSB7XG4gICAgICAgICRzYWZlLWFyZWEtZW5kOiBjYWxjKHZhcigtLWlvbi1zYWZlLWFyZWEtcmlnaHQpICsgI3skZW5kfSk7XG4gICAgfVxuICAgIEBpZiAoJHN0YXJ0KSB7XG4gICAgICAgICRzYWZlLWFyZWEtc3RhcnQ6IGNhbGModmFyKC0taW9uLXNhZmUtYXJlYS1sZWZ0KSArICN7JHN0YXJ0fSk7XG4gICAgfVxuXG4gICAgQGluY2x1ZGUgcGFkZGluZy1ob3Jpem9udGFsKCRzYWZlLWFyZWEtc3RhcnQsICRzYWZlLWFyZWEtZW5kKTtcbn1cblxuQG1peGluIHNhZmUtYXJlYS1wYWRkaW5nLXN0YXJ0KCRzdGFydCwgJGVuZCkge1xuICAgICRzYWZlLWFyZWEtc3RhcnQ6IGNhbGModmFyKC0taW9uLXNhZmUtYXJlYS1sZWZ0KSArICN7JHN0YXJ0fSk7XG5cbiAgICBAaW5jbHVkZSBwYWRkaW5nLWhvcml6b250YWwoJHNhZmUtYXJlYS1zdGFydCwgJGVuZCk7XG59XG5cbkBtaXhpbiBzYWZlLWFyZWEtcGFkZGluZy1lbmQoJHN0YXJ0LCAkZW5kKSB7XG4gICAgJHNhZmUtYXJlYS1lbmQ6IGNhbGModmFyKC0taW9uLXNhZmUtYXJlYS1yaWdodCkgKyAjeyRlbmR9KTtcblxuICAgIEBpbmNsdWRlIHBhZGRpbmctaG9yaXpvbnRhbCgkc3RhcnQsICRzYWZlLWFyZWEtZW5kKTtcbn1cblxuQG1peGluIHNhZmUtYXJlYS1wb3NpdGlvbigkdG9wOiBudWxsLCAkZW5kOiBudWxsLCAkYm90dG9tOiBudWxsLCAkc3RhcnQ6IG51bGwpIHtcbiAgICAkc2FmZS1hcmVhLXN0YXJ0OiBjYWxjKHZhcigtLWlvbi1zYWZlLWFyZWEtbGVmdCkgKyAjeyRzdGFydH0pO1xuICAgICRzYWZlLWFyZWEtZW5kOiBjYWxjKHZhcigtLWlvbi1zYWZlLWFyZWEtcmlnaHQpICsgI3skZW5kfSk7XG5cbiAgICBAaW5jbHVkZSBwb3NpdGlvbigkdG9wLCAkc2FmZS1hcmVhLWVuZCwgJGJvdHRvbSwgJHNhZmUtYXJlYS1zdGFydCk7XG59XG5cbkBtaXhpbiBjb3JlLWhlYWRpbmdzKCkge1xuICAgIGgxIHtcbiAgICAgICAgZm9udC1zaXplOiAyNnB4O1xuICAgIH1cbiAgICBoMiwgLml0ZW0taGVhZGluZyB7XG4gICAgICAgIGZvbnQtc2l6ZTogMjRweDtcbiAgICB9XG4gICAgaDMge1xuICAgICAgICBmb250LXNpemU6IDIycHg7XG4gICAgfVxuICAgIGg0IHtcbiAgICAgICAgZm9udC1zaXplOiAyMHB4O1xuICAgIH1cbiAgICBoNSB7XG4gICAgICAgIGZvbnQtc2l6ZTogMThweDtcbiAgICB9XG4gICAgaDYge1xuICAgICAgICBmb250LXNpemU6IDE2cHg7XG4gICAgfVxufVxuXG5AbWl4aW4gZGFya21vZGUoKSB7XG4gICAgJHJvb3Q6ICN7Jn07XG5cbiAgICBAYXQtcm9vdCAje2FkZC1yb290LXNlbGVjdG9yKCRyb290LCBcImh0bWwuZGFya1wiKX0ge1xuICAgICAgICBAY29udGVudDtcbiAgICB9XG59XG5cbkBtaXhpbiBob3Jpem9udGFsX3Njcm9sbF9pdGVtKCR3aWR0aCwgJG1pbi13aWR0aCwgJG1heC13aWR0aCkge1xuICAgIGZsZXg6IDAgMCAkd2lkdGg7XG4gICAgbWluLXdpZHRoOiAkbWluLXdpZHRoO1xuICAgIG1heC13aWR0aDogJG1heC13aWR0aDtcbiAgICBhbGlnbi1zZWxmOiBzdHJldGNoO1xuICAgIGRpc3BsYXk6IGJsb2NrO1xuXG4gICAgaW9uLWNhcmQge1xuICAgICAgICAtLXZlcnRpY2FsLW1hcmdpbjogMTBweDtcbiAgICAgICAgLS1ob3Jpem9udGFsLW1hcmdpbjogMTBweDtcblxuICAgICAgICB3aWR0aDogY2FsYygxMDAlIC0gdmFyKC0taG9yaXpvbnRhbC1tYXJnaW4pIC0gdmFyKC0taG9yaXpvbnRhbC1tYXJnaW4pKTtcbiAgICAgICAgaGVpZ2h0OiBjYWxjKDEwMCUgLSB2YXIoLS12ZXJ0aWNhbC1tYXJnaW4pIC0gdmFyKC0tdmVydGljYWwtbWFyZ2luKSk7XG4gICAgICAgIG1hcmdpbjogdmFyKC0tdmVydGljYWwtbWFyZ2luKSB2YXIoLS1ob3Jpem9udGFsLW1hcmdpbik7XG5cbiAgICAgICAgQG1lZGlhIChtYXgtd2lkdGg6IDM2MHB4KSB7XG4gICAgICAgICAgICAtLWhvcml6b250YWwtbWFyZ2luOiA2cHg7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbi8vIENvbG9yIG1peGlucy5cbkBmdW5jdGlvbiBnZXRfYnJpZ2h0bmVzcygkY29sb3IpIHtcbiAgICBAcmV0dXJuIG1hdGguZGl2KHJlZCgkY29sb3IpICsgZ3JlZW4oJGNvbG9yKSArIGJsdWUoJGNvbG9yKSwgMyk7XG59XG5cbi8vIEdldCB0aGUgYmV0dGVyIGNvbG9yIGNvbnRyYXN0IHVzaW5nIFdDQUcgYWxnb3J5dGhtLlxuQGZ1bmN0aW9uIGdldF9jb250cmFzdF9jb2xvcigkY29sb3IpIHtcbiAgICAkbHVtaWFuY2U6IGx1bWluYW5jZSgkY29sb3IpO1xuXG4gICAgLy8gV2hpdGUgbHVtaWFuY2UgaXMgMS5cbiAgICAkd2hpdGVDb250cmFzdDogbWF0aC5kaXYoJGx1bWlhbmNlICsgMC4wNSwgMSArIDAuMDUpO1xuICAgIC8vIFdoaXRlIGx1bWlhbmNlIGlzIDAuXG4gICAgJGJsYWNrQ29udHJhc3Q6IG1hdGguZGl2KDAuMDUsICRsdW1pYW5jZSArIDAuMDUpO1xuXG4gICAgQHJldHVybiBpZigkd2hpdGVDb250cmFzdCA8ICRibGFja0NvbnRyYXN0LCB3aGl0ZSwgYmxhY2spO1xufVxuXG4vLyBDb2xvciBjb250cmFzdCB1c2luZyB5aXEgYXByb3hpbWF0aW9uIHdpdGggMTUwIHRocmVzaG9sZC5cbkBmdW5jdGlvbiBnZXRfY29udHJhc3RfY29sb3JfeWlxKCRjb2xvciwgJGRhcms6IGJsYWNrLCAkbGlnaHQ6IHdoaXRlKSB7XG4gICAgJHI6IHJlZCgkY29sb3IpO1xuICAgICRnOiBncmVlbigkY29sb3IpO1xuICAgICRiOiBibHVlKCRjb2xvcik7XG5cbiAgICAkeWlxOiBtYXRoLmRpdigoJHIgKiAyOTkpICsgKCRnICogNTg3KSArICgkYiAqIDExNCksIDEwMDApO1xuXG4gICAgQHJldHVybiBpZigkeWlxID49IDEyOCwgJGRhcmssICRsaWdodCk7XG59XG5cbi8vIFdDQUcgY29udHJhc3QgYWxnb3JpdGhtXG5AZnVuY3Rpb24gY2hlY2stY29udHJhc3QoJGZvcmVncm91bmQsICRiYWNrZ3JvdW5kKSB7XG4gICAgJGZvcmVncm91bmRMdW1pYW5jZTogbHVtaW5hbmNlKCRmb3JlZ3JvdW5kKTtcbiAgICAkYmFja2dyb3VuZEx1bWluYW5jZTogbHVtaW5hbmNlKCRiYWNrZ3JvdW5kKTtcblxuICAgIEBpZiAoJGJhY2tncm91bmRMdW1pbmFuY2UgPCAkZm9yZWdyb3VuZEx1bWlhbmNlKSB7XG4gICAgICAgIEByZXR1cm4gbWF0aC5kaXYoJGJhY2tncm91bmRMdW1pbmFuY2UgKyAwLjA1LCAkZm9yZWdyb3VuZEx1bWlhbmNlICsgMC4wNSk7XG4gICAgfSBAZWxzZSB7XG4gICAgICAgIEByZXR1cm4gbWF0aC5kaXYoJGZvcmVncm91bmRMdW1pYW5jZSArIDAuMDUsICRiYWNrZ3JvdW5kTHVtaW5hbmNlICsgMC4wNSk7XG4gICAgfVxufVxuXG5AZnVuY3Rpb24gbHVtaW5hbmNlKCRjb2xvcikge1xuICAgICRyOiByZWQoJGNvbG9yKTtcbiAgICAkZzogZ3JlZW4oJGNvbG9yKTtcbiAgICAkYjogYmx1ZSgkY29sb3IpO1xuXG4gICAgJHI6IGNvbXBvbmVudC1sdW1pbmFuY2UoJHIpO1xuICAgICRnOiBjb21wb25lbnQtbHVtaW5hbmNlKCRnKTtcbiAgICAkYjogY29tcG9uZW50LWx1bWluYW5jZSgkYik7XG5cbiAgICBAcmV0dXJuICRyICogMC4yMTI2ICsgJGcgKiAwLjcxNTIgKyAkYiAqIDAuMDcyMjtcbn1cblxuQGZ1bmN0aW9uIGNvbXBvbmVudC1sdW1pbmFuY2UoJHZhbHVlKSB7XG4gICAgJHZhbHVlOiBtYXRoLmRpdigkdmFsdWUsIDI1NSk7XG5cbiAgICBAaWYgKCR2YWx1ZSA8PSAwLjAzOTI4KSB7XG4gICAgICAgIEByZXR1cm4gbWF0aC5kaXYoJHZhbHVlLCAxMi45Mik7XG4gICAgfSBAZWxzZSB7XG4gICAgICAgIEByZXR1cm4gbWF0aC5wb3cobWF0aC5kaXYoJHZhbHVlICsgMC4wNTUsIDEuMDU1KSwgMi40KTtcbiAgICB9XG59XG4iLCIvKlxuICogQXBwIEN1c3RvbSBBcHAgdmFyaWFibGVzIFNDU1NcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqIFBsYWNlIGhlcmUgYWxsIGN1c3RvbSBhcHAgdmFyaWFibGVzLlxuICovXG4iLCIvKlxuICogQXBwIEdsb2JhbCB2YXJpYWJsZXMgU0NTU1xuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogUGxhY2UgaGVyZSBhbGwgZ2xvYmFsIHZhcmlhYmxlcy5cbiAqL1xuXG4kd2hpdGU6ICAgICAgICNmZmZmZmYgIWRlZmF1bHQ7XG4kZ3JheS0xMDA6ICAgICNmOGY5ZmEgIWRlZmF1bHQ7XG4kZ3JheS0yMDA6ICAgICNlOWVjZWYgIWRlZmF1bHQ7XG4kZ3JheS0zMDA6ICAgICNkZWUyZTYgIWRlZmF1bHQ7IC8vIFN0cm9rZVxuJGdyYXktNDAwOiAgICAjY2VkNGRhICFkZWZhdWx0O1xuJGdyYXktNTAwOiAgICAjOGY5NTllICFkZWZhdWx0OyAvLyBTdHJva2Ugb24gaW5wdXRzXG4kZ3JheS02MDA6ICAgICM2YTczN2IgIWRlZmF1bHQ7XG4kZ3JheS03MDA6ICAgICM0OTUwNTcgIWRlZmF1bHQ7XG4kZ3JheS04MDA6ICAgICMzNDNhNDAgIWRlZmF1bHQ7XG4kZ3JheS05MDA6ICAgICMyODI4MjggIWRlZmF1bHQ7IC8vIENvcHkgdGV4dFxuJGJsYWNrOiAgICAgICAjMDAwMDAwICFkZWZhdWx0OyAvLyBBdm9pZCB1c2FnZVxuXG4kYmx1ZTogICAgICAgICMwZjZjYmYgIWRlZmF1bHQ7XG4kY3lhbjogICAgICAgICMwMDgxOTYgIWRlZmF1bHQ7IC8vIE5vdCB1c2VkLlxuJGdyZWVuOiAgICAgICAjMzU3YTMyICFkZWZhdWx0O1xuJHJlZDogICAgICAgICAjY2EzMTIwICFkZWZhdWx0O1xuJHllbGxvdzogICAgICAjZjBhZDRlICFkZWZhdWx0O1xuXG4kYnJhbmQtY29sb3I6ICNmOTgwMTIgIWRlZmF1bHQ7XG5cbiR0ZXh0LWNvbG9yOiAgICAgICAgICAgICAgICRncmF5LTkwMCAhZGVmYXVsdDtcbiR0ZXh0LWNvbG9yLXJnYjogICAgICAgICAgIGNvbG9yLXRvLXJnYi1saXN0KCR0ZXh0LWNvbG9yKSAhZGVmYXVsdDtcbiR0ZXh0LWNvbG9yLWRhcms6ICAgICAgICAgICR3aGl0ZSAhZGVmYXVsdDtcbiR0ZXh0LWNvbG9yLWRhcmstcmdiOiAgICAgIGNvbG9yLXRvLXJnYi1saXN0KCR0ZXh0LWNvbG9yLWRhcmspICFkZWZhdWx0O1xuXG4kYmFja2dyb3VuZC1jb2xvcjogICAgICAgICAgJHdoaXRlICFkZWZhdWx0O1xuJGJhY2tncm91bmQtY29sb3ItcmdiOiAgICAgIGNvbG9yLXRvLXJnYi1saXN0KCRiYWNrZ3JvdW5kLWNvbG9yKSAhZGVmYXVsdDtcbiRiYWNrZ3JvdW5kLWNvbG9yLWRhcms6ICAgICAkZ3JheS05MDAgIWRlZmF1bHQ7IC8vICMxYTFhMWFcbiRiYWNrZ3JvdW5kLWNvbG9yLWRhcmstcmdiOiBjb2xvci10by1yZ2ItbGlzdCgkYmFja2dyb3VuZC1jb2xvci1kYXJrKSAhZGVmYXVsdDtcblxuJGlvbi1pdGVtLWJhY2tncm91bmQ6ICAgICAgJHdoaXRlICFkZWZhdWx0O1xuJGlvbi1pdGVtLWJhY2tncm91bmQtcmdiOiAgY29sb3ItdG8tcmdiLWxpc3QoJGlvbi1pdGVtLWJhY2tncm91bmQpICFkZWZhdWx0O1xuJGlvbi1pdGVtLWJhY2tncm91bmQtZGFyazogJGdyYXktOTAwICFkZWZhdWx0O1xuJGlvbi1pdGVtLWJhY2tncm91bmQtZGFyay1yZ2I6IGNvbG9yLXRvLXJnYi1saXN0KCRpb24taXRlbS1iYWNrZ3JvdW5kLWRhcmspICFkZWZhdWx0O1xuXG4kcHJpbWFyeTogICAgJGJyYW5kLWNvbG9yICFkZWZhdWx0O1xuJHNlY29uZGFyeTogICRncmF5LTMwMCAhZGVmYXVsdDtcbiRkYW5nZXI6ICAgICAkcmVkICFkZWZhdWx0O1xuJHdhcm5pbmc6ICAgICR5ZWxsb3cgIWRlZmF1bHQ7XG4kc3VjY2VzczogICAgJGdyZWVuICFkZWZhdWx0O1xuJGluZm86ICAgICAgICRibHVlICFkZWZhdWx0O1xuJGxpZ2h0OiAgICAgICRncmF5LTEwMCAhZGVmYXVsdDtcbiRtZWRpdW06ICAgICAkZ3JheS03MDAgIWRlZmF1bHQ7XG4kZGFyazogICAgICAgJGdyYXktOTAwICFkZWZhdWx0O1xuXG4kY29sb3JzOiAgKFxuICAgIHByaW1hcnk6IChsaWdodDogJHByaW1hcnksIGRhcms6ICRwcmltYXJ5KSxcbiAgICBzZWNvbmRhcnk6IChsaWdodDogJHNlY29uZGFyeSwgZGFyazogJGdyYXktNzAwKSxcbiAgICBzdWNjZXNzOiAobGlnaHQ6ICRzdWNjZXNzKSxcbiAgICB3YXJuaW5nOiAobGlnaHQ6ICR3YXJuaW5nKSxcbiAgICBkYW5nZXI6ICAobGlnaHQ6ICRkYW5nZXIpLFxuICAgIGluZm86IChsaWdodDogJGluZm8pLFxuICAgIGxpZ2h0OiAobGlnaHQ6ICRsaWdodCwgZGFyazogJGRhcmspLFxuICAgIG1lZGl1bTogKGxpZ2h0OiAkbWVkaXVtLCBkYXJrOiAkZ3JheS0yMDApLFxuICAgIGRhcms6IChsaWdodDogJGRhcmssIGRhcms6ICRsaWdodCksXG4pICFkZWZhdWx0O1xuXG4vKipcbiAqIExheW91dCBCcmVha3BvaW50c1xuICpcbiAqIGh0dHBzOi8vaW9uaWNmcmFtZXdvcmsuY29tL2RvY3MvbGF5b3V0L2dyaWQjZGVmYXVsdC1icmVha3BvaW50c1xuICovXG5cbi8vIFRoZSBtaW5pbXVtIGRpbWVuc2lvbnMgYXQgd2hpY2ggeW91ciBsYXlvdXQgd2lsbCBjaGFuZ2UsXG4vLyBhZGFwdGluZyB0byBkaWZmZXJlbnQgc2NyZWVuIHNpemVzLCBmb3IgdXNlIGluIG1lZGlhIHF1ZXJpZXNcbiRzY3JlZW4tYnJlYWtwb2ludHM6IChcbiAgICB4czogMHB4LFxuICAgIHNtOiA1NzZweCxcbiAgICBtZDogNzY4cHgsXG4gICAgbGc6IDk5MnB4LFxuICAgIHRhYmxldDogOTkycHgsXG4gICAgeGw6IDEyMDBweFxuKSAhZGVmYXVsdDtcblxuJGNvcmUtY291cnNlLWltYWdlLWJhY2tncm91bmQ6ICM4MWVjZWMsICM3NGI5ZmYsICNhMjliZmUsICNkZmU2ZTksICMwMGI4OTQsICMwOTg0ZTMsICNiMmJlYzMsICNmZGNiNmUsICNmZDc5YTgsICM2YzVjZTcgIWRlZmF1bHQ7XG4kY29yZS1kZC1xdWVzdGlvbi1jb2xvcnM6ICNGRkZGRkYsICNCMEM0REUsICNEQ0RDREMsICNEOEJGRDgsICM4N0NFRkEsICNEQUE1MjAsICNGRkQ3MDAsICNGMEU2OEMgIWRlZmF1bHQ7XG4kY29yZS10ZXh0LWhpZ2h0bGlnaHQtYmFja2dyb3VuZC1jb2xvcjogbGlnaHRlbigkYmx1ZSwgNDAlKSAhZGVmYXVsdDtcblxuJGNvcmUtZml4ZWQtdXJsOiBmYWxzZSAhZGVmYXVsdDtcbiRjb3JlLWRhc2hib2FyZC1sb2dvOiBmYWxzZSAhZGVmYXVsdDtcbiRjb3JlLWFsd2F5cy1zaG93LW1haW4tbWVudTogZmFsc2UgIWRlZmF1bHQ7XG4kY29yZS1mb3JtYXQtdGV4dC1uZXZlci1zaG9ydGVuOiBmYWxzZSAhZGVmYXVsdDtcblxuJGNvcmUtaGlkZS1jb3Vyc2VpbWFnZS1vbi1jb3Vyc2U6IGZhbHNlICFkZWZhdWx0O1xuJGNvcmUtaGlkZS1wcm9ncmVzcy1vbi1jb3Vyc2U6IGZhbHNlICFkZWZhdWx0O1xuJGNvcmUtaGlkZS1wcm9ncmVzcy1vbi1zZWN0aW9uLXNlbGVjdG9yOiBmYWxzZSAhZGVmYXVsdDtcblxuJGNvcmUtY291cnNlLWhpZGUtdGh1bWItb24tY2FyZHM6IGZhbHNlICFkZWZhdWx0O1xuJGNvcmUtY291cnNlLXRodW1iLW9uLWNhcmRzLWJhY2tncm91bmQ6IG51bGwgIWRlZmF1bHQ7XG4kY29yZS1jb3Vyc2UtaGlkZS1wcm9ncmVzcy1vbi1jYXJkczogZmFsc2UgIWRlZmF1bHQ7XG5cbi8vIENvbmZpZ3VyYXRpb24gb3B0aW9ucyBmb3IgbG9naW4gcGFnZS5cbiRjb3JlLWxvZ2luLWJ1dHRvbi1vdXRsaW5lOiBmYWxzZSAhZGVmYXVsdDtcbiRjb3JlLWxvZ2luLWJ1dHRvbi1vdXRsaW5lLWRhcms6ICRjb3JlLWxvZ2luLWJ1dHRvbi1vdXRsaW5lICFkZWZhdWx0O1xuJGNvcmUtbG9naW4tbG9hZGluZy1jb2xvcjogZmFsc2UgIWRlZmF1bHQ7XG4kY29yZS1sb2dpbi1sb2FkaW5nLWNvbG9yLWRhcms6ICR0ZXh0LWNvbG9yLWRhcmsgIWRlZmF1bHQ7XG4kY29yZS1sb2dpbi1oaWRlLWZvcmdvdC1wYXNzd29yZDogZmFsc2UgIWRlZmF1bHQ7XG4kY29yZS1sb2dpbi1oaWRlLW5lZWQtaGVscDogZmFsc2UgIWRlZmF1bHQ7XG4kY29yZS1sb2dpbi1oaWRlLXFyY29kZTogZmFsc2UgIWRlZmF1bHQ7XG5cbi8vIENvbmZpZ3VyYXRpb24gb3B0aW9ucyBmb3IgbW9yZSBwYWdlLiAoZGVwcmVjYXRlZCBvbiA0LjApXG4kY29yZS1tb3JlLWhpZGUtc2l0ZWluZm86IGZhbHNlICFkZWZhdWx0O1xuJGNvcmUtbW9yZS1oaWRlLXNpdGVuYW1lOiBmYWxzZSAhZGVmYXVsdDtcbiRjb3JlLW1vcmUtaGlkZS1zaXRldXJsOiBmYWxzZSAhZGVmYXVsdDtcblxuLy8gQ29uZmlndXJhdGlvbiBvcHRpb25zIGZvciB1c2VyIHBhZ2UuXG4kY29yZS11c2VyLWhpZGUtc2l0ZWluZm86ICRjb3JlLW1vcmUtaGlkZS1zaXRlaW5mbyAhZGVmYXVsdDtcbiRjb3JlLXVzZXItaGlkZS1zaXRlbmFtZTogJGNvcmUtbW9yZS1oaWRlLXNpdGVuYW1lICFkZWZhdWx0O1xuJGNvcmUtdXNlci1oaWRlLXNpdGV1cmw6ICRjb3JlLW1vcmUtaGlkZS1zaXRldXJsICFkZWZhdWx0O1xuXG4vLyBBY3Rpdml0eSBpY29uIGJhY2tncm91bmQgY29sb3JzLlxuJGFjdGl2aXR5LWljb24tY29sb3JzOiAoXG4gICAgYWRtaW5pc3RyYXRpb246ICM1ZDYzZjYsXG4gICAgYXNzZXNzbWVudDogI2ViNjZhMixcbiAgICBjb2xsYWJvcmF0aW9uOiAjZjc2MzRkLFxuICAgIGNvbW11bmljYXRpb246ICMxMWE2NzYsXG4gICAgY29udGVudDogIzM5OWJlMixcbiAgICBpbnRlcmZhY2U6ICNhMzc4ZmZcbikgIWRlZmF1bHQ7XG5cbiRjYWxlbmRhci1ldmVudC1jYXRlZ29yeS1jYXRlZ29yeTogIzhlMjRhYSAhZGVmYXVsdDtcbiRjYWxlbmRhci1ldmVudC1jYXRlZ29yeS1jb3Vyc2U6ICRyZWQgIWRlZmF1bHQ7XG4kY2FsZW5kYXItZXZlbnQtY2F0ZWdvcnktZ3JvdXA6ICR5ZWxsb3cgIWRlZmF1bHQ7XG4kY2FsZW5kYXItZXZlbnQtY2F0ZWdvcnktdXNlcjogJGJsdWUgIWRlZmF1bHQ7XG4kY2FsZW5kYXItZXZlbnQtY2F0ZWdvcnktc2l0ZTogJGdyZWVuICFkZWZhdWx0O1xuXG4vLyBDYWxlbmRhciBldmVudCBjYXRlZ29yeSBiYWNrZ3JvdW5kIGNvbG9ycy5cbiRjYWxlbmRhci1ldmVudC1jYXRlZ29yeS1jb2xvcnM6IChcbiAgICBjYXRlZ29yeTogJGNhbGVuZGFyLWV2ZW50LWNhdGVnb3J5LWNhdGVnb3J5LFxuICAgIGNvdXJzZTogJGNhbGVuZGFyLWV2ZW50LWNhdGVnb3J5LWNvdXJzZSxcbiAgICBncm91cDogJGNhbGVuZGFyLWV2ZW50LWNhdGVnb3J5LWdyb3VwLFxuICAgIHVzZXI6ICRjYWxlbmRhci1ldmVudC1jYXRlZ29yeS11c2VyLFxuICAgIHNpdGU6ICRjYWxlbmRhci1ldmVudC1jYXRlZ29yeS1zaXRlLFxuKSAhZGVmYXVsdDtcbiIsIkB1c2UgXCJ0aGVtZS9nbG9iYWxzXCIgYXMgKjtcblxuOmhvc3QgLmFkZG9uLW1vZF9mb3J1bS1wb3N0IHtcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1pb24taXRlbS1iYWNrZ3JvdW5kKTtcbiAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYWRkb24tZm9ydW0tYm9yZGVyLWNvbG9yKTtcblxuICAgIC5hZGRvbi1mb3J1bS1zdGFyIHtcbiAgICAgICAgY29sb3I6IHZhcigtLWNvcmUtc3Rhci1jb2xvcik7XG4gICAgfVxuXG4gICAgLmNvcmUtZGlzY3Vzc2lvbnVzZXJuYW1lIHtcbiAgICAgICAgZm9udC1zaXplOiAxLjJlbTtcbiAgICB9XG5cbiAgICAuY29yZS1ncm91cG5hbWUge1xuICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICBnYXA6IDRweDtcbiAgICB9XG5cbiAgICBpb24tY2FyZC1oZWFkZXIgLml0ZW0ge1xuXG4gICAgICAgICYuaGlnaGxpZ2h0OjpwYXJ0KG5hdGl2ZSkge1xuICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tYWRkb24tZm9ydW0taGlnaGxpZ2h0LWNvbG9yKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlvbi1sYWJlbCB7XG4gICAgICAgICAgICBtYXJnaW4tdG9wOiA0cHg7XG5cbiAgICAgICAgICAgIGgyIHtcbiAgICAgICAgICAgICAgICBtYXJnaW4tdG9wOiA4cHg7XG4gICAgICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogOHB4O1xuICAgICAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkO1xuICAgICAgICAgICAgICAgIGZsZXgtZ3JvdzogMTtcblxuICAgICAgICAgICAgICAgIGlvbi1pY29uIHtcbiAgICAgICAgICAgICAgICAgICAgQGluY2x1ZGUgbWFyZ2luKDAsIDZweCwgMCwgMCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfVxuXG4gICAgICAgIGNvcmUtdXNlci1hdmF0YXIge1xuICAgICAgICAgICAgLS1jb3JlLWF2YXRhci1zaXplOiB2YXIoLS1hZGRvbi1mb3J1bS1hdmF0YXItc2l6ZSk7XG5cbiAgICAgICAgICAgIEBpbmNsdWRlIG1hcmdpbigwLCA4cHgsIDAsIDApO1xuICAgICAgICB9XG5cbiAgICAgICAgLmFkZG9uLW1vZC1mb3J1bS1wb3N0LXRpdGxlLFxuICAgICAgICAuYWRkb24tbW9kLWZvcnVtLXBvc3QtaW5mbyB7XG4gICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgfVxuXG4gICAgICAgIC5hZGRvbi1tb2QtZm9ydW0tcG9zdC1pbmZvIHtcbiAgICAgICAgICAgIG1hcmdpbi10b3A6IDhweDtcbiAgICAgICAgfVxuXG4gICAgICAgIC5hZGRvbi1tb2QtZm9ydW0tcG9zdC10aXRsZSArIC5hZGRvbi1tb2QtZm9ydW0tcG9zdC1pbmZvIHtcbiAgICAgICAgICAgIG1hcmdpbi10b3A6IDBweDtcbiAgICAgICAgfVxuXG4gICAgICAgIC5hZGRvbi1tb2QtZm9ydW0tcG9zdC10aXRsZSAuaXRlbS1oZWFkaW5nLFxuICAgICAgICAuYWRkb24tbW9kLWZvcnVtLXBvc3QtaW5mbyAuYWRkb24tbW9kLWZvcnVtLXBvc3QtYXV0aG9yIHtcbiAgICAgICAgICAgIGZsZXgtZ3JvdzogMTtcbiAgICAgICAgfVxuXG4gICAgfVxuXG4gICAgaW9uLWNhcmQtY29udGVudCB7XG4gICAgICAgIHBhZGRpbmctdG9wOiAxNHB4O1xuICAgIH1cblxuICAgIC5pdGVtIC5pdGVtLWlubmVyIHtcbiAgICAgICAgYm9yZGVyLWJvdHRvbTogMDtcbiAgICB9XG5cbiAgICAuYWRkb24tbW9kLWZvcnVtLXBvc3QtbW9yZS1pbmZvIGRpdiB7XG4gICAgICAgIGZvbnQtc2l6ZTogMXJlbTtcbiAgICB9XG5cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0= */\"]\n});","map":{"version":3,"names":["EventEmitter","FormControl","CoreDomUtils","CoreEvents","CoreSites","AddonModForum","AddonModForumProvider","CoreTag","Translate","CoreFileUploader","AddonModForumSync","CoreSync","CoreTextUtils","AddonModForumHelper","AddonModForumOffline","CoreUtils","AddonModForumPostOptionsMenuComponent","CoreForms","CoreDom","CoreAnalytics","CoreAnalyticsEventType","i0","ɵɵelement","ɵɵattribute","ɵɵpipeBind1","ɵɵelementStart","ɵɵelementEnd","ɵɵlistener","AddonModForumPostComponent_ng_container_1_div_4_ion_button_6_Template_ion_button_click_0_listener","$event","ɵɵrestoreView","_r21","ctx_r20","ɵɵnextContext","ɵɵresetView","showOptionsMenu","ɵɵtemplate","AddonModForumPostComponent_ng_container_1_div_4_ion_icon_2_Template","AddonModForumPostComponent_ng_container_1_div_4_ion_icon_3_Template","AddonModForumPostComponent_ng_container_1_div_4_ion_note_5_Template","AddonModForumPostComponent_ng_container_1_div_4_ion_button_6_Template","ɵɵadvance","ɵɵproperty","ctx_r2","discussion","post","parentid","pinned","starred","subject","forum","cmid","courseId","trackPosts","unread","optionsMenuEnabled","ctx_r3","author","ɵɵtext","ɵɵtextInterpolate1","ctx_r4","fullname","group_r23","name","ctx_r22","AddonModForumPostComponent_ng_container_1_div_9_p_1_Template","ctx_r5","groups","ɵɵtextInterpolate","ɵɵpipeBind2","ctx_r6","timecreated","AddonModForumPostComponent_ng_container_1_ng_container_12_ion_button_2_Template_ion_button_click_0_listener","_r27","ctx_r26","ɵɵelementContainerStart","AddonModForumPostComponent_ng_container_1_ng_container_12_ion_note_1_Template","AddonModForumPostComponent_ng_container_1_ng_container_12_ion_button_2_Template","ɵɵelementContainerEnd","ctx_r8","ɵɵpureFunction1","_c1","ctx_r10","wordcount","ctx_r11","attachments","component","componentId","ctx_r12","tags","AddonModForumPostComponent_ng_container_1_core_rating_rate_20_Template_core_rating_rate_onUpdate_0_listener","_r29","ctx_r28","ratingUpdated","ctx_r13","ratingInfo","id","discussionId","assessed","scale","ctx_r14","AddonModForumPostComponent_ng_container_1_ion_item_22_Template_ion_button_click_2_listener","_r31","ctx_r30","showReplyForm","ctx_r15","uniqueId","formData","replyingTo","AddonModForumPostComponent_ng_container_1_div_4_Template","AddonModForumPostComponent_ng_container_1_core_user_avatar_6_Template","AddonModForumPostComponent_ng_container_1_span_8_Template","AddonModForumPostComponent_ng_container_1_div_9_Template","AddonModForumPostComponent_ng_container_1_p_10_Template","AddonModForumPostComponent_ng_container_1_p_11_Template","AddonModForumPostComponent_ng_container_1_ng_container_12_Template","AddonModForumPostComponent_ng_container_1_div_14_Template","AddonModForumPostComponent_ng_container_1_p_16_Template","AddonModForumPostComponent_ng_container_1_div_17_Template","AddonModForumPostComponent_ng_container_1_ion_item_19_Template","AddonModForumPostComponent_ng_container_1_core_rating_rate_20_Template","AddonModForumPostComponent_ng_container_1_core_rating_aggregate_21_Template","AddonModForumPostComponent_ng_container_1_ion_item_22_Template","ɵɵpropertyInterpolate1","ctx_r0","ɵɵclassProp","highlight","displaySubject","ɵɵclassMap","isprivatereply","message","haswordcount","length","tagsEnabled","capabilities","reply","AddonModForumPostComponent_form_2_ion_item_14_Template_ion_checkbox_ngModelChange_4_listener","_r38","ctx_r37","ctx_r33","ctx_r41","files","maxbytes","maxattachments","AddonModForumPostComponent_form_2_ng_container_15_Template_ion_item_click_1_listener","_r43","ctx_r42","toggleAdvanced","AddonModForumPostComponent_form_2_ng_container_15_ion_icon_3_Template","AddonModForumPostComponent_form_2_ng_container_15_ion_icon_4_Template","AddonModForumPostComponent_form_2_ng_container_15_div_9_Template","ctx_r34","advanced","AddonModForumPostComponent_form_2_Template_ion_input_ngModelChange_6_listener","_r45","ctx_r44","AddonModForumPostComponent_form_2_Template_core_rich_text_editor_contentChanged_12_listener","ctx_r46","onMessageChange","AddonModForumPostComponent_form_2_ion_item_14_Template","AddonModForumPostComponent_form_2_ng_container_15_Template","AddonModForumPostComponent_form_2_Template_ion_button_click_19_listener","ctx_r47","cancel","AddonModForumPostComponent_form_2_Template_ion_button_click_23_listener","ctx_r48","send","AddonModForumPostComponent_form_2_span_24_Template","AddonModForumPostComponent_form_2_span_25_Template","ctx_r1","messageControl","_c2","accessInfo","canpostprivatereply","isEditing","AddonModForumPostComponent","constructor","elementRef","onPostChange","showForm","ngOnInit","areTagsAvailableInSite","reTranslated","instant","parentSubject","defaultReplySubject","replysubject","startsWith","delete","undefined","edit","isGetDiscussionPostAvailable","isDeletePostAvailable","isUpdatePostAvailable","ngOnChanges","changes","leavingPage","triggerFormCancelledEvent","formElement","getCurrentSiteId","deletePost","_this","_asyncToGenerator","analyticsLogEvent","showDeleteConfirm","modal","showModalLoading","response","data","forumId","cmId","deleted","status","trigger","CHANGE_DISCUSSION_EVENT","showToast","error","showErrorModal","dismiss","setFormData","isPrivate","postId","clearTmpFiles","setValue","originalData","slice","event","_this2","popoverData","openPopover","componentProps","waitForDismissCompleted","action","editPost","discardOfflineReply","_this3","preventDefault","stopPropagation","confirmDiscard","scrollToForm","_unused","_this4","syncId","getDiscussionSyncId","blockOperation","COMPONENT","_unused2","text","_this5","saveOffline","isEditOnline","formatHtmlLines","uploadOrStoreReplyFiles","isWebServiceError","sent","updatePost","attachmentsid","replyPost","private","deleteReplyStoredFiles","emit","triggerFormSubmittedEvent","unblockOperation","showErrorModalDefault","_this6","_this7","promises","push","deleteReply","catch","ignoreErrors","Promise","all","invalidateDiscussionPosts","ngOnDestroy","_this8","hasPostDataChanged","showConfirm","_this9","scrollToElement","nativeElement","wsName","url","logEvent","type","VIEW_ITEM","ws","forumid","category","ɵɵdirectiveInject","ElementRef","selectors","viewQuery","AddonModForumPostComponent_Query","rf","ctx","AddonModForumPostComponent_ng_container_1_Template","AddonModForumPostComponent_form_2_Template"],"sources":["/home/toon/works/gitionic7/ionic-github/ionic/src/addons/mod/forum/components/post/post.ts","/home/toon/works/gitionic7/ionic-github/ionic/src/addons/mod/forum/components/post/post.html"],"sourcesContent":["// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {\n    Component,\n    ElementRef,\n    EventEmitter,\n    Input,\n    OnChanges,\n    OnDestroy,\n    OnInit,\n    Output,\n    SimpleChange,\n    ViewChild,\n} from '@angular/core';\nimport { FormControl } from '@angular/forms';\nimport { CoreDomUtils } from '@services/utils/dom';\nimport { CoreEvents } from '@singletons/events';\nimport { CoreSites } from '@services/sites';\nimport {\n    AddonModForum,\n    AddonModForumAccessInformation,\n    AddonModForumData,\n    AddonModForumDiscussion,\n    AddonModForumPost,\n    AddonModForumProvider,\n    AddonModForumPostFormData,\n} from '../../services/forum';\nimport { CoreTag } from '@features/tag/services/tag';\nimport { Translate } from '@singletons';\nimport { CoreFileUploader } from '@features/fileuploader/services/fileuploader';\nimport { AddonModForumSync } from '../../services/forum-sync';\nimport { CoreSync } from '@services/sync';\nimport { CoreTextUtils } from '@services/utils/text';\nimport { AddonModForumHelper } from '../../services/forum-helper';\nimport { AddonModForumOffline } from '../../services/forum-offline';\nimport { CoreUtils } from '@services/utils/utils';\nimport { AddonModForumPostOptionsMenuComponent } from '../post-options-menu/post-options-menu';\nimport { CoreRatingInfo } from '@features/rating/services/rating';\nimport { CoreForms } from '@singletons/form';\nimport { CoreFileEntry } from '@services/file-helper';\nimport { AddonModForumSharedPostFormData } from '../../pages/discussion/discussion';\nimport { CoreDom } from '@singletons/dom';\nimport { CoreAnalytics, CoreAnalyticsEventType } from '@services/analytics';\n\n/**\n * Components that shows a discussion post, its attachments and the action buttons allowed (reply, etc.).\n */\n@Component({\n    selector: 'addon-mod-forum-post',\n    templateUrl: 'post.html',\n    styleUrls: ['post.scss'],\n})\nexport class AddonModForumPostComponent implements OnInit, OnDestroy, OnChanges {\n\n    @Input() post!: AddonModForumPost; // Post.\n    @Input() courseId!: number; // Post's course ID.\n    @Input() discussionId!: number; // Post's' discussion ID.\n    @Input() discussion?: AddonModForumDiscussion; // Post's' discussion, only for starting posts.\n    @Input() component!: string; // Component this post belong to.\n    @Input() componentId!: number; // Component ID.\n    @Input() formData!: AddonModForumSharedPostFormData; // Object with the new post data. Usually shared between posts.\n    @Input() originalData!: Omit<AddonModForumPostFormData, 'id'>; // Original post data. Usually shared between posts.\n    @Input() trackPosts!: boolean; // True if post is being tracked.\n    @Input() forum!: AddonModForumData; // The forum the post belongs to. Required for attachments and offline posts.\n    @Input() accessInfo!: AddonModForumAccessInformation; // Forum access information.\n    @Input() parentSubject?: string; // Subject of parent post.\n    @Input() ratingInfo?: CoreRatingInfo; // Rating info item.\n    @Input() leavingPage?: boolean; // Whether the page that contains this post is being left and will be destroyed.\n    @Input() highlight = false;\n    @Output() onPostChange: EventEmitter<void> = new EventEmitter<void>(); // Event emitted when a reply is posted or modified.\n\n    @ViewChild('replyFormEl') formElement!: ElementRef;\n\n    messageControl = new FormControl();\n\n    uniqueId!: string;\n    defaultReplySubject!: string;\n    advanced = false; // Display all form fields.\n    tagsEnabled!: boolean;\n    displaySubject = true;\n    optionsMenuEnabled = false;\n\n    constructor(\n        protected elementRef: ElementRef,\n    ) {}\n\n    get showForm(): boolean {\n        return this.post.id > 0\n            ? (!this.formData.isEditing && this.formData.replyingTo === this.post.id) ||\n                (!!this.formData.isEditing && this.formData.id === this.post.id)\n            : !!this.formData.isEditing && this.formData.replyingTo === this.post.parentid;\n    }\n\n    /**\n     * @inheritdoc\n     */\n    ngOnInit(): void {\n        this.tagsEnabled = CoreTag.areTagsAvailableInSite();\n        this.uniqueId = this.post.id > 0 ? 'reply' + this.post.id : 'edit' + this.post.parentid;\n\n        const reTranslated = Translate.instant('addon.mod_forum.re');\n        this.displaySubject = !this.parentSubject ||\n            (this.post.subject != this.parentSubject && this.post.subject != `Re: ${this.parentSubject}` &&\n                this.post.subject != `${reTranslated} ${this.parentSubject}`);\n        this.defaultReplySubject = this.post.replysubject || ((this.post.subject.startsWith('Re: ') ||\n            this.post.subject.startsWith(reTranslated)) ? this.post.subject : `${reTranslated} ${this.post.subject}`);\n\n        if (this.post.id < 0) {\n            this.optionsMenuEnabled = true;\n        } else if (this.post.capabilities.delete !== undefined) {\n            this.optionsMenuEnabled = this.post.capabilities.delete === true || this.post.capabilities.edit === true;\n        } else {\n            // Cannot know if the user can edit/delete or not, display the menu if the WebServices are available.\n            this.optionsMenuEnabled = this.post.id < 0 || (AddonModForum.isGetDiscussionPostAvailable() &&\n                        (AddonModForum.isDeletePostAvailable() || AddonModForum.isUpdatePostAvailable()));\n        }\n    }\n\n    /**\n     * Detect changes on input properties.\n     */\n    ngOnChanges(changes: {[name: string]: SimpleChange}): void {\n        if (changes.leavingPage && this.leavingPage) {\n            // Download all courses is enabled now, initialize it.\n            CoreForms.triggerFormCancelledEvent(this.formElement, CoreSites.getCurrentSiteId());\n        }\n    }\n\n    /**\n     * Deletes an online post.\n     */\n    async deletePost(): Promise<void> {\n        // Log analytics even if the user cancels for consistency with LMS.\n        this.analyticsLogEvent('mod_forum_delete_post', `/mod/forum/post.php?delete=${this.post.id}`);\n\n        try {\n            await CoreDomUtils.showDeleteConfirm('addon.mod_forum.deletesure');\n\n            const modal = await CoreDomUtils.showModalLoading('core.deleting', true);\n\n            try {\n                const response = await AddonModForum.deletePost(this.post.id);\n\n                const data = {\n                    forumId: this.forum.id,\n                    discussionId: this.discussionId,\n                    cmId: this.forum.cmid,\n                    deleted: response.status,\n                    post: this.post,\n                };\n\n                CoreEvents.trigger(\n                    AddonModForumProvider.CHANGE_DISCUSSION_EVENT,\n                    data,\n                    CoreSites.getCurrentSiteId(),\n                );\n\n                CoreDomUtils.showToast('addon.mod_forum.deletedpost', true);\n            } catch (error) {\n                CoreDomUtils.showErrorModal(error);\n            } finally {\n                modal.dismiss();\n            }\n        } catch (error) {\n            // Do nothing.\n        }\n    }\n\n    /**\n     * Set data to new/edit post, clearing temporary files and updating original data.\n     *\n     * @param replyingTo Id of post beeing replied.\n     * @param isEditing True it's an offline reply beeing edited, false otherwise.\n     * @param subject Subject of the reply.\n     * @param message Message of the reply.\n     * @param files Reply attachments.\n     * @param isPrivate True if it's private reply.\n     * @param postId The post ID if user is editing an online post.\n     */\n    protected setFormData(\n        replyingTo?: number,\n        isEditing?: boolean,\n        subject?: string,\n        message?: string,\n        files?: CoreFileEntry[],\n        isPrivate?: boolean,\n        postId?: number,\n    ): void {\n        // Delete the local files from the tmp folder if any.\n        CoreFileUploader.clearTmpFiles(this.formData.files);\n\n        this.formData.replyingTo = replyingTo || 0;\n        this.formData.isEditing = !!isEditing;\n        this.formData.subject = subject || this.defaultReplySubject || '';\n        this.formData.message = message || null;\n        this.formData.files = files || [];\n        this.formData.isprivatereply = !!isPrivate;\n        this.formData.id = postId;\n\n        // Update rich text editor.\n        this.messageControl.setValue(this.formData.message);\n\n        // Update original data.\n        this.originalData.subject = this.formData.subject;\n        this.originalData.message = this.formData.message;\n        this.originalData.files = this.formData.files.slice();\n        this.originalData.isprivatereply = this.formData.isprivatereply;\n\n        // Show advanced fields if any of them has not the default value.\n        this.advanced = this.formData.files.length > 0;\n    }\n\n    /**\n     * Show the context menu.\n     *\n     * @param event Click Event.\n     */\n    async showOptionsMenu(event: Event): Promise<void> {\n        const popoverData = await CoreDomUtils.openPopover<{ action?: string }>({\n            component: AddonModForumPostOptionsMenuComponent,\n            componentProps: {\n                post: this.post,\n                forumId: this.forum.id,\n                cmId: this.forum.cmid,\n            },\n            event,\n            waitForDismissCompleted: true,\n        });\n\n        if (popoverData && popoverData.action) {\n            switch (popoverData.action) {\n                case 'edit':\n                    this.editPost();\n                    break;\n                case 'delete':\n                    this.deletePost();\n                    break;\n                case 'deleteoffline':\n                    this.discardOfflineReply();\n                    break;\n            }\n        }\n    }\n\n    /**\n     * Set this post as being replied to.\n     *\n     * @param event Click event.\n     */\n    async showReplyForm(event: Event): Promise<void> {\n        event.preventDefault();\n        event.stopPropagation();\n\n        if (this.formData.isEditing) {\n            // User is editing a post, data needs to be resetted. Ask confirm if there is unsaved data.\n            try {\n                await this.confirmDiscard();\n                this.setFormData(this.post.id);\n\n                this.scrollToForm();\n            } catch {\n                // Cancelled.\n            }\n\n            return;\n        }\n\n        if (!this.formData.replyingTo) {\n            // User isn't replying, it's a brand new reply. Initialize the data.\n            this.setFormData(this.post.id);\n        } else {\n            // The post being replied has changed but the data will be kept.\n            this.formData.replyingTo = this.post.id;\n\n            if (this.formData.subject == this.originalData.subject) {\n                // Update subject only if it hadn't been modified\n                this.formData.subject = this.defaultReplySubject;\n                this.originalData.subject = this.defaultReplySubject;\n            }\n\n            this.messageControl.setValue(this.formData.message);\n        }\n\n        this.scrollToForm();\n\n        this.analyticsLogEvent('mod_forum_add_discussion_post', `/mod/forum/post.php?reply=${this.post.id}`);\n    }\n\n    /**\n     * Set this post as being edited to.\n     */\n    async editPost(): Promise<void> {\n        // Ask confirm if there is unsaved data.\n        try {\n            await this.confirmDiscard();\n\n            this.formData.syncId = AddonModForumSync.getDiscussionSyncId(this.discussionId);\n            CoreSync.blockOperation(AddonModForumProvider.COMPONENT, this.formData.syncId);\n\n            this.setFormData(\n                this.post.parentid,\n                true,\n                this.post.subject,\n                this.post.message,\n                this.post.attachments,\n                this.post.isprivatereply,\n                this.post.id > 0 ? this.post.id : undefined,\n            );\n\n            this.scrollToForm();\n\n            this.analyticsLogEvent('mod_forum_update_discussion_post', `/mod/forum/post.php?edit=${this.post.id}`);\n        } catch {\n            // Cancelled.\n        }\n    }\n\n    /**\n     * Message changed.\n     *\n     * @param text The new text.\n     */\n    onMessageChange(text?: string | null): void {\n        this.formData.message = text ?? null;\n    }\n\n    /**\n     * Reply to this post or edit post data.\n     */\n    async send(): Promise<void> {\n        if (!this.formData.subject) {\n            CoreDomUtils.showErrorModal('addon.mod_forum.erroremptysubject', true);\n\n            return;\n        }\n\n        if (!this.formData.message) {\n            CoreDomUtils.showErrorModal('addon.mod_forum.erroremptymessage', true);\n\n            return;\n        }\n\n        let saveOffline = false;\n        let message = this.formData.message;\n        const subject = this.formData.subject;\n        const replyingTo = this.formData.replyingTo!;\n        const files = this.formData.files || [];\n        const isEditOnline = this.formData.id && this.formData.id > 0;\n        const modal = await CoreDomUtils.showModalLoading('core.sending', true);\n\n        // Add some HTML to the message if needed.\n        message = CoreTextUtils.formatHtmlLines(message);\n\n        // Upload attachments first if any.\n        let attachments;\n\n        try {\n            if (files.length) {\n                try {\n                    attachments = await AddonModForumHelper.uploadOrStoreReplyFiles(\n                        this.forum.id,\n                        isEditOnline ? this.formData.id! : replyingTo,\n                        files,\n                        false,\n                    );\n                } catch (error) {\n                    // Cannot upload them in online, save them in offline.\n                    if (!this.forum.id || isEditOnline || CoreUtils.isWebServiceError(error)) {\n                        // Cannot store them in offline. Reject.\n                        throw error;\n                    }\n\n                    saveOffline = true;\n                    attachments = await AddonModForumHelper.uploadOrStoreReplyFiles(this.forum.id, replyingTo, files, true);\n                }\n            }\n\n            let sent = false;\n\n            if (isEditOnline) {\n                sent = await AddonModForum.updatePost(this.formData.id!, subject, message, {\n                    attachmentsid: attachments,\n                });\n            } else if (saveOffline) {\n                // Save post in offline.\n                await AddonModForumOffline.replyPost(\n                    replyingTo,\n                    this.discussionId,\n                    this.forum.id,\n                    this.forum.name,\n                    this.courseId,\n                    subject,\n                    message,\n                    {\n                        attachmentsid: attachments,\n                        private: !!this.formData.isprivatereply,\n                    },\n                );\n\n                // Set sent to false since it wasn't sent to server.\n                sent = false;\n            } else {\n                // Try to send it to server.\n                // Don't allow offline if there are attachments since they were uploaded fine.\n                sent = await AddonModForum.replyPost(\n                    replyingTo,\n                    this.discussionId,\n                    this.forum.id,\n                    this.forum.name,\n                    this.courseId,\n                    subject,\n                    message,\n                    {\n                        attachmentsid: attachments,\n                        private: !!this.formData.isprivatereply,\n                    },\n                    undefined,\n                    !files.length,\n                );\n            }\n\n            if (sent && this.forum.id) {\n                // Data sent to server, delete stored files (if any).\n                AddonModForumHelper.deleteReplyStoredFiles(this.forum.id, replyingTo);\n            }\n\n            // Reset data.\n            this.setFormData();\n\n            this.onPostChange.emit();\n\n            CoreForms.triggerFormSubmittedEvent(this.formElement, sent, CoreSites.getCurrentSiteId());\n\n            this.unblockOperation();\n        } catch (error) {\n            CoreDomUtils.showErrorModalDefault(\n                error,\n                isEditOnline ? 'addon.mod_forum.couldnotupdate' : 'addon.mod_forum.couldnotadd',\n                true,\n            );\n        } finally {\n            modal.dismiss();\n        }\n    }\n\n    /**\n     * Cancel reply.\n     */\n    async cancel(): Promise<void> {\n        try {\n            await this.confirmDiscard();\n\n            // Reset data.\n            this.setFormData();\n\n            CoreForms.triggerFormCancelledEvent(this.formElement, CoreSites.getCurrentSiteId());\n\n            this.unblockOperation();\n        } catch (error) {\n            // Cancelled.\n        }\n    }\n\n    /**\n     * Discard offline reply.\n     */\n    async discardOfflineReply(): Promise<void> {\n        try {\n            await CoreDomUtils.showDeleteConfirm();\n\n            const promises: Promise<void>[] = [];\n\n            promises.push(AddonModForumOffline.deleteReply(this.post.parentid!));\n\n            if (this.forum.id) {\n                promises.push(AddonModForumHelper.deleteReplyStoredFiles(this.forum.id, this.post.parentid!).catch(() => {\n                    // Ignore errors, maybe there are no files.\n                }));\n            }\n\n            await CoreUtils.ignoreErrors(Promise.all(promises));\n\n            // Reset data.\n            this.setFormData();\n\n            this.onPostChange.emit();\n\n            this.unblockOperation();\n        } catch (error) {\n            // Cancelled.\n        }\n    }\n\n    /**\n     * Function called when rating is updated online.\n     */\n    ratingUpdated(): void {\n        AddonModForum.invalidateDiscussionPosts(this.discussionId, this.forum.id);\n    }\n\n    /**\n     * Show or hide advanced form fields.\n     */\n    toggleAdvanced(): void {\n        this.advanced = !this.advanced;\n    }\n\n    /**\n     * @inheritdoc\n     */\n    ngOnDestroy(): void {\n        this.unblockOperation();\n    }\n\n    /**\n     * Confirm discard changes if any.\n     *\n     * @returns Promise resolved if the user confirms or data was not changed and rejected otherwise.\n     */\n    protected async confirmDiscard(): Promise<void> {\n        if (AddonModForumHelper.hasPostDataChanged(this.formData, this.originalData)) {\n            // Show confirmation if some data has been modified.\n            await CoreDomUtils.showConfirm(Translate.instant('core.confirmloss'));\n        }\n\n        this.unblockOperation();\n    }\n\n    /**\n     * Unblock operation if there's any blocked operation.\n     */\n    protected unblockOperation(): void {\n        if (!this.formData.syncId) {\n            return;\n        }\n\n        CoreSync.unblockOperation(AddonModForumProvider.COMPONENT, this.formData.syncId);\n        delete this.formData.syncId;\n    }\n\n    /**\n     * Scroll to reply/edit form.\n     *\n     * @returns Promise resolved when done.\n     */\n    protected async scrollToForm(): Promise<void> {\n        await CoreDom.scrollToElement(\n            this.elementRef.nativeElement,\n            '#addon-forum-reply-edit-form-' + this.uniqueId,\n        );\n    }\n\n    /**\n     * Log analytics event.\n     *\n     * @param wsName WS name.\n     * @param url URL.\n     */\n    protected analyticsLogEvent(wsName: string, url: string): void {\n        if (this.post.id <= 0) {\n            return;\n        }\n\n        CoreAnalytics.logEvent({\n            type: CoreAnalyticsEventType.VIEW_ITEM,\n            ws: wsName,\n            name: this.post.subject,\n            data: { id: this.post.id, forumid: this.forum.id, category: 'forum' },\n            url,\n        });\n    }\n\n}\n","<div class=\"addon-mod_forum-post\">\n    <ng-container *ngIf=\"!formData.isEditing || !showForm\">\n        <ion-card-header class=\"ion-text-wrap ion-no-padding\" id=\"addon-mod_forum-post-{{post.id}}\">\n            <ion-item class=\"ion-text-wrap\" [class.highlight]=\"highlight\">\n                <ion-label>\n                    <div class=\"addon-mod-forum-post-title\" *ngIf=\"displaySubject\">\n                        <h2 class=\"ion-text-wrap\">\n                            <ion-icon name=\"fas-map-pin\" *ngIf=\"discussion && !post.parentid && discussion.pinned\"\n                                [attr.aria-label]=\"'addon.mod_forum.discussionpinned' | translate\" />\n                            <ion-icon name=\"fas-star\" class=\"addon-forum-star\" [attr.aria-label]=\"'addon.mod_forum.favourites' | translate\"\n                                *ngIf=\"discussion && !post.parentid && !discussion.pinned && discussion.starred\" />\n                            <core-format-text [text]=\"post.subject\" contextLevel=\"module\" [contextInstanceId]=\"forum && forum.cmid\"\n                                [courseId]=\"courseId\" />\n                        </h2>\n                        <ion-note *ngIf=\"trackPosts && post.unread\" class=\"ion-float-end ion-padding-start ion-text-end\"\n                            [attr.aria-label]=\"'addon.mod_forum.unread' | translate\">\n                            <ion-icon name=\"fas-circle\" color=\"primary\" aria-hidden=\"true\" />\n                        </ion-note>\n                        <ion-button *ngIf=\"optionsMenuEnabled\" fill=\"clear\" [attr.aria-label]=\"('core.displayoptions' | translate)\"\n                            (click)=\"showOptionsMenu($event)\">\n                            <ion-icon name=\"ellipsis-vertical\" slot=\"icon-only\" aria-hidden=\"true\" />\n                        </ion-button>\n                    </div>\n                    <div class=\"addon-mod-forum-post-info\">\n                        <core-user-avatar *ngIf=\"post.author && post.author.fullname\" [user]=\"post.author\" slot=\"start\"\n                            [courseId]=\"courseId\" />\n                        <div class=\"addon-mod-forum-post-author\">\n                            <span *ngIf=\"post.author && post.author.fullname\" class=\"core-discussionusername\">\n                                {{ post.author.fullname }}\n                            </span>\n                            <div *ngIf=\"post.author && post.author.groups\">\n                                <p *ngFor=\"let group of post.author.groups\" class=\"core-groupname\">\n                                    <ion-icon name=\"fas-users\" [attr.aria-label]=\"'addon.mod_forum.group' | translate\" />\n                                    <core-format-text [text]=\"group.name\" contextLevel=\"course\" [contextInstanceId]=\"courseId\"\n                                        [wsNotFiltered]=\"true\" />\n                                </p>\n                            </div>\n                            <p *ngIf=\"post.timecreated\">{{post.timecreated * 1000 | coreFormatDate: \"strftimerecentfull\"}}</p>\n                            <p *ngIf=\"!post.timecreated\">\n                                <ion-icon name=\"fas-clock\" aria-hidden=\"true\" /> {{ 'core.notsent' | translate }}\n                            </p>\n                        </div>\n                        <ng-container *ngIf=\"!displaySubject\">\n                            <ion-note *ngIf=\"trackPosts && post.unread\" class=\"ion-float-end ion-padding-start ion-text-end\"\n                                [attr.aria-label]=\"'addon.mod_forum.unread' | translate\">\n                                <ion-icon name=\"fas-circle\" color=\"primary\" aria-hidden=\"true\" />\n                            </ion-note>\n                            <ion-button *ngIf=\"optionsMenuEnabled\" fill=\"clear\" [attr.aria-label]=\"('core.displayoptions' | translate)\"\n                                (click)=\"showOptionsMenu($event)\">\n                                <ion-icon name=\"ellipsis-vertical\" slot=\"icon-only\" aria-hidden=\"true\" />\n                            </ion-button>\n                        </ng-container>\n                    </div>\n                </ion-label>\n            </ion-item>\n        </ion-card-header>\n        <ion-card-content [class]=\"post.parentid === 0 ? 'ion-padding-top' : ''\">\n            <div class=\"ion-padding-bottom\" *ngIf=\"post.isprivatereply\">\n                <ion-note color=\"danger\">{{ 'addon.mod_forum.postisprivatereply' | translate }}</ion-note>\n            </div>\n            <core-format-text [component]=\"component\" [componentId]=\"componentId\" [text]=\"post.message\" contextLevel=\"module\"\n                [contextInstanceId]=\"forum && forum.cmid\" [courseId]=\"courseId\" />\n            <p *ngIf=\"post.haswordcount && post.wordcount\">\n                <em>{{ 'core.numwords' | translate: {'$a': post.wordcount} }}</em>\n            </p>\n            <div *ngIf=\"post.attachments && post.attachments.length > 0\">\n                <core-files [files]=\"post.attachments\" [component]=\"component\" [componentId]=\"componentId\" showInline=\"true\" />\n            </div>\n        </ion-card-content>\n        <div class=\"addon-mod-forum-post-more-info\">\n            <ion-item class=\"ion-text-wrap\" *ngIf=\"tagsEnabled && post.tags && post.tags.length > 0\">\n                <div slot=\"start\">{{ 'core.tag.tags' | translate }}:</div>\n                <ion-label>\n                    <core-tag-list [tags]=\"post.tags\" />\n                </ion-label>\n            </ion-item>\n            <core-rating-rate *ngIf=\"forum && ratingInfo\" [ratingInfo]=\"ratingInfo\" contextLevel=\"module\" [instanceId]=\"componentId\"\n                [itemId]=\"post.id\" [itemSetId]=\"discussionId\" [courseId]=\"courseId\" [aggregateMethod]=\"forum.assessed\"\n                [scaleId]=\"forum.scale\" [userId]=\"post.author.id\" (onUpdate)=\"ratingUpdated()\" />\n            <core-rating-aggregate *ngIf=\"forum && ratingInfo\" [ratingInfo]=\"ratingInfo\" contextLevel=\"module\" [instanceId]=\"componentId\"\n                [itemId]=\"post.id\" [courseId]=\"courseId\" [aggregateMethod]=\"forum.assessed\" [scaleId]=\"forum.scale\" />\n\n            <ion-item *ngIf=\"post.id > 0 && post.capabilities.reply && !post.isprivatereply\"\n                class=\"ion-no-padding ion-text-end addon-forum-reply-button\">\n                <ion-label>\n                    <ion-button fill=\"clear\" size=\"small\" [attr.aria-controls]=\"'addon-forum-reply-edit-form-' + uniqueId\"\n                        [attr.aria-expanded]=\"formData.replyingTo === post.id\" (click)=\"showReplyForm($event)\">\n                        <ion-icon name=\"fas-reply\" slot=\"start\" aria-hidden=\"true\" />\n                        {{ 'addon.mod_forum.reply' | translate }}\n                    </ion-button>\n                </ion-label>\n            </ion-item>\n        </div>\n    </ng-container>\n\n    <form *ngIf=\"showForm\" [id]=\"'addon-forum-reply-edit-form-' + uniqueId\" #replyFormEl>\n        <ion-item>\n            <ion-label position=\"stacked\">{{ 'addon.mod_forum.subject' | translate }}</ion-label>\n            <ion-input type=\"text\" [placeholder]=\"'addon.mod_forum.subject' | translate\" [(ngModel)]=\"formData.subject\" name=\"subject\" />\n        </ion-item>\n        <ion-item>\n            <ion-label position=\"stacked\">{{ 'addon.mod_forum.message' | translate }}</ion-label>\n            <core-rich-text-editor elementId=\"message\" contextLevel=\"module\" [control]=\"messageControl\"\n                [placeholder]=\"'addon.mod_forum.replyplaceholder' | translate\" [name]=\"'mod_forum_reply_' + post.id\" [component]=\"component\"\n                [componentId]=\"componentId\" [autoSave]=\"true\" [contextInstanceId]=\"forum && forum.cmid\"\n                [draftExtraParams]=\"{reply: post.id}\" (contentChanged)=\"onMessageChange($event)\" />\n        </ion-item>\n        <ion-item class=\"ion-text-wrap\" *ngIf=\"accessInfo.canpostprivatereply\">\n            <ion-label>{{ 'addon.mod_forum.privatereply' | translate }}</ion-label>\n            <ion-checkbox slot=\"end\" [(ngModel)]=\"formData.isprivatereply\" name=\"isprivatereply\" />\n        </ion-item>\n        <ng-container *ngIf=\"forum.id && forum.maxattachments > 0\">\n            <ion-item button class=\"divider ion-text-wrap\" (click)=\"toggleAdvanced()\" [detail]=\"false\" [attr.aria-expanded]=\"advanced\"\n                [attr.aria-controls]=\"'addon-forum-reply-edit-form-advanced-' + uniqueId\"\n                [attr.aria-label]=\"(advanced ? 'core.hideadvanced' : 'core.showadvanced') | translate\">\n                <ion-icon *ngIf=\"!advanced\" name=\"fas-chevron-right\" flip-rtl slot=\"start\" aria-hidden=\"true\"\n                    class=\"expandable-status-icon\" />\n                <ion-icon *ngIf=\"advanced\" name=\"fas-chevron-down\" slot=\"start\" aria-hidden=\"true\" class=\"expandable-status-icon\" />\n                <ion-label>\n                    <h3 class=\"item-heading\">{{ 'addon.mod_forum.advanced' | translate }}</h3>\n                </ion-label>\n            </ion-item>\n            <div *ngIf=\"advanced\" [id]=\"'addon-forum-reply-edit-form-advanced-' + uniqueId\">\n                <core-attachments [files]=\"formData.files\" [maxSize]=\"forum.maxbytes\" [maxSubmissions]=\"forum.maxattachments\"\n                    [component]=\"component\" [componentId]=\"forum.cmid\" [allowOffline]=\"true\" [courseId]=\"courseId\" />\n            </div>\n        </ng-container>\n        <ion-grid>\n            <ion-row>\n                <ion-col>\n                    <ion-button expand=\"block\" fill=\"outline\" (click)=\"cancel()\">{{ 'core.cancel' | translate }}</ion-button>\n                </ion-col>\n                <ion-col>\n                    <ion-button expand=\"block\" (click)=\"send()\" [disabled]=\"formData.subject === '' || formData.message === null\">\n                        <span *ngIf=\"formData.isEditing\">{{ 'core.savechanges' | translate }}</span>\n                        <span *ngIf=\"!formData.isEditing\">{{ 'addon.mod_forum.posttoforum' | translate }}</span>\n                    </ion-button>\n                </ion-col>\n            </ion-row>\n        </ion-grid>\n    </form>\n</div>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
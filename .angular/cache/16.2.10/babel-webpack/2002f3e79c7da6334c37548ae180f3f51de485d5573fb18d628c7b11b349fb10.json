{"ast":null,"code":"import _asyncToGenerator from \"/home/toon/works/gitionic7/ionic-github/ionic/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _class;\nimport { CoreContentLinksHandlerBase } from '@features/contentlinks/classes/base-handler';\nimport { CoreGrades } from '@features/grades/services/grades';\nimport { CoreGradesHelper } from '@features/grades/services/grades-helper';\nimport { makeSingleton } from '@singletons';\nimport * as i0 from \"@angular/core\";\n/**\n * Handler to treat links to user grades.\n */\nexport class CoreGradesReportLinkHandlerService extends CoreContentLinksHandlerBase {\n  constructor() {\n    super(...arguments);\n    this.name = 'CoreGradesReportLinkHandler';\n    this.pattern = /\\/grade\\/report(\\/user)?\\/index.php/;\n  }\n  /**\n   * @inheritdoc\n   */\n  getActions(siteIds, url, params, courseId, data) {\n    const courseIdentifier = courseId || Number(params.id);\n    data = data || {};\n    return [{\n      action: siteId => {\n        var _data;\n        const userId = params.userid ? parseInt(params.userid, 10) : undefined;\n        const moduleId = ((_data = data) === null || _data === void 0 ? void 0 : _data.cmid) && parseInt(data.cmid, 10) || undefined;\n        CoreGradesHelper.goToGrades(courseIdentifier, userId, moduleId, siteId);\n      }\n    }];\n  }\n  /**\n   * @inheritdoc\n   */\n  isEnabled(siteId, url, params, courseId) {\n    return _asyncToGenerator(function* () {\n      if (!courseId && !params.id) {\n        return false;\n      }\n      return CoreGrades.isPluginEnabledForCourse(courseId || Number(params.id), siteId);\n    })();\n  }\n}\n_class = CoreGradesReportLinkHandlerService;\n_class.ɵfac = /*@__PURE__*/function () {\n  let ɵCoreGradesReportLinkHandlerService_BaseFactory;\n  return function CoreGradesReportLinkHandlerService_Factory(t) {\n    return (ɵCoreGradesReportLinkHandlerService_BaseFactory || (ɵCoreGradesReportLinkHandlerService_BaseFactory = i0.ɵɵgetInheritedFactory(_class)))(t || _class);\n  };\n}();\n_class.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: _class,\n  factory: _class.ɵfac,\n  providedIn: 'root'\n});\nexport const CoreGradesReportLinkHandler = makeSingleton(CoreGradesReportLinkHandlerService);","map":{"version":3,"names":["CoreContentLinksHandlerBase","CoreGrades","CoreGradesHelper","makeSingleton","CoreGradesReportLinkHandlerService","constructor","name","pattern","getActions","siteIds","url","params","courseId","data","courseIdentifier","Number","id","action","siteId","_data","userId","userid","parseInt","undefined","moduleId","cmid","goToGrades","isEnabled","_asyncToGenerator","isPluginEnabledForCourse","t","factory","ɵfac","providedIn","CoreGradesReportLinkHandler"],"sources":["/home/toon/works/gitionic7/ionic-github/ionic/src/core/features/grades/services/handlers/report-link.ts"],"sourcesContent":["// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Injectable } from '@angular/core';\n\nimport { CoreContentLinksAction } from '@features/contentlinks/services/contentlinks-delegate';\nimport { CoreContentLinksHandlerBase } from '@features/contentlinks/classes/base-handler';\nimport { CoreGrades } from '@features/grades/services/grades';\nimport { CoreGradesHelper } from '@features/grades/services/grades-helper';\nimport { makeSingleton } from '@singletons';\n\n/**\n * Handler to treat links to user grades.\n */\n@Injectable({ providedIn: 'root' })\nexport class CoreGradesReportLinkHandlerService extends CoreContentLinksHandlerBase {\n\n    name = 'CoreGradesReportLinkHandler';\n    pattern = /\\/grade\\/report(\\/user)?\\/index.php/;\n\n    /**\n     * @inheritdoc\n     */\n    getActions(\n        siteIds: string[],\n        url: string,\n        params: Record<string, string>,\n        courseId?: number,\n        data?: { cmid?: string },\n    ): CoreContentLinksAction[] | Promise<CoreContentLinksAction[]> {\n        const courseIdentifier = courseId || Number(params.id);\n        data = data || {};\n\n        return [{\n            action: (siteId): void => {\n                const userId = params.userid ? parseInt(params.userid, 10) : undefined;\n                const moduleId = data?.cmid && parseInt(data.cmid, 10) || undefined;\n\n                CoreGradesHelper.goToGrades(courseIdentifier, userId, moduleId, siteId);\n            },\n        }];\n    }\n\n    /**\n     * @inheritdoc\n     */\n    async isEnabled(siteId: string, url: string, params: Record<string, string>, courseId?: number): Promise<boolean> {\n        if (!courseId && !params.id) {\n            return false;\n        }\n\n        return CoreGrades.isPluginEnabledForCourse(courseId || Number(params.id), siteId);\n    }\n\n}\n\nexport const CoreGradesReportLinkHandler = makeSingleton(CoreGradesReportLinkHandlerService);\n"],"mappings":";;AAiBA,SAASA,2BAA2B,QAAQ,6CAA6C;AACzF,SAASC,UAAU,QAAQ,kCAAkC;AAC7D,SAASC,gBAAgB,QAAQ,yCAAyC;AAC1E,SAASC,aAAa,QAAQ,aAAa;;AAE3C;;;AAIA,OAAM,MAAOC,kCAAmC,SAAQJ,2BAA2B;EADnFK,YAAA;;IAGI,KAAAC,IAAI,GAAG,6BAA6B;IACpC,KAAAC,OAAO,GAAG,qCAAqC;;EAE/C;;;EAGAC,UAAUA,CACNC,OAAiB,EACjBC,GAAW,EACXC,MAA8B,EAC9BC,QAAiB,EACjBC,IAAwB;IAExB,MAAMC,gBAAgB,GAAGF,QAAQ,IAAIG,MAAM,CAACJ,MAAM,CAACK,EAAE,CAAC;IACtDH,IAAI,GAAGA,IAAI,IAAI,EAAE;IAEjB,OAAO,CAAC;MACJI,MAAM,EAAGC,MAAM,IAAU;QAAA,IAAAC,KAAA;QACrB,MAAMC,MAAM,GAAGT,MAAM,CAACU,MAAM,GAAGC,QAAQ,CAACX,MAAM,CAACU,MAAM,EAAE,EAAE,CAAC,GAAGE,SAAS;QACtE,MAAMC,QAAQ,GAAG,EAAAL,KAAA,GAAAN,IAAI,cAAAM,KAAA,uBAAJA,KAAA,CAAMM,IAAI,KAAIH,QAAQ,CAACT,IAAI,CAACY,IAAI,EAAE,EAAE,CAAC,IAAIF,SAAS;QAEnErB,gBAAgB,CAACwB,UAAU,CAACZ,gBAAgB,EAAEM,MAAM,EAAEI,QAAQ,EAAEN,MAAM,CAAC;MAC3E;KACH,CAAC;EACN;EAEA;;;EAGMS,SAASA,CAACT,MAAc,EAAER,GAAW,EAAEC,MAA8B,EAAEC,QAAiB;IAAA,OAAAgB,iBAAA;MAC1F,IAAI,CAAChB,QAAQ,IAAI,CAACD,MAAM,CAACK,EAAE,EAAE;QACzB,OAAO,KAAK;;MAGhB,OAAOf,UAAU,CAAC4B,wBAAwB,CAACjB,QAAQ,IAAIG,MAAM,CAACJ,MAAM,CAACK,EAAE,CAAC,EAAEE,MAAM,CAAC;IAAC;EACtF;;SArCSd,kCAAmC;;;;2IAAnCA,MAAkC,IAAA0B,CAAA,IAAlC1B,MAAkC;EAAA;AAAA;;SAAlCA,MAAkC;EAAA2B,OAAA,EAAlC3B,MAAkC,CAAA4B,IAAA;EAAAC,UAAA,EADrB;AAAM;AA0ChC,OAAO,MAAMC,2BAA2B,GAAG/B,aAAa,CAACC,kCAAkC,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}
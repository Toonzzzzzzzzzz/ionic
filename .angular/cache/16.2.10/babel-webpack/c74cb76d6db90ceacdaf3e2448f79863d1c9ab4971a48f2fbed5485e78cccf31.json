{"ast":null,"code":"import _asyncToGenerator from \"/home/toon/works/gitionic7/ionic-github/ionic/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _class;\nimport { CoreContentLinksHandlerBase } from '@features/contentlinks/classes/base-handler';\nimport { CoreCourse } from '@features/course/services/course';\nimport { CoreNavigator } from '@services/navigator';\nimport { CoreDomUtils } from '@services/utils/dom';\nimport { makeSingleton } from '@singletons';\nimport { AddonModGlossary } from '../glossary';\nimport { AddonModGlossaryModuleHandlerService } from './module';\nimport * as i0 from \"@angular/core\";\n/**\n * Handler to treat links to glossary entries.\n */\nexport class AddonModGlossaryEntryLinkHandlerService extends CoreContentLinksHandlerBase {\n  constructor() {\n    super(...arguments);\n    this.name = 'AddonModGlossaryEntryLinkHandler';\n    this.featureName = 'CoreCourseModuleDelegate_AddonModGlossary';\n    this.pattern = /\\/mod\\/glossary\\/(showentry|view)\\.php.*([&?](eid|g|mode|hook)=\\d+)/;\n  }\n  /**\n   * @inheritdoc\n   */\n  getActions(siteIds, url, params) {\n    return [{\n      action: function () {\n        var _ref = _asyncToGenerator(function* (siteId) {\n          const modal = yield CoreDomUtils.showModalLoading();\n          try {\n            const entryId = params.mode == 'entry' ? Number(params.hook) : Number(params.eid);\n            const response = yield AddonModGlossary.getEntry(entryId, {\n              siteId,\n              readingStrategy: 1 /* CoreSitesReadingStrategy.PREFER_CACHE */\n            });\n            const module = yield CoreCourse.getModuleBasicInfoByInstance(response.entry.glossaryid, 'glossary', {\n              siteId,\n              readingStrategy: 1 /* CoreSitesReadingStrategy.PREFER_CACHE */\n            });\n            yield CoreNavigator.navigateToSitePath(`${AddonModGlossaryModuleHandlerService.PAGE_NAME}/entry/${entryId}`, {\n              siteId,\n              params: {\n                courseId: module.course,\n                cmId: module.id\n              }\n            });\n          } catch (error) {\n            CoreDomUtils.showErrorModalDefault(error, 'addon.mod_glossary.errorloadingentry', true);\n          } finally {\n            modal.dismiss();\n          }\n        });\n        return function action(_x) {\n          return _ref.apply(this, arguments);\n        };\n      }()\n    }];\n  }\n}\n_class = AddonModGlossaryEntryLinkHandlerService;\n_class.ɵfac = /*@__PURE__*/function () {\n  let ɵAddonModGlossaryEntryLinkHandlerService_BaseFactory;\n  return function AddonModGlossaryEntryLinkHandlerService_Factory(t) {\n    return (ɵAddonModGlossaryEntryLinkHandlerService_BaseFactory || (ɵAddonModGlossaryEntryLinkHandlerService_BaseFactory = i0.ɵɵgetInheritedFactory(_class)))(t || _class);\n  };\n}();\n_class.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: _class,\n  factory: _class.ɵfac,\n  providedIn: 'root'\n});\nexport const AddonModGlossaryEntryLinkHandler = makeSingleton(AddonModGlossaryEntryLinkHandlerService);","map":{"version":3,"names":["CoreContentLinksHandlerBase","CoreCourse","CoreNavigator","CoreDomUtils","makeSingleton","AddonModGlossary","AddonModGlossaryModuleHandlerService","AddonModGlossaryEntryLinkHandlerService","constructor","name","featureName","pattern","getActions","siteIds","url","params","action","_ref","_asyncToGenerator","siteId","modal","showModalLoading","entryId","mode","Number","hook","eid","response","getEntry","readingStrategy","module","getModuleBasicInfoByInstance","entry","glossaryid","navigateToSitePath","PAGE_NAME","courseId","course","cmId","id","error","showErrorModalDefault","dismiss","_x","apply","arguments","t","factory","ɵfac","providedIn","AddonModGlossaryEntryLinkHandler"],"sources":["/home/toon/works/gitionic7/ionic-github/ionic/src/addons/mod/glossary/services/handlers/entry-link.ts"],"sourcesContent":["// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Injectable } from '@angular/core';\nimport { CoreContentLinksHandlerBase } from '@features/contentlinks/classes/base-handler';\nimport { CoreContentLinksAction } from '@features/contentlinks/services/contentlinks-delegate';\nimport { CoreCourse } from '@features/course/services/course';\nimport { CoreNavigator } from '@services/navigator';\nimport { CoreSitesReadingStrategy } from '@services/sites';\nimport { CoreDomUtils } from '@services/utils/dom';\nimport { makeSingleton } from '@singletons';\nimport { AddonModGlossary } from '../glossary';\nimport { AddonModGlossaryModuleHandlerService } from './module';\n\n/**\n * Handler to treat links to glossary entries.\n */\n@Injectable({ providedIn: 'root' })\nexport class AddonModGlossaryEntryLinkHandlerService extends CoreContentLinksHandlerBase {\n\n    name = 'AddonModGlossaryEntryLinkHandler';\n    featureName = 'CoreCourseModuleDelegate_AddonModGlossary';\n    pattern = /\\/mod\\/glossary\\/(showentry|view)\\.php.*([&?](eid|g|mode|hook)=\\d+)/;\n\n    /**\n     * @inheritdoc\n     */\n    getActions(siteIds: string[], url: string, params: Record<string, string>): CoreContentLinksAction[] {\n        return [{\n            action: async (siteId: string) => {\n                const modal = await CoreDomUtils.showModalLoading();\n\n                try {\n                    const entryId = params.mode == 'entry' ? Number(params.hook) : Number(params.eid);\n\n                    const response = await AddonModGlossary.getEntry(\n                        entryId,\n                        { siteId, readingStrategy: CoreSitesReadingStrategy.PREFER_CACHE },\n                    );\n\n                    const module = await CoreCourse.getModuleBasicInfoByInstance(\n                        response.entry.glossaryid,\n                        'glossary',\n                        { siteId, readingStrategy: CoreSitesReadingStrategy.PREFER_CACHE },\n                    );\n\n                    await CoreNavigator.navigateToSitePath(\n                        `${AddonModGlossaryModuleHandlerService.PAGE_NAME}/entry/${entryId}`,\n                        {\n                            siteId,\n                            params: {\n                                courseId: module.course,\n                                cmId: module.id,\n                            },\n                        },\n                    );\n                } catch (error) {\n                    CoreDomUtils.showErrorModalDefault(error, 'addon.mod_glossary.errorloadingentry', true);\n                } finally {\n                    modal.dismiss();\n                }\n            },\n        }];\n    }\n\n}\n\nexport const AddonModGlossaryEntryLinkHandler = makeSingleton(AddonModGlossaryEntryLinkHandlerService);\n"],"mappings":";;AAeA,SAASA,2BAA2B,QAAQ,6CAA6C;AAEzF,SAASC,UAAU,QAAQ,kCAAkC;AAC7D,SAASC,aAAa,QAAQ,qBAAqB;AAEnD,SAASC,YAAY,QAAQ,qBAAqB;AAClD,SAASC,aAAa,QAAQ,aAAa;AAC3C,SAASC,gBAAgB,QAAQ,aAAa;AAC9C,SAASC,oCAAoC,QAAQ,UAAU;;AAE/D;;;AAIA,OAAM,MAAOC,uCAAwC,SAAQP,2BAA2B;EADxFQ,YAAA;;IAGI,KAAAC,IAAI,GAAG,kCAAkC;IACzC,KAAAC,WAAW,GAAG,2CAA2C;IACzD,KAAAC,OAAO,GAAG,qEAAqE;;EAE/E;;;EAGAC,UAAUA,CAACC,OAAiB,EAAEC,GAAW,EAAEC,MAA8B;IACrE,OAAO,CAAC;MACJC,MAAM;QAAA,IAAAC,IAAA,GAAAC,iBAAA,CAAE,WAAOC,MAAc,EAAI;UAC7B,MAAMC,KAAK,SAASjB,YAAY,CAACkB,gBAAgB,EAAE;UAEnD,IAAI;YACA,MAAMC,OAAO,GAAGP,MAAM,CAACQ,IAAI,IAAI,OAAO,GAAGC,MAAM,CAACT,MAAM,CAACU,IAAI,CAAC,GAAGD,MAAM,CAACT,MAAM,CAACW,GAAG,CAAC;YAEjF,MAAMC,QAAQ,SAAStB,gBAAgB,CAACuB,QAAQ,CAC5CN,OAAO,EACP;cAAEH,MAAM;cAAEU,eAAe;YAAuC,CAAE,CACrE;YAED,MAAMC,MAAM,SAAS7B,UAAU,CAAC8B,4BAA4B,CACxDJ,QAAQ,CAACK,KAAK,CAACC,UAAU,EACzB,UAAU,EACV;cAAEd,MAAM;cAAEU,eAAe;YAAuC,CAAE,CACrE;YAED,MAAM3B,aAAa,CAACgC,kBAAkB,CAClC,GAAG5B,oCAAoC,CAAC6B,SAAS,UAAUb,OAAO,EAAE,EACpE;cACIH,MAAM;cACNJ,MAAM,EAAE;gBACJqB,QAAQ,EAAEN,MAAM,CAACO,MAAM;gBACvBC,IAAI,EAAER,MAAM,CAACS;;aAEpB,CACJ;WACJ,CAAC,OAAOC,KAAK,EAAE;YACZrC,YAAY,CAACsC,qBAAqB,CAACD,KAAK,EAAE,sCAAsC,EAAE,IAAI,CAAC;WAC1F,SAAS;YACNpB,KAAK,CAACsB,OAAO,EAAE;;QAEvB,CAAC;QAAA,gBAAA1B,OAAA2B,EAAA;UAAA,OAAA1B,IAAA,CAAA2B,KAAA,OAAAC,SAAA;QAAA;MAAA;KACJ,CAAC;EACN;;SA7CStC,uCAAwC;;;;qJAAxCA,MAAuC,IAAAuC,CAAA,IAAvCvC,MAAuC;EAAA;AAAA;;SAAvCA,MAAuC;EAAAwC,OAAA,EAAvCxC,MAAuC,CAAAyC,IAAA;EAAAC,UAAA,EAD1B;AAAM;AAkDhC,OAAO,MAAMC,gCAAgC,GAAG9C,aAAa,CAACG,uCAAuC,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}
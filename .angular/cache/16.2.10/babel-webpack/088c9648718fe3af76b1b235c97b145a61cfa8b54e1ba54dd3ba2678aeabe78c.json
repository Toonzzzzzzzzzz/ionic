{"ast":null,"code":"import _asyncToGenerator from \"/home/toon/works/gitionic7/ionic-github/ionic/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _class;\nimport { CoreBlockBaseComponent } from '@features/block/classes/base-block-component';\nimport { CoreBlockDelegate } from '@features/block/services/block-delegate';\nimport { CoreSitePlugins } from '@features/siteplugins/services/siteplugins';\nimport { CoreSitePluginsPluginContentComponent } from '../plugin-content/plugin-content';\nimport * as i0 from \"@angular/core\";\nfunction CoreSitePluginsBlockComponent_core_site_plugins_plugin_content_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"core-site-plugins-plugin-content\", 1);\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"component\", ctx_r0.component)(\"method\", ctx_r0.method)(\"args\", ctx_r0.args)(\"initResult\", ctx_r0.initResult);\n  }\n}\n/**\n * Component that displays the index of a course format site plugin.\n */\nexport class CoreSitePluginsBlockComponent extends CoreBlockBaseComponent {\n  constructor() {\n    super('CoreSitePluginsBlockComponent');\n  }\n  /**\n   * Detect changes on input properties.\n   */\n  ngOnChanges() {\n    if (this.component) {\n      return;\n    }\n    // Initialize the data.\n    const handlerName = CoreBlockDelegate.getHandlerName(this.block.name);\n    const handler = CoreSitePlugins.getSitePluginHandler(handlerName);\n    if (!handler) {\n      return;\n    }\n    this.component = handler.plugin.component;\n    this.method = handler.handlerSchema.method;\n    this.args = {\n      contextlevel: this.contextLevel,\n      instanceid: this.instanceId,\n      blockid: this.block.instanceid\n    };\n    this.initResult = handler.initResult;\n  }\n  /**\n   * Invalidate block data.\n   *\n   * @returns Promise resolved when done.\n   */\n  invalidateContent() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      if (!_this.component || !_this.method) {\n        return;\n      }\n      return CoreSitePlugins.invalidateContent(_this.component, _this.method, _this.args);\n    })();\n  }\n}\n_class = CoreSitePluginsBlockComponent;\n_class.ɵfac = function CoreSitePluginsBlockComponent_Factory(t) {\n  return new (t || _class)();\n};\n_class.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: _class,\n  selectors: [[\"core-site-plugins-block\"]],\n  viewQuery: function CoreSitePluginsBlockComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(CoreSitePluginsPluginContentComponent, 5);\n    }\n    if (rf & 2) {\n      let _t;\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.content = _t.first);\n    }\n  },\n  hostVars: 2,\n  hostBindings: function CoreSitePluginsBlockComponent_HostBindings(rf, ctx) {\n    if (rf & 2) {\n      i0.ɵɵclassMap(ctx.component);\n    }\n  },\n  features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature],\n  decls: 1,\n  vars: 1,\n  consts: [[3, \"component\", \"method\", \"args\", \"initResult\", 4, \"ngIf\"], [3, \"component\", \"method\", \"args\", \"initResult\"]],\n  template: function CoreSitePluginsBlockComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵtemplate(0, CoreSitePluginsBlockComponent_core_site_plugins_plugin_content_0_Template, 1, 4, \"core-site-plugins-plugin-content\", 0);\n    }\n    if (rf & 2) {\n      i0.ɵɵproperty(\"ngIf\", ctx.component && ctx.method);\n    }\n  },\n  styles: [\"[_nghost-%COMP%] { display: contents; }\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9jb3JlL2ZlYXR1cmVzL3NpdGVwbHVnaW5zL2NvbXBvbmVudHMvYmxvY2svYmxvY2sudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsUUFBUSxpQkFBaUIsRUFBRSIsInNvdXJjZXNDb250ZW50IjpbIjpob3N0IHsgZGlzcGxheTogY29udGVudHM7IH0iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n});","map":{"version":3,"names":["CoreBlockBaseComponent","CoreBlockDelegate","CoreSitePlugins","CoreSitePluginsPluginContentComponent","i0","ɵɵelement","ɵɵproperty","ctx_r0","component","method","args","initResult","CoreSitePluginsBlockComponent","constructor","ngOnChanges","handlerName","getHandlerName","block","name","handler","getSitePluginHandler","plugin","handlerSchema","contextlevel","contextLevel","instanceid","instanceId","blockid","invalidateContent","_this","_asyncToGenerator","selectors","viewQuery","CoreSitePluginsBlockComponent_Query","rf","ctx","ɵɵtemplate","CoreSitePluginsBlockComponent_core_site_plugins_plugin_content_0_Template"],"sources":["/home/toon/works/gitionic7/ionic-github/ionic/src/core/features/siteplugins/components/block/block.ts","/home/toon/works/gitionic7/ionic-github/ionic/src/core/features/siteplugins/components/block/core-siteplugins-block.html"],"sourcesContent":["// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Component, HostBinding, OnChanges, ViewChild } from '@angular/core';\n\nimport { CoreBlockBaseComponent } from '@features/block/classes/base-block-component';\nimport { CoreBlockDelegate } from '@features/block/services/block-delegate';\nimport { CoreSitePlugins, CoreSitePluginsContent } from '@features/siteplugins/services/siteplugins';\nimport { CoreSitePluginsPluginContentComponent } from '../plugin-content/plugin-content';\n\n/**\n * Component that displays the index of a course format site plugin.\n */\n@Component({\n    selector: 'core-site-plugins-block',\n    templateUrl: 'core-siteplugins-block.html',\n    styles: [':host { display: contents; }'],\n})\nexport class CoreSitePluginsBlockComponent extends CoreBlockBaseComponent implements OnChanges {\n\n    @ViewChild(CoreSitePluginsPluginContentComponent) content?: CoreSitePluginsPluginContentComponent;\n\n    @HostBinding('class') component?: string;\n    method?: string;\n    args?: Record<string, unknown>;\n    initResult?: CoreSitePluginsContent | null;\n\n    constructor() {\n        super('CoreSitePluginsBlockComponent');\n    }\n\n    /**\n     * Detect changes on input properties.\n     */\n    ngOnChanges(): void {\n        if (this.component) {\n            return;\n        }\n\n        // Initialize the data.\n        const handlerName = CoreBlockDelegate.getHandlerName(this.block.name);\n        const handler = CoreSitePlugins.getSitePluginHandler(handlerName);\n        if (!handler) {\n            return;\n        }\n\n        this.component = handler.plugin.component;\n        this.method = handler.handlerSchema.method;\n        this.args = {\n            contextlevel: this.contextLevel,\n            instanceid: this.instanceId,\n            blockid: this.block.instanceid,\n        };\n        this.initResult = handler.initResult;\n    }\n\n    /**\n     * Invalidate block data.\n     *\n     * @returns Promise resolved when done.\n     */\n    async invalidateContent(): Promise<void> {\n        if (!this.component || !this.method) {\n            return;\n        }\n\n        return CoreSitePlugins.invalidateContent(this.component, this.method, this.args);\n    }\n\n}\n","<core-site-plugins-plugin-content *ngIf=\"component && method\" [component]=\"component\" [method]=\"method\" [args]=\"args\"\n    [initResult]=\"initResult\" />\n"],"mappings":";;AAgBA,SAASA,sBAAsB,QAAQ,8CAA8C;AACrF,SAASC,iBAAiB,QAAQ,yCAAyC;AAC3E,SAASC,eAAe,QAAgC,4CAA4C;AACpG,SAASC,qCAAqC,QAAQ,kCAAkC;;;;ICnBxFC,EAAA,CAAAC,SAAA,0CACgC;;;;IAD8BD,EAAA,CAAAE,UAAA,cAAAC,MAAA,CAAAC,SAAA,CAAuB,WAAAD,MAAA,CAAAE,MAAA,UAAAF,MAAA,CAAAG,IAAA,gBAAAH,MAAA,CAAAI,UAAA;;;ADqBrF;;;AAQA,OAAM,MAAOC,6BAA8B,SAAQZ,sBAAsB;EASrEa,YAAA;IACI,KAAK,CAAC,+BAA+B,CAAC;EAC1C;EAEA;;;EAGAC,WAAWA,CAAA;IACP,IAAI,IAAI,CAACN,SAAS,EAAE;MAChB;;IAGJ;IACA,MAAMO,WAAW,GAAGd,iBAAiB,CAACe,cAAc,CAAC,IAAI,CAACC,KAAK,CAACC,IAAI,CAAC;IACrE,MAAMC,OAAO,GAAGjB,eAAe,CAACkB,oBAAoB,CAACL,WAAW,CAAC;IACjE,IAAI,CAACI,OAAO,EAAE;MACV;;IAGJ,IAAI,CAACX,SAAS,GAAGW,OAAO,CAACE,MAAM,CAACb,SAAS;IACzC,IAAI,CAACC,MAAM,GAAGU,OAAO,CAACG,aAAa,CAACb,MAAM;IAC1C,IAAI,CAACC,IAAI,GAAG;MACRa,YAAY,EAAE,IAAI,CAACC,YAAY;MAC/BC,UAAU,EAAE,IAAI,CAACC,UAAU;MAC3BC,OAAO,EAAE,IAAI,CAACV,KAAK,CAACQ;KACvB;IACD,IAAI,CAACd,UAAU,GAAGQ,OAAO,CAACR,UAAU;EACxC;EAEA;;;;;EAKMiB,iBAAiBA,CAAA;IAAA,IAAAC,KAAA;IAAA,OAAAC,iBAAA;MACnB,IAAI,CAACD,KAAI,CAACrB,SAAS,IAAI,CAACqB,KAAI,CAACpB,MAAM,EAAE;QACjC;;MAGJ,OAAOP,eAAe,CAAC0B,iBAAiB,CAACC,KAAI,CAACrB,SAAS,EAAEqB,KAAI,CAACpB,MAAM,EAAEoB,KAAI,CAACnB,IAAI,CAAC;IAAC;EACrF;;SAjDSE,6BAA8B;;mBAA9BA,MAA6B;AAAA;;QAA7BA,MAA6B;EAAAmB,SAAA;EAAAC,SAAA,WAAAC,oCAAAC,EAAA,EAAAC,GAAA;IAAA,IAAAD,EAAA;qBAE3B/B,qCAAqC;;;;;;;;;;;;;;;;;;;MC/BpDC,EAAA,CAAAgC,UAAA,IAAAC,yEAAA,8CACgC;;;MADGjC,EAAA,CAAAE,UAAA,SAAA6B,GAAA,CAAA3B,SAAA,IAAA2B,GAAA,CAAA1B,MAAA,CAAyB"},"metadata":{},"sourceType":"module","externalDependencies":[]}
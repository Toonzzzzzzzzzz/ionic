{"ast":null,"code":"import _asyncToGenerator from \"/home/toon/works/gitionic7/ionic-github/ionic/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _class;\nimport { FormGroup } from '@angular/forms';\nimport { CoreCourse } from '@features/course/services/course';\nimport { CoreGradesHelper } from '@features/grades/services/grades-helper';\nimport { CoreUser } from '@features/user/services/user';\nimport { CoreNavigator } from '@services/navigator';\nimport { CoreSites } from '@services/sites';\nimport { CoreSync } from '@services/sync';\nimport { CoreDomUtils } from '@services/utils/dom';\nimport { CoreTextUtils } from '@services/utils/text';\nimport { Translate } from '@singletons';\nimport { CoreEvents } from '@singletons/events';\nimport { CoreForms } from '@singletons/form';\nimport { AddonModWorkshopAssessmentStrategyComponent } from '../../components/assessment-strategy/assessment-strategy';\nimport { AddonModWorkshopProvider, AddonModWorkshop, AddonModWorkshopPhase, AddonModWorkshopAction } from '../../services/workshop';\nimport { AddonModWorkshopHelper } from '../../services/workshop-helper';\nimport { AddonModWorkshopOffline } from '../../services/workshop-offline';\nimport { AddonModWorkshopSyncProvider } from '../../services/workshop-sync';\nimport { CoreAnalytics, CoreAnalyticsEventType } from '@services/analytics';\nimport { CoreTime } from '@singletons/time';\nimport { ADDON_MOD_WORKSHOP_COMPONENT } from '@addons/mod/workshop/constants';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"@ionic/angular\";\nconst _c0 = [\"feedbackFormEl\"];\nfunction AddonModWorkshopSubmissionPage_core_format_text_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"core-format-text\", 11);\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"text\", ctx_r0.title)(\"contextInstanceId\", ctx_r0.module.id)(\"courseId\", ctx_r0.courseId);\n  }\n}\nfunction AddonModWorkshopSubmissionPage_ion_button_9_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r13 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-button\", 12);\n    i0.ɵɵlistener(\"click\", function AddonModWorkshopSubmissionPage_ion_button_9_Template_ion_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r12 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r12.saveAssessment());\n    });\n    i0.ɵɵpipe(1, \"translate\");\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵattribute(\"aria-label\", i0.ɵɵpipeBind1(1, 2, \"core.save\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(3, 4, \"core.save\"), \" \");\n  }\n}\nfunction AddonModWorkshopSubmissionPage_ion_button_10_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r15 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-button\", 12);\n    i0.ɵɵlistener(\"click\", function AddonModWorkshopSubmissionPage_ion_button_10_Template_ion_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r14 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r14.saveEvaluation());\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(2, 1, \"core.save\"), \" \");\n  }\n}\nfunction AddonModWorkshopSubmissionPage_ion_refresher_12_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r17 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-refresher\", 13);\n    i0.ɵɵlistener(\"ionRefresh\", function AddonModWorkshopSubmissionPage_ion_refresher_12_Template_ion_refresher_ionRefresh_0_listener($event) {\n      i0.ɵɵrestoreView(_r17);\n      const ctx_r16 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r16.refreshSubmission($event.target));\n    });\n    i0.ɵɵelement(1, \"ion-refresher-content\", 14);\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"disabled\", !ctx_r3.loaded);\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate(\"pullingText\", i0.ɵɵpipeBind1(2, 2, \"core.pulltorefresh\"));\n  }\n}\nfunction AddonModWorkshopSubmissionPage_ion_list_14_ion_item_2_ion_button_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r23 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-button\", 21);\n    i0.ɵɵlistener(\"click\", function AddonModWorkshopSubmissionPage_ion_list_14_ion_item_2_ion_button_2_Template_ion_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r23);\n      const ctx_r22 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r22.editSubmission());\n    });\n    i0.ɵɵelement(1, \"ion-icon\", 22);\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(3, 1, \"addon.mod_workshop.editsubmission\"), \" \");\n  }\n}\nfunction AddonModWorkshopSubmissionPage_ion_list_14_ion_item_2_ion_button_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r25 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-button\", 23);\n    i0.ɵɵlistener(\"click\", function AddonModWorkshopSubmissionPage_ion_list_14_ion_item_2_ion_button_3_Template_ion_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r25);\n      const ctx_r24 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r24.deleteSubmission());\n    });\n    i0.ɵɵelement(1, \"ion-icon\", 24);\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(3, 1, \"addon.mod_workshop.deletesubmission\"), \" \");\n  }\n}\nfunction AddonModWorkshopSubmissionPage_ion_list_14_ion_item_2_ion_button_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r27 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-button\", 25);\n    i0.ɵɵlistener(\"click\", function AddonModWorkshopSubmissionPage_ion_list_14_ion_item_2_ion_button_4_Template_ion_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r27);\n      const ctx_r26 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r26.undoDeleteSubmission());\n    });\n    i0.ɵɵelement(1, \"ion-icon\", 26);\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(3, 1, \"core.restore\"), \" \");\n  }\n}\nfunction AddonModWorkshopSubmissionPage_ion_list_14_ion_item_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-item\", 17)(1, \"ion-label\");\n    i0.ɵɵtemplate(2, AddonModWorkshopSubmissionPage_ion_list_14_ion_item_2_ion_button_2_Template, 4, 3, \"ion-button\", 18);\n    i0.ɵɵtemplate(3, AddonModWorkshopSubmissionPage_ion_list_14_ion_item_2_ion_button_3_Template, 4, 3, \"ion-button\", 19);\n    i0.ɵɵtemplate(4, AddonModWorkshopSubmissionPage_ion_list_14_ion_item_2_ion_button_4_Template, 4, 3, \"ion-button\", 20);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r18 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r18.canEdit);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r18.submission.deleted && ctx_r18.canDelete);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r18.submission.deleted && ctx_r18.canDelete);\n  }\n}\nfunction AddonModWorkshopSubmissionPage_ion_list_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-list\");\n    i0.ɵɵelement(1, \"addon-mod-workshop-submission\", 15);\n    i0.ɵɵtemplate(2, AddonModWorkshopSubmissionPage_ion_list_14_ion_item_2_Template, 5, 3, \"ion-item\", 16);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"submission\", ctx_r4.submission)(\"courseId\", ctx_r4.courseId)(\"module\", ctx_r4.module)(\"workshop\", ctx_r4.workshop)(\"access\", ctx_r4.access);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r4.canEdit || ctx_r4.canDelete);\n  }\n}\nfunction AddonModWorkshopSubmissionPage_ion_list_15_core_user_avatar_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"core-user-avatar\", 28);\n  }\n  if (rf & 2) {\n    const ctx_r28 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"user\", ctx_r28.evaluateByProfile)(\"courseId\", ctx_r28.courseId)(\"userId\", ctx_r28.evaluateByProfile.id);\n  }\n}\nconst _c1 = function (a0) {\n  return {\n    $a: a0\n  };\n};\nfunction AddonModWorkshopSubmissionPage_ion_list_15_h2_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h2\");\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r29 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind2(2, 1, \"addon.mod_workshop.feedbackby\", i0.ɵɵpureFunction1(4, _c1, ctx_r29.evaluateByProfile.fullname)), \" \");\n  }\n}\nfunction AddonModWorkshopSubmissionPage_ion_list_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-list\")(1, \"ion-item\", 17);\n    i0.ɵɵtemplate(2, AddonModWorkshopSubmissionPage_ion_list_15_core_user_avatar_2_Template, 1, 3, \"core-user-avatar\", 27);\n    i0.ɵɵelementStart(3, \"ion-label\");\n    i0.ɵɵtemplate(4, AddonModWorkshopSubmissionPage_ion_list_15_h2_4_Template, 3, 6, \"h2\", 8);\n    i0.ɵɵelement(5, \"core-format-text\", 11);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r5.evaluateByProfile);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r5.evaluateByProfile && ctx_r5.evaluateByProfile.fullname);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"text\", ctx_r5.evaluate == null ? null : ctx_r5.evaluate.text)(\"contextInstanceId\", ctx_r5.module.id)(\"courseId\", ctx_r5.courseId);\n  }\n}\nfunction AddonModWorkshopSubmissionPage_ion_list_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-list\")(1, \"ion-item\", 17)(2, \"ion-label\")(3, \"h2\");\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"translate\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelement(6, \"addon-mod-workshop-assessment\", 29);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r6 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(5, 7, \"addon.mod_workshop.yourassessment\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"submission\", ctx_r6.submission)(\"assessment\", ctx_r6.ownAssessment)(\"courseId\", ctx_r6.courseId)(\"access\", ctx_r6.access)(\"module\", ctx_r6.module)(\"workshop\", ctx_r6.workshop);\n  }\n}\nfunction AddonModWorkshopSubmissionPage_ion_list_17_ng_container_6_addon_mod_workshop_assessment_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"addon-mod-workshop-assessment\", 29);\n  }\n  if (rf & 2) {\n    const reviewer_r31 = i0.ɵɵnextContext().$implicit;\n    const ctx_r32 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"submission\", ctx_r32.submission)(\"assessment\", reviewer_r31)(\"courseId\", ctx_r32.courseId)(\"access\", ctx_r32.access)(\"module\", ctx_r32.module)(\"workshop\", ctx_r32.workshop);\n  }\n}\nfunction AddonModWorkshopSubmissionPage_ion_list_17_ng_container_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, AddonModWorkshopSubmissionPage_ion_list_17_ng_container_6_addon_mod_workshop_assessment_1_Template, 1, 6, \"addon-mod-workshop-assessment\", 32);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const reviewer_r31 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !reviewer_r31.ownAssessment);\n  }\n}\nfunction AddonModWorkshopSubmissionPage_ion_list_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-list\")(1, \"ion-item\", 17)(2, \"ion-label\")(3, \"h3\", 30);\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"translate\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵtemplate(6, AddonModWorkshopSubmissionPage_ion_list_17_ng_container_6_Template, 2, 1, \"ng-container\", 31);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r7 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(5, 2, \"addon.mod_workshop.receivedgrades\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r7.submissionInfo.reviewedby);\n  }\n}\nfunction AddonModWorkshopSubmissionPage_ion_list_18_addon_mod_workshop_assessment_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"addon-mod-workshop-assessment\", 34);\n  }\n  if (rf & 2) {\n    const reviewer_r35 = ctx.$implicit;\n    const ctx_r34 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"assessment\", reviewer_r35)(\"courseId\", ctx_r34.courseId)(\"module\", ctx_r34.module)(\"workshop\", ctx_r34.workshop)(\"access\", ctx_r34.access);\n  }\n}\nfunction AddonModWorkshopSubmissionPage_ion_list_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-list\")(1, \"ion-item\", 17)(2, \"ion-label\")(3, \"h3\", 30);\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"translate\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵtemplate(6, AddonModWorkshopSubmissionPage_ion_list_18_addon_mod_workshop_assessment_6_Template, 1, 5, \"addon-mod-workshop-assessment\", 33);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r8 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(5, 2, \"addon.mod_workshop.givengrades\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r8.submissionInfo.reviewerof);\n  }\n}\nfunction AddonModWorkshopSubmissionPage_form_19_ion_item_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-item\", 17)(1, \"ion-label\")(2, \"p\", 30);\n    i0.ɵɵtext(3);\n    i0.ɵɵpipe(4, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"p\");\n    i0.ɵɵtext(6);\n    i0.ɵɵpipe(7, \"translate\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelement(8, \"ion-toggle\", 41);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(4, 2, \"addon.mod_workshop.publishsubmission\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(7, 4, \"addon.mod_workshop.publishsubmission_help\"));\n  }\n}\nfunction AddonModWorkshopSubmissionPage_form_19_ion_select_option_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-select-option\", 42);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const grade_r39 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", grade_r39.value);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", grade_r39.label, \" \");\n  }\n}\nconst _c2 = function (a0) {\n  return {\n    header: a0\n  };\n};\nconst _c3 = function (a0) {\n  return {\n    id: a0\n  };\n};\nfunction AddonModWorkshopSubmissionPage_form_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"form\", 35, 36)(2, \"ion-item\", 17)(3, \"ion-label\")(4, \"h3\", 30);\n    i0.ɵɵtext(5);\n    i0.ɵɵpipe(6, \"translate\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵtemplate(7, AddonModWorkshopSubmissionPage_form_19_ion_item_7_Template, 9, 6, \"ion-item\", 16);\n    i0.ɵɵelementStart(8, \"ion-item\", 17)(9, \"ion-label\")(10, \"h3\", 30);\n    i0.ɵɵtext(11);\n    i0.ɵɵpipe(12, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"p\");\n    i0.ɵɵtext(14);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(15, \"ion-item\", 17)(16, \"ion-label\", 37);\n    i0.ɵɵtext(17);\n    i0.ɵɵpipe(18, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(19, \"ion-select\", 38);\n    i0.ɵɵpipe(20, \"translate\");\n    i0.ɵɵpipe(21, \"translate\");\n    i0.ɵɵtemplate(22, AddonModWorkshopSubmissionPage_form_19_ion_select_option_22_Template, 2, 2, \"ion-select-option\", 39);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(23, \"ion-item\")(24, \"ion-label\", 37);\n    i0.ɵɵtext(25);\n    i0.ɵɵpipe(26, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(27, \"core-rich-text-editor\", 40);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r9 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"formGroup\", ctx_r9.feedbackForm);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(6, 14, \"addon.mod_workshop.feedbackauthor\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r9.access.canpublishsubmissions);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(12, 16, \"addon.mod_workshop.gradecalculated\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(ctx_r9.submission.grade);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(18, 18, \"addon.mod_workshop.gradeover\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"cancelText\", i0.ɵɵpipeBind1(20, 20, \"core.cancel\"))(\"interfaceOptions\", i0.ɵɵpureFunction1(26, _c2, i0.ɵɵpipeBind1(21, 22, \"addon.mod_workshop.gradeover\")));\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r9.evaluationGrades);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(26, 24, \"addon.mod_workshop.feedbackauthor\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"control\", ctx_r9.feedbackForm.controls[\"text\"])(\"autoSave\", true)(\"contextInstanceId\", ctx_r9.module.id)(\"draftExtraParams\", i0.ɵɵpureFunction1(28, _c3, ctx_r9.submissionId));\n  }\n}\nfunction AddonModWorkshopSubmissionPage_addon_mod_workshop_assessment_strategy_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"addon-mod-workshop-assessment-strategy\", 43);\n  }\n  if (rf & 2) {\n    const ctx_r10 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"workshop\", ctx_r10.workshop)(\"access\", ctx_r10.access)(\"assessmentId\", ctx_r10.assessmentId)(\"userId\", ctx_r10.assessmentUserId)(\"strategy\", ctx_r10.strategy)(\"edit\", ctx_r10.access.assessingallowed);\n  }\n}\nfunction AddonModWorkshopSubmissionPage_ion_list_21_core_user_avatar_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"core-user-avatar\", 28);\n  }\n  if (rf & 2) {\n    const ctx_r40 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"user\", ctx_r40.evaluateGradingByProfile)(\"courseId\", ctx_r40.courseId)(\"userId\", ctx_r40.evaluateGradingByProfile.id);\n  }\n}\nfunction AddonModWorkshopSubmissionPage_ion_list_21_h3_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h3\", 30);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r41 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind2(2, 1, \"addon.mod_workshop.feedbackby\", i0.ɵɵpureFunction1(4, _c1, ctx_r41.evaluateGradingByProfile.fullname)), \" \");\n  }\n}\nfunction AddonModWorkshopSubmissionPage_ion_list_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-list\")(1, \"ion-item\", 17);\n    i0.ɵɵtemplate(2, AddonModWorkshopSubmissionPage_ion_list_21_core_user_avatar_2_Template, 1, 3, \"core-user-avatar\", 27);\n    i0.ɵɵelementStart(3, \"ion-label\");\n    i0.ɵɵtemplate(4, AddonModWorkshopSubmissionPage_ion_list_21_h3_4_Template, 3, 6, \"h3\", 44);\n    i0.ɵɵelement(5, \"core-format-text\", 11);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r11 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r11.evaluateGradingByProfile);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r11.evaluateGradingByProfile && ctx_r11.evaluateGradingByProfile.fullname);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"text\", ctx_r11.assessment.feedbackreviewer)(\"contextInstanceId\", ctx_r11.module.id)(\"courseId\", ctx_r11.courseId);\n  }\n}\n/**\n * Page that displays a workshop submission.\n */\nexport class AddonModWorkshopSubmissionPage {\n  constructor(fb, content) {\n    this.fb = fb;\n    this.content = content;\n    this.loaded = false;\n    this.canAddFeedback = false;\n    this.canEdit = false;\n    this.canDelete = false;\n    this.evaluationGrades = [];\n    this.originalEvaluation = {\n      published: false,\n      text: '',\n      grade: ''\n    };\n    this.hasOffline = false;\n    this.component = ADDON_MOD_WORKSHOP_COMPONENT;\n    this.forceLeave = false;\n    this.isDestroyed = false;\n    this.currentUserId = CoreSites.getCurrentSiteUserId();\n    this.siteId = CoreSites.getCurrentSiteId();\n    this.feedbackForm = new FormGroup({});\n    this.feedbackForm.addControl('published', this.fb.control(''));\n    this.feedbackForm.addControl('grade', this.fb.control(''));\n    this.feedbackForm.addControl('text', this.fb.control(''));\n    this.obsAssessmentSaved = CoreEvents.on(AddonModWorkshopProvider.ASSESSMENT_SAVED, data => {\n      this.eventReceived(data);\n    }, this.siteId);\n    // Refresh workshop on sync.\n    this.syncObserver = CoreEvents.on(AddonModWorkshopSyncProvider.AUTO_SYNCED, data => {\n      // Update just when all database is synced.\n      this.eventReceived(data);\n    }, this.siteId);\n    this.logView = CoreTime.once(() => this.performLogView());\n  }\n  /**\n   * @inheritdoc\n   */\n  ngOnInit() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      var _this$submissionInfo, _this$assessment, _this$assessment2;\n      try {\n        _this.submissionId = CoreNavigator.getRequiredRouteNumberParam('submissionId');\n        _this.module = CoreNavigator.getRequiredRouteParam('module');\n        _this.workshop = CoreNavigator.getRequiredRouteParam('workshop');\n        _this.access = CoreNavigator.getRequiredRouteParam('access');\n        _this.courseId = CoreNavigator.getRequiredRouteNumberParam('courseId');\n        _this.profile = CoreNavigator.getRouteParam('profile');\n        _this.submissionInfo = CoreNavigator.getRequiredRouteParam('submission');\n        _this.assessment = CoreNavigator.getRouteParam('assessment');\n      } catch (error) {\n        CoreDomUtils.showErrorModal(error);\n        CoreNavigator.back();\n        return;\n      }\n      _this.title = _this.module.name;\n      _this.workshopId = _this.module.instance || _this.workshop.id;\n      _this.userId = (_this$submissionInfo = _this.submissionInfo) === null || _this$submissionInfo === void 0 ? void 0 : _this$submissionInfo.authorid;\n      _this.strategy = _this.assessment && _this.assessment.strategy || _this.workshop && _this.workshop.strategy;\n      _this.assessmentId = (_this$assessment = _this.assessment) === null || _this$assessment === void 0 ? void 0 : _this$assessment.id;\n      _this.assessmentUserId = (_this$assessment2 = _this.assessment) === null || _this$assessment2 === void 0 ? void 0 : _this$assessment2.reviewerid;\n      yield _this.fetchSubmissionData();\n      _this.logView();\n    })();\n  }\n  /**\n   * Check if we can leave the page or not.\n   *\n   * @returns Resolved if we can leave it, rejected if not.\n   */\n  canLeave() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      var _this2$assessmentStra;\n      const assessmentHasChanged = (_this2$assessmentStra = _this2.assessmentStrategy) === null || _this2$assessmentStra === void 0 ? void 0 : _this2$assessmentStra.hasDataChanged();\n      if (_this2.forceLeave || !_this2.hasEvaluationChanged() && !assessmentHasChanged) {\n        return true;\n      }\n      // Show confirmation if some data has been modified.\n      yield CoreDomUtils.showConfirm(Translate.instant('core.confirmcanceledit'));\n      CoreForms.triggerFormCancelledEvent(_this2.formElement, _this2.siteId);\n      return true;\n    })();\n  }\n  /**\n   * Goto edit submission page.\n   */\n  editSubmission() {\n    const params = {\n      module: module,\n      access: this.access\n    };\n    CoreNavigator.navigate(String(this.submissionId) + '/edit', params);\n  }\n  /**\n   * Function called when we receive an event of submission changes.\n   *\n   * @param data Event data received.\n   */\n  eventReceived(data) {\n    if (this.workshopId === data.workshopId) {\n      var _this$content;\n      (_this$content = this.content) === null || _this$content === void 0 || _this$content.scrollToTop();\n      this.loaded = false;\n      this.refreshAllData();\n    }\n  }\n  /**\n   * Fetch the submission data.\n   *\n   * @returns Resolved when done.\n   */\n  fetchSubmissionData() {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      try {\n        var _this3$submissionInfo, _this3$submissionInfo2, _this3$submissionInfo3;\n        _this3.submission = yield AddonModWorkshopHelper.getSubmissionById(_this3.workshopId, _this3.submissionId, {\n          cmId: _this3.module.id\n        });\n        const promises = [];\n        _this3.submission.grade = (_this3$submissionInfo = _this3.submissionInfo) === null || _this3$submissionInfo === void 0 ? void 0 : _this3$submissionInfo.grade;\n        _this3.submission.gradinggrade = (_this3$submissionInfo2 = _this3.submissionInfo) === null || _this3$submissionInfo2 === void 0 ? void 0 : _this3$submissionInfo2.gradinggrade;\n        _this3.submission.gradeover = (_this3$submissionInfo3 = _this3.submissionInfo) === null || _this3$submissionInfo3 === void 0 ? void 0 : _this3$submissionInfo3.gradeover;\n        _this3.userId = _this3.submission.authorid || _this3.userId;\n        _this3.canEdit = _this3.currentUserId == _this3.userId && _this3.access.cansubmit && _this3.access.modifyingsubmissionallowed;\n        _this3.canDelete = _this3.access.candeletesubmissions;\n        _this3.canAddFeedback = !_this3.assessmentId && _this3.workshop.phase > AddonModWorkshopPhase.PHASE_ASSESSMENT && _this3.workshop.phase < AddonModWorkshopPhase.PHASE_CLOSED && _this3.access.canoverridegrades;\n        _this3.ownAssessment = undefined;\n        if (_this3.access.canviewallassessments) {\n          // Get new data, different that came from stateParams.\n          promises.push(AddonModWorkshop.getSubmissionAssessments(_this3.workshopId, _this3.submissionId, {\n            cmId: _this3.module.id\n          }).then(subAssessments => {\n            // Only allow the student to delete their own submission if it's still editable and hasn't been assessed.\n            if (_this3.canDelete) {\n              _this3.canDelete = !subAssessments.length;\n            }\n            _this3.submissionInfo.reviewedby = subAssessments;\n            _this3.submissionInfo.reviewedby.forEach(assessment => {\n              assessment = AddonModWorkshopHelper.realGradeValue(_this3.workshop, assessment);\n              if (_this3.currentUserId == assessment.reviewerid) {\n                _this3.ownAssessment = assessment;\n                assessment.ownAssessment = true;\n              }\n            });\n            return;\n          }));\n        } else if (_this3.currentUserId === _this3.userId && _this3.assessmentId) {\n          // Get new data, different that came from stateParams.\n          promises.push(AddonModWorkshop.getAssessment(_this3.workshopId, _this3.assessmentId, {\n            cmId: _this3.module.id\n          }).then(assessment => {\n            // Only allow the student to delete their own submission if it's still editable and hasn't been assessed.\n            if (_this3.canDelete) {\n              _this3.canDelete = !assessment;\n            }\n            _this3.submissionInfo.reviewedby = [_this3.parseAssessment(assessment)];\n            return;\n          }));\n        } else if (_this3.workshop.phase === AddonModWorkshopPhase.PHASE_CLOSED && _this3.userId === _this3.currentUserId) {\n          const assessments = yield AddonModWorkshop.getSubmissionAssessments(_this3.workshopId, _this3.submissionId, {\n            cmId: _this3.module.id\n          });\n          _this3.submissionInfo.reviewedby = assessments.map(assessment => _this3.parseAssessment(assessment));\n        }\n        if (_this3.canAddFeedback || _this3.workshop.phase === AddonModWorkshopPhase.PHASE_CLOSED) {\n          _this3.evaluate = {\n            published: _this3.submission.published,\n            text: _this3.submission.feedbackauthor || ''\n          };\n        }\n        if (_this3.canAddFeedback) {\n          if (!_this3.isDestroyed) {\n            // Block the workshop.\n            CoreSync.blockOperation(_this3.component, _this3.workshopId);\n          }\n          promises.push(_this3.fillEvaluationsGrades());\n        } else if (_this3.workshop.phase === AddonModWorkshopPhase.PHASE_CLOSED && _this3.submission.gradeoverby && _this3.evaluate && _this3.evaluate.text) {\n          promises.push(CoreUser.getProfile(_this3.submission.gradeoverby, _this3.courseId, true).then(profile => {\n            _this3.evaluateByProfile = profile;\n            return;\n          }));\n        }\n        if (_this3.assessment && !_this3.access.assessingallowed && _this3.assessment.feedbackreviewer && _this3.assessment.gradinggradeoverby) {\n          promises.push(CoreUser.getProfile(_this3.assessment.gradinggradeoverby, _this3.courseId, true).then(profile => {\n            _this3.evaluateGradingByProfile = profile;\n            return;\n          }));\n        }\n        yield Promise.all(promises);\n        const submissionsActions = yield AddonModWorkshopOffline.getSubmissions(_this3.workshopId);\n        _this3.submission = yield AddonModWorkshopHelper.applyOfflineData(_this3.submission, submissionsActions);\n      } catch (error) {\n        CoreDomUtils.showErrorModalDefault(error, 'core.course.errorgetmodule', true);\n      } finally {\n        _this3.loaded = true;\n      }\n    })();\n  }\n  /**\n   * Fill evaluation grade info.\n   */\n  fillEvaluationsGrades() {\n    var _this4 = this;\n    return _asyncToGenerator(function* () {\n      const defaultGrade = Translate.instant('addon.mod_workshop.notoverridden');\n      _this4.evaluationGrades = yield CoreGradesHelper.makeGradesMenu(_this4.workshop.grade || 0, undefined, defaultGrade, -1);\n      if (!_this4.evaluate) {\n        // Should not happen.\n        return;\n      }\n      _this4.evaluate.grade = {\n        label: CoreGradesHelper.getGradeLabelFromValue(_this4.evaluationGrades, _this4.submissionInfo.gradeover) || defaultGrade,\n        value: _this4.submissionInfo.gradeover || -1\n      };\n      try {\n        const offlineSubmission = yield AddonModWorkshopOffline.getEvaluateSubmission(_this4.workshopId, _this4.submissionId);\n        _this4.hasOffline = true;\n        _this4.evaluate.published = offlineSubmission.published;\n        _this4.evaluate.text = offlineSubmission.feedbacktext;\n        _this4.evaluate.grade = {\n          label: CoreGradesHelper.getGradeLabelFromValue(_this4.evaluationGrades, parseInt(offlineSubmission.gradeover, 10)) || defaultGrade,\n          value: offlineSubmission.gradeover || -1\n        };\n      } catch (_unused) {\n        // Ignore errors.\n        _this4.hasOffline = false;\n      } finally {\n        _this4.originalEvaluation.published = _this4.evaluate.published;\n        _this4.originalEvaluation.text = _this4.evaluate.text;\n        _this4.originalEvaluation.grade = _this4.evaluate.grade.value;\n        _this4.feedbackForm.controls['published'].setValue(_this4.evaluate.published);\n        _this4.feedbackForm.controls['grade'].setValue(_this4.evaluate.grade.value);\n        _this4.feedbackForm.controls['text'].setValue(_this4.evaluate.text);\n      }\n    })();\n  }\n  /**\n   * Parse assessment to be shown.\n   *\n   * @param assessment Original assessment.\n   * @returns Parsed assessment.\n   */\n  parseAssessment(assessment) {\n    assessment = AddonModWorkshopHelper.realGradeValue(this.workshop, assessment);\n    if (this.currentUserId == assessment.reviewerid) {\n      this.ownAssessment = assessment;\n      assessment.ownAssessment = true;\n    }\n    return assessment;\n  }\n  /**\n   * Force leaving the page, without checking for changes.\n   */\n  forceLeavePage() {\n    this.forceLeave = true;\n    CoreNavigator.back();\n  }\n  /**\n   * Check if data has changed.\n   *\n   * @returns True if changed, false otherwise.\n   */\n  hasEvaluationChanged() {\n    if (!this.loaded || !this.access.canoverridegrades) {\n      return false;\n    }\n    const inputData = this.feedbackForm.value;\n    if (this.originalEvaluation.published != inputData.published) {\n      return true;\n    }\n    if (this.originalEvaluation.text != inputData.text) {\n      return true;\n    }\n    if (this.originalEvaluation.grade != inputData.grade) {\n      return true;\n    }\n    return false;\n  }\n  /**\n   * Convenience function to refresh all the data.\n   *\n   * @returns Resolved when done.\n   */\n  refreshAllData() {\n    var _this5 = this;\n    return _asyncToGenerator(function* () {\n      const promises = [];\n      promises.push(AddonModWorkshop.invalidateSubmissionData(_this5.workshopId, _this5.submissionId));\n      promises.push(AddonModWorkshop.invalidateSubmissionsData(_this5.workshopId));\n      promises.push(AddonModWorkshop.invalidateSubmissionAssesmentsData(_this5.workshopId, _this5.submissionId));\n      if (_this5.assessmentId) {\n        promises.push(AddonModWorkshop.invalidateAssessmentFormData(_this5.workshopId, _this5.assessmentId));\n        promises.push(AddonModWorkshop.invalidateAssessmentData(_this5.workshopId, _this5.assessmentId));\n      }\n      if (_this5.assessmentUserId) {\n        promises.push(AddonModWorkshop.invalidateReviewerAssesmentsData(_this5.workshopId, _this5.assessmentId));\n      }\n      try {\n        yield Promise.all(promises);\n      } finally {\n        CoreEvents.trigger(AddonModWorkshopProvider.ASSESSMENT_INVALIDATED, null, _this5.siteId);\n        yield _this5.fetchSubmissionData();\n        _this5.logView();\n      }\n    })();\n  }\n  /**\n   * Pull to refresh.\n   *\n   * @param refresher Refresher.\n   */\n  refreshSubmission(refresher) {\n    if (this.loaded) {\n      this.refreshAllData().finally(() => {\n        refresher === null || refresher === void 0 || refresher.complete();\n      });\n    }\n  }\n  /**\n   * Save the assessment.\n   */\n  saveAssessment() {\n    var _this6 = this;\n    return _asyncToGenerator(function* () {\n      var _this6$assessmentStra;\n      if ((_this6$assessmentStra = _this6.assessmentStrategy) !== null && _this6$assessmentStra !== void 0 && _this6$assessmentStra.hasDataChanged()) {\n        try {\n          yield _this6.assessmentStrategy.saveAssessment();\n          _this6.forceLeavePage();\n        } catch (_unused2) {\n          // Error, stay on the page.\n        }\n      } else {\n        // Nothing to save, just go back.\n        _this6.forceLeavePage();\n      }\n    })();\n  }\n  /**\n   * Save the submission evaluation.\n   */\n  saveEvaluation() {\n    var _this7 = this;\n    return _asyncToGenerator(function* () {\n      // Check if data has changed.\n      if (_this7.hasEvaluationChanged()) {\n        yield _this7.sendEvaluation();\n        _this7.forceLeavePage();\n      } else {\n        // Nothing to save, just go back.\n        _this7.forceLeavePage();\n      }\n    })();\n  }\n  /**\n   * Sends the evaluation to be saved on the server.\n   *\n   * @returns Resolved when done.\n   */\n  sendEvaluation() {\n    var _this8 = this;\n    return _asyncToGenerator(function* () {\n      const modal = yield CoreDomUtils.showModalLoading('core.sending', true);\n      const inputData = _this8.feedbackForm.value;\n      inputData.grade = Number(inputData.grade) >= 0 ? inputData.grade : '';\n      // Add some HTML to the message if needed.\n      inputData.text = CoreTextUtils.formatHtmlLines(inputData.text);\n      // Try to send it to server.\n      try {\n        const result = yield AddonModWorkshop.evaluateSubmission(_this8.workshopId, _this8.submissionId, _this8.courseId, inputData.text, inputData.published, String(inputData.grade));\n        CoreForms.triggerFormSubmittedEvent(_this8.formElement, !!result, _this8.siteId);\n        yield AddonModWorkshop.invalidateSubmissionData(_this8.workshopId, _this8.submissionId).finally(() => {\n          const data = {\n            workshopId: _this8.workshopId,\n            submissionId: _this8.submissionId\n          };\n          CoreEvents.trigger(AddonModWorkshopProvider.SUBMISSION_CHANGED, data, _this8.siteId);\n        });\n      } catch (message) {\n        CoreDomUtils.showErrorModalDefault(message, 'Cannot save submission evaluation');\n      } finally {\n        modal.dismiss();\n      }\n    })();\n  }\n  /**\n   * Perform the submission delete action.\n   */\n  deleteSubmission() {\n    var _this9 = this;\n    return _asyncToGenerator(function* () {\n      try {\n        yield CoreDomUtils.showDeleteConfirm('addon.mod_workshop.submissiondeleteconfirm');\n      } catch (_unused3) {\n        return;\n      }\n      const modal = yield CoreDomUtils.showModalLoading('core.deleting', true);\n      let success = false;\n      try {\n        yield AddonModWorkshop.deleteSubmission(_this9.workshopId, _this9.submissionId, _this9.courseId);\n        success = true;\n        yield AddonModWorkshop.invalidateSubmissionData(_this9.workshopId, _this9.submissionId);\n      } catch (error) {\n        CoreDomUtils.showErrorModalDefault(error, 'Cannot delete submission');\n      } finally {\n        modal.dismiss();\n        if (success) {\n          const data = {\n            workshopId: _this9.workshopId,\n            submissionId: _this9.submissionId\n          };\n          CoreEvents.trigger(AddonModWorkshopProvider.SUBMISSION_CHANGED, data, _this9.siteId);\n          _this9.forceLeavePage();\n        }\n      }\n    })();\n  }\n  /**\n   * Undo the submission delete action.\n   *\n   * @returns Resolved when done.\n   */\n  undoDeleteSubmission() {\n    var _this10 = this;\n    return _asyncToGenerator(function* () {\n      yield AddonModWorkshopOffline.deleteSubmissionAction(_this10.workshopId, AddonModWorkshopAction.DELETE).finally( /*#__PURE__*/_asyncToGenerator(function* () {\n        const data = {\n          workshopId: _this10.workshopId,\n          submissionId: _this10.submissionId\n        };\n        CoreEvents.trigger(AddonModWorkshopProvider.SUBMISSION_CHANGED, data, _this10.siteId);\n        yield _this10.refreshAllData();\n      }));\n    })();\n  }\n  /**\n   * Log submission viewed.\n   */\n  performLogView() {\n    var _this11 = this;\n    return _asyncToGenerator(function* () {\n      try {\n        yield AddonModWorkshop.logViewSubmission(_this11.submissionId, _this11.workshopId);\n        CoreCourse.checkModuleCompletion(_this11.courseId, _this11.module.completiondata);\n      } catch (_unused4) {\n        // Ignore errors.\n      }\n      CoreAnalytics.logEvent({\n        type: CoreAnalyticsEventType.VIEW_ITEM,\n        ws: 'mod_workshop_view_submission',\n        name: _this11.workshop.name,\n        data: {\n          id: _this11.workshop.id,\n          submissionid: _this11.submissionId,\n          category: 'workshop'\n        },\n        url: `/mod/workshop/submission.php?cmid=${_this11.module.id}&id=${_this11.submissionId}`\n      });\n    })();\n  }\n  /**\n   * @inheritdoc\n   */\n  ngOnDestroy() {\n    var _this$syncObserver, _this$obsAssessmentSa;\n    this.isDestroyed = true;\n    (_this$syncObserver = this.syncObserver) === null || _this$syncObserver === void 0 || _this$syncObserver.off();\n    (_this$obsAssessmentSa = this.obsAssessmentSaved) === null || _this$obsAssessmentSa === void 0 || _this$obsAssessmentSa.off();\n    // Restore original back functions.\n    CoreSync.unblockOperation(this.component, this.workshopId);\n  }\n}\n_class = AddonModWorkshopSubmissionPage;\n_class.ɵfac = function AddonModWorkshopSubmissionPage_Factory(t) {\n  return new (t || _class)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.IonContent, 8));\n};\n_class.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: _class,\n  selectors: [[\"page-addon-mod-workshop-submission-page\"]],\n  viewQuery: function AddonModWorkshopSubmissionPage_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(AddonModWorkshopAssessmentStrategyComponent, 5);\n      i0.ɵɵviewQuery(_c0, 5);\n    }\n    if (rf & 2) {\n      let _t;\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.assessmentStrategy = _t.first);\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.formElement = _t.first);\n    }\n  },\n  decls: 22,\n  vars: 17,\n  consts: [[\"slot\", \"start\"], [3, \"text\"], [\"contextLevel\", \"module\", 3, \"text\", \"contextInstanceId\", \"courseId\", 4, \"ngIf\"], [\"slot\", \"end\", 3, \"hidden\"], [\"fill\", \"clear\", 3, \"click\", 4, \"ngIf\"], [1, \"limited-width\"], [\"slot\", \"fixed\", 3, \"disabled\", \"ionRefresh\", 4, \"ngIf\"], [3, \"hideUntil\"], [4, \"ngIf\"], [3, \"formGroup\", 4, \"ngIf\"], [3, \"workshop\", \"access\", \"assessmentId\", \"userId\", \"strategy\", \"edit\", 4, \"ngIf\"], [\"contextLevel\", \"module\", 3, \"text\", \"contextInstanceId\", \"courseId\"], [\"fill\", \"clear\", 3, \"click\"], [\"slot\", \"fixed\", 3, \"disabled\", \"ionRefresh\"], [3, \"pullingText\"], [3, \"submission\", \"courseId\", \"module\", \"workshop\", \"access\"], [\"class\", \"ion-text-wrap\", 4, \"ngIf\"], [1, \"ion-text-wrap\"], [\"expand\", \"block\", 3, \"click\", 4, \"ngIf\"], [\"expand\", \"block\", \"color\", \"danger\", 3, \"click\", 4, \"ngIf\"], [\"expand\", \"block\", \"fill\", \"outline\", \"color\", \"danger\", 3, \"click\", 4, \"ngIf\"], [\"expand\", \"block\", 3, \"click\"], [\"name\", \"fas-pen\", \"slot\", \"start\", \"aria-hidden\", \"true\"], [\"expand\", \"block\", \"color\", \"danger\", 3, \"click\"], [\"name\", \"fas-trash\", \"slot\", \"start\", \"aria-hidden\", \"true\"], [\"expand\", \"block\", \"fill\", \"outline\", \"color\", \"danger\", 3, \"click\"], [\"name\", \"fas-rotate-left\", \"slot\", \"start\", \"aria-hidden\", \"true\"], [\"slot\", \"start\", 3, \"user\", \"courseId\", \"userId\", 4, \"ngIf\"], [\"slot\", \"start\", 3, \"user\", \"courseId\", \"userId\"], [3, \"submission\", \"assessment\", \"courseId\", \"access\", \"module\", \"workshop\"], [1, \"item-heading\"], [4, \"ngFor\", \"ngForOf\"], [3, \"submission\", \"assessment\", \"courseId\", \"access\", \"module\", \"workshop\", 4, \"ngIf\"], [3, \"assessment\", \"courseId\", \"module\", \"workshop\", \"access\", 4, \"ngFor\", \"ngForOf\"], [3, \"assessment\", \"courseId\", \"module\", \"workshop\", \"access\"], [3, \"formGroup\"], [\"feedbackFormEl\", \"\"], [\"position\", \"stacked\"], [\"formControlName\", \"grade\", \"interface\", \"action-sheet\", 3, \"cancelText\", \"interfaceOptions\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"name\", \"text\", \"contextLevel\", \"module\", \"elementId\", \"feedbackauthor_editor\", 3, \"control\", \"autoSave\", \"contextInstanceId\", \"draftExtraParams\"], [\"formControlName\", \"published\", \"slot\", \"end\"], [3, \"value\"], [3, \"workshop\", \"access\", \"assessmentId\", \"userId\", \"strategy\", \"edit\"], [\"class\", \"item-heading\", 4, \"ngIf\"]],\n  template: function AddonModWorkshopSubmissionPage_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"ion-header\")(1, \"ion-toolbar\")(2, \"ion-buttons\", 0);\n      i0.ɵɵelement(3, \"ion-back-button\", 1);\n      i0.ɵɵpipe(4, \"translate\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(5, \"ion-title\")(6, \"h1\");\n      i0.ɵɵtemplate(7, AddonModWorkshopSubmissionPage_core_format_text_7_Template, 1, 3, \"core-format-text\", 2);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(8, \"ion-buttons\", 3);\n      i0.ɵɵtemplate(9, AddonModWorkshopSubmissionPage_ion_button_9_Template, 4, 6, \"ion-button\", 4);\n      i0.ɵɵtemplate(10, AddonModWorkshopSubmissionPage_ion_button_10_Template, 3, 3, \"ion-button\", 4);\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(11, \"ion-content\", 5);\n      i0.ɵɵtemplate(12, AddonModWorkshopSubmissionPage_ion_refresher_12_Template, 3, 4, \"ion-refresher\", 6);\n      i0.ɵɵelementStart(13, \"core-loading\", 7);\n      i0.ɵɵtemplate(14, AddonModWorkshopSubmissionPage_ion_list_14_Template, 3, 6, \"ion-list\", 8);\n      i0.ɵɵtemplate(15, AddonModWorkshopSubmissionPage_ion_list_15_Template, 6, 5, \"ion-list\", 8);\n      i0.ɵɵtemplate(16, AddonModWorkshopSubmissionPage_ion_list_16_Template, 7, 9, \"ion-list\", 8);\n      i0.ɵɵtemplate(17, AddonModWorkshopSubmissionPage_ion_list_17_Template, 7, 4, \"ion-list\", 8);\n      i0.ɵɵtemplate(18, AddonModWorkshopSubmissionPage_ion_list_18_Template, 7, 4, \"ion-list\", 8);\n      i0.ɵɵtemplate(19, AddonModWorkshopSubmissionPage_form_19_Template, 28, 30, \"form\", 9);\n      i0.ɵɵtemplate(20, AddonModWorkshopSubmissionPage_addon_mod_workshop_assessment_strategy_20_Template, 1, 6, \"addon-mod-workshop-assessment-strategy\", 10);\n      i0.ɵɵtemplate(21, AddonModWorkshopSubmissionPage_ion_list_21_Template, 6, 5, \"ion-list\", 8);\n      i0.ɵɵelementEnd()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"text\", i0.ɵɵpipeBind1(4, 15, \"core.back\"));\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngIf\", ctx.title);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"hidden\", !ctx.loaded);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.assessmentId && ctx.access.assessingallowed);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.canAddFeedback);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", !(ctx.assessmentId && ctx.access.assessingallowed || ctx.canAddFeedback));\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"hideUntil\", ctx.loaded);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.submission);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", !ctx.canAddFeedback && (ctx.evaluate == null ? null : ctx.evaluate.text));\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.ownAssessment && !ctx.assessment);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.submissionInfo && ctx.submissionInfo.reviewedby && ctx.submissionInfo.reviewedby.length && !ctx.assessment);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.submissionInfo && ctx.submissionInfo.reviewerof && ctx.submissionInfo.reviewerof.length && !ctx.assessment);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.canAddFeedback && ctx.submission);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.assessmentId);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.assessmentId && !ctx.access.assessingallowed && (ctx.assessment == null ? null : ctx.assessment.feedbackreviewer));\n    }\n  },\n  encapsulation: 2\n});","map":{"version":3,"names":["FormGroup","CoreCourse","CoreGradesHelper","CoreUser","CoreNavigator","CoreSites","CoreSync","CoreDomUtils","CoreTextUtils","Translate","CoreEvents","CoreForms","AddonModWorkshopAssessmentStrategyComponent","AddonModWorkshopProvider","AddonModWorkshop","AddonModWorkshopPhase","AddonModWorkshopAction","AddonModWorkshopHelper","AddonModWorkshopOffline","AddonModWorkshopSyncProvider","CoreAnalytics","CoreAnalyticsEventType","CoreTime","ADDON_MOD_WORKSHOP_COMPONENT","i0","ɵɵelement","ɵɵproperty","ctx_r0","title","module","id","courseId","ɵɵelementStart","ɵɵlistener","AddonModWorkshopSubmissionPage_ion_button_9_Template_ion_button_click_0_listener","ɵɵrestoreView","_r13","ctx_r12","ɵɵnextContext","ɵɵresetView","saveAssessment","ɵɵtext","ɵɵelementEnd","ɵɵattribute","ɵɵpipeBind1","ɵɵadvance","ɵɵtextInterpolate1","AddonModWorkshopSubmissionPage_ion_button_10_Template_ion_button_click_0_listener","_r15","ctx_r14","saveEvaluation","AddonModWorkshopSubmissionPage_ion_refresher_12_Template_ion_refresher_ionRefresh_0_listener","$event","_r17","ctx_r16","refreshSubmission","target","ctx_r3","loaded","ɵɵpropertyInterpolate","AddonModWorkshopSubmissionPage_ion_list_14_ion_item_2_ion_button_2_Template_ion_button_click_0_listener","_r23","ctx_r22","editSubmission","AddonModWorkshopSubmissionPage_ion_list_14_ion_item_2_ion_button_3_Template_ion_button_click_0_listener","_r25","ctx_r24","deleteSubmission","AddonModWorkshopSubmissionPage_ion_list_14_ion_item_2_ion_button_4_Template_ion_button_click_0_listener","_r27","ctx_r26","undoDeleteSubmission","ɵɵtemplate","AddonModWorkshopSubmissionPage_ion_list_14_ion_item_2_ion_button_2_Template","AddonModWorkshopSubmissionPage_ion_list_14_ion_item_2_ion_button_3_Template","AddonModWorkshopSubmissionPage_ion_list_14_ion_item_2_ion_button_4_Template","ctx_r18","canEdit","submission","deleted","canDelete","AddonModWorkshopSubmissionPage_ion_list_14_ion_item_2_Template","ctx_r4","workshop","access","ctx_r28","evaluateByProfile","ɵɵpipeBind2","ɵɵpureFunction1","_c1","ctx_r29","fullname","AddonModWorkshopSubmissionPage_ion_list_15_core_user_avatar_2_Template","AddonModWorkshopSubmissionPage_ion_list_15_h2_4_Template","ctx_r5","evaluate","text","ɵɵtextInterpolate","ctx_r6","ownAssessment","ctx_r32","reviewer_r31","ɵɵelementContainerStart","AddonModWorkshopSubmissionPage_ion_list_17_ng_container_6_addon_mod_workshop_assessment_1_Template","ɵɵelementContainerEnd","AddonModWorkshopSubmissionPage_ion_list_17_ng_container_6_Template","ctx_r7","submissionInfo","reviewedby","reviewer_r35","ctx_r34","AddonModWorkshopSubmissionPage_ion_list_18_addon_mod_workshop_assessment_6_Template","ctx_r8","reviewerof","grade_r39","value","label","AddonModWorkshopSubmissionPage_form_19_ion_item_7_Template","AddonModWorkshopSubmissionPage_form_19_ion_select_option_22_Template","ctx_r9","feedbackForm","canpublishsubmissions","grade","_c2","evaluationGrades","controls","_c3","submissionId","ctx_r10","assessmentId","assessmentUserId","strategy","assessingallowed","ctx_r40","evaluateGradingByProfile","ctx_r41","AddonModWorkshopSubmissionPage_ion_list_21_core_user_avatar_2_Template","AddonModWorkshopSubmissionPage_ion_list_21_h3_4_Template","ctx_r11","assessment","feedbackreviewer","AddonModWorkshopSubmissionPage","constructor","fb","content","canAddFeedback","originalEvaluation","published","hasOffline","component","forceLeave","isDestroyed","currentUserId","getCurrentSiteUserId","siteId","getCurrentSiteId","addControl","control","obsAssessmentSaved","on","ASSESSMENT_SAVED","data","eventReceived","syncObserver","AUTO_SYNCED","logView","once","performLogView","ngOnInit","_this","_asyncToGenerator","_this$submissionInfo","_this$assessment","_this$assessment2","getRequiredRouteNumberParam","getRequiredRouteParam","profile","getRouteParam","error","showErrorModal","back","name","workshopId","instance","userId","authorid","reviewerid","fetchSubmissionData","canLeave","_this2","_this2$assessmentStra","assessmentHasChanged","assessmentStrategy","hasDataChanged","hasEvaluationChanged","showConfirm","instant","triggerFormCancelledEvent","formElement","params","navigate","String","_this$content","scrollToTop","refreshAllData","_this3","_this3$submissionInfo","_this3$submissionInfo2","_this3$submissionInfo3","getSubmissionById","cmId","promises","gradinggrade","gradeover","cansubmit","modifyingsubmissionallowed","candeletesubmissions","phase","PHASE_ASSESSMENT","PHASE_CLOSED","canoverridegrades","undefined","canviewallassessments","push","getSubmissionAssessments","then","subAssessments","length","forEach","realGradeValue","getAssessment","parseAssessment","assessments","map","feedbackauthor","blockOperation","fillEvaluationsGrades","gradeoverby","getProfile","gradinggradeoverby","Promise","all","submissionsActions","getSubmissions","applyOfflineData","showErrorModalDefault","_this4","defaultGrade","makeGradesMenu","getGradeLabelFromValue","offlineSubmission","getEvaluateSubmission","feedbacktext","parseInt","_unused","setValue","forceLeavePage","inputData","_this5","invalidateSubmissionData","invalidateSubmissionsData","invalidateSubmissionAssesmentsData","invalidateAssessmentFormData","invalidateAssessmentData","invalidateReviewerAssesmentsData","trigger","ASSESSMENT_INVALIDATED","refresher","finally","complete","_this6","_this6$assessmentStra","_unused2","_this7","sendEvaluation","_this8","modal","showModalLoading","Number","formatHtmlLines","result","evaluateSubmission","triggerFormSubmittedEvent","SUBMISSION_CHANGED","message","dismiss","_this9","showDeleteConfirm","_unused3","success","_this10","deleteSubmissionAction","DELETE","_this11","logViewSubmission","checkModuleCompletion","completiondata","_unused4","logEvent","type","VIEW_ITEM","ws","submissionid","category","url","ngOnDestroy","_this$syncObserver","_this$obsAssessmentSa","off","unblockOperation","ɵɵdirectiveInject","i1","FormBuilder","i2","IonContent","selectors","viewQuery","AddonModWorkshopSubmissionPage_Query","rf","ctx","AddonModWorkshopSubmissionPage_core_format_text_7_Template","AddonModWorkshopSubmissionPage_ion_button_9_Template","AddonModWorkshopSubmissionPage_ion_button_10_Template","AddonModWorkshopSubmissionPage_ion_refresher_12_Template","AddonModWorkshopSubmissionPage_ion_list_14_Template","AddonModWorkshopSubmissionPage_ion_list_15_Template","AddonModWorkshopSubmissionPage_ion_list_16_Template","AddonModWorkshopSubmissionPage_ion_list_17_Template","AddonModWorkshopSubmissionPage_ion_list_18_Template","AddonModWorkshopSubmissionPage_form_19_Template","AddonModWorkshopSubmissionPage_addon_mod_workshop_assessment_strategy_20_Template","AddonModWorkshopSubmissionPage_ion_list_21_Template"],"sources":["/home/toon/works/gitionic7/ionic-github/ionic/src/addons/mod/workshop/pages/submission/submission.ts","/home/toon/works/gitionic7/ionic-github/ionic/src/addons/mod/workshop/pages/submission/submission.html"],"sourcesContent":["// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Component, OnInit, OnDestroy, Optional, ViewChild, ElementRef } from '@angular/core';\nimport { FormGroup, FormBuilder } from '@angular/forms';\nimport { Params } from '@angular/router';\nimport { CoreCourse } from '@features/course/services/course';\nimport { CoreCourseModuleData } from '@features/course/services/course-helper';\nimport { CoreGradesHelper, CoreGradesMenuItem } from '@features/grades/services/grades-helper';\nimport { CoreUser, CoreUserProfile } from '@features/user/services/user';\nimport { CanLeave } from '@guards/can-leave';\nimport { IonContent } from '@ionic/angular';\nimport { CoreNavigator } from '@services/navigator';\nimport { CoreSites } from '@services/sites';\nimport { CoreSync } from '@services/sync';\nimport { CoreDomUtils } from '@services/utils/dom';\nimport { CoreTextUtils } from '@services/utils/text';\nimport { Translate } from '@singletons';\nimport { CoreEventObserver, CoreEvents } from '@singletons/events';\nimport { CoreForms } from '@singletons/form';\nimport { AddonModWorkshopAssessmentStrategyComponent } from '../../components/assessment-strategy/assessment-strategy';\nimport {\n    AddonModWorkshopProvider,\n    AddonModWorkshop,\n    AddonModWorkshopPhase,\n    AddonModWorkshopSubmissionChangedEventData,\n    AddonModWorkshopAction,\n    AddonModWorkshopData,\n    AddonModWorkshopGetWorkshopAccessInformationWSResponse,\n    AddonModWorkshopAssessmentSavedChangedEventData,\n} from '../../services/workshop';\nimport {\n    AddonModWorkshopHelper,\n    AddonModWorkshopSubmissionAssessmentWithFormData,\n    AddonModWorkshopSubmissionDataWithOfflineData,\n} from '../../services/workshop-helper';\nimport { AddonModWorkshopOffline } from '../../services/workshop-offline';\nimport { AddonModWorkshopSyncProvider, AddonModWorkshopAutoSyncData } from '../../services/workshop-sync';\nimport { CoreAnalytics, CoreAnalyticsEventType } from '@services/analytics';\nimport { CoreTime } from '@singletons/time';\nimport { ADDON_MOD_WORKSHOP_COMPONENT } from '@addons/mod/workshop/constants';\n\n/**\n * Page that displays a workshop submission.\n */\n@Component({\n    selector: 'page-addon-mod-workshop-submission-page',\n    templateUrl: 'submission.html',\n})\nexport class AddonModWorkshopSubmissionPage implements OnInit, OnDestroy, CanLeave {\n\n    @ViewChild(AddonModWorkshopAssessmentStrategyComponent) assessmentStrategy?: AddonModWorkshopAssessmentStrategyComponent;\n\n    @ViewChild('feedbackFormEl') formElement?: ElementRef;\n\n    module!: CoreCourseModuleData;\n    workshop!: AddonModWorkshopData;\n    access!: AddonModWorkshopGetWorkshopAccessInformationWSResponse;\n    assessment?: AddonModWorkshopSubmissionAssessmentWithFormData;\n    submissionInfo!: AddonModWorkshopSubmissionDataWithOfflineData;\n    profile?: CoreUserProfile;\n    courseId!: number;\n\n    submission?: AddonModWorkshopSubmissionDataWithOfflineData;\n    title?: string;\n    loaded = false;\n    ownAssessment?: AddonModWorkshopSubmissionAssessmentWithFormData;\n    strategy?: string;\n    assessmentId?: number;\n    assessmentUserId?: number;\n    evaluate?: AddonWorkshopSubmissionEvaluateData;\n    canAddFeedback = false;\n    canEdit = false;\n    canDelete = false;\n    evaluationGrades: CoreGradesMenuItem[] = [];\n    evaluateGradingByProfile?: CoreUserProfile;\n    evaluateByProfile?: CoreUserProfile;\n    feedbackForm: FormGroup; // The form group.\n    submissionId!: number;\n\n    protected workshopId!: number;\n    protected currentUserId: number;\n    protected userId?: number;\n    protected siteId: string;\n    protected originalEvaluation: Omit<AddonWorkshopSubmissionEvaluateData, 'grade'> & { grade: number | string} = {\n        published: false,\n        text: '',\n        grade: '',\n    };\n\n    protected hasOffline = false;\n    protected component = ADDON_MOD_WORKSHOP_COMPONENT;\n    protected forceLeave = false;\n    protected obsAssessmentSaved: CoreEventObserver;\n    protected syncObserver: CoreEventObserver;\n    protected isDestroyed = false;\n    protected logView: () => void;\n\n    constructor(\n        protected fb: FormBuilder,\n        @Optional() protected content: IonContent,\n    ) {\n        this.currentUserId = CoreSites.getCurrentSiteUserId();\n        this.siteId = CoreSites.getCurrentSiteId();\n\n        this.feedbackForm = new FormGroup({});\n        this.feedbackForm.addControl('published', this.fb.control(''));\n        this.feedbackForm.addControl('grade', this.fb.control(''));\n        this.feedbackForm.addControl('text', this.fb.control(''));\n\n        this.obsAssessmentSaved = CoreEvents.on(AddonModWorkshopProvider.ASSESSMENT_SAVED, (data) => {\n            this.eventReceived(data);\n        }, this.siteId);\n\n        // Refresh workshop on sync.\n        this.syncObserver = CoreEvents.on(AddonModWorkshopSyncProvider.AUTO_SYNCED, (data) => {\n            // Update just when all database is synced.\n            this.eventReceived(data);\n        }, this.siteId);\n\n        this.logView = CoreTime.once(() => this.performLogView());\n    }\n\n    /**\n     * @inheritdoc\n     */\n    async ngOnInit(): Promise<void> {\n        try {\n            this.submissionId = CoreNavigator.getRequiredRouteNumberParam('submissionId');\n            this.module = CoreNavigator.getRequiredRouteParam<CoreCourseModuleData>('module');\n            this.workshop = CoreNavigator.getRequiredRouteParam<AddonModWorkshopData>('workshop');\n            this.access = CoreNavigator.getRequiredRouteParam<AddonModWorkshopGetWorkshopAccessInformationWSResponse>('access');\n            this.courseId = CoreNavigator.getRequiredRouteNumberParam('courseId');\n            this.profile = CoreNavigator.getRouteParam<CoreUserProfile>('profile');\n            this.submissionInfo = CoreNavigator.getRequiredRouteParam<AddonModWorkshopSubmissionDataWithOfflineData>('submission');\n            this.assessment = CoreNavigator.getRouteParam<AddonModWorkshopSubmissionAssessmentWithFormData>('assessment');\n        } catch (error) {\n            CoreDomUtils.showErrorModal(error);\n\n            CoreNavigator.back();\n\n            return;\n        }\n\n        this.title = this.module.name;\n        this.workshopId = this.module.instance || this.workshop.id;\n\n        this.userId = this.submissionInfo?.authorid;\n        this.strategy = (this.assessment && this.assessment.strategy) || (this.workshop && this.workshop.strategy);\n        this.assessmentId = this.assessment?.id;\n        this.assessmentUserId = this.assessment?.reviewerid;\n\n        await this.fetchSubmissionData();\n\n        this.logView();\n    }\n\n    /**\n     * Check if we can leave the page or not.\n     *\n     * @returns Resolved if we can leave it, rejected if not.\n     */\n    async canLeave(): Promise<boolean> {\n        const assessmentHasChanged = this.assessmentStrategy?.hasDataChanged();\n        if (this.forceLeave || (!this.hasEvaluationChanged() && !assessmentHasChanged)) {\n            return true;\n        }\n\n        // Show confirmation if some data has been modified.\n        await CoreDomUtils.showConfirm(Translate.instant('core.confirmcanceledit'));\n\n        CoreForms.triggerFormCancelledEvent(this.formElement, this.siteId);\n\n        return true;\n    }\n\n    /**\n     * Goto edit submission page.\n     */\n    editSubmission(): void {\n        const params: Params = {\n            module: module,\n            access: this.access,\n        };\n\n        CoreNavigator.navigate(String(this.submissionId) + '/edit', params);\n    }\n\n    /**\n     * Function called when we receive an event of submission changes.\n     *\n     * @param data Event data received.\n     */\n    protected eventReceived(data: AddonModWorkshopAutoSyncData |\n    AddonModWorkshopAssessmentSavedChangedEventData): void {\n        if (this.workshopId === data.workshopId) {\n            this.content?.scrollToTop();\n\n            this.loaded = false;\n            this.refreshAllData();\n        }\n    }\n\n    /**\n     * Fetch the submission data.\n     *\n     * @returns Resolved when done.\n     */\n    protected async fetchSubmissionData(): Promise<void> {\n        try {\n            this.submission = await AddonModWorkshopHelper.getSubmissionById(this.workshopId, this.submissionId, {\n                cmId: this.module.id,\n            });\n\n            const promises: Promise<void>[] = [];\n\n            this.submission.grade = this.submissionInfo?.grade;\n            this.submission.gradinggrade = this.submissionInfo?.gradinggrade;\n            this.submission.gradeover = this.submissionInfo?.gradeover;\n            this.userId = this.submission.authorid || this.userId;\n            this.canEdit = this.currentUserId == this.userId && this.access.cansubmit && this.access.modifyingsubmissionallowed;\n            this.canDelete = this.access.candeletesubmissions;\n\n            this.canAddFeedback = !this.assessmentId && this.workshop.phase > AddonModWorkshopPhase.PHASE_ASSESSMENT &&\n                this.workshop.phase < AddonModWorkshopPhase.PHASE_CLOSED && this.access.canoverridegrades;\n            this.ownAssessment = undefined;\n\n            if (this.access.canviewallassessments) {\n                // Get new data, different that came from stateParams.\n                promises.push(AddonModWorkshop.getSubmissionAssessments(this.workshopId, this.submissionId, {\n                    cmId: this.module.id,\n                }).then((subAssessments) => {\n                    // Only allow the student to delete their own submission if it's still editable and hasn't been assessed.\n                    if (this.canDelete) {\n                        this.canDelete = !subAssessments.length;\n                    }\n\n                    this.submissionInfo.reviewedby = subAssessments;\n\n                    this.submissionInfo.reviewedby.forEach((assessment) => {\n                        assessment = AddonModWorkshopHelper.realGradeValue(this.workshop, assessment);\n\n                        if (this.currentUserId == assessment.reviewerid) {\n                            this.ownAssessment = assessment;\n                            assessment.ownAssessment = true;\n                        }\n                    });\n\n                    return;\n                }));\n            } else if (this.currentUserId === this.userId && this.assessmentId) {\n                // Get new data, different that came from stateParams.\n                promises.push(AddonModWorkshop.getAssessment(this.workshopId, this.assessmentId, {\n                    cmId: this.module.id,\n                }).then((assessment) => {\n                    // Only allow the student to delete their own submission if it's still editable and hasn't been assessed.\n                    if (this.canDelete) {\n                        this.canDelete = !assessment;\n                    }\n\n                    this.submissionInfo.reviewedby = [this.parseAssessment(assessment)];\n\n                    return;\n                }));\n            } else if (this.workshop.phase === AddonModWorkshopPhase.PHASE_CLOSED && this.userId === this.currentUserId) {\n                const assessments = await AddonModWorkshop.getSubmissionAssessments(this.workshopId, this.submissionId, {\n                    cmId: this.module.id,\n                });\n\n                this.submissionInfo.reviewedby = assessments.map((assessment) => this.parseAssessment(assessment));\n            }\n\n            if (this.canAddFeedback || this.workshop.phase === AddonModWorkshopPhase.PHASE_CLOSED) {\n                this.evaluate = {\n                    published: this.submission.published,\n                    text: this.submission.feedbackauthor || '',\n                };\n            }\n\n            if (this.canAddFeedback) {\n                if (!this.isDestroyed) {\n                    // Block the workshop.\n                    CoreSync.blockOperation(this.component, this.workshopId);\n                }\n\n                promises.push(this.fillEvaluationsGrades());\n            } else if (this.workshop.phase === AddonModWorkshopPhase.PHASE_CLOSED && this.submission.gradeoverby &&\n                    this.evaluate && this.evaluate.text) {\n                promises.push(CoreUser.getProfile(this.submission.gradeoverby, this.courseId, true).then((profile) => {\n                    this.evaluateByProfile = profile;\n\n                    return;\n                }));\n            }\n\n            if (this.assessment && !this.access.assessingallowed && this.assessment.feedbackreviewer &&\n                    this.assessment.gradinggradeoverby) {\n                promises.push(CoreUser.getProfile(this.assessment.gradinggradeoverby, this.courseId, true)\n                    .then((profile) => {\n                        this.evaluateGradingByProfile = profile;\n\n                        return;\n                    }));\n            }\n\n            await Promise.all(promises);\n\n            const submissionsActions = await AddonModWorkshopOffline.getSubmissions(this.workshopId);\n\n            this.submission = await AddonModWorkshopHelper.applyOfflineData(this.submission, submissionsActions);\n        } catch (error) {\n            CoreDomUtils.showErrorModalDefault(error, 'core.course.errorgetmodule', true);\n        } finally {\n            this.loaded = true;\n        }\n    }\n\n    /**\n     * Fill evaluation grade info.\n     */\n    protected async fillEvaluationsGrades(): Promise<void> {\n        const defaultGrade = Translate.instant('addon.mod_workshop.notoverridden');\n\n        this.evaluationGrades = await CoreGradesHelper.makeGradesMenu(this.workshop.grade || 0, undefined, defaultGrade, -1);\n\n        if (!this.evaluate) {\n            // Should not happen.\n            return;\n        }\n\n        this.evaluate.grade = {\n            label: CoreGradesHelper.getGradeLabelFromValue(this.evaluationGrades, this.submissionInfo.gradeover) || defaultGrade,\n            value: this.submissionInfo.gradeover || -1,\n        };\n\n        try {\n            const offlineSubmission = await AddonModWorkshopOffline.getEvaluateSubmission(this.workshopId, this.submissionId);\n\n            this.hasOffline = true;\n            this.evaluate.published = offlineSubmission.published;\n            this.evaluate.text = offlineSubmission.feedbacktext;\n            this.evaluate.grade = {\n                label: CoreGradesHelper.getGradeLabelFromValue(this.evaluationGrades, parseInt(offlineSubmission.gradeover, 10)) ||\n                    defaultGrade,\n                value: offlineSubmission.gradeover || -1,\n            };\n        } catch {\n            // Ignore errors.\n            this.hasOffline = false;\n        } finally {\n            this.originalEvaluation.published = this.evaluate.published;\n            this.originalEvaluation.text = this.evaluate.text;\n            this.originalEvaluation.grade = this.evaluate.grade.value;\n\n            this.feedbackForm.controls['published'].setValue(this.evaluate.published);\n            this.feedbackForm.controls['grade'].setValue(this.evaluate.grade.value);\n            this.feedbackForm.controls['text'].setValue(this.evaluate.text);\n        }\n    }\n\n    /**\n     * Parse assessment to be shown.\n     *\n     * @param assessment Original assessment.\n     * @returns Parsed assessment.\n     */\n    protected parseAssessment(\n        assessment: AddonModWorkshopSubmissionAssessmentWithFormData,\n    ): AddonModWorkshopSubmissionAssessmentWithFormData {\n        assessment = AddonModWorkshopHelper.realGradeValue(this.workshop, assessment);\n\n        if (this.currentUserId == assessment.reviewerid) {\n            this.ownAssessment = assessment;\n            assessment.ownAssessment = true;\n        }\n\n        return assessment;\n    }\n\n    /**\n     * Force leaving the page, without checking for changes.\n     */\n    protected forceLeavePage(): void {\n        this.forceLeave = true;\n        CoreNavigator.back();\n    }\n\n    /**\n     * Check if data has changed.\n     *\n     * @returns True if changed, false otherwise.\n     */\n    protected hasEvaluationChanged(): boolean {\n        if (!this.loaded || !this.access.canoverridegrades) {\n            return false;\n        }\n\n        const inputData = this.feedbackForm.value;\n\n        if (this.originalEvaluation.published != inputData.published) {\n            return true;\n        }\n\n        if (this.originalEvaluation.text != inputData.text) {\n            return true;\n        }\n\n        if (this.originalEvaluation.grade != inputData.grade) {\n            return true;\n        }\n\n        return false;\n    }\n\n    /**\n     * Convenience function to refresh all the data.\n     *\n     * @returns Resolved when done.\n     */\n    protected async refreshAllData(): Promise<void> {\n        const promises: Promise<void>[] = [];\n\n        promises.push(AddonModWorkshop.invalidateSubmissionData(this.workshopId, this.submissionId));\n        promises.push(AddonModWorkshop.invalidateSubmissionsData(this.workshopId));\n        promises.push(AddonModWorkshop.invalidateSubmissionAssesmentsData(this.workshopId, this.submissionId));\n\n        if (this.assessmentId) {\n            promises.push(AddonModWorkshop.invalidateAssessmentFormData(this.workshopId, this.assessmentId));\n            promises.push(AddonModWorkshop.invalidateAssessmentData(this.workshopId, this.assessmentId));\n        }\n\n        if (this.assessmentUserId) {\n            promises.push(AddonModWorkshop.invalidateReviewerAssesmentsData(this.workshopId, this.assessmentId));\n        }\n\n        try {\n            await Promise.all(promises);\n        } finally {\n            CoreEvents.trigger(AddonModWorkshopProvider.ASSESSMENT_INVALIDATED, null, this.siteId);\n\n            await this.fetchSubmissionData();\n\n            this.logView();\n        }\n    }\n\n    /**\n     * Pull to refresh.\n     *\n     * @param refresher Refresher.\n     */\n    refreshSubmission(refresher: HTMLIonRefresherElement): void {\n        if (this.loaded) {\n            this.refreshAllData().finally(() => {\n                refresher?.complete();\n            });\n        }\n    }\n\n    /**\n     * Save the assessment.\n     */\n    async saveAssessment(): Promise<void> {\n        if (this.assessmentStrategy?.hasDataChanged()) {\n            try {\n                await this.assessmentStrategy.saveAssessment();\n                this.forceLeavePage();\n            } catch {\n                // Error, stay on the page.\n            }\n        } else {\n            // Nothing to save, just go back.\n            this.forceLeavePage();\n        }\n    }\n\n    /**\n     * Save the submission evaluation.\n     */\n    async saveEvaluation(): Promise<void> {\n        // Check if data has changed.\n        if (this.hasEvaluationChanged()) {\n            await this.sendEvaluation();\n            this.forceLeavePage();\n        } else {\n            // Nothing to save, just go back.\n            this.forceLeavePage();\n        }\n    }\n\n    /**\n     * Sends the evaluation to be saved on the server.\n     *\n     * @returns Resolved when done.\n     */\n    protected async sendEvaluation(): Promise<void> {\n        const modal = await CoreDomUtils.showModalLoading('core.sending', true);\n\n        const inputData: {\n            grade: number | string;\n            text: string;\n            published: boolean;\n        } = this.feedbackForm.value;\n\n        inputData.grade = Number(inputData.grade) >= 0 ? inputData.grade : '';\n        // Add some HTML to the message if needed.\n        inputData.text = CoreTextUtils.formatHtmlLines(inputData.text);\n\n        // Try to send it to server.\n        try {\n            const result = await AddonModWorkshop.evaluateSubmission(\n                this.workshopId,\n                this.submissionId,\n                this.courseId,\n                inputData.text,\n                inputData.published,\n                String(inputData.grade),\n            );\n            CoreForms.triggerFormSubmittedEvent(this.formElement, !!result, this.siteId);\n\n            await AddonModWorkshop.invalidateSubmissionData(this.workshopId, this.submissionId).finally(() => {\n                const data: AddonModWorkshopSubmissionChangedEventData = {\n                    workshopId: this.workshopId,\n                    submissionId: this.submissionId,\n                };\n\n                CoreEvents.trigger(AddonModWorkshopProvider.SUBMISSION_CHANGED, data, this.siteId);\n            });\n        } catch (message) {\n            CoreDomUtils.showErrorModalDefault(message, 'Cannot save submission evaluation');\n        } finally {\n            modal.dismiss();\n        }\n    }\n\n    /**\n     * Perform the submission delete action.\n     */\n    async deleteSubmission(): Promise<void> {\n        try {\n            await CoreDomUtils.showDeleteConfirm('addon.mod_workshop.submissiondeleteconfirm');\n        } catch {\n            return;\n        }\n\n        const modal = await CoreDomUtils.showModalLoading('core.deleting', true);\n\n        let success = false;\n        try {\n            await AddonModWorkshop.deleteSubmission(this.workshopId, this.submissionId, this.courseId);\n            success = true;\n\n            await AddonModWorkshop.invalidateSubmissionData(this.workshopId, this.submissionId);\n        } catch (error) {\n            CoreDomUtils.showErrorModalDefault(error, 'Cannot delete submission');\n        } finally {\n            modal.dismiss();\n            if (success) {\n                const data: AddonModWorkshopSubmissionChangedEventData = {\n                    workshopId: this.workshopId,\n                    submissionId: this.submissionId,\n                };\n\n                CoreEvents.trigger(AddonModWorkshopProvider.SUBMISSION_CHANGED, data, this.siteId);\n\n                this.forceLeavePage();\n            }\n        }\n    }\n\n    /**\n     * Undo the submission delete action.\n     *\n     * @returns Resolved when done.\n     */\n    async undoDeleteSubmission(): Promise<void> {\n        await AddonModWorkshopOffline.deleteSubmissionAction(\n            this.workshopId,\n            AddonModWorkshopAction.DELETE,\n        ).finally(async () => {\n\n            const data: AddonModWorkshopSubmissionChangedEventData = {\n                workshopId: this.workshopId,\n                submissionId: this.submissionId,\n            };\n\n            CoreEvents.trigger(AddonModWorkshopProvider.SUBMISSION_CHANGED, data, this.siteId);\n\n            await this.refreshAllData();\n        });\n    }\n\n    /**\n     * Log submission viewed.\n     */\n    protected async performLogView(): Promise<void> {\n        try {\n            await AddonModWorkshop.logViewSubmission(this.submissionId, this.workshopId);\n            CoreCourse.checkModuleCompletion(this.courseId, this.module.completiondata);\n        } catch {\n            // Ignore errors.\n        }\n\n        CoreAnalytics.logEvent({\n            type: CoreAnalyticsEventType.VIEW_ITEM,\n            ws: 'mod_workshop_view_submission',\n            name: this.workshop.name,\n            data: { id: this.workshop.id, submissionid: this.submissionId, category: 'workshop' },\n            url: `/mod/workshop/submission.php?cmid=${this.module.id}&id=${this.submissionId}`,\n        });\n    }\n\n    /**\n     * @inheritdoc\n     */\n    ngOnDestroy(): void {\n        this.isDestroyed = true;\n\n        this.syncObserver?.off();\n        this.obsAssessmentSaved?.off();\n        // Restore original back functions.\n        CoreSync.unblockOperation(this.component, this.workshopId);\n    }\n\n}\n\ntype AddonWorkshopSubmissionEvaluateData = {\n    published: boolean;\n    text: string;\n    grade?: CoreGradesMenuItem;\n};\n","<ion-header>\n    <ion-toolbar>\n        <ion-buttons slot=\"start\">\n            <ion-back-button [text]=\"'core.back' | translate\" />\n        </ion-buttons>\n        <ion-title>\n            <h1>\n                <core-format-text *ngIf=\"title\" [text]=\"title\" contextLevel=\"module\" [contextInstanceId]=\"module.id\"\n                    [courseId]=\"courseId\" />\n            </h1>\n        </ion-title>\n        <ion-buttons slot=\"end\" [hidden]=\"!loaded\">\n            <ion-button *ngIf=\"assessmentId && access.assessingallowed\" fill=\"clear\" (click)=\"saveAssessment()\"\n                [attr.aria-label]=\"'core.save' | translate\">\n                {{ 'core.save' | translate }}\n            </ion-button>\n            <ion-button *ngIf=\"canAddFeedback\" fill=\"clear\" (click)=\"saveEvaluation()\">\n                {{ 'core.save' | translate }}\n            </ion-button>\n        </ion-buttons>\n    </ion-toolbar>\n</ion-header>\n<ion-content class=\"limited-width\">\n    <ion-refresher slot=\"fixed\" [disabled]=\"!loaded\" (ionRefresh)=\"refreshSubmission($event.target)\"\n        *ngIf=\"!((assessmentId && access.assessingallowed) || canAddFeedback)\">\n        <ion-refresher-content pullingText=\"{{ 'core.pulltorefresh' | translate }}\" />\n    </ion-refresher>\n    <core-loading [hideUntil]=\"loaded\">\n        <ion-list *ngIf=\"submission\">\n            <addon-mod-workshop-submission [submission]=\"submission\" [courseId]=\"courseId\" [module]=\"module\" [workshop]=\"workshop\"\n                [access]=\"access\" />\n            <ion-item class=\"ion-text-wrap\" *ngIf=\"canEdit || canDelete\">\n                <ion-label>\n                    <ion-button expand=\"block\" *ngIf=\"canEdit\" (click)=\"editSubmission()\">\n                        <ion-icon name=\"fas-pen\" slot=\"start\" aria-hidden=\"true\" />\n                        {{ 'addon.mod_workshop.editsubmission' | translate }}\n                    </ion-button>\n                    <ion-button expand=\"block\" *ngIf=\"!submission.deleted && canDelete\" color=\"danger\" (click)=\"deleteSubmission()\">\n                        <ion-icon name=\"fas-trash\" slot=\"start\" aria-hidden=\"true\" />\n                        {{ 'addon.mod_workshop.deletesubmission' | translate }}\n                    </ion-button>\n                    <ion-button expand=\"block\" fill=\"outline\" *ngIf=\"submission.deleted && canDelete\" color=\"danger\"\n                        (click)=\"undoDeleteSubmission()\">\n                        <ion-icon name=\"fas-rotate-left\" slot=\"start\" aria-hidden=\"true\" />\n                        {{ 'core.restore' | translate }}\n                    </ion-button>\n                </ion-label>\n            </ion-item>\n        </ion-list>\n\n        <ion-list *ngIf=\"!canAddFeedback && evaluate?.text\">\n            <ion-item class=\"ion-text-wrap\">\n                <core-user-avatar *ngIf=\"evaluateByProfile\" [user]=\"evaluateByProfile\" slot=\"start\" [courseId]=\"courseId\"\n                    [userId]=\"evaluateByProfile.id\" />\n                <ion-label>\n                    <h2 *ngIf=\"evaluateByProfile && evaluateByProfile.fullname\">\n                        {{ 'addon.mod_workshop.feedbackby' | translate : {$a: evaluateByProfile.fullname} }}\n                    </h2>\n                    <core-format-text [text]=\"evaluate?.text\" contextLevel=\"module\" [contextInstanceId]=\"module.id\" [courseId]=\"courseId\" />\n                </ion-label>\n            </ion-item>\n        </ion-list>\n\n        <ion-list *ngIf=\"ownAssessment && !assessment\">\n            <ion-item class=\"ion-text-wrap\">\n                <ion-label>\n                    <h2>{{ 'addon.mod_workshop.yourassessment' | translate }}</h2>\n                </ion-label>\n            </ion-item>\n            <addon-mod-workshop-assessment [submission]=\"submission\" [assessment]=\"ownAssessment\" [courseId]=\"courseId\" [access]=\"access\"\n                [module]=\"module\" [workshop]=\"workshop\" />\n        </ion-list>\n\n        <ion-list *ngIf=\"submissionInfo && submissionInfo.reviewedby && submissionInfo.reviewedby.length && !assessment\">\n            <ion-item class=\"ion-text-wrap\">\n                <ion-label>\n                    <h3 class=\"item-heading\">{{ 'addon.mod_workshop.receivedgrades' | translate }}</h3>\n                </ion-label>\n            </ion-item>\n            <ng-container *ngFor=\"let reviewer of submissionInfo.reviewedby\">\n                <addon-mod-workshop-assessment *ngIf=\"!reviewer.ownAssessment\" [submission]=\"submission\" [assessment]=\"reviewer\"\n                    [courseId]=\"courseId\" [access]=\"access\" [module]=\"module\" [workshop]=\"workshop\" />\n            </ng-container>\n        </ion-list>\n\n        <ion-list *ngIf=\"submissionInfo && submissionInfo.reviewerof && submissionInfo.reviewerof.length && !assessment\">\n            <ion-item class=\"ion-text-wrap\">\n                <ion-label>\n                    <h3 class=\"item-heading\">{{ 'addon.mod_workshop.givengrades' | translate }}</h3>\n                </ion-label>\n            </ion-item>\n            <addon-mod-workshop-assessment *ngFor=\"let reviewer of submissionInfo.reviewerof\" [assessment]=\"reviewer\" [courseId]=\"courseId\"\n                [module]=\"module\" [workshop]=\"workshop\" [access]=\"access\" />\n        </ion-list>\n\n        <form [formGroup]=\"feedbackForm\" *ngIf=\"canAddFeedback && submission\" #feedbackFormEl>\n            <ion-item class=\"ion-text-wrap\">\n                <ion-label>\n                    <h3 class=\"item-heading\">{{ 'addon.mod_workshop.feedbackauthor' | translate }}</h3>\n                </ion-label>\n            </ion-item>\n            <ion-item class=\"ion-text-wrap\" *ngIf=\"access.canpublishsubmissions\">\n                <ion-label>\n                    <p class=\"item-heading\">{{ 'addon.mod_workshop.publishsubmission' | translate }}</p>\n                    <p>{{ 'addon.mod_workshop.publishsubmission_help' | translate }}</p>\n                </ion-label>\n                <ion-toggle formControlName=\"published\" slot=\"end\" />\n            </ion-item>\n\n            <ion-item class=\"ion-text-wrap\">\n                <ion-label>\n                    <h3 class=\"item-heading\">{{ 'addon.mod_workshop.gradecalculated' | translate }}</h3>\n                    <p>{{ submission.grade }}</p>\n                </ion-label>\n            </ion-item>\n            <ion-item class=\"ion-text-wrap\">\n                <ion-label position=\"stacked\">{{ 'addon.mod_workshop.gradeover' | translate }}</ion-label>\n                <ion-select formControlName=\"grade\" interface=\"action-sheet\" [cancelText]=\"'core.cancel' | translate\"\n                    [interfaceOptions]=\"{header: 'addon.mod_workshop.gradeover' | translate}\">\n                    <ion-select-option *ngFor=\"let grade of evaluationGrades\" [value]=\"grade.value\">\n                        {{grade.label}}\n                    </ion-select-option>\n                </ion-select>\n            </ion-item>\n            <ion-item>\n                <ion-label position=\"stacked\">{{ 'addon.mod_workshop.feedbackauthor' | translate }}</ion-label>\n                <core-rich-text-editor [control]=\"feedbackForm.controls['text']\" name=\"text\" [autoSave]=\"true\" contextLevel=\"module\"\n                    [contextInstanceId]=\"module.id\" elementId=\"feedbackauthor_editor\" [draftExtraParams]=\"{id: submissionId}\" />\n            </ion-item>\n        </form>\n\n        <addon-mod-workshop-assessment-strategy *ngIf=\"assessmentId\" [workshop]=\"workshop\" [access]=\"access\" [assessmentId]=\"assessmentId\"\n            [userId]=\"assessmentUserId\" [strategy]=\"strategy\" [edit]=\"access.assessingallowed\" />\n\n        <ion-list *ngIf=\"assessmentId && !access.assessingallowed && assessment?.feedbackreviewer\">\n            <ion-item class=\"ion-text-wrap\">\n                <core-user-avatar *ngIf=\"evaluateGradingByProfile\" [user]=\"evaluateGradingByProfile\" slot=\"start\" [courseId]=\"courseId\"\n                    [userId]=\"evaluateGradingByProfile.id\" />\n                <ion-label>\n                    <h3 class=\"item-heading\" *ngIf=\"evaluateGradingByProfile && evaluateGradingByProfile.fullname\">\n                        {{ 'addon.mod_workshop.feedbackby' | translate : {$a: evaluateGradingByProfile.fullname} }}\n                    </h3>\n                    <core-format-text [text]=\"assessment!.feedbackreviewer\" contextLevel=\"module\" [contextInstanceId]=\"module.id\"\n                        [courseId]=\"courseId\" />\n                </ion-label>\n            </ion-item>\n        </ion-list>\n    </core-loading>\n</ion-content>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
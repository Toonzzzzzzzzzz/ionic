{"ast":null,"code":"import _asyncToGenerator from \"/home/toon/works/gitionic7/ionic-github/ionic/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _class;\nimport { PageLoadsManager } from '@classes/page-loads-manager';\nimport { CorePromisedValue } from '@classes/promised-value';\nimport { CoreBlockComponent } from '@features/block/components/block/block';\nimport { CoreBlockDelegate } from '@features/block/services/block-delegate';\nimport { CoreCoursesDashboard, CoreCoursesDashboardProvider } from '@features/courses/services/dashboard';\nimport { CoreMainMenuDeepLinkManager } from '@features/mainmenu/classes/deep-link-manager';\nimport { CoreSites } from '@services/sites';\nimport { CoreDomUtils } from '@services/utils/dom';\nimport { CoreUtils } from '@services/utils/utils';\nimport { CoreEvents } from '@singletons/events';\nimport { CoreCourses } from '../../services/courses';\nimport { CoreTime } from '@singletons/time';\nimport { CoreAnalytics, CoreAnalyticsEventType } from '@services/analytics';\nimport { Translate } from '@singletons';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@classes/page-loads-manager\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"../../../../components/empty-box/empty-box\";\nimport * as i4 from \"../../../../components/loading/loading\";\nimport * as i5 from \"../../../../directives/fa-icon\";\nimport * as i6 from \"../../../../directives/format-text\";\nimport * as i7 from \"../../../../directives/content\";\nimport * as i8 from \"../../../../directives/update-non-reactive-attributes\";\nimport * as i9 from \"@ionic/angular\";\nimport * as i10 from \"../../../block/components/block/block\";\nimport * as i11 from \"../../../block/components/side-blocks-button/side-blocks-button\";\nimport * as i12 from \"../../../mainmenu/components/user-menu-button/user-menu-button\";\nimport * as i13 from \"@ngx-translate/core\";\nfunction CoreCoursesMyPage_div_22_ion_button_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-button\", 19);\n    i0.ɵɵlistener(\"click\", function CoreCoursesMyPage_div_22_ion_button_1_Template_ion_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r7 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r7.myOverviewBlock.prefetchCourses());\n    });\n    i0.ɵɵpipe(1, \"translate\");\n    i0.ɵɵelement(2, \"ion-icon\", 20);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext(2);\n    i0.ɵɵattribute(\"aria-label\", i0.ɵɵpipeBind1(1, 2, ctx_r4.myOverviewBlock.prefetchCoursesData.statusTranslatable));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"name\", ctx_r4.myOverviewBlock.prefetchCoursesData.icon);\n  }\n}\nfunction CoreCoursesMyPage_div_22_ion_badge_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-badge\", 21);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext(2);\n    i0.ɵɵattribute(\"aria-valuemax\", ctx_r5.myOverviewBlock.prefetchCoursesData.total)(\"aria-valuenow\", ctx_r5.myOverviewBlock.prefetchCoursesData.count)(\"aria-valuetext\", ctx_r5.myOverviewBlock.prefetchCoursesData.badgeA11yText);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r5.myOverviewBlock.prefetchCoursesData.badge, \" \");\n  }\n}\nfunction CoreCoursesMyPage_div_22_ion_spinner_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"ion-spinner\");\n    i0.ɵɵpipe(1, \"translate\");\n  }\n  if (rf & 2) {\n    i0.ɵɵattribute(\"aria-label\", i0.ɵɵpipeBind1(1, 1, \"core.loading\"));\n  }\n}\nfunction CoreCoursesMyPage_div_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 15);\n    i0.ɵɵtemplate(1, CoreCoursesMyPage_div_22_ion_button_1_Template, 3, 4, \"ion-button\", 16);\n    i0.ɵɵtemplate(2, CoreCoursesMyPage_div_22_ion_badge_2_Template, 2, 4, \"ion-badge\", 17);\n    i0.ɵɵtemplate(3, CoreCoursesMyPage_div_22_ion_spinner_3_Template, 2, 3, \"ion-spinner\", 18);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r0.myOverviewBlock.prefetchCoursesData.loading);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.myOverviewBlock.prefetchCoursesData.badge);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.myOverviewBlock.prefetchCoursesData.loading);\n  }\n}\nfunction CoreCoursesMyPage_core_block_24_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"core-block\", 22);\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"block\", ctx_r1.loadedBlock)(\"instanceId\", ctx_r1.userId);\n  }\n}\nfunction CoreCoursesMyPage_core_block_side_blocks_button_25_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"core-block-side-blocks-button\", 23);\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"instanceId\", ctx_r2.userId)(\"myDashboardPage\", ctx_r2.myPageCourses);\n  }\n}\nfunction CoreCoursesMyPage_core_empty_box_26_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"core-empty-box\", 24);\n    i0.ɵɵpipe(1, \"translate\");\n  }\n  if (rf & 2) {\n    i0.ɵɵproperty(\"message\", i0.ɵɵpipeBind1(1, 1, \"core.course.nocontentavailable\"));\n  }\n}\n/**\n * Page that shows a my courses.\n */\nexport class CoreCoursesMyPage {\n  constructor(loadsManager) {\n    var _this = this;\n    this.loadsManager = loadsManager;\n    this.siteName = '';\n    this.downloadCoursesEnabled = false;\n    this.loaded = false;\n    this.myPageCourses = CoreCoursesDashboardProvider.MY_PAGE_COURSES;\n    this.hasSideBlocks = false;\n    this.onReadyPromise = new CorePromisedValue();\n    // Refresh the enabled flags if site is updated.\n    this.updateSiteObserver = CoreEvents.on(CoreEvents.SITE_UPDATED, /*#__PURE__*/_asyncToGenerator(function* () {\n      _this.downloadCoursesEnabled = !CoreCourses.isDownloadCoursesDisabledInSite();\n      yield _this.loadSiteName();\n    }), CoreSites.getCurrentSiteId());\n    this.userId = CoreSites.getCurrentSiteUserId();\n    this.loadsManagerSubscription = this.loadsManager.onRefreshPage.subscribe(() => {\n      this.loaded = false;\n      this.loadContent();\n    });\n    this.logView = CoreTime.once( /*#__PURE__*/_asyncToGenerator(function* () {\n      yield CoreUtils.ignoreErrors(CoreCourses.logView('my'));\n      CoreAnalytics.logEvent({\n        type: CoreAnalyticsEventType.VIEW_ITEM,\n        ws: 'core_my_view_page',\n        name: Translate.instant('core.courses.mycourses'),\n        data: {\n          category: 'course',\n          page: 'my'\n        },\n        url: '/my/courses.php'\n      });\n    }));\n  }\n  /**\n   * @inheritdoc\n   */\n  ngOnInit() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      _this2.downloadCoursesEnabled = !CoreCourses.isDownloadCoursesDisabledInSite();\n      const deepLinkManager = new CoreMainMenuDeepLinkManager();\n      deepLinkManager.treatLink();\n      yield _this2.loadSiteName();\n      _this2.loadContent(true);\n    })();\n  }\n  /**\n   * Load data.\n   *\n   * @param firstLoad Whether it's the first load.\n   */\n  loadContent(firstLoad = false) {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      var _CoreSites$getCurrent;\n      const loadWatcher = _this3.loadsManager.startPageLoad(_this3, !!firstLoad);\n      const available = yield CoreCoursesDashboard.isAvailable();\n      const disabled = yield CoreCourses.isMyCoursesDisabled();\n      const supportsMyParam = !!((_CoreSites$getCurrent = CoreSites.getCurrentSite()) !== null && _CoreSites$getCurrent !== void 0 && _CoreSites$getCurrent.isVersionGreaterEqualThan('4.0'));\n      if (available && !disabled) {\n        try {\n          var _this3$block;\n          const blocks = yield loadWatcher.watchRequest(CoreCoursesDashboard.getDashboardBlocksObservable({\n            myPage: supportsMyParam ? _this3.myPageCourses : undefined,\n            readingStrategy: loadWatcher.getReadingStrategy()\n          }));\n          // My overview block should always be in main blocks, but check side blocks too just in case.\n          _this3.loadedBlock = blocks.mainBlocks.concat(blocks.sideBlocks).find(block => block.name == 'myoverview');\n          _this3.hasSideBlocks = supportsMyParam && CoreBlockDelegate.hasSupportedBlock(blocks.sideBlocks);\n          yield CoreUtils.nextTicks(2);\n          _this3.myOverviewBlock = (_this3$block = _this3.block) === null || _this3$block === void 0 || (_this3$block = _this3$block.dynamicComponent) === null || _this3$block === void 0 ? void 0 : _this3$block.instance;\n          if (!_this3.loadedBlock && !supportsMyParam) {\n            // In old sites, display the block even if not found in Dashboard.\n            // This is because the \"My courses\" page doesn't exist in the site so it can't be configured.\n            _this3.loadFallbackBlock();\n          }\n        } catch (error) {\n          CoreDomUtils.showErrorModal(error);\n          // Cannot get the blocks, just show the block if needed.\n          _this3.loadFallbackBlock();\n        }\n      } else if (!available) {\n        // WS not available, show fallback block.\n        _this3.loadFallbackBlock();\n      } else {\n        _this3.loadedBlock = undefined;\n      }\n      _this3.loaded = true;\n      _this3.onReadyPromise.resolve();\n      _this3.logView();\n    })();\n  }\n  /**\n   * Load the site name.\n   */\n  loadSiteName() {\n    var _this4 = this;\n    return _asyncToGenerator(function* () {\n      const site = CoreSites.getRequiredCurrentSite();\n      _this4.siteName = (yield site.getSiteName()) || '';\n    })();\n  }\n  /**\n   * Load fallback blocks.\n   */\n  loadFallbackBlock() {\n    this.loadedBlock = {\n      name: 'myoverview',\n      visible: true\n    };\n  }\n  /**\n   * Refresh the data.\n   *\n   * @param refresher Refresher.\n   */\n  refresh(refresher) {\n    var _this5 = this;\n    return _asyncToGenerator(function* () {\n      const promises = [];\n      promises.push(CoreCoursesDashboard.invalidateDashboardBlocks(CoreCoursesDashboardProvider.MY_PAGE_COURSES));\n      // Invalidate the blocks.\n      if (_this5.myOverviewBlock) {\n        promises.push(CoreUtils.ignoreErrors(_this5.myOverviewBlock.invalidateContent()));\n      }\n      Promise.all(promises).finally(() => {\n        _this5.loadContent().finally(() => {\n          refresher === null || refresher === void 0 || refresher.complete();\n        });\n      });\n    })();\n  }\n  /**\n   * @inheritdoc\n   */\n  ngOnDestroy() {\n    var _this$updateSiteObser;\n    (_this$updateSiteObser = this.updateSiteObserver) === null || _this$updateSiteObser === void 0 || _this$updateSiteObser.off();\n    this.loadsManagerSubscription.unsubscribe();\n  }\n  /**\n   * @inheritdoc\n   */\n  ready() {\n    var _this6 = this;\n    return _asyncToGenerator(function* () {\n      return yield _this6.onReadyPromise;\n    })();\n  }\n}\n_class = CoreCoursesMyPage;\n_class.ɵfac = function CoreCoursesMyPage_Factory(t) {\n  return new (t || _class)(i0.ɵɵdirectiveInject(i1.PageLoadsManager));\n};\n_class.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: _class,\n  selectors: [[\"page-core-courses-my\"]],\n  viewQuery: function CoreCoursesMyPage_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(CoreBlockComponent, 5);\n    }\n    if (rf & 2) {\n      let _t;\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.block = _t.first);\n    }\n  },\n  features: [i0.ɵɵProvidersFeature([{\n    provide: PageLoadsManager,\n    useClass: PageLoadsManager\n  }])],\n  decls: 27,\n  vars: 18,\n  consts: [[\"slot\", \"start\"], [3, \"text\"], [\"contextLevel\", \"system\", 1, \"core-header-sitename\", 3, \"text\", \"contextInstanceId\"], [\"src\", \"assets/img/top_logo.png\", 1, \"core-header-logo\", 3, \"alt\"], [\"slot\", \"end\"], [\"slot\", \"fixed\", 3, \"disabled\", \"ionRefresh\"], [3, \"pullingText\"], [3, \"hideUntil\"], [1, \"ion-text-wrap\", \"divider\"], [\"id\", \"core-courses-my-title\", 1, \"big\"], [\"slot\", \"end\", 1, \"flex-row\"], [\"class\", \"core-button-spinner\", 4, \"ngIf\"], [\"contextLevel\", \"user\", \"labelledBy\", \"core-courses-my-title\", 3, \"block\", \"instanceId\", 4, \"ngIf\"], [\"slot\", \"fixed\", \"contextLevel\", \"user\", 3, \"instanceId\", \"myDashboardPage\", 4, \"ngIf\"], [\"icon\", \"fas-cubes\", 3, \"message\", 4, \"ngIf\"], [1, \"core-button-spinner\"], [\"fill\", \"clear\", 3, \"click\", 4, \"ngIf\"], [\"class\", \"core-course-download-courses-progress\", \"role\", \"progressbar\", 4, \"ngIf\"], [4, \"ngIf\"], [\"fill\", \"clear\", 3, \"click\"], [\"slot\", \"icon-only\", \"aria-hidden\", \"true\", 3, \"name\"], [\"role\", \"progressbar\", 1, \"core-course-download-courses-progress\"], [\"contextLevel\", \"user\", \"labelledBy\", \"core-courses-my-title\", 3, \"block\", \"instanceId\"], [\"slot\", \"fixed\", \"contextLevel\", \"user\", 3, \"instanceId\", \"myDashboardPage\"], [\"icon\", \"fas-cubes\", 3, \"message\"]],\n  template: function CoreCoursesMyPage_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"ion-header\")(1, \"ion-toolbar\")(2, \"ion-buttons\", 0);\n      i0.ɵɵelement(3, \"ion-back-button\", 1);\n      i0.ɵɵpipe(4, \"translate\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(5, \"ion-title\")(6, \"h1\");\n      i0.ɵɵelement(7, \"core-format-text\", 2)(8, \"img\", 3);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(9, \"ion-buttons\", 4);\n      i0.ɵɵelement(10, \"core-user-menu-button\");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(11, \"ion-content\")(12, \"ion-refresher\", 5);\n      i0.ɵɵlistener(\"ionRefresh\", function CoreCoursesMyPage_Template_ion_refresher_ionRefresh_12_listener($event) {\n        return ctx.refresh($event.target);\n      });\n      i0.ɵɵelement(13, \"ion-refresher-content\", 6);\n      i0.ɵɵpipe(14, \"translate\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(15, \"core-loading\", 7)(16, \"ion-item\", 8)(17, \"ion-label\")(18, \"h2\", 9);\n      i0.ɵɵtext(19);\n      i0.ɵɵpipe(20, \"translate\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(21, \"div\", 10);\n      i0.ɵɵtemplate(22, CoreCoursesMyPage_div_22_Template, 4, 3, \"div\", 11);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(23, \"ion-list\");\n      i0.ɵɵtemplate(24, CoreCoursesMyPage_core_block_24_Template, 1, 2, \"core-block\", 12);\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(25, CoreCoursesMyPage_core_block_side_blocks_button_25_Template, 1, 2, \"core-block-side-blocks-button\", 13);\n      i0.ɵɵtemplate(26, CoreCoursesMyPage_core_empty_box_26_Template, 2, 3, \"core-empty-box\", 14);\n      i0.ɵɵelementEnd()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"text\", i0.ɵɵpipeBind1(4, 12, \"core.back\"));\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"text\", ctx.siteName)(\"contextInstanceId\", 0);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"alt\", ctx.siteName);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"disabled\", !ctx.loaded);\n      i0.ɵɵadvance(1);\n      i0.ɵɵpropertyInterpolate(\"pullingText\", i0.ɵɵpipeBind1(14, 14, \"core.pulltorefresh\"));\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"hideUntil\", ctx.loaded);\n      i0.ɵɵadvance(4);\n      i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(20, 16, \"core.courses.mycourses\"));\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngIf\", ctx.downloadCoursesEnabled && ctx.myOverviewBlock && ctx.myOverviewBlock.filteredCourses.length > 0);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", ctx.loadedBlock == null ? null : ctx.loadedBlock.visible);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.hasSideBlocks);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", !ctx.loadedBlock);\n    }\n  },\n  dependencies: [i2.NgIf, i3.CoreEmptyBoxComponent, i4.CoreLoadingComponent, i5.CoreFaIconDirective, i6.CoreFormatTextDirective, i7.CoreContentDirective, i8.CoreUpdateNonReactiveAttributesDirective, i9.IonBadge, i9.IonButton, i9.IonButtons, i9.IonContent, i9.IonHeader, i9.IonIcon, i9.IonItem, i9.IonLabel, i9.IonList, i9.IonRefresher, i9.IonRefresherContent, i9.IonSpinner, i9.IonTitle, i9.IonToolbar, i9.IonBackButton, i10.CoreBlockComponent, i11.CoreBlockSideBlocksButtonComponent, i12.CoreMainMenuUserButtonComponent, i13.TranslatePipe],\n  styles: [\"[_nghost-%COMP%]     ion-item-divider {\\n  display: none !important;\\n}\\n\\n[_nghost-%COMP%]     core-loading {\\n  --internal-loading-inline-min-height: calc(100vh - var(--core-header-toolbar-height));\\n}\\n\\nion-tabs.placement-bottom[_nghost-%COMP%]     core-loading, ion-tabs.placement-bottom   [_nghost-%COMP%]     core-loading {\\n  --internal-loading-inline-min-height: calc(100vh - var(--core-header-toolbar-height) - var(--bottom-tabs-size) - 2px);\\n}\\n\\ncore-block[_ngcontent-%COMP%]     ion-card.addon-block-myoverview {\\n  --border-width: 0;\\n  --background: transparent;\\n  margin: 0;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9jb3JlL2ZlYXR1cmVzL2NvdXJzZXMvcGFnZXMvbXkvbXkuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLHdCQUFBO0FBQ0o7O0FBQ0E7RUFDSSxxRkFBQTtBQUVKOztBQUNBO0VBQ0kscUhBQUE7QUFFSjs7QUFDQTtFQUNJLGlCQUFBO0VBQ0EseUJBQUE7RUFDQSxTQUFBO0FBRUoiLCJzb3VyY2VzQ29udGVudCI6WyI6aG9zdCA6Om5nLWRlZXAgaW9uLWl0ZW0tZGl2aWRlciB7XG4gICAgZGlzcGxheTogbm9uZSAhaW1wb3J0YW50O1xufVxuOmhvc3QgOjpuZy1kZWVwIGNvcmUtbG9hZGluZyB7XG4gICAgLS1pbnRlcm5hbC1sb2FkaW5nLWlubGluZS1taW4taGVpZ2h0OiBjYWxjKDEwMHZoIC0gdmFyKC0tY29yZS1oZWFkZXItdG9vbGJhci1oZWlnaHQpKTtcbn1cblxuOmhvc3QtY29udGV4dChpb24tdGFicy5wbGFjZW1lbnQtYm90dG9tKSA6Om5nLWRlZXAgY29yZS1sb2FkaW5nIHtcbiAgICAtLWludGVybmFsLWxvYWRpbmctaW5saW5lLW1pbi1oZWlnaHQ6IGNhbGMoMTAwdmggLSB2YXIoLS1jb3JlLWhlYWRlci10b29sYmFyLWhlaWdodCkgLSB2YXIoLS1ib3R0b20tdGFicy1zaXplKSAtIDJweCk7XG59XG5cbmNvcmUtYmxvY2sgOjpuZy1kZWVwIGlvbi1jYXJkLmFkZG9uLWJsb2NrLW15b3ZlcnZpZXcge1xuICAgIC0tYm9yZGVyLXdpZHRoOiAwO1xuICAgIC0tYmFja2dyb3VuZDogdHJhbnNwYXJlbnQ7XG4gICAgbWFyZ2luOiAwO1xufVxuIl0sInNvdXJjZVJvb3QiOiIifQ== */\"]\n});","map":{"version":3,"names":["PageLoadsManager","CorePromisedValue","CoreBlockComponent","CoreBlockDelegate","CoreCoursesDashboard","CoreCoursesDashboardProvider","CoreMainMenuDeepLinkManager","CoreSites","CoreDomUtils","CoreUtils","CoreEvents","CoreCourses","CoreTime","CoreAnalytics","CoreAnalyticsEventType","Translate","i0","ɵɵelementStart","ɵɵlistener","CoreCoursesMyPage_div_22_ion_button_1_Template_ion_button_click_0_listener","ɵɵrestoreView","_r8","ctx_r7","ɵɵnextContext","ɵɵresetView","myOverviewBlock","prefetchCourses","ɵɵelement","ɵɵelementEnd","ɵɵattribute","ɵɵpipeBind1","ctx_r4","prefetchCoursesData","statusTranslatable","ɵɵadvance","ɵɵproperty","icon","ɵɵtext","ctx_r5","total","count","badgeA11yText","ɵɵtextInterpolate1","badge","ɵɵtemplate","CoreCoursesMyPage_div_22_ion_button_1_Template","CoreCoursesMyPage_div_22_ion_badge_2_Template","CoreCoursesMyPage_div_22_ion_spinner_3_Template","ctx_r0","loading","ctx_r1","loadedBlock","userId","ctx_r2","myPageCourses","CoreCoursesMyPage","constructor","loadsManager","_this","siteName","downloadCoursesEnabled","loaded","MY_PAGE_COURSES","hasSideBlocks","onReadyPromise","updateSiteObserver","on","SITE_UPDATED","_asyncToGenerator","isDownloadCoursesDisabledInSite","loadSiteName","getCurrentSiteId","getCurrentSiteUserId","loadsManagerSubscription","onRefreshPage","subscribe","loadContent","logView","once","ignoreErrors","logEvent","type","VIEW_ITEM","ws","name","instant","data","category","page","url","ngOnInit","_this2","deepLinkManager","treatLink","firstLoad","_this3","_CoreSites$getCurrent","loadWatcher","startPageLoad","available","isAvailable","disabled","isMyCoursesDisabled","supportsMyParam","getCurrentSite","isVersionGreaterEqualThan","_this3$block","blocks","watchRequest","getDashboardBlocksObservable","myPage","undefined","readingStrategy","getReadingStrategy","mainBlocks","concat","sideBlocks","find","block","hasSupportedBlock","nextTicks","dynamicComponent","instance","loadFallbackBlock","error","showErrorModal","resolve","_this4","site","getRequiredCurrentSite","getSiteName","visible","refresh","refresher","_this5","promises","push","invalidateDashboardBlocks","invalidateContent","Promise","all","finally","complete","ngOnDestroy","_this$updateSiteObser","off","unsubscribe","ready","_this6","ɵɵdirectiveInject","i1","selectors","viewQuery","CoreCoursesMyPage_Query","rf","ctx","provide","useClass","decls","vars","consts","template","CoreCoursesMyPage_Template","CoreCoursesMyPage_Template_ion_refresher_ionRefresh_12_listener","$event","target","CoreCoursesMyPage_div_22_Template","CoreCoursesMyPage_core_block_24_Template","CoreCoursesMyPage_core_block_side_blocks_button_25_Template","CoreCoursesMyPage_core_empty_box_26_Template","ɵɵpropertyInterpolate","ɵɵtextInterpolate","filteredCourses","length"],"sources":["/home/toon/works/gitionic7/ionic-github/ionic/src/core/features/courses/pages/my/my.ts","/home/toon/works/gitionic7/ionic-github/ionic/src/core/features/courses/pages/my/my.html"],"sourcesContent":["// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { AddonBlockMyOverviewComponent } from '@addons/block/myoverview/components/myoverview/myoverview';\nimport { Component, OnDestroy, OnInit, ViewChild } from '@angular/core';\nimport { AsyncDirective } from '@classes/async-directive';\nimport { PageLoadsManager } from '@classes/page-loads-manager';\nimport { CorePromisedValue } from '@classes/promised-value';\nimport { CoreBlockComponent } from '@features/block/components/block/block';\nimport { CoreBlockDelegate } from '@features/block/services/block-delegate';\nimport { CoreCourseBlock } from '@features/course/services/course';\nimport { CoreCoursesDashboard, CoreCoursesDashboardProvider } from '@features/courses/services/dashboard';\nimport { CoreMainMenuDeepLinkManager } from '@features/mainmenu/classes/deep-link-manager';\nimport { CoreSites } from '@services/sites';\nimport { CoreDomUtils } from '@services/utils/dom';\nimport { CoreUtils } from '@services/utils/utils';\nimport { CoreEventObserver, CoreEvents } from '@singletons/events';\nimport { Subscription } from 'rxjs';\nimport { CoreCourses } from '../../services/courses';\nimport { CoreTime } from '@singletons/time';\nimport { CoreAnalytics, CoreAnalyticsEventType } from '@services/analytics';\nimport { Translate } from '@singletons';\n\n/**\n * Page that shows a my courses.\n */\n@Component({\n    selector: 'page-core-courses-my',\n    templateUrl: 'my.html',\n    styleUrls: ['my.scss'],\n    providers: [{\n        provide: PageLoadsManager,\n        useClass: PageLoadsManager,\n    }],\n})\nexport class CoreCoursesMyPage implements OnInit, OnDestroy, AsyncDirective {\n\n    @ViewChild(CoreBlockComponent) block!: CoreBlockComponent;\n\n    siteName = '';\n    downloadCoursesEnabled = false;\n    userId: number;\n    loadedBlock?: Partial<CoreCourseBlock>;\n    myOverviewBlock?: AddonBlockMyOverviewComponent;\n    loaded = false;\n    myPageCourses = CoreCoursesDashboardProvider.MY_PAGE_COURSES;\n    hasSideBlocks = false;\n\n    protected updateSiteObserver: CoreEventObserver;\n    protected onReadyPromise = new CorePromisedValue<void>();\n    protected loadsManagerSubscription: Subscription;\n    protected logView: () => void;\n\n    constructor(protected loadsManager: PageLoadsManager) {\n        // Refresh the enabled flags if site is updated.\n        this.updateSiteObserver = CoreEvents.on(CoreEvents.SITE_UPDATED, async () => {\n            this.downloadCoursesEnabled = !CoreCourses.isDownloadCoursesDisabledInSite();\n            await this.loadSiteName();\n\n        }, CoreSites.getCurrentSiteId());\n\n        this.userId = CoreSites.getCurrentSiteUserId();\n\n        this.loadsManagerSubscription = this.loadsManager.onRefreshPage.subscribe(() => {\n            this.loaded = false;\n            this.loadContent();\n        });\n\n        this.logView = CoreTime.once(async () => {\n            await CoreUtils.ignoreErrors(CoreCourses.logView('my'));\n\n            CoreAnalytics.logEvent({\n                type: CoreAnalyticsEventType.VIEW_ITEM,\n                ws: 'core_my_view_page',\n                name: Translate.instant('core.courses.mycourses'),\n                data: { category: 'course', page: 'my' },\n                url: '/my/courses.php',\n            });\n        });\n    }\n\n    /**\n     * @inheritdoc\n     */\n    async ngOnInit(): Promise<void> {\n        this.downloadCoursesEnabled = !CoreCourses.isDownloadCoursesDisabledInSite();\n\n        const deepLinkManager = new CoreMainMenuDeepLinkManager();\n        deepLinkManager.treatLink();\n\n        await this.loadSiteName();\n\n        this.loadContent(true);\n    }\n\n    /**\n     * Load data.\n     *\n     * @param firstLoad Whether it's the first load.\n     */\n    protected async loadContent(firstLoad = false): Promise<void> {\n        const loadWatcher = this.loadsManager.startPageLoad(this, !!firstLoad);\n        const available = await CoreCoursesDashboard.isAvailable();\n        const disabled = await CoreCourses.isMyCoursesDisabled();\n\n        const supportsMyParam = !!CoreSites.getCurrentSite()?.isVersionGreaterEqualThan('4.0');\n\n        if (available && !disabled) {\n            try {\n                const blocks = await loadWatcher.watchRequest(\n                    CoreCoursesDashboard.getDashboardBlocksObservable({\n                        myPage: supportsMyParam ? this.myPageCourses : undefined,\n                        readingStrategy: loadWatcher.getReadingStrategy(),\n                    }),\n                );\n\n                // My overview block should always be in main blocks, but check side blocks too just in case.\n                this.loadedBlock = blocks.mainBlocks.concat(blocks.sideBlocks).find((block) => block.name == 'myoverview');\n                this.hasSideBlocks = supportsMyParam && CoreBlockDelegate.hasSupportedBlock(blocks.sideBlocks);\n\n                await CoreUtils.nextTicks(2);\n\n                this.myOverviewBlock = this.block?.dynamicComponent?.instance as AddonBlockMyOverviewComponent;\n\n                if (!this.loadedBlock && !supportsMyParam) {\n                    // In old sites, display the block even if not found in Dashboard.\n                    // This is because the \"My courses\" page doesn't exist in the site so it can't be configured.\n                    this.loadFallbackBlock();\n                }\n            } catch (error) {\n                CoreDomUtils.showErrorModal(error);\n\n                // Cannot get the blocks, just show the block if needed.\n                this.loadFallbackBlock();\n            }\n        } else if (!available) {\n            // WS not available, show fallback block.\n            this.loadFallbackBlock();\n        } else {\n            this.loadedBlock = undefined;\n        }\n\n        this.loaded = true;\n        this.onReadyPromise.resolve();\n\n        this.logView();\n    }\n\n    /**\n     * Load the site name.\n     */\n    protected async loadSiteName(): Promise<void> {\n        const site = CoreSites.getRequiredCurrentSite();\n        this.siteName = await site.getSiteName() || '';\n    }\n\n    /**\n     * Load fallback blocks.\n     */\n    protected loadFallbackBlock(): void {\n        this.loadedBlock = {\n            name: 'myoverview',\n            visible: true,\n        };\n    }\n\n    /**\n     * Refresh the data.\n     *\n     * @param refresher Refresher.\n     */\n    async refresh(refresher?: HTMLIonRefresherElement): Promise<void> {\n\n        const promises: Promise<void>[] = [];\n\n        promises.push(CoreCoursesDashboard.invalidateDashboardBlocks(CoreCoursesDashboardProvider.MY_PAGE_COURSES));\n\n        // Invalidate the blocks.\n        if (this.myOverviewBlock) {\n            promises.push(CoreUtils.ignoreErrors(this.myOverviewBlock.invalidateContent()));\n        }\n\n        Promise.all(promises).finally(() => {\n            this.loadContent().finally(() => {\n                refresher?.complete();\n            });\n        });\n    }\n\n    /**\n     * @inheritdoc\n     */\n    ngOnDestroy(): void {\n        this.updateSiteObserver?.off();\n        this.loadsManagerSubscription.unsubscribe();\n    }\n\n    /**\n     * @inheritdoc\n     */\n    async ready(): Promise<void> {\n        return await this.onReadyPromise;\n    }\n\n}\n","<ion-header>\n    <ion-toolbar>\n        <ion-buttons slot=\"start\">\n            <ion-back-button [text]=\"'core.back' | translate\" />\n        </ion-buttons>\n        <ion-title>\n            <h1>\n                <core-format-text [text]=\"siteName\" contextLevel=\"system\" [contextInstanceId]=\"0\" class=\"core-header-sitename\" />\n                <img src=\"assets/img/top_logo.png\" class=\"core-header-logo\" [alt]=\"siteName\">\n            </h1>\n        </ion-title>\n        <ion-buttons slot=\"end\">\n            <core-user-menu-button />\n        </ion-buttons>\n    </ion-toolbar>\n</ion-header>\n<ion-content>\n    <ion-refresher slot=\"fixed\" [disabled]=\"!loaded\" (ionRefresh)=\"refresh($event.target)\">\n        <ion-refresher-content pullingText=\"{{ 'core.pulltorefresh' | translate }}\" />\n    </ion-refresher>\n    <core-loading [hideUntil]=\"loaded\">\n        <ion-item class=\"ion-text-wrap divider\">\n            <ion-label>\n                <h2 class=\"big\" id=\"core-courses-my-title\">{{ 'core.courses.mycourses' | translate }}</h2>\n            </ion-label>\n            <div slot=\"end\" class=\"flex-row\">\n                <!-- Download all courses. -->\n                <div *ngIf=\"downloadCoursesEnabled && myOverviewBlock && myOverviewBlock.filteredCourses.length > 0\"\n                    class=\"core-button-spinner\">\n                    <ion-button *ngIf=\"!myOverviewBlock.prefetchCoursesData.loading\" fill=\"clear\"\n                        (click)=\"myOverviewBlock.prefetchCourses()\"\n                        [attr.aria-label]=\"myOverviewBlock.prefetchCoursesData.statusTranslatable | translate\">\n                        <ion-icon [name]=\"myOverviewBlock.prefetchCoursesData.icon\" slot=\"icon-only\" aria-hidden=\"true\" />\n                    </ion-button>\n                    <ion-badge class=\"core-course-download-courses-progress\" *ngIf=\"myOverviewBlock.prefetchCoursesData.badge\"\n                        role=\"progressbar\" [attr.aria-valuemax]=\"myOverviewBlock.prefetchCoursesData.total\"\n                        [attr.aria-valuenow]=\"myOverviewBlock.prefetchCoursesData.count\"\n                        [attr.aria-valuetext]=\"myOverviewBlock.prefetchCoursesData.badgeA11yText\">\n                        {{myOverviewBlock.prefetchCoursesData.badge}}\n                    </ion-badge>\n                    <ion-spinner *ngIf=\"myOverviewBlock.prefetchCoursesData.loading\" [attr.aria-label]=\"'core.loading' | translate\" />\n                </div>\n            </div>\n        </ion-item>\n        <ion-list>\n            <core-block *ngIf=\"loadedBlock?.visible\" [block]=\"loadedBlock\" contextLevel=\"user\" [instanceId]=\"userId\"\n                labelledBy=\"core-courses-my-title\" />\n        </ion-list>\n\n        <core-block-side-blocks-button slot=\"fixed\" *ngIf=\"hasSideBlocks\" contextLevel=\"user\" [instanceId]=\"userId\"\n            [myDashboardPage]=\"myPageCourses\" />\n\n        <core-empty-box *ngIf=\"!loadedBlock\" icon=\"fas-cubes\" [message]=\"'core.course.nocontentavailable' | translate\" />\n    </core-loading>\n</ion-content>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"import _asyncToGenerator from \"/home/toon/works/gitionic7/ionic-github/ionic/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _class;\nimport { CoreCourseModuleMainActivityComponent } from '@features/course/classes/main-activity-component';\nimport { AddonModForum, AddonModForumProvider } from '@addons/mod/forum/services/forum';\nimport { AddonModForumOffline } from '@addons/mod/forum/services/forum-offline';\nimport { Translate } from '@singletons';\nimport { AddonModForumHelper } from '@addons/mod/forum/services/forum-helper';\nimport { CoreEvents } from '@singletons/events';\nimport { AddonModForumSyncProvider } from '@addons/mod/forum/services/forum-sync';\nimport { CoreSites } from '@services/sites';\nimport { CoreUser } from '@features/user/services/user';\nimport { CoreDomUtils } from '@services/utils/dom';\nimport { CoreCourse } from '@features/course/services/course';\nimport { CoreSplitViewComponent } from '@components/split-view/split-view';\nimport { AddonModForumDiscussionOptionsMenuComponent } from '../discussion-options-menu/discussion-options-menu';\nimport { AddonModForumSortOrderSelectorComponent } from '../sort-order-selector/sort-order-selector';\nimport { CoreScreen } from '@services/screen';\nimport { AddonModForumPrefetchHandler } from '../../services/handlers/prefetch';\nimport { AddonModForumModuleHandlerService } from '../../services/handlers/module';\nimport { CoreRatingProvider } from '@features/rating/services/rating';\nimport { CoreRatingSyncProvider } from '@features/rating/services/rating-sync';\nimport { CoreRatingOffline } from '@features/rating/services/rating-offline';\nimport { AddonModForumDiscussionsSource } from '../../classes/forum-discussions-source';\nimport { CoreListItemsManager } from '@classes/items-management/list-items-manager';\nimport { CoreRoutedItemsManagerSourcesTracker } from '@classes/items-management/routed-items-manager-sources-tracker';\nimport { CorePromisedValue } from '@classes/promised-value';\nimport { CoreNavigator } from '@services/navigator';\nimport { FORUM_SEARCH_PAGE_NAME } from '@addons/mod/forum/forum.module';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"@ionic/angular\";\nimport * as i3 from \"@features/course/pages/contents/contents\";\nfunction AddonModForumIndexComponent_core_group_selector_17_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"core-group-selector\", 15);\n    i0.ɵɵlistener(\"selectedChange\", function AddonModForumIndexComponent_core_group_selector_17_Template_core_group_selector_selectedChange_0_listener($event) {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r6 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r6.groupId = $event);\n    })(\"selectedChange\", function AddonModForumIndexComponent_core_group_selector_17_Template_core_group_selector_selectedChange_0_listener() {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r8 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r8.groupChanged());\n    });\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"groupInfo\", ctx_r0.groupInfo)(\"selected\", ctx_r0.groupId)(\"courseId\", ctx_r0.courseId);\n  }\n}\nfunction AddonModForumIndexComponent_ion_card_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-card\", 16)(1, \"ion-item\");\n    i0.ɵɵelement(2, \"ion-icon\", 17);\n    i0.ɵɵelementStart(3, \"ion-label\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(ctx_r1.availabilityMessage);\n  }\n}\nfunction AddonModForumIndexComponent_ion_card_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-card\", 16)(1, \"ion-item\");\n    i0.ɵɵelement(2, \"ion-icon\", 17);\n    i0.ɵɵelementStart(3, \"ion-label\");\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"translate\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(5, 1, \"addon.mod_forum.qandanotify\"));\n  }\n}\nfunction AddonModForumIndexComponent_ion_card_20_span_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(2, 1, \"addon.mod_forum.cannotadddiscussionall\"));\n  }\n}\nfunction AddonModForumIndexComponent_ion_card_20_span_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(2, 1, \"addon.mod_forum.cannotadddiscussion\"));\n  }\n}\nfunction AddonModForumIndexComponent_ion_card_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-card\", 16)(1, \"ion-item\");\n    i0.ɵɵelement(2, \"ion-icon\", 17);\n    i0.ɵɵelementStart(3, \"ion-label\");\n    i0.ɵɵtemplate(4, AddonModForumIndexComponent_ion_card_20_span_4_Template, 3, 3, \"span\", 12);\n    i0.ɵɵtemplate(5, AddonModForumIndexComponent_ion_card_20_span_5_Template, 3, 3, \"span\", 12);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.groupId <= 0);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.groupId > 0);\n  }\n}\nfunction AddonModForumIndexComponent_ng_container_21_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r16 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 9)(1, \"core-combobox\", 23);\n    i0.ɵɵlistener(\"onChange\", function AddonModForumIndexComponent_ng_container_21_div_1_Template_core_combobox_onChange_1_listener($event) {\n      i0.ɵɵrestoreView(_r16);\n      const ctx_r15 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r15.setSortOrder($event));\n    });\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵpipe(3, \"translate\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r11 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"modalOptions\", ctx_r11.sortOrderSelectorModalOptions)(\"label\", i0.ɵɵpipeBind1(2, 3, \"core.sort\"))(\"selection\", i0.ɵɵpipeBind1(3, 5, ctx_r11.selectedSortOrder.label));\n  }\n}\nfunction AddonModForumIndexComponent_ng_container_21_core_empty_box_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"core-empty-box\", 24);\n    i0.ɵɵpipe(1, \"translate\");\n  }\n  if (rf & 2) {\n    i0.ɵɵproperty(\"message\", i0.ɵɵpipeBind1(1, 1, \"addon.mod_forum.forumnodiscussionsyet\"));\n  }\n}\nfunction AddonModForumIndexComponent_ng_container_21_core_empty_box_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"core-empty-box\", 25);\n    i0.ɵɵpipe(1, \"translate\");\n    i0.ɵɵelementStart(2, \"p\");\n    i0.ɵɵtext(3);\n    i0.ɵɵpipe(4, \"translate\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    i0.ɵɵproperty(\"message\", i0.ɵɵpipeBind1(1, 2, \"addon.mod_forum.errorloadingsortingorder\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(4, 4, \"addon.mod_forum.errorloadingsortingorderdetails\"));\n  }\n}\nfunction AddonModForumIndexComponent_ng_container_21_ion_item_4_ion_icon_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"ion-icon\", 39);\n    i0.ɵɵpipe(1, \"translate\");\n  }\n  if (rf & 2) {\n    i0.ɵɵattribute(\"aria-label\", i0.ɵɵpipeBind1(1, 1, \"addon.mod_forum.discussionpinned\"));\n  }\n}\nfunction AddonModForumIndexComponent_ng_container_21_ion_item_4_ion_icon_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"ion-icon\", 40);\n    i0.ɵɵpipe(1, \"translate\");\n  }\n  if (rf & 2) {\n    i0.ɵɵattribute(\"aria-label\", i0.ɵɵpipeBind1(1, 1, \"addon.mod_forum.favourites\"));\n  }\n}\nfunction AddonModForumIndexComponent_ng_container_21_ion_item_4_ion_icon_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"ion-icon\", 41);\n    i0.ɵɵpipe(1, \"translate\");\n  }\n  if (rf & 2) {\n    i0.ɵɵattribute(\"aria-label\", i0.ɵɵpipeBind1(1, 1, \"addon.mod_forum.discussionlocked\"));\n  }\n}\nfunction AddonModForumIndexComponent_ng_container_21_ion_item_4_core_user_avatar_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"core-user-avatar\", 42);\n  }\n  if (rf & 2) {\n    const discussion_r17 = i0.ɵɵnextContext().$implicit;\n    const ctx_r21 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"user\", discussion_r17)(\"courseId\", ctx_r21.courseId)(\"linkProfile\", false);\n  }\n}\nfunction AddonModForumIndexComponent_ng_container_21_ion_item_4_span_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 43);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const discussion_r17 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(discussion_r17.userfullname);\n  }\n}\nfunction AddonModForumIndexComponent_ng_container_21_ion_item_4_p_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 44);\n    i0.ɵɵelement(1, \"ion-icon\", 45);\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelement(3, \"core-format-text\", 46);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const discussion_r17 = i0.ɵɵnextContext().$implicit;\n    const ctx_r23 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵattribute(\"aria-label\", i0.ɵɵpipeBind1(2, 4, \"addon.mod_forum.group\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"text\", discussion_r17.groupname)(\"contextInstanceId\", ctx_r23.courseId)(\"wsNotFiltered\", true);\n  }\n}\nfunction AddonModForumIndexComponent_ng_container_21_ion_item_4_p_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"coreFormatDate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const discussion_r17 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind2(2, 1, discussion_r17.created * 1000, \"strftimerecentfull\"), \" \");\n  }\n}\nfunction AddonModForumIndexComponent_ng_container_21_ion_item_4_p_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵelement(1, \"ion-icon\", 47);\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(3, 1, \"core.notsent\"), \" \");\n  }\n}\nfunction AddonModForumIndexComponent_ng_container_21_ion_item_4_ion_row_14_ng_container_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"coreTimeAgo\");\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const discussion_r17 = i0.ɵɵnextContext(2).$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(2, 1, discussion_r17.timemodified), \" \");\n  }\n}\nfunction AddonModForumIndexComponent_ng_container_21_ion_item_4_ion_row_14_ng_container_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"coreTimeAgo\");\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const discussion_r17 = i0.ɵɵnextContext(2).$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(2, 1, discussion_r17.created), \" \");\n  }\n}\nconst _c0 = function (a0) {\n  return {\n    \"$a\": a0\n  };\n};\nfunction AddonModForumIndexComponent_ng_container_21_ion_item_4_ion_row_14_ion_badge_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-badge\", 53)(1, \"span\", 54);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"span\", 55);\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"translate\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const discussion_r17 = i0.ɵɵnextContext(2).$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(discussion_r17.numunread);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind2(5, 2, \"addon.mod_forum.unreadpostsnumber\", i0.ɵɵpureFunction1(5, _c0, discussion_r17.numunread)), \" \");\n  }\n}\nconst _c1 = function (a0) {\n  return {\n    numreplies: a0\n  };\n};\nfunction AddonModForumIndexComponent_ng_container_21_ion_item_4_ion_row_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-row\", 48)(1, \"ion-col\", 49)(2, \"ion-note\");\n    i0.ɵɵelement(3, \"ion-icon\", 47);\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"translate\");\n    i0.ɵɵtemplate(6, AddonModForumIndexComponent_ng_container_21_ion_item_4_ion_row_14_ng_container_6_Template, 3, 3, \"ng-container\", 12);\n    i0.ɵɵtemplate(7, AddonModForumIndexComponent_ng_container_21_ion_item_4_ion_row_14_ng_container_7_Template, 3, 3, \"ng-container\", 12);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"ion-col\", 50)(9, \"ion-note\");\n    i0.ɵɵelement(10, \"ion-icon\", 51);\n    i0.ɵɵtext(11);\n    i0.ɵɵpipe(12, \"translate\");\n    i0.ɵɵtemplate(13, AddonModForumIndexComponent_ng_container_21_ion_item_4_ion_row_14_ion_badge_13_Template, 6, 7, \"ion-badge\", 52);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const discussion_r17 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(5, 5, \"addon.mod_forum.lastpost\"), \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", discussion_r17.timemodified > discussion_r17.created);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", discussion_r17.timemodified <= discussion_r17.created);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind2(12, 7, \"addon.mod_forum.numreplies\", i0.ɵɵpureFunction1(10, _c1, discussion_r17.numreplies)), \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", discussion_r17.numunread);\n  }\n}\nfunction AddonModForumIndexComponent_ng_container_21_ion_item_4_ion_button_15_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r41 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-button\", 56);\n    i0.ɵɵlistener(\"click\", function AddonModForumIndexComponent_ng_container_21_ion_item_4_ion_button_15_Template_ion_button_click_0_listener($event) {\n      i0.ɵɵrestoreView(_r41);\n      const discussion_r17 = i0.ɵɵnextContext().$implicit;\n      const ctx_r39 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r39.showOptionsMenu($event, discussion_r17));\n    });\n    i0.ɵɵpipe(1, \"translate\");\n    i0.ɵɵelement(2, \"ion-icon\", 57);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵattribute(\"aria-label\", i0.ɵɵpipeBind1(1, 1, \"core.displayoptions\"));\n  }\n}\nfunction AddonModForumIndexComponent_ng_container_21_ion_item_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r43 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-item\", 26);\n    i0.ɵɵlistener(\"click\", function AddonModForumIndexComponent_ng_container_21_ion_item_4_Template_ion_item_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r43);\n      const discussion_r17 = restoredCtx.$implicit;\n      const ctx_r42 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r42.discussions == null ? null : ctx_r42.discussions.select(discussion_r17));\n    });\n    i0.ɵɵelementStart(1, \"ion-label\")(2, \"p\", 27);\n    i0.ɵɵtemplate(3, AddonModForumIndexComponent_ng_container_21_ion_item_4_ion_icon_3_Template, 2, 3, \"ion-icon\", 28);\n    i0.ɵɵtemplate(4, AddonModForumIndexComponent_ng_container_21_ion_item_4_ion_icon_4_Template, 2, 3, \"ion-icon\", 29);\n    i0.ɵɵelement(5, \"core-format-text\", 30);\n    i0.ɵɵtemplate(6, AddonModForumIndexComponent_ng_container_21_ion_item_4_ion_icon_6_Template, 2, 3, \"ion-icon\", 31);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"div\", 32);\n    i0.ɵɵtemplate(8, AddonModForumIndexComponent_ng_container_21_ion_item_4_core_user_avatar_8_Template, 1, 3, \"core-user-avatar\", 33);\n    i0.ɵɵelementStart(9, \"div\", 34);\n    i0.ɵɵtemplate(10, AddonModForumIndexComponent_ng_container_21_ion_item_4_span_10_Template, 2, 1, \"span\", 35);\n    i0.ɵɵtemplate(11, AddonModForumIndexComponent_ng_container_21_ion_item_4_p_11_Template, 4, 6, \"p\", 36);\n    i0.ɵɵtemplate(12, AddonModForumIndexComponent_ng_container_21_ion_item_4_p_12_Template, 3, 4, \"p\", 12);\n    i0.ɵɵtemplate(13, AddonModForumIndexComponent_ng_container_21_ion_item_4_p_13_Template, 4, 3, \"p\", 12);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(14, AddonModForumIndexComponent_ng_container_21_ion_item_4_ion_row_14_Template, 14, 12, \"ion-row\", 37);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(15, AddonModForumIndexComponent_ng_container_21_ion_item_4_ion_button_15_Template, 3, 3, \"ion-button\", 38);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const discussion_r17 = ctx.$implicit;\n    const ctx_r14 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"detail\", true)(\"lines\", discussion_r17.groupname && \"none\");\n    i0.ɵɵattribute(\"aria-current\", ctx_r14.discussions == null ? null : ctx_r14.discussions.getItemAriaCurrent(discussion_r17));\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", discussion_r17.pinned);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", discussion_r17.starred);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"text\", discussion_r17.subject)(\"contextInstanceId\", ctx_r14.module && ctx_r14.module.id)(\"courseId\", ctx_r14.courseId);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", discussion_r17.locked);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", discussion_r17.userfullname);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", discussion_r17.userfullname);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", discussion_r17.groupname);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r14.isOnlineDiscussion(discussion_r17));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r14.isOfflineDiscussion(discussion_r17));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r14.isOnlineDiscussion(discussion_r17));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r14.canPin || discussion_r17.canlock || discussion_r17.canfavourite);\n  }\n}\nfunction AddonModForumIndexComponent_ng_container_21_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r45 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, AddonModForumIndexComponent_ng_container_21_div_1_Template, 4, 7, \"div\", 18);\n    i0.ɵɵtemplate(2, AddonModForumIndexComponent_ng_container_21_core_empty_box_2_Template, 2, 3, \"core-empty-box\", 19);\n    i0.ɵɵtemplate(3, AddonModForumIndexComponent_ng_container_21_core_empty_box_3_Template, 5, 6, \"core-empty-box\", 20);\n    i0.ɵɵtemplate(4, AddonModForumIndexComponent_ng_container_21_ion_item_4_Template, 16, 16, \"ion-item\", 21);\n    i0.ɵɵelementStart(5, \"core-infinite-loading\", 22);\n    i0.ɵɵlistener(\"action\", function AddonModForumIndexComponent_ng_container_21_Template_core_infinite_loading_action_5_listener($event) {\n      i0.ɵɵrestoreView(_r45);\n      const ctx_r44 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r44.fetchMoreDiscussions($event));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r4.discussions && ctx_r4.sortingAvailable && ctx_r4.selectedSortOrder);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r4.discussions || !ctx_r4.discussions.hasDiscussions && !ctx_r4.errorLoadingDiscussions);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r4.errorLoadingDiscussions);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r4.discussionsItems);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"enabled\", ctx_r4.discussions && ctx_r4.discussions.loaded && !ctx_r4.discussions.completed)(\"error\", ctx_r4.fetchFailed);\n  }\n}\nfunction AddonModForumIndexComponent_ion_fab_23_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r47 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-fab\", 58)(1, \"ion-fab-button\", 59);\n    i0.ɵɵlistener(\"click\", function AddonModForumIndexComponent_ion_fab_23_Template_ion_fab_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r47);\n      const ctx_r46 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r46.openNewDiscussion());\n    });\n    i0.ɵɵelement(2, \"ion-icon\", 60);\n    i0.ɵɵelementStart(3, \"span\", 55);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵattribute(\"aria-label\", ctx_r5.addDiscussionText);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(ctx_r5.addDiscussionText);\n  }\n}\n/**\n * Component that displays a forum entry page.\n */\nexport class AddonModForumIndexComponent extends CoreCourseModuleMainActivityComponent {\n  constructor(route, content, courseContentsPage) {\n    super('AddonModForumIndexComponent', content, courseContentsPage);\n    this.route = route;\n    this.content = content;\n    this.component = AddonModForumProvider.COMPONENT;\n    this.pluginName = 'forum';\n    this.discussionsItems = [];\n    this.fetchFailed = false;\n    this.canAddDiscussion = false;\n    this.availabilityMessage = null;\n    this.sortOrders = [];\n    this.hasOfflineRatings = false;\n    this.showQAMessage = false;\n    this.isSetPinAvailable = false;\n    this.sortOrderSelectorModalOptions = {\n      component: AddonModForumSortOrderSelectorComponent\n    };\n    this.fetchContentDefaultError = 'addon.mod_forum.errorgetforum';\n    this.syncEventName = AddonModForumSyncProvider.AUTO_SYNCED;\n    this.checkCompletionAfterLog = false; // Use CoreListItemsManager log system instead.\n    this.promisedDiscussions = new CorePromisedValue();\n  }\n  get discussions() {\n    return this.promisedDiscussions.value;\n  }\n  get forum() {\n    var _this$discussions;\n    return (_this$discussions = this.discussions) === null || _this$discussions === void 0 ? void 0 : _this$discussions.getSource().forum;\n  }\n  get selectedSortOrder() {\n    var _this$discussions$get, _this$discussions2;\n    return (_this$discussions$get = (_this$discussions2 = this.discussions) === null || _this$discussions2 === void 0 ? void 0 : _this$discussions2.getSource().selectedSortOrder) !== null && _this$discussions$get !== void 0 ? _this$discussions$get : undefined;\n  }\n  get supportsChangeGroup() {\n    var _this$discussions$get2, _this$discussions3;\n    return (_this$discussions$get2 = (_this$discussions3 = this.discussions) === null || _this$discussions3 === void 0 ? void 0 : _this$discussions3.getSource().supportsChangeGroup) !== null && _this$discussions$get2 !== void 0 ? _this$discussions$get2 : false;\n  }\n  get groupId() {\n    var _this$discussions$get3, _this$discussions4;\n    return (_this$discussions$get3 = (_this$discussions4 = this.discussions) === null || _this$discussions4 === void 0 ? void 0 : _this$discussions4.getSource().groupId) !== null && _this$discussions$get3 !== void 0 ? _this$discussions$get3 : 0;\n  }\n  set groupId(value) {\n    if (this.discussions) {\n      this.discussions.getSource().groupId = value;\n    }\n  }\n  get groupInfo() {\n    var _this$discussions5;\n    return (_this$discussions5 = this.discussions) === null || _this$discussions5 === void 0 ? void 0 : _this$discussions5.getSource().groupInfo;\n  }\n  get usesGroups() {\n    var _this$discussions6;\n    return !!((_this$discussions6 = this.discussions) !== null && _this$discussions6 !== void 0 && _this$discussions6.getSource().usesGroups);\n  }\n  get canPin() {\n    var _this$discussions7;\n    return !!(this.isSetPinAvailable && (_this$discussions7 = this.discussions) !== null && _this$discussions7 !== void 0 && (_this$discussions7 = _this$discussions7.getSource().allPartsPermissions) !== null && _this$discussions7 !== void 0 && _this$discussions7.canpindiscussions);\n  }\n  get canAddDiscussionToGroup() {\n    var _this$discussions8;\n    return !!(this.forum && this.canAddDiscussion && (_this$discussions8 = this.discussions) !== null && _this$discussions8 !== void 0 && _this$discussions8.getSource().canAddDiscussionToGroup);\n  }\n  get errorLoadingDiscussions() {\n    var _this$discussions9;\n    return !!((_this$discussions9 = this.discussions) !== null && _this$discussions9 !== void 0 && _this$discussions9.getSource().errorLoadingDiscussions);\n  }\n  /**\n   * Check whether a discussion is online.\n   *\n   * @param discussion Discussion\n   * @returns Whether the discussion is online.\n   */\n  isOnlineDiscussion(discussion) {\n    var _this$discussions10;\n    return !!((_this$discussions10 = this.discussions) !== null && _this$discussions10 !== void 0 && _this$discussions10.getSource().isOnlineDiscussion(discussion));\n  }\n  /**\n   * Check whether a discussion is offline.\n   *\n   * @param discussion Discussion\n   * @returns Whether the discussion is offline.\n   */\n  isOfflineDiscussion(discussion) {\n    var _this$discussions11;\n    return !!((_this$discussions11 = this.discussions) !== null && _this$discussions11 !== void 0 && _this$discussions11.getSource().isOfflineDiscussion(discussion));\n  }\n  /**\n   * @inheritdoc\n   */\n  ngOnInit() {\n    var _superprop_getNgOnInit = () => super.ngOnInit,\n      _this = this;\n    return _asyncToGenerator(function* () {\n      _this.addDiscussionText = Translate.instant('addon.mod_forum.addanewdiscussion');\n      _this.sortingAvailable = AddonModForum.isDiscussionListSortingAvailable();\n      _this.sortOrders = AddonModForum.getAvailableSortOrders();\n      _this.isSetPinAvailable = AddonModForum.isSetPinStateAvailableForSite();\n      _this.sortOrderSelectorModalOptions.componentProps = {\n        sortOrders: _this.sortOrders\n      };\n      yield _superprop_getNgOnInit().call(_this);\n      // Initialize discussions manager.\n      const source = CoreRoutedItemsManagerSourcesTracker.getOrCreateSource(AddonModForumDiscussionsSource, [_this.courseId, _this.module.id, _this.courseContentsPage ? `${AddonModForumModuleHandlerService.PAGE_NAME}/` : '']);\n      _this.sourceUnsubscribe = source.addListener({\n        onItemsUpdated: function () {\n          var _ref = _asyncToGenerator(function* (discussions) {\n            _this.discussionsItems = discussions.filter(discussion => !source.isNewDiscussionForm(discussion));\n            _this.hasOffline = discussions.some(discussion => source.isOfflineDiscussion(discussion));\n            if (!_this.forum) {\n              return;\n            }\n            // Check if there are replies for discussions stored in offline.\n            const hasOffline = yield AddonModForumOffline.hasForumReplies(_this.forum.id);\n            _this.hasOffline = _this.hasOffline || hasOffline || _this.hasOfflineRatings;\n            if (hasOffline) {\n              // Only update new fetched discussions.\n              const promises = discussions.map( /*#__PURE__*/function () {\n                var _ref2 = _asyncToGenerator(function* (discussion) {\n                  var _this$discussions12;\n                  if (!((_this$discussions12 = _this.discussions) !== null && _this$discussions12 !== void 0 && _this$discussions12.getSource().isOnlineDiscussion(discussion))) {\n                    return;\n                  }\n                  // Get offline discussions.\n                  const replies = yield AddonModForumOffline.getDiscussionReplies(discussion.discussion);\n                  discussion.numreplies = Number(discussion.numreplies) + replies.length;\n                });\n                return function (_x2) {\n                  return _ref2.apply(this, arguments);\n                };\n              }());\n              yield Promise.all(promises);\n            }\n          });\n          return function onItemsUpdated(_x) {\n            return _ref.apply(this, arguments);\n          };\n        }(),\n        onReset: () => {\n          _this.discussionsItems = [];\n        }\n      });\n      _this.promisedDiscussions.resolve(new AddonModForumDiscussionsManager(source, _this));\n      // Refresh data if this forum discussion is synchronized from discussions list.\n      _this.syncManualObserver = CoreEvents.on(AddonModForumSyncProvider.MANUAL_SYNCED, data => {\n        _this.autoSyncEventReceived(data);\n      }, _this.siteId);\n      // Listen for discussions added. When a discussion is added, we reload the data.\n      _this.newDiscObserver = CoreEvents.on(AddonModForumProvider.NEW_DISCUSSION_EVENT, data => _this.eventReceived(true, data));\n      _this.replyObserver = CoreEvents.on(AddonModForumProvider.REPLY_DISCUSSION_EVENT, data => _this.eventReceived(false, data));\n      _this.changeDiscObserver = CoreEvents.on(AddonModForumProvider.CHANGE_DISCUSSION_EVENT, data => {\n        if (!_this.forum) {\n          return;\n        }\n        if (_this.forum.id === data.forumId || data.cmId === _this.module.id) {\n          AddonModForum.invalidateDiscussionsList(_this.forum.id).finally(() => {\n            if (data.discussionId) {\n              var _this$discussions13;\n              // Discussion changed, search it in the list of discussions.\n              const discussion = (_this$discussions13 = _this.discussions) === null || _this$discussions13 === void 0 ? void 0 : _this$discussions13.items.find(disc => {\n                var _this$discussions14;\n                return ((_this$discussions14 = _this.discussions) === null || _this$discussions14 === void 0 ? void 0 : _this$discussions14.getSource().isOnlineDiscussion(disc)) && data.discussionId == disc.discussion;\n              });\n              if (discussion) {\n                if (data.locked !== undefined) {\n                  discussion.locked = data.locked;\n                }\n                if (data.pinned !== undefined) {\n                  discussion.pinned = data.pinned;\n                }\n                if (data.starred !== undefined) {\n                  discussion.starred = data.starred;\n                }\n                _this.showLoadingAndRefresh(false);\n              }\n            }\n            if (data.deleted !== undefined && data.deleted) {\n              var _data$post;\n              if (((_data$post = data.post) === null || _data$post === void 0 ? void 0 : _data$post.parentid) == 0 && CoreScreen.isTablet && _this.discussions && !_this.discussions.empty) {\n                // Discussion deleted, clear details page.\n                _this.discussions.select(_this.discussions[0]);\n              }\n              _this.showLoadingAndRefresh(false);\n            }\n          });\n        }\n      });\n      // Listen for offline ratings saved and synced.\n      _this.ratingOfflineObserver = CoreEvents.on(CoreRatingProvider.RATING_SAVED_EVENT, data => {\n        if (_this.forum && data.component == 'mod_forum' && data.ratingArea == 'post' && data.contextLevel == \"module\" /* ContextLevel.MODULE */ && data.instanceId == _this.forum.cmid) {\n          _this.hasOfflineRatings = true;\n          _this.hasOffline = true;\n        }\n      });\n      _this.ratingSyncObserver = CoreEvents.on(CoreRatingSyncProvider.SYNCED_EVENT, /*#__PURE__*/function () {\n        var _ref3 = _asyncToGenerator(function* (data) {\n          if (_this.forum && data.component == 'mod_forum' && data.ratingArea == 'post' && data.contextLevel == \"module\" /* ContextLevel.MODULE */ && data.instanceId == _this.forum.cmid) {\n            _this.hasOfflineRatings = yield CoreRatingOffline.hasRatings('mod_forum', 'post', \"module\" /* ContextLevel.MODULE */, _this.forum.cmid);\n            _this.hasOffline = _this.hasOffline || _this.hasOfflineRatings;\n          }\n        });\n        return function (_x3) {\n          return _ref3.apply(this, arguments);\n        };\n      }());\n    })();\n  }\n  ngAfterViewInit() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      yield _this2.loadContent(false, true);\n      const discussions = yield _this2.promisedDiscussions;\n      discussions.start(_this2.splitView);\n    })();\n  }\n  /**\n   * @inheritdoc\n   */\n  ngOnDestroy() {\n    var _this$discussions15;\n    super.ngOnDestroy();\n    this.syncManualObserver && this.syncManualObserver.off();\n    this.newDiscObserver && this.newDiscObserver.off();\n    this.replyObserver && this.replyObserver.off();\n    this.viewDiscObserver && this.viewDiscObserver.off();\n    this.changeDiscObserver && this.changeDiscObserver.off();\n    this.ratingOfflineObserver && this.ratingOfflineObserver.off();\n    this.ratingSyncObserver && this.ratingSyncObserver.off();\n    this.sourceUnsubscribe && this.sourceUnsubscribe();\n    (_this$discussions15 = this.discussions) === null || _this$discussions15 === void 0 || _this$discussions15.destroy();\n  }\n  /**\n   * Open search page.\n   */\n  openSearch() {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      if (!_this3.forum) {\n        return;\n      }\n      yield CoreNavigator.navigateToSitePath(FORUM_SEARCH_PAGE_NAME, {\n        params: {\n          courseId: _this3.courseId,\n          forumId: _this3.forum.id\n        }\n      });\n    })();\n  }\n  /**\n   * @inheritdoc\n   */\n  fetchContent(refresh = false, sync = false, showErrors = false) {\n    var _this4 = this;\n    return _asyncToGenerator(function* () {\n      _this4.fetchFailed = false;\n      try {\n        yield Promise.all([_this4.fetchForum(sync, showErrors), _this4.fetchSortOrderPreference()]);\n        if (!_this4.forum) {\n          return;\n        }\n        const discussions = yield _this4.promisedDiscussions;\n        yield Promise.all([refresh ? discussions.reload() : discussions.load(), CoreRatingOffline.hasRatings('mod_forum', 'post', \"module\" /* ContextLevel.MODULE */, _this4.forum.cmid).then(hasRatings => {\n          _this4.hasOfflineRatings = hasRatings;\n          return;\n        })]);\n      } catch (error) {\n        _this4.fetchFailed = true; // Set to prevent infinite calls with infinite-loading.\n        throw error; // Pass the error to the parent catch.\n      }\n    })();\n  }\n\n  fetchForum(sync = false, showErrors = false) {\n    var _this5 = this;\n    return _asyncToGenerator(function* () {\n      var _CoreSites$getCurrent;\n      if (!_this5.courseId || !_this5.module) {\n        return;\n      }\n      const discussions = yield _this5.promisedDiscussions;\n      yield discussions.getSource().loadForum();\n      if (!_this5.forum) {\n        return;\n      }\n      const forum = _this5.forum;\n      const showDueDateMessage = !((_CoreSites$getCurrent = CoreSites.getCurrentSite()) !== null && _CoreSites$getCurrent !== void 0 && _CoreSites$getCurrent.isVersionGreaterEqualThan('3.11'));\n      _this5.description = forum.intro || _this5.description;\n      _this5.availabilityMessage = AddonModForumHelper.getAvailabilityMessage(forum, showDueDateMessage);\n      _this5.descriptionNote = Translate.instant('addon.mod_forum.numdiscussions', {\n        numdiscussions: forum.numdiscussions\n      });\n      _this5.dataRetrieved.emit(forum);\n      switch (forum.type) {\n        case 'news':\n        case 'blog':\n          _this5.addDiscussionText = Translate.instant('addon.mod_forum.addanewtopic');\n          break;\n        case 'qanda':\n          _this5.addDiscussionText = Translate.instant('addon.mod_forum.addanewquestion');\n          break;\n        default:\n          _this5.addDiscussionText = Translate.instant('addon.mod_forum.addanewdiscussion');\n      }\n      if (sync) {\n        // Try to synchronize the forum.\n        const updated = yield _this5.syncActivity(showErrors);\n        if (updated) {\n          // Sync successful, send event.\n          CoreEvents.trigger(AddonModForumSyncProvider.MANUAL_SYNCED, {\n            forumId: forum.id,\n            userId: CoreSites.getCurrentSiteUserId(),\n            source: 'index'\n          }, CoreSites.getCurrentSiteId());\n        }\n      }\n      const promises = [];\n      // Check if the activity uses groups.\n      promises.push(discussions.getSource().loadGroupInfo(forum.id));\n      promises.push(AddonModForum.getAccessInformation(forum.id, {\n        cmId: _this5.module.id\n      }).then( /*#__PURE__*/function () {\n        var _ref4 = _asyncToGenerator(function* (accessInfo) {\n          // Disallow adding discussions if cut-off date is reached and the user has not the\n          // capability to override it.\n          // Just in case the forum was fetched from WS when the cut-off date was not reached but it is now.\n          const cutoffDateReached = AddonModForumHelper.isCutoffDateReached(forum) && !accessInfo.cancanoverridecutoff;\n          _this5.canAddDiscussion = !!forum.cancreatediscussions && !cutoffDateReached;\n          _this5.showQAMessage = forum.type === 'qanda' && !accessInfo.canviewqandawithoutposting;\n          return;\n        });\n        return function (_x4) {\n          return _ref4.apply(this, arguments);\n        };\n      }()));\n      yield Promise.all(promises);\n    })();\n  }\n  /**\n   * Convenience function to load more forum discussions.\n   *\n   * @param complete Infinite scroll complete function. Only used from core-infinite-loading.\n   * @returns Promise resolved when done.\n   */\n  fetchMoreDiscussions(complete) {\n    var _this6 = this;\n    return _asyncToGenerator(function* () {\n      const discussions = yield _this6.promisedDiscussions;\n      try {\n        _this6.fetchFailed = false;\n        yield discussions.load();\n      } catch (error) {\n        CoreDomUtils.showErrorModalDefault(error, 'addon.mod_forum.errorgetforum', true);\n        _this6.fetchFailed = true;\n      } finally {\n        complete();\n      }\n    })();\n  }\n  /**\n   * Convenience function to fetch the sort order preference.\n   *\n   * @returns Promise resolved when done.\n   */\n  fetchSortOrderPreference() {\n    var _this7 = this;\n    return _asyncToGenerator(function* () {\n      const discussions = yield _this7.promisedDiscussions;\n      const selectedOrder = yield AddonModForum.getSelectedSortOrder();\n      discussions.getSource().selectedSortOrder = selectedOrder;\n      if (_this7.sortOrderSelectorModalOptions.componentProps) {\n        _this7.sortOrderSelectorModalOptions.componentProps.selected = selectedOrder.value;\n      }\n    })();\n  }\n  /**\n   * Perform the invalidate content function.\n   *\n   * @returns Resolved when done.\n   */\n  invalidateContent() {\n    var _this8 = this;\n    return _asyncToGenerator(function* () {\n      const promises = [];\n      if (_this8.discussions) {\n        promises.push(_this8.discussions.getSource().invalidateCache());\n      }\n      if (_this8.forum) {\n        promises.push(AddonModForum.invalidateAccessInformation(_this8.forum.id));\n      }\n      if (_this8.sortingAvailable) {\n        promises.push(CoreUser.invalidateUserPreference(AddonModForumProvider.PREFERENCE_SORTORDER));\n      }\n      yield Promise.all(promises);\n    })();\n  }\n  /**\n   * @inheritdoc\n   */\n  sync() {\n    return AddonModForumPrefetchHandler.sync(this.module, this.courseId);\n  }\n  /**\n   * Compares sync event data with current data to check if refresh content is needed.\n   *\n   * @param syncEventData Data receiven on sync observer.\n   * @returns True if refresh is needed, false otherwise.\n   */\n  isRefreshSyncNeeded(syncEventData) {\n    return !!this.forum && (!('source' in syncEventData) || syncEventData.source != 'index') && syncEventData.forumId == this.forum.id && syncEventData.userId == CoreSites.getCurrentSiteUserId();\n  }\n  /**\n   * Function called when we receive an event of new discussion or reply to discussion.\n   *\n   * @param isNewDiscussion Whether it's a new discussion event.\n   * @param data Event data.\n   */\n  eventReceived(isNewDiscussion, data) {\n    var _this9 = this;\n    return _asyncToGenerator(function* () {\n      if ((!_this9.forum || _this9.forum.id !== data.forumId) && data.cmId !== _this9.module.id) {\n        return; // Not current forum.\n      }\n      // Check completion since it could be configured to complete once the user adds a new discussion or replies.\n      _this9.checkCompletion();\n      try {\n        if (isNewDiscussion) {\n          CoreDomUtils.showToast('addon.mod_forum.postaddedsuccess', true);\n          const newDiscGroupId = data.groupId;\n          if (!newDiscGroupId || newDiscGroupId < 0 || !_this9.groupId || newDiscGroupId === _this9.groupId) {\n            yield _this9.showLoadingAndRefresh(false);\n          } else {\n            var _this9$discussions;\n            // Discussion is in a different group than the one currently viewed, only invalidate data.\n            yield (_this9$discussions = _this9.discussions) === null || _this9$discussions === void 0 ? void 0 : _this9$discussions.getSource().invalidateList();\n          }\n        } else {\n          yield _this9.showLoadingAndRefresh(false);\n        }\n      } finally {\n        // If it's a new discussion in tablet mode, try to open it.\n        if (isNewDiscussion && CoreScreen.isTablet && _this9.discussions) {\n          const newDiscussionData = data;\n          const discussion = _this9.discussions.items.find(disc => {\n            var _this9$discussions2, _this9$discussions3;\n            if ((_this9$discussions2 = _this9.discussions) !== null && _this9$discussions2 !== void 0 && _this9$discussions2.getSource().isOfflineDiscussion(disc)) {\n              return disc.timecreated === newDiscussionData.discTimecreated;\n            }\n            if ((_this9$discussions3 = _this9.discussions) !== null && _this9$discussions3 !== void 0 && _this9$discussions3.getSource().isOnlineDiscussion(disc)) {\n              var _newDiscussionData$di;\n              return ((_newDiscussionData$di = newDiscussionData.discussionIds) !== null && _newDiscussionData$di !== void 0 ? _newDiscussionData$di : []).includes(disc.discussion);\n            }\n            return false;\n          });\n          _this9.discussions.select(discussion !== null && discussion !== void 0 ? discussion : null);\n        }\n      }\n    })();\n  }\n  /**\n   * Opens the new discussion form.\n   */\n  openNewDiscussion() {\n    var _this$discussions16;\n    (_this$discussions16 = this.discussions) === null || _this$discussions16 === void 0 || _this$discussions16.select(AddonModForumDiscussionsSource.NEW_DISCUSSION);\n  }\n  /**\n   * Changes the sort order.\n   *\n   * @param sortOrder Sort order new data.\n   */\n  setSortOrder(sortOrder) {\n    var _this10 = this;\n    return _asyncToGenerator(function* () {\n      var _this10$discussions$g;\n      if (_this10.discussions && sortOrder.value != ((_this10$discussions$g = _this10.discussions.getSource().selectedSortOrder) === null || _this10$discussions$g === void 0 ? void 0 : _this10$discussions$g.value)) {\n        _this10.discussions.getSource().selectedSortOrder = sortOrder;\n        _this10.discussions.getSource().setDirty(true);\n        if (_this10.sortOrderSelectorModalOptions.componentProps) {\n          _this10.sortOrderSelectorModalOptions.componentProps.selected = sortOrder.value;\n        }\n        try {\n          yield CoreUser.setUserPreference(AddonModForumProvider.PREFERENCE_SORTORDER, sortOrder.value.toFixed(0));\n          yield _this10.showLoadingAndFetch();\n        } catch (error) {\n          CoreDomUtils.showErrorModalDefault(error, 'Error updating preference.');\n        }\n      }\n    })();\n  }\n  /**\n   * Display the sort order selector modal.\n   */\n  showSortOrderSelector() {\n    var _this11 = this;\n    return _asyncToGenerator(function* () {\n      const modalData = yield CoreDomUtils.openModal(_this11.sortOrderSelectorModalOptions);\n      if (modalData) {\n        _this11.setSortOrder(modalData);\n      }\n    })();\n  }\n  /**\n   * Show the context menu.\n   *\n   * @param event Click Event.\n   * @param discussion Discussion.\n   */\n  showOptionsMenu(event, discussion) {\n    var _this12 = this;\n    return _asyncToGenerator(function* () {\n      if (!_this12.forum) {\n        return;\n      }\n      event.preventDefault();\n      event.stopPropagation();\n      const popoverData = yield CoreDomUtils.openPopover({\n        component: AddonModForumDiscussionOptionsMenuComponent,\n        componentProps: {\n          discussion,\n          forumId: _this12.forum.id,\n          cmId: _this12.module.id\n        },\n        event\n      });\n      if (popoverData && popoverData.action) {\n        switch (popoverData.action) {\n          case 'lock':\n            discussion.locked = popoverData.value;\n            break;\n          case 'pin':\n            discussion.pinned = popoverData.value;\n            break;\n          case 'star':\n            discussion.starred = popoverData.value;\n            break;\n          default:\n            break;\n        }\n      }\n    })();\n  }\n  /**\n   * Group has changed.\n   */\n  groupChanged() {\n    var _this13 = this;\n    return _asyncToGenerator(function* () {\n      const modal = yield CoreDomUtils.showModalLoading();\n      try {\n        var _this13$discussions, _this13$discussions2;\n        yield Promise.all([(_this13$discussions = _this13.discussions) === null || _this13$discussions === void 0 ? void 0 : _this13$discussions.getSource().loadSelectedGroupData(), (_this13$discussions2 = _this13.discussions) === null || _this13$discussions2 === void 0 ? void 0 : _this13$discussions2.reload()]);\n      } catch (error) {\n        CoreDomUtils.showErrorModalDefault(error, 'core.errorloadingcontent', true);\n      } finally {\n        modal.dismiss();\n      }\n    })();\n  }\n}\n/**\n * Discussions manager.\n */\n_class = AddonModForumIndexComponent;\n_class.ɵfac = function AddonModForumIndexComponent_Factory(t) {\n  return new (t || _class)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.IonContent, 8), i0.ɵɵdirectiveInject(i3.CoreCourseContentsPage, 8));\n};\n_class.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: _class,\n  selectors: [[\"addon-mod-forum-index\"]],\n  viewQuery: function AddonModForumIndexComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(CoreSplitViewComponent, 5);\n    }\n    if (rf & 2) {\n      let _t;\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.splitView = _t.first);\n    }\n  },\n  features: [i0.ɵɵInheritDefinitionFeature],\n  decls: 24,\n  vars: 27,\n  consts: [[\"slot\", \"end\"], [\"fill\", \"clear\", 3, \"click\"], [\"name\", \"fas-magnifying-glass\", \"slot\", \"icon-only\", \"aria-hidden\", \"true\"], [\"fill\", \"clear\", \"aria-haspopup\", \"true\", 3, \"click\"], [\"name\", \"fas-circle-info\", \"slot\", \"icon-only\", \"aria-hidden\", \"true\"], [\"slot\", \"fixed\", 3, \"disabled\", \"ionRefresh\"], [3, \"pullingText\"], [3, \"hideUntil\"], [3, \"module\", \"description\", \"component\", \"componentId\", \"courseId\", \"hasDataToSync\", \"completionChanged\"], [1, \"ion-text-wrap\"], [3, \"groupInfo\", \"selected\", \"courseId\", \"selectedChange\", 4, \"ngIf\"], [\"class\", \"core-info-card\", 4, \"ngIf\"], [4, \"ngIf\"], [\"collapsible-footer\", \"\", 3, \"hidden\", \"courseId\", \"currentModuleId\"], [\"slot\", \"fixed\", \"core-fab\", \"\", \"vertical\", \"bottom\", \"horizontal\", \"end\", 4, \"ngIf\"], [3, \"groupInfo\", \"selected\", \"courseId\", \"selectedChange\"], [1, \"core-info-card\"], [\"name\", \"fas-circle-info\", \"slot\", \"start\", \"aria-hidden\", \"true\"], [\"class\", \"ion-text-wrap\", 4, \"ngIf\"], [\"icon\", \"far-comments\", 3, \"message\", 4, \"ngIf\"], [\"icon\", \"fas-triangle-exclamation\", 3, \"message\", 4, \"ngIf\"], [\"class\", \"addon-mod-forum-discussion\", \"button\", \"\", 3, \"detail\", \"lines\", \"click\", 4, \"ngFor\", \"ngForOf\"], [3, \"enabled\", \"error\", \"action\"], [\"listboxId\", \"addon-mod-forum-sort-selector\", \"interface\", \"modal\", 3, \"modalOptions\", \"label\", \"selection\", \"onChange\"], [\"icon\", \"far-comments\", 3, \"message\"], [\"icon\", \"fas-triangle-exclamation\", 3, \"message\"], [\"button\", \"\", 1, \"addon-mod-forum-discussion\", 3, \"detail\", \"lines\", \"click\"], [1, \"addon-mod-forum-discussion-title\", \"ion-text-wrap\", \"item-heading\"], [\"name\", \"fas-map-pin\", 4, \"ngIf\"], [\"name\", \"fas-star\", \"class\", \"addon-forum-star\", 4, \"ngIf\"], [\"contextLevel\", \"module\", 3, \"text\", \"contextInstanceId\", \"courseId\"], [\"name\", \"fas-lock\", \"class\", \"addon-mod-forum-locked-icon\", 4, \"ngIf\"], [1, \"addon-mod-forum-discussion-info\"], [\"slot\", \"start\", 3, \"user\", \"courseId\", \"linkProfile\", 4, \"ngIf\"], [1, \"addon-mod-forum-discussion-author\"], [\"class\", \"core-discussionusername\", 4, \"ngIf\"], [\"class\", \"core-groupname\", 4, \"ngIf\"], [\"class\", \"ion-text-center addon-mod-forum-discussion-more-info\", 4, \"ngIf\"], [\"fill\", \"clear\", \"slot\", \"end\", 3, \"click\", 4, \"ngIf\"], [\"name\", \"fas-map-pin\"], [\"name\", \"fas-star\", 1, \"addon-forum-star\"], [\"name\", \"fas-lock\", 1, \"addon-mod-forum-locked-icon\"], [\"slot\", \"start\", 3, \"user\", \"courseId\", \"linkProfile\"], [1, \"core-discussionusername\"], [1, \"core-groupname\"], [\"name\", \"fas-users\"], [\"contextLevel\", \"course\", 3, \"text\", \"contextInstanceId\", \"wsNotFiltered\"], [\"name\", \"fas-clock\", \"aria-hidden\", \"true\"], [1, \"ion-text-center\", \"addon-mod-forum-discussion-more-info\"], [1, \"ion-text-start\"], [1, \"ion-text-end\"], [\"name\", \"fas-comments\", \"aria-hidden\", \"true\"], [\"class\", \"ion-text-center\", 4, \"ngIf\"], [1, \"ion-text-center\"], [\"aria-hidden\", \"true\"], [1, \"sr-only\"], [\"fill\", \"clear\", \"slot\", \"end\", 3, \"click\"], [\"name\", \"ellipsis-vertical\", \"slot\", \"icon-only\", \"aria-hidden\", \"true\"], [\"slot\", \"fixed\", \"core-fab\", \"\", \"vertical\", \"bottom\", \"horizontal\", \"end\"], [3, \"click\"], [\"name\", \"fas-plus\", \"aria-hidden\", \"true\"]],\n  template: function AddonModForumIndexComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"core-navbar-buttons\", 0)(1, \"ion-button\", 1);\n      i0.ɵɵlistener(\"click\", function AddonModForumIndexComponent_Template_ion_button_click_1_listener() {\n        return ctx.openSearch();\n      });\n      i0.ɵɵpipe(2, \"translate\");\n      i0.ɵɵelement(3, \"ion-icon\", 2);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(4, \"ion-button\", 3);\n      i0.ɵɵlistener(\"click\", function AddonModForumIndexComponent_Template_ion_button_click_4_listener() {\n        return ctx.openModuleSummary();\n      });\n      i0.ɵɵpipe(5, \"translate\");\n      i0.ɵɵelement(6, \"ion-icon\", 4);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(7, \"core-context-menu\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(8, \"core-split-view\")(9, \"ion-refresher\", 5);\n      i0.ɵɵlistener(\"ionRefresh\", function AddonModForumIndexComponent_Template_ion_refresher_ionRefresh_9_listener($event) {\n        return ctx.doRefresh($event.target);\n      });\n      i0.ɵɵelement(10, \"ion-refresher-content\", 6);\n      i0.ɵɵpipe(11, \"translate\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(12, \"core-loading\", 7)(13, \"core-course-module-info\", 8);\n      i0.ɵɵlistener(\"completionChanged\", function AddonModForumIndexComponent_Template_core_course_module_info_completionChanged_13_listener() {\n        return ctx.onCompletionChange();\n      });\n      i0.ɵɵelementStart(14, \"ion-item\", 9)(15, \"ion-label\");\n      i0.ɵɵtext(16);\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵtemplate(17, AddonModForumIndexComponent_core_group_selector_17_Template, 1, 3, \"core-group-selector\", 10);\n      i0.ɵɵtemplate(18, AddonModForumIndexComponent_ion_card_18_Template, 5, 1, \"ion-card\", 11);\n      i0.ɵɵtemplate(19, AddonModForumIndexComponent_ion_card_19_Template, 6, 3, \"ion-card\", 11);\n      i0.ɵɵtemplate(20, AddonModForumIndexComponent_ion_card_20_Template, 6, 2, \"ion-card\", 11);\n      i0.ɵɵtemplate(21, AddonModForumIndexComponent_ng_container_21_Template, 6, 6, \"ng-container\", 12);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(22, \"core-course-module-navigation\", 13);\n      i0.ɵɵtemplate(23, AddonModForumIndexComponent_ion_fab_23_Template, 5, 2, \"ion-fab\", 14);\n      i0.ɵɵelementEnd();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(1);\n      i0.ɵɵattribute(\"aria-label\", i0.ɵɵpipeBind1(2, 21, \"core.search\"));\n      i0.ɵɵadvance(3);\n      i0.ɵɵattribute(\"aria-label\", i0.ɵɵpipeBind1(5, 23, \"core.info\"));\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"disabled\", ctx.showLoading || ctx.discussions && !ctx.discussions.loaded);\n      i0.ɵɵadvance(1);\n      i0.ɵɵpropertyInterpolate(\"pullingText\", i0.ɵɵpipeBind1(11, 25, \"core.pulltorefresh\"));\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"hideUntil\", !ctx.showLoading && ctx.discussions && ctx.discussions.loaded);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"module\", ctx.module)(\"description\", ctx.forum && ctx.forum.type !== \"single\" && ctx.description)(\"component\", ctx.component)(\"componentId\", ctx.componentId)(\"courseId\", ctx.courseId)(\"hasDataToSync\", ctx.hasOffline || ctx.hasOfflineRatings);\n      i0.ɵɵadvance(3);\n      i0.ɵɵtextInterpolate1(\" \", ctx.descriptionNote, \" \");\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.supportsChangeGroup);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.availabilityMessage);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.showQAMessage);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.usesGroups && ctx.canAddDiscussion && !ctx.canAddDiscussionToGroup);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.forum);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"hidden\", ctx.showLoading)(\"courseId\", ctx.courseId)(\"currentModuleId\", ctx.module.id);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.canAddDiscussionToGroup);\n    }\n  },\n  styles: [\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n[_nghost-%COMP%]   .addon-forum-star[_ngcontent-%COMP%] {\\n  color: var(--core-star-color);\\n}\\n[_nghost-%COMP%]   .core-discussionusername[_ngcontent-%COMP%] {\\n  font-size: 1.2em;\\n}\\n[_nghost-%COMP%]   .core-groupname[_ngcontent-%COMP%] {\\n  display: flex;\\n  align-items: center;\\n  gap: 4px;\\n}\\n[_nghost-%COMP%]   .addon-mod-forum-discussion.item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%] {\\n  margin-top: 4px;\\n}\\n[_nghost-%COMP%]   .addon-mod-forum-discussion.item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   .item-heading[_ngcontent-%COMP%] {\\n  margin-top: 8px;\\n  margin-bottom: 8px;\\n  font-weight: bold;\\n}\\n[_nghost-%COMP%]   .addon-mod-forum-discussion.item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   .item-heading[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%] {\\n  -webkit-margin-start: 0;\\n  margin-inline-start: 0;\\n  -webkit-margin-end: 6px;\\n  margin-inline-end: 6px;\\n  margin-top: 0;\\n  margin-bottom: 0;\\n}\\n[_nghost-%COMP%]   .addon-mod-forum-discussion.item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   .item-heading[_ngcontent-%COMP%]   ion-icon.addon-mod-forum-locked-icon[_ngcontent-%COMP%] {\\n  -webkit-margin-start: 4px;\\n  margin-inline-start: 4px;\\n  -webkit-margin-end: 0px;\\n  margin-inline-end: 0px;\\n  color: var(--gray-500);\\n}\\n[_nghost-%COMP%]   .addon-mod-forum-discussion.item[_ngcontent-%COMP%]   core-user-avatar[_ngcontent-%COMP%] {\\n  --core-avatar-size: var(--addon-forum-avatar-size);\\n  -webkit-margin-start: 0;\\n  margin-inline-start: 0;\\n  -webkit-margin-end: 8px;\\n  margin-inline-end: 8px;\\n  margin-top: 0;\\n  margin-bottom: 0;\\n}\\n[_nghost-%COMP%]   .addon-mod-forum-discussion.item[_ngcontent-%COMP%]   .addon-mod-forum-discussion-info[_ngcontent-%COMP%] {\\n  display: flex;\\n  align-items: center;\\n}\\n[_nghost-%COMP%]   .addon-mod-forum-discussion.item[_ngcontent-%COMP%]   .addon-mod-forum-discussion-info[_ngcontent-%COMP%]   .addon-mod-forum-discussion-author[_ngcontent-%COMP%] {\\n  flex-grow: 1;\\n}\\n[_nghost-%COMP%]   .addon-mod-forum-discussion.item[_ngcontent-%COMP%]   .addon-mod-forum-discussion-title[_ngcontent-%COMP%] {\\n  -webkit-margin-end: 8px;\\n  margin-inline-end: 8px;\\n  line-height: 18px;\\n}\\n[_nghost-%COMP%]   .addon-mod-forum-discussion.item[_ngcontent-%COMP%]   .addon-mod-forum-discussion-more-info.ios[_ngcontent-%COMP%] {\\n  font-size: 0.9rem;\\n}\\n[_nghost-%COMP%]   .addon-mod-forum-discussion.item[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%] {\\n  position: absolute;\\n  top: 4px;\\n}\\n@supports (inset-inline-start: 0) {\\n  [_nghost-%COMP%]   .addon-mod-forum-discussion.item[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%] {\\n    inset-inline-end: 8px;\\n  }\\n}\\n@supports not (inset-inline-start: 0) {\\n  [_nghost-%COMP%]   .addon-mod-forum-discussion.item[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%] {\\n    right: 8px;\\n  }\\n  [dir=rtl][_nghost-%COMP%]   .addon-mod-forum-discussion.item[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%], [dir=rtl]   [_nghost-%COMP%]   .addon-mod-forum-discussion.item[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%] {\\n    left: unset;\\n    right: unset;\\n    left: 8px;\\n  }\\n  [_nghost-%COMP%]   .addon-mod-forum-discussion.item[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]:dir(rtl) {\\n    left: unset;\\n    right: unset;\\n    left: 8px;\\n  }\\n}\\n[_nghost-%COMP%]   .core-group-selector[_ngcontent-%COMP%] {\\n  border-top: 1px solid var(--spacer-color);\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy90aGVtZS9nbG9iYWxzLnNjc3MiLCJ3ZWJwYWNrOi8vLi9zcmMvdGhlbWUvaGVscGVycy9pb25pYy5mdW5jdGlvbnMuc3RyaW5nLnNjc3MiLCJ3ZWJwYWNrOi8vLi9zcmMvdGhlbWUvaGVscGVycy9pb25pYy5mdW5jdGlvbnMuY29sb3Iuc2NzcyIsIndlYnBhY2s6Ly8uL3NyYy90aGVtZS9oZWxwZXJzL2lvbmljLm1peGlucy5zY3NzIiwid2VicGFjazovLy4vc3JjL3RoZW1lL2hlbHBlcnMvaW9uaWMuY29tcG9uZW50cy5taXhpbnMuc2NzcyIsIndlYnBhY2s6Ly8uL3NyYy90aGVtZS9oZWxwZXJzL2N1c3RvbS5taXhpbnMuc2NzcyIsIndlYnBhY2s6Ly8uL3NyYy90aGVtZS9nbG9iYWxzLmN1c3RvbS5zY3NzIiwid2VicGFjazovLy4vc3JjL3RoZW1lL2dsb2JhbHMudmFyaWFibGVzLnNjc3MiLCJ3ZWJwYWNrOi8vLi9zcmMvYWRkb25zL21vZC9mb3J1bS9jb21wb25lbnRzL2luZGV4L2luZGV4LnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7RUFBQTtBQ0FBOzs7OztFQUFBO0FDQUE7Ozs7O0VBQUE7QUNBQTs7Ozs7RUFBQTtBQ0FBOzs7Ozs7RUFBQTtBQ0VBOzs7O0VBQUE7QUE0R0E7O0VBQUE7QUM5R0E7Ozs7RUFBQTtBQ0FBOzs7O0VBQUE7QUErREE7Ozs7RUFBQTtBQzNESTtFQUNJLDZCQUFBO0FBa0RSO0FBL0NJO0VBQ0ksZ0JBQUE7QUFpRFI7QUE5Q0k7RUFDSSxhQUFBO0VBQ0EsbUJBQUE7RUFDQSxRQUFBO0FBZ0RSO0FBNUNRO0VBQ0ksZUFBQTtBQThDWjtBQTVDWTtFQUNJLGVBQUE7RUFDQSxrQkFBQTtFQUNBLGlCQUFBO0FBOENoQjtBQTVDZ0I7RUwwUlosdUJLelIyQztFTDBSM0Msc0JLMVIyQztFTDJSM0MsdUJLM1JtQztFTDRSbkMsc0JLNVJtQztFTDBTckMsYUsxU2tDO0VMMlNsQyxnQkszUzBDO0FBbUQ1QztBQWpEb0I7RUx1UmhCLHlCS3RSK0M7RUx1Ui9DLHdCS3ZSK0M7RUx3Ui9DLHVCS3hSb0Q7RUx5UnBELHNCS3pSb0Q7RUFDaEMsc0JBQUE7QUFzRHhCO0FBOUNRO0VBQ0ksa0RBQUE7RUw0UVIsdUJLMVFtQztFTDJRbkMsc0JLM1FtQztFTDRRbkMsdUJLNVEyQjtFTDZRM0Isc0JLN1EyQjtFTDJSN0IsYUszUjBCO0VMNFIxQixnQks1UmtDO0FBb0RwQztBQWpEUTtFQUNJLGFBQUE7RUFDQSxtQkFBQTtBQW1EWjtBQWhEUTtFQUNJLFlBQUE7QUFrRFo7QUEvQ1E7RUxnUUosdUJLL1B5QztFTGdRekMsc0JLaFF5QztFQUNqQyxpQkFBQTtBQWtEWjtBQTlDUTtFQUNJLGlCQUFBO0FBZ0RaO0FBN0NRO0VBQ0ksa0JBQUE7RUw2VlYsUUs1VjZCO0FBK0MvQjtBTHdRTTtFQUNFO0lBRUUscUJLMVQwQjtFQW1EbEM7QUFDRjtBTDZRTTtFQUNFO0lBR0ksVUtyVXdCO0VBd0RsQztFTDBHVztJQXNLRCxXQUFBO0lBQ0EsWUFBQTtJQUVBLFNLM1V3QjtFQTZEbEM7RUxtSVc7SUF3SUQsV0FBQTtJQUNBLFlBQUE7SUFFQSxTSzNVd0I7RUFrRWxDO0FBQ0Y7QUE5REk7RUFDSSx5Q0FBQTtBQWdFUiIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQXBwIEdsb2JhbCB2YXJpYWJsZXMgU0NTU1xuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogUGxhY2UgaGVyZSB0aGUgZGlmZmVyZW50IGZpbGVzIHlvdSBzaG91bGQgaW1wb3J0IHRvIHVzZSBnbG9iYWwgdmFyaWFibGVzLlxuICovXG5cbiRmb250LXBhdGg6IFwiLi4vYXNzZXRzL2ZvbnRzXCI7XG4kYXNzZXRzLXBhdGg6IFwiLi4vYXNzZXRzXCI7XG5cbkBpbXBvcnQgXCIuL2hlbHBlcnMvaGVscGVycy5zY3NzXCI7XG5AaW1wb3J0IFwiLi9nbG9iYWxzLmN1c3RvbS5zY3NzXCI7XG5AaW1wb3J0IFwiLi9nbG9iYWxzLnZhcmlhYmxlcy5zY3NzXCI7XG4iLCIvKipcbiAqIEltcG9ydGVkIGlvbmljIHN0cmluZyBmdW5jdGlvbnMgZm9yIFNDU1NcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqIEV4dHJhY3RlZCBmcm9tXG4gKiBodHRwczovL2dpdGh1Yi5jb20vaW9uaWMtdGVhbS9pb25pYy1mcmFtZXdvcmsvYmxvYi9tYXN0ZXIvY29yZS9zcmMvdGhlbWVzL2lvbmljLmZ1bmN0aW9ucy5zdHJpbmcuc2Nzc1xuICovXG5cblxuLy8gU3RyaW5nIFV0aWxpdHkgRnVuY3Rpb25zXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4vLyBTdHJpbmcgUmVwbGFjZSBGdW5jdGlvblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuQGZ1bmN0aW9uIHN0ci1yZXBsYWNlKCRzdHJpbmcsICRzZWFyY2gsICRyZXBsYWNlOiBcIlwiKSB7XG4gICRpbmRleDogc3RyLWluZGV4KCRzdHJpbmcsICRzZWFyY2gpO1xuXG4gIEBpZiAkaW5kZXgge1xuICAgIEByZXR1cm4gc3RyLXNsaWNlKCRzdHJpbmcsIDEsICRpbmRleCAtIDEpICsgJHJlcGxhY2UgKyBzdHItcmVwbGFjZShzdHItc2xpY2UoJHN0cmluZywgJGluZGV4ICsgc3RyLWxlbmd0aCgkc2VhcmNoKSksICRzZWFyY2gsICRyZXBsYWNlKTtcbiAgfVxuXG4gIEByZXR1cm4gJHN0cmluZztcbn1cblxuLy8gU3RyaW5nIFNwbGl0IEZ1bmN0aW9uXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5cbkBmdW5jdGlvbiBzdHItc3BsaXQoJHN0cmluZywgJHNlcGFyYXRvcikge1xuICAvLyBlbXB0eSBhcnJheS9saXN0XG4gICRzcGxpdC1hcnI6ICgpO1xuICAvLyBmaXJzdCBpbmRleCBvZiBzZXBhcmF0b3IgaW4gc3RyaW5nXG4gICRpbmRleDogc3RyLWluZGV4KCRzdHJpbmcsICRzZXBhcmF0b3IpO1xuICAvLyBsb29wIHRocm91Z2ggc3RyaW5nXG4gIEB3aGlsZSAkaW5kZXggIT0gbnVsbCB7XG4gICAgLy8gZ2V0IHRoZSBzdWJzdHJpbmcgZnJvbSB0aGUgZmlyc3QgY2hhcmFjdGVyIHRvIHRoZSBzZXBhcmF0b3JcbiAgICAkaXRlbTogc3RyLXNsaWNlKCRzdHJpbmcsIDEsICRpbmRleCAtIDEpO1xuICAgIC8vIHB1c2ggaXRlbSB0byBhcnJheVxuICAgICRzcGxpdC1hcnI6IGFwcGVuZCgkc3BsaXQtYXJyLCAkaXRlbSk7XG4gICAgLy8gcmVtb3ZlIGl0ZW0gYW5kIHNlcGFyYXRvciBmcm9tIHN0cmluZ1xuICAgICRzdHJpbmc6IHN0ci1zbGljZSgkc3RyaW5nLCAkaW5kZXggKyAxKTtcbiAgICAvLyBmaW5kIG5ldyBpbmRleCBvZiBzZXBhcmF0b3JcbiAgICAkaW5kZXg6IHN0ci1pbmRleCgkc3RyaW5nLCAkc2VwYXJhdG9yKTtcbiAgfVxuICAvLyBhZGQgdGhlIHJlbWFpbmluZyBzdHJpbmcgdG8gbGlzdCAodGhlIGxhc3QgaXRlbSlcbiAgJHNwbGl0LWFycjogYXBwZW5kKCRzcGxpdC1hcnIsICRzdHJpbmcpO1xuXG4gIEByZXR1cm4gJHNwbGl0LWFycjtcbn1cblxuXG4vLyBTdHJpbmcgRXh0cmFjdCBGdW5jdGlvblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuQGZ1bmN0aW9uIHN0ci1leHRyYWN0KCRzdHJpbmcsICRzdGFydCwgJGVuZCkge1xuICAkc3RhcnQtaW5kZXg6IHN0ci1pbmRleCgkc3RyaW5nLCAkc3RhcnQpO1xuXG4gIEBpZiAkc3RhcnQtaW5kZXgge1xuICAgICRwb3N0OiBzdHItc2xpY2UoJHN0cmluZywgJHN0YXJ0LWluZGV4ICsgc3RyLWxlbmd0aCgkc3RhcnQpKTtcbiAgICAkZW5kLWluZGV4OiBzdHItaW5kZXgoJHBvc3QsICRlbmQpO1xuXG4gICAgQGlmICRlbmQtaW5kZXgge1xuICAgICAgQHJldHVybiBzdHItc2xpY2UoJHBvc3QsIDEsICRlbmQtaW5kZXggLSAxKTtcbiAgICB9XG4gIH1cblxuICBAcmV0dXJuIG51bGw7XG59XG5cblxuLy8gU3RyaW5nIENvbnRhaW5zIEZ1bmN0aW9uXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5AZnVuY3Rpb24gc3RyLWNvbnRhaW5zKCRzdHJpbmcsICRuZWVkbGUpIHtcbiAgQGlmICh0eXBlLW9mKCRzdHJpbmcpID09IHN0cmluZykge1xuICAgIEByZXR1cm4gc3RyLWluZGV4KCRzdHJpbmcsICRuZWVkbGUpICE9IG51bGw7XG4gIH1cblxuICBAcmV0dXJuIGZhbHNlO1xufVxuXG5cbi8vIFVSTCBFbmNvZGUgRnVuY3Rpb25cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbkBmdW5jdGlvbiB1cmwtZW5jb2RlKCR2YWwpIHtcbiAgJHNwYWNlczogc3RyLXJlcGxhY2UoJHZhbCwgXCIgXCIsIFwiJTIwXCIpO1xuICAkZW5jb2RlZDogc3RyLXJlcGxhY2UoJHNwYWNlcywgXCIjXCIsIFwiJTIzXCIpO1xuICBAcmV0dXJuICRlbmNvZGVkO1xufVxuXG5cbi8vIEFkZCBSb290IFNlbGVjdG9yXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gQWRkcyBhIHJvb3Qgc2VsZWN0b3IgdXNpbmcgaG9zdCBiYXNlZCBvbiB0aGUgc2VsZWN0b3IgcGFzc2VkXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5AZnVuY3Rpb24gYWRkLXJvb3Qtc2VsZWN0b3IoJHJvb3QsICRhZGRIb3N0U2VsZWN0b3IpIHtcbiAgJHNlbGVjdG9yczogc3RyLXNwbGl0KCRyb290LCBcIixcIik7XG5cbiAgJGxpc3Q6ICgpO1xuXG4gIEBlYWNoICRzZWxlY3RvciBpbiAkc2VsZWN0b3JzIHtcbiAgICAvLyBJZiB0aGUgc2VsZWN0b3IgY29udGFpbnMgOmhvc3QoIGl0IG1lYW5zIGl0IGlzIHRhcmdldGluZyBhIGNsYXNzIG9uIHRoZSBob3N0XG4gICAgLy8gZWxlbWVudCBzbyB3ZSBuZWVkIHRvIGNoYW5nZSBob3cgd2UgdGFyZ2V0IGl0OlxuICAgIC8vIEBpbmNsdWRlIGFkZC1yb290LXNlbGVjdG9yKFwiOmhvc3QoLmZpeGVkKVwiLCBcIltkaXI9cnRsXVwiKVxuICAgIC8vIC0tPiA6aG9zdC1jb250ZXh0KFtkaXI9cnRsXSk6aG9zdCguZml4ZWQpXG4gICAgLy8gLS0+IDpob3N0LWNvbnRleHQoW2Rpcj1ydGxdKS5maXhlZFxuICAgIEBpZiBzdHItY29udGFpbnMoJHNlbGVjdG9yLCBcIjpob3N0KFwiKSB7XG4gICAgICAvLyBAaW5jbHVkZSBhZGQtcm9vdC1zZWxlY3RvcihcIjpob3N0KC5maXhlZClcIiwgXCJbZGlyPXJ0bF1cIilcbiAgICAgIC8vIC0tPiA6aG9zdC1jb250ZXh0KFtkaXI9cnRsXSk6aG9zdCguZml4ZWQpXG4gICAgICAkc2hhZG93LWVsZW1lbnQ6IHN0ci1yZXBsYWNlKCRzZWxlY3RvciwgXCI6aG9zdChcIiwgXCI6aG9zdC1jb250ZXh0KCN7JGFkZEhvc3RTZWxlY3Rvcn0pOmhvc3QoXCIpO1xuICAgICAgJGxpc3Q6IGFwcGVuZCgkbGlzdCwgJHNoYWRvdy1lbGVtZW50LCBjb21tYSk7XG5cbiAgICAgICRuZXctZWxlbWVudDogKCk7XG4gICAgICAkZWxlbWVudHM6IHN0ci1zcGxpdCgkc2VsZWN0b3IsIFwiIFwiKTtcblxuICAgICAgQGVhY2ggJGVsZW1lbnQgaW4gJGVsZW1lbnRzIHtcbiAgICAgICAgQGlmIHN0ci1jb250YWlucygkZWxlbWVudCwgXCI6aG9zdChcIikge1xuICAgICAgICAgICRzY29wZWQtZWxlbWVudDogJGVsZW1lbnQ7XG5cbiAgICAgICAgICAvLyBSZXBsYWNlIHRoZSA6aG9zdCggYW5kICkgc28gYWxsIHdlIGhhdmUgbGVmdCBpcyB0aGUgY2xhc3NcbiAgICAgICAgICAvLyBpbnNpZGUgb2YgaXQ6XG4gICAgICAgICAgLy8gOmhvc3QoLmZpeGVkKSAtPiAuZml4ZWRcbiAgICAgICAgICAkc2NvcGVkLWVsZW1lbnQ6IHN0ci1yZXBsYWNlKCRzY29wZWQtZWxlbWVudCwgXCIpXCIsIFwiXCIpO1xuICAgICAgICAgICRzY29wZWQtZWxlbWVudDogc3RyLXJlcGxhY2UoJHNjb3BlZC1lbGVtZW50LCBcIjpob3N0KFwiLCBcIlwiKTtcblxuICAgICAgICAgIC8vIEFkZCB0aGUgY2xhc3MgYmFjayBpbnNpZGUgb2YgaG9zdCB3aXRoIHRoZSBydGwgc2VsZWN0b3I6XG4gICAgICAgICAgLy8gLmZpeGVkIC0+IDpob3N0LWNvbnRleHQoW2Rpcj1ydGxdKS5maXhlZFxuICAgICAgICAgICRzY29wZWQtZWxlbWVudDogc3RyLXJlcGxhY2UoJHNjb3BlZC1lbGVtZW50LCAkc2NvcGVkLWVsZW1lbnQsIFwiOmhvc3QtY29udGV4dCgjeyRhZGRIb3N0U2VsZWN0b3J9KSN7JHNjb3BlZC1lbGVtZW50fVwiKTtcblxuICAgICAgICAgIC8vIEBpbmNsdWRlIGFkZC1yb290LXNlbGVjdG9yKFwiOmhvc3QoLmZpeGVkKVwiLCBcIltkaXI9cnRsXVwiKVxuICAgICAgICAgIC8vIC0tPiA6aG9zdC1jb250ZXh0KFtkaXI9cnRsXSkuZml4ZWRcbiAgICAgICAgICAkbmV3LWVsZW1lbnQ6IGFwcGVuZCgkbmV3LWVsZW1lbnQsICRzY29wZWQtZWxlbWVudCwgc3BhY2UpO1xuICAgICAgICB9IEBlbHNlIHtcbiAgICAgICAgICAvLyBBZGQgYmFjayBhbnkgc2VsZWN0b3JzIHRoYXQgZm9sbG93ZWQgdGhlIGhvc3QgYWZ0ZXIgdHJhbnNmb3JtaW5nIHRoZVxuICAgICAgICAgIC8vIGZpcnN0IHNlbGVjdG9yOlxuICAgICAgICAgIC8vIDpob3N0KC5maXhlZCkgOjpzbG90dGVkKGlvbi1pY29uKVxuICAgICAgICAgIC8vIC0tPiA6aG9zdC1jb250ZXh0KFtkaXI9cnRsXSk6aG9zdCguZml4ZWQpIDo6c2xvdHRlZChpb24taWNvbilcbiAgICAgICAgICAvLyAtLT4gOmhvc3QtY29udGV4dChbZGlyPXJ0bF0pLmZpeGVkIDo6c2xvdHRlZChpb24taWNvbilcbiAgICAgICAgICAkbmV3LWVsZW1lbnQ6IGFwcGVuZCgkbmV3LWVsZW1lbnQsICRlbGVtZW50LCBzcGFjZSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgJGxpc3Q6IGFwcGVuZCgkbGlzdCwgJG5ldy1lbGVtZW50LCBjb21tYSk7XG4gICAgLy8gSWYgdGhlIHNlbGVjdG9yIGNvbnRhaW5zIDpob3N0IHdpdGhvdXQgYSBwYXJhbnRoZXNlc1xuICAgIC8vIGl0IG1lYW5zIGl0IGlzIHRhcmdldGluZyBqdXN0IHRoZSBob3N0XG4gICAgLy8gZWxlbWVudCBzbyB3ZSBjYW4gY2hhbmdlIGl0IHRvIGxvb2sgZm9yIGhvc3QtY29udGV4dFxuICAgIC8vIEBpbmNsdWRlIGFkZC1yb290LXNlbGVjdG9yKFwiOmhvc3RcIiwgXCJbZGlyPXJ0bF1cIilcbiAgICAvLyAtLT4gOmhvc3QtY29udGV4dChbZGlyPXJ0bF0pXG4gICAgLy8gLS0+IDpob3N0OmRpcihydGwpXG4gICAgfSBAZWxzZSBpZiBzdHItY29udGFpbnMoJHNlbGVjdG9yLCBcIjpob3N0XCIpIHtcbiAgICAgICRuZXctZWxlbWVudDogKCk7XG4gICAgICAkZWxlbWVudHM6IHN0ci1zcGxpdCgkc2VsZWN0b3IsIFwiIFwiKTtcblxuICAgICAgQGVhY2ggJGVsZW1lbnQgaW4gJGVsZW1lbnRzIHtcbiAgICAgICAgQGlmIHN0ci1jb250YWlucygkZWxlbWVudCwgXCI6aG9zdFwiKSB7XG4gICAgICAgICAgLy8gUmVwbGFjZSB0aGUgOmhvc3Qgd2l0aCB0aGUgYWRkSG9zdFNlbGVjdG9yOlxuICAgICAgICAgIC8vIDpob3N0IC0+IDpob3N0LWNvbnRleHQoW2Rpcj1ydGxdKVxuICAgICAgICAgICR1cGRhdGVkLWVsZW1lbnQ6IHN0ci1yZXBsYWNlKCRlbGVtZW50LCBcIjpob3N0XCIsIFwiOmhvc3QtY29udGV4dCgjeyRhZGRIb3N0U2VsZWN0b3J9KVwiKTtcblxuICAgICAgICAgIC8vIEFkZCB0aGUgZmluYWwgc2VsZWN0b3IgYWZ0ZXIgYWxsIHRyYW5zZm9ybWF0aW9uczpcbiAgICAgICAgICAvLyA6aG9zdCAtPiA6aG9zdC1jb250ZXh0KFtkaXI9cnRsXSlcbiAgICAgICAgICAkbmV3LWVsZW1lbnQ6IGFwcGVuZCgkbmV3LWVsZW1lbnQsICR1cGRhdGVkLWVsZW1lbnQsIHNwYWNlKTtcbiAgICAgICAgfSBAZWxzZSB7XG4gICAgICAgICAgLy8gQWRkIGJhY2sgYW55IHNlbGVjdG9ycyB0aGF0IGZvbGxvd2VkIHRoZSBob3N0IGFmdGVyIHRyYW5zZm9ybWluZyB0aGVcbiAgICAgICAgICAvLyBmaXJzdCBzZWxlY3RvcjpcbiAgICAgICAgICAvLyA6aG9zdCA6OnNsb3R0ZWQoaW9uLWljb24pIC0+IDpob3N0LWNvbnRleHQoW2Rpcj1ydGxdKSA6OnNsb3R0ZWQoaW9uLWljb24pXG4gICAgICAgICAgJG5ldy1lbGVtZW50OiBhcHBlbmQoJG5ldy1lbGVtZW50LCAkZWxlbWVudCwgc3BhY2UpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgICRsaXN0OiBhcHBlbmQoJGxpc3QsICRuZXctZWxlbWVudCwgY29tbWEpO1xuICAgIC8vIElmIHRoZSBzZWxlY3RvciBkb2VzIG5vdCBjb250YWluIGhvc3QgYXQgYWxsIGl0IGlzIGVpdGhlciBhIHNoYWRvd1xuICAgIC8vIG9yIG5vcm1hbCBlbGVtZW50IHNvIGFwcGVuZCBib3RoIHRoZSBhZGRIb3N0U2VsZWN0b3IgYW5kIGhvc3QtY29udGV4dFxuICAgIC8vIEBpbmNsdWRlIGFkZC1yb290LXNlbGVjdG9yKFwiaW9uLWNvbXBvbmVudFwiLCBcIltkaXI9cnRsXVwiKVxuICAgIC8vIC0tPiA6aG9zdC1jb250ZXh0KFtkaXI9cnRsXSkgaW9uLWNvbXBvbmVudFxuICAgIC8vIC0tPiBbZGlyPXJ0bF0gaW9uLWNvbXBvbmVudFxuICAgIH0gQGVsc2Uge1xuICAgICAgJGxpc3Q6IGFwcGVuZCgkbGlzdCwgXCIjeyRhZGRIb3N0U2VsZWN0b3J9ICN7JHNlbGVjdG9yfVwiLCBjb21tYSk7XG4gICAgICAkbGlzdDogYXBwZW5kKCRsaXN0LCBcIjpob3N0LWNvbnRleHQoI3skYWRkSG9zdFNlbGVjdG9yfSkgI3skc2VsZWN0b3J9XCIsIGNvbW1hKTtcbiAgICB9XG4gIH1cblxuICBAcmV0dXJuICRsaXN0O1xufVxuIiwiLyoqXG4gKiBJbXBvcnRlZCBpb25pYyBjb2xvciBmdW5jdGlvbnMgZm9yIFNDU1NcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqIEV4dHJhY3RlZCBmcm9tXG4gKiBodHRwczovL2dpdGh1Yi5jb20vaW9uaWMtdGVhbS9pb25pYy1mcmFtZXdvcmsvYmxvYi9tYXN0ZXIvY29yZS9zcmMvdGhlbWVzL2lvbmljLmZ1bmN0aW9ucy5jb2xvci5zY3NzXG4gKi9cblxuLy8gR2V0cyB0aGUgYWN0aXZlIGNvbG9yJ3MgY3NzIHZhcmlhYmxlIGZyb20gYSB2YXJpYXRpb24uIEFscGhhIGlzIG9wdGlvbmFsLlxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIEV4YW1wbGUgdXNhZ2U6XG4vLyBjdXJyZW50LWNvbG9yKGJhc2UpID0+IHZhcigtLWlvbi1jb2xvci1iYXNlKVxuLy8gY3VycmVudC1jb2xvcihjb250cmFzdCwgMC4xKSA9PiByZ2JhKHZhcigtLWlvbi1jb2xvci1jb250cmFzdC1yZ2IpLCAwLjEpXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQGZ1bmN0aW9uIGN1cnJlbnQtY29sb3IoJHZhcmlhdGlvbiwgJGFscGhhOiBudWxsKSB7XG4gIEBpZiAkYWxwaGEgPT0gbnVsbCB7XG4gICAgQHJldHVybiB2YXIoLS1pb24tY29sb3ItI3skdmFyaWF0aW9ufSk7XG4gIH0gQGVsc2Uge1xuICAgIEByZXR1cm4gcmdiYSh2YXIoLS1pb24tY29sb3ItI3skdmFyaWF0aW9ufS1yZ2IpLCAjeyRhbHBoYX0pO1xuICB9XG59XG5cbi8vIEdldHMgdGhlIHNwZWNpZmljIGNvbG9yJ3MgY3NzIHZhcmlhYmxlIGZyb20gdGhlIG5hbWUgYW5kIHZhcmlhdGlvbi4gQWxwaGEvcmdiIGFyZSBvcHRpb25hbC5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBFeGFtcGxlIHVzYWdlOlxuLy8gaW9uLWNvbG9yKHByaW1hcnksIGJhc2UpID0+IHZhcigtLWlvbi1jb2xvci1wcmltYXJ5LCAjMzg4MGZmKVxuLy8gaW9uLWNvbG9yKHNlY29uZGFyeSwgY29udHJhc3QpID0+IHZhcigtLWlvbi1jb2xvci1zZWNvbmRhcnktY29udHJhc3QpXG4vLyBpb24tY29sb3IocHJpbWFyeSwgYmFzZSwgMC41KSA9PiByZ2JhKHZhcigtLWlvbi1jb2xvci1wcmltYXJ5LXJnYiwgNTYsIDEyOCwgMjU1KSwgMC41KVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbkBmdW5jdGlvbiBpb24tY29sb3IoJG5hbWUsICR2YXJpYXRpb24sICRhbHBoYTogbnVsbCwgJHJnYjogbnVsbCkge1xuICAkdmFsdWVzOiBtYXAtZ2V0KCRjb2xvcnMsICRuYW1lKTtcbiAgJHZhbHVlOiBtYXAtZ2V0KCR2YWx1ZXMsICR2YXJpYXRpb24pO1xuICAkdmFyaWFibGU6IC0taW9uLWNvbG9yLSN7JG5hbWV9LSN7JHZhcmlhdGlvbn07XG5cbiAgQGlmICgkdmFyaWF0aW9uID09IGJhc2UpIHtcbiAgICAkdmFyaWFibGU6IC0taW9uLWNvbG9yLSN7JG5hbWV9O1xuICB9XG5cbiAgQGlmICgkYWxwaGEpIHtcbiAgICAkdmFsdWU6IGNvbG9yLXRvLXJnYi1saXN0KCR2YWx1ZSk7XG4gICAgQHJldHVybiByZ2JhKHZhcigjeyR2YXJpYWJsZX0tcmdiLCAkdmFsdWUpLCAkYWxwaGEpO1xuICB9XG4gIEBpZiAoJHJnYikge1xuICAgICR2YWx1ZTogY29sb3ItdG8tcmdiLWxpc3QoJHZhbHVlKTtcbiAgICAkdmFyaWFibGU6ICN7JHZhcmlhYmxlfS1yZ2I7XG4gIH1cblxuICBAcmV0dXJuIHZhcigjeyR2YXJpYWJsZX0sICR2YWx1ZSk7XG59XG5cbi8vIE1peGVzIGEgY29sb3Igd2l0aCBibGFjayB0byBjcmVhdGUgaXRzIHNoYWRlLlxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbkBmdW5jdGlvbiBnZXQtY29sb3Itc2hhZGUoJGNvbG9yKSB7XG4gIEByZXR1cm4gbWl4KCMwMDAsICRjb2xvciwgMTIlKTtcbn1cblxuLy8gTWl4ZXMgYSBjb2xvciB3aXRoIHdoaXRlIHRvIGNyZWF0ZSBpdHMgdGludC5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5AZnVuY3Rpb24gZ2V0LWNvbG9yLXRpbnQoJGNvbG9yKSB7XG4gIEByZXR1cm4gbWl4KCNmZmYsICRjb2xvciwgMTAlKTtcbn1cblxuLy8gQ29udmVydHMgYSBjb2xvciB0byBhIGNvbW1hIHNlcGFyYXRlZCByZ2IuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQGZ1bmN0aW9uIGNvbG9yLXRvLXJnYi1saXN0KCRjb2xvcikge1xuICBAcmV0dXJuICN7cmVkKCRjb2xvcil9LCN7Z3JlZW4oJGNvbG9yKX0sI3tibHVlKCRjb2xvcil9O1xufVxuIiwiLyoqXG4gKiBJbXBvcnRlZCBpb25pYyBtaXhpbnMgZm9yIFNDU1NcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqIEV4dHJhY3RlZCBmcm9tXG4gKiBodHRwczovL2dpdGh1Yi5jb20vaW9uaWMtdGVhbS9pb25pYy1mcmFtZXdvcmsvYmxvYi9tYXN0ZXIvY29yZS9zcmMvdGhlbWVzL2lvbmljLm1peGlucy5zY3NzXG4gKi9cblxuQG1peGluIGlucHV0LWNvdmVyKCkge1xuICBAaW5jbHVkZSBwb3NpdGlvbigwLCBudWxsLCBudWxsLCAwKTtcbiAgQGluY2x1ZGUgbWFyZ2luKDApO1xuXG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcblxuICB3aWR0aDogMTAwJTtcbiAgaGVpZ2h0OiAxMDAlO1xuXG4gIGJvcmRlcjogMDtcbiAgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQ7XG4gIGN1cnNvcjogcG9pbnRlcjtcblxuICBhcHBlYXJhbmNlOiBub25lO1xuICBvdXRsaW5lOiBub25lO1xuXG4gICY6Oi1tb3otZm9jdXMtaW5uZXIge1xuICAgIGJvcmRlcjogMDtcbiAgfVxufVxuXG5AbWl4aW4gdmlzdWFsbHktaGlkZGVuKCkge1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG5cbiAgdG9wOiAwO1xuICBsZWZ0OiAwO1xuICByaWdodDogMDtcbiAgYm90dG9tOiAwO1xuXG4gIHdpZHRoOiAxMDAlO1xuICBoZWlnaHQ6IDEwMCU7XG5cbiAgbWFyZ2luOiAwO1xuICBwYWRkaW5nOiAwO1xuXG4gIGJvcmRlcjogMDtcbiAgb3V0bGluZTogMDtcbiAgY2xpcDogcmVjdCgwIDAgMCAwKTtcblxuICBvcGFjaXR5OiAwO1xuICBvdmVyZmxvdzogaGlkZGVuO1xuXG4gIC13ZWJraXQtYXBwZWFyYW5jZTogbm9uZTtcbiAgLW1vei1hcHBlYXJhbmNlOiBub25lO1xufVxuXG5AbWl4aW4gdGV4dC1pbmhlcml0KCkge1xuICBmb250LWZhbWlseTogaW5oZXJpdDtcbiAgZm9udC1zaXplOiBpbmhlcml0O1xuICBmb250LXN0eWxlOiBpbmhlcml0O1xuICBmb250LXdlaWdodDogaW5oZXJpdDtcbiAgbGV0dGVyLXNwYWNpbmc6IGluaGVyaXQ7XG4gIHRleHQtZGVjb3JhdGlvbjogaW5oZXJpdDtcbiAgdGV4dC1pbmRlbnQ6IGluaGVyaXQ7XG4gIHRleHQtb3ZlcmZsb3c6IGluaGVyaXQ7XG4gIHRleHQtdHJhbnNmb3JtOiBpbmhlcml0O1xuICB0ZXh0LWFsaWduOiBpbmhlcml0O1xuICB3aGl0ZS1zcGFjZTogaW5oZXJpdDtcbiAgY29sb3I6IGluaGVyaXQ7XG59XG5cbkBtaXhpbiBidXR0b24tc3RhdGUoKSB7XG4gIEBpbmNsdWRlIHBvc2l0aW9uKDAsIDAsIDAsIDApO1xuXG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcblxuICBjb250ZW50OiBcIlwiO1xuXG4gIG9wYWNpdHk6IDA7XG59XG5cbi8vIEZvbnQgc21vb3RoaW5nXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5AbWl4aW4gZm9udC1zbW9vdGhpbmcoKSB7XG4gIC1tb3otb3N4LWZvbnQtc21vb3RoaW5nOiBncmF5c2NhbGU7XG4gIC13ZWJraXQtZm9udC1zbW9vdGhpbmc6IGFudGlhbGlhc2VkO1xufVxuXG4vLyBHZXQgdGhlIGtleSBmcm9tIGEgbWFwIGJhc2VkIG9uIHRoZSBpbmRleFxuQGZ1bmN0aW9uIGluZGV4LXRvLWtleSgkbWFwLCAkaW5kZXgpIHtcbiAgJGtleXM6IG1hcC1rZXlzKCRtYXApO1xuXG4gIEByZXR1cm4gbnRoKCRrZXlzLCAkaW5kZXgpO1xufVxuXG5cbi8vIEJyZWFrcG9pbnQgTWl4aW5zXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuLy8gQnJlYWtwb2ludCB2aWV3cG9ydCBzaXplcyBhbmQgbWVkaWEgcXVlcmllcy5cbi8vXG4vLyBCcmVha3BvaW50cyBhcmUgZGVmaW5lZCBhcyBhIG1hcCBvZiAobmFtZTogbWluaW11bSB3aWR0aCksIG9yZGVyIGZyb20gc21hbGwgdG8gbGFyZ2U6XG4vL1xuLy8gICAgKHhzOiAwLCBzbTogNTc2cHgsIG1kOiA3NjhweCwgbGc6IDk5MnB4LCB4bDogMTIwMHB4KVxuLy9cbi8vIFRoZSBtYXAgZGVmaW5lZCBpbiB0aGUgYCRzY3JlZW4tYnJlYWtwb2ludHNgIGdsb2JhbCB2YXJpYWJsZSBpcyB1c2VkIGFzIHRoZSBgJGJyZWFrcG9pbnRzYCBhcmd1bWVudCBieSBkZWZhdWx0LlxuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuLy8gTWluaW11bSBicmVha3BvaW50IHdpZHRoLiBOdWxsIGZvciB0aGUgc21hbGxlc3QgKGZpcnN0KSBicmVha3BvaW50LlxuLy9cbi8vICAgID4+IGJyZWFrcG9pbnQtbWluKHNtLCAoeHM6IDAsIHNtOiA1NzZweCwgbWQ6IDc2OHB4LCBsZzogOTkycHgsIHhsOiAxMjAwcHgpKVxuLy8gICAgNTc2cHhcbkBmdW5jdGlvbiBicmVha3BvaW50LW1pbigkbmFtZSwgJGJyZWFrcG9pbnRzOiAkc2NyZWVuLWJyZWFrcG9pbnRzKSB7XG4gICRtaW46IG1hcC1nZXQoJGJyZWFrcG9pbnRzLCAkbmFtZSk7XG5cbiAgQHJldHVybiBpZigkbmFtZSAhPSBpbmRleC10by1rZXkoJGJyZWFrcG9pbnRzLCAxKSwgJG1pbiwgbnVsbCk7XG59XG5cbi8vIFJldHVybnMgYSBibGFuayBzdHJpbmcgaWYgc21hbGxlc3QgYnJlYWtwb2ludCwgb3RoZXJ3aXNlIHJldHVybnMgdGhlIG5hbWUgd2l0aCBhIGRhc2ggaW5mcm9udC5cbi8vIFVzZWZ1bCBmb3IgbWFraW5nIHJlc3BvbnNpdmUgdXRpbGl0aWVzLlxuLy9cbi8vICAgID4+IGJyZWFrcG9pbnQtaW5maXgoeHMsICh4czogMCwgc206IDU3NnB4LCBtZDogNzY4cHgsIGxnOiA5OTJweCwgeGw6IDEyMDBweCkpXG4vLyAgICBcIlwiICAoUmV0dXJucyBhIGJsYW5rIHN0cmluZylcbi8vICAgID4+IGJyZWFrcG9pbnQtaW5maXgoc20sICh4czogMCwgc206IDU3NnB4LCBtZDogNzY4cHgsIGxnOiA5OTJweCwgeGw6IDEyMDBweCkpXG4vLyAgICBcIi1zbVwiXG5AZnVuY3Rpb24gYnJlYWtwb2ludC1pbmZpeCgkbmFtZSwgJGJyZWFrcG9pbnRzOiAkc2NyZWVuLWJyZWFrcG9pbnRzKSB7XG4gIEByZXR1cm4gaWYoYnJlYWtwb2ludC1taW4oJG5hbWUsICRicmVha3BvaW50cykgPT0gbnVsbCwgXCJcIiwgXCItI3skbmFtZX1cIik7XG59XG5cbi8vIE1lZGlhIG9mIGF0IGxlYXN0IHRoZSBtaW5pbXVtIGJyZWFrcG9pbnQgd2lkdGguIE5vIHF1ZXJ5IGZvciB0aGUgc21hbGxlc3QgYnJlYWtwb2ludC5cbi8vIE1ha2VzIHRoZSBAY29udGVudCBhcHBseSB0byB0aGUgZ2l2ZW4gYnJlYWtwb2ludCBhbmQgd2lkZXIuXG5AbWl4aW4gbWVkaWEtYnJlYWtwb2ludC11cCgkbmFtZSwgJGJyZWFrcG9pbnRzOiAkc2NyZWVuLWJyZWFrcG9pbnRzKSB7XG4gICRtaW46IGJyZWFrcG9pbnQtbWluKCRuYW1lLCAkYnJlYWtwb2ludHMpO1xuICBAaWYgJG1pbiB7XG4gICAgQG1lZGlhIChtaW4td2lkdGg6ICRtaW4pIHtcbiAgICAgIEBjb250ZW50O1xuICAgIH1cbiAgfSBAZWxzZSB7XG4gICAgQGNvbnRlbnQ7XG4gIH1cbn1cblxuLy8gTmFtZSBvZiB0aGUgbmV4dCBicmVha3BvaW50LCBvciBudWxsIGZvciB0aGUgbGFzdCBicmVha3BvaW50LlxuLy9cbi8vICAgID4+IGJyZWFrcG9pbnQtbmV4dChzbSlcbi8vICAgIG1kXG4vLyAgICA+PiBicmVha3BvaW50LW5leHQoc20sICh4czogMCwgc206IDU3NnB4LCBtZDogNzY4cHgsIGxnOiA5OTJweCwgeGw6IDEyMDBweCkpXG4vLyAgICBtZFxuLy8gICAgPj4gYnJlYWtwb2ludC1uZXh0KHNtLCAkYnJlYWtwb2ludC1uYW1lczogKHhzIHNtIG1kIGxnIHhsKSlcbi8vICAgIG1kXG5AZnVuY3Rpb24gYnJlYWtwb2ludC1uZXh0KCRuYW1lLCAkYnJlYWtwb2ludHM6ICRzY3JlZW4tYnJlYWtwb2ludHMsICRicmVha3BvaW50LW5hbWVzOiBtYXAta2V5cygkYnJlYWtwb2ludHMpKSB7XG4gICRuOiBpbmRleCgkYnJlYWtwb2ludC1uYW1lcywgJG5hbWUpO1xuICBAcmV0dXJuIGlmKCRuIDwgbGVuZ3RoKCRicmVha3BvaW50LW5hbWVzKSwgbnRoKCRicmVha3BvaW50LW5hbWVzLCAkbiArIDEpLCBudWxsKTtcbn1cblxuLy8gTWF4aW11bSBicmVha3BvaW50IHdpZHRoLiBOdWxsIGZvciB0aGUgc21hbGxlc3QgKGZpcnN0KSBicmVha3BvaW50LlxuLy8gVGhlIG1heGltdW0gdmFsdWUgaXMgcmVkdWNlZCBieSAwLjAycHggdG8gd29yayBhcm91bmQgdGhlIGxpbWl0YXRpb25zIG9mXG4vLyBgbWluLWAgYW5kIGBtYXgtYCBwcmVmaXhlcyBhbmQgdmlld3BvcnRzIHdpdGggZnJhY3Rpb25hbCB3aWR0aHMuXG4vL1xuLy8gU2VlIGh0dHBzOi8vd3d3LnczLm9yZy9UUi9tZWRpYXF1ZXJpZXMtNC8jbXEtbWluLW1heFxuLy8gVXNlcyAwLjAycHggcmF0aGVyIHRoYW4gMC4wMXB4IHRvIHdvcmsgYXJvdW5kIGEgY3VycmVudCByb3VuZGluZyBidWcgaW4gU2FmYXJpLlx0Ly8gVXNlcyAwLjAycHggcmF0aGVyIHRoYW4gMC4wMXB4IHRvIHdvcmsgYXJvdW5kIGEgY3VycmVudCByb3VuZGluZyBidWcgaW4gU2FmYXJpLlxuLy8gU2VlIGh0dHBzOi8vYnVncy53ZWJraXQub3JnL3Nob3dfYnVnLmNnaT9pZD0xNzgyNjFcdC8vIFNlZSBodHRwczovL2J1Z3Mud2Via2l0Lm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MTc4MjYxXG4vL1xuLy8gICAgPj4gYnJlYWtwb2ludC1tYXgobWQsICh4czogMCwgc206IDU3NnB4LCBtZDogNzY4cHgsIGxnOiA5OTJweCwgeGw6IDEyMDBweCkpXG4vLyAgICA3NjcuOThweFxuQGZ1bmN0aW9uIGJyZWFrcG9pbnQtbWF4KCRuYW1lLCAkYnJlYWtwb2ludHM6ICRzY3JlZW4tYnJlYWtwb2ludHMpIHtcbiAgJG1heDogbWFwLWdldCgkYnJlYWtwb2ludHMsICRuYW1lKTtcbiAgQHJldHVybiBpZigkbWF4IGFuZCAkbWF4ID4gMCwgJG1heCAtIC4wMiwgbnVsbCk7XG59XG5cbi8vIE1lZGlhIG9mIGF0IG1vc3QgdGhlIG1heGltdW0gYnJlYWtwb2ludCB3aWR0aC4gTm8gcXVlcnkgZm9yIHRoZSBsYXJnZXN0IGJyZWFrcG9pbnQuXG4vLyBNYWtlcyB0aGUgQGNvbnRlbnQgYXBwbHkgdG8gdGhlIGdpdmVuIGJyZWFrcG9pbnQgYW5kIG5hcnJvd2VyLlxuQG1peGluIG1lZGlhLWJyZWFrcG9pbnQtZG93bigkbmFtZSwgJGJyZWFrcG9pbnRzOiAkc2NyZWVuLWJyZWFrcG9pbnRzKSB7XG4gICRtYXg6IGJyZWFrcG9pbnQtbWF4KCRuYW1lLCAkYnJlYWtwb2ludHMpO1xuICBAaWYgJG1heCB7XG4gICAgQG1lZGlhIChtYXgtd2lkdGg6ICRtYXgpIHtcbiAgICAgIEBjb250ZW50O1xuICAgIH1cbiAgfSBAZWxzZSB7XG4gICAgQGNvbnRlbnQ7XG4gIH1cbn1cblxuXG4vLyBUZXh0IERpcmVjdGlvbiAtIGx0ciAvIHJ0bFxuLy9cbi8vIENTUyBkZWZhdWx0cyB0byB1c2UgdGhlIGx0ciBjc3MsIGFuZCBhZGRzIFtkaXI9cnRsXSBzZWxlY3RvcnNcbi8vIHRvIG92ZXJyaWRlIGx0ciBkZWZhdWx0cy5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuQG1peGluIG11bHRpLWRpcigpIHtcbiAgQGNvbnRlbnQ7XG5cbiAgLy8gJHJvb3Q6ICN7Jn07XG4gIC8vIEBhdC1yb290IFtkaXJdIHtcbiAgLy8gICAjeyRyb290fSB7XG4gIC8vICAgICBAY29udGVudDtcbiAgLy8gICB9XG4gIC8vIH1cbn1cblxuQG1peGluIHJ0bCgpIHtcbiAgJHJvb3Q6ICN7Jn07XG5cbiAgJHJvb3RTcGxpdDogc3RyLXNwbGl0KCRyb290LCBcIixcIik7XG4gICRzZWxlY3RvcnM6ICN7YWRkLXJvb3Qtc2VsZWN0b3IoJHJvb3QsIFwiW2Rpcj1ydGxdXCIpfTtcbiAgJHNlbGVjdG9yc1NwbGl0OiBzdHItc3BsaXQoJHNlbGVjdG9ycywgXCIsXCIpO1xuXG4gICRob3N0Q29udGV4dFNlbGVjdG9yczogKCk7XG4gICRyZXN0U2VsZWN0b3JzOiAoKTtcbiAgJGRpclNlbGVjdG9yczogKCk7XG5cbiAgLy8gU2VsZWN0b3JzIG11c3QgYmUgc3BsaXQgaW50byBpbmRpdmlkdWFsIHNlbGVjdG9ycyBpbiBjYXNlIHRoZSBicm93c2VyXG4gIC8vIGRvZXNuJ3Qgc3VwcG9ydCBhIHNwZWNpZmljIHNlbGVjdG9yLlxuICAvLyBGb3IgZXhhbXBsZSwgRmlyZWZveCBhbmQgU2FmYXJpIGRvZXNuJ3Qgc3VwcG9ydCBgOmhvc3QtY29udGV4dCgpYC5cbiAgLy8gSWYgYW4gaW52YWxpZCBzZWxlY3RvciBpcyB1c2VkLCB0aGVuIHRoZSBlbnRpcmUgZ3JvdXAgb2Ygc2VsZWN0b3JzXG4gIC8vIHdpbGwgYmUgaWdub3JlZC5cbiAgLy8gQGxpbmsgaHR0cHM6Ly93d3cudzMub3JnL1RSL3NlbGVjdG9ycy0zLyNncm91cGluZ1xuICBAZWFjaCAkc2VsZWN0b3IgaW4gJHNlbGVjdG9yc1NwbGl0IHtcbiAgICAvLyBHcm91cCB0aGUgc2VsZWN0b3JzIGJhY2sgaW50byBhIHNpbmdsZSBzZWxlY3RvciB0byBvcHRpbWl6ZSB0aGUgb3V0cHV0LlxuICAgIEBpZiBzdHItaW5kZXgoJHNlbGVjdG9yLCBcIjpob3N0LWNvbnRleHRcIikge1xuICAgICAgJGhvc3RDb250ZXh0U2VsZWN0b3JzOiBhcHBlbmQoJGhvc3RDb250ZXh0U2VsZWN0b3JzLCAkc2VsZWN0b3IsIGNvbW1hKTtcbiAgICB9IEBlbHNlIHtcbiAgICAgIC8vIEdyb3VwIHRoZSBzZWxlY3RvcnMgYmFjayBpbnRvIGEgc2luZ2xlIHNlbGVjdG9yIHRvIG9wdGltaXplIHRoZSBvdXRwdXQuXG4gICAgICAkcmVzdFNlbGVjdG9yczogYXBwZW5kKCRyZXN0U2VsZWN0b3JzLCAkc2VsZWN0b3IsIGNvbW1hKTtcbiAgICB9XG4gIH1cblxuICAvLyBTdXBwb3J0ZWQgYnkgQ2hyb21lLlxuICBAaWYgbGVuZ3RoKCRob3N0Q29udGV4dFNlbGVjdG9ycykgPiAwIHtcbiAgICBAYXQtcm9vdCAjeyRob3N0Q29udGV4dFNlbGVjdG9yc30ge1xuICAgICAgQGNvbnRlbnQ7XG4gICAgfVxuICB9XG5cbiAgLy8gU3VwcG9ydGVkIGJ5IGFsbCBicm93c2Vycy5cbiAgQGlmIGxlbmd0aCgkcmVzdFNlbGVjdG9ycykgPiAwIHtcbiAgICBAYXQtcm9vdCAjeyRyZXN0U2VsZWN0b3JzfSB7XG4gICAgICBAY29udGVudDtcbiAgICB9XG4gIH1cblxuICAvLyBJZiBicm93c2VyIGNhbiBzdXBwb3J0IGA6ZGlyKClgLCB0aGVuIGFkZCB0aGUgYDpkaXIoKWAgc2VsZWN0b3JzLlxuICAvLyBAc3VwcG9ydHMgc2VsZWN0b3IoOmRpcihydGwpKSB7IC8vIEAgSU1QT1RBTlQgTk9URTogVGhpcyBoYXMgYmVlbiByZW1vdmVkIGJlY2F1c2Ugc2VsZWN0b3IgZnVuY3Rpb24gaXMgbm90IHN1cHBvcnRlZCBpbiBjdXJyZW50IFNDU1NcbiAgLy8gQWRkaW5nIDpkaXIoKSBpbiBjYXNlIHRoZSBicm93c2VyIGRvZXNuJ3Qgc3VwcG9ydCBgOmhvc3QtY29udGV4dCgpYCBhbmQgZG9lcyBzdXBwb3J0IGA6ZGlyKClgLlxuICAvLyBgOmhvc3QtY29udGV4dCgpYCBpcyBhZGRlZDpcbiAgLy8gLSB0aHJvdWdoIHRoZSBgYWRkLXJvb3Qtc2VsZWN0b3IoKWAgZnVuY3Rpb24uXG4gIC8vIC0gZmlyc3Qgc28gdGhhdCBpdCB0YWtlcyBwcmVjZWRlbmNlIG92ZXIgYDpkaXIoKWAuXG4gIC8vIEZvciBleGFtcGxlLFxuICAvLyAtIEZpcmVmb3ggZG9lc24ndCBzdXBwb3J0IGA6aG9zdC1jb250ZXh0KClgLCBidXQgZG9lcyBzdXBwb3J0IGA6ZGlyKClgLlxuICAvLyAtIFNhZmFyaSBkb2Vzbid0IHN1cHBvcnQgYDpob3N0LWNvbnRleHQoKWAsIGJ1dCBTYWZhcmkgMTYuNCsgc3VwcG9ydHMgYDpkaXIoKWBcbiAgLy8gQGxpbmsgaHR0cHM6Ly93ZWJraXQub3JnL2Jsb2cvMTM5NjYvd2Via2l0LWZlYXR1cmVzLWluLXNhZmFyaS0xNi00L1xuICBAZWFjaCAkc2VsZWN0b3IgaW4gJHJvb3RTcGxpdCB7XG4gICAgJGRpclNlbGVjdG9yOiBcIiN7JHNlbGVjdG9yfTpkaXIocnRsKVwiO1xuICAgIC8vIEdyb3VwIHRoZSBzZWxlY3RvcnMgYmFjayBpbnRvIGEgc2luZ2xlIHNlbGVjdG9yIHRvIG9wdGltaXplIHRoZSBvdXRwdXQuXG4gICAgJGRpclNlbGVjdG9yczogYXBwZW5kKCRkaXJTZWxlY3RvcnMsICRkaXJTZWxlY3RvciwgY29tbWEpO1xuICB9XG5cbiAgLy8gU3VwcG9ydGVkIGJ5IEZpcmVmb3guXG4gIEBpZiBsZW5ndGgoJGRpclNlbGVjdG9ycykgPiAwIHtcbiAgICBAYXQtcm9vdCAjeyRkaXJTZWxlY3RvcnN9IHtcbiAgICAgIEBjb250ZW50O1xuICAgIH1cbiAgfVxuICAvL31cbn1cblxuQG1peGluIGx0cigpIHtcbiAgQGNvbnRlbnQ7XG59XG5cblxuLy8gU1ZHIEJhY2tncm91bmQgSW1hZ2UgTWl4aW5cbi8vIEBwYXJhbSB7c3RyaW5nfSAkc3ZnXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5AbWl4aW4gc3ZnLWJhY2tncm91bmQtaW1hZ2UoJHN2ZywgJGZsaXAtcnRsOiBmYWxzZSkge1xuICAkdXJsOiB1cmwtZW5jb2RlKCRzdmcpO1xuICAkdmlld0JveDogc3RyLXNwbGl0KHN0ci1leHRyYWN0KCRzdmcsIFwidmlld0JveD0nXCIsIFwiJ1wiKSwgXCIgXCIpO1xuXG4gIEBpZiAkZmxpcC1ydGwgIT0gdHJ1ZSBvciAkdmlld0JveCA9PSBudWxsIHtcbiAgICBAaW5jbHVkZSBtdWx0aS1kaXIoKSB7XG4gICAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoXCJkYXRhOmltYWdlL3N2Zyt4bWw7Y2hhcnNldD11dGYtOCwjeyR1cmx9XCIpO1xuICAgIH1cbiAgfSBAZWxzZSB7XG4gICAgJHRyYW5zZm9ybTogXCJ0cmFuc2Zvcm09J3RyYW5zbGF0ZSgje250aCgkdmlld0JveCwgMyl9LCAwKSBzY2FsZSgtMSwgMSknXCI7XG4gICAgJGZsaXBwZWQtdXJsOiAkc3ZnO1xuICAgICRmbGlwcGVkLXVybDogc3RyLXJlcGxhY2UoJGZsaXBwZWQtdXJsLCBcIjxwYXRoXCIsIFwiPHBhdGggI3skdHJhbnNmb3JtfVwiKTtcbiAgICAkZmxpcHBlZC11cmw6IHN0ci1yZXBsYWNlKCRmbGlwcGVkLXVybCwgXCI8bGluZVwiLCBcIjxsaW5lICN7JHRyYW5zZm9ybX1cIik7XG4gICAgJGZsaXBwZWQtdXJsOiBzdHItcmVwbGFjZSgkZmxpcHBlZC11cmwsIFwiPHBvbHlnb25cIiwgXCI8cG9seWdvbiAjeyR0cmFuc2Zvcm19XCIpO1xuICAgICRmbGlwcGVkLXVybDogdXJsLWVuY29kZSgkZmxpcHBlZC11cmwpO1xuXG4gICAgQGluY2x1ZGUgbHRyICgpIHtcbiAgICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChcImRhdGE6aW1hZ2Uvc3ZnK3htbDtjaGFyc2V0PXV0Zi04LCN7JHVybH1cIik7XG4gICAgfVxuICAgIEBpbmNsdWRlIHJ0bCgpIHtcbiAgICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChcImRhdGE6aW1hZ2Uvc3ZnK3htbDtjaGFyc2V0PXV0Zi04LCN7JGZsaXBwZWQtdXJsfVwiKTtcbiAgICB9XG4gIH1cbn1cblxuLy8gQWRkIHByb3BlcnR5IGhvcml6b250YWxcbi8vIEBwYXJhbSB7c3RyaW5nfSAkc3RhcnRcbi8vIEBwYXJhbSB7c3RyaW5nfSAkZW5kXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5AbWl4aW4gcHJvcGVydHktaG9yaXpvbnRhbCgkcHJvcCwgJHN0YXJ0LCAkZW5kOiAkc3RhcnQpIHtcbiAgQGlmICRzdGFydCA9PSAwIGFuZCAkZW5kID09IDAge1xuICAgICN7JHByb3B9LWxlZnQ6ICRzdGFydDtcbiAgICAjeyRwcm9wfS1yaWdodDogJGVuZDtcblxuICB9IEBlbHNlIHtcbiAgICAtd2Via2l0LSN7JHByb3B9LXN0YXJ0OiAkc3RhcnQ7XG4gICAgI3skcHJvcH0taW5saW5lLXN0YXJ0OiAkc3RhcnQ7XG4gICAgLXdlYmtpdC0jeyRwcm9wfS1lbmQ6ICRlbmQ7XG4gICAgI3skcHJvcH0taW5saW5lLWVuZDogJGVuZDtcbiAgfVxufVxuXG4vLyBBZGQgcHJvcGVydHkgZm9yIGFsbCBkaXJlY3Rpb25zXG4vLyBAcGFyYW0ge3N0cmluZ30gJHByb3Bcbi8vIEBwYXJhbSB7c3RyaW5nfSAkdG9wXG4vLyBAcGFyYW0ge3N0cmluZ30gJGVuZFxuLy8gQHBhcmFtIHtzdHJpbmd9ICRib3R0b21cbi8vIEBwYXJhbSB7c3RyaW5nfSAkc3RhcnRcbi8vIEBwYXJhbSB7Ym9vbGVhbn0gJGNvbnRlbnQgaW5jbHVkZSBjb250ZW50IG9yIHVzZSBkZWZhdWx0XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5AbWl4aW4gcHJvcGVydHkoJHByb3AsICR0b3AsICRlbmQ6ICR0b3AsICRib3R0b206ICR0b3AsICRzdGFydDogJGVuZCkge1xuICBAaW5jbHVkZSBwcm9wZXJ0eS1ob3Jpem9udGFsKCRwcm9wLCAkc3RhcnQsICRlbmQpO1xuICAjeyRwcm9wfS10b3A6ICR0b3A7XG4gICN7JHByb3B9LWJvdHRvbTogJGJvdHRvbTtcbn1cblxuLy8gQWRkIHBhZGRpbmcgaG9yaXpvbnRhbFxuLy8gQHBhcmFtIHtzdHJpbmd9ICRzdGFydFxuLy8gQHBhcmFtIHtzdHJpbmd9ICRlbmRcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbkBtaXhpbiBwYWRkaW5nLWhvcml6b250YWwoJHN0YXJ0LCAkZW5kOiAkc3RhcnQpIHtcbiAgQGluY2x1ZGUgcHJvcGVydHktaG9yaXpvbnRhbChwYWRkaW5nLCAkc3RhcnQsICRlbmQpO1xufVxuXG4vLyBBZGQgcGFkZGluZyBmb3IgYWxsIGRpcmVjdGlvbnNcbi8vIEBwYXJhbSB7c3RyaW5nfSAkdG9wXG4vLyBAcGFyYW0ge3N0cmluZ30gJGVuZFxuLy8gQHBhcmFtIHtzdHJpbmd9ICRib3R0b21cbi8vIEBwYXJhbSB7c3RyaW5nfSAkc3RhcnRcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbkBtaXhpbiBwYWRkaW5nKCR0b3AsICRlbmQ6ICR0b3AsICRib3R0b206ICR0b3AsICRzdGFydDogJGVuZCkge1xuICBAaW5jbHVkZSBwcm9wZXJ0eShwYWRkaW5nLCAkdG9wLCAkZW5kLCAkYm90dG9tLCAkc3RhcnQpO1xufVxuXG4vLyBBZGQgbWFyZ2luIGhvcml6b250YWxcbi8vIEBwYXJhbSB7c3RyaW5nfSAkc3RhcnRcbi8vIEBwYXJhbSB7c3RyaW5nfSAkZW5kXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5AbWl4aW4gbWFyZ2luLWhvcml6b250YWwoJHN0YXJ0LCAkZW5kOiAkc3RhcnQpIHtcbiAgQGluY2x1ZGUgcHJvcGVydHktaG9yaXpvbnRhbChtYXJnaW4sICRzdGFydCwgJGVuZCk7XG59XG5cbi8vIEFkZCBtYXJnaW4gZm9yIGFsbCBkaXJlY3Rpb25zXG4vLyBAcGFyYW0ge3N0cmluZ30gJHRvcFxuLy8gQHBhcmFtIHtzdHJpbmd9ICRlbmRcbi8vIEBwYXJhbSB7c3RyaW5nfSAkYm90dG9tXG4vLyBAcGFyYW0ge3N0cmluZ30gJHN0YXJ0XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5AbWl4aW4gbWFyZ2luKCR0b3AsICRlbmQ6ICR0b3AsICRib3R0b206ICR0b3AsICRzdGFydDogJGVuZCkge1xuICBAaW5jbHVkZSBwcm9wZXJ0eShtYXJnaW4sICR0b3AsICRlbmQsICRib3R0b20sICRzdGFydCk7XG59XG5cbi8vIEFkZCBwb3NpdGlvbiBob3Jpem9udGFsXG4vLyBAcGFyYW0ge3N0cmluZ30gJHN0YXJ0IC0gYW1vdW50IHRvIHBvc2l0aW9uIHN0YXJ0XG4vLyBAcGFyYW0ge3N0cmluZ30gJGVuZCAtIGFtb3VudCB0byBsZWZ0OiAwOyBlbmRcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbkBtaXhpbiBwb3NpdGlvbi1ob3Jpem9udGFsKCRzdGFydDogbnVsbCwgJGVuZDogbnVsbCkge1xuICBAaWYgJHN0YXJ0ID09ICRlbmQge1xuICAgIEBpbmNsdWRlIG11bHRpLWRpcigpIHtcbiAgICAgIGxlZnQ6ICRzdGFydDtcbiAgICAgIHJpZ2h0OiAkZW5kO1xuICAgIH1cbiAgfSBAZWxzZSB7XG4gICAgQGF0LXJvb3Qge1xuICAgICAgQHN1cHBvcnRzIChpbnNldC1pbmxpbmUtc3RhcnQ6IDApIHtcbiAgICAgICAgJiB7XG4gICAgICAgICAgaW5zZXQtaW5saW5lLXN0YXJ0OiAkc3RhcnQ7XG4gICAgICAgICAgaW5zZXQtaW5saW5lLWVuZDogJGVuZDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFRPRE8gRlctMzc2NlxuICAgIEBhdC1yb290IHtcbiAgICAgIEBzdXBwb3J0cyBub3QgKGluc2V0LWlubGluZS1zdGFydDogMCkge1xuICAgICAgICAmIHtcbiAgICAgICAgICBAaW5jbHVkZSBsdHIoKSB7XG4gICAgICAgICAgICBsZWZ0OiAkc3RhcnQ7XG4gICAgICAgICAgICByaWdodDogJGVuZDtcbiAgICAgICAgICB9XG4gICAgICAgICAgQGluY2x1ZGUgcnRsKCkge1xuICAgICAgICAgICAgbGVmdDogdW5zZXQ7XG4gICAgICAgICAgICByaWdodDogdW5zZXQ7XG5cbiAgICAgICAgICAgIGxlZnQ6ICRlbmQ7XG4gICAgICAgICAgICByaWdodDogJHN0YXJ0O1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG4vLyBBZGQgcG9zaXRpb24gZm9yIGFsbCBkaXJlY3Rpb25zXG4vLyBAcGFyYW0ge3N0cmluZ30gJHRvcFxuLy8gQHBhcmFtIHtzdHJpbmd9ICRlbmRcbi8vIEBwYXJhbSB7c3RyaW5nfSAkYm90dG9tXG4vLyBAcGFyYW0ge3N0cmluZ30gJHN0YXJ0XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5AbWl4aW4gcG9zaXRpb24oJHRvcDogbnVsbCwgJGVuZDogbnVsbCwgJGJvdHRvbTogbnVsbCwgJHN0YXJ0OiBudWxsKSB7XG4gIEBpbmNsdWRlIHBvc2l0aW9uLWhvcml6b250YWwoJHN0YXJ0LCAkZW5kKTtcbiAgdG9wOiAkdG9wO1xuICBib3R0b206ICRib3R0b207XG59XG5cbi8vIEFkZCBib3JkZXIgZm9yIGFsbCBkaXJlY3Rpb25zXG4vLyBAcGFyYW0ge3N0cmluZ30gJHRvcFxuLy8gQHBhcmFtIHtzdHJpbmd9ICRlbmRcbi8vIEBwYXJhbSB7c3RyaW5nfSAkYm90dG9tXG4vLyBAcGFyYW0ge3N0cmluZ30gJHN0YXJ0XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5AbWl4aW4gYm9yZGVyKCR0b3AsICRlbmQ6ICR0b3AsICRib3R0b206ICR0b3AsICRzdGFydDogJGVuZCkge1xuICBAaW5jbHVkZSBwcm9wZXJ0eShib3JkZXIsICR0b3AsICRlbmQsICRib3R0b20sICRzdGFydCk7XG59XG5cbi8vIEFkZCBib3JkZXIgcmFkaXVzIGZvciBhbGwgZGlyZWN0aW9uc1xuLy8gQHBhcmFtIHtzdHJpbmd9ICR0b3Atc3RhcnRcbi8vIEBwYXJhbSB7c3RyaW5nfSAkdG9wLWVuZFxuLy8gQHBhcmFtIHtzdHJpbmd9ICRib3R0b20tZW5kXG4vLyBAcGFyYW0ge3N0cmluZ30gJGJvdHRvbS1zdGFydFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQG1peGluIGJvcmRlci1yYWRpdXMoJHRvcC1zdGFydCwgJHRvcC1lbmQ6ICR0b3Atc3RhcnQsICRib3R0b20tZW5kOiAkdG9wLXN0YXJ0LCAkYm90dG9tLXN0YXJ0OiAkdG9wLWVuZCkge1xuICBAaWYgJHRvcC1zdGFydCA9PSAkdG9wLWVuZCBhbmQgJHRvcC1zdGFydCA9PSAkYm90dG9tLWVuZCBhbmQgJHRvcC1zdGFydCA9PSAkYm90dG9tLXN0YXJ0IHtcbiAgICBAaW5jbHVkZSBtdWx0aS1kaXIoKSB7XG4gICAgICBib3JkZXItcmFkaXVzOiAkdG9wLXN0YXJ0O1xuICAgIH1cbiAgfSBAZWxzZSB7XG4gICAgQGluY2x1ZGUgbHRyKCkge1xuICAgICAgYm9yZGVyLXRvcC1sZWZ0LXJhZGl1czogJHRvcC1zdGFydDtcbiAgICAgIGJvcmRlci10b3AtcmlnaHQtcmFkaXVzOiAkdG9wLWVuZDtcbiAgICAgIGJvcmRlci1ib3R0b20tcmlnaHQtcmFkaXVzOiAkYm90dG9tLWVuZDtcbiAgICAgIGJvcmRlci1ib3R0b20tbGVmdC1yYWRpdXM6ICRib3R0b20tc3RhcnQ7XG4gICAgfVxuXG4gICAgQGluY2x1ZGUgcnRsKCkge1xuICAgICAgYm9yZGVyLXRvcC1sZWZ0LXJhZGl1czogJHRvcC1lbmQ7XG4gICAgICBib3JkZXItdG9wLXJpZ2h0LXJhZGl1czogJHRvcC1zdGFydDtcbiAgICAgIGJvcmRlci1ib3R0b20tcmlnaHQtcmFkaXVzOiAkYm90dG9tLXN0YXJ0O1xuICAgICAgYm9yZGVyLWJvdHRvbS1sZWZ0LXJhZGl1czogJGJvdHRvbS1lbmQ7XG4gICAgfVxuICB9XG59XG5cbi8vIEFkZCBkaXJlY3Rpb24gZm9yIGFsbCBkaXJlY3Rpb25zXG4vLyBAcGFyYW0ge3N0cmluZ30gJGRpciAtIERpcmVjdGlvbiBvbiBMVFJcbkBtaXhpbiBkaXJlY3Rpb24oJGRpcikge1xuICAkb3RoZXItZGlyOiBudWxsO1xuXG4gIEBpZiAkZGlyID09IGx0ciB7XG4gICAgJG90aGVyLWRpcjogcnRsO1xuICB9IEBlbHNlIHtcbiAgICAkb3RoZXItZGlyOiBsdHI7XG4gIH1cblxuICBAaW5jbHVkZSBsdHIoKSB7XG4gICAgZGlyZWN0aW9uOiAkZGlyO1xuICB9XG4gIEBpbmNsdWRlIHJ0bCgpIHtcbiAgICBkaXJlY3Rpb246ICRvdGhlci1kaXI7XG4gIH1cbn1cblxuLy8gQWRkIGZsb2F0IGZvciBhbGwgZGlyZWN0aW9uc1xuLy8gQHBhcmFtIHtzdHJpbmd9ICRzaWRlXG4vLyBAcGFyYW0ge3N0cmluZ30gJGRlY29yYXRvciAtICFpbXBvcnRhbnRcbkBtaXhpbiBmbG9hdCgkc2lkZSwgJGRlY29yYXRvcjogbnVsbCkge1xuICBAaWYgJHNpZGUgPT0gc3RhcnQge1xuICAgIEBpbmNsdWRlIGx0cigpIHtcbiAgICAgIGZsb2F0OiBsZWZ0ICRkZWNvcmF0b3I7XG4gICAgfVxuICAgIEBpbmNsdWRlIHJ0bCgpIHtcbiAgICAgIGZsb2F0OiByaWdodCAkZGVjb3JhdG9yO1xuICAgIH1cbiAgfSBAZWxzZSBpZiAkc2lkZSA9PSBlbmQge1xuICAgIEBpbmNsdWRlIGx0cigpIHtcbiAgICAgIGZsb2F0OiByaWdodCAkZGVjb3JhdG9yO1xuICAgIH1cbiAgICBAaW5jbHVkZSBydGwoKSB7XG4gICAgICBmbG9hdDogbGVmdCAkZGVjb3JhdG9yO1xuICAgIH1cbiAgfSBAZWxzZSB7XG4gICAgQGluY2x1ZGUgbXVsdGktZGlyKCkge1xuICAgICAgZmxvYXQ6ICRzaWRlICRkZWNvcmF0b3I7XG4gICAgfVxuICB9XG59XG5cbkBtaXhpbiBiYWNrZ3JvdW5kLXBvc2l0aW9uKCRob3Jpem9udGFsLCAkaG9yaXpvbnRhbC1hbW91bnQ6IG51bGwsICR2ZXJ0aWNhbDogbnVsbCwgJHZlcnRpY2FsLWFtb3VudDogbnVsbCkge1xuICBAaWYgJGhvcml6b250YWwgPT0gc3RhcnQgb3IgJGhvcml6b250YWwgPT0gZW5kIHtcbiAgICAkaG9yaXpvbnRhbC1sdHI6IG51bGw7XG4gICAgJGhvcml6b250YWwtcnRsOiBudWxsO1xuICAgIEBpZiAkaG9yaXpvbnRhbCA9PSBzdGFydCB7XG4gICAgICAkaG9yaXpvbnRhbC1sdHI6IGxlZnQ7XG4gICAgICAkaG9yaXpvbnRhbC1ydGw6IHJpZ2h0O1xuICAgIH0gQGVsc2Uge1xuICAgICAgJGhvcml6b250YWwtbHRyOiByaWdodDtcbiAgICAgICRob3Jpem9udGFsLXJ0bDogbGVmdDtcbiAgICB9XG5cbiAgICBAaW5jbHVkZSBsdHIoKSB7XG4gICAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAkaG9yaXpvbnRhbC1sdHIgJGhvcml6b250YWwtYW1vdW50ICR2ZXJ0aWNhbCAkdmVydGljYWwtYW1vdW50O1xuICAgIH1cbiAgICBAaW5jbHVkZSBydGwoKSB7XG4gICAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAkaG9yaXpvbnRhbC1ydGwgJGhvcml6b250YWwtYW1vdW50ICR2ZXJ0aWNhbCAkdmVydGljYWwtYW1vdW50O1xuICAgIH1cbiAgfSBAZWxzZSB7XG4gICAgQGluY2x1ZGUgbXVsdGktZGlyKCkge1xuICAgICAgYmFja2dyb3VuZC1wb3NpdGlvbjogJGhvcml6b250YWwgJGhvcml6b250YWwtYW1vdW50ICR2ZXJ0aWNhbCAkdmVydGljYWwtYW1vdW50O1xuICAgIH1cbiAgfVxufVxuXG5AbWl4aW4gdHJhbnNmb3JtLW9yaWdpbigkeC1heGlzLCAkeS1heGlzOiBudWxsKSB7XG4gIEBpZiAkeC1heGlzID09IHN0YXJ0IHtcbiAgICBAaW5jbHVkZSBsdHIoKSB7XG4gICAgICB0cmFuc2Zvcm0tb3JpZ2luOiBsZWZ0ICR5LWF4aXM7XG4gICAgfVxuICAgIEBpbmNsdWRlIHJ0bCgpIHtcbiAgICAgIHRyYW5zZm9ybS1vcmlnaW46IHJpZ2h0ICR5LWF4aXM7XG4gICAgfVxuICB9IEBlbHNlIGlmICR4LWF4aXMgPT0gZW5kIHtcbiAgICBAaW5jbHVkZSBsdHIoKSB7XG4gICAgICB0cmFuc2Zvcm0tb3JpZ2luOiByaWdodCAkeS1heGlzO1xuICAgIH1cbiAgICBAaW5jbHVkZSBydGwoKSB7XG4gICAgICB0cmFuc2Zvcm0tb3JpZ2luOiBsZWZ0ICR5LWF4aXM7XG4gICAgfVxuICB9IEBlbHNlIGlmICR4LWF4aXMgPT0gbGVmdCBvciAkeC1heGlzID09IHJpZ2h0IHtcbiAgICBAaW5jbHVkZSBtdWx0aS1kaXIoKSB7XG4gICAgICB0cmFuc2Zvcm0tb3JpZ2luOiAkeC1heGlzICR5LWF4aXM7XG4gICAgfVxuICB9IEBlbHNlIHtcbiAgICBAaW5jbHVkZSBsdHIoKSB7XG4gICAgICB0cmFuc2Zvcm0tb3JpZ2luOiAkeC1heGlzICR5LWF4aXM7XG4gICAgfVxuICAgIEBpbmNsdWRlIHJ0bCgpIHtcbiAgICAgIHRyYW5zZm9ybS1vcmlnaW46IGNhbGMoMTAwJSAtICN7JHgtYXhpc30pICR5LWF4aXM7XG4gICAgfVxuICB9XG59XG5cbi8vIEFkZCB0cmFuc2Zvcm0gZm9yIGFsbCBkaXJlY3Rpb25zXG4vLyBAcGFyYW0ge3N0cmluZ30gJHRyYW5zZm9ybXMgLSBjb21tYSBzZXBhcmF0ZWQgbGlzdCBvZiB0cmFuc2Zvcm1zXG5AbWl4aW4gdHJhbnNmb3JtKCR0cmFuc2Zvcm1zLi4uKSB7XG4gICRleHRyYTogbnVsbDtcblxuICAkeDogbnVsbDtcbiAgJGx0ci10cmFuc2xhdGU6IG51bGw7XG4gICRydGwtdHJhbnNsYXRlOiBudWxsO1xuXG4gIEBlYWNoICR0cmFuc2Zvcm0gaW4gJHRyYW5zZm9ybXMge1xuICAgIEBpZiAoc3RyLWluZGV4KCR0cmFuc2Zvcm0sIHRyYW5zbGF0ZTNkKSkge1xuICAgICAgJHRyYW5zZm9ybTogc3RyLXJlcGxhY2UoJHRyYW5zZm9ybSwgJ3RyYW5zbGF0ZTNkKCcpO1xuICAgICAgJHRyYW5zZm9ybTogc3RyLXJlcGxhY2UoJHRyYW5zZm9ybSwgJyknKTtcblxuICAgICAgJGNvb3JkaW5hdGVzOiBzdHItc3BsaXQoJHRyYW5zZm9ybSwgJywnKTtcblxuICAgICAgJHg6IG50aCgkY29vcmRpbmF0ZXMsIDEpO1xuICAgICAgJHk6IG50aCgkY29vcmRpbmF0ZXMsIDIpO1xuICAgICAgJHo6IG50aCgkY29vcmRpbmF0ZXMsIDMpO1xuXG4gICAgICAkbHRyLXRyYW5zbGF0ZTogdHJhbnNsYXRlM2QoJHgsICR5LCAkeik7XG4gICAgICAkcnRsLXRyYW5zbGF0ZTogdHJhbnNsYXRlM2QoY2FsYygtMSAqICN7JHh9KSwgJHksICR6KTtcbiAgICB9IEBlbHNlIHtcbiAgICAgIEBpZiAkZXh0cmEgPT0gbnVsbCB7XG4gICAgICAgICRleHRyYTogJHRyYW5zZm9ybTtcbiAgICAgIH0gQGVsc2Uge1xuICAgICAgICAkZXh0cmE6ICRleHRyYSAkdHJhbnNmb3JtO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIEBpZiAkeCA9PSAnMCcgb3IgJHggPT0gbnVsbCB7XG4gICAgQGluY2x1ZGUgbXVsdGktZGlyKCkge1xuICAgICAgdHJhbnNmb3JtOiAkbHRyLXRyYW5zbGF0ZSAkZXh0cmE7XG4gICAgfVxuICB9IEBlbHNlIHtcbiAgICBAaW5jbHVkZSBsdHIoKSB7XG4gICAgICB0cmFuc2Zvcm06ICRsdHItdHJhbnNsYXRlICRleHRyYTtcbiAgICB9XG5cbiAgICBAaW5jbHVkZSBydGwoKSB7XG4gICAgICB0cmFuc2Zvcm06ICRydGwtdHJhbnNsYXRlICRleHRyYTtcbiAgICB9XG4gIH1cbn1cbiIsIi8qKlxuICogSW1wb3J0ZWQgaW9uaWMgbWl4aW5zIGZvciBTQ1NTIGZyb20gZGlmZmVyZW50IGNvbXBvbmVudHNcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqIEV4dHJhY3RlZCBmcm9tXG4gKiBodHRwczovL2dpdGh1Yi5jb20vaW9uaWMtdGVhbS9pb25pYy1mcmFtZXdvcmsvYmxvYi9tYXN0ZXIvY29yZS9zcmMvY29tcG9uZW50cy9ncmlkL2dyaWQubWl4aW5zLnNjc3NcbiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9pb25pYy10ZWFtL2lvbmljLWZyYW1ld29yay9ibG9iL21hc3Rlci9jb3JlL3NyYy9jb21wb25lbnRzL2l0ZW0vaXRlbS5taXhpbnMuc2Nzc1xuICovXG5cbi8vIFJlc3BvbnNpdmUgTWl4aW5zXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5cbi8vIENyZWF0ZXMgYSBmaXhlZCB3aWR0aCBmb3IgdGhlIGdyaWQgYmFzZWQgb24gdGhlIHNjcmVlbiBzaXplXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuQG1peGluIG1ha2UtZ3JpZC13aWR0aHMoJHdpZHRoczogJGdyaWQtd2lkdGhzLCAkYnJlYWtwb2ludHM6ICRzY3JlZW4tYnJlYWtwb2ludHMpIHtcbiAgQGVhY2ggJGJyZWFrcG9pbnQsICR3aWR0aCBpbiAkd2lkdGhzIHtcbiAgICBAaW5jbHVkZSBtZWRpYS1icmVha3BvaW50LXVwKCRicmVha3BvaW50LCAkYnJlYWtwb2ludHMpIHtcbiAgICAgIHdpZHRoOiAkd2lkdGg7XG4gICAgfVxuICB9XG5cbiAgbWF4LXdpZHRoOiAxMDAlO1xufVxuXG5cbi8vIEFkZHMgcGFkZGluZyB0byB0aGUgZWxlbWVudCBiYXNlZCBvbiBicmVha3BvaW50c1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbkBtaXhpbiBtYWtlLWJyZWFrcG9pbnQtcGFkZGluZygkcGFkZGluZ3MpIHtcbiAgQGVhY2ggJGJyZWFrcG9pbnQgaW4gbWFwLWtleXMoJHBhZGRpbmdzKSB7XG4gICAgQGluY2x1ZGUgbWVkaWEtYnJlYWtwb2ludC11cCgkYnJlYWtwb2ludCkge1xuICAgICAgJHBhZGRpbmc6IG1hcC1nZXQoJHBhZGRpbmdzLCAkYnJlYWtwb2ludCk7XG5cbiAgICAgIEBpbmNsdWRlIHBhZGRpbmcoJHBhZGRpbmcpO1xuICAgIH1cbiAgfVxufVxuXG5cbi8vIEl0ZW0gTWl4aW5zXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5AbWl4aW4gaXRlbS1wdXNoLXN2Zy11cmwoJGZpbGwpIHtcbiAgJGl0ZW0tZGV0YWlsLXB1c2gtc3ZnOiBcIjxzdmcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB2aWV3Qm94PScwIDAgMTIgMjAnPjxwYXRoIGQ9J00yLDIwbC0yLTJsOC04TDAsMmwyLTJsMTAsMTBMMiwyMHonIGZpbGw9JyN7JGZpbGx9Jy8+PC9zdmc+XCI7XG5cbiAgQGluY2x1ZGUgc3ZnLWJhY2tncm91bmQtaW1hZ2UoJGl0ZW0tZGV0YWlsLXB1c2gtc3ZnLCB0cnVlKTtcbn1cbiIsIkB1c2UgXCJzYXNzOm1hdGhcIiBhcyBtYXRoO1xuXG4vKipcbiAqIEFwcCBjdXN0b20gbWl4aW5zIGZvciBTQ1NTXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiBQbGFjZSBoZXJlIG91ciBjdXN0b20gbWl4aW5zLlxuICovXG5cbi8vIE1peGVzIGEgY29sb3Igd2l0aCBibGFjayB0byBjcmVhdGUgaXRzIHNoYWRlLlxuLy8gRGVmYXVsdCB0byBib290c3RyYXAgbGV2ZWwgNi5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5AZnVuY3Rpb24gZ2V0LWNvbG9yLXNoYWRlLXBlcmNlbnQoJGNvbG9yLCAkcGVyY2VudDogNDglKSB7XG4gICAgQHJldHVybiBtaXgoIzAwMCwgJGNvbG9yLCAkcGVyY2VudCk7XG59XG5cbi8vIE1peGVzIGEgY29sb3Igd2l0aCB3aGl0ZSB0byBjcmVhdGUgaXRzIHRpbnQuXG4vLyBEZWZhdWx0IHRvIGJvb3RzdHJhcCBsZXZlbCAtMTAuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQGZ1bmN0aW9uIGdldC1jb2xvci10aW50LXBlcmNlbnQoJGNvbG9yLCAkcGVyY2VudDogODAlKSB7XG4gICAgQHJldHVybiBtaXgoI2ZmZiwgJGNvbG9yLCAkcGVyY2VudCk7XG59XG5cbi8vIElvbmljIENvbG9yc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIEdlbmVyYXRlcyB0aGUgY29sb3IgY2xhc3NlcyBhbmQgdmFyaWFibGVzIGJhc2VkIG9uIHRoZVxuLy8gY29sb3JzIG1hcFxuXG5AbWl4aW4gZ2VuZXJhdGUtY29sb3IoJGNvbG9yLW5hbWUsICRjb2xvcnMsICR0aGVtZSkge1xuICAgICRjb2xvci10aGVtZXM6IG1hcC1nZXQoJGNvbG9ycywgJGNvbG9yLW5hbWUpO1xuICAgICRiYXNlOiBtYXAtZ2V0KCRjb2xvci10aGVtZXMsICR0aGVtZSk7XG5cbiAgICBAaWYgJHRoZW1lID09ICdkYXJrJyB7XG4gICAgICAgICRiYXNlOiBtaXgobWFwLWdldCgkY29sb3ItdGhlbWVzLCAnbGlnaHQnKSwgd2hpdGUsIDgwJSkgIWRlZmF1bHQ7XG4gICAgfVxuXG4gICAgQGluY2x1ZGUgZ2VuZXJhdGUtY29sb3ItdmFyaWFudHMoJGNvbG9yLW5hbWUsICRiYXNlKTtcbn1cblxuQG1peGluIGdlbmVyYXRlLWNvbG9yLXZhcmlhbnRzKCRjb2xvci1uYW1lLCAkYmFzZSkge1xuICAgICRjb250cmFzdDogZ2V0X2NvbnRyYXN0X2NvbG9yKCRiYXNlKTtcbiAgICAkc2hhZGU6IGdldC1jb2xvci1zaGFkZS1wZXJjZW50KCRiYXNlKTtcbiAgICAkdGludDogZ2V0LWNvbG9yLXRpbnQtcGVyY2VudCgkYmFzZSk7XG5cbiAgICAtLSN7JGNvbG9yLW5hbWV9OiAjeyRiYXNlfTtcbiAgICAtLSN7JGNvbG9yLW5hbWV9LXNoYWRlOiAjeyRzaGFkZX07XG4gICAgLS0jeyRjb2xvci1uYW1lfS10aW50OiAjeyR0aW50fTtcbiAgICAtLSN7JGNvbG9yLW5hbWV9LWNvbnRyYXN0OiAjeyRjb250cmFzdH07XG5cbiAgICAvLyBJbnRlcm5hbCBpb25pYyB1c2Ugb25seS5cbiAgICAtLWlvbi1jb2xvci0jeyRjb2xvci1uYW1lfTogdmFyKC0tI3skY29sb3ItbmFtZX0pO1xuICAgIC0taW9uLWNvbG9yLSN7JGNvbG9yLW5hbWV9LWJhc2U6IHZhcigtLWlvbi1jb2xvci0jeyRjb2xvci1uYW1lfSk7XG4gICAgLS1pb24tY29sb3ItI3skY29sb3ItbmFtZX0tcmdiOiAje2NvbG9yLXRvLXJnYi1saXN0KCRiYXNlKX07XG4gICAgLS1pb24tY29sb3ItI3skY29sb3ItbmFtZX0tY29udHJhc3Q6ICN7JGNvbnRyYXN0fTtcbiAgICAtLWlvbi1jb2xvci0jeyRjb2xvci1uYW1lfS1jb250cmFzdC1yZ2I6ICN7Y29sb3ItdG8tcmdiLWxpc3QoJGNvbnRyYXN0KX07XG4gICAgLS1pb24tY29sb3ItI3skY29sb3ItbmFtZX0tc2hhZGU6ICN7JHNoYWRlfTtcbiAgICAtLWlvbi1jb2xvci0jeyRjb2xvci1uYW1lfS10aW50OiAjeyR0aW50fTtcblxuICAgIC5pb24tY29sb3ItI3skY29sb3ItbmFtZX0ge1xuICAgICAgICAtLWlvbi1jb2xvcjogdmFyKC0taW9uLWNvbG9yLSN7JGNvbG9yLW5hbWV9KTtcbiAgICAgICAgLS1pb24tY29sb3ItYmFzZTogdmFyKC0taW9uLWNvbG9yLSN7JGNvbG9yLW5hbWV9LWJhc2UpO1xuICAgICAgICAtLWlvbi1jb2xvci1yZ2I6IHZhcigtLWlvbi1jb2xvci0jeyRjb2xvci1uYW1lfS1yZ2IpO1xuICAgICAgICAtLWlvbi1jb2xvci1jb250cmFzdDogdmFyKC0taW9uLWNvbG9yLSN7JGNvbG9yLW5hbWV9LWNvbnRyYXN0KTtcbiAgICAgICAgLS1pb24tY29sb3ItY29udHJhc3QtcmdiOiB2YXIoLS1pb24tY29sb3ItI3skY29sb3ItbmFtZX0tY29udHJhc3QtcmdiKTtcbiAgICAgICAgLS1pb24tY29sb3Itc2hhZGU6IHZhcigtLWlvbi1jb2xvci0jeyRjb2xvci1uYW1lfS1zaGFkZSk7XG4gICAgICAgIC0taW9uLWNvbG9yLXRpbnQ6IHZhcigtLWlvbi1jb2xvci0jeyRjb2xvci1uYW1lfS10aW50KTtcbiAgICB9XG59XG5cbkBtaXhpbiBjb3JlLWZvY3VzKCkge1xuICAgIG91dGxpbmU6IG5vbmU7XG4gICAgcG9zaXRpb246IHJlbGF0aXZlO1xuICAgICY6OmFmdGVyIHtcbiAgICAgICAgQGluY2x1ZGUgcG9zaXRpb24oMCwgMCwgMCwgMCk7XG4gICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICAgICAgY29udGVudDogXCJcIjtcbiAgICAgICAgb3BhY2l0eTogMTtcbiAgICAgICAgei1pbmRleDogMTtcbiAgICAgICAgQGluY2x1ZGUgY29yZS1mb2N1cy1zdHlsZSgpO1xuICAgIH1cbn1cblxuQG1peGluIGNvcmUtZm9jdXMtc3R5bGUoKSB7XG4gICAgYm94LXNoYWRvdzogaW5zZXQgMCAwIHZhcigtLWExMXktZm9jdXMtd2lkdGgpIDFweCB2YXIoLS1hMTF5LWZvY3VzLWNvbG9yKTtcbiAgICBib3JkZXItcmFkaXVzOiB2YXIoLS1ib3JkZXItcmFkaXVzKTtcbiAgICAvLyBUaGlja2VyIG9wdGlvbjpcbiAgICAvLyBib3JkZXI6IHZhcigtLWExMXktZm9jdXMtd2lkdGgpIHNvbGlkIHZhcigtLWExMXktZm9jdXMtY29sb3IpO1xufVxuXG5AbWl4aW4gY29yZS10cmFuc2l0aW9uKCRwcm9wZXJ0aWVzOiBhbGwsICRkdXJhdGlvbjogNTAwbXMsICR0aW1pbmctZnVuY3Rpb246IGVhc2UtaW4tb3V0KSB7XG4gICAgJHRyYW5zaXRpb25zOiAoKTtcbiAgICBAZWFjaCAkcHJvcGVydHkgaW4gJHByb3BlcnRpZXMge1xuICAgICAgJHRyYW5zaXRpb25zOiBhcHBlbmQoJHRyYW5zaXRpb25zLCAkcHJvcGVydHkgJGR1cmF0aW9uICR0aW1pbmctZnVuY3Rpb24sIGNvbW1hKTtcbiAgICB9XG5cbiAgICAtd2Via2l0LXRyYW5zaXRpb246ICR0cmFuc2l0aW9ucztcbiAgICB0cmFuc2l0aW9uOiAkdHJhbnNpdGlvbnM7XG59XG5cbkBtaXhpbiBzci1vbmx5KCkge1xuICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICB3aWR0aDogMXB4O1xuICAgIGhlaWdodDogMXB4O1xuICAgIHBhZGRpbmc6IDA7XG4gICAgbWFyZ2luOiAtMXB4O1xuICAgIG92ZXJmbG93OiBoaWRkZW47XG4gICAgY2xpcDogcmVjdCgwLCAwLCAwLCAwKTtcbiAgICB3aGl0ZS1zcGFjZTogbm93cmFwO1xuICAgIGJvcmRlcjogMDtcbn1cblxuLyoqXG4gKiBTYW1lIGFzIGl0ZW0tcHVzaC1zdmctdXJsIGJ1dCBhZG1pdHMgZmxpcC1ydGxcbiAqL1xuQG1peGluIHB1c2gtYXJyb3ctY29sb3IoJGZpbGw6IDYyNjI2MiwgJGZsaXAtcnRsOiBmYWxzZSkge1xuICAgICRpdGVtLWRldGFpbC1wdXNoLXN2ZzogXCI8c3ZnIHhtbG5zPSdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Zycgdmlld0JveD0nMCAwIDEyIDIwJz48cGF0aCBkPSdNMiwyMGwtMi0ybDgtOEwwLDJsMi0ybDEwLDEwTDIsMjB6JyBmaWxsPScjeyRmaWxsfScvPjwvc3ZnPlwiO1xuXG4gICAgQGluY2x1ZGUgc3ZnLWJhY2tncm91bmQtaW1hZ2UoJGl0ZW0tZGV0YWlsLXB1c2gtc3ZnLCAkZmxpcC1ydGwpO1xufVxuXG5AbWl4aW4gYm9yZGVyLXN0YXJ0KCRweCwgJHR5cGU6IG51bGwsICRjb2xvcjogbnVsbCkge1xuICAgIEBpbmNsdWRlIHByb3BlcnR5LWhvcml6b250YWwoYm9yZGVyLCAkcHggJHR5cGUgJGNvbG9yLCBudWxsKTtcbn1cblxuQG1peGluIGJvcmRlci1lbmQoJHB4LCAkdHlwZTogbnVsbCwgJGNvbG9yOiBudWxsKSB7XG4gICAgQGluY2x1ZGUgcHJvcGVydHktaG9yaXpvbnRhbChib3JkZXIsIG51bGwsICRweCAkdHlwZSAkY29sb3IpO1xufVxuXG5AbWl4aW4gc2FmZS1hcmVhLWJvcmRlci1zdGFydCgkcHgsICR0eXBlLCAkY29sb3IpIHtcbiAgICAkc2FmZS1hcmVhLXBvc2l0aW9uOiBjYWxjKHZhcigtLWlvbi1zYWZlLWFyZWEtbGVmdCkgKyAjeyRweH0pO1xuXG4gICAgQGluY2x1ZGUgYm9yZGVyLXN0YXJ0KCRzYWZlLWFyZWEtcG9zaXRpb24sICR0eXBlLCAkY29sb3IpO1xufVxuXG5AbWl4aW4gc2FmZS1hcmVhLWJvcmRlci1lbmQoJHB4LCAkdHlwZSwgJGNvbG9yKSB7XG4gICAgJHNhZmUtYXJlYS1wb3NpdGlvbjogY2FsYyh2YXIoLS1pb24tc2FmZS1hcmVhLXJpZ2h0KSArICN7JHB4fSk7XG5cbiAgICBAaW5jbHVkZSBib3JkZXItZW5kKCRzYWZlLWFyZWEtcG9zaXRpb24sICR0eXBlLCAkY29sb3IpO1xufVxuXG5AbWl4aW4gc2FmZS1hcmVhLW1hcmdpbi1ob3Jpem9udGFsKCRzdGFydCwgJGVuZDogJHN0YXJ0KSB7XG4gICAgJHNhZmUtYXJlYS1lbmQ6IG51bGw7XG4gICAgJHNhZmUtYXJlYS1zdGFydDogbnVsbDtcblxuICAgIEBpZiAoJGVuZCkge1xuICAgICAgICAkc2FmZS1hcmVhLWVuZDogY2FsYyh2YXIoLS1pb24tc2FmZS1hcmVhLXJpZ2h0KSArICN7JGVuZH0pO1xuICAgIH1cbiAgICBAaWYgKCRzdGFydCkge1xuICAgICAgICAkc2FmZS1hcmVhLXN0YXJ0OiBjYWxjKHZhcigtLWlvbi1zYWZlLWFyZWEtbGVmdCkgKyAjeyRzdGFydH0pO1xuICAgIH1cblxuICAgIEBpbmNsdWRlIG1hcmdpbi1ob3Jpem9udGFsKCRzYWZlLWFyZWEtc3RhcnQsICRzYWZlLWFyZWEtZW5kKTtcbn1cblxuQG1peGluIHNhZmUtYXJlYS1tYXJnaW4tc3RhcnQoJHN0YXJ0LCAkZW5kKSB7XG4gICAgJHNhZmUtYXJlYS1zdGFydDogY2FsYyh2YXIoLS1pb24tc2FmZS1hcmVhLWxlZnQpICsgI3skc3RhcnR9KTtcblxuICAgIEBpbmNsdWRlIG1hcmdpbi1ob3Jpem9udGFsKCRzYWZlLWFyZWEtc3RhcnQsICRlbmQpO1xufVxuXG5AbWl4aW4gc2FmZS1hcmVhLW1hcmdpbi1lbmQoJHN0YXJ0LCAkZW5kKSB7XG4gICAgJHNhZmUtYXJlYS1lbmQ6IGNhbGModmFyKC0taW9uLXNhZmUtYXJlYS1yaWdodCkgKyAjeyRlbmR9KTtcblxuICAgIEBpbmNsdWRlIG1hcmdpbi1ob3Jpem9udGFsKCRzdGFydCwgJHNhZmUtYXJlYS1lbmQpO1xufVxuXG5AbWl4aW4gc2FmZS1hcmVhLXBhZGRpbmctaG9yaXpvbnRhbCgkc3RhcnQsICRlbmQ6ICRzdGFydCkge1xuICAgICRzYWZlLWFyZWEtZW5kOiBudWxsO1xuICAgICRzYWZlLWFyZWEtc3RhcnQ6IG51bGw7XG5cbiAgICBAaWYgKCRlbmQpIHtcbiAgICAgICAgJHNhZmUtYXJlYS1lbmQ6IGNhbGModmFyKC0taW9uLXNhZmUtYXJlYS1yaWdodCkgKyAjeyRlbmR9KTtcbiAgICB9XG4gICAgQGlmICgkc3RhcnQpIHtcbiAgICAgICAgJHNhZmUtYXJlYS1zdGFydDogY2FsYyh2YXIoLS1pb24tc2FmZS1hcmVhLWxlZnQpICsgI3skc3RhcnR9KTtcbiAgICB9XG5cbiAgICBAaW5jbHVkZSBwYWRkaW5nLWhvcml6b250YWwoJHNhZmUtYXJlYS1zdGFydCwgJHNhZmUtYXJlYS1lbmQpO1xufVxuXG5AbWl4aW4gc2FmZS1hcmVhLXBhZGRpbmctc3RhcnQoJHN0YXJ0LCAkZW5kKSB7XG4gICAgJHNhZmUtYXJlYS1zdGFydDogY2FsYyh2YXIoLS1pb24tc2FmZS1hcmVhLWxlZnQpICsgI3skc3RhcnR9KTtcblxuICAgIEBpbmNsdWRlIHBhZGRpbmctaG9yaXpvbnRhbCgkc2FmZS1hcmVhLXN0YXJ0LCAkZW5kKTtcbn1cblxuQG1peGluIHNhZmUtYXJlYS1wYWRkaW5nLWVuZCgkc3RhcnQsICRlbmQpIHtcbiAgICAkc2FmZS1hcmVhLWVuZDogY2FsYyh2YXIoLS1pb24tc2FmZS1hcmVhLXJpZ2h0KSArICN7JGVuZH0pO1xuXG4gICAgQGluY2x1ZGUgcGFkZGluZy1ob3Jpem9udGFsKCRzdGFydCwgJHNhZmUtYXJlYS1lbmQpO1xufVxuXG5AbWl4aW4gc2FmZS1hcmVhLXBvc2l0aW9uKCR0b3A6IG51bGwsICRlbmQ6IG51bGwsICRib3R0b206IG51bGwsICRzdGFydDogbnVsbCkge1xuICAgICRzYWZlLWFyZWEtc3RhcnQ6IGNhbGModmFyKC0taW9uLXNhZmUtYXJlYS1sZWZ0KSArICN7JHN0YXJ0fSk7XG4gICAgJHNhZmUtYXJlYS1lbmQ6IGNhbGModmFyKC0taW9uLXNhZmUtYXJlYS1yaWdodCkgKyAjeyRlbmR9KTtcblxuICAgIEBpbmNsdWRlIHBvc2l0aW9uKCR0b3AsICRzYWZlLWFyZWEtZW5kLCAkYm90dG9tLCAkc2FmZS1hcmVhLXN0YXJ0KTtcbn1cblxuQG1peGluIGNvcmUtaGVhZGluZ3MoKSB7XG4gICAgaDEge1xuICAgICAgICBmb250LXNpemU6IDI2cHg7XG4gICAgfVxuICAgIGgyLCAuaXRlbS1oZWFkaW5nIHtcbiAgICAgICAgZm9udC1zaXplOiAyNHB4O1xuICAgIH1cbiAgICBoMyB7XG4gICAgICAgIGZvbnQtc2l6ZTogMjJweDtcbiAgICB9XG4gICAgaDQge1xuICAgICAgICBmb250LXNpemU6IDIwcHg7XG4gICAgfVxuICAgIGg1IHtcbiAgICAgICAgZm9udC1zaXplOiAxOHB4O1xuICAgIH1cbiAgICBoNiB7XG4gICAgICAgIGZvbnQtc2l6ZTogMTZweDtcbiAgICB9XG59XG5cbkBtaXhpbiBkYXJrbW9kZSgpIHtcbiAgICAkcm9vdDogI3smfTtcblxuICAgIEBhdC1yb290ICN7YWRkLXJvb3Qtc2VsZWN0b3IoJHJvb3QsIFwiaHRtbC5kYXJrXCIpfSB7XG4gICAgICAgIEBjb250ZW50O1xuICAgIH1cbn1cblxuQG1peGluIGhvcml6b250YWxfc2Nyb2xsX2l0ZW0oJHdpZHRoLCAkbWluLXdpZHRoLCAkbWF4LXdpZHRoKSB7XG4gICAgZmxleDogMCAwICR3aWR0aDtcbiAgICBtaW4td2lkdGg6ICRtaW4td2lkdGg7XG4gICAgbWF4LXdpZHRoOiAkbWF4LXdpZHRoO1xuICAgIGFsaWduLXNlbGY6IHN0cmV0Y2g7XG4gICAgZGlzcGxheTogYmxvY2s7XG5cbiAgICBpb24tY2FyZCB7XG4gICAgICAgIC0tdmVydGljYWwtbWFyZ2luOiAxMHB4O1xuICAgICAgICAtLWhvcml6b250YWwtbWFyZ2luOiAxMHB4O1xuXG4gICAgICAgIHdpZHRoOiBjYWxjKDEwMCUgLSB2YXIoLS1ob3Jpem9udGFsLW1hcmdpbikgLSB2YXIoLS1ob3Jpem9udGFsLW1hcmdpbikpO1xuICAgICAgICBoZWlnaHQ6IGNhbGMoMTAwJSAtIHZhcigtLXZlcnRpY2FsLW1hcmdpbikgLSB2YXIoLS12ZXJ0aWNhbC1tYXJnaW4pKTtcbiAgICAgICAgbWFyZ2luOiB2YXIoLS12ZXJ0aWNhbC1tYXJnaW4pIHZhcigtLWhvcml6b250YWwtbWFyZ2luKTtcblxuICAgICAgICBAbWVkaWEgKG1heC13aWR0aDogMzYwcHgpIHtcbiAgICAgICAgICAgIC0taG9yaXpvbnRhbC1tYXJnaW46IDZweDtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuLy8gQ29sb3IgbWl4aW5zLlxuQGZ1bmN0aW9uIGdldF9icmlnaHRuZXNzKCRjb2xvcikge1xuICAgIEByZXR1cm4gbWF0aC5kaXYocmVkKCRjb2xvcikgKyBncmVlbigkY29sb3IpICsgYmx1ZSgkY29sb3IpLCAzKTtcbn1cblxuLy8gR2V0IHRoZSBiZXR0ZXIgY29sb3IgY29udHJhc3QgdXNpbmcgV0NBRyBhbGdvcnl0aG0uXG5AZnVuY3Rpb24gZ2V0X2NvbnRyYXN0X2NvbG9yKCRjb2xvcikge1xuICAgICRsdW1pYW5jZTogbHVtaW5hbmNlKCRjb2xvcik7XG5cbiAgICAvLyBXaGl0ZSBsdW1pYW5jZSBpcyAxLlxuICAgICR3aGl0ZUNvbnRyYXN0OiBtYXRoLmRpdigkbHVtaWFuY2UgKyAwLjA1LCAxICsgMC4wNSk7XG4gICAgLy8gV2hpdGUgbHVtaWFuY2UgaXMgMC5cbiAgICAkYmxhY2tDb250cmFzdDogbWF0aC5kaXYoMC4wNSwgJGx1bWlhbmNlICsgMC4wNSk7XG5cbiAgICBAcmV0dXJuIGlmKCR3aGl0ZUNvbnRyYXN0IDwgJGJsYWNrQ29udHJhc3QsIHdoaXRlLCBibGFjayk7XG59XG5cbi8vIENvbG9yIGNvbnRyYXN0IHVzaW5nIHlpcSBhcHJveGltYXRpb24gd2l0aCAxNTAgdGhyZXNob2xkLlxuQGZ1bmN0aW9uIGdldF9jb250cmFzdF9jb2xvcl95aXEoJGNvbG9yLCAkZGFyazogYmxhY2ssICRsaWdodDogd2hpdGUpIHtcbiAgICAkcjogcmVkKCRjb2xvcik7XG4gICAgJGc6IGdyZWVuKCRjb2xvcik7XG4gICAgJGI6IGJsdWUoJGNvbG9yKTtcblxuICAgICR5aXE6IG1hdGguZGl2KCgkciAqIDI5OSkgKyAoJGcgKiA1ODcpICsgKCRiICogMTE0KSwgMTAwMCk7XG5cbiAgICBAcmV0dXJuIGlmKCR5aXEgPj0gMTI4LCAkZGFyaywgJGxpZ2h0KTtcbn1cblxuLy8gV0NBRyBjb250cmFzdCBhbGdvcml0aG1cbkBmdW5jdGlvbiBjaGVjay1jb250cmFzdCgkZm9yZWdyb3VuZCwgJGJhY2tncm91bmQpIHtcbiAgICAkZm9yZWdyb3VuZEx1bWlhbmNlOiBsdW1pbmFuY2UoJGZvcmVncm91bmQpO1xuICAgICRiYWNrZ3JvdW5kTHVtaW5hbmNlOiBsdW1pbmFuY2UoJGJhY2tncm91bmQpO1xuXG4gICAgQGlmICgkYmFja2dyb3VuZEx1bWluYW5jZSA8ICRmb3JlZ3JvdW5kTHVtaWFuY2UpIHtcbiAgICAgICAgQHJldHVybiBtYXRoLmRpdigkYmFja2dyb3VuZEx1bWluYW5jZSArIDAuMDUsICRmb3JlZ3JvdW5kTHVtaWFuY2UgKyAwLjA1KTtcbiAgICB9IEBlbHNlIHtcbiAgICAgICAgQHJldHVybiBtYXRoLmRpdigkZm9yZWdyb3VuZEx1bWlhbmNlICsgMC4wNSwgJGJhY2tncm91bmRMdW1pbmFuY2UgKyAwLjA1KTtcbiAgICB9XG59XG5cbkBmdW5jdGlvbiBsdW1pbmFuY2UoJGNvbG9yKSB7XG4gICAgJHI6IHJlZCgkY29sb3IpO1xuICAgICRnOiBncmVlbigkY29sb3IpO1xuICAgICRiOiBibHVlKCRjb2xvcik7XG5cbiAgICAkcjogY29tcG9uZW50LWx1bWluYW5jZSgkcik7XG4gICAgJGc6IGNvbXBvbmVudC1sdW1pbmFuY2UoJGcpO1xuICAgICRiOiBjb21wb25lbnQtbHVtaW5hbmNlKCRiKTtcblxuICAgIEByZXR1cm4gJHIgKiAwLjIxMjYgKyAkZyAqIDAuNzE1MiArICRiICogMC4wNzIyO1xufVxuXG5AZnVuY3Rpb24gY29tcG9uZW50LWx1bWluYW5jZSgkdmFsdWUpIHtcbiAgICAkdmFsdWU6IG1hdGguZGl2KCR2YWx1ZSwgMjU1KTtcblxuICAgIEBpZiAoJHZhbHVlIDw9IDAuMDM5MjgpIHtcbiAgICAgICAgQHJldHVybiBtYXRoLmRpdigkdmFsdWUsIDEyLjkyKTtcbiAgICB9IEBlbHNlIHtcbiAgICAgICAgQHJldHVybiBtYXRoLnBvdyhtYXRoLmRpdigkdmFsdWUgKyAwLjA1NSwgMS4wNTUpLCAyLjQpO1xuICAgIH1cbn1cbiIsIi8qXG4gKiBBcHAgQ3VzdG9tIEFwcCB2YXJpYWJsZXMgU0NTU1xuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogUGxhY2UgaGVyZSBhbGwgY3VzdG9tIGFwcCB2YXJpYWJsZXMuXG4gKi9cbiIsIi8qXG4gKiBBcHAgR2xvYmFsIHZhcmlhYmxlcyBTQ1NTXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiBQbGFjZSBoZXJlIGFsbCBnbG9iYWwgdmFyaWFibGVzLlxuICovXG5cbiR3aGl0ZTogICAgICAgI2ZmZmZmZiAhZGVmYXVsdDtcbiRncmF5LTEwMDogICAgI2Y4ZjlmYSAhZGVmYXVsdDtcbiRncmF5LTIwMDogICAgI2U5ZWNlZiAhZGVmYXVsdDtcbiRncmF5LTMwMDogICAgI2RlZTJlNiAhZGVmYXVsdDsgLy8gU3Ryb2tlXG4kZ3JheS00MDA6ICAgICNjZWQ0ZGEgIWRlZmF1bHQ7XG4kZ3JheS01MDA6ICAgICM4Zjk1OWUgIWRlZmF1bHQ7IC8vIFN0cm9rZSBvbiBpbnB1dHNcbiRncmF5LTYwMDogICAgIzZhNzM3YiAhZGVmYXVsdDtcbiRncmF5LTcwMDogICAgIzQ5NTA1NyAhZGVmYXVsdDtcbiRncmF5LTgwMDogICAgIzM0M2E0MCAhZGVmYXVsdDtcbiRncmF5LTkwMDogICAgIzI4MjgyOCAhZGVmYXVsdDsgLy8gQ29weSB0ZXh0XG4kYmxhY2s6ICAgICAgICMwMDAwMDAgIWRlZmF1bHQ7IC8vIEF2b2lkIHVzYWdlXG5cbiRibHVlOiAgICAgICAgIzBmNmNiZiAhZGVmYXVsdDtcbiRjeWFuOiAgICAgICAgIzAwODE5NiAhZGVmYXVsdDsgLy8gTm90IHVzZWQuXG4kZ3JlZW46ICAgICAgICMzNTdhMzIgIWRlZmF1bHQ7XG4kcmVkOiAgICAgICAgICNjYTMxMjAgIWRlZmF1bHQ7XG4keWVsbG93OiAgICAgICNmMGFkNGUgIWRlZmF1bHQ7XG5cbiRicmFuZC1jb2xvcjogI2Y5ODAxMiAhZGVmYXVsdDtcblxuJHRleHQtY29sb3I6ICAgICAgICAgICAgICAgJGdyYXktOTAwICFkZWZhdWx0O1xuJHRleHQtY29sb3ItcmdiOiAgICAgICAgICAgY29sb3ItdG8tcmdiLWxpc3QoJHRleHQtY29sb3IpICFkZWZhdWx0O1xuJHRleHQtY29sb3ItZGFyazogICAgICAgICAgJHdoaXRlICFkZWZhdWx0O1xuJHRleHQtY29sb3ItZGFyay1yZ2I6ICAgICAgY29sb3ItdG8tcmdiLWxpc3QoJHRleHQtY29sb3ItZGFyaykgIWRlZmF1bHQ7XG5cbiRiYWNrZ3JvdW5kLWNvbG9yOiAgICAgICAgICAkd2hpdGUgIWRlZmF1bHQ7XG4kYmFja2dyb3VuZC1jb2xvci1yZ2I6ICAgICAgY29sb3ItdG8tcmdiLWxpc3QoJGJhY2tncm91bmQtY29sb3IpICFkZWZhdWx0O1xuJGJhY2tncm91bmQtY29sb3ItZGFyazogICAgICRncmF5LTkwMCAhZGVmYXVsdDsgLy8gIzFhMWExYVxuJGJhY2tncm91bmQtY29sb3ItZGFyay1yZ2I6IGNvbG9yLXRvLXJnYi1saXN0KCRiYWNrZ3JvdW5kLWNvbG9yLWRhcmspICFkZWZhdWx0O1xuXG4kaW9uLWl0ZW0tYmFja2dyb3VuZDogICAgICAkd2hpdGUgIWRlZmF1bHQ7XG4kaW9uLWl0ZW0tYmFja2dyb3VuZC1yZ2I6ICBjb2xvci10by1yZ2ItbGlzdCgkaW9uLWl0ZW0tYmFja2dyb3VuZCkgIWRlZmF1bHQ7XG4kaW9uLWl0ZW0tYmFja2dyb3VuZC1kYXJrOiAkZ3JheS05MDAgIWRlZmF1bHQ7XG4kaW9uLWl0ZW0tYmFja2dyb3VuZC1kYXJrLXJnYjogY29sb3ItdG8tcmdiLWxpc3QoJGlvbi1pdGVtLWJhY2tncm91bmQtZGFyaykgIWRlZmF1bHQ7XG5cbiRwcmltYXJ5OiAgICAkYnJhbmQtY29sb3IgIWRlZmF1bHQ7XG4kc2Vjb25kYXJ5OiAgJGdyYXktMzAwICFkZWZhdWx0O1xuJGRhbmdlcjogICAgICRyZWQgIWRlZmF1bHQ7XG4kd2FybmluZzogICAgJHllbGxvdyAhZGVmYXVsdDtcbiRzdWNjZXNzOiAgICAkZ3JlZW4gIWRlZmF1bHQ7XG4kaW5mbzogICAgICAgJGJsdWUgIWRlZmF1bHQ7XG4kbGlnaHQ6ICAgICAgJGdyYXktMTAwICFkZWZhdWx0O1xuJG1lZGl1bTogICAgICRncmF5LTcwMCAhZGVmYXVsdDtcbiRkYXJrOiAgICAgICAkZ3JheS05MDAgIWRlZmF1bHQ7XG5cbiRjb2xvcnM6ICAoXG4gICAgcHJpbWFyeTogKGxpZ2h0OiAkcHJpbWFyeSwgZGFyazogJHByaW1hcnkpLFxuICAgIHNlY29uZGFyeTogKGxpZ2h0OiAkc2Vjb25kYXJ5LCBkYXJrOiAkZ3JheS03MDApLFxuICAgIHN1Y2Nlc3M6IChsaWdodDogJHN1Y2Nlc3MpLFxuICAgIHdhcm5pbmc6IChsaWdodDogJHdhcm5pbmcpLFxuICAgIGRhbmdlcjogIChsaWdodDogJGRhbmdlciksXG4gICAgaW5mbzogKGxpZ2h0OiAkaW5mbyksXG4gICAgbGlnaHQ6IChsaWdodDogJGxpZ2h0LCBkYXJrOiAkZGFyayksXG4gICAgbWVkaXVtOiAobGlnaHQ6ICRtZWRpdW0sIGRhcms6ICRncmF5LTIwMCksXG4gICAgZGFyazogKGxpZ2h0OiAkZGFyaywgZGFyazogJGxpZ2h0KSxcbikgIWRlZmF1bHQ7XG5cbi8qKlxuICogTGF5b3V0IEJyZWFrcG9pbnRzXG4gKlxuICogaHR0cHM6Ly9pb25pY2ZyYW1ld29yay5jb20vZG9jcy9sYXlvdXQvZ3JpZCNkZWZhdWx0LWJyZWFrcG9pbnRzXG4gKi9cblxuLy8gVGhlIG1pbmltdW0gZGltZW5zaW9ucyBhdCB3aGljaCB5b3VyIGxheW91dCB3aWxsIGNoYW5nZSxcbi8vIGFkYXB0aW5nIHRvIGRpZmZlcmVudCBzY3JlZW4gc2l6ZXMsIGZvciB1c2UgaW4gbWVkaWEgcXVlcmllc1xuJHNjcmVlbi1icmVha3BvaW50czogKFxuICAgIHhzOiAwcHgsXG4gICAgc206IDU3NnB4LFxuICAgIG1kOiA3NjhweCxcbiAgICBsZzogOTkycHgsXG4gICAgdGFibGV0OiA5OTJweCxcbiAgICB4bDogMTIwMHB4XG4pICFkZWZhdWx0O1xuXG4kY29yZS1jb3Vyc2UtaW1hZ2UtYmFja2dyb3VuZDogIzgxZWNlYywgIzc0YjlmZiwgI2EyOWJmZSwgI2RmZTZlOSwgIzAwYjg5NCwgIzA5ODRlMywgI2IyYmVjMywgI2ZkY2I2ZSwgI2ZkNzlhOCwgIzZjNWNlNyAhZGVmYXVsdDtcbiRjb3JlLWRkLXF1ZXN0aW9uLWNvbG9yczogI0ZGRkZGRiwgI0IwQzRERSwgI0RDRENEQywgI0Q4QkZEOCwgIzg3Q0VGQSwgI0RBQTUyMCwgI0ZGRDcwMCwgI0YwRTY4QyAhZGVmYXVsdDtcbiRjb3JlLXRleHQtaGlnaHRsaWdodC1iYWNrZ3JvdW5kLWNvbG9yOiBsaWdodGVuKCRibHVlLCA0MCUpICFkZWZhdWx0O1xuXG4kY29yZS1maXhlZC11cmw6IGZhbHNlICFkZWZhdWx0O1xuJGNvcmUtZGFzaGJvYXJkLWxvZ286IGZhbHNlICFkZWZhdWx0O1xuJGNvcmUtYWx3YXlzLXNob3ctbWFpbi1tZW51OiBmYWxzZSAhZGVmYXVsdDtcbiRjb3JlLWZvcm1hdC10ZXh0LW5ldmVyLXNob3J0ZW46IGZhbHNlICFkZWZhdWx0O1xuXG4kY29yZS1oaWRlLWNvdXJzZWltYWdlLW9uLWNvdXJzZTogZmFsc2UgIWRlZmF1bHQ7XG4kY29yZS1oaWRlLXByb2dyZXNzLW9uLWNvdXJzZTogZmFsc2UgIWRlZmF1bHQ7XG4kY29yZS1oaWRlLXByb2dyZXNzLW9uLXNlY3Rpb24tc2VsZWN0b3I6IGZhbHNlICFkZWZhdWx0O1xuXG4kY29yZS1jb3Vyc2UtaGlkZS10aHVtYi1vbi1jYXJkczogZmFsc2UgIWRlZmF1bHQ7XG4kY29yZS1jb3Vyc2UtdGh1bWItb24tY2FyZHMtYmFja2dyb3VuZDogbnVsbCAhZGVmYXVsdDtcbiRjb3JlLWNvdXJzZS1oaWRlLXByb2dyZXNzLW9uLWNhcmRzOiBmYWxzZSAhZGVmYXVsdDtcblxuLy8gQ29uZmlndXJhdGlvbiBvcHRpb25zIGZvciBsb2dpbiBwYWdlLlxuJGNvcmUtbG9naW4tYnV0dG9uLW91dGxpbmU6IGZhbHNlICFkZWZhdWx0O1xuJGNvcmUtbG9naW4tYnV0dG9uLW91dGxpbmUtZGFyazogJGNvcmUtbG9naW4tYnV0dG9uLW91dGxpbmUgIWRlZmF1bHQ7XG4kY29yZS1sb2dpbi1sb2FkaW5nLWNvbG9yOiBmYWxzZSAhZGVmYXVsdDtcbiRjb3JlLWxvZ2luLWxvYWRpbmctY29sb3ItZGFyazogJHRleHQtY29sb3ItZGFyayAhZGVmYXVsdDtcbiRjb3JlLWxvZ2luLWhpZGUtZm9yZ290LXBhc3N3b3JkOiBmYWxzZSAhZGVmYXVsdDtcbiRjb3JlLWxvZ2luLWhpZGUtbmVlZC1oZWxwOiBmYWxzZSAhZGVmYXVsdDtcbiRjb3JlLWxvZ2luLWhpZGUtcXJjb2RlOiBmYWxzZSAhZGVmYXVsdDtcblxuLy8gQ29uZmlndXJhdGlvbiBvcHRpb25zIGZvciBtb3JlIHBhZ2UuIChkZXByZWNhdGVkIG9uIDQuMClcbiRjb3JlLW1vcmUtaGlkZS1zaXRlaW5mbzogZmFsc2UgIWRlZmF1bHQ7XG4kY29yZS1tb3JlLWhpZGUtc2l0ZW5hbWU6IGZhbHNlICFkZWZhdWx0O1xuJGNvcmUtbW9yZS1oaWRlLXNpdGV1cmw6IGZhbHNlICFkZWZhdWx0O1xuXG4vLyBDb25maWd1cmF0aW9uIG9wdGlvbnMgZm9yIHVzZXIgcGFnZS5cbiRjb3JlLXVzZXItaGlkZS1zaXRlaW5mbzogJGNvcmUtbW9yZS1oaWRlLXNpdGVpbmZvICFkZWZhdWx0O1xuJGNvcmUtdXNlci1oaWRlLXNpdGVuYW1lOiAkY29yZS1tb3JlLWhpZGUtc2l0ZW5hbWUgIWRlZmF1bHQ7XG4kY29yZS11c2VyLWhpZGUtc2l0ZXVybDogJGNvcmUtbW9yZS1oaWRlLXNpdGV1cmwgIWRlZmF1bHQ7XG5cbi8vIEFjdGl2aXR5IGljb24gYmFja2dyb3VuZCBjb2xvcnMuXG4kYWN0aXZpdHktaWNvbi1jb2xvcnM6IChcbiAgICBhZG1pbmlzdHJhdGlvbjogIzVkNjNmNixcbiAgICBhc3Nlc3NtZW50OiAjZWI2NmEyLFxuICAgIGNvbGxhYm9yYXRpb246ICNmNzYzNGQsXG4gICAgY29tbXVuaWNhdGlvbjogIzExYTY3NixcbiAgICBjb250ZW50OiAjMzk5YmUyLFxuICAgIGludGVyZmFjZTogI2EzNzhmZlxuKSAhZGVmYXVsdDtcblxuJGNhbGVuZGFyLWV2ZW50LWNhdGVnb3J5LWNhdGVnb3J5OiAjOGUyNGFhICFkZWZhdWx0O1xuJGNhbGVuZGFyLWV2ZW50LWNhdGVnb3J5LWNvdXJzZTogJHJlZCAhZGVmYXVsdDtcbiRjYWxlbmRhci1ldmVudC1jYXRlZ29yeS1ncm91cDogJHllbGxvdyAhZGVmYXVsdDtcbiRjYWxlbmRhci1ldmVudC1jYXRlZ29yeS11c2VyOiAkYmx1ZSAhZGVmYXVsdDtcbiRjYWxlbmRhci1ldmVudC1jYXRlZ29yeS1zaXRlOiAkZ3JlZW4gIWRlZmF1bHQ7XG5cbi8vIENhbGVuZGFyIGV2ZW50IGNhdGVnb3J5IGJhY2tncm91bmQgY29sb3JzLlxuJGNhbGVuZGFyLWV2ZW50LWNhdGVnb3J5LWNvbG9yczogKFxuICAgIGNhdGVnb3J5OiAkY2FsZW5kYXItZXZlbnQtY2F0ZWdvcnktY2F0ZWdvcnksXG4gICAgY291cnNlOiAkY2FsZW5kYXItZXZlbnQtY2F0ZWdvcnktY291cnNlLFxuICAgIGdyb3VwOiAkY2FsZW5kYXItZXZlbnQtY2F0ZWdvcnktZ3JvdXAsXG4gICAgdXNlcjogJGNhbGVuZGFyLWV2ZW50LWNhdGVnb3J5LXVzZXIsXG4gICAgc2l0ZTogJGNhbGVuZGFyLWV2ZW50LWNhdGVnb3J5LXNpdGUsXG4pICFkZWZhdWx0O1xuIiwiQHVzZSBcInRoZW1lL2dsb2JhbHNcIiBhcyAqO1xuXG46aG9zdCB7XG5cbiAgICAuYWRkb24tZm9ydW0tc3RhciB7XG4gICAgICAgIGNvbG9yOiB2YXIoLS1jb3JlLXN0YXItY29sb3IpO1xuICAgIH1cblxuICAgIC5jb3JlLWRpc2N1c3Npb251c2VybmFtZSB7XG4gICAgICAgIGZvbnQtc2l6ZTogMS4yZW07XG4gICAgfVxuXG4gICAgLmNvcmUtZ3JvdXBuYW1lIHtcbiAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgZ2FwOiA0cHg7XG4gICAgfVxuXG4gICAgLmFkZG9uLW1vZC1mb3J1bS1kaXNjdXNzaW9uLml0ZW0ge1xuICAgICAgICBpb24tbGFiZWwge1xuICAgICAgICAgICAgbWFyZ2luLXRvcDogNHB4O1xuXG4gICAgICAgICAgICAuaXRlbS1oZWFkaW5nIHtcbiAgICAgICAgICAgICAgICBtYXJnaW4tdG9wOiA4cHg7XG4gICAgICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogOHB4O1xuICAgICAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkO1xuXG4gICAgICAgICAgICAgICAgaW9uLWljb24ge1xuICAgICAgICAgICAgICAgICAgICBAaW5jbHVkZSBtYXJnaW4oMCwgNnB4LCAwLCAwKTtcblxuICAgICAgICAgICAgICAgICAgICAmLmFkZG9uLW1vZC1mb3J1bS1sb2NrZWQtaWNvbiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBAaW5jbHVkZSBtYXJnaW4taG9yaXpvbnRhbCg0cHgsIDBweCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogdmFyKC0tZ3JheS01MDApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfVxuXG4gICAgICAgIGNvcmUtdXNlci1hdmF0YXIge1xuICAgICAgICAgICAgLS1jb3JlLWF2YXRhci1zaXplOiB2YXIoLS1hZGRvbi1mb3J1bS1hdmF0YXItc2l6ZSk7XG5cbiAgICAgICAgICAgIEBpbmNsdWRlIG1hcmdpbigwLCA4cHgsIDAsIDApO1xuICAgICAgICB9XG5cbiAgICAgICAgLmFkZG9uLW1vZC1mb3J1bS1kaXNjdXNzaW9uLWluZm8ge1xuICAgICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgICAgIH1cblxuICAgICAgICAuYWRkb24tbW9kLWZvcnVtLWRpc2N1c3Npb24taW5mbyAuYWRkb24tbW9kLWZvcnVtLWRpc2N1c3Npb24tYXV0aG9yIHtcbiAgICAgICAgICAgIGZsZXgtZ3JvdzogMTtcbiAgICAgICAgfVxuXG4gICAgICAgIC5hZGRvbi1tb2QtZm9ydW0tZGlzY3Vzc2lvbi10aXRsZSB7XG4gICAgICAgICAgICBAaW5jbHVkZSBtYXJnaW4taG9yaXpvbnRhbChudWxsLCA4cHgpO1xuICAgICAgICAgICAgbGluZS1oZWlnaHQ6IDE4cHg7XG4gICAgICAgIH1cblxuXG4gICAgICAgIC5hZGRvbi1tb2QtZm9ydW0tZGlzY3Vzc2lvbi1tb3JlLWluZm8uaW9zIHtcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogMC45cmVtO1xuICAgICAgICB9XG5cbiAgICAgICAgaW9uLWJ1dHRvbiB7XG4gICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICAgICAgICBAaW5jbHVkZSBwb3NpdGlvbiAoNHB4LCA4cHgsIG51bGwsIG51bGwpO1xuICAgICAgICB9XG5cbiAgICB9XG5cbiAgICAuY29yZS1ncm91cC1zZWxlY3RvciB7XG4gICAgICAgIGJvcmRlci10b3A6IDFweCBzb2xpZCB2YXIoLS1zcGFjZXItY29sb3IpO1xuICAgIH1cblxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ== */\"]\n});\nclass AddonModForumDiscussionsManager extends CoreListItemsManager {\n  constructor(source, page) {\n    super(source, page.route.component);\n    this.page = page;\n  }\n  /**\n   * @inheritdoc\n   */\n  getDefaultItem() {\n    const source = this.getSource();\n    return this.items.find(discussion => !source.isNewDiscussionForm(discussion)) || null;\n  }\n  /**\n   * @inheritdoc\n   */\n  logActivity() {\n    var _this14 = this;\n    return _asyncToGenerator(function* () {\n      const forum = _this14.getSource().forum;\n      if (!forum) {\n        return;\n      }\n      try {\n        yield AddonModForum.logView(forum.id);\n        CoreCourse.checkModuleCompletion(_this14.page.courseId, _this14.page.module.completiondata);\n      } catch (_unused) {\n        // Ignore errors.\n      }\n      _this14.page.analyticsLogEvent('mod_forum_view_forum');\n    })();\n  }\n  /**\n   * Check whether there is any discussion in the items.\n   *\n   * @returns Whether there is a discussion.\n   */\n  get hasDiscussions() {\n    const source = this.getSource();\n    const items = source.getItems();\n    return items !== null && items.some(item => !source.isNewDiscussionForm(item));\n  }\n}","map":{"version":3,"names":["CoreCourseModuleMainActivityComponent","AddonModForum","AddonModForumProvider","AddonModForumOffline","Translate","AddonModForumHelper","CoreEvents","AddonModForumSyncProvider","CoreSites","CoreUser","CoreDomUtils","CoreCourse","CoreSplitViewComponent","AddonModForumDiscussionOptionsMenuComponent","AddonModForumSortOrderSelectorComponent","CoreScreen","AddonModForumPrefetchHandler","AddonModForumModuleHandlerService","CoreRatingProvider","CoreRatingSyncProvider","CoreRatingOffline","AddonModForumDiscussionsSource","CoreListItemsManager","CoreRoutedItemsManagerSourcesTracker","CorePromisedValue","CoreNavigator","FORUM_SEARCH_PAGE_NAME","i0","ɵɵelementStart","ɵɵlistener","AddonModForumIndexComponent_core_group_selector_17_Template_core_group_selector_selectedChange_0_listener","$event","ɵɵrestoreView","_r7","ctx_r6","ɵɵnextContext","ɵɵresetView","groupId","ctx_r8","groupChanged","ɵɵelementEnd","ɵɵproperty","ctx_r0","groupInfo","courseId","ɵɵelement","ɵɵtext","ɵɵadvance","ɵɵtextInterpolate","ctx_r1","availabilityMessage","ɵɵpipeBind1","ɵɵtemplate","AddonModForumIndexComponent_ion_card_20_span_4_Template","AddonModForumIndexComponent_ion_card_20_span_5_Template","ctx_r3","AddonModForumIndexComponent_ng_container_21_div_1_Template_core_combobox_onChange_1_listener","_r16","ctx_r15","setSortOrder","ctx_r11","sortOrderSelectorModalOptions","selectedSortOrder","label","ɵɵattribute","discussion_r17","ctx_r21","userfullname","groupname","ctx_r23","ɵɵtextInterpolate1","ɵɵpipeBind2","created","ɵɵelementContainerStart","ɵɵelementContainerEnd","timemodified","numunread","ɵɵpureFunction1","_c0","AddonModForumIndexComponent_ng_container_21_ion_item_4_ion_row_14_ng_container_6_Template","AddonModForumIndexComponent_ng_container_21_ion_item_4_ion_row_14_ng_container_7_Template","AddonModForumIndexComponent_ng_container_21_ion_item_4_ion_row_14_ion_badge_13_Template","_c1","numreplies","AddonModForumIndexComponent_ng_container_21_ion_item_4_ion_button_15_Template_ion_button_click_0_listener","_r41","$implicit","ctx_r39","showOptionsMenu","AddonModForumIndexComponent_ng_container_21_ion_item_4_Template_ion_item_click_0_listener","restoredCtx","_r43","ctx_r42","discussions","select","AddonModForumIndexComponent_ng_container_21_ion_item_4_ion_icon_3_Template","AddonModForumIndexComponent_ng_container_21_ion_item_4_ion_icon_4_Template","AddonModForumIndexComponent_ng_container_21_ion_item_4_ion_icon_6_Template","AddonModForumIndexComponent_ng_container_21_ion_item_4_core_user_avatar_8_Template","AddonModForumIndexComponent_ng_container_21_ion_item_4_span_10_Template","AddonModForumIndexComponent_ng_container_21_ion_item_4_p_11_Template","AddonModForumIndexComponent_ng_container_21_ion_item_4_p_12_Template","AddonModForumIndexComponent_ng_container_21_ion_item_4_p_13_Template","AddonModForumIndexComponent_ng_container_21_ion_item_4_ion_row_14_Template","AddonModForumIndexComponent_ng_container_21_ion_item_4_ion_button_15_Template","ctx_r14","getItemAriaCurrent","pinned","starred","subject","module","id","locked","isOnlineDiscussion","isOfflineDiscussion","canPin","canlock","canfavourite","AddonModForumIndexComponent_ng_container_21_div_1_Template","AddonModForumIndexComponent_ng_container_21_core_empty_box_2_Template","AddonModForumIndexComponent_ng_container_21_core_empty_box_3_Template","AddonModForumIndexComponent_ng_container_21_ion_item_4_Template","AddonModForumIndexComponent_ng_container_21_Template_core_infinite_loading_action_5_listener","_r45","ctx_r44","fetchMoreDiscussions","ctx_r4","sortingAvailable","hasDiscussions","errorLoadingDiscussions","discussionsItems","loaded","completed","fetchFailed","AddonModForumIndexComponent_ion_fab_23_Template_ion_fab_button_click_1_listener","_r47","ctx_r46","openNewDiscussion","ctx_r5","addDiscussionText","AddonModForumIndexComponent","constructor","route","content","courseContentsPage","component","COMPONENT","pluginName","canAddDiscussion","sortOrders","hasOfflineRatings","showQAMessage","isSetPinAvailable","fetchContentDefaultError","syncEventName","AUTO_SYNCED","checkCompletionAfterLog","promisedDiscussions","value","forum","_this$discussions","getSource","_this$discussions$get","_this$discussions2","undefined","supportsChangeGroup","_this$discussions$get2","_this$discussions3","_this$discussions$get3","_this$discussions4","_this$discussions5","usesGroups","_this$discussions6","_this$discussions7","allPartsPermissions","canpindiscussions","canAddDiscussionToGroup","_this$discussions8","_this$discussions9","discussion","_this$discussions10","_this$discussions11","ngOnInit","_superprop_getNgOnInit","_this","_asyncToGenerator","instant","isDiscussionListSortingAvailable","getAvailableSortOrders","isSetPinStateAvailableForSite","componentProps","call","source","getOrCreateSource","PAGE_NAME","sourceUnsubscribe","addListener","onItemsUpdated","_ref","filter","isNewDiscussionForm","hasOffline","some","hasForumReplies","promises","map","_ref2","_this$discussions12","replies","getDiscussionReplies","Number","length","_x2","apply","arguments","Promise","all","_x","onReset","resolve","AddonModForumDiscussionsManager","syncManualObserver","on","MANUAL_SYNCED","data","autoSyncEventReceived","siteId","newDiscObserver","NEW_DISCUSSION_EVENT","eventReceived","replyObserver","REPLY_DISCUSSION_EVENT","changeDiscObserver","CHANGE_DISCUSSION_EVENT","forumId","cmId","invalidateDiscussionsList","finally","discussionId","_this$discussions13","items","find","disc","_this$discussions14","showLoadingAndRefresh","deleted","_data$post","post","parentid","isTablet","empty","ratingOfflineObserver","RATING_SAVED_EVENT","ratingArea","contextLevel","instanceId","cmid","ratingSyncObserver","SYNCED_EVENT","_ref3","hasRatings","_x3","ngAfterViewInit","_this2","loadContent","start","splitView","ngOnDestroy","_this$discussions15","off","viewDiscObserver","destroy","openSearch","_this3","navigateToSitePath","params","fetchContent","refresh","sync","showErrors","_this4","fetchForum","fetchSortOrderPreference","reload","load","then","error","_this5","_CoreSites$getCurrent","loadForum","showDueDateMessage","getCurrentSite","isVersionGreaterEqualThan","description","intro","getAvailabilityMessage","descriptionNote","numdiscussions","dataRetrieved","emit","type","updated","syncActivity","trigger","userId","getCurrentSiteUserId","getCurrentSiteId","push","loadGroupInfo","getAccessInformation","_ref4","accessInfo","cutoffDateReached","isCutoffDateReached","cancanoverridecutoff","cancreatediscussions","canviewqandawithoutposting","_x4","complete","_this6","showErrorModalDefault","_this7","selectedOrder","getSelectedSortOrder","selected","invalidateContent","_this8","invalidateCache","invalidateAccessInformation","invalidateUserPreference","PREFERENCE_SORTORDER","isRefreshSyncNeeded","syncEventData","isNewDiscussion","_this9","checkCompletion","showToast","newDiscGroupId","_this9$discussions","invalidateList","newDiscussionData","_this9$discussions2","_this9$discussions3","timecreated","discTimecreated","_newDiscussionData$di","discussionIds","includes","_this$discussions16","NEW_DISCUSSION","sortOrder","_this10","_this10$discussions$g","setDirty","setUserPreference","toFixed","showLoadingAndFetch","showSortOrderSelector","_this11","modalData","openModal","event","_this12","preventDefault","stopPropagation","popoverData","openPopover","action","_this13","modal","showModalLoading","_this13$discussions","_this13$discussions2","loadSelectedGroupData","dismiss","_class","ɵɵdirectiveInject","i1","ActivatedRoute","i2","IonContent","i3","CoreCourseContentsPage","selectors","viewQuery","AddonModForumIndexComponent_Query","rf","ctx","AddonModForumIndexComponent_Template_ion_button_click_1_listener","AddonModForumIndexComponent_Template_ion_button_click_4_listener","openModuleSummary","AddonModForumIndexComponent_Template_ion_refresher_ionRefresh_9_listener","doRefresh","target","AddonModForumIndexComponent_Template_core_course_module_info_completionChanged_13_listener","onCompletionChange","AddonModForumIndexComponent_core_group_selector_17_Template","AddonModForumIndexComponent_ion_card_18_Template","AddonModForumIndexComponent_ion_card_19_Template","AddonModForumIndexComponent_ion_card_20_Template","AddonModForumIndexComponent_ng_container_21_Template","AddonModForumIndexComponent_ion_fab_23_Template","showLoading","ɵɵpropertyInterpolate","componentId","page","getDefaultItem","logActivity","_this14","logView","checkModuleCompletion","completiondata","_unused","analyticsLogEvent","getItems","item"],"sources":["/home/toon/works/gitionic7/ionic-github/ionic/src/addons/mod/forum/components/index/index.ts","/home/toon/works/gitionic7/ionic-github/ionic/src/addons/mod/forum/components/index/index.html"],"sourcesContent":["// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Component, Optional, OnInit, OnDestroy, ViewChild, AfterViewInit } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { IonContent } from '@ionic/angular';\nimport { ModalOptions } from '@ionic/core';\n\nimport { CoreCourseModuleMainActivityComponent } from '@features/course/classes/main-activity-component';\nimport {\n    AddonModForum,\n    AddonModForumData,\n    AddonModForumProvider,\n    AddonModForumSortOrder,\n    AddonModForumDiscussion,\n    AddonModForumNewDiscussionData,\n    AddonModForumReplyDiscussionData,\n} from '@addons/mod/forum/services/forum';\nimport { AddonModForumOffline } from '@addons/mod/forum/services/forum-offline';\nimport { Translate } from '@singletons';\nimport { CoreCourseContentsPage } from '@features/course/pages/contents/contents';\nimport { AddonModForumHelper } from '@addons/mod/forum/services/forum-helper';\nimport { CoreGroupInfo } from '@services/groups';\nimport { CoreEvents, CoreEventObserver } from '@singletons/events';\nimport {\n    AddonModForumAutoSyncData,\n    AddonModForumManualSyncData,\n    AddonModForumSyncProvider,\n    AddonModForumSyncResult,\n} from '@addons/mod/forum/services/forum-sync';\nimport { CoreSites } from '@services/sites';\nimport { CoreUser } from '@features/user/services/user';\nimport { CoreDomUtils } from '@services/utils/dom';\nimport { CoreCourse } from '@features/course/services/course';\nimport { CoreSplitViewComponent } from '@components/split-view/split-view';\nimport { AddonModForumDiscussionOptionsMenuComponent } from '../discussion-options-menu/discussion-options-menu';\nimport { AddonModForumSortOrderSelectorComponent } from '../sort-order-selector/sort-order-selector';\nimport { CoreScreen } from '@services/screen';\nimport { AddonModForumPrefetchHandler } from '../../services/handlers/prefetch';\nimport { AddonModForumModuleHandlerService } from '../../services/handlers/module';\nimport { CoreRatingProvider } from '@features/rating/services/rating';\nimport { CoreRatingSyncProvider } from '@features/rating/services/rating-sync';\nimport { CoreRatingOffline } from '@features/rating/services/rating-offline';\nimport { ContextLevel } from '@/core/constants';\nimport { AddonModForumDiscussionItem, AddonModForumDiscussionsSource } from '../../classes/forum-discussions-source';\nimport { CoreListItemsManager } from '@classes/items-management/list-items-manager';\nimport { CoreRoutedItemsManagerSourcesTracker } from '@classes/items-management/routed-items-manager-sources-tracker';\nimport { CorePromisedValue } from '@classes/promised-value';\nimport { CoreNavigator } from '@services/navigator';\nimport { FORUM_SEARCH_PAGE_NAME } from '@addons/mod/forum/forum.module';\n\n/**\n * Component that displays a forum entry page.\n */\n@Component({\n    selector: 'addon-mod-forum-index',\n    templateUrl: 'index.html',\n    styleUrls: ['index.scss'],\n})\nexport class AddonModForumIndexComponent extends CoreCourseModuleMainActivityComponent implements OnInit, AfterViewInit, OnDestroy {\n\n    @ViewChild(CoreSplitViewComponent) splitView!: CoreSplitViewComponent;\n\n    component = AddonModForumProvider.COMPONENT;\n    pluginName = 'forum';\n    descriptionNote?: string;\n    promisedDiscussions: CorePromisedValue<AddonModForumDiscussionsManager>;\n    discussionsItems: AddonModForumDiscussionItem[] = [];\n    fetchFailed = false;\n    canAddDiscussion = false;\n    addDiscussionText!: string;\n    availabilityMessage: string | null = null;\n    sortingAvailable!: boolean;\n    sortOrders: AddonModForumSortOrder[] = [];\n    hasOfflineRatings = false;\n    showQAMessage = false;\n    isSetPinAvailable = false;\n    sortOrderSelectorModalOptions: ModalOptions = {\n        component: AddonModForumSortOrderSelectorComponent,\n    };\n\n    protected fetchContentDefaultError = 'addon.mod_forum.errorgetforum';\n    protected syncEventName = AddonModForumSyncProvider.AUTO_SYNCED;\n    protected syncManualObserver?: CoreEventObserver; // It will observe the sync manual event.\n    protected replyObserver?: CoreEventObserver;\n    protected newDiscObserver?: CoreEventObserver;\n    protected viewDiscObserver?: CoreEventObserver;\n    protected changeDiscObserver?: CoreEventObserver;\n    protected ratingOfflineObserver?: CoreEventObserver;\n    protected ratingSyncObserver?: CoreEventObserver;\n    protected sourceUnsubscribe?: () => void;\n    protected checkCompletionAfterLog = false; // Use CoreListItemsManager log system instead.\n\n    constructor(\n        public route: ActivatedRoute,\n        @Optional() protected content?: IonContent,\n        @Optional() courseContentsPage?: CoreCourseContentsPage,\n    ) {\n        super('AddonModForumIndexComponent', content, courseContentsPage);\n\n        this.promisedDiscussions = new CorePromisedValue();\n    }\n\n    get discussions(): AddonModForumDiscussionsManager | null {\n        return this.promisedDiscussions.value;\n    }\n\n    get forum(): AddonModForumData | undefined {\n        return this.discussions?.getSource().forum;\n    }\n\n    get selectedSortOrder(): AddonModForumSortOrder | undefined {\n        return this.discussions?.getSource().selectedSortOrder ?? undefined;\n    }\n\n    get supportsChangeGroup(): boolean {\n        return this.discussions?.getSource().supportsChangeGroup ?? false;\n    }\n\n    get groupId(): number {\n        return this.discussions?.getSource().groupId ?? 0;\n    }\n\n    set groupId(value: number) {\n        if (this.discussions) {\n            this.discussions.getSource().groupId = value;\n        }\n    }\n\n    get groupInfo(): CoreGroupInfo | undefined {\n        return this.discussions?.getSource().groupInfo;\n    }\n\n    get usesGroups(): boolean {\n        return !!(this.discussions?.getSource().usesGroups);\n    }\n\n    get canPin(): boolean {\n        return !!(this.isSetPinAvailable && this.discussions?.getSource().allPartsPermissions?.canpindiscussions);\n    }\n\n    get canAddDiscussionToGroup(): boolean {\n        return !!(this.forum && this.canAddDiscussion && this.discussions?.getSource().canAddDiscussionToGroup);\n    }\n\n    get errorLoadingDiscussions(): boolean {\n        return !!this.discussions?.getSource().errorLoadingDiscussions;\n    }\n\n    /**\n     * Check whether a discussion is online.\n     *\n     * @param discussion Discussion\n     * @returns Whether the discussion is online.\n     */\n    isOnlineDiscussion(discussion: AddonModForumDiscussionItem): boolean {\n        return !!this.discussions?.getSource().isOnlineDiscussion(discussion);\n    }\n\n    /**\n     * Check whether a discussion is offline.\n     *\n     * @param discussion Discussion\n     * @returns Whether the discussion is offline.\n     */\n    isOfflineDiscussion(discussion: AddonModForumDiscussionItem): boolean {\n        return !!this.discussions?.getSource().isOfflineDiscussion(discussion);\n    }\n\n    /**\n     * @inheritdoc\n     */\n    async ngOnInit(): Promise<void> {\n        this.addDiscussionText = Translate.instant('addon.mod_forum.addanewdiscussion');\n        this.sortingAvailable = AddonModForum.isDiscussionListSortingAvailable();\n        this.sortOrders = AddonModForum.getAvailableSortOrders();\n        this.isSetPinAvailable = AddonModForum.isSetPinStateAvailableForSite();\n\n        this.sortOrderSelectorModalOptions.componentProps = {\n            sortOrders: this.sortOrders,\n        };\n\n        await super.ngOnInit();\n\n        // Initialize discussions manager.\n        const source = CoreRoutedItemsManagerSourcesTracker.getOrCreateSource(\n            AddonModForumDiscussionsSource,\n            [this.courseId, this.module.id, this.courseContentsPage ? `${AddonModForumModuleHandlerService.PAGE_NAME}/` : ''],\n        );\n\n        this.sourceUnsubscribe = source.addListener({\n            onItemsUpdated: async discussions => {\n                this.discussionsItems = discussions.filter(discussion => !source.isNewDiscussionForm(discussion));\n                this.hasOffline = discussions.some(discussion => source.isOfflineDiscussion(discussion));\n\n                if (!this.forum) {\n                    return;\n                }\n\n                // Check if there are replies for discussions stored in offline.\n                const hasOffline = await AddonModForumOffline.hasForumReplies(this.forum.id);\n\n                this.hasOffline = this.hasOffline || hasOffline || this.hasOfflineRatings;\n\n                if (hasOffline) {\n                    // Only update new fetched discussions.\n                    const promises = discussions.map(async (discussion) => {\n                        if (!this.discussions?.getSource().isOnlineDiscussion(discussion)) {\n                            return;\n                        }\n\n                        // Get offline discussions.\n                        const replies = await AddonModForumOffline.getDiscussionReplies(discussion.discussion);\n\n                        discussion.numreplies = Number(discussion.numreplies) + replies.length;\n                    });\n\n                    await Promise.all(promises);\n                }\n            },\n            onReset: () => {\n                this.discussionsItems = [];\n            },\n        });\n\n        this.promisedDiscussions.resolve(new AddonModForumDiscussionsManager(source, this));\n\n        // Refresh data if this forum discussion is synchronized from discussions list.\n        this.syncManualObserver = CoreEvents.on(AddonModForumSyncProvider.MANUAL_SYNCED, (data) => {\n            this.autoSyncEventReceived(data);\n        }, this.siteId);\n\n        // Listen for discussions added. When a discussion is added, we reload the data.\n        this.newDiscObserver = CoreEvents.on(\n            AddonModForumProvider.NEW_DISCUSSION_EVENT,\n            (data) => this.eventReceived(true, data),\n        );\n        this.replyObserver = CoreEvents.on(\n            AddonModForumProvider.REPLY_DISCUSSION_EVENT,\n            (data) => this.eventReceived(false, data),\n        );\n        this.changeDiscObserver = CoreEvents.on(AddonModForumProvider.CHANGE_DISCUSSION_EVENT, data => {\n            if (!this.forum) {\n                return;\n            }\n\n            if (this.forum.id === data.forumId || data.cmId === this.module.id) {\n                AddonModForum.invalidateDiscussionsList(this.forum.id).finally(() => {\n                    if (data.discussionId) {\n                        // Discussion changed, search it in the list of discussions.\n                        const discussion = this.discussions?.items.find(\n                            disc => this.discussions?.getSource().isOnlineDiscussion(disc) && data.discussionId == disc.discussion,\n                        ) as AddonModForumDiscussion;\n\n                        if (discussion) {\n                            if (data.locked !== undefined) {\n                                discussion.locked = data.locked;\n                            }\n                            if (data.pinned !== undefined) {\n                                discussion.pinned = data.pinned;\n                            }\n                            if (data.starred !== undefined) {\n                                discussion.starred = data.starred;\n                            }\n\n                            this.showLoadingAndRefresh(false);\n                        }\n                    }\n\n                    if (data.deleted !== undefined && data.deleted) {\n                        if (data.post?.parentid == 0 && CoreScreen.isTablet && this.discussions && !this.discussions.empty) {\n                            // Discussion deleted, clear details page.\n                            this.discussions.select(this.discussions[0]);\n                        }\n\n                        this.showLoadingAndRefresh(false);\n                    }\n                });\n            }\n        });\n\n        // Listen for offline ratings saved and synced.\n        this.ratingOfflineObserver = CoreEvents.on(CoreRatingProvider.RATING_SAVED_EVENT, (data) => {\n            if (this.forum && data.component == 'mod_forum' && data.ratingArea == 'post' &&\n                    data.contextLevel == ContextLevel.MODULE && data.instanceId == this.forum.cmid) {\n                this.hasOfflineRatings = true;\n                this.hasOffline = true;\n            }\n        });\n\n        this.ratingSyncObserver = CoreEvents.on(CoreRatingSyncProvider.SYNCED_EVENT, async (data) => {\n            if (this.forum && data.component == 'mod_forum' && data.ratingArea == 'post' &&\n                    data.contextLevel == ContextLevel.MODULE && data.instanceId == this.forum.cmid) {\n                this.hasOfflineRatings =\n                    await CoreRatingOffline.hasRatings('mod_forum', 'post', ContextLevel.MODULE, this.forum.cmid);\n                this.hasOffline = this.hasOffline || this.hasOfflineRatings;\n            }\n        });\n    }\n\n    async ngAfterViewInit(): Promise<void> {\n        await this.loadContent(false, true);\n\n        const discussions = await this.promisedDiscussions;\n\n        discussions.start(this.splitView);\n    }\n\n    /**\n     * @inheritdoc\n     */\n    ngOnDestroy(): void {\n        super.ngOnDestroy();\n\n        this.syncManualObserver && this.syncManualObserver.off();\n        this.newDiscObserver && this.newDiscObserver.off();\n        this.replyObserver && this.replyObserver.off();\n        this.viewDiscObserver && this.viewDiscObserver.off();\n        this.changeDiscObserver && this.changeDiscObserver.off();\n        this.ratingOfflineObserver && this.ratingOfflineObserver.off();\n        this.ratingSyncObserver && this.ratingSyncObserver.off();\n        this.sourceUnsubscribe && this.sourceUnsubscribe();\n        this.discussions?.destroy();\n    }\n\n    /**\n     * Open search page.\n     */\n    async openSearch(): Promise<void> {\n        if (!this.forum) {\n            return;\n        }\n\n        await CoreNavigator.navigateToSitePath(FORUM_SEARCH_PAGE_NAME, {\n            params: {\n                courseId: this.courseId,\n                forumId: this.forum.id,\n            },\n        });\n    }\n\n    /**\n     * @inheritdoc\n     */\n    protected async fetchContent(refresh = false, sync = false, showErrors = false): Promise<void> {\n        this.fetchFailed = false;\n\n        try {\n            await Promise.all([\n                this.fetchForum(sync, showErrors),\n                this.fetchSortOrderPreference(),\n            ]);\n\n            if (!this.forum) {\n                return;\n            }\n\n            const discussions = await this.promisedDiscussions;\n\n            await Promise.all([\n                refresh ? discussions.reload() : discussions.load(),\n                CoreRatingOffline.hasRatings('mod_forum', 'post', ContextLevel.MODULE, this.forum.cmid).then((hasRatings) => {\n                    this.hasOfflineRatings = hasRatings;\n\n                    return;\n                }),\n            ]);\n        } catch (error) {\n            this.fetchFailed = true; // Set to prevent infinite calls with infinite-loading.\n\n            throw error; // Pass the error to the parent catch.\n        }\n    }\n\n    private async fetchForum(sync: boolean = false, showErrors: boolean = false): Promise<void> {\n        if (!this.courseId || !this.module) {\n            return;\n        }\n\n        const discussions = await this.promisedDiscussions;\n\n        await discussions.getSource().loadForum();\n\n        if (!this.forum) {\n            return;\n        }\n\n        const forum = this.forum;\n        const showDueDateMessage = !CoreSites.getCurrentSite()?.isVersionGreaterEqualThan('3.11');\n        this.description = forum.intro || this.description;\n        this.availabilityMessage = AddonModForumHelper.getAvailabilityMessage(forum, showDueDateMessage);\n        this.descriptionNote = Translate.instant('addon.mod_forum.numdiscussions', {\n            numdiscussions: forum.numdiscussions,\n        });\n\n        this.dataRetrieved.emit(forum);\n\n        switch (forum.type) {\n            case 'news':\n            case 'blog':\n                this.addDiscussionText = Translate.instant('addon.mod_forum.addanewtopic');\n                break;\n            case 'qanda':\n                this.addDiscussionText = Translate.instant('addon.mod_forum.addanewquestion');\n                break;\n            default:\n                this.addDiscussionText = Translate.instant('addon.mod_forum.addanewdiscussion');\n        }\n\n        if (sync) {\n            // Try to synchronize the forum.\n            const updated = await this.syncActivity(showErrors);\n\n            if (updated) {\n                // Sync successful, send event.\n                CoreEvents.trigger(AddonModForumSyncProvider.MANUAL_SYNCED, {\n                    forumId: forum.id,\n                    userId: CoreSites.getCurrentSiteUserId(),\n                    source: 'index',\n                }, CoreSites.getCurrentSiteId());\n            }\n        }\n\n        const promises: Promise<void>[] = [];\n\n        // Check if the activity uses groups.\n        promises.push(discussions.getSource().loadGroupInfo(forum.id));\n\n        promises.push(\n            AddonModForum\n                .getAccessInformation(forum.id, { cmId: this.module.id })\n                .then(async accessInfo => {\n                    // Disallow adding discussions if cut-off date is reached and the user has not the\n                    // capability to override it.\n                    // Just in case the forum was fetched from WS when the cut-off date was not reached but it is now.\n                    const cutoffDateReached = AddonModForumHelper.isCutoffDateReached(forum)\n                                    && !accessInfo.cancanoverridecutoff;\n                    this.canAddDiscussion = !!forum.cancreatediscussions && !cutoffDateReached;\n                    this.showQAMessage = forum.type === 'qanda' && !accessInfo.canviewqandawithoutposting;\n\n                    return;\n                }),\n        );\n\n        await Promise.all(promises);\n    }\n\n    /**\n     * Convenience function to load more forum discussions.\n     *\n     * @param complete Infinite scroll complete function. Only used from core-infinite-loading.\n     * @returns Promise resolved when done.\n     */\n    async fetchMoreDiscussions(complete: () => void): Promise<void> {\n        const discussions = await this.promisedDiscussions;\n\n        try {\n            this.fetchFailed = false;\n\n            await discussions.load();\n        } catch (error) {\n            CoreDomUtils.showErrorModalDefault(error, 'addon.mod_forum.errorgetforum', true);\n\n            this.fetchFailed = true;\n        } finally {\n            complete();\n        }\n    }\n\n    /**\n     * Convenience function to fetch the sort order preference.\n     *\n     * @returns Promise resolved when done.\n     */\n    protected async fetchSortOrderPreference(): Promise<void> {\n        const discussions = await this.promisedDiscussions;\n        const selectedOrder = await AddonModForum.getSelectedSortOrder();\n\n        discussions.getSource().selectedSortOrder = selectedOrder;\n\n        if (this.sortOrderSelectorModalOptions.componentProps) {\n            this.sortOrderSelectorModalOptions.componentProps.selected = selectedOrder.value;\n        }\n    }\n\n    /**\n     * Perform the invalidate content function.\n     *\n     * @returns Resolved when done.\n     */\n    protected async invalidateContent(): Promise<void> {\n        const promises: Promise<void>[] = [];\n\n        if (this.discussions) {\n            promises.push(this.discussions.getSource().invalidateCache());\n        }\n\n        if (this.forum) {\n            promises.push(AddonModForum.invalidateAccessInformation(this.forum.id));\n        }\n\n        if (this.sortingAvailable) {\n            promises.push(CoreUser.invalidateUserPreference(AddonModForumProvider.PREFERENCE_SORTORDER));\n        }\n\n        await Promise.all(promises);\n    }\n\n    /**\n     * @inheritdoc\n     */\n    protected sync(): Promise<AddonModForumSyncResult> {\n        return AddonModForumPrefetchHandler.sync(this.module, this.courseId);\n    }\n\n    /**\n     * Compares sync event data with current data to check if refresh content is needed.\n     *\n     * @param syncEventData Data receiven on sync observer.\n     * @returns True if refresh is needed, false otherwise.\n     */\n    protected isRefreshSyncNeeded(syncEventData: AddonModForumAutoSyncData | AddonModForumManualSyncData): boolean {\n        return !!this.forum\n            && (!('source' in syncEventData) || syncEventData.source != 'index')\n            && syncEventData.forumId == this.forum.id\n            && syncEventData.userId == CoreSites.getCurrentSiteUserId();\n    }\n\n    /**\n     * Function called when we receive an event of new discussion or reply to discussion.\n     *\n     * @param isNewDiscussion Whether it's a new discussion event.\n     * @param data Event data.\n     */\n    protected async eventReceived(\n        isNewDiscussion: boolean,\n        data: AddonModForumNewDiscussionData | AddonModForumReplyDiscussionData,\n    ): Promise<void> {\n        if ((!this.forum || this.forum.id !== data.forumId) && data.cmId !== this.module.id) {\n            return; // Not current forum.\n        }\n\n        // Check completion since it could be configured to complete once the user adds a new discussion or replies.\n        this.checkCompletion();\n\n        try {\n            if (isNewDiscussion) {\n                CoreDomUtils.showToast('addon.mod_forum.postaddedsuccess', true);\n\n                const newDiscGroupId = (data as AddonModForumNewDiscussionData).groupId;\n\n                if (!newDiscGroupId || newDiscGroupId < 0 || !this.groupId || newDiscGroupId === this.groupId) {\n                    await this.showLoadingAndRefresh(false);\n                } else {\n                    // Discussion is in a different group than the one currently viewed, only invalidate data.\n                    await this.discussions?.getSource().invalidateList();\n                }\n            } else {\n                await this.showLoadingAndRefresh(false);\n            }\n        } finally {\n            // If it's a new discussion in tablet mode, try to open it.\n            if (isNewDiscussion && CoreScreen.isTablet && this.discussions) {\n                const newDiscussionData = data as AddonModForumNewDiscussionData;\n                const discussion = this.discussions.items.find(disc => {\n                    if (this.discussions?.getSource().isOfflineDiscussion(disc)) {\n                        return disc.timecreated === newDiscussionData.discTimecreated;\n                    }\n\n                    if (this.discussions?.getSource().isOnlineDiscussion(disc)) {\n                        return (newDiscussionData.discussionIds ?? []).includes(disc.discussion);\n                    }\n\n                    return false;\n                });\n\n                this.discussions.select(discussion ?? null);\n            }\n        }\n\n    }\n\n    /**\n     * Opens the new discussion form.\n     */\n    openNewDiscussion(): void {\n        this.discussions?.select(AddonModForumDiscussionsSource.NEW_DISCUSSION);\n    }\n\n    /**\n     * Changes the sort order.\n     *\n     * @param sortOrder Sort order new data.\n     */\n    async setSortOrder(sortOrder: AddonModForumSortOrder): Promise<void> {\n        if (this.discussions && sortOrder.value != this.discussions.getSource().selectedSortOrder?.value) {\n            this.discussions.getSource().selectedSortOrder = sortOrder;\n            this.discussions.getSource().setDirty(true);\n\n            if (this.sortOrderSelectorModalOptions.componentProps) {\n                this.sortOrderSelectorModalOptions.componentProps.selected = sortOrder.value;\n            }\n\n            try {\n                await CoreUser.setUserPreference(AddonModForumProvider.PREFERENCE_SORTORDER, sortOrder.value.toFixed(0));\n                await this.showLoadingAndFetch();\n            } catch (error) {\n                CoreDomUtils.showErrorModalDefault(error, 'Error updating preference.');\n            }\n        }\n    }\n\n    /**\n     * Display the sort order selector modal.\n     */\n    async showSortOrderSelector(): Promise<void> {\n        const modalData = await CoreDomUtils.openModal<AddonModForumSortOrder>(this.sortOrderSelectorModalOptions);\n\n        if (modalData) {\n            this.setSortOrder(modalData);\n        }\n    }\n\n    /**\n     * Show the context menu.\n     *\n     * @param event Click Event.\n     * @param discussion Discussion.\n     */\n    async showOptionsMenu(event: Event, discussion: AddonModForumDiscussion): Promise<void> {\n        if (!this.forum) {\n            return;\n        }\n\n        event.preventDefault();\n        event.stopPropagation();\n\n        const popoverData = await CoreDomUtils.openPopover<{ action?: string; value: boolean }>({\n            component: AddonModForumDiscussionOptionsMenuComponent,\n            componentProps: {\n                discussion,\n                forumId: this.forum.id,\n                cmId: this.module.id,\n            },\n            event,\n        });\n\n        if (popoverData && popoverData.action) {\n            switch (popoverData.action) {\n                case 'lock':\n                    discussion.locked = popoverData.value;\n                    break;\n                case 'pin':\n                    discussion.pinned = popoverData.value;\n                    break;\n                case 'star':\n                    discussion.starred = popoverData.value;\n                    break;\n                default:\n                    break;\n            }\n        }\n    }\n\n    /**\n     * Group has changed.\n     */\n    async groupChanged(): Promise<void> {\n        const modal = await CoreDomUtils.showModalLoading();\n\n        try {\n            await Promise.all([\n                this.discussions?.getSource().loadSelectedGroupData(),\n                this.discussions?.reload(),\n            ]);\n        } catch (error) {\n            CoreDomUtils.showErrorModalDefault(error, 'core.errorloadingcontent', true);\n        } finally {\n            modal.dismiss();\n        }\n    }\n\n}\n\n/**\n * Discussions manager.\n */\nclass AddonModForumDiscussionsManager extends CoreListItemsManager<AddonModForumDiscussionItem, AddonModForumDiscussionsSource> {\n\n    page: AddonModForumIndexComponent;\n\n    constructor(source: AddonModForumDiscussionsSource, page: AddonModForumIndexComponent) {\n        super(source, page.route.component);\n\n        this.page = page;\n    }\n\n    /**\n     * @inheritdoc\n     */\n    protected getDefaultItem(): AddonModForumDiscussionItem | null {\n        const source = this.getSource();\n\n        return this.items.find(discussion => !source.isNewDiscussionForm(discussion)) || null;\n    }\n\n    /**\n     * @inheritdoc\n     */\n    protected async logActivity(): Promise<void> {\n        const forum = this.getSource().forum;\n\n        if (!forum) {\n            return;\n        }\n\n        try {\n            await AddonModForum.logView(forum.id);\n\n            CoreCourse.checkModuleCompletion(this.page.courseId, this.page.module.completiondata);\n        } catch {\n            // Ignore errors.\n        }\n\n        this.page.analyticsLogEvent('mod_forum_view_forum');\n    }\n\n    /**\n     * Check whether there is any discussion in the items.\n     *\n     * @returns Whether there is a discussion.\n     */\n    get hasDiscussions(): boolean {\n        const source = this.getSource();\n        const items = source.getItems();\n\n        return items !== null && items.some(item => !source.isNewDiscussionForm(item));\n    }\n\n}\n","<!-- Buttons to add to the header. -->\n<core-navbar-buttons slot=\"end\">\n    <ion-button fill=\"clear\" (click)=\"openSearch()\" [attr.aria-label]=\"'core.search' | translate\">\n        <ion-icon name=\"fas-magnifying-glass\" slot=\"icon-only\" aria-hidden=\"true\" />\n    </ion-button>\n    <ion-button fill=\"clear\" (click)=\"openModuleSummary()\" aria-haspopup=\"true\" [attr.aria-label]=\"'core.info' | translate\">\n        <ion-icon name=\"fas-circle-info\" slot=\"icon-only\" aria-hidden=\"true\" />\n    </ion-button>\n    <!-- Add an empty context menu so split view pages can add items, otherwise the menu disappears in some cases. -->\n    <core-context-menu />\n</core-navbar-buttons>\n\n<!-- Content. -->\n<core-split-view>\n    <ion-refresher slot=\"fixed\" [disabled]=\"showLoading || (discussions && !discussions.loaded)\" (ionRefresh)=\"doRefresh($event.target)\">\n        <ion-refresher-content pullingText=\"{{ 'core.pulltorefresh' | translate }}\" />\n    </ion-refresher>\n\n    <core-loading [hideUntil]=\"!showLoading && discussions && discussions.loaded\">\n        <!-- Activity info. -->\n        <core-course-module-info [module]=\"module\" [description]=\"forum && forum.type !== 'single' && description\" [component]=\"component\"\n            [componentId]=\"componentId\" [courseId]=\"courseId\" [hasDataToSync]=\"hasOffline || hasOfflineRatings\"\n            (completionChanged)=\"onCompletionChange()\">\n            <ion-item class=\"ion-text-wrap\">\n                <ion-label>\n                    {{descriptionNote}}\n                </ion-label>\n            </ion-item>\n        </core-course-module-info>\n\n        <core-group-selector *ngIf=\"supportsChangeGroup\" [groupInfo]=\"groupInfo\" [(selected)]=\"groupId\" (selectedChange)=\"groupChanged()\"\n            [courseId]=\"courseId\" />\n\n        <!-- Cut-off date or due date message -->\n        <ion-card class=\"core-info-card\" *ngIf=\"availabilityMessage\">\n            <ion-item>\n                <ion-icon name=\"fas-circle-info\" slot=\"start\" aria-hidden=\"true\" />\n                <ion-label>{{ availabilityMessage }}</ion-label>\n            </ion-item>\n        </ion-card>\n\n        <!-- Q&A message. -->\n        <ion-card class=\"core-info-card\" *ngIf=\"showQAMessage\">\n            <ion-item>\n                <ion-icon name=\"fas-circle-info\" slot=\"start\" aria-hidden=\"true\" />\n                <ion-label>{{ 'addon.mod_forum.qandanotify' | translate }}</ion-label>\n            </ion-item>\n        </ion-card>\n\n        <!-- Cannot add discussion to group messages. -->\n        <ion-card class=\"core-info-card\" *ngIf=\"usesGroups && canAddDiscussion && !canAddDiscussionToGroup\">\n            <ion-item>\n                <ion-icon name=\"fas-circle-info\" slot=\"start\" aria-hidden=\"true\" />\n                <ion-label>\n                    <span *ngIf=\"groupId <= 0\">{{ 'addon.mod_forum.cannotadddiscussionall' | translate }}</span>\n                    <span *ngIf=\"groupId > 0\">{{ 'addon.mod_forum.cannotadddiscussion' | translate }}</span>\n                </ion-label>\n            </ion-item>\n        </ion-card>\n\n        <ng-container *ngIf=\"forum\">\n            <div *ngIf=\"discussions && sortingAvailable && selectedSortOrder\" class=\"ion-text-wrap\">\n                <core-combobox [modalOptions]=\"sortOrderSelectorModalOptions\" listboxId=\"addon-mod-forum-sort-selector\"\n                    [label]=\"('core.sort' | translate)\" (onChange)=\"setSortOrder($event)\" [selection]=\"selectedSortOrder.label | translate\"\n                    interface=\"modal\" />\n            </div>\n\n            <core-empty-box *ngIf=\"!discussions || (!discussions.hasDiscussions && !errorLoadingDiscussions)\" icon=\"far-comments\"\n                [message]=\"'addon.mod_forum.forumnodiscussionsyet' | translate\" />\n\n            <core-empty-box *ngIf=\"errorLoadingDiscussions\" icon=\"fas-triangle-exclamation\"\n                [message]=\"'addon.mod_forum.errorloadingsortingorder' | translate\">\n                <p>{{ 'addon.mod_forum.errorloadingsortingorderdetails' | translate }}</p>\n            </core-empty-box>\n\n            <ion-item *ngFor=\"let discussion of discussionsItems\" class=\"addon-mod-forum-discussion\" [detail]=\"true\"\n                [lines]=\"discussion.groupname && 'none'\" [attr.aria-current]=\"discussions?.getItemAriaCurrent(discussion)\"\n                (click)=\"discussions?.select(discussion)\" button>\n                <ion-label>\n                    <p class=\"addon-mod-forum-discussion-title ion-text-wrap item-heading\">\n                        <ion-icon name=\"fas-map-pin\" *ngIf=\"discussion.pinned\"\n                            [attr.aria-label]=\"'addon.mod_forum.discussionpinned' | translate\" />\n                        <ion-icon name=\"fas-star\" class=\"addon-forum-star\" *ngIf=\"discussion.starred\"\n                            [attr.aria-label]=\"'addon.mod_forum.favourites' | translate\" />\n                        <core-format-text [text]=\"discussion.subject\" contextLevel=\"module\" [contextInstanceId]=\"module && module.id\"\n                            [courseId]=\"courseId\" />\n                        <ion-icon name=\"fas-lock\" *ngIf=\"discussion.locked\" class=\"addon-mod-forum-locked-icon\"\n                            [attr.aria-label]=\"'addon.mod_forum.discussionlocked' | translate\" />\n                    </p>\n                    <div class=\"addon-mod-forum-discussion-info\">\n                        <core-user-avatar *ngIf=\"discussion.userfullname\" [user]=\"discussion\" slot=\"start\" [courseId]=\"courseId\"\n                            [linkProfile]=\"false\" />\n                        <div class=\"addon-mod-forum-discussion-author\">\n                            <span *ngIf=\"discussion.userfullname\" class=\"core-discussionusername\">{{discussion.userfullname}}</span>\n                            <p *ngIf=\"discussion.groupname\" class=\"core-groupname\">\n                                <ion-icon name=\"fas-users\" [attr.aria-label]=\"'addon.mod_forum.group' | translate\" />\n                                <core-format-text [text]=\"discussion.groupname\" contextLevel=\"course\" [contextInstanceId]=\"courseId\"\n                                    [wsNotFiltered]=\"true\" />\n                            </p>\n                            <p *ngIf=\"isOnlineDiscussion(discussion)\">\n                                {{discussion.created * 1000 | coreFormatDate: \"strftimerecentfull\"}}\n                            </p>\n                            <p *ngIf=\"isOfflineDiscussion(discussion)\">\n                                <ion-icon name=\"fas-clock\" aria-hidden=\"true\" />\n                                {{ 'core.notsent' | translate }}\n                            </p>\n                        </div>\n                    </div>\n                    <ion-row *ngIf=\"isOnlineDiscussion(discussion)\" class=\"ion-text-center addon-mod-forum-discussion-more-info\">\n                        <ion-col class=\"ion-text-start\">\n                            <ion-note>\n                                <ion-icon name=\"fas-clock\" aria-hidden=\"true\" /> {{ 'addon.mod_forum.lastpost' | translate }}\n                                <ng-container *ngIf=\"discussion.timemodified > discussion.created\">\n                                    {{ discussion.timemodified | coreTimeAgo }}\n                                </ng-container>\n                                <ng-container *ngIf=\"discussion.timemodified <= discussion.created\">\n                                    {{ discussion.created | coreTimeAgo }}\n                                </ng-container>\n                            </ion-note>\n                        </ion-col>\n                        <ion-col class=\"ion-text-end\">\n                            <ion-note>\n                                <ion-icon name=\"fas-comments\" aria-hidden=\"true\" />\n                                {{ 'addon.mod_forum.numreplies' | translate:{numreplies: discussion.numreplies} }}\n                                <ion-badge *ngIf=\"discussion.numunread\" class=\"ion-text-center\">\n                                    <span aria-hidden=\"true\">{{ discussion.numunread }}</span>\n                                    <span class=\"sr-only\">\n                                        {{ 'addon.mod_forum.unreadpostsnumber' | translate:{ '$a' : discussion.numunread} }}\n                                    </span>\n                                </ion-badge>\n                            </ion-note>\n                        </ion-col>\n                    </ion-row>\n                </ion-label>\n                <ion-button *ngIf=\"canPin || discussion.canlock || discussion.canfavourite\" fill=\"clear\"\n                    [attr.aria-label]=\"('core.displayoptions' | translate)\" (click)=\"showOptionsMenu($event, discussion)\" slot=\"end\">\n                    <ion-icon name=\"ellipsis-vertical\" slot=\"icon-only\" aria-hidden=\"true\" />\n                </ion-button>\n            </ion-item>\n\n            <core-infinite-loading [enabled]=\"discussions && discussions.loaded && !discussions.completed\" [error]=\"fetchFailed\"\n                (action)=\"fetchMoreDiscussions($event)\" />\n        </ng-container>\n    </core-loading>\n\n    <core-course-module-navigation collapsible-footer [hidden]=\"showLoading\" [courseId]=\"courseId\" [currentModuleId]=\"module.id\" />\n\n    <ion-fab slot=\"fixed\" core-fab vertical=\"bottom\" horizontal=\"end\" *ngIf=\"canAddDiscussionToGroup\">\n        <ion-fab-button (click)=\"openNewDiscussion()\" [attr.aria-label]=\"addDiscussionText\">\n            <ion-icon name=\"fas-plus\" aria-hidden=\"true\" />\n            <span class=\"sr-only\">{{ addDiscussionText }}</span>\n        </ion-fab-button>\n    </ion-fab>\n</core-split-view>\n"],"mappings":";;AAmBA,SAASA,qCAAqC,QAAQ,kDAAkD;AACxG,SACIC,aAAa,EAEbC,qBAAqB,QAKlB,kCAAkC;AACzC,SAASC,oBAAoB,QAAQ,0CAA0C;AAC/E,SAASC,SAAS,QAAQ,aAAa;AAEvC,SAASC,mBAAmB,QAAQ,yCAAyC;AAE7E,SAASC,UAAU,QAA2B,oBAAoB;AAClE,SAGIC,yBAAyB,QAEtB,uCAAuC;AAC9C,SAASC,SAAS,QAAQ,iBAAiB;AAC3C,SAASC,QAAQ,QAAQ,8BAA8B;AACvD,SAASC,YAAY,QAAQ,qBAAqB;AAClD,SAASC,UAAU,QAAQ,kCAAkC;AAC7D,SAASC,sBAAsB,QAAQ,mCAAmC;AAC1E,SAASC,2CAA2C,QAAQ,oDAAoD;AAChH,SAASC,uCAAuC,QAAQ,4CAA4C;AACpG,SAASC,UAAU,QAAQ,kBAAkB;AAC7C,SAASC,4BAA4B,QAAQ,kCAAkC;AAC/E,SAASC,iCAAiC,QAAQ,gCAAgC;AAClF,SAASC,kBAAkB,QAAQ,kCAAkC;AACrE,SAASC,sBAAsB,QAAQ,uCAAuC;AAC9E,SAASC,iBAAiB,QAAQ,0CAA0C;AAE5E,SAAsCC,8BAA8B,QAAQ,wCAAwC;AACpH,SAASC,oBAAoB,QAAQ,8CAA8C;AACnF,SAASC,oCAAoC,QAAQ,gEAAgE;AACrH,SAASC,iBAAiB,QAAQ,yBAAyB;AAC3D,SAASC,aAAa,QAAQ,qBAAqB;AACnD,SAASC,sBAAsB,QAAQ,gCAAgC;;;;;;;;IC9B/DC,EAAA,CAAAC,cAAA,8BAC4B;IAD6CD,EAAA,CAAAE,UAAA,4BAAAC,0GAAAC,MAAA;MAAAJ,EAAA,CAAAK,aAAA,CAAAC,GAAA;MAAA,MAAAC,MAAA,GAAAP,EAAA,CAAAQ,aAAA;MAAA,OAAAR,EAAA,CAAAS,WAAA,CAAAF,MAAA,CAAAG,OAAA,GAAAN,MAAA;IAAA,EAAsB,4BAAAD,0GAAA;MAAAH,EAAA,CAAAK,aAAA,CAAAC,GAAA;MAAA,MAAAK,MAAA,GAAAX,EAAA,CAAAQ,aAAA;MAAA,OAAmBR,EAAA,CAAAS,WAAA,CAAAE,MAAA,CAAAC,YAAA,EAAc;IAAA,EAAjC;IAA/FZ,EAAA,CAAAa,YAAA,EAC4B;;;;IADqBb,EAAA,CAAAc,UAAA,cAAAC,MAAA,CAAAC,SAAA,CAAuB,aAAAD,MAAA,CAAAL,OAAA,cAAAK,MAAA,CAAAE,QAAA;;;;;IAIxEjB,EAAA,CAAAC,cAAA,mBAA6D;IAErDD,EAAA,CAAAkB,SAAA,mBAAmE;IACnElB,EAAA,CAAAC,cAAA,gBAAW;IAAAD,EAAA,CAAAmB,MAAA,GAAyB;IAAAnB,EAAA,CAAAa,YAAA,EAAY;;;;IAArCb,EAAA,CAAAoB,SAAA,GAAyB;IAAzBpB,EAAA,CAAAqB,iBAAA,CAAAC,MAAA,CAAAC,mBAAA,CAAyB;;;;;IAK5CvB,EAAA,CAAAC,cAAA,mBAAuD;IAE/CD,EAAA,CAAAkB,SAAA,mBAAmE;IACnElB,EAAA,CAAAC,cAAA,gBAAW;IAAAD,EAAA,CAAAmB,MAAA,GAA+C;;IAAAnB,EAAA,CAAAa,YAAA,EAAY;;;IAA3Db,EAAA,CAAAoB,SAAA,GAA+C;IAA/CpB,EAAA,CAAAqB,iBAAA,CAAArB,EAAA,CAAAwB,WAAA,sCAA+C;;;;;IAStDxB,EAAA,CAAAC,cAAA,WAA2B;IAAAD,EAAA,CAAAmB,MAAA,GAA0D;;IAAAnB,EAAA,CAAAa,YAAA,EAAO;;;IAAjEb,EAAA,CAAAoB,SAAA,GAA0D;IAA1DpB,EAAA,CAAAqB,iBAAA,CAAArB,EAAA,CAAAwB,WAAA,iDAA0D;;;;;IACrFxB,EAAA,CAAAC,cAAA,WAA0B;IAAAD,EAAA,CAAAmB,MAAA,GAAuD;;IAAAnB,EAAA,CAAAa,YAAA,EAAO;;;IAA9Db,EAAA,CAAAoB,SAAA,GAAuD;IAAvDpB,EAAA,CAAAqB,iBAAA,CAAArB,EAAA,CAAAwB,WAAA,8CAAuD;;;;;IAL7FxB,EAAA,CAAAC,cAAA,mBAAoG;IAE5FD,EAAA,CAAAkB,SAAA,mBAAmE;IACnElB,EAAA,CAAAC,cAAA,gBAAW;IACPD,EAAA,CAAAyB,UAAA,IAAAC,uDAAA,mBAA4F;IAC5F1B,EAAA,CAAAyB,UAAA,IAAAE,uDAAA,mBAAwF;IAC5F3B,EAAA,CAAAa,YAAA,EAAY;;;;IAFDb,EAAA,CAAAoB,SAAA,GAAkB;IAAlBpB,EAAA,CAAAc,UAAA,SAAAc,MAAA,CAAAlB,OAAA,MAAkB;IAClBV,EAAA,CAAAoB,SAAA,GAAiB;IAAjBpB,EAAA,CAAAc,UAAA,SAAAc,MAAA,CAAAlB,OAAA,KAAiB;;;;;;IAMhCV,EAAA,CAAAC,cAAA,aAAwF;IAE5CD,EAAA,CAAAE,UAAA,sBAAA2B,6FAAAzB,MAAA;MAAAJ,EAAA,CAAAK,aAAA,CAAAyB,IAAA;MAAA,MAAAC,OAAA,GAAA/B,EAAA,CAAAQ,aAAA;MAAA,OAAYR,EAAA,CAAAS,WAAA,CAAAsB,OAAA,CAAAC,YAAA,CAAA5B,MAAA,CAAoB;IAAA,EAAC;;;IADzEJ,EAAA,CAAAa,YAAA,EAEwB;;;;IAFTb,EAAA,CAAAoB,SAAA,GAA8C;IAA9CpB,EAAA,CAAAc,UAAA,iBAAAmB,OAAA,CAAAC,6BAAA,CAA8C,UAAAlC,EAAA,CAAAwB,WAAA,kCAAAxB,EAAA,CAAAwB,WAAA,OAAAS,OAAA,CAAAE,iBAAA,CAAAC,KAAA;;;;;IAKjEpC,EAAA,CAAAkB,SAAA,yBACsE;;;;IAAlElB,EAAA,CAAAc,UAAA,YAAAd,EAAA,CAAAwB,WAAA,gDAA+D;;;;;IAEnExB,EAAA,CAAAC,cAAA,yBACuE;;IACnED,EAAA,CAAAC,cAAA,QAAG;IAAAD,EAAA,CAAAmB,MAAA,GAAmE;;IAAAnB,EAAA,CAAAa,YAAA,EAAI;;;IAD1Eb,EAAA,CAAAc,UAAA,YAAAd,EAAA,CAAAwB,WAAA,mDAAkE;IAC/DxB,EAAA,CAAAoB,SAAA,GAAmE;IAAnEpB,EAAA,CAAAqB,iBAAA,CAAArB,EAAA,CAAAwB,WAAA,0DAAmE;;;;;IAQ9DxB,EAAA,CAAAkB,SAAA,mBACyE;;;;IAArElB,EAAA,CAAAqC,WAAA,eAAArC,EAAA,CAAAwB,WAAA,2CAAkE;;;;;IACtExB,EAAA,CAAAkB,SAAA,mBACmE;;;;IAA/DlB,EAAA,CAAAqC,WAAA,eAAArC,EAAA,CAAAwB,WAAA,qCAA4D;;;;;IAGhExB,EAAA,CAAAkB,SAAA,mBACyE;;;;IAArElB,EAAA,CAAAqC,WAAA,eAAArC,EAAA,CAAAwB,WAAA,2CAAkE;;;;;IAGtExB,EAAA,CAAAkB,SAAA,2BAC4B;;;;;IADsBlB,EAAA,CAAAc,UAAA,SAAAwB,cAAA,CAAmB,aAAAC,OAAA,CAAAtB,QAAA;;;;;IAGjEjB,EAAA,CAAAC,cAAA,eAAsE;IAAAD,EAAA,CAAAmB,MAAA,GAA2B;IAAAnB,EAAA,CAAAa,YAAA,EAAO;;;;IAAlCb,EAAA,CAAAoB,SAAA,GAA2B;IAA3BpB,EAAA,CAAAqB,iBAAA,CAAAiB,cAAA,CAAAE,YAAA,CAA2B;;;;;IACjGxC,EAAA,CAAAC,cAAA,YAAuD;IACnDD,EAAA,CAAAkB,SAAA,mBAAqF;;IACrFlB,EAAA,CAAAkB,SAAA,2BAC6B;IACjClB,EAAA,CAAAa,YAAA,EAAI;;;;;IAH2Bb,EAAA,CAAAoB,SAAA,GAAuD;IAAvDpB,EAAA,CAAAqC,WAAA,eAAArC,EAAA,CAAAwB,WAAA,gCAAuD;IAChExB,EAAA,CAAAoB,SAAA,GAA6B;IAA7BpB,EAAA,CAAAc,UAAA,SAAAwB,cAAA,CAAAG,SAAA,CAA6B,sBAAAC,OAAA,CAAAzB,QAAA;;;;;IAGnDjB,EAAA,CAAAC,cAAA,QAA0C;IACtCD,EAAA,CAAAmB,MAAA,GACJ;;IAAAnB,EAAA,CAAAa,YAAA,EAAI;;;;IADAb,EAAA,CAAAoB,SAAA,GACJ;IADIpB,EAAA,CAAA2C,kBAAA,MAAA3C,EAAA,CAAA4C,WAAA,OAAAN,cAAA,CAAAO,OAAA,oCACJ;;;;;IACA7C,EAAA,CAAAC,cAAA,QAA2C;IACvCD,EAAA,CAAAkB,SAAA,mBAAgD;IAChDlB,EAAA,CAAAmB,MAAA,GACJ;;IAAAnB,EAAA,CAAAa,YAAA,EAAI;;;IADAb,EAAA,CAAAoB,SAAA,GACJ;IADIpB,EAAA,CAAA2C,kBAAA,MAAA3C,EAAA,CAAAwB,WAAA,4BACJ;;;;;IAOIxB,EAAA,CAAA8C,uBAAA,GAAmE;IAC/D9C,EAAA,CAAAmB,MAAA,GACJ;;IAAAnB,EAAA,CAAA+C,qBAAA,EAAe;;;;IADX/C,EAAA,CAAAoB,SAAA,GACJ;IADIpB,EAAA,CAAA2C,kBAAA,MAAA3C,EAAA,CAAAwB,WAAA,OAAAc,cAAA,CAAAU,YAAA,OACJ;;;;;IACAhD,EAAA,CAAA8C,uBAAA,GAAoE;IAChE9C,EAAA,CAAAmB,MAAA,GACJ;;IAAAnB,EAAA,CAAA+C,qBAAA,EAAe;;;;IADX/C,EAAA,CAAAoB,SAAA,GACJ;IADIpB,EAAA,CAAA2C,kBAAA,MAAA3C,EAAA,CAAAwB,WAAA,OAAAc,cAAA,CAAAO,OAAA,OACJ;;;;;;;;;;IAOA7C,EAAA,CAAAC,cAAA,oBAAgE;IACnCD,EAAA,CAAAmB,MAAA,GAA0B;IAAAnB,EAAA,CAAAa,YAAA,EAAO;IAC1Db,EAAA,CAAAC,cAAA,eAAsB;IAClBD,EAAA,CAAAmB,MAAA,GACJ;;IAAAnB,EAAA,CAAAa,YAAA,EAAO;;;;IAHkBb,EAAA,CAAAoB,SAAA,GAA0B;IAA1BpB,EAAA,CAAAqB,iBAAA,CAAAiB,cAAA,CAAAW,SAAA,CAA0B;IAE/CjD,EAAA,CAAAoB,SAAA,GACJ;IADIpB,EAAA,CAAA2C,kBAAA,MAAA3C,EAAA,CAAA4C,WAAA,4CAAA5C,EAAA,CAAAkD,eAAA,IAAAC,GAAA,EAAAb,cAAA,CAAAW,SAAA,QACJ;;;;;;;;;;IApBhBjD,EAAA,CAAAC,cAAA,kBAA6G;IAGjGD,EAAA,CAAAkB,SAAA,mBAAgD;IAAClB,EAAA,CAAAmB,MAAA,GACjD;;IAAAnB,EAAA,CAAAyB,UAAA,IAAA2B,yFAAA,2BAEe;IACfpD,EAAA,CAAAyB,UAAA,IAAA4B,yFAAA,2BAEe;IACnBrD,EAAA,CAAAa,YAAA,EAAW;IAEfb,EAAA,CAAAC,cAAA,kBAA8B;IAEtBD,EAAA,CAAAkB,SAAA,oBAAmD;IACnDlB,EAAA,CAAAmB,MAAA,IACA;;IAAAnB,EAAA,CAAAyB,UAAA,KAAA6B,uFAAA,wBAKY;IAChBtD,EAAA,CAAAa,YAAA,EAAW;;;;IAnB0Cb,EAAA,CAAAoB,SAAA,GACjD;IADiDpB,EAAA,CAAA2C,kBAAA,MAAA3C,EAAA,CAAAwB,WAAA,wCACjD;IAAexB,EAAA,CAAAoB,SAAA,GAAkD;IAAlDpB,EAAA,CAAAc,UAAA,SAAAwB,cAAA,CAAAU,YAAA,GAAAV,cAAA,CAAAO,OAAA,CAAkD;IAGlD7C,EAAA,CAAAoB,SAAA,GAAmD;IAAnDpB,EAAA,CAAAc,UAAA,SAAAwB,cAAA,CAAAU,YAAA,IAAAV,cAAA,CAAAO,OAAA,CAAmD;IAQlE7C,EAAA,CAAAoB,SAAA,GACA;IADApB,EAAA,CAAA2C,kBAAA,MAAA3C,EAAA,CAAA4C,WAAA,sCAAA5C,EAAA,CAAAkD,eAAA,KAAAK,GAAA,EAAAjB,cAAA,CAAAkB,UAAA,QACA;IAAYxD,EAAA,CAAAoB,SAAA,GAA0B;IAA1BpB,EAAA,CAAAc,UAAA,SAAAwB,cAAA,CAAAW,SAAA,CAA0B;;;;;;IAUtDjD,EAAA,CAAAC,cAAA,qBACqH;IAAzDD,EAAA,CAAAE,UAAA,mBAAAuD,0GAAArD,MAAA;MAAAJ,EAAA,CAAAK,aAAA,CAAAqD,IAAA;MAAA,MAAApB,cAAA,GAAAtC,EAAA,CAAAQ,aAAA,GAAAmD,SAAA;MAAA,MAAAC,OAAA,GAAA5D,EAAA,CAAAQ,aAAA;MAAA,OAASR,EAAA,CAAAS,WAAA,CAAAmD,OAAA,CAAAC,eAAA,CAAAzD,MAAA,EAAAkC,cAAA,CAAmC;IAAA,EAAC;;IACrGtC,EAAA,CAAAkB,SAAA,mBAAyE;IAC7ElB,EAAA,CAAAa,YAAA,EAAa;;;IAFTb,EAAA,CAAAqC,WAAA,eAAArC,EAAA,CAAAwB,WAAA,8BAAuD;;;;;;IA5D/DxB,EAAA,CAAAC,cAAA,mBAEqD;IAAjDD,EAAA,CAAAE,UAAA,mBAAA4D,0FAAA;MAAA,MAAAC,WAAA,GAAA/D,EAAA,CAAAK,aAAA,CAAA2D,IAAA;MAAA,MAAA1B,cAAA,GAAAyB,WAAA,CAAAJ,SAAA;MAAA,MAAAM,OAAA,GAAAjE,EAAA,CAAAQ,aAAA;MAAA,OAAAR,EAAA,CAAAS,WAAA,CAAAwD,OAAA,CAAAC,WAAA,kBAASD,OAAA,CAAAC,WAAA,CAAAC,MAAA,CAAA7B,cAAA,CAA+B;IAAA,EAAC;IACzCtC,EAAA,CAAAC,cAAA,gBAAW;IAEHD,EAAA,CAAAyB,UAAA,IAAA2C,0EAAA,uBACyE;IACzEpE,EAAA,CAAAyB,UAAA,IAAA4C,0EAAA,uBACmE;IACnErE,EAAA,CAAAkB,SAAA,2BAC4B;IAC5BlB,EAAA,CAAAyB,UAAA,IAAA6C,0EAAA,uBACyE;IAC7EtE,EAAA,CAAAa,YAAA,EAAI;IACJb,EAAA,CAAAC,cAAA,cAA6C;IACzCD,EAAA,CAAAyB,UAAA,IAAA8C,kFAAA,+BAC4B;IAC5BvE,EAAA,CAAAC,cAAA,cAA+C;IAC3CD,EAAA,CAAAyB,UAAA,KAAA+C,uEAAA,mBAAwG;IACxGxE,EAAA,CAAAyB,UAAA,KAAAgD,oEAAA,gBAII;IACJzE,EAAA,CAAAyB,UAAA,KAAAiD,oEAAA,gBAEI;IACJ1E,EAAA,CAAAyB,UAAA,KAAAkD,oEAAA,gBAGI;IACR3E,EAAA,CAAAa,YAAA,EAAM;IAEVb,EAAA,CAAAyB,UAAA,KAAAmD,0EAAA,wBAwBU;IACd5E,EAAA,CAAAa,YAAA,EAAY;IACZb,EAAA,CAAAyB,UAAA,KAAAoD,6EAAA,yBAGa;IACjB7E,EAAA,CAAAa,YAAA,EAAW;;;;;IA/D8Eb,EAAA,CAAAc,UAAA,gBAAe,UAAAwB,cAAA,CAAAG,SAAA;IAC3DzC,EAAA,CAAAqC,WAAA,iBAAAyC,OAAA,CAAAZ,WAAA,kBAAAY,OAAA,CAAAZ,WAAA,CAAAa,kBAAA,CAAAzC,cAAA,EAAiE;IAIpEtC,EAAA,CAAAoB,SAAA,GAAuB;IAAvBpB,EAAA,CAAAc,UAAA,SAAAwB,cAAA,CAAA0C,MAAA,CAAuB;IAEDhF,EAAA,CAAAoB,SAAA,GAAwB;IAAxBpB,EAAA,CAAAc,UAAA,SAAAwB,cAAA,CAAA2C,OAAA,CAAwB;IAE1DjF,EAAA,CAAAoB,SAAA,GAA2B;IAA3BpB,EAAA,CAAAc,UAAA,SAAAwB,cAAA,CAAA4C,OAAA,CAA2B,sBAAAJ,OAAA,CAAAK,MAAA,IAAAL,OAAA,CAAAK,MAAA,CAAAC,EAAA,cAAAN,OAAA,CAAA7D,QAAA;IAElBjB,EAAA,CAAAoB,SAAA,GAAuB;IAAvBpB,EAAA,CAAAc,UAAA,SAAAwB,cAAA,CAAA+C,MAAA,CAAuB;IAI/BrF,EAAA,CAAAoB,SAAA,GAA6B;IAA7BpB,EAAA,CAAAc,UAAA,SAAAwB,cAAA,CAAAE,YAAA,CAA6B;IAGrCxC,EAAA,CAAAoB,SAAA,GAA6B;IAA7BpB,EAAA,CAAAc,UAAA,SAAAwB,cAAA,CAAAE,YAAA,CAA6B;IAChCxC,EAAA,CAAAoB,SAAA,GAA0B;IAA1BpB,EAAA,CAAAc,UAAA,SAAAwB,cAAA,CAAAG,SAAA,CAA0B;IAK1BzC,EAAA,CAAAoB,SAAA,GAAoC;IAApCpB,EAAA,CAAAc,UAAA,SAAAgE,OAAA,CAAAQ,kBAAA,CAAAhD,cAAA,EAAoC;IAGpCtC,EAAA,CAAAoB,SAAA,GAAqC;IAArCpB,EAAA,CAAAc,UAAA,SAAAgE,OAAA,CAAAS,mBAAA,CAAAjD,cAAA,EAAqC;IAMvCtC,EAAA,CAAAoB,SAAA,GAAoC;IAApCpB,EAAA,CAAAc,UAAA,SAAAgE,OAAA,CAAAQ,kBAAA,CAAAhD,cAAA,EAAoC;IA0BrCtC,EAAA,CAAAoB,SAAA,GAA6D;IAA7DpB,EAAA,CAAAc,UAAA,SAAAgE,OAAA,CAAAU,MAAA,IAAAlD,cAAA,CAAAmD,OAAA,IAAAnD,cAAA,CAAAoD,YAAA,CAA6D;;;;;;IA1ElF1F,EAAA,CAAA8C,uBAAA,GAA4B;IACxB9C,EAAA,CAAAyB,UAAA,IAAAkE,0DAAA,kBAIM;IAEN3F,EAAA,CAAAyB,UAAA,IAAAmE,qEAAA,6BACsE;IAEtE5F,EAAA,CAAAyB,UAAA,IAAAoE,qEAAA,6BAGiB;IAEjB7F,EAAA,CAAAyB,UAAA,IAAAqE,+DAAA,yBA+DW;IAEX9F,EAAA,CAAAC,cAAA,gCAC8C;IAA1CD,EAAA,CAAAE,UAAA,oBAAA6F,6FAAA3F,MAAA;MAAAJ,EAAA,CAAAK,aAAA,CAAA2F,IAAA;MAAA,MAAAC,OAAA,GAAAjG,EAAA,CAAAQ,aAAA;MAAA,OAAUR,EAAA,CAAAS,WAAA,CAAAwF,OAAA,CAAAC,oBAAA,CAAA9F,MAAA,CAA4B;IAAA,EAAC;IAD3CJ,EAAA,CAAAa,YAAA,EAC8C;IAClDb,EAAA,CAAA+C,qBAAA,EAAe;;;;IAjFL/C,EAAA,CAAAoB,SAAA,GAA0D;IAA1DpB,EAAA,CAAAc,UAAA,SAAAqF,MAAA,CAAAjC,WAAA,IAAAiC,MAAA,CAAAC,gBAAA,IAAAD,MAAA,CAAAhE,iBAAA,CAA0D;IAM/CnC,EAAA,CAAAoB,SAAA,GAA+E;IAA/EpB,EAAA,CAAAc,UAAA,UAAAqF,MAAA,CAAAjC,WAAA,KAAAiC,MAAA,CAAAjC,WAAA,CAAAmC,cAAA,KAAAF,MAAA,CAAAG,uBAAA,CAA+E;IAG/EtG,EAAA,CAAAoB,SAAA,GAA6B;IAA7BpB,EAAA,CAAAc,UAAA,SAAAqF,MAAA,CAAAG,uBAAA,CAA6B;IAKbtG,EAAA,CAAAoB,SAAA,GAAmB;IAAnBpB,EAAA,CAAAc,UAAA,YAAAqF,MAAA,CAAAI,gBAAA,CAAmB;IAiE7BvG,EAAA,CAAAoB,SAAA,GAAuE;IAAvEpB,EAAA,CAAAc,UAAA,YAAAqF,MAAA,CAAAjC,WAAA,IAAAiC,MAAA,CAAAjC,WAAA,CAAAsC,MAAA,KAAAL,MAAA,CAAAjC,WAAA,CAAAuC,SAAA,CAAuE,UAAAN,MAAA,CAAAO,WAAA;;;;;;IAOtG1G,EAAA,CAAAC,cAAA,kBAAkG;IAC9ED,EAAA,CAAAE,UAAA,mBAAAyG,gFAAA;MAAA3G,EAAA,CAAAK,aAAA,CAAAuG,IAAA;MAAA,MAAAC,OAAA,GAAA7G,EAAA,CAAAQ,aAAA;MAAA,OAASR,EAAA,CAAAS,WAAA,CAAAoG,OAAA,CAAAC,iBAAA,EAAmB;IAAA,EAAC;IACzC9G,EAAA,CAAAkB,SAAA,mBAA+C;IAC/ClB,EAAA,CAAAC,cAAA,eAAsB;IAAAD,EAAA,CAAAmB,MAAA,GAAuB;IAAAnB,EAAA,CAAAa,YAAA,EAAO;;;;IAFVb,EAAA,CAAAoB,SAAA,GAAqC;IAArCpB,EAAA,CAAAqC,WAAA,eAAA0E,MAAA,CAAAC,iBAAA,CAAqC;IAEzDhH,EAAA,CAAAoB,SAAA,GAAuB;IAAvBpB,EAAA,CAAAqB,iBAAA,CAAA0F,MAAA,CAAAC,iBAAA,CAAuB;;;ADxFzD;;;AAQA,OAAM,MAAOC,2BAA4B,SAAQ5I,qCAAqC;EAkClF6I,YACWC,KAAqB,EACNC,OAAoB,EAC9BC,kBAA2C;IAEvD,KAAK,CAAC,6BAA6B,EAAED,OAAO,EAAEC,kBAAkB,CAAC;IAJ1D,KAAAF,KAAK,GAALA,KAAK;IACU,KAAAC,OAAO,GAAPA,OAAO;IAhCjC,KAAAE,SAAS,GAAG/I,qBAAqB,CAACgJ,SAAS;IAC3C,KAAAC,UAAU,GAAG,OAAO;IAGpB,KAAAjB,gBAAgB,GAAkC,EAAE;IACpD,KAAAG,WAAW,GAAG,KAAK;IACnB,KAAAe,gBAAgB,GAAG,KAAK;IAExB,KAAAlG,mBAAmB,GAAkB,IAAI;IAEzC,KAAAmG,UAAU,GAA6B,EAAE;IACzC,KAAAC,iBAAiB,GAAG,KAAK;IACzB,KAAAC,aAAa,GAAG,KAAK;IACrB,KAAAC,iBAAiB,GAAG,KAAK;IACzB,KAAA3F,6BAA6B,GAAiB;MAC1CoF,SAAS,EAAEnI;KACd;IAES,KAAA2I,wBAAwB,GAAG,+BAA+B;IAC1D,KAAAC,aAAa,GAAGnJ,yBAAyB,CAACoJ,WAAW;IASrD,KAAAC,uBAAuB,GAAG,KAAK,CAAC,CAAC;IASvC,IAAI,CAACC,mBAAmB,GAAG,IAAIrI,iBAAiB,EAAE;EACtD;EAEA,IAAIqE,WAAWA,CAAA;IACX,OAAO,IAAI,CAACgE,mBAAmB,CAACC,KAAK;EACzC;EAEA,IAAIC,KAAKA,CAAA;IAAA,IAAAC,iBAAA;IACL,QAAAA,iBAAA,GAAO,IAAI,CAACnE,WAAW,cAAAmE,iBAAA,uBAAhBA,iBAAA,CAAkBC,SAAS,EAAE,CAACF,KAAK;EAC9C;EAEA,IAAIjG,iBAAiBA,CAAA;IAAA,IAAAoG,qBAAA,EAAAC,kBAAA;IACjB,QAAAD,qBAAA,IAAAC,kBAAA,GAAO,IAAI,CAACtE,WAAW,cAAAsE,kBAAA,uBAAhBA,kBAAA,CAAkBF,SAAS,EAAE,CAACnG,iBAAiB,cAAAoG,qBAAA,cAAAA,qBAAA,GAAIE,SAAS;EACvE;EAEA,IAAIC,mBAAmBA,CAAA;IAAA,IAAAC,sBAAA,EAAAC,kBAAA;IACnB,QAAAD,sBAAA,IAAAC,kBAAA,GAAO,IAAI,CAAC1E,WAAW,cAAA0E,kBAAA,uBAAhBA,kBAAA,CAAkBN,SAAS,EAAE,CAACI,mBAAmB,cAAAC,sBAAA,cAAAA,sBAAA,GAAI,KAAK;EACrE;EAEA,IAAIjI,OAAOA,CAAA;IAAA,IAAAmI,sBAAA,EAAAC,kBAAA;IACP,QAAAD,sBAAA,IAAAC,kBAAA,GAAO,IAAI,CAAC5E,WAAW,cAAA4E,kBAAA,uBAAhBA,kBAAA,CAAkBR,SAAS,EAAE,CAAC5H,OAAO,cAAAmI,sBAAA,cAAAA,sBAAA,GAAI,CAAC;EACrD;EAEA,IAAInI,OAAOA,CAACyH,KAAa;IACrB,IAAI,IAAI,CAACjE,WAAW,EAAE;MAClB,IAAI,CAACA,WAAW,CAACoE,SAAS,EAAE,CAAC5H,OAAO,GAAGyH,KAAK;;EAEpD;EAEA,IAAInH,SAASA,CAAA;IAAA,IAAA+H,kBAAA;IACT,QAAAA,kBAAA,GAAO,IAAI,CAAC7E,WAAW,cAAA6E,kBAAA,uBAAhBA,kBAAA,CAAkBT,SAAS,EAAE,CAACtH,SAAS;EAClD;EAEA,IAAIgI,UAAUA,CAAA;IAAA,IAAAC,kBAAA;IACV,OAAO,CAAC,GAAAA,kBAAA,GAAE,IAAI,CAAC/E,WAAW,cAAA+E,kBAAA,eAAhBA,kBAAA,CAAkBX,SAAS,EAAE,CAACU,UAAU,CAAC;EACvD;EAEA,IAAIxD,MAAMA,CAAA;IAAA,IAAA0D,kBAAA;IACN,OAAO,CAAC,EAAE,IAAI,CAACrB,iBAAiB,KAAAqB,kBAAA,GAAI,IAAI,CAAChF,WAAW,cAAAgF,kBAAA,gBAAAA,kBAAA,GAAhBA,kBAAA,CAAkBZ,SAAS,EAAE,CAACa,mBAAmB,cAAAD,kBAAA,eAAjDA,kBAAA,CAAmDE,iBAAiB,CAAC;EAC7G;EAEA,IAAIC,uBAAuBA,CAAA;IAAA,IAAAC,kBAAA;IACvB,OAAO,CAAC,EAAE,IAAI,CAAClB,KAAK,IAAI,IAAI,CAACX,gBAAgB,KAAA6B,kBAAA,GAAI,IAAI,CAACpF,WAAW,cAAAoF,kBAAA,eAAhBA,kBAAA,CAAkBhB,SAAS,EAAE,CAACe,uBAAuB,CAAC;EAC3G;EAEA,IAAI/C,uBAAuBA,CAAA;IAAA,IAAAiD,kBAAA;IACvB,OAAO,CAAC,GAAAA,kBAAA,GAAC,IAAI,CAACrF,WAAW,cAAAqF,kBAAA,eAAhBA,kBAAA,CAAkBjB,SAAS,EAAE,CAAChC,uBAAuB;EAClE;EAEA;;;;;;EAMAhB,kBAAkBA,CAACkE,UAAuC;IAAA,IAAAC,mBAAA;IACtD,OAAO,CAAC,GAAAA,mBAAA,GAAC,IAAI,CAACvF,WAAW,cAAAuF,mBAAA,eAAhBA,mBAAA,CAAkBnB,SAAS,EAAE,CAAChD,kBAAkB,CAACkE,UAAU,CAAC;EACzE;EAEA;;;;;;EAMAjE,mBAAmBA,CAACiE,UAAuC;IAAA,IAAAE,mBAAA;IACvD,OAAO,CAAC,GAAAA,mBAAA,GAAC,IAAI,CAACxF,WAAW,cAAAwF,mBAAA,eAAhBA,mBAAA,CAAkBpB,SAAS,EAAE,CAAC/C,mBAAmB,CAACiE,UAAU,CAAC;EAC1E;EAEA;;;EAGMG,QAAQA,CAAA;IAAA,IAAAC,sBAAA,GAAAA,CAAA,WAAAD,QAAA;MAAAE,KAAA;IAAA,OAAAC,iBAAA;MACVD,KAAI,CAAC7C,iBAAiB,GAAGvI,SAAS,CAACsL,OAAO,CAAC,mCAAmC,CAAC;MAC/EF,KAAI,CAACzD,gBAAgB,GAAG9H,aAAa,CAAC0L,gCAAgC,EAAE;MACxEH,KAAI,CAACnC,UAAU,GAAGpJ,aAAa,CAAC2L,sBAAsB,EAAE;MACxDJ,KAAI,CAAChC,iBAAiB,GAAGvJ,aAAa,CAAC4L,6BAA6B,EAAE;MAEtEL,KAAI,CAAC3H,6BAA6B,CAACiI,cAAc,GAAG;QAChDzC,UAAU,EAAEmC,KAAI,CAACnC;OACpB;MAED,MAAMkC,sBAAA,GAAAQ,IAAA,CAAAP,KAAc,CAAE;MAEtB;MACA,MAAMQ,MAAM,GAAGzK,oCAAoC,CAAC0K,iBAAiB,CACjE5K,8BAA8B,EAC9B,CAACmK,KAAI,CAAC5I,QAAQ,EAAE4I,KAAI,CAAC1E,MAAM,CAACC,EAAE,EAAEyE,KAAI,CAACxC,kBAAkB,GAAG,GAAG/H,iCAAiC,CAACiL,SAAS,GAAG,GAAG,EAAE,CAAC,CACpH;MAEDV,KAAI,CAACW,iBAAiB,GAAGH,MAAM,CAACI,WAAW,CAAC;QACxCC,cAAc;UAAA,IAAAC,IAAA,GAAAb,iBAAA,CAAE,WAAM5F,WAAW,EAAG;YAChC2F,KAAI,CAACtD,gBAAgB,GAAGrC,WAAW,CAAC0G,MAAM,CAACpB,UAAU,IAAI,CAACa,MAAM,CAACQ,mBAAmB,CAACrB,UAAU,CAAC,CAAC;YACjGK,KAAI,CAACiB,UAAU,GAAG5G,WAAW,CAAC6G,IAAI,CAACvB,UAAU,IAAIa,MAAM,CAAC9E,mBAAmB,CAACiE,UAAU,CAAC,CAAC;YAExF,IAAI,CAACK,KAAI,CAACzB,KAAK,EAAE;cACb;;YAGJ;YACA,MAAM0C,UAAU,SAAStM,oBAAoB,CAACwM,eAAe,CAACnB,KAAI,CAACzB,KAAK,CAAChD,EAAE,CAAC;YAE5EyE,KAAI,CAACiB,UAAU,GAAGjB,KAAI,CAACiB,UAAU,IAAIA,UAAU,IAAIjB,KAAI,CAAClC,iBAAiB;YAEzE,IAAImD,UAAU,EAAE;cACZ;cACA,MAAMG,QAAQ,GAAG/G,WAAW,CAACgH,GAAG;gBAAA,IAAAC,KAAA,GAAArB,iBAAA,CAAC,WAAON,UAAU,EAAI;kBAAA,IAAA4B,mBAAA;kBAClD,IAAI,GAAAA,mBAAA,GAACvB,KAAI,CAAC3F,WAAW,cAAAkH,mBAAA,eAAhBA,mBAAA,CAAkB9C,SAAS,EAAE,CAAChD,kBAAkB,CAACkE,UAAU,CAAC,GAAE;oBAC/D;;kBAGJ;kBACA,MAAM6B,OAAO,SAAS7M,oBAAoB,CAAC8M,oBAAoB,CAAC9B,UAAU,CAACA,UAAU,CAAC;kBAEtFA,UAAU,CAAChG,UAAU,GAAG+H,MAAM,CAAC/B,UAAU,CAAChG,UAAU,CAAC,GAAG6H,OAAO,CAACG,MAAM;gBAC1E,CAAC;gBAAA,iBAAAC,GAAA;kBAAA,OAAAN,KAAA,CAAAO,KAAA,OAAAC,SAAA;gBAAA;cAAA,IAAC;cAEF,MAAMC,OAAO,CAACC,GAAG,CAACZ,QAAQ,CAAC;;UAEnC,CAAC;UAAA,gBAAAP,eAAAoB,EAAA;YAAA,OAAAnB,IAAA,CAAAe,KAAA,OAAAC,SAAA;UAAA;QAAA;QACDI,OAAO,EAAEA,CAAA,KAAK;UACVlC,KAAI,CAACtD,gBAAgB,GAAG,EAAE;QAC9B;OACH,CAAC;MAEFsD,KAAI,CAAC3B,mBAAmB,CAAC8D,OAAO,CAAC,IAAIC,+BAA+B,CAAC5B,MAAM,EAAER,KAAI,CAAC,CAAC;MAEnF;MACAA,KAAI,CAACqC,kBAAkB,GAAGvN,UAAU,CAACwN,EAAE,CAACvN,yBAAyB,CAACwN,aAAa,EAAGC,IAAI,IAAI;QACtFxC,KAAI,CAACyC,qBAAqB,CAACD,IAAI,CAAC;MACpC,CAAC,EAAExC,KAAI,CAAC0C,MAAM,CAAC;MAEf;MACA1C,KAAI,CAAC2C,eAAe,GAAG7N,UAAU,CAACwN,EAAE,CAChC5N,qBAAqB,CAACkO,oBAAoB,EACzCJ,IAAI,IAAKxC,KAAI,CAAC6C,aAAa,CAAC,IAAI,EAAEL,IAAI,CAAC,CAC3C;MACDxC,KAAI,CAAC8C,aAAa,GAAGhO,UAAU,CAACwN,EAAE,CAC9B5N,qBAAqB,CAACqO,sBAAsB,EAC3CP,IAAI,IAAKxC,KAAI,CAAC6C,aAAa,CAAC,KAAK,EAAEL,IAAI,CAAC,CAC5C;MACDxC,KAAI,CAACgD,kBAAkB,GAAGlO,UAAU,CAACwN,EAAE,CAAC5N,qBAAqB,CAACuO,uBAAuB,EAAET,IAAI,IAAG;QAC1F,IAAI,CAACxC,KAAI,CAACzB,KAAK,EAAE;UACb;;QAGJ,IAAIyB,KAAI,CAACzB,KAAK,CAAChD,EAAE,KAAKiH,IAAI,CAACU,OAAO,IAAIV,IAAI,CAACW,IAAI,KAAKnD,KAAI,CAAC1E,MAAM,CAACC,EAAE,EAAE;UAChE9G,aAAa,CAAC2O,yBAAyB,CAACpD,KAAI,CAACzB,KAAK,CAAChD,EAAE,CAAC,CAAC8H,OAAO,CAAC,MAAK;YAChE,IAAIb,IAAI,CAACc,YAAY,EAAE;cAAA,IAAAC,mBAAA;cACnB;cACA,MAAM5D,UAAU,IAAA4D,mBAAA,GAAGvD,KAAI,CAAC3F,WAAW,cAAAkJ,mBAAA,uBAAhBA,mBAAA,CAAkBC,KAAK,CAACC,IAAI,CAC3CC,IAAI;gBAAA,IAAAC,mBAAA;gBAAA,OAAI,EAAAA,mBAAA,GAAA3D,KAAI,CAAC3F,WAAW,cAAAsJ,mBAAA,uBAAhBA,mBAAA,CAAkBlF,SAAS,EAAE,CAAChD,kBAAkB,CAACiI,IAAI,CAAC,KAAIlB,IAAI,CAACc,YAAY,IAAII,IAAI,CAAC/D,UAAU;cAAA,EAC9E;cAE5B,IAAIA,UAAU,EAAE;gBACZ,IAAI6C,IAAI,CAAChH,MAAM,KAAKoD,SAAS,EAAE;kBAC3Be,UAAU,CAACnE,MAAM,GAAGgH,IAAI,CAAChH,MAAM;;gBAEnC,IAAIgH,IAAI,CAACrH,MAAM,KAAKyD,SAAS,EAAE;kBAC3Be,UAAU,CAACxE,MAAM,GAAGqH,IAAI,CAACrH,MAAM;;gBAEnC,IAAIqH,IAAI,CAACpH,OAAO,KAAKwD,SAAS,EAAE;kBAC5Be,UAAU,CAACvE,OAAO,GAAGoH,IAAI,CAACpH,OAAO;;gBAGrC4E,KAAI,CAAC4D,qBAAqB,CAAC,KAAK,CAAC;;;YAIzC,IAAIpB,IAAI,CAACqB,OAAO,KAAKjF,SAAS,IAAI4D,IAAI,CAACqB,OAAO,EAAE;cAAA,IAAAC,UAAA;cAC5C,IAAI,EAAAA,UAAA,GAAAtB,IAAI,CAACuB,IAAI,cAAAD,UAAA,uBAATA,UAAA,CAAWE,QAAQ,KAAI,CAAC,IAAIzO,UAAU,CAAC0O,QAAQ,IAAIjE,KAAI,CAAC3F,WAAW,IAAI,CAAC2F,KAAI,CAAC3F,WAAW,CAAC6J,KAAK,EAAE;gBAChG;gBACAlE,KAAI,CAAC3F,WAAW,CAACC,MAAM,CAAC0F,KAAI,CAAC3F,WAAW,CAAC,CAAC,CAAC,CAAC;;cAGhD2F,KAAI,CAAC4D,qBAAqB,CAAC,KAAK,CAAC;;UAEzC,CAAC,CAAC;;MAEV,CAAC,CAAC;MAEF;MACA5D,KAAI,CAACmE,qBAAqB,GAAGrP,UAAU,CAACwN,EAAE,CAAC5M,kBAAkB,CAAC0O,kBAAkB,EAAG5B,IAAI,IAAI;QACvF,IAAIxC,KAAI,CAACzB,KAAK,IAAIiE,IAAI,CAAC/E,SAAS,IAAI,WAAW,IAAI+E,IAAI,CAAC6B,UAAU,IAAI,MAAM,IACpE7B,IAAI,CAAC8B,YAAY,0CAA2B9B,IAAI,CAAC+B,UAAU,IAAIvE,KAAI,CAACzB,KAAK,CAACiG,IAAI,EAAE;UACpFxE,KAAI,CAAClC,iBAAiB,GAAG,IAAI;UAC7BkC,KAAI,CAACiB,UAAU,GAAG,IAAI;;MAE9B,CAAC,CAAC;MAEFjB,KAAI,CAACyE,kBAAkB,GAAG3P,UAAU,CAACwN,EAAE,CAAC3M,sBAAsB,CAAC+O,YAAY;QAAA,IAAAC,KAAA,GAAA1E,iBAAA,CAAE,WAAOuC,IAAI,EAAI;UACxF,IAAIxC,KAAI,CAACzB,KAAK,IAAIiE,IAAI,CAAC/E,SAAS,IAAI,WAAW,IAAI+E,IAAI,CAAC6B,UAAU,IAAI,MAAM,IACpE7B,IAAI,CAAC8B,YAAY,0CAA2B9B,IAAI,CAAC+B,UAAU,IAAIvE,KAAI,CAACzB,KAAK,CAACiG,IAAI,EAAE;YACpFxE,KAAI,CAAClC,iBAAiB,SACZlI,iBAAiB,CAACgP,UAAU,CAAC,WAAW,EAAE,MAAM,sCAAuB5E,KAAI,CAACzB,KAAK,CAACiG,IAAI,CAAC;YACjGxE,KAAI,CAACiB,UAAU,GAAGjB,KAAI,CAACiB,UAAU,IAAIjB,KAAI,CAAClC,iBAAiB;;QAEnE,CAAC;QAAA,iBAAA+G,GAAA;UAAA,OAAAF,KAAA,CAAA9C,KAAA,OAAAC,SAAA;QAAA;MAAA,IAAC;IAAC;EACP;EAEMgD,eAAeA,CAAA;IAAA,IAAAC,MAAA;IAAA,OAAA9E,iBAAA;MACjB,MAAM8E,MAAI,CAACC,WAAW,CAAC,KAAK,EAAE,IAAI,CAAC;MAEnC,MAAM3K,WAAW,SAAS0K,MAAI,CAAC1G,mBAAmB;MAElDhE,WAAW,CAAC4K,KAAK,CAACF,MAAI,CAACG,SAAS,CAAC;IAAC;EACtC;EAEA;;;EAGAC,WAAWA,CAAA;IAAA,IAAAC,mBAAA;IACP,KAAK,CAACD,WAAW,EAAE;IAEnB,IAAI,CAAC9C,kBAAkB,IAAI,IAAI,CAACA,kBAAkB,CAACgD,GAAG,EAAE;IACxD,IAAI,CAAC1C,eAAe,IAAI,IAAI,CAACA,eAAe,CAAC0C,GAAG,EAAE;IAClD,IAAI,CAACvC,aAAa,IAAI,IAAI,CAACA,aAAa,CAACuC,GAAG,EAAE;IAC9C,IAAI,CAACC,gBAAgB,IAAI,IAAI,CAACA,gBAAgB,CAACD,GAAG,EAAE;IACpD,IAAI,CAACrC,kBAAkB,IAAI,IAAI,CAACA,kBAAkB,CAACqC,GAAG,EAAE;IACxD,IAAI,CAAClB,qBAAqB,IAAI,IAAI,CAACA,qBAAqB,CAACkB,GAAG,EAAE;IAC9D,IAAI,CAACZ,kBAAkB,IAAI,IAAI,CAACA,kBAAkB,CAACY,GAAG,EAAE;IACxD,IAAI,CAAC1E,iBAAiB,IAAI,IAAI,CAACA,iBAAiB,EAAE;IAClD,CAAAyE,mBAAA,OAAI,CAAC/K,WAAW,cAAA+K,mBAAA,eAAhBA,mBAAA,CAAkBG,OAAO,EAAE;EAC/B;EAEA;;;EAGMC,UAAUA,CAAA;IAAA,IAAAC,MAAA;IAAA,OAAAxF,iBAAA;MACZ,IAAI,CAACwF,MAAI,CAAClH,KAAK,EAAE;QACb;;MAGJ,MAAMtI,aAAa,CAACyP,kBAAkB,CAACxP,sBAAsB,EAAE;QAC3DyP,MAAM,EAAE;UACJvO,QAAQ,EAAEqO,MAAI,CAACrO,QAAQ;UACvB8L,OAAO,EAAEuC,MAAI,CAAClH,KAAK,CAAChD;;OAE3B,CAAC;IAAC;EACP;EAEA;;;EAGgBqK,YAAYA,CAACC,OAAO,GAAG,KAAK,EAAEC,IAAI,GAAG,KAAK,EAAEC,UAAU,GAAG,KAAK;IAAA,IAAAC,MAAA;IAAA,OAAA/F,iBAAA;MAC1E+F,MAAI,CAACnJ,WAAW,GAAG,KAAK;MAExB,IAAI;QACA,MAAMkF,OAAO,CAACC,GAAG,CAAC,CACdgE,MAAI,CAACC,UAAU,CAACH,IAAI,EAAEC,UAAU,CAAC,EACjCC,MAAI,CAACE,wBAAwB,EAAE,CAClC,CAAC;QAEF,IAAI,CAACF,MAAI,CAACzH,KAAK,EAAE;UACb;;QAGJ,MAAMlE,WAAW,SAAS2L,MAAI,CAAC3H,mBAAmB;QAElD,MAAM0D,OAAO,CAACC,GAAG,CAAC,CACd6D,OAAO,GAAGxL,WAAW,CAAC8L,MAAM,EAAE,GAAG9L,WAAW,CAAC+L,IAAI,EAAE,EACnDxQ,iBAAiB,CAACgP,UAAU,CAAC,WAAW,EAAE,MAAM,sCAAuBoB,MAAI,CAACzH,KAAK,CAACiG,IAAI,CAAC,CAAC6B,IAAI,CAAEzB,UAAU,IAAI;UACxGoB,MAAI,CAAClI,iBAAiB,GAAG8G,UAAU;UAEnC;QACJ,CAAC,CAAC,CACL,CAAC;OACL,CAAC,OAAO0B,KAAK,EAAE;QACZN,MAAI,CAACnJ,WAAW,GAAG,IAAI,CAAC,CAAC;QAEzB,MAAMyJ,KAAK,CAAC,CAAC;;IAChB;EACL;;EAEcL,UAAUA,CAACH,IAAA,GAAgB,KAAK,EAAEC,UAAA,GAAsB,KAAK;IAAA,IAAAQ,MAAA;IAAA,OAAAtG,iBAAA;MAAA,IAAAuG,qBAAA;MACvE,IAAI,CAACD,MAAI,CAACnP,QAAQ,IAAI,CAACmP,MAAI,CAACjL,MAAM,EAAE;QAChC;;MAGJ,MAAMjB,WAAW,SAASkM,MAAI,CAAClI,mBAAmB;MAElD,MAAMhE,WAAW,CAACoE,SAAS,EAAE,CAACgI,SAAS,EAAE;MAEzC,IAAI,CAACF,MAAI,CAAChI,KAAK,EAAE;QACb;;MAGJ,MAAMA,KAAK,GAAGgI,MAAI,CAAChI,KAAK;MACxB,MAAMmI,kBAAkB,GAAG,GAAAF,qBAAA,GAACxR,SAAS,CAAC2R,cAAc,EAAE,cAAAH,qBAAA,eAA1BA,qBAAA,CAA4BI,yBAAyB,CAAC,MAAM,CAAC;MACzFL,MAAI,CAACM,WAAW,GAAGtI,KAAK,CAACuI,KAAK,IAAIP,MAAI,CAACM,WAAW;MAClDN,MAAI,CAAC7O,mBAAmB,GAAG7C,mBAAmB,CAACkS,sBAAsB,CAACxI,KAAK,EAAEmI,kBAAkB,CAAC;MAChGH,MAAI,CAACS,eAAe,GAAGpS,SAAS,CAACsL,OAAO,CAAC,gCAAgC,EAAE;QACvE+G,cAAc,EAAE1I,KAAK,CAAC0I;OACzB,CAAC;MAEFV,MAAI,CAACW,aAAa,CAACC,IAAI,CAAC5I,KAAK,CAAC;MAE9B,QAAQA,KAAK,CAAC6I,IAAI;QACd,KAAK,MAAM;QACX,KAAK,MAAM;UACPb,MAAI,CAACpJ,iBAAiB,GAAGvI,SAAS,CAACsL,OAAO,CAAC,8BAA8B,CAAC;UAC1E;QACJ,KAAK,OAAO;UACRqG,MAAI,CAACpJ,iBAAiB,GAAGvI,SAAS,CAACsL,OAAO,CAAC,iCAAiC,CAAC;UAC7E;QACJ;UACIqG,MAAI,CAACpJ,iBAAiB,GAAGvI,SAAS,CAACsL,OAAO,CAAC,mCAAmC,CAAC;;MAGvF,IAAI4F,IAAI,EAAE;QACN;QACA,MAAMuB,OAAO,SAASd,MAAI,CAACe,YAAY,CAACvB,UAAU,CAAC;QAEnD,IAAIsB,OAAO,EAAE;UACT;UACAvS,UAAU,CAACyS,OAAO,CAACxS,yBAAyB,CAACwN,aAAa,EAAE;YACxDW,OAAO,EAAE3E,KAAK,CAAChD,EAAE;YACjBiM,MAAM,EAAExS,SAAS,CAACyS,oBAAoB,EAAE;YACxCjH,MAAM,EAAE;WACX,EAAExL,SAAS,CAAC0S,gBAAgB,EAAE,CAAC;;;MAIxC,MAAMtG,QAAQ,GAAoB,EAAE;MAEpC;MACAA,QAAQ,CAACuG,IAAI,CAACtN,WAAW,CAACoE,SAAS,EAAE,CAACmJ,aAAa,CAACrJ,KAAK,CAAChD,EAAE,CAAC,CAAC;MAE9D6F,QAAQ,CAACuG,IAAI,CACTlT,aAAa,CACRoT,oBAAoB,CAACtJ,KAAK,CAAChD,EAAE,EAAE;QAAE4H,IAAI,EAAEoD,MAAI,CAACjL,MAAM,CAACC;MAAE,CAAE,CAAC,CACxD8K,IAAI;QAAA,IAAAyB,KAAA,GAAA7H,iBAAA,CAAC,WAAM8H,UAAU,EAAG;UACrB;UACA;UACA;UACA,MAAMC,iBAAiB,GAAGnT,mBAAmB,CAACoT,mBAAmB,CAAC1J,KAAK,CAAC,IACrD,CAACwJ,UAAU,CAACG,oBAAoB;UACnD3B,MAAI,CAAC3I,gBAAgB,GAAG,CAAC,CAACW,KAAK,CAAC4J,oBAAoB,IAAI,CAACH,iBAAiB;UAC1EzB,MAAI,CAACxI,aAAa,GAAGQ,KAAK,CAAC6I,IAAI,KAAK,OAAO,IAAI,CAACW,UAAU,CAACK,0BAA0B;UAErF;QACJ,CAAC;QAAA,iBAAAC,GAAA;UAAA,OAAAP,KAAA,CAAAjG,KAAA,OAAAC,SAAA;QAAA;MAAA,IAAC,CACT;MAED,MAAMC,OAAO,CAACC,GAAG,CAACZ,QAAQ,CAAC;IAAC;EAChC;EAEA;;;;;;EAMM/E,oBAAoBA,CAACiM,QAAoB;IAAA,IAAAC,MAAA;IAAA,OAAAtI,iBAAA;MAC3C,MAAM5F,WAAW,SAASkO,MAAI,CAAClK,mBAAmB;MAElD,IAAI;QACAkK,MAAI,CAAC1L,WAAW,GAAG,KAAK;QAExB,MAAMxC,WAAW,CAAC+L,IAAI,EAAE;OAC3B,CAAC,OAAOE,KAAK,EAAE;QACZpR,YAAY,CAACsT,qBAAqB,CAAClC,KAAK,EAAE,+BAA+B,EAAE,IAAI,CAAC;QAEhFiC,MAAI,CAAC1L,WAAW,GAAG,IAAI;OAC1B,SAAS;QACNyL,QAAQ,EAAE;;IACb;EACL;EAEA;;;;;EAKgBpC,wBAAwBA,CAAA;IAAA,IAAAuC,MAAA;IAAA,OAAAxI,iBAAA;MACpC,MAAM5F,WAAW,SAASoO,MAAI,CAACpK,mBAAmB;MAClD,MAAMqK,aAAa,SAASjU,aAAa,CAACkU,oBAAoB,EAAE;MAEhEtO,WAAW,CAACoE,SAAS,EAAE,CAACnG,iBAAiB,GAAGoQ,aAAa;MAEzD,IAAID,MAAI,CAACpQ,6BAA6B,CAACiI,cAAc,EAAE;QACnDmI,MAAI,CAACpQ,6BAA6B,CAACiI,cAAc,CAACsI,QAAQ,GAAGF,aAAa,CAACpK,KAAK;;IACnF;EACL;EAEA;;;;;EAKgBuK,iBAAiBA,CAAA;IAAA,IAAAC,MAAA;IAAA,OAAA7I,iBAAA;MAC7B,MAAMmB,QAAQ,GAAoB,EAAE;MAEpC,IAAI0H,MAAI,CAACzO,WAAW,EAAE;QAClB+G,QAAQ,CAACuG,IAAI,CAACmB,MAAI,CAACzO,WAAW,CAACoE,SAAS,EAAE,CAACsK,eAAe,EAAE,CAAC;;MAGjE,IAAID,MAAI,CAACvK,KAAK,EAAE;QACZ6C,QAAQ,CAACuG,IAAI,CAAClT,aAAa,CAACuU,2BAA2B,CAACF,MAAI,CAACvK,KAAK,CAAChD,EAAE,CAAC,CAAC;;MAG3E,IAAIuN,MAAI,CAACvM,gBAAgB,EAAE;QACvB6E,QAAQ,CAACuG,IAAI,CAAC1S,QAAQ,CAACgU,wBAAwB,CAACvU,qBAAqB,CAACwU,oBAAoB,CAAC,CAAC;;MAGhG,MAAMnH,OAAO,CAACC,GAAG,CAACZ,QAAQ,CAAC;IAAC;EAChC;EAEA;;;EAGU0E,IAAIA,CAAA;IACV,OAAOtQ,4BAA4B,CAACsQ,IAAI,CAAC,IAAI,CAACxK,MAAM,EAAE,IAAI,CAAClE,QAAQ,CAAC;EACxE;EAEA;;;;;;EAMU+R,mBAAmBA,CAACC,aAAsE;IAChG,OAAO,CAAC,CAAC,IAAI,CAAC7K,KAAK,KACX,EAAE,QAAQ,IAAI6K,aAAa,CAAC,IAAIA,aAAa,CAAC5I,MAAM,IAAI,OAAO,CAAC,IACjE4I,aAAa,CAAClG,OAAO,IAAI,IAAI,CAAC3E,KAAK,CAAChD,EAAE,IACtC6N,aAAa,CAAC5B,MAAM,IAAIxS,SAAS,CAACyS,oBAAoB,EAAE;EACnE;EAEA;;;;;;EAMgB5E,aAAaA,CACzBwG,eAAwB,EACxB7G,IAAuE;IAAA,IAAA8G,MAAA;IAAA,OAAArJ,iBAAA;MAEvE,IAAI,CAAC,CAACqJ,MAAI,CAAC/K,KAAK,IAAI+K,MAAI,CAAC/K,KAAK,CAAChD,EAAE,KAAKiH,IAAI,CAACU,OAAO,KAAKV,IAAI,CAACW,IAAI,KAAKmG,MAAI,CAAChO,MAAM,CAACC,EAAE,EAAE;QACjF,OAAO,CAAC;;MAGZ;MACA+N,MAAI,CAACC,eAAe,EAAE;MAEtB,IAAI;QACA,IAAIF,eAAe,EAAE;UACjBnU,YAAY,CAACsU,SAAS,CAAC,kCAAkC,EAAE,IAAI,CAAC;UAEhE,MAAMC,cAAc,GAAIjH,IAAuC,CAAC3L,OAAO;UAEvE,IAAI,CAAC4S,cAAc,IAAIA,cAAc,GAAG,CAAC,IAAI,CAACH,MAAI,CAACzS,OAAO,IAAI4S,cAAc,KAAKH,MAAI,CAACzS,OAAO,EAAE;YAC3F,MAAMyS,MAAI,CAAC1F,qBAAqB,CAAC,KAAK,CAAC;WAC1C,MAAM;YAAA,IAAA8F,kBAAA;YACH;YACA,OAAAA,kBAAA,GAAMJ,MAAI,CAACjP,WAAW,cAAAqP,kBAAA,uBAAhBA,kBAAA,CAAkBjL,SAAS,EAAE,CAACkL,cAAc,EAAE;;SAE3D,MAAM;UACH,MAAML,MAAI,CAAC1F,qBAAqB,CAAC,KAAK,CAAC;;OAE9C,SAAS;QACN;QACA,IAAIyF,eAAe,IAAI9T,UAAU,CAAC0O,QAAQ,IAAIqF,MAAI,CAACjP,WAAW,EAAE;UAC5D,MAAMuP,iBAAiB,GAAGpH,IAAsC;UAChE,MAAM7C,UAAU,GAAG2J,MAAI,CAACjP,WAAW,CAACmJ,KAAK,CAACC,IAAI,CAACC,IAAI,IAAG;YAAA,IAAAmG,mBAAA,EAAAC,mBAAA;YAClD,KAAAD,mBAAA,GAAIP,MAAI,CAACjP,WAAW,cAAAwP,mBAAA,eAAhBA,mBAAA,CAAkBpL,SAAS,EAAE,CAAC/C,mBAAmB,CAACgI,IAAI,CAAC,EAAE;cACzD,OAAOA,IAAI,CAACqG,WAAW,KAAKH,iBAAiB,CAACI,eAAe;;YAGjE,KAAAF,mBAAA,GAAIR,MAAI,CAACjP,WAAW,cAAAyP,mBAAA,eAAhBA,mBAAA,CAAkBrL,SAAS,EAAE,CAAChD,kBAAkB,CAACiI,IAAI,CAAC,EAAE;cAAA,IAAAuG,qBAAA;cACxD,OAAO,EAAAA,qBAAA,GAACL,iBAAiB,CAACM,aAAa,cAAAD,qBAAA,cAAAA,qBAAA,GAAI,EAAE,EAAEE,QAAQ,CAACzG,IAAI,CAAC/D,UAAU,CAAC;;YAG5E,OAAO,KAAK;UAChB,CAAC,CAAC;UAEF2J,MAAI,CAACjP,WAAW,CAACC,MAAM,CAACqF,UAAU,aAAVA,UAAU,cAAVA,UAAU,GAAI,IAAI,CAAC;;;IAElD;EAEL;EAEA;;;EAGA1C,iBAAiBA,CAAA;IAAA,IAAAmN,mBAAA;IACb,CAAAA,mBAAA,OAAI,CAAC/P,WAAW,cAAA+P,mBAAA,eAAhBA,mBAAA,CAAkB9P,MAAM,CAACzE,8BAA8B,CAACwU,cAAc,CAAC;EAC3E;EAEA;;;;;EAKMlS,YAAYA,CAACmS,SAAiC;IAAA,IAAAC,OAAA;IAAA,OAAAtK,iBAAA;MAAA,IAAAuK,qBAAA;MAChD,IAAID,OAAI,CAAClQ,WAAW,IAAIiQ,SAAS,CAAChM,KAAK,MAAAkM,qBAAA,GAAID,OAAI,CAAClQ,WAAW,CAACoE,SAAS,EAAE,CAACnG,iBAAiB,cAAAkS,qBAAA,uBAA9CA,qBAAA,CAAgDlM,KAAK,GAAE;QAC9FiM,OAAI,CAAClQ,WAAW,CAACoE,SAAS,EAAE,CAACnG,iBAAiB,GAAGgS,SAAS;QAC1DC,OAAI,CAAClQ,WAAW,CAACoE,SAAS,EAAE,CAACgM,QAAQ,CAAC,IAAI,CAAC;QAE3C,IAAIF,OAAI,CAAClS,6BAA6B,CAACiI,cAAc,EAAE;UACnDiK,OAAI,CAAClS,6BAA6B,CAACiI,cAAc,CAACsI,QAAQ,GAAG0B,SAAS,CAAChM,KAAK;;QAGhF,IAAI;UACA,MAAMrJ,QAAQ,CAACyV,iBAAiB,CAAChW,qBAAqB,CAACwU,oBAAoB,EAAEoB,SAAS,CAAChM,KAAK,CAACqM,OAAO,CAAC,CAAC,CAAC,CAAC;UACxG,MAAMJ,OAAI,CAACK,mBAAmB,EAAE;SACnC,CAAC,OAAOtE,KAAK,EAAE;UACZpR,YAAY,CAACsT,qBAAqB,CAAClC,KAAK,EAAE,4BAA4B,CAAC;;;IAE9E;EACL;EAEA;;;EAGMuE,qBAAqBA,CAAA;IAAA,IAAAC,OAAA;IAAA,OAAA7K,iBAAA;MACvB,MAAM8K,SAAS,SAAS7V,YAAY,CAAC8V,SAAS,CAAyBF,OAAI,CAACzS,6BAA6B,CAAC;MAE1G,IAAI0S,SAAS,EAAE;QACXD,OAAI,CAAC3S,YAAY,CAAC4S,SAAS,CAAC;;IAC/B;EACL;EAEA;;;;;;EAMM/Q,eAAeA,CAACiR,KAAY,EAAEtL,UAAmC;IAAA,IAAAuL,OAAA;IAAA,OAAAjL,iBAAA;MACnE,IAAI,CAACiL,OAAI,CAAC3M,KAAK,EAAE;QACb;;MAGJ0M,KAAK,CAACE,cAAc,EAAE;MACtBF,KAAK,CAACG,eAAe,EAAE;MAEvB,MAAMC,WAAW,SAASnW,YAAY,CAACoW,WAAW,CAAsC;QACpF7N,SAAS,EAAEpI,2CAA2C;QACtDiL,cAAc,EAAE;UACZX,UAAU;UACVuD,OAAO,EAAEgI,OAAI,CAAC3M,KAAK,CAAChD,EAAE;UACtB4H,IAAI,EAAE+H,OAAI,CAAC5P,MAAM,CAACC;SACrB;QACD0P;OACH,CAAC;MAEF,IAAII,WAAW,IAAIA,WAAW,CAACE,MAAM,EAAE;QACnC,QAAQF,WAAW,CAACE,MAAM;UACtB,KAAK,MAAM;YACP5L,UAAU,CAACnE,MAAM,GAAG6P,WAAW,CAAC/M,KAAK;YACrC;UACJ,KAAK,KAAK;YACNqB,UAAU,CAACxE,MAAM,GAAGkQ,WAAW,CAAC/M,KAAK;YACrC;UACJ,KAAK,MAAM;YACPqB,UAAU,CAACvE,OAAO,GAAGiQ,WAAW,CAAC/M,KAAK;YACtC;UACJ;YACI;;;IAEX;EACL;EAEA;;;EAGMvH,YAAYA,CAAA;IAAA,IAAAyU,OAAA;IAAA,OAAAvL,iBAAA;MACd,MAAMwL,KAAK,SAASvW,YAAY,CAACwW,gBAAgB,EAAE;MAEnD,IAAI;QAAA,IAAAC,mBAAA,EAAAC,oBAAA;QACA,MAAM7J,OAAO,CAACC,GAAG,CAAC,EAAA2J,mBAAA,GACdH,OAAI,CAACnR,WAAW,cAAAsR,mBAAA,uBAAhBA,mBAAA,CAAkBlN,SAAS,EAAE,CAACoN,qBAAqB,EAAE,GAAAD,oBAAA,GACrDJ,OAAI,CAACnR,WAAW,cAAAuR,oBAAA,uBAAhBA,oBAAA,CAAkBzF,MAAM,EAAE,CAC7B,CAAC;OACL,CAAC,OAAOG,KAAK,EAAE;QACZpR,YAAY,CAACsT,qBAAqB,CAAClC,KAAK,EAAE,0BAA0B,EAAE,IAAI,CAAC;OAC9E,SAAS;QACNmF,KAAK,CAACK,OAAO,EAAE;;IAClB;EACL;;AAIJ;;;AAAAC,MAAA,GAjnBa3O,2BAA4B;;mBAA5BA,MAA2B,EAAAjH,EAAA,CAAA6V,iBAAA,CAAAC,EAAA,CAAAC,cAAA,GAAA/V,EAAA,CAAA6V,iBAAA,CAAAG,EAAA,CAAAC,UAAA,MAAAjW,EAAA,CAAA6V,iBAAA,CAAAK,EAAA,CAAAC,sBAAA;AAAA;;QAA3BlP,MAA2B;EAAAmP,SAAA;EAAAC,SAAA,WAAAC,kCAAAC,EAAA,EAAAC,GAAA;IAAA,IAAAD,EAAA;qBAEzBtX,sBAAsB;;;;;;;;;;;;;MCvErCe,EAAA,CAAAC,cAAA,6BAAgC;MACHD,EAAA,CAAAE,UAAA,mBAAAuW,iEAAA;QAAA,OAASD,GAAA,CAAAnH,UAAA,EAAY;MAAA,EAAC;;MAC3CrP,EAAA,CAAAkB,SAAA,kBAA4E;MAChFlB,EAAA,CAAAa,YAAA,EAAa;MACbb,EAAA,CAAAC,cAAA,oBAAwH;MAA/FD,EAAA,CAAAE,UAAA,mBAAAwW,iEAAA;QAAA,OAASF,GAAA,CAAAG,iBAAA,EAAmB;MAAA,EAAC;;MAClD3W,EAAA,CAAAkB,SAAA,kBAAuE;MAC3ElB,EAAA,CAAAa,YAAA,EAAa;MAEbb,EAAA,CAAAkB,SAAA,wBAAqB;MACzBlB,EAAA,CAAAa,YAAA,EAAsB;MAGtBb,EAAA,CAAAC,cAAA,sBAAiB;MACgFD,EAAA,CAAAE,UAAA,wBAAA0W,yEAAAxW,MAAA;QAAA,OAAcoW,GAAA,CAAAK,SAAA,CAAAzW,MAAA,CAAA0W,MAAA,CAAwB;MAAA,EAAC;MAChI9W,EAAA,CAAAkB,SAAA,gCAA8E;;MAClFlB,EAAA,CAAAa,YAAA,EAAgB;MAEhBb,EAAA,CAAAC,cAAA,uBAA8E;MAItED,EAAA,CAAAE,UAAA,+BAAA6W,2FAAA;QAAA,OAAqBP,GAAA,CAAAQ,kBAAA,EAAoB;MAAA,EAAC;MAC1ChX,EAAA,CAAAC,cAAA,mBAAgC;MAExBD,EAAA,CAAAmB,MAAA,IACJ;MAAAnB,EAAA,CAAAa,YAAA,EAAY;MAIpBb,EAAA,CAAAyB,UAAA,KAAAwV,2DAAA,kCAC4B;MAG5BjX,EAAA,CAAAyB,UAAA,KAAAyV,gDAAA,uBAKW;MAGXlX,EAAA,CAAAyB,UAAA,KAAA0V,gDAAA,uBAKW;MAGXnX,EAAA,CAAAyB,UAAA,KAAA2V,gDAAA,uBAQW;MAEXpX,EAAA,CAAAyB,UAAA,KAAA4V,oDAAA,2BAkFe;MACnBrX,EAAA,CAAAa,YAAA,EAAe;MAEfb,EAAA,CAAAkB,SAAA,yCAA+H;MAE/HlB,EAAA,CAAAyB,UAAA,KAAA6V,+CAAA,sBAKU;MACdtX,EAAA,CAAAa,YAAA,EAAkB;;;MAvJkCb,EAAA,CAAAoB,SAAA,GAA6C;MAA7CpB,EAAA,CAAAqC,WAAA,eAAArC,EAAA,CAAAwB,WAAA,uBAA6C;MAGjBxB,EAAA,CAAAoB,SAAA,GAA2C;MAA3CpB,EAAA,CAAAqC,WAAA,eAAArC,EAAA,CAAAwB,WAAA,qBAA2C;MAS3FxB,EAAA,CAAAoB,SAAA,GAAgE;MAAhEpB,EAAA,CAAAc,UAAA,aAAA0V,GAAA,CAAAe,WAAA,IAAAf,GAAA,CAAAtS,WAAA,KAAAsS,GAAA,CAAAtS,WAAA,CAAAsC,MAAA,CAAgE;MACjExG,EAAA,CAAAoB,SAAA,GAAoD;MAApDpB,EAAA,CAAAwX,qBAAA,gBAAAxX,EAAA,CAAAwB,WAAA,+BAAoD;MAGjExB,EAAA,CAAAoB,SAAA,GAA+D;MAA/DpB,EAAA,CAAAc,UAAA,eAAA0V,GAAA,CAAAe,WAAA,IAAAf,GAAA,CAAAtS,WAAA,IAAAsS,GAAA,CAAAtS,WAAA,CAAAsC,MAAA,CAA+D;MAEhDxG,EAAA,CAAAoB,SAAA,GAAiB;MAAjBpB,EAAA,CAAAc,UAAA,WAAA0V,GAAA,CAAArR,MAAA,CAAiB,gBAAAqR,GAAA,CAAApO,KAAA,IAAAoO,GAAA,CAAApO,KAAA,CAAA6I,IAAA,iBAAAuF,GAAA,CAAA9F,WAAA,eAAA8F,GAAA,CAAAlP,SAAA,iBAAAkP,GAAA,CAAAiB,WAAA,cAAAjB,GAAA,CAAAvV,QAAA,mBAAAuV,GAAA,CAAA1L,UAAA,IAAA0L,GAAA,CAAA7O,iBAAA;MAK9B3H,EAAA,CAAAoB,SAAA,GACJ;MADIpB,EAAA,CAAA2C,kBAAA,MAAA6T,GAAA,CAAA3F,eAAA,MACJ;MAIc7Q,EAAA,CAAAoB,SAAA,GAAyB;MAAzBpB,EAAA,CAAAc,UAAA,SAAA0V,GAAA,CAAA9N,mBAAA,CAAyB;MAIb1I,EAAA,CAAAoB,SAAA,GAAyB;MAAzBpB,EAAA,CAAAc,UAAA,SAAA0V,GAAA,CAAAjV,mBAAA,CAAyB;MAQzBvB,EAAA,CAAAoB,SAAA,GAAmB;MAAnBpB,EAAA,CAAAc,UAAA,SAAA0V,GAAA,CAAA5O,aAAA,CAAmB;MAQnB5H,EAAA,CAAAoB,SAAA,GAAgE;MAAhEpB,EAAA,CAAAc,UAAA,SAAA0V,GAAA,CAAAxN,UAAA,IAAAwN,GAAA,CAAA/O,gBAAA,KAAA+O,GAAA,CAAAnN,uBAAA,CAAgE;MAUnFrJ,EAAA,CAAAoB,SAAA,GAAW;MAAXpB,EAAA,CAAAc,UAAA,SAAA0V,GAAA,CAAApO,KAAA,CAAW;MAqFoBpI,EAAA,CAAAoB,SAAA,GAAsB;MAAtBpB,EAAA,CAAAc,UAAA,WAAA0V,GAAA,CAAAe,WAAA,CAAsB,aAAAf,GAAA,CAAAvV,QAAA,qBAAAuV,GAAA,CAAArR,MAAA,CAAAC,EAAA;MAELpF,EAAA,CAAAoB,SAAA,GAA6B;MAA7BpB,EAAA,CAAAc,UAAA,SAAA0V,GAAA,CAAAnN,uBAAA,CAA6B;;;;;ADuiBpG,MAAM4C,+BAAgC,SAAQtM,oBAAiF;EAI3HuH,YAAYmD,MAAsC,EAAEqN,IAAiC;IACjF,KAAK,CAACrN,MAAM,EAAEqN,IAAI,CAACvQ,KAAK,CAACG,SAAS,CAAC;IAEnC,IAAI,CAACoQ,IAAI,GAAGA,IAAI;EACpB;EAEA;;;EAGUC,cAAcA,CAAA;IACpB,MAAMtN,MAAM,GAAG,IAAI,CAAC/B,SAAS,EAAE;IAE/B,OAAO,IAAI,CAAC+E,KAAK,CAACC,IAAI,CAAC9D,UAAU,IAAI,CAACa,MAAM,CAACQ,mBAAmB,CAACrB,UAAU,CAAC,CAAC,IAAI,IAAI;EACzF;EAEA;;;EAGgBoO,WAAWA,CAAA;IAAA,IAAAC,OAAA;IAAA,OAAA/N,iBAAA;MACvB,MAAM1B,KAAK,GAAGyP,OAAI,CAACvP,SAAS,EAAE,CAACF,KAAK;MAEpC,IAAI,CAACA,KAAK,EAAE;QACR;;MAGJ,IAAI;QACA,MAAM9J,aAAa,CAACwZ,OAAO,CAAC1P,KAAK,CAAChD,EAAE,CAAC;QAErCpG,UAAU,CAAC+Y,qBAAqB,CAACF,OAAI,CAACH,IAAI,CAACzW,QAAQ,EAAE4W,OAAI,CAACH,IAAI,CAACvS,MAAM,CAAC6S,cAAc,CAAC;OACxF,CAAC,OAAAC,OAAA,EAAM;QACJ;MAAA;MAGJJ,OAAI,CAACH,IAAI,CAACQ,iBAAiB,CAAC,sBAAsB,CAAC;IAAC;EACxD;EAEA;;;;;EAKA,IAAI7R,cAAcA,CAAA;IACd,MAAMgE,MAAM,GAAG,IAAI,CAAC/B,SAAS,EAAE;IAC/B,MAAM+E,KAAK,GAAGhD,MAAM,CAAC8N,QAAQ,EAAE;IAE/B,OAAO9K,KAAK,KAAK,IAAI,IAAIA,KAAK,CAACtC,IAAI,CAACqN,IAAI,IAAI,CAAC/N,MAAM,CAACQ,mBAAmB,CAACuN,IAAI,CAAC,CAAC;EAClF"},"metadata":{},"sourceType":"module","externalDependencies":[]}
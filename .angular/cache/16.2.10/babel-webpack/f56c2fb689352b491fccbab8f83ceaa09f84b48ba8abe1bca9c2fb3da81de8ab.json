{"ast":null,"code":"var _class;\n// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nimport { AddonFilterMediaPluginVideoJS } from '@addons/filter/mediaplugin/services/videojs';\nimport { CoreFilterDefaultHandler } from '@features/filter/services/handlers/default-filter';\nimport { makeSingleton } from '@singletons';\nimport { CoreMedia } from '@singletons/media';\nimport * as i0 from \"@angular/core\";\n/**\n * Handler to support the Multimedia filter.\n */\nexport class AddonFilterMediaPluginHandlerService extends CoreFilterDefaultHandler {\n  constructor() {\n    super(...arguments);\n    this.name = 'AddonFilterMediaPluginHandler';\n    this.filterName = 'mediaplugin';\n    this.template = document.createElement('template'); // A template element to convert HTML to element.\n  }\n  /**\n   * @inheritdoc\n   */\n  filter(text) {\n    this.template.innerHTML = text;\n    const videos = Array.from(this.template.content.querySelectorAll('video'));\n    videos.forEach(video => {\n      AddonFilterMediaPluginVideoJS.treatYoutubeVideos(video);\n    });\n    return this.template.innerHTML;\n  }\n  /**\n   * @inheritdoc\n   */\n  handleHtml(container) {\n    const mediaElements = Array.from(container.querySelectorAll('video, audio'));\n    mediaElements.forEach(mediaElement => {\n      if (CoreMedia.mediaUsesJavascriptPlayer(mediaElement)) {\n        AddonFilterMediaPluginVideoJS.createPlayer(mediaElement);\n        return;\n      }\n      // Remove the VideoJS classes and data if present.\n      mediaElement.classList.remove('video-js');\n      mediaElement.removeAttribute('data-setup');\n      mediaElement.removeAttribute('data-setup-lazy');\n    });\n  }\n}\n_class = AddonFilterMediaPluginHandlerService;\n_class.ɵfac = /*@__PURE__*/function () {\n  let ɵAddonFilterMediaPluginHandlerService_BaseFactory;\n  return function AddonFilterMediaPluginHandlerService_Factory(t) {\n    return (ɵAddonFilterMediaPluginHandlerService_BaseFactory || (ɵAddonFilterMediaPluginHandlerService_BaseFactory = i0.ɵɵgetInheritedFactory(_class)))(t || _class);\n  };\n}();\n_class.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: _class,\n  factory: _class.ɵfac,\n  providedIn: 'root'\n});\nexport const AddonFilterMediaPluginHandler = makeSingleton(AddonFilterMediaPluginHandlerService);","map":{"version":3,"names":["AddonFilterMediaPluginVideoJS","CoreFilterDefaultHandler","makeSingleton","CoreMedia","AddonFilterMediaPluginHandlerService","constructor","name","filterName","template","document","createElement","filter","text","innerHTML","videos","Array","from","content","querySelectorAll","forEach","video","treatYoutubeVideos","handleHtml","container","mediaElements","mediaElement","mediaUsesJavascriptPlayer","createPlayer","classList","remove","removeAttribute","t","factory","ɵfac","providedIn","AddonFilterMediaPluginHandler"],"sources":["/home/toon/works/gitionic7/ionic-github/ionic/src/addons/filter/mediaplugin/services/handlers/mediaplugin.ts"],"sourcesContent":["// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { AddonFilterMediaPluginVideoJS } from '@addons/filter/mediaplugin/services/videojs';\nimport { Injectable } from '@angular/core';\n\nimport { CoreFilterDefaultHandler } from '@features/filter/services/handlers/default-filter';\nimport { makeSingleton } from '@singletons';\nimport { CoreMedia } from '@singletons/media';\n\n/**\n * Handler to support the Multimedia filter.\n */\n@Injectable({ providedIn: 'root' })\nexport class AddonFilterMediaPluginHandlerService extends CoreFilterDefaultHandler {\n\n    name = 'AddonFilterMediaPluginHandler';\n    filterName = 'mediaplugin';\n\n    protected template = document.createElement('template'); // A template element to convert HTML to element.\n\n    /**\n     * @inheritdoc\n     */\n    filter(text: string): string | Promise<string> {\n        this.template.innerHTML = text;\n\n        const videos = Array.from(this.template.content.querySelectorAll('video'));\n\n        videos.forEach((video) => {\n            AddonFilterMediaPluginVideoJS.treatYoutubeVideos(video);\n        });\n\n        return this.template.innerHTML;\n    }\n\n    /**\n     * @inheritdoc\n     */\n    handleHtml(container: HTMLElement): void {\n        const mediaElements = Array.from(container.querySelectorAll<HTMLVideoElement | HTMLAudioElement>('video, audio'));\n\n        mediaElements.forEach((mediaElement) => {\n            if (CoreMedia.mediaUsesJavascriptPlayer(mediaElement)) {\n                AddonFilterMediaPluginVideoJS.createPlayer(mediaElement);\n\n                return;\n            }\n\n            // Remove the VideoJS classes and data if present.\n            mediaElement.classList.remove('video-js');\n            mediaElement.removeAttribute('data-setup');\n            mediaElement.removeAttribute('data-setup-lazy');\n        });\n    }\n\n}\n\nexport const AddonFilterMediaPluginHandler = makeSingleton(AddonFilterMediaPluginHandlerService);\n"],"mappings":";AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,SAASA,6BAA6B,QAAQ,6CAA6C;AAG3F,SAASC,wBAAwB,QAAQ,mDAAmD;AAC5F,SAASC,aAAa,QAAQ,aAAa;AAC3C,SAASC,SAAS,QAAQ,mBAAmB;;AAE7C;;;AAIA,OAAM,MAAOC,oCAAqC,SAAQH,wBAAwB;EADlFI,YAAA;;IAGI,KAAAC,IAAI,GAAG,+BAA+B;IACtC,KAAAC,UAAU,GAAG,aAAa;IAEhB,KAAAC,QAAQ,GAAGC,QAAQ,CAACC,aAAa,CAAC,UAAU,CAAC,CAAC,CAAC;;EAEzD;;;EAGAC,MAAMA,CAACC,IAAY;IACf,IAAI,CAACJ,QAAQ,CAACK,SAAS,GAAGD,IAAI;IAE9B,MAAME,MAAM,GAAGC,KAAK,CAACC,IAAI,CAAC,IAAI,CAACR,QAAQ,CAACS,OAAO,CAACC,gBAAgB,CAAC,OAAO,CAAC,CAAC;IAE1EJ,MAAM,CAACK,OAAO,CAAEC,KAAK,IAAI;MACrBpB,6BAA6B,CAACqB,kBAAkB,CAACD,KAAK,CAAC;IAC3D,CAAC,CAAC;IAEF,OAAO,IAAI,CAACZ,QAAQ,CAACK,SAAS;EAClC;EAEA;;;EAGAS,UAAUA,CAACC,SAAsB;IAC7B,MAAMC,aAAa,GAAGT,KAAK,CAACC,IAAI,CAACO,SAAS,CAACL,gBAAgB,CAAsC,cAAc,CAAC,CAAC;IAEjHM,aAAa,CAACL,OAAO,CAAEM,YAAY,IAAI;MACnC,IAAItB,SAAS,CAACuB,yBAAyB,CAACD,YAAY,CAAC,EAAE;QACnDzB,6BAA6B,CAAC2B,YAAY,CAACF,YAAY,CAAC;QAExD;;MAGJ;MACAA,YAAY,CAACG,SAAS,CAACC,MAAM,CAAC,UAAU,CAAC;MACzCJ,YAAY,CAACK,eAAe,CAAC,YAAY,CAAC;MAC1CL,YAAY,CAACK,eAAe,CAAC,iBAAiB,CAAC;IACnD,CAAC,CAAC;EACN;;SAxCS1B,oCAAqC;;;;+IAArCA,MAAoC,IAAA2B,CAAA,IAApC3B,MAAoC;EAAA;AAAA;;SAApCA,MAAoC;EAAA4B,OAAA,EAApC5B,MAAoC,CAAA6B,IAAA;EAAAC,UAAA,EADvB;AAAM;AA6ChC,OAAO,MAAMC,6BAA6B,GAAGjC,aAAa,CAACE,oCAAoC,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}
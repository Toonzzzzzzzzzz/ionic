{"ast":null,"code":"import _asyncToGenerator from \"/home/toon/works/gitionic7/ionic-github/ionic/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _class;\nimport { CoreSitePluginsPluginContentComponent } from '@features/siteplugins/components/plugin-content/plugin-content';\nimport { CoreSitePlugins } from '@features/siteplugins/services/siteplugins';\nimport { CoreUtils } from '@services/utils/utils';\nimport { CoreNavigator } from '@services/navigator';\nimport * as i0 from \"@angular/core\";\nfunction CoreSitePluginsCourseOptionPage_core_site_plugins_plugin_content_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"core-site-plugins-plugin-content\", 3);\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"component\", ctx_r0.component)(\"method\", ctx_r0.method)(\"args\", ctx_r0.args)(\"initResult\", ctx_r0.initResult);\n  }\n}\n/**\n * Page that displays the index of a course option site plugin.\n */\nexport class CoreSitePluginsCourseOptionPage {\n  constructor() {\n    this.ptrEnabled = true;\n  }\n  /**\n   * @inheritdoc\n   */\n  ngOnInit() {\n    this.courseId = CoreNavigator.getRouteNumberParam('courseId');\n    this.handlerUniqueName = CoreNavigator.getRouteParam('handlerUniqueName');\n    if (!this.handlerUniqueName) {\n      return;\n    }\n    const handler = CoreSitePlugins.getSitePluginHandler(this.handlerUniqueName);\n    if (!handler) {\n      return;\n    }\n    this.component = handler.plugin.component;\n    this.method = handler.handlerSchema.method;\n    this.args = {\n      courseid: this.courseId\n    };\n    this.initResult = handler.initResult;\n    this.ptrEnabled = !('ptrenabled' in handler.handlerSchema) || !CoreUtils.isFalseOrZero(handler.handlerSchema.ptrenabled);\n  }\n  /**\n   * Refresh the data.\n   *\n   * @param refresher Refresher.\n   */\n  refreshData(refresher) {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      try {\n        var _this$content;\n        yield (_this$content = _this.content) === null || _this$content === void 0 ? void 0 : _this$content.refreshContent(false);\n      } finally {\n        refresher.complete();\n      }\n    })();\n  }\n  /**\n   * The page is about to enter and become the active page.\n   */\n  ionViewWillEnter() {\n    var _this$content2;\n    (_this$content2 = this.content) === null || _this$content2 === void 0 || _this$content2.callComponentFunction('ionViewWillEnter');\n  }\n  /**\n   * The page has fully entered and is now the active page. This event will fire, whether it was the first load or a cached page.\n   */\n  ionViewDidEnter() {\n    var _this$content3;\n    (_this$content3 = this.content) === null || _this$content3 === void 0 || _this$content3.callComponentFunction('ionViewDidEnter');\n  }\n  /**\n   * The page is about to leave and no longer be the active page.\n   */\n  ionViewWillLeave() {\n    var _this$content4;\n    (_this$content4 = this.content) === null || _this$content4 === void 0 || _this$content4.callComponentFunction('ionViewWillLeave');\n  }\n  /**\n   * The page has finished leaving and is no longer the active page.\n   */\n  ionViewDidLeave() {\n    var _this$content5;\n    (_this$content5 = this.content) === null || _this$content5 === void 0 || _this$content5.callComponentFunction('ionViewDidLeave');\n  }\n  /**\n   * The page is about to be destroyed and have its elements removed.\n   */\n  ionViewWillUnload() {\n    var _this$content6;\n    (_this$content6 = this.content) === null || _this$content6 === void 0 || _this$content6.callComponentFunction('ionViewWillUnload');\n  }\n  /**\n   * Check if we can leave the page or not.\n   *\n   * @returns Resolved if we can leave it, rejected if not.\n   */\n  canLeave() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      if (!_this2.content) {\n        return true;\n      }\n      const result = yield _this2.content.callComponentFunction('canLeave');\n      return result === undefined || result === null ? true : !!result;\n    })();\n  }\n}\n_class = CoreSitePluginsCourseOptionPage;\n_class.ɵfac = function CoreSitePluginsCourseOptionPage_Factory(t) {\n  return new (t || _class)();\n};\n_class.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: _class,\n  selectors: [[\"core-site-plugins-course-option\"]],\n  viewQuery: function CoreSitePluginsCourseOptionPage_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(CoreSitePluginsPluginContentComponent, 5);\n    }\n    if (rf & 2) {\n      let _t;\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.content = _t.first);\n    }\n  },\n  decls: 5,\n  vars: 5,\n  consts: [[\"slot\", \"fixed\", 3, \"disabled\", \"ionRefresh\"], [3, \"pullingText\"], [3, \"component\", \"method\", \"args\", \"initResult\", 4, \"ngIf\"], [3, \"component\", \"method\", \"args\", \"initResult\"]],\n  template: function CoreSitePluginsCourseOptionPage_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"ion-content\")(1, \"ion-refresher\", 0);\n      i0.ɵɵlistener(\"ionRefresh\", function CoreSitePluginsCourseOptionPage_Template_ion_refresher_ionRefresh_1_listener($event) {\n        return ctx.refreshData($event.target);\n      });\n      i0.ɵɵelement(2, \"ion-refresher-content\", 1);\n      i0.ɵɵpipe(3, \"translate\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(4, CoreSitePluginsCourseOptionPage_core_site_plugins_plugin_content_4_Template, 1, 4, \"core-site-plugins-plugin-content\", 2);\n      i0.ɵɵelementEnd();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"disabled\", !ctx.ptrEnabled || !ctx.content || !ctx.content.dataLoaded);\n      i0.ɵɵadvance(1);\n      i0.ɵɵpropertyInterpolate(\"pullingText\", i0.ɵɵpipeBind1(3, 3, \"core.pulltorefresh\"));\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", ctx.component && ctx.method);\n    }\n  },\n  encapsulation: 2\n});","map":{"version":3,"names":["CoreSitePluginsPluginContentComponent","CoreSitePlugins","CoreUtils","CoreNavigator","i0","ɵɵelement","ɵɵproperty","ctx_r0","component","method","args","initResult","CoreSitePluginsCourseOptionPage","constructor","ptrEnabled","ngOnInit","courseId","getRouteNumberParam","handlerUniqueName","getRouteParam","handler","getSitePluginHandler","plugin","handlerSchema","courseid","isFalseOrZero","ptrenabled","refreshData","refresher","_this","_asyncToGenerator","_this$content","content","refreshContent","complete","ionViewWillEnter","_this$content2","callComponentFunction","ionViewDidEnter","_this$content3","ionViewWillLeave","_this$content4","ionViewDidLeave","_this$content5","ionViewWillUnload","_this$content6","canLeave","_this2","result","undefined","selectors","viewQuery","CoreSitePluginsCourseOptionPage_Query","rf","ctx","ɵɵelementStart","ɵɵlistener","CoreSitePluginsCourseOptionPage_Template_ion_refresher_ionRefresh_1_listener","$event","target","ɵɵelementEnd","ɵɵtemplate","CoreSitePluginsCourseOptionPage_core_site_plugins_plugin_content_4_Template","ɵɵadvance","dataLoaded","ɵɵpropertyInterpolate","ɵɵpipeBind1"],"sources":["/home/toon/works/gitionic7/ionic-github/ionic/src/core/features/siteplugins/pages/course-option/course-option.ts","/home/toon/works/gitionic7/ionic-github/ionic/src/core/features/siteplugins/pages/course-option/core-siteplugins-course-option.html"],"sourcesContent":["// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Component, OnInit, ViewChild } from '@angular/core';\n\nimport { CoreSitePluginsPluginContentComponent } from '@features/siteplugins/components/plugin-content/plugin-content';\nimport { CoreSitePlugins, CoreSitePluginsContent } from '@features/siteplugins/services/siteplugins';\nimport { CoreUtils } from '@services/utils/utils';\nimport { CoreNavigator } from '@services/navigator';\n\n/**\n * Page that displays the index of a course option site plugin.\n */\n@Component({\n    selector: 'core-site-plugins-course-option',\n    templateUrl: 'core-siteplugins-course-option.html',\n})\nexport class CoreSitePluginsCourseOptionPage implements OnInit {\n\n    @ViewChild(CoreSitePluginsPluginContentComponent) content?: CoreSitePluginsPluginContentComponent;\n\n    courseId?: number;\n    handlerUniqueName?: string;\n    component?: string;\n    method?: string;\n    args?: Record<string, unknown>;\n    initResult?: CoreSitePluginsContent | null;\n    ptrEnabled = true;\n\n    /**\n     * @inheritdoc\n     */\n    ngOnInit(): void {\n        this.courseId = CoreNavigator.getRouteNumberParam('courseId');\n        this.handlerUniqueName = CoreNavigator.getRouteParam('handlerUniqueName');\n\n        if (!this.handlerUniqueName) {\n            return;\n        }\n\n        const handler = CoreSitePlugins.getSitePluginHandler(this.handlerUniqueName);\n        if (!handler) {\n            return;\n        }\n\n        this.component = handler.plugin.component;\n        this.method = handler.handlerSchema.method;\n        this.args = {\n            courseid: this.courseId,\n        };\n        this.initResult = handler.initResult;\n        this.ptrEnabled = !('ptrenabled' in handler.handlerSchema) ||\n            !CoreUtils.isFalseOrZero(handler.handlerSchema.ptrenabled);\n    }\n\n    /**\n     * Refresh the data.\n     *\n     * @param refresher Refresher.\n     */\n    async refreshData(refresher: HTMLIonRefresherElement): Promise<void> {\n        try {\n            await this.content?.refreshContent(false);\n        } finally {\n            refresher.complete();\n        }\n    }\n\n    /**\n     * The page is about to enter and become the active page.\n     */\n    ionViewWillEnter(): void {\n        this.content?.callComponentFunction('ionViewWillEnter');\n    }\n\n    /**\n     * The page has fully entered and is now the active page. This event will fire, whether it was the first load or a cached page.\n     */\n    ionViewDidEnter(): void {\n        this.content?.callComponentFunction('ionViewDidEnter');\n    }\n\n    /**\n     * The page is about to leave and no longer be the active page.\n     */\n    ionViewWillLeave(): void {\n        this.content?.callComponentFunction('ionViewWillLeave');\n    }\n\n    /**\n     * The page has finished leaving and is no longer the active page.\n     */\n    ionViewDidLeave(): void {\n        this.content?.callComponentFunction('ionViewDidLeave');\n    }\n\n    /**\n     * The page is about to be destroyed and have its elements removed.\n     */\n    ionViewWillUnload(): void {\n        this.content?.callComponentFunction('ionViewWillUnload');\n    }\n\n    /**\n     * Check if we can leave the page or not.\n     *\n     * @returns Resolved if we can leave it, rejected if not.\n     */\n    async canLeave(): Promise<boolean> {\n        if (!this.content) {\n            return true;\n        }\n\n        const result = await this.content.callComponentFunction('canLeave');\n\n        return result === undefined || result === null ? true : !!result;\n    }\n\n}\n","<ion-content>\n    <ion-refresher slot=\"fixed\" [disabled]=\"!ptrEnabled || !content || !content.dataLoaded\"\n        (ionRefresh)=\"refreshData($event.target)\">\n        <ion-refresher-content pullingText=\"{{ 'core.pulltorefresh' | translate }}\" />\n    </ion-refresher>\n    <core-site-plugins-plugin-content *ngIf=\"component && method\" [component]=\"component\" [method]=\"method\" [args]=\"args\"\n        [initResult]=\"initResult\" />\n</ion-content>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
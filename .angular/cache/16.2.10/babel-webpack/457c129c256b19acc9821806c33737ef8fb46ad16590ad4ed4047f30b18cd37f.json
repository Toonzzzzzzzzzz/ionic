{"ast":null,"code":"import _asyncToGenerator from \"/home/toon/works/gitionic7/ionic-github/ionic/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _class;\n// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nimport { EventEmitter } from '@angular/core';\nimport { CoreFilter } from '@features/filter/services/filter';\nimport { CoreSites } from '@services/sites';\nimport { CoreUtils } from '@services/utils/utils';\nimport { Translate } from '@singletons';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nimport * as i2 from \"@ionic/angular\";\nimport * as i3 from \"@angular/forms\";\nimport * as i4 from \"@ngx-translate/core\";\nfunction CoreSitePickerComponent_ion_item_0_ion_select_option_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-select-option\", 3);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const site_r2 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", site_r2.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(site_r2.fullNameAndSiteName);\n  }\n}\nconst _c0 = function (a0) {\n  return {\n    header: a0\n  };\n};\nfunction CoreSitePickerComponent_ion_item_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-item\")(1, \"ion-label\");\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"ion-select\", 1);\n    i0.ɵɵlistener(\"ngModelChange\", function CoreSitePickerComponent_ion_item_0_Template_ion_select_ngModelChange_4_listener($event) {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.selectedSite = $event);\n    })(\"ngModelChange\", function CoreSitePickerComponent_ion_item_0_Template_ion_select_ngModelChange_4_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r5 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r5.siteSelected.emit(ctx_r5.selectedSite));\n    });\n    i0.ɵɵpipe(5, \"translate\");\n    i0.ɵɵpipe(6, \"translate\");\n    i0.ɵɵtemplate(7, CoreSitePickerComponent_ion_item_0_ion_select_option_7_Template, 2, 2, \"ion-select-option\", 2);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(3, 5, \"core.site\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.selectedSite)(\"cancelText\", i0.ɵɵpipeBind1(5, 7, \"core.cancel\"))(\"interfaceOptions\", i0.ɵɵpureFunction1(11, _c0, i0.ɵɵpipeBind1(6, 9, \"core.site\")));\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.sites);\n  }\n}\n/**\n * Component to display a site selector. It will display a select with the list of sites. If the selected site changes,\n * an output will be emitted with the site ID.\n *\n * Example usage:\n * <core-site-picker (siteSelected)=\"changeSite($event)\"></core-site-picker>\n */\nexport class CoreSitePickerComponent {\n  constructor() {\n    this.siteSelected = new EventEmitter(); // Emit an event when a site is selected. Sends the siteId as parameter.\n  }\n  /**\n   * @inheritdoc\n   */\n  ngOnInit() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      _this.selectedSite = _this.initialSite || CoreSites.getCurrentSiteId();\n      // Load the sites.\n      const sites = yield CoreSites.getSites();\n      if (!_this.selectedSite && sites.length) {\n        // There is no current site, select the first one.\n        _this.selectedSite = sites[0].id;\n        _this.siteSelected.emit(_this.selectedSite);\n      }\n      yield Promise.all(sites.map( /*#__PURE__*/function () {\n        var _ref = _asyncToGenerator(function* (site) {\n          // Format the site name.\n          const options = {\n            clean: true,\n            singleLine: true,\n            filter: false\n          };\n          const siteName = yield CoreUtils.ignoreErrors(CoreFilter.formatText(site.siteName || '', options, [], site.id), site.siteName || '');\n          site.fullNameAndSiteName = Translate.instant('core.fullnameandsitename', {\n            fullname: site.fullname,\n            sitename: siteName\n          });\n        });\n        return function (_x) {\n          return _ref.apply(this, arguments);\n        };\n      }()));\n      _this.sites = sites;\n    })();\n  }\n}\n_class = CoreSitePickerComponent;\n_class.ɵfac = function CoreSitePickerComponent_Factory(t) {\n  return new (t || _class)();\n};\n_class.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: _class,\n  selectors: [[\"core-site-picker\"]],\n  inputs: {\n    initialSite: \"initialSite\"\n  },\n  outputs: {\n    siteSelected: \"siteSelected\"\n  },\n  decls: 1,\n  vars: 1,\n  consts: [[4, \"ngIf\"], [\"interface\", \"action-sheet\", 3, \"ngModel\", \"cancelText\", \"interfaceOptions\", \"ngModelChange\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [3, \"value\"]],\n  template: function CoreSitePickerComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵtemplate(0, CoreSitePickerComponent_ion_item_0_Template, 8, 13, \"ion-item\", 0);\n    }\n    if (rf & 2) {\n      i0.ɵɵproperty(\"ngIf\", ctx.sites && ctx.sites.length);\n    }\n  },\n  dependencies: [i1.NgForOf, i1.NgIf, i2.IonItem, i2.IonLabel, i2.IonSelect, i2.IonSelectOption, i2.SelectValueAccessor, i3.NgControlStatus, i3.NgModel, i4.TranslatePipe],\n  encapsulation: 2\n});","map":{"version":3,"names":["EventEmitter","CoreFilter","CoreSites","CoreUtils","Translate","i0","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵproperty","site_r2","id","ɵɵadvance","ɵɵtextInterpolate","fullNameAndSiteName","ɵɵlistener","CoreSitePickerComponent_ion_item_0_Template_ion_select_ngModelChange_4_listener","$event","ɵɵrestoreView","_r4","ctx_r3","ɵɵnextContext","ɵɵresetView","selectedSite","ctx_r5","siteSelected","emit","ɵɵtemplate","CoreSitePickerComponent_ion_item_0_ion_select_option_7_Template","ɵɵpipeBind1","ctx_r0","ɵɵpureFunction1","_c0","sites","CoreSitePickerComponent","constructor","ngOnInit","_this","_asyncToGenerator","initialSite","getCurrentSiteId","getSites","length","Promise","all","map","_ref","site","options","clean","singleLine","filter","siteName","ignoreErrors","formatText","instant","fullname","sitename","_x","apply","arguments","selectors","inputs","outputs","decls","vars","consts","template","CoreSitePickerComponent_Template","rf","ctx","CoreSitePickerComponent_ion_item_0_Template"],"sources":["/home/toon/works/gitionic7/ionic-github/ionic/src/core/components/site-picker/site-picker.ts","/home/toon/works/gitionic7/ionic-github/ionic/src/core/components/site-picker/core-site-picker.html"],"sourcesContent":["// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Component, Input, Output, EventEmitter, OnInit } from '@angular/core';\n\nimport { CoreFilter } from '@features/filter/services/filter';\nimport { CoreSiteBasicInfo, CoreSites } from '@services/sites';\nimport { CoreUtils } from '@services/utils/utils';\nimport { Translate } from '@singletons';\n\n/**\n * Component to display a site selector. It will display a select with the list of sites. If the selected site changes,\n * an output will be emitted with the site ID.\n *\n * Example usage:\n * <core-site-picker (siteSelected)=\"changeSite($event)\"></core-site-picker>\n */\n@Component({\n    selector: 'core-site-picker',\n    templateUrl: 'core-site-picker.html',\n})\nexport class CoreSitePickerComponent implements OnInit {\n\n    @Input() initialSite?: string; // Initial site. If not provided, current site.\n    @Output() siteSelected = new EventEmitter<string>(); // Emit an event when a site is selected. Sends the siteId as parameter.\n\n    selectedSite?: string;\n    sites?: SiteInfo[];\n\n    /**\n     * @inheritdoc\n     */\n    async ngOnInit(): Promise<void> {\n        this.selectedSite = this.initialSite || CoreSites.getCurrentSiteId();\n\n        // Load the sites.\n        const sites = await CoreSites.getSites();\n\n        if (!this.selectedSite && sites.length) {\n            // There is no current site, select the first one.\n            this.selectedSite = sites[0].id;\n            this.siteSelected.emit(this.selectedSite);\n        }\n\n        await Promise.all(sites.map(async (site: SiteInfo) => {\n            // Format the site name.\n            const options = { clean: true, singleLine: true, filter: false };\n            const siteName = await CoreUtils.ignoreErrors(\n                CoreFilter.formatText(site.siteName || '', options, [], site.id),\n                site.siteName || '',\n            );\n\n            site.fullNameAndSiteName = Translate.instant(\n                'core.fullnameandsitename',\n                { fullname: site.fullname, sitename: siteName },\n            );\n        }));\n\n        this.sites = sites;\n    }\n\n}\n\ntype SiteInfo = CoreSiteBasicInfo & {\n    fullNameAndSiteName?: string;\n};\n","<ion-item *ngIf=\"sites && sites.length\">\n    <ion-label>{{ 'core.site' | translate }}</ion-label>\n    <ion-select [(ngModel)]=\"selectedSite\" (ngModelChange)=\"siteSelected.emit(selectedSite)\" interface=\"action-sheet\"\n        [cancelText]=\"'core.cancel' | translate\" [interfaceOptions]=\"{header: 'core.site' | translate}\">\n        <ion-select-option *ngFor=\"let site of sites\" [value]=\"site.id\">{{ site.fullNameAndSiteName }}</ion-select-option>\n    </ion-select>\n</ion-item>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
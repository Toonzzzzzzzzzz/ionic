{"ast":null,"code":"import _asyncToGenerator from \"/home/toon/works/gitionic7/ionic-github/ionic/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _class;\nimport { CoreError } from '@classes/errors/error';\nimport { CoreCourseModuleMainActivityComponent } from '@features/course/classes/main-activity-component';\nimport { CoreGroups } from '@services/groups';\nimport { CoreNavigator } from '@services/navigator';\nimport { CoreSites } from '@services/sites';\nimport { CoreDomUtils } from '@services/utils/dom';\nimport { CoreTimeUtils } from '@services/utils/time';\nimport { CoreUtils } from '@services/utils/utils';\nimport { Translate } from '@singletons';\nimport { CoreEvents } from '@singletons/events';\nimport { CoreTime } from '@singletons/time';\nimport { AddonModAssignListFilterName } from '../../classes/submissions-source';\nimport { AddonModAssign, AddonModAssignProvider } from '../../services/assign';\nimport { AddonModAssignOffline } from '../../services/assign-offline';\nimport { AddonModAssignSync, AddonModAssignSyncProvider } from '../../services/assign-sync';\nimport { AddonModAssignModuleHandlerService } from '../../services/handlers/module';\nimport { AddonModAssignSubmissionComponent } from '../submission/submission';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ionic/angular\";\nimport * as i2 from \"@features/course/pages/contents/contents\";\nfunction AddonModAssignIndexComponent_div_6_core_file_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"core-file\", 10);\n  }\n  if (rf & 2) {\n    const file_r4 = ctx.$implicit;\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"file\", file_r4)(\"component\", ctx_r3.component)(\"componentId\", ctx_r3.componentId);\n  }\n}\nfunction AddonModAssignIndexComponent_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 8);\n    i0.ɵɵtemplate(1, AddonModAssignIndexComponent_div_6_core_file_1_Template, 1, 3, \"core-file\", 9);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.assign.introattachments);\n  }\n}\nfunction AddonModAssignIndexComponent_ng_container_7_p_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(2, 1, \"core.no\"));\n  }\n}\nfunction AddonModAssignIndexComponent_ng_container_7_p_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(2, 1, \"core.yes\"));\n  }\n}\nfunction AddonModAssignIndexComponent_ng_container_7_ion_item_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-item\", 13)(1, \"ion-label\")(2, \"p\", 14);\n    i0.ɵɵtext(3);\n    i0.ɵɵpipe(4, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"p\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r7 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(4, 2, \"addon.mod_assign.timeremaining\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(ctx_r7.timeRemaining);\n  }\n}\nfunction AddonModAssignIndexComponent_ng_container_7_ion_item_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-item\", 13)(1, \"ion-label\")(2, \"p\", 14);\n    i0.ɵɵtext(3);\n    i0.ɵɵpipe(4, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"p\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r8 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(4, 2, \"addon.mod_assign.latesubmissions\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(ctx_r8.lateSubmissions);\n  }\n}\nfunction AddonModAssignIndexComponent_ng_container_7_ion_item_12_p_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 14);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(2, 1, \"addon.mod_assign.numberofteams\"));\n  }\n}\nfunction AddonModAssignIndexComponent_ng_container_7_ion_item_12_p_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 14);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(2, 1, \"addon.mod_assign.numberofparticipants\"));\n  }\n}\nconst _c0 = function (a0) {\n  return {\n    count: a0\n  };\n};\nfunction AddonModAssignIndexComponent_ng_container_7_ion_item_12_span_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 25);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r17 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind2(2, 1, \"addon.mod_assign.numberofparticipantscountdescription\", i0.ɵɵpureFunction1(4, _c0, ctx_r17.summary.participantcount)), \" \");\n  }\n}\nfunction AddonModAssignIndexComponent_ng_container_7_ion_item_12_span_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 25);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r18 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind2(2, 1, \"addon.mod_assign.numberofteamscountdescription\", i0.ɵɵpureFunction1(4, _c0, ctx_r18.summary.participantcount)), \" \");\n  }\n}\nfunction AddonModAssignIndexComponent_ng_container_7_ion_item_12_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r20 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-item\", 20);\n    i0.ɵɵlistener(\"click\", function AddonModAssignIndexComponent_ng_container_7_ion_item_12_Template_ion_item_click_0_listener() {\n      i0.ɵɵrestoreView(_r20);\n      const ctx_r19 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r19.goToSubmissionList());\n    });\n    i0.ɵɵelementStart(1, \"ion-label\");\n    i0.ɵɵtemplate(2, AddonModAssignIndexComponent_ng_container_7_ion_item_12_p_2_Template, 3, 3, \"p\", 21);\n    i0.ɵɵtemplate(3, AddonModAssignIndexComponent_ng_container_7_ion_item_12_p_3_Template, 3, 3, \"p\", 21);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"ion-badge\", 22)(5, \"span\", 23);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(7, AddonModAssignIndexComponent_ng_container_7_ion_item_12_span_7_Template, 3, 6, \"span\", 24);\n    i0.ɵɵtemplate(8, AddonModAssignIndexComponent_ng_container_7_ion_item_12_span_8_Template, 3, 6, \"span\", 24);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r9 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"detail\", true);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r9.assign.teamsubmission);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r9.assign.teamsubmission);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(ctx_r9.summary.participantcount);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r9.assign.teamsubmission);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r9.assign.teamsubmission);\n  }\n}\nfunction AddonModAssignIndexComponent_ng_container_7_ion_item_13_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r22 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-item\", 26);\n    i0.ɵɵlistener(\"click\", function AddonModAssignIndexComponent_ng_container_7_ion_item_13_Template_ion_item_click_0_listener() {\n      i0.ɵɵrestoreView(_r22);\n      const ctx_r21 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r21.goToSubmissionList(ctx_r21.submissionStatusDraft, !!ctx_r21.summary.submissiondraftscount));\n    });\n    i0.ɵɵelementStart(1, \"ion-label\")(2, \"p\", 14);\n    i0.ɵɵtext(3);\n    i0.ɵɵpipe(4, \"translate\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"ion-badge\", 22)(6, \"span\", 23);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"span\", 25);\n    i0.ɵɵtext(9);\n    i0.ɵɵpipe(10, \"translate\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r10 = i0.ɵɵnextContext(2);\n    i0.ɵɵclassProp(\"hide-detail\", !ctx_r10.summary.submissiondraftscount);\n    i0.ɵɵproperty(\"detail\", true)(\"button\", ctx_r10.summary.submissiondraftscount);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(4, 7, \"addon.mod_assign.numberofdraftsubmissions\"));\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(ctx_r10.summary.submissiondraftscount);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind2(10, 9, \"addon.mod_assign.numberofdraftsubmissionscountdescription\", i0.ɵɵpureFunction1(12, _c0, ctx_r10.summary.submissiondraftscount)), \" \");\n  }\n}\nfunction AddonModAssignIndexComponent_ng_container_7_ion_item_14_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r24 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-item\", 26);\n    i0.ɵɵlistener(\"click\", function AddonModAssignIndexComponent_ng_container_7_ion_item_14_Template_ion_item_click_0_listener() {\n      i0.ɵɵrestoreView(_r24);\n      const ctx_r23 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r23.goToSubmissionList(ctx_r23.submissionStatusSubmitted, !!ctx_r23.summary.submissionssubmittedcount));\n    });\n    i0.ɵɵelementStart(1, \"ion-label\")(2, \"p\", 14);\n    i0.ɵɵtext(3);\n    i0.ɵɵpipe(4, \"translate\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"ion-badge\", 22)(6, \"span\", 23);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"span\", 25);\n    i0.ɵɵtext(9);\n    i0.ɵɵpipe(10, \"translate\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r11 = i0.ɵɵnextContext(2);\n    i0.ɵɵclassProp(\"hide-detail\", !ctx_r11.summary.submissionssubmittedcount);\n    i0.ɵɵproperty(\"detail\", true)(\"button\", ctx_r11.summary.submissionssubmittedcount);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(4, 7, \"addon.mod_assign.numberofsubmittedassignments\"));\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(ctx_r11.summary.submissionssubmittedcount);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind2(10, 9, \"addon.mod_assign.numberofsubmittedassignmentscountdescription\", i0.ɵɵpureFunction1(12, _c0, ctx_r11.summary.submissionssubmittedcount)), \" \");\n  }\n}\nfunction AddonModAssignIndexComponent_ng_container_7_ion_item_15_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r26 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-item\", 26);\n    i0.ɵɵlistener(\"click\", function AddonModAssignIndexComponent_ng_container_7_ion_item_15_Template_ion_item_click_0_listener() {\n      i0.ɵɵrestoreView(_r26);\n      const ctx_r25 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r25.goToSubmissionList(ctx_r25.needGrading, ctx_r25.needsGradingAvailable));\n    });\n    i0.ɵɵelementStart(1, \"ion-label\")(2, \"p\", 14);\n    i0.ɵɵtext(3);\n    i0.ɵɵpipe(4, \"translate\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"ion-badge\", 22)(6, \"span\", 23);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"span\", 25);\n    i0.ɵɵtext(9);\n    i0.ɵɵpipe(10, \"translate\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r12 = i0.ɵɵnextContext(2);\n    i0.ɵɵclassProp(\"hide-detail\", !ctx_r12.needsGradingAvailable);\n    i0.ɵɵproperty(\"detail\", true)(\"button\", ctx_r12.needsGradingAvailable);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(4, 7, \"addon.mod_assign.numberofsubmissionsneedgrading\"));\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(ctx_r12.summary.submissionsneedgradingcount);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind2(10, 9, \"addon.mod_assign.numberofsubmissionsneedgradingcountdescription\", i0.ɵɵpureFunction1(12, _c0, ctx_r12.summary.submissionsneedgradingcount)), \" \");\n  }\n}\nfunction AddonModAssignIndexComponent_ng_container_7_ion_card_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-card\", 27)(1, \"ion-item\");\n    i0.ɵɵelement(2, \"ion-icon\", 28);\n    i0.ɵɵelementStart(3, \"ion-label\");\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"translate\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r13 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(5, 1, \"addon.mod_assign.\" + ctx_r13.summary.warnofungroupedusers));\n  }\n}\nfunction AddonModAssignIndexComponent_ng_container_7_div_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 29);\n    i0.ɵɵelement(1, \"core-course-module-navigation\", 30);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r14 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"courseId\", ctx_r14.courseId)(\"currentModuleId\", ctx_r14.module.id);\n  }\n}\nfunction AddonModAssignIndexComponent_ng_container_7_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r28 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"ion-list\", 11)(2, \"core-group-selector\", 12);\n    i0.ɵɵlistener(\"selectedChange\", function AddonModAssignIndexComponent_ng_container_7_Template_core_group_selector_selectedChange_2_listener($event) {\n      i0.ɵɵrestoreView(_r28);\n      const ctx_r27 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r27.group = $event);\n    })(\"selectedChange\", function AddonModAssignIndexComponent_ng_container_7_Template_core_group_selector_selectedChange_2_listener() {\n      i0.ɵɵrestoreView(_r28);\n      const ctx_r29 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r29.setGroup(ctx_r29.group));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"ion-item\", 13)(4, \"ion-label\")(5, \"p\", 14);\n    i0.ɵɵtext(6);\n    i0.ɵɵpipe(7, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(8, AddonModAssignIndexComponent_ng_container_7_p_8_Template, 3, 3, \"p\", 6);\n    i0.ɵɵtemplate(9, AddonModAssignIndexComponent_ng_container_7_p_9_Template, 3, 3, \"p\", 6);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(10, AddonModAssignIndexComponent_ng_container_7_ion_item_10_Template, 7, 4, \"ion-item\", 15);\n    i0.ɵɵtemplate(11, AddonModAssignIndexComponent_ng_container_7_ion_item_11_Template, 7, 4, \"ion-item\", 15);\n    i0.ɵɵtemplate(12, AddonModAssignIndexComponent_ng_container_7_ion_item_12_Template, 9, 6, \"ion-item\", 16);\n    i0.ɵɵtemplate(13, AddonModAssignIndexComponent_ng_container_7_ion_item_13_Template, 11, 14, \"ion-item\", 17);\n    i0.ɵɵtemplate(14, AddonModAssignIndexComponent_ng_container_7_ion_item_14_Template, 11, 14, \"ion-item\", 17);\n    i0.ɵɵtemplate(15, AddonModAssignIndexComponent_ng_container_7_ion_item_15_Template, 11, 14, \"ion-item\", 17);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(16, AddonModAssignIndexComponent_ng_container_7_ion_card_16_Template, 6, 3, \"ion-card\", 18);\n    i0.ɵɵtemplate(17, AddonModAssignIndexComponent_ng_container_7_div_17_Template, 2, 2, \"div\", 19);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"groupInfo\", ctx_r1.groupInfo)(\"selected\", ctx_r1.group)(\"courseId\", ctx_r1.courseId);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(7, 14, \"core.course.hiddenfromstudents\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.module.visible);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r1.module.visible);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.timeRemaining);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.lateSubmissions);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.summary && ctx_r1.summary.participantcount);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.assign.submissiondrafts && ctx_r1.summary && ctx_r1.summary.submissionsenabled);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.summary && ctx_r1.summary.submissionsenabled);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.summary && ctx_r1.summary.submissionsenabled && !ctx_r1.assign.teamsubmission);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.assign.teamsubmission && ctx_r1.summary && ctx_r1.summary.warnofungroupedusers);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r1.showLoading);\n  }\n}\nfunction AddonModAssignIndexComponent_addon_mod_assign_submission_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"addon-mod-assign-submission\", 31);\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"courseId\", ctx_r2.courseId)(\"moduleId\", ctx_r2.module.id);\n  }\n}\n/**\n * Component that displays an assignment.\n */\nexport class AddonModAssignIndexComponent extends CoreCourseModuleMainActivityComponent {\n  constructor(content, courseContentsPage) {\n    super('AddonModLessonIndexComponent', content, courseContentsPage);\n    this.content = content;\n    this.component = AddonModAssignProvider.COMPONENT;\n    this.pluginName = 'assign';\n    this.canViewAllSubmissions = false; // Whether the user can view all submissions.\n    this.canViewOwnSubmission = false; // Whether the user can view their own submission.\n    this.needsGradingAvailable = false; // Whether we can see the submissions that need grading.\n    this.groupInfo = {\n      groups: [],\n      separateGroups: false,\n      visibleGroups: false,\n      defaultGroupId: 0,\n      canAccessAllGroups: false\n    };\n    // Status.\n    this.submissionStatusSubmitted = AddonModAssignListFilterName.SUBMITTED;\n    this.submissionStatusDraft = AddonModAssignListFilterName.DRAFT;\n    this.needGrading = AddonModAssignListFilterName.NEED_GRADING;\n    this.syncEventName = AddonModAssignSyncProvider.AUTO_SYNCED;\n    this.currentSite = CoreSites.getRequiredCurrentSite();\n    this.currentUserId = this.currentSite.getUserId();\n  }\n  /**\n   * @inheritdoc\n   */\n  ngOnInit() {\n    var _superprop_getNgOnInit = () => super.ngOnInit,\n      _this = this;\n    return _asyncToGenerator(function* () {\n      _superprop_getNgOnInit().call(_this);\n      // Listen to events.\n      _this.savedObserver = CoreEvents.on(AddonModAssignProvider.SUBMISSION_SAVED_EVENT, data => {\n        if (_this.assign && data.assignmentId == _this.assign.id && data.userId == _this.currentUserId) {\n          // Assignment submission saved, refresh data.\n          _this.showLoadingAndRefresh(true, false);\n        }\n      }, _this.siteId);\n      _this.submittedObserver = CoreEvents.on(AddonModAssignProvider.SUBMITTED_FOR_GRADING_EVENT, data => {\n        if (_this.assign && data.assignmentId == _this.assign.id && data.userId == _this.currentUserId) {\n          // Assignment submitted, check completion.\n          _this.checkCompletion();\n          // Reload data since it can have offline data now.\n          _this.showLoadingAndRefresh(true, false);\n        }\n      }, _this.siteId);\n      _this.gradedObserver = CoreEvents.on(AddonModAssignProvider.GRADED_EVENT, data => {\n        if (_this.assign && data.assignmentId == _this.assign.id && data.userId == _this.currentUserId) {\n          // Assignment graded, refresh data.\n          _this.showLoadingAndRefresh(true, false);\n        }\n      }, _this.siteId);\n      _this.startedObserver = CoreEvents.on(AddonModAssignProvider.STARTED_EVENT, data => {\n        if (_this.assign && data.assignmentId == _this.assign.id) {\n          // Assignment submission started, refresh data.\n          _this.showLoadingAndRefresh(false, false);\n        }\n      }, _this.siteId);\n      yield _this.loadContent(false, true);\n    })();\n  }\n  /**\n   * @inheritdoc\n   */\n  fetchContent(refresh, sync = false, showErrors = false) {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      // Get assignment data.\n      _this2.assign = yield AddonModAssign.getAssignment(_this2.courseId, _this2.module.id);\n      _this2.dataRetrieved.emit(_this2.assign);\n      _this2.description = _this2.assign.intro;\n      if (sync) {\n        // Try to synchronize the assign.\n        yield CoreUtils.ignoreErrors(_this2.syncActivity(showErrors));\n      }\n      // Check if there's any offline data for this assign.\n      _this2.hasOffline = yield AddonModAssignOffline.hasAssignOfflineData(_this2.assign.id);\n      // Get assignment submissions.\n      const submissions = yield AddonModAssign.getSubmissions(_this2.assign.id, {\n        cmId: _this2.module.id\n      });\n      const time = CoreTimeUtils.timestamp();\n      _this2.canViewAllSubmissions = submissions.canviewsubmissions;\n      if (submissions.canviewsubmissions) {\n        // Calculate the messages to display about time remaining and late submissions.\n        _this2.timeRemaining = '';\n        _this2.lateSubmissions = '';\n        if (_this2.assign.duedate > 0) {\n          if (_this2.assign.duedate - time <= 0) {\n            _this2.timeRemaining = Translate.instant('addon.mod_assign.assignmentisdue');\n          } else {\n            _this2.timeRemaining = CoreTime.formatTime(_this2.assign.duedate - time);\n          }\n          if (_this2.assign.duedate < time) {\n            if (_this2.assign.cutoffdate) {\n              if (_this2.assign.cutoffdate > time) {\n                _this2.lateSubmissions = Translate.instant('addon.mod_assign.latesubmissionsaccepted', {\n                  $a: CoreTimeUtils.userDate(_this2.assign.cutoffdate * 1000)\n                });\n              } else {\n                _this2.lateSubmissions = Translate.instant('addon.mod_assign.nomoresubmissionsaccepted');\n              }\n            }\n          }\n        }\n        // Check if groupmode is enabled to avoid showing wrong numbers.\n        _this2.groupInfo = yield CoreGroups.getActivityGroupInfo(_this2.assign.cmid, false);\n        yield _this2.setGroup(CoreGroups.validateGroupId(_this2.group, _this2.groupInfo));\n        return;\n      }\n      try {\n        // Check if the user can view their own submission.\n        yield AddonModAssign.getSubmissionStatus(_this2.assign.id, {\n          cmId: _this2.module.id\n        });\n        _this2.canViewOwnSubmission = true;\n      } catch (error) {\n        _this2.canViewOwnSubmission = false;\n        if (error.errorcode !== 'nopermission') {\n          throw error;\n        }\n      }\n    })();\n  }\n  /**\n   * @inheritdoc\n   */\n  logActivity() {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      if (!_this3.assign) {\n        return; // Shouldn't happen.\n      }\n\n      yield CoreUtils.ignoreErrors(AddonModAssign.logView(_this3.assign.id));\n      _this3.analyticsLogEvent('mod_assign_view_assign');\n      if (_this3.canViewAllSubmissions) {\n        // User can see all submissions, log grading view.\n        yield CoreUtils.ignoreErrors(AddonModAssign.logGradingView(_this3.assign.id));\n        _this3.analyticsLogEvent('mod_assign_view_grading_table', {\n          sendUrl: false\n        });\n      } else if (_this3.canViewOwnSubmission) {\n        // User can only see their own submission, log view the user submission.\n        yield CoreUtils.ignoreErrors(AddonModAssign.logSubmissionView(_this3.assign.id));\n        _this3.analyticsLogEvent('mod_assign_view_submission_status', {\n          sendUrl: false\n        });\n      }\n    })();\n  }\n  /**\n   * Set group to see the summary.\n   *\n   * @param groupId Group ID.\n   * @returns Resolved when done.\n   */\n  setGroup(groupId = 0) {\n    var _this4 = this;\n    return _asyncToGenerator(function* () {\n      _this4.group = groupId;\n      if (!_this4.assign) {\n        return;\n      }\n      const submissionStatus = yield AddonModAssign.getSubmissionStatus(_this4.assign.id, {\n        groupId: _this4.group,\n        cmId: _this4.module.id\n      });\n      _this4.summary = submissionStatus.gradingsummary;\n      if (!_this4.summary) {\n        _this4.needsGradingAvailable = false;\n        return;\n      }\n      if (_this4.summary.warnofungroupedusers === true) {\n        _this4.summary.warnofungroupedusers = 'ungroupedusers';\n      } else {\n        switch (_this4.summary.warnofungroupedusers) {\n          case AddonModAssignProvider.WARN_GROUPS_REQUIRED:\n            _this4.summary.warnofungroupedusers = 'ungroupedusers';\n            break;\n          case AddonModAssignProvider.WARN_GROUPS_OPTIONAL:\n            _this4.summary.warnofungroupedusers = 'ungroupedusersoptional';\n            break;\n          default:\n            _this4.summary.warnofungroupedusers = '';\n            break;\n        }\n      }\n      _this4.needsGradingAvailable = _this4.summary.submissionsneedgradingcount > 0;\n    })();\n  }\n  /**\n   * Go to view a list of submissions.\n   *\n   * @param status Status to see.\n   * @param hasSubmissions If the status has any submission.\n   */\n  goToSubmissionList(status, hasSubmissions = false) {\n    if (status !== undefined && !hasSubmissions) {\n      return;\n    }\n    const params = {\n      groupId: this.group || 0,\n      moduleName: this.moduleName\n    };\n    if (status !== undefined) {\n      params.status = status;\n    }\n    CoreNavigator.navigateToSitePath(AddonModAssignModuleHandlerService.PAGE_NAME + `/${this.courseId}/${this.module.id}/submission`, {\n      params\n    });\n  }\n  /**\n   * @inheritdoc\n   */\n  hasSyncSucceed(result) {\n    if (result.updated) {\n      var _this$submissionCompo;\n      (_this$submissionCompo = this.submissionComponent) === null || _this$submissionCompo === void 0 || _this$submissionCompo.invalidateAndRefresh(false);\n    }\n    return result.updated;\n  }\n  /**\n   * @inheritdoc\n   */\n  invalidateContent() {\n    var _this5 = this;\n    return _asyncToGenerator(function* () {\n      var _this5$submissionComp;\n      const promises = [];\n      promises.push(AddonModAssign.invalidateAssignmentData(_this5.courseId));\n      // Invalidate before component becomes null.\n      promises.push(((_this5$submissionComp = _this5.submissionComponent) === null || _this5$submissionComp === void 0 ? void 0 : _this5$submissionComp.invalidateAndRefresh(true)) || Promise.resolve());\n      if (_this5.assign) {\n        promises.push(AddonModAssign.invalidateAllSubmissionData(_this5.assign.id));\n        if (_this5.canViewAllSubmissions) {\n          promises.push(AddonModAssign.invalidateSubmissionStatusData(_this5.assign.id, undefined, _this5.group));\n        }\n      }\n      yield Promise.all(promises);\n    })();\n  }\n  /**\n   * User entered the page that contains the component.\n   */\n  ionViewDidEnter() {\n    var _this$submissionCompo2;\n    super.ionViewDidEnter();\n    (_this$submissionCompo2 = this.submissionComponent) === null || _this$submissionCompo2 === void 0 || _this$submissionCompo2.ionViewDidEnter();\n  }\n  /**\n   * User left the page that contains the component.\n   */\n  ionViewDidLeave() {\n    var _this$submissionCompo3;\n    super.ionViewDidLeave();\n    (_this$submissionCompo3 = this.submissionComponent) === null || _this$submissionCompo3 === void 0 || _this$submissionCompo3.ionViewDidLeave();\n  }\n  /**\n   * @inheritdoc\n   */\n  isRefreshSyncNeeded(syncEventData) {\n    if (!this.assign || syncEventData.assignId != this.assign.id) {\n      return false;\n    }\n    if (syncEventData.warnings && syncEventData.warnings.length) {\n      // Show warnings.\n      CoreDomUtils.showAlert(undefined, syncEventData.warnings[0]);\n    }\n    return true;\n  }\n  /**\n   * @inheritdoc\n   */\n  sync() {\n    var _this6 = this;\n    return _asyncToGenerator(function* () {\n      if (!_this6.assign) {\n        throw new CoreError('Cannot sync without a assign.');\n      }\n      return AddonModAssignSync.syncAssign(_this6.assign.id);\n    })();\n  }\n  /**\n   * @inheritdoc\n   */\n  ngOnDestroy() {\n    var _this$savedObserver, _this$submittedObserv, _this$gradedObserver, _this$startedObserver;\n    super.ngOnDestroy();\n    (_this$savedObserver = this.savedObserver) === null || _this$savedObserver === void 0 || _this$savedObserver.off();\n    (_this$submittedObserv = this.submittedObserver) === null || _this$submittedObserv === void 0 || _this$submittedObserv.off();\n    (_this$gradedObserver = this.gradedObserver) === null || _this$gradedObserver === void 0 || _this$gradedObserver.off();\n    (_this$startedObserver = this.startedObserver) === null || _this$startedObserver === void 0 || _this$startedObserver.off();\n  }\n}\n_class = AddonModAssignIndexComponent;\n_class.ɵfac = function AddonModAssignIndexComponent_Factory(t) {\n  return new (t || _class)(i0.ɵɵdirectiveInject(i1.IonContent), i0.ɵɵdirectiveInject(i2.CoreCourseContentsPage, 8));\n};\n_class.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: _class,\n  selectors: [[\"addon-mod-assign-index\"]],\n  viewQuery: function AddonModAssignIndexComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(AddonModAssignSubmissionComponent, 5);\n    }\n    if (rf & 2) {\n      let _t;\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.submissionComponent = _t.first);\n    }\n  },\n  features: [i0.ɵɵInheritDefinitionFeature],\n  decls: 9,\n  vars: 13,\n  consts: [[\"slot\", \"end\"], [\"fill\", \"clear\", \"aria-haspopup\", \"true\", 3, \"click\"], [\"name\", \"fas-circle-info\", \"slot\", \"icon-only\", \"aria-hidden\", \"true\"], [3, \"hideUntil\"], [3, \"module\", \"description\", \"component\", \"componentId\", \"courseId\", \"hasDataToSync\", \"completionChanged\"], [\"description\", \"\", 4, \"ngIf\"], [4, \"ngIf\"], [3, \"courseId\", \"moduleId\", 4, \"ngIf\"], [\"description\", \"\"], [3, \"file\", \"component\", \"componentId\", 4, \"ngFor\", \"ngForOf\"], [3, \"file\", \"component\", \"componentId\"], [1, \"core-list-align-detail-right\"], [3, \"groupInfo\", \"selected\", \"courseId\", \"selectedChange\"], [1, \"ion-text-wrap\"], [1, \"item-heading\"], [\"class\", \"ion-text-wrap\", 4, \"ngIf\"], [\"class\", \"ion-text-wrap\", \"button\", \"\", 3, \"detail\", \"click\", 4, \"ngIf\"], [\"class\", \"ion-text-wrap\", 3, \"hide-detail\", \"detail\", \"button\", \"click\", 4, \"ngIf\"], [\"class\", \"core-info-card\", 4, \"ngIf\"], [\"collapsible-footer\", \"\", \"slot\", \"fixed\", 4, \"ngIf\"], [\"button\", \"\", 1, \"ion-text-wrap\", 3, \"detail\", \"click\"], [\"class\", \"item-heading\", 4, \"ngIf\"], [\"slot\", \"end\", \"color\", \"primary\"], [\"aria-hidden\", \"true\"], [\"class\", \"sr-only\", 4, \"ngIf\"], [1, \"sr-only\"], [1, \"ion-text-wrap\", 3, \"detail\", \"button\", \"click\"], [1, \"core-info-card\"], [\"name\", \"fas-circle-question\", \"slot\", \"start\", \"aria-hidden\", \"true\"], [\"collapsible-footer\", \"\", \"slot\", \"fixed\"], [3, \"courseId\", \"currentModuleId\"], [3, \"courseId\", \"moduleId\"]],\n  template: function AddonModAssignIndexComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"core-navbar-buttons\", 0)(1, \"ion-button\", 1);\n      i0.ɵɵlistener(\"click\", function AddonModAssignIndexComponent_Template_ion_button_click_1_listener() {\n        return ctx.openModuleSummary();\n      });\n      i0.ɵɵpipe(2, \"translate\");\n      i0.ɵɵelement(3, \"ion-icon\", 2);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(4, \"core-loading\", 3)(5, \"core-course-module-info\", 4);\n      i0.ɵɵlistener(\"completionChanged\", function AddonModAssignIndexComponent_Template_core_course_module_info_completionChanged_5_listener() {\n        return ctx.onCompletionChange();\n      });\n      i0.ɵɵtemplate(6, AddonModAssignIndexComponent_div_6_Template, 2, 1, \"div\", 5);\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(7, AddonModAssignIndexComponent_ng_container_7_Template, 18, 16, \"ng-container\", 6);\n      i0.ɵɵtemplate(8, AddonModAssignIndexComponent_addon_mod_assign_submission_8_Template, 1, 2, \"addon-mod-assign-submission\", 7);\n      i0.ɵɵelementEnd();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(1);\n      i0.ɵɵattribute(\"aria-label\", i0.ɵɵpipeBind1(2, 11, \"core.info\"));\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"hideUntil\", !ctx.showLoading);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"module\", ctx.module)(\"description\", ctx.description)(\"component\", ctx.component)(\"componentId\", ctx.componentId)(\"courseId\", ctx.courseId)(\"hasDataToSync\", ctx.hasOffline);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.assign && (ctx.assign.introattachments == null ? null : ctx.assign.introattachments.length) && !ctx.assign.submissionattachments);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.assign && ctx.canViewAllSubmissions);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", !ctx.showLoading && !ctx.canViewAllSubmissions && ctx.canViewOwnSubmission);\n    }\n  },\n  encapsulation: 2\n});","map":{"version":3,"names":["CoreError","CoreCourseModuleMainActivityComponent","CoreGroups","CoreNavigator","CoreSites","CoreDomUtils","CoreTimeUtils","CoreUtils","Translate","CoreEvents","CoreTime","AddonModAssignListFilterName","AddonModAssign","AddonModAssignProvider","AddonModAssignOffline","AddonModAssignSync","AddonModAssignSyncProvider","AddonModAssignModuleHandlerService","AddonModAssignSubmissionComponent","i0","ɵɵelement","ɵɵproperty","file_r4","ctx_r3","component","componentId","ɵɵelementStart","ɵɵtemplate","AddonModAssignIndexComponent_div_6_core_file_1_Template","ɵɵelementEnd","ɵɵadvance","ctx_r0","assign","introattachments","ɵɵtext","ɵɵtextInterpolate","ɵɵpipeBind1","ctx_r7","timeRemaining","ctx_r8","lateSubmissions","ɵɵtextInterpolate1","ɵɵpipeBind2","ɵɵpureFunction1","_c0","ctx_r17","summary","participantcount","ctx_r18","ɵɵlistener","AddonModAssignIndexComponent_ng_container_7_ion_item_12_Template_ion_item_click_0_listener","ɵɵrestoreView","_r20","ctx_r19","ɵɵnextContext","ɵɵresetView","goToSubmissionList","AddonModAssignIndexComponent_ng_container_7_ion_item_12_p_2_Template","AddonModAssignIndexComponent_ng_container_7_ion_item_12_p_3_Template","AddonModAssignIndexComponent_ng_container_7_ion_item_12_span_7_Template","AddonModAssignIndexComponent_ng_container_7_ion_item_12_span_8_Template","ctx_r9","teamsubmission","AddonModAssignIndexComponent_ng_container_7_ion_item_13_Template_ion_item_click_0_listener","_r22","ctx_r21","submissionStatusDraft","submissiondraftscount","ɵɵclassProp","ctx_r10","AddonModAssignIndexComponent_ng_container_7_ion_item_14_Template_ion_item_click_0_listener","_r24","ctx_r23","submissionStatusSubmitted","submissionssubmittedcount","ctx_r11","AddonModAssignIndexComponent_ng_container_7_ion_item_15_Template_ion_item_click_0_listener","_r26","ctx_r25","needGrading","needsGradingAvailable","ctx_r12","submissionsneedgradingcount","ctx_r13","warnofungroupedusers","ctx_r14","courseId","module","id","ɵɵelementContainerStart","AddonModAssignIndexComponent_ng_container_7_Template_core_group_selector_selectedChange_2_listener","$event","_r28","ctx_r27","group","ctx_r29","setGroup","AddonModAssignIndexComponent_ng_container_7_p_8_Template","AddonModAssignIndexComponent_ng_container_7_p_9_Template","AddonModAssignIndexComponent_ng_container_7_ion_item_10_Template","AddonModAssignIndexComponent_ng_container_7_ion_item_11_Template","AddonModAssignIndexComponent_ng_container_7_ion_item_12_Template","AddonModAssignIndexComponent_ng_container_7_ion_item_13_Template","AddonModAssignIndexComponent_ng_container_7_ion_item_14_Template","AddonModAssignIndexComponent_ng_container_7_ion_item_15_Template","AddonModAssignIndexComponent_ng_container_7_ion_card_16_Template","AddonModAssignIndexComponent_ng_container_7_div_17_Template","ɵɵelementContainerEnd","ctx_r1","groupInfo","visible","submissiondrafts","submissionsenabled","showLoading","ctx_r2","AddonModAssignIndexComponent","constructor","content","courseContentsPage","COMPONENT","pluginName","canViewAllSubmissions","canViewOwnSubmission","groups","separateGroups","visibleGroups","defaultGroupId","canAccessAllGroups","SUBMITTED","DRAFT","NEED_GRADING","syncEventName","AUTO_SYNCED","currentSite","getRequiredCurrentSite","currentUserId","getUserId","ngOnInit","_superprop_getNgOnInit","_this","_asyncToGenerator","call","savedObserver","on","SUBMISSION_SAVED_EVENT","data","assignmentId","userId","showLoadingAndRefresh","siteId","submittedObserver","SUBMITTED_FOR_GRADING_EVENT","checkCompletion","gradedObserver","GRADED_EVENT","startedObserver","STARTED_EVENT","loadContent","fetchContent","refresh","sync","showErrors","_this2","getAssignment","dataRetrieved","emit","description","intro","ignoreErrors","syncActivity","hasOffline","hasAssignOfflineData","submissions","getSubmissions","cmId","time","timestamp","canviewsubmissions","duedate","instant","formatTime","cutoffdate","$a","userDate","getActivityGroupInfo","cmid","validateGroupId","getSubmissionStatus","error","errorcode","logActivity","_this3","logView","analyticsLogEvent","logGradingView","sendUrl","logSubmissionView","groupId","_this4","submissionStatus","gradingsummary","WARN_GROUPS_REQUIRED","WARN_GROUPS_OPTIONAL","status","hasSubmissions","undefined","params","moduleName","navigateToSitePath","PAGE_NAME","hasSyncSucceed","result","updated","_this$submissionCompo","submissionComponent","invalidateAndRefresh","invalidateContent","_this5","_this5$submissionComp","promises","push","invalidateAssignmentData","Promise","resolve","invalidateAllSubmissionData","invalidateSubmissionStatusData","all","ionViewDidEnter","_this$submissionCompo2","ionViewDidLeave","_this$submissionCompo3","isRefreshSyncNeeded","syncEventData","assignId","warnings","length","showAlert","_this6","syncAssign","ngOnDestroy","_this$savedObserver","_this$submittedObserv","_this$gradedObserver","_this$startedObserver","off","ɵɵdirectiveInject","i1","IonContent","i2","CoreCourseContentsPage","selectors","viewQuery","AddonModAssignIndexComponent_Query","rf","ctx","AddonModAssignIndexComponent_Template_ion_button_click_1_listener","openModuleSummary","AddonModAssignIndexComponent_Template_core_course_module_info_completionChanged_5_listener","onCompletionChange","AddonModAssignIndexComponent_div_6_Template","AddonModAssignIndexComponent_ng_container_7_Template","AddonModAssignIndexComponent_addon_mod_assign_submission_8_Template","ɵɵattribute","submissionattachments"],"sources":["/home/toon/works/gitionic7/ionic-github/ionic/src/addons/mod/assign/components/index/index.ts","/home/toon/works/gitionic7/ionic-github/ionic/src/addons/mod/assign/components/index/addon-mod-assign-index.html"],"sourcesContent":["// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Component, Optional, OnDestroy, OnInit, ViewChild } from '@angular/core';\nimport { Params } from '@angular/router';\nimport { CoreError } from '@classes/errors/error';\nimport { CoreSite } from '@classes/sites/site';\nimport { CoreCourseModuleMainActivityComponent } from '@features/course/classes/main-activity-component';\nimport { CoreCourseContentsPage } from '@features/course/pages/contents/contents';\nimport { IonContent } from '@ionic/angular';\nimport { CoreGroupInfo, CoreGroups } from '@services/groups';\nimport { CoreNavigator } from '@services/navigator';\nimport { CoreSites } from '@services/sites';\nimport { CoreDomUtils } from '@services/utils/dom';\nimport { CoreTimeUtils } from '@services/utils/time';\nimport { CoreUtils } from '@services/utils/utils';\nimport { Translate } from '@singletons';\nimport { CoreEventObserver, CoreEvents } from '@singletons/events';\nimport { CoreTime } from '@singletons/time';\nimport { AddonModAssignListFilterName } from '../../classes/submissions-source';\nimport {\n    AddonModAssign,\n    AddonModAssignAssign,\n    AddonModAssignProvider,\n    AddonModAssignSubmissionGradingSummary,\n} from '../../services/assign';\nimport { AddonModAssignOffline } from '../../services/assign-offline';\nimport {\n    AddonModAssignAutoSyncData,\n    AddonModAssignSync,\n    AddonModAssignSyncProvider,\n    AddonModAssignSyncResult,\n} from '../../services/assign-sync';\nimport { AddonModAssignModuleHandlerService } from '../../services/handlers/module';\nimport { AddonModAssignSubmissionComponent } from '../submission/submission';\n\n/**\n * Component that displays an assignment.\n */\n@Component({\n    selector: 'addon-mod-assign-index',\n    templateUrl: 'addon-mod-assign-index.html',\n})\nexport class AddonModAssignIndexComponent extends CoreCourseModuleMainActivityComponent implements OnInit, OnDestroy {\n\n    @ViewChild(AddonModAssignSubmissionComponent) submissionComponent?: AddonModAssignSubmissionComponent;\n\n    component = AddonModAssignProvider.COMPONENT;\n    pluginName = 'assign';\n\n    assign?: AddonModAssignAssign; // The assign object.\n    canViewAllSubmissions = false; // Whether the user can view all submissions.\n    canViewOwnSubmission = false; // Whether the user can view their own submission.\n    timeRemaining?: string; // Message about time remaining to submit.\n    lateSubmissions?: string; // Message about late submissions.\n    summary?: AddonModAssignSubmissionGradingSummary; // The grading summary.\n    needsGradingAvailable = false; // Whether we can see the submissions that need grading.\n\n    groupInfo: CoreGroupInfo = {\n        groups: [],\n        separateGroups: false,\n        visibleGroups: false,\n        defaultGroupId: 0,\n        canAccessAllGroups: false,\n    };\n\n    // Status.\n    submissionStatusSubmitted = AddonModAssignListFilterName.SUBMITTED;\n    submissionStatusDraft = AddonModAssignListFilterName.DRAFT;\n    needGrading = AddonModAssignListFilterName.NEED_GRADING;\n\n    protected currentUserId!: number; // Current user ID.\n    protected currentSite!: CoreSite; // Current site.\n    protected syncEventName = AddonModAssignSyncProvider.AUTO_SYNCED;\n\n    // Observers.\n    protected savedObserver?: CoreEventObserver;\n    protected submittedObserver?: CoreEventObserver;\n    protected gradedObserver?: CoreEventObserver;\n    protected startedObserver?: CoreEventObserver;\n\n    constructor(\n        protected content?: IonContent,\n        @Optional() courseContentsPage?: CoreCourseContentsPage,\n    ) {\n        super('AddonModLessonIndexComponent', content, courseContentsPage);\n\n        this.currentSite = CoreSites.getRequiredCurrentSite();\n        this.currentUserId = this.currentSite.getUserId();\n    }\n\n    /**\n     * @inheritdoc\n     */\n    async ngOnInit(): Promise<void> {\n        super.ngOnInit();\n\n        // Listen to events.\n        this.savedObserver = CoreEvents.on(\n            AddonModAssignProvider.SUBMISSION_SAVED_EVENT,\n            (data) => {\n                if (this.assign && data.assignmentId == this.assign.id && data.userId == this.currentUserId) {\n                    // Assignment submission saved, refresh data.\n                    this.showLoadingAndRefresh(true, false);\n                }\n            },\n            this.siteId,\n        );\n\n        this.submittedObserver = CoreEvents.on(\n            AddonModAssignProvider.SUBMITTED_FOR_GRADING_EVENT,\n            (data) => {\n                if (this.assign && data.assignmentId == this.assign.id && data.userId == this.currentUserId) {\n                    // Assignment submitted, check completion.\n                    this.checkCompletion();\n\n                    // Reload data since it can have offline data now.\n                    this.showLoadingAndRefresh(true, false);\n                }\n            },\n            this.siteId,\n        );\n\n        this.gradedObserver = CoreEvents.on(AddonModAssignProvider.GRADED_EVENT, (data) => {\n            if (this.assign && data.assignmentId == this.assign.id && data.userId == this.currentUserId) {\n                // Assignment graded, refresh data.\n                this.showLoadingAndRefresh(true, false);\n            }\n        }, this.siteId);\n\n        this.startedObserver = CoreEvents.on(AddonModAssignProvider.STARTED_EVENT, (data) => {\n            if (this.assign && data.assignmentId == this.assign.id) {\n                // Assignment submission started, refresh data.\n                this.showLoadingAndRefresh(false, false);\n            }\n        }, this.siteId);\n\n        await this.loadContent(false, true);\n    }\n\n    /**\n     * @inheritdoc\n     */\n    protected async fetchContent(refresh?: boolean, sync = false, showErrors = false): Promise<void> {\n\n        // Get assignment data.\n        this.assign = await AddonModAssign.getAssignment(this.courseId, this.module.id);\n\n        this.dataRetrieved.emit(this.assign);\n        this.description = this.assign.intro;\n\n        if (sync) {\n            // Try to synchronize the assign.\n            await CoreUtils.ignoreErrors(this.syncActivity(showErrors));\n        }\n\n        // Check if there's any offline data for this assign.\n        this.hasOffline = await AddonModAssignOffline.hasAssignOfflineData(this.assign.id);\n\n        // Get assignment submissions.\n        const submissions = await AddonModAssign.getSubmissions(this.assign.id, { cmId: this.module.id });\n        const time = CoreTimeUtils.timestamp();\n\n        this.canViewAllSubmissions = submissions.canviewsubmissions;\n\n        if (submissions.canviewsubmissions) {\n\n            // Calculate the messages to display about time remaining and late submissions.\n            this.timeRemaining = '';\n            this.lateSubmissions = '';\n\n            if (this.assign.duedate > 0) {\n                if (this.assign.duedate - time <= 0) {\n                    this.timeRemaining = Translate.instant('addon.mod_assign.assignmentisdue');\n                } else {\n                    this.timeRemaining = CoreTime.formatTime(this.assign.duedate - time);\n                }\n\n                if (this.assign.duedate < time) {\n                    if (this.assign.cutoffdate) {\n                        if (this.assign.cutoffdate > time) {\n                            this.lateSubmissions = Translate.instant(\n                                'addon.mod_assign.latesubmissionsaccepted',\n                                { $a: CoreTimeUtils.userDate(this.assign.cutoffdate * 1000) },\n                            );\n                        } else {\n                            this.lateSubmissions = Translate.instant('addon.mod_assign.nomoresubmissionsaccepted');\n                        }\n                    }\n                }\n            }\n\n            // Check if groupmode is enabled to avoid showing wrong numbers.\n            this.groupInfo = await CoreGroups.getActivityGroupInfo(this.assign.cmid, false);\n\n            await this.setGroup(CoreGroups.validateGroupId(this.group, this.groupInfo));\n\n            return;\n        }\n\n        try {\n            // Check if the user can view their own submission.\n            await AddonModAssign.getSubmissionStatus(this.assign.id, { cmId: this.module.id });\n            this.canViewOwnSubmission = true;\n        } catch (error) {\n            this.canViewOwnSubmission = false;\n\n            if (error.errorcode !== 'nopermission') {\n                throw error;\n            }\n        }\n    }\n\n    /**\n     * @inheritdoc\n     */\n    protected async logActivity(): Promise<void> {\n        if (!this.assign) {\n            return; // Shouldn't happen.\n        }\n\n        await CoreUtils.ignoreErrors(AddonModAssign.logView(this.assign.id));\n\n        this.analyticsLogEvent('mod_assign_view_assign');\n\n        if (this.canViewAllSubmissions) {\n            // User can see all submissions, log grading view.\n            await CoreUtils.ignoreErrors(AddonModAssign.logGradingView(this.assign.id));\n\n            this.analyticsLogEvent('mod_assign_view_grading_table', { sendUrl: false });\n        } else if (this.canViewOwnSubmission) {\n            // User can only see their own submission, log view the user submission.\n            await CoreUtils.ignoreErrors(AddonModAssign.logSubmissionView(this.assign.id));\n\n            this.analyticsLogEvent('mod_assign_view_submission_status', { sendUrl: false });\n        }\n    }\n\n    /**\n     * Set group to see the summary.\n     *\n     * @param groupId Group ID.\n     * @returns Resolved when done.\n     */\n    async setGroup(groupId = 0): Promise<void> {\n        this.group = groupId;\n\n        if (!this.assign) {\n            return;\n        }\n\n        const submissionStatus = await AddonModAssign.getSubmissionStatus(this.assign.id, {\n            groupId: this.group,\n            cmId: this.module.id,\n        });\n\n        this.summary = submissionStatus.gradingsummary;\n        if (!this.summary) {\n            this.needsGradingAvailable = false;\n\n            return;\n        }\n\n        if (this.summary.warnofungroupedusers === true) {\n            this.summary.warnofungroupedusers = 'ungroupedusers';\n        } else {\n            switch (this.summary.warnofungroupedusers) {\n                case AddonModAssignProvider.WARN_GROUPS_REQUIRED:\n                    this.summary.warnofungroupedusers = 'ungroupedusers';\n                    break;\n                case AddonModAssignProvider.WARN_GROUPS_OPTIONAL:\n                    this.summary.warnofungroupedusers = 'ungroupedusersoptional';\n                    break;\n                default:\n                    this.summary.warnofungroupedusers = '';\n                    break;\n            }\n        }\n\n        this.needsGradingAvailable = this.summary.submissionsneedgradingcount > 0;\n    }\n\n    /**\n     * Go to view a list of submissions.\n     *\n     * @param status Status to see.\n     * @param hasSubmissions If the status has any submission.\n     */\n    goToSubmissionList(status?: AddonModAssignListFilterName, hasSubmissions = false): void {\n        if (status !== undefined && !hasSubmissions) {\n            return;\n        }\n\n        const params: Params = {\n            groupId: this.group || 0,\n            moduleName: this.moduleName,\n        };\n        if (status !== undefined) {\n            params.status = status;\n        }\n\n        CoreNavigator.navigateToSitePath(\n            AddonModAssignModuleHandlerService.PAGE_NAME + `/${this.courseId}/${this.module.id}/submission`,\n            {\n                params,\n            },\n        );\n    }\n\n    /**\n     * @inheritdoc\n     */\n    protected hasSyncSucceed(result: AddonModAssignSyncResult): boolean {\n        if (result.updated) {\n            this.submissionComponent?.invalidateAndRefresh(false);\n        }\n\n        return result.updated;\n    }\n\n    /**\n     * @inheritdoc\n     */\n    protected async invalidateContent(): Promise<void> {\n        const promises: Promise<void>[] = [];\n\n        promises.push(AddonModAssign.invalidateAssignmentData(this.courseId));\n        // Invalidate before component becomes null.\n        promises.push(this.submissionComponent?.invalidateAndRefresh(true) || Promise.resolve());\n\n        if (this.assign) {\n            promises.push(AddonModAssign.invalidateAllSubmissionData(this.assign.id));\n\n            if (this.canViewAllSubmissions) {\n                promises.push(AddonModAssign.invalidateSubmissionStatusData(this.assign.id, undefined, this.group));\n            }\n        }\n\n        await Promise.all(promises);\n    }\n\n    /**\n     * User entered the page that contains the component.\n     */\n    ionViewDidEnter(): void {\n        super.ionViewDidEnter();\n\n        this.submissionComponent?.ionViewDidEnter();\n    }\n\n    /**\n     * User left the page that contains the component.\n     */\n    ionViewDidLeave(): void {\n        super.ionViewDidLeave();\n\n        this.submissionComponent?.ionViewDidLeave();\n    }\n\n    /**\n     * @inheritdoc\n     */\n    protected isRefreshSyncNeeded(syncEventData: AddonModAssignAutoSyncData): boolean {\n        if (!this.assign || syncEventData.assignId != this.assign.id) {\n            return false;\n        }\n\n        if (syncEventData.warnings && syncEventData.warnings.length) {\n            // Show warnings.\n            CoreDomUtils.showAlert(undefined, syncEventData.warnings[0]);\n        }\n\n        return true;\n    }\n\n    /**\n     * @inheritdoc\n     */\n    protected async sync(): Promise<AddonModAssignSyncResult> {\n        if (!this.assign) {\n            throw new CoreError('Cannot sync without a assign.');\n        }\n\n        return AddonModAssignSync.syncAssign(this.assign.id);\n    }\n\n    /**\n     * @inheritdoc\n     */\n    ngOnDestroy(): void {\n        super.ngOnDestroy();\n\n        this.savedObserver?.off();\n        this.submittedObserver?.off();\n        this.gradedObserver?.off();\n        this.startedObserver?.off();\n    }\n\n}\n","<!-- Buttons to add to the header. -->\n<core-navbar-buttons slot=\"end\">\n    <ion-button fill=\"clear\" (click)=\"openModuleSummary()\" aria-haspopup=\"true\" [attr.aria-label]=\"'core.info' | translate\">\n        <ion-icon name=\"fas-circle-info\" slot=\"icon-only\" aria-hidden=\"true\" />\n    </ion-button>\n</core-navbar-buttons>\n\n<!-- Content. -->\n<core-loading [hideUntil]=\"!showLoading\">\n\n    <!-- Activity info. -->\n    <core-course-module-info [module]=\"module\" [description]=\"description\" [component]=\"component\" [componentId]=\"componentId\"\n        [courseId]=\"courseId\" [hasDataToSync]=\"hasOffline\" (completionChanged)=\"onCompletionChange()\">\n        <div description *ngIf=\"assign && assign.introattachments?.length && !assign.submissionattachments\">\n            <core-file *ngFor=\"let file of assign.introattachments\" [file]=\"file\" [component]=\"component\" [componentId]=\"componentId\" />\n        </div>\n    </core-course-module-info>\n\n    <!-- User can view all submissions (teacher). -->\n    <ng-container *ngIf=\"assign && canViewAllSubmissions\">\n        <ion-list class=\"core-list-align-detail-right\">\n\n            <core-group-selector [groupInfo]=\"groupInfo\" [(selected)]=\"group\" (selectedChange)=\"setGroup(group)\" [courseId]=\"courseId\" />\n\n            <ion-item class=\"ion-text-wrap\">\n                <ion-label>\n                    <p class=\"item-heading\">{{ 'core.course.hiddenfromstudents' | translate }}</p>\n                    <p *ngIf=\"module.visible\">{{ 'core.no' | translate }}</p>\n                    <p *ngIf=\"!module.visible\">{{ 'core.yes' | translate }}</p>\n                </ion-label>\n            </ion-item>\n\n            <ion-item class=\"ion-text-wrap\" *ngIf=\"timeRemaining\">\n                <ion-label>\n                    <p class=\"item-heading\">{{ 'addon.mod_assign.timeremaining' | translate }}</p>\n                    <p>{{ timeRemaining }}</p>\n                </ion-label>\n            </ion-item>\n            <ion-item class=\"ion-text-wrap\" *ngIf=\"lateSubmissions\">\n                <ion-label>\n                    <p class=\"item-heading\">{{ 'addon.mod_assign.latesubmissions' | translate }}</p>\n                    <p>{{ lateSubmissions }}</p>\n                </ion-label>\n            </ion-item>\n\n            <!-- Summary of all submissions. -->\n            <ion-item class=\"ion-text-wrap\" *ngIf=\"summary && summary.participantcount\" (click)=\"goToSubmissionList()\" [detail]=\"true\"\n                button>\n                <ion-label>\n                    <p class=\"item-heading\" *ngIf=\"assign.teamsubmission\">{{ 'addon.mod_assign.numberofteams' | translate }}</p>\n                    <p class=\"item-heading\" *ngIf=\"!assign.teamsubmission\">{{ 'addon.mod_assign.numberofparticipants' | translate }}</p>\n                </ion-label>\n                <ion-badge slot=\"end\" color=\"primary\">\n                    <span aria-hidden=\"true\">{{ summary.participantcount }}</span>\n                    <span class=\"sr-only\" *ngIf=\"!assign.teamsubmission\">\n                        {{ 'addon.mod_assign.numberofparticipantscountdescription' | translate:{count: summary.participantcount} }}\n                    </span>\n                    <span class=\"sr-only\" *ngIf=\"assign.teamsubmission\">\n                        {{ 'addon.mod_assign.numberofteamscountdescription' | translate:{count: summary.participantcount} }}\n                    </span>\n                </ion-badge>\n            </ion-item>\n\n            <!-- Summary of submissions with draft status. -->\n            <ion-item class=\"ion-text-wrap\" *ngIf=\"assign.submissiondrafts && summary && summary.submissionsenabled\"\n                [class.hide-detail]=\"!summary.submissiondraftscount\" [detail]=\"true\" [button]=\"summary.submissiondraftscount\"\n                (click)=\"goToSubmissionList(submissionStatusDraft, !!summary.submissiondraftscount)\">\n                <ion-label>\n                    <p class=\"item-heading\">{{ 'addon.mod_assign.numberofdraftsubmissions' | translate }}</p>\n                </ion-label>\n                <ion-badge slot=\"end\" color=\"primary\">\n                    <span aria-hidden=\"true\">{{ summary.submissiondraftscount }}</span>\n                    <span class=\"sr-only\">\n                        {{ 'addon.mod_assign.numberofdraftsubmissionscountdescription' | translate:\n                        {count: summary.submissiondraftscount} }}\n                    </span>\n                </ion-badge>\n            </ion-item>\n\n            <!-- Summary of submissions with submitted status. -->\n            <ion-item class=\"ion-text-wrap\" *ngIf=\"summary && summary.submissionsenabled\"\n                [class.hide-detail]=\"!summary.submissionssubmittedcount\" [detail]=\"true\" [button]=\"summary.submissionssubmittedcount\"\n                (click)=\"goToSubmissionList(submissionStatusSubmitted, !!summary.submissionssubmittedcount)\">\n                <ion-label>\n                    <p class=\"item-heading\">{{ 'addon.mod_assign.numberofsubmittedassignments' | translate }}</p>\n                </ion-label>\n                <ion-badge slot=\"end\" color=\"primary\">\n                    <span aria-hidden=\"true\">{{ summary.submissionssubmittedcount }}</span>\n                    <span class=\"sr-only\">\n                        {{ 'addon.mod_assign.numberofsubmittedassignmentscountdescription' | translate:\n                        {count: summary.submissionssubmittedcount} }}\n                    </span>\n                </ion-badge>\n            </ion-item>\n\n            <!-- Summary of submissions that need grading. -->\n            <ion-item class=\"ion-text-wrap\" *ngIf=\"summary && summary.submissionsenabled && !assign.teamsubmission\"\n                [class.hide-detail]=\"!needsGradingAvailable\" [detail]=\"true\" [button]=\"needsGradingAvailable\"\n                (click)=\"goToSubmissionList(needGrading, needsGradingAvailable)\">\n                <ion-label>\n                    <p class=\"item-heading\">{{ 'addon.mod_assign.numberofsubmissionsneedgrading' | translate }}</p>\n                </ion-label>\n                <ion-badge slot=\"end\" color=\"primary\">\n                    <span aria-hidden=\"true\">{{ summary.submissionsneedgradingcount }}</span>\n                    <span class=\"sr-only\">\n                        {{ 'addon.mod_assign.numberofsubmissionsneedgradingcountdescription' | translate:\n                        {count: summary.submissionsneedgradingcount} }}\n                    </span>\n                </ion-badge>\n            </ion-item>\n        </ion-list>\n\n        <!-- Ungrouped users. -->\n        <ion-card *ngIf=\"assign.teamsubmission && summary && summary.warnofungroupedusers\" class=\"core-info-card\">\n            <ion-item>\n                <ion-icon name=\"fas-circle-question\" slot=\"start\" aria-hidden=\"true\" />\n                <ion-label>{{ 'addon.mod_assign.'+summary.warnofungroupedusers | translate }}</ion-label>\n            </ion-item>\n        </ion-card>\n\n        <div collapsible-footer *ngIf=\"!showLoading\" slot=\"fixed\">\n            <core-course-module-navigation [courseId]=\"courseId\" [currentModuleId]=\"module.id\" />\n        </div>\n    </ng-container>\n\n    <!-- If it's a student, display his submission. -->\n    <addon-mod-assign-submission *ngIf=\"!showLoading && !canViewAllSubmissions && canViewOwnSubmission\" [courseId]=\"courseId\"\n        [moduleId]=\"module.id\" />\n</core-loading>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
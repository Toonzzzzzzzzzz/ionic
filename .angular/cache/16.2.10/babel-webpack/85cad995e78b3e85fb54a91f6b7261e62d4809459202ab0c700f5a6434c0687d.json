{"ast":null,"code":"import _asyncToGenerator from \"/home/toon/works/gitionic7/ionic-github/ionic/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _class;\nimport { CoreContentLinksHandlerBase } from '@features/contentlinks/classes/base-handler';\nimport { CoreCourseHelper } from '@features/course/services/course-helper';\nimport { makeSingleton } from '@singletons';\nimport * as i0 from \"@angular/core\";\n/**\n * Handler to treat links to SCORM player.\n */\nexport class AddonModScormPlayerLinkHandlerService extends CoreContentLinksHandlerBase {\n  constructor() {\n    super(...arguments);\n    this.name = 'AddonModScormPlayerLinkHandler';\n    this.featureName = 'CoreCourseModuleDelegate_AddonModScorm';\n    this.pattern = /\\/mod\\/scorm\\/player\\.php.*([?&](id|a)=\\d+)/;\n  }\n  /**\n   * @inheritdoc\n   */\n  getActions(siteIds, url, params, courseId) {\n    return [{\n      action: function () {\n        var _ref = _asyncToGenerator(function* (siteId) {\n          const cmId = Number(params.id);\n          const instanceId = Number(params.a);\n          courseId = Number(courseId || params.courseid || params.cid);\n          if (!cmId && !instanceId) {\n            // Shouldn't happen, the regex should handle this.\n            return;\n          }\n          const navOptions = {\n            params: {\n              autoPlay: true,\n              mode: params.mode || undefined,\n              newAttempt: params.newattempt === 'on',\n              organizationId: params.currentorg,\n              scoId: Number(params.scoid) || undefined\n            }\n          };\n          if (cmId) {\n            CoreCourseHelper.navigateToModule(cmId, {\n              courseId,\n              modNavOptions: navOptions,\n              siteId\n            });\n          } else {\n            CoreCourseHelper.navigateToModuleByInstance(instanceId, 'scorm', {\n              courseId,\n              modNavOptions: navOptions,\n              siteId\n            });\n          }\n        });\n        return function action(_x) {\n          return _ref.apply(this, arguments);\n        };\n      }()\n    }];\n  }\n}\n_class = AddonModScormPlayerLinkHandlerService;\n_class.ɵfac = /*@__PURE__*/function () {\n  let ɵAddonModScormPlayerLinkHandlerService_BaseFactory;\n  return function AddonModScormPlayerLinkHandlerService_Factory(t) {\n    return (ɵAddonModScormPlayerLinkHandlerService_BaseFactory || (ɵAddonModScormPlayerLinkHandlerService_BaseFactory = i0.ɵɵgetInheritedFactory(_class)))(t || _class);\n  };\n}();\n_class.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: _class,\n  factory: _class.ɵfac,\n  providedIn: 'root'\n});\nexport const AddonModScormPlayerLinkHandler = makeSingleton(AddonModScormPlayerLinkHandlerService);","map":{"version":3,"names":["CoreContentLinksHandlerBase","CoreCourseHelper","makeSingleton","AddonModScormPlayerLinkHandlerService","constructor","name","featureName","pattern","getActions","siteIds","url","params","courseId","action","_ref","_asyncToGenerator","siteId","cmId","Number","id","instanceId","a","courseid","cid","navOptions","autoPlay","mode","undefined","newAttempt","newattempt","organizationId","currentorg","scoId","scoid","navigateToModule","modNavOptions","navigateToModuleByInstance","_x","apply","arguments","t","factory","ɵfac","providedIn","AddonModScormPlayerLinkHandler"],"sources":["/home/toon/works/gitionic7/ionic-github/ionic/src/addons/mod/scorm/services/handlers/player-link.ts"],"sourcesContent":["// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Injectable } from '@angular/core';\nimport { CoreContentLinksHandlerBase } from '@features/contentlinks/classes/base-handler';\nimport { CoreContentLinksAction } from '@features/contentlinks/services/contentlinks-delegate';\nimport { CoreCourseHelper } from '@features/course/services/course-helper';\nimport { CoreNavigationOptions } from '@services/navigator';\nimport { makeSingleton } from '@singletons';\n\n/**\n * Handler to treat links to SCORM player.\n */\n@Injectable({ providedIn: 'root' })\nexport class AddonModScormPlayerLinkHandlerService extends CoreContentLinksHandlerBase {\n\n    name = 'AddonModScormPlayerLinkHandler';\n    featureName = 'CoreCourseModuleDelegate_AddonModScorm';\n    pattern = /\\/mod\\/scorm\\/player\\.php.*([?&](id|a)=\\d+)/;\n\n    /**\n     * @inheritdoc\n     */\n    getActions(siteIds: string[], url: string, params: Record<string, string>, courseId?: number): CoreContentLinksAction[] {\n\n        return [{\n            action: async (siteId) => {\n                const cmId = Number(params.id);\n                const instanceId = Number(params.a);\n                courseId = Number(courseId || params.courseid || params.cid);\n\n                if (!cmId && !instanceId) {\n                    // Shouldn't happen, the regex should handle this.\n                    return;\n                }\n\n                const navOptions: CoreNavigationOptions = {\n                    params: {\n                        autoPlay: true,\n                        mode: params.mode || undefined,\n                        newAttempt: params.newattempt === 'on',\n                        organizationId: params.currentorg,\n                        scoId: Number(params.scoid) || undefined,\n                    },\n                };\n\n                if (cmId) {\n                    CoreCourseHelper.navigateToModule(\n                        cmId,\n                        {\n                            courseId,\n                            modNavOptions: navOptions,\n                            siteId,\n                        },\n                    );\n                } else {\n                    CoreCourseHelper.navigateToModuleByInstance(\n                        instanceId,\n                        'scorm',\n                        {\n                            courseId,\n                            modNavOptions: navOptions,\n                            siteId,\n                        },\n                    );\n                }\n            },\n        }];\n    }\n\n}\n\nexport const AddonModScormPlayerLinkHandler = makeSingleton(AddonModScormPlayerLinkHandlerService);\n"],"mappings":";;AAeA,SAASA,2BAA2B,QAAQ,6CAA6C;AAEzF,SAASC,gBAAgB,QAAQ,yCAAyC;AAE1E,SAASC,aAAa,QAAQ,aAAa;;AAE3C;;;AAIA,OAAM,MAAOC,qCAAsC,SAAQH,2BAA2B;EADtFI,YAAA;;IAGI,KAAAC,IAAI,GAAG,gCAAgC;IACvC,KAAAC,WAAW,GAAG,wCAAwC;IACtD,KAAAC,OAAO,GAAG,6CAA6C;;EAEvD;;;EAGAC,UAAUA,CAACC,OAAiB,EAAEC,GAAW,EAAEC,MAA8B,EAAEC,QAAiB;IAExF,OAAO,CAAC;MACJC,MAAM;QAAA,IAAAC,IAAA,GAAAC,iBAAA,CAAE,WAAOC,MAAM,EAAI;UACrB,MAAMC,IAAI,GAAGC,MAAM,CAACP,MAAM,CAACQ,EAAE,CAAC;UAC9B,MAAMC,UAAU,GAAGF,MAAM,CAACP,MAAM,CAACU,CAAC,CAAC;UACnCT,QAAQ,GAAGM,MAAM,CAACN,QAAQ,IAAID,MAAM,CAACW,QAAQ,IAAIX,MAAM,CAACY,GAAG,CAAC;UAE5D,IAAI,CAACN,IAAI,IAAI,CAACG,UAAU,EAAE;YACtB;YACA;;UAGJ,MAAMI,UAAU,GAA0B;YACtCb,MAAM,EAAE;cACJc,QAAQ,EAAE,IAAI;cACdC,IAAI,EAAEf,MAAM,CAACe,IAAI,IAAIC,SAAS;cAC9BC,UAAU,EAAEjB,MAAM,CAACkB,UAAU,KAAK,IAAI;cACtCC,cAAc,EAAEnB,MAAM,CAACoB,UAAU;cACjCC,KAAK,EAAEd,MAAM,CAACP,MAAM,CAACsB,KAAK,CAAC,IAAIN;;WAEtC;UAED,IAAIV,IAAI,EAAE;YACNhB,gBAAgB,CAACiC,gBAAgB,CAC7BjB,IAAI,EACJ;cACIL,QAAQ;cACRuB,aAAa,EAAEX,UAAU;cACzBR;aACH,CACJ;WACJ,MAAM;YACHf,gBAAgB,CAACmC,0BAA0B,CACvChB,UAAU,EACV,OAAO,EACP;cACIR,QAAQ;cACRuB,aAAa,EAAEX,UAAU;cACzBR;aACH,CACJ;;QAET,CAAC;QAAA,gBAAAH,OAAAwB,EAAA;UAAA,OAAAvB,IAAA,CAAAwB,KAAA,OAAAC,SAAA;QAAA;MAAA;KACJ,CAAC;EACN;;SAtDSpC,qCAAsC;;;;iJAAtCA,MAAqC,IAAAqC,CAAA,IAArCrC,MAAqC;EAAA;AAAA;;SAArCA,MAAqC;EAAAsC,OAAA,EAArCtC,MAAqC,CAAAuC,IAAA;EAAAC,UAAA,EADxB;AAAM;AA2DhC,OAAO,MAAMC,8BAA8B,GAAG1C,aAAa,CAACC,qCAAqC,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}
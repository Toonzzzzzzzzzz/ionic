{"ast":null,"code":"import _asyncToGenerator from \"/home/toon/works/gitionic7/ionic-github/ionic/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _class;\nimport * as i0 from \"@angular/core\";\n/**\n * Directive to observe mutations on some attributes and propagate them inside.\n * Current supported attributes: ion-button.aria-label\n *\n * This is necessary in order to update some attributes that are not reactive, for example aria-label.\n *\n * @see https://github.com/ionic-team/ionic-framework/issues/21534\n */\nexport class CoreUpdateNonReactiveAttributesDirective {\n  constructor(element) {\n    this.element = element.nativeElement;\n    this.mutationObserver = new MutationObserver(() => {\n      var _this$element$shadowR;\n      const button = (_this$element$shadowR = this.element.shadowRoot) === null || _this$element$shadowR === void 0 ? void 0 : _this$element$shadowR.querySelector('button');\n      if (!button) {\n        return;\n      }\n      // Propagate label to button.\n      const ariaLabel = this.element.getAttribute('aria-label');\n      ariaLabel ? button.setAttribute('aria-label', ariaLabel) : button.removeAttribute('aria-label');\n    });\n  }\n  /**\n   * @inheritdoc\n   */\n  ngOnInit() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      if ('componentOnReady' in _this.element) {\n        // This may be necessary if this is somehow called but Ionic's directives arent. This happens, for example,\n        // in some tests such as the credentials page.\n        yield _this.element.componentOnReady();\n      }\n      _this.mutationObserver.observe(_this.element, {\n        attributes: true,\n        attributeFilter: ['aria-label']\n      });\n    })();\n  }\n  /**\n   * @inheritdoc\n   */\n  ngOnDestroy() {\n    this.mutationObserver.disconnect();\n  }\n}\n_class = CoreUpdateNonReactiveAttributesDirective;\n_class.ɵfac = function CoreUpdateNonReactiveAttributesDirective_Factory(t) {\n  return new (t || _class)(i0.ɵɵdirectiveInject(i0.ElementRef));\n};\n_class.ɵdir = /*@__PURE__*/i0.ɵɵdefineDirective({\n  type: _class,\n  selectors: [[\"ion-button\"]]\n});","map":{"version":3,"names":["CoreUpdateNonReactiveAttributesDirective","constructor","element","nativeElement","mutationObserver","MutationObserver","_this$element$shadowR","button","shadowRoot","querySelector","ariaLabel","getAttribute","setAttribute","removeAttribute","ngOnInit","_this","_asyncToGenerator","componentOnReady","observe","attributes","attributeFilter","ngOnDestroy","disconnect","i0","ɵɵdirectiveInject","ElementRef","selectors"],"sources":["/home/toon/works/gitionic7/ionic-github/ionic/src/core/directives/update-non-reactive-attributes.ts"],"sourcesContent":["// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Directive, ElementRef, OnDestroy, OnInit } from '@angular/core';\n\n/**\n * Directive to observe mutations on some attributes and propagate them inside.\n * Current supported attributes: ion-button.aria-label\n *\n * This is necessary in order to update some attributes that are not reactive, for example aria-label.\n *\n * @see https://github.com/ionic-team/ionic-framework/issues/21534\n */\n@Directive({\n    selector: 'ion-button',\n})\nexport class CoreUpdateNonReactiveAttributesDirective implements OnInit, OnDestroy {\n\n    protected element: HTMLIonButtonElement | HTMLElement;\n    protected mutationObserver: MutationObserver;\n\n    constructor(element: ElementRef<HTMLIonButtonElement>) {\n        this.element = element.nativeElement;\n        this.mutationObserver = new MutationObserver(() => {\n            const button = this.element.shadowRoot?.querySelector('button');\n\n            if (!button) {\n                return;\n            }\n\n            // Propagate label to button.\n            const ariaLabel = this.element.getAttribute('aria-label');\n\n            ariaLabel\n                ? button.setAttribute('aria-label', ariaLabel)\n                : button.removeAttribute('aria-label');\n        });\n    }\n\n    /**\n     * @inheritdoc\n     */\n    async ngOnInit(): Promise<void> {\n        if ('componentOnReady' in this.element) {\n            // This may be necessary if this is somehow called but Ionic's directives arent. This happens, for example,\n            // in some tests such as the credentials page.\n            await this.element.componentOnReady();\n        }\n\n        this.mutationObserver.observe(this.element, { attributes: true, attributeFilter: ['aria-label'] });\n    }\n\n    /**\n     * @inheritdoc\n     */\n    ngOnDestroy(): void {\n        this.mutationObserver.disconnect();\n    }\n\n}\n"],"mappings":";;;AAgBA;;;;;;;;AAWA,OAAM,MAAOA,wCAAwC;EAKjDC,YAAYC,OAAyC;IACjD,IAAI,CAACA,OAAO,GAAGA,OAAO,CAACC,aAAa;IACpC,IAAI,CAACC,gBAAgB,GAAG,IAAIC,gBAAgB,CAAC,MAAK;MAAA,IAAAC,qBAAA;MAC9C,MAAMC,MAAM,IAAAD,qBAAA,GAAG,IAAI,CAACJ,OAAO,CAACM,UAAU,cAAAF,qBAAA,uBAAvBA,qBAAA,CAAyBG,aAAa,CAAC,QAAQ,CAAC;MAE/D,IAAI,CAACF,MAAM,EAAE;QACT;;MAGJ;MACA,MAAMG,SAAS,GAAG,IAAI,CAACR,OAAO,CAACS,YAAY,CAAC,YAAY,CAAC;MAEzDD,SAAS,GACHH,MAAM,CAACK,YAAY,CAAC,YAAY,EAAEF,SAAS,CAAC,GAC5CH,MAAM,CAACM,eAAe,CAAC,YAAY,CAAC;IAC9C,CAAC,CAAC;EACN;EAEA;;;EAGMC,QAAQA,CAAA;IAAA,IAAAC,KAAA;IAAA,OAAAC,iBAAA;MACV,IAAI,kBAAkB,IAAID,KAAI,CAACb,OAAO,EAAE;QACpC;QACA;QACA,MAAMa,KAAI,CAACb,OAAO,CAACe,gBAAgB,EAAE;;MAGzCF,KAAI,CAACX,gBAAgB,CAACc,OAAO,CAACH,KAAI,CAACb,OAAO,EAAE;QAAEiB,UAAU,EAAE,IAAI;QAAEC,eAAe,EAAE,CAAC,YAAY;MAAC,CAAE,CAAC;IAAC;EACvG;EAEA;;;EAGAC,WAAWA,CAAA;IACP,IAAI,CAACjB,gBAAgB,CAACkB,UAAU,EAAE;EACtC;;SAzCStB,wCAAwC;;mBAAxCA,MAAwC,EAAAuB,EAAA,CAAAC,iBAAA,CAAAD,EAAA,CAAAE,UAAA;AAAA;;QAAxCzB,MAAwC;EAAA0B,SAAA;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}